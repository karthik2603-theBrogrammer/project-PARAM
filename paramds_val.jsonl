{"text": "Q: How to highlight a page in the page list (Admin Menu)? Ok bear with me, I could not find any info on this online. I'm creating a plugin and I need to highlight one of the pages It will create upon activation.\nWordPress currently does this here;\n\nHow is this achieved? If anyone has any reading material they know of or if it's a simple thing to do I'd love to know.\n\nClarification: I'm not looking to highlight the row, but add the text\nnext to the page link. E.g. my page - Your Page\n\n\nA: You can add a stylesheet for admin using the following code,\nadd this in function.php\nfunction mmk_enqueue_custom_admin_style() {\n            wp_register_style( 'pixel_admin_css', get_template_directory_uri() . '/admin.css', false, '1.0.0' );\n            wp_enqueue_style( 'pixel_admin_css' );\n        }\n \n\n   add_action( 'admin_enqueue_scripts', 'mmk_enqueue_custom_admin_style' );\n\nthen add create admin.css in theme directory:\nyou can using following class to highlight\n.row-title\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402435", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get name of current page template in Gutenberg era In a block theme I'd like to be able to make some edits to the head meta based on the (block-based) page template used. The traditional get_page_template() doesn't seem to work as hoped in this case (I'm getting a return of wp-includes/template-canvas.php). Do we currently have a method for knowing what block-based page template someone may have assigned to a post/page? (Or do I have to do something like parse the body classes, or something like that?)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402441", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Widget editing returns JSON response error I am trying to modify the sidebar widgets under Appearance -> Widgets, but whatever I do (just change one option, or remove a widget, etc.), as soon as I press the Update button, on the bottom left it says There was an error. The response is not a valid JSON response.\nUpon inspecting the Network tab of the browser DevTools, the request is showing up as v1?_local=user and the request URL is https://host/wp-json/batch/v1?_locale=user with a method of OPTIONS. This request returns a status code 200, but there is no response data - unsure if this could be the issue or not.\nWhat I tried so far (after each point I tried editing the widgets again):\n\n*\n\n*Updated WordPress to 5.9\n\n*Updated all plugins\n\n*Disabled all plugins\n\n*Switched to a different theme\n\n*Saved changes on the permalinks\n\n*Used a different .htaccess suggested by a different website\n\n*Checked the Site Health, it does not report any issues with the REST API\n\nEverything else seems to work just fine, I can create/edit posts, pages, etc., but the widget editing keeps failing.\nWhat else can I try to fix this issue?\n\nA: The release of WordPress 5.8 removed the classic widgets editor in favor of the Gutenberg widget block editor to control your website widget areas.\nReferences:\nhttps://make.wordpress.org/core/2021/06/29/block-based-widgets-editor-in-wordpress-5-8/\nhttps://wordpress.org/news/2021/07/tatum/\nOld View of Widgets Dashboard\n\nNew View of Widgets Dashboard\n\nTo fix the issue add following code in the functions.php file.\nFile location: /var/www/html/yoursite/wp-includes/functions.php\nfunction example_theme_support() {\n    remove_theme_support( 'widgets-block-editor' );\n}\nadd_action( 'after_setup_theme', 'example_theme_support' );\n\nThen after reload the widgets dashboard, you will see the old dashboard view and will be able to edit the widgets.\nOR\nYou may transform the existing widget as shown in the screenshot.\n\nI hope these 2 solutions may help you.\nNote: Remember to undo the changes done in the functions.php file.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402443", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: What do I put in the form action attr on top of form wordpress I created an html form, but have no clue, what I must put in the <form action = on top of the form. Does the user info go to the database, or to a file in wordpress. I am not sure what to put there. At the moment, I do not have this site live. It's local by flywheel, but would just like to know. If anyone can help me here with this. Thanks\n\nA: There's a great article on Sitepoint that describes how to handle POST forms in WordPress:\nhttps://www.sitepoint.com/handling-post-requests-the-wordpress-way/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402447", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display custom post types by category I want to create a listing of custom post types in a particular category. I've tried the code below without any success. Can someone please show me where I have gone wrong?\nThe custom post type is called 'property', and the category slug is 'long-term'\n<?php\n    $query= null;\n    $args=array(\n    'post_type' => 'property',\n        'tax_query' => array(\n            array(\n                'taxonomy' => 'category',\n                'field' => 'slug',\n                'terms' => 'long-term'\n                                    )\n                            )\n                    );\n            $query = new WP_Query($args);\n            \n             if ( $query->have_posts() ) : $query->the_post(); ?>\n    \n    <h2><?php the_title();?></h2>\n    \n    <?php endif; ?>\n    <?php wp_reset_query(); ?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402449", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to allow to add gradients to core/heading block? is there a way to add gradients support for background in the core/heading block?\nI've tried to\n\n*\n\n*extend settings.supports with gradients: true\n\n*add gradients to theme json:\n\n\"blocks\": {\n      \"core/heading\": {\n        \"color\": {\n          \"gradients\": [\n            {\n              \"slug\": \"dark-gradient-with-stripes\",\n              \"name\": \"Dark gradient with stripes\",\n              \"gradient\": \"linear-gradient(to left bottom, rgba(125, 134, 152, .2) 15%, rgba(0, 0, 0, 0) 92.5%)\"\n            }\n          ]\n        }\n      }\n    },\n\nYour help is really appreciated.\n\nA: No, currently gradient support in the heading block has not been implemented.\nYou can declare that it supports it in theme.json or via supports, but there is nothing in the block to read that data in and use it. Gradient support has to be built into a block, it can't be inserted arbitrarily.\nThe closest you can get is with predefined variants or styles, a custom block, or wrapper the heading in a group/cover block. Composition not modification.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402450", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: wc_get_template_part doesnt display the content hello guys when i try to loop products it's just display the div but not product info\nthe image of the result\n\nfunction stsearch_products($data) {\n  $args = array(\n      'post_type'     => 'product', \n      'product', 'posts_per_page' => -1,\n      'order'         => 'ASC' // ASC\n  );\n  $args['s'] = $data['search-title'];\n  \n\n  $loop = new WP_Query( $args );\n  ob_start();\n  if ( $loop->have_posts() ) :\n\n      do_action( 'woocommerce_before_shop_loop' );\n\n      woocommerce_product_loop_start(); \n\n\n          while ( $loop->have_posts() ) :\n\n              $loop->the_post();\n\n              wc_get_template_part( 'content', 'product' );\n\n          endwhile;\n  \n      woocommerce_product_loop_end(); \n\n\n      do_action( 'woocommerce_after_shop_loop' ); \n\n\n  else :\n\n      do_action( 'woocommerce_no_products_found' );\n\n  endif; \n\n \n  wp_reset_postdata(); \n  return ob_get_clean();\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402451", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to remove share button from image overlay does anyone know how I can remove share button from image overlay on my website ?, I already have a share button on my site, I dont want uploaded images to have share buttons too,  please help \n\nA: First, you have to find out which sources cause these sharing buttons.\n\n*\n\n*Is it your theme?\n\n*\n\n*Then head over to the customizer of your them and look for an option describing these buttons.\n\n*If you can't find an option, check out the theme documentation.\n\n\n\n*Is it a plugin?\n\n*\n\n*Depending on the amount of the installed plugins, you can disable/enable these and see if the sharing disappear.\n\n*Once you know the plugin, which is causing this behaviour, check out the plugin options.\n\n\n\nIn case you can't find an option to control it via the admin interface, you can still visually remove the buttons using CSS display: none.\nTo hide them, open your web inspector and copy the element selector, add the display: none; declaration under your selector and paste the CSS rule to the custom CSS section in the WordPress customizer.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402455", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Unwanted white space next to inputs added within `PluginDocumentSettingPanel` using `` So I've encountered something I'm not quite sure of, so I thought I'd ask and see if anyone else has had a similar problem.\nI've created a new PluginDocumentSettingPanel Instance to include my custom metadata. I'm using <PanelRow> to wrap each newly created <TextControl>.\nEverything is working as expected except for a visual quirk, of which I'm not sure if it's intended. Below are some images highlighting the quirk.\n\nSee Full\n\nSee Full\n\nIs there any reason these inputs wouldn't take up 100% of the width inside the PluginDocumentSettingPanel?\n\nHTML Markup With Unwanted Space\n<div class=\"components-panel__row\">\n    <div class=\"components-base-control css-1wzzj1a e1puf3u3\">\n        <div class=\"components-base-control__field css-1kyqli5 e1puf3u2\">\n            <label class=\"components-base-control__label css-4dk55l e1puf3u1\" for=\"inspector-text-control-3\">Auto 1hr:</label>\n            <input class=\"components-text-control__input\" type=\"text\" id=\"inspector-text-control-3\" value=\"42\">\n        </div>\n    </div>\n</div>\n\nHTML Markup Without Unwanted Space\n<div class=\"components-panel__row\">\n    <div class=\"components-base-control css-1wzzj1a e1puf3u3\">\n        <div class=\"components-base-control__field css-1kyqli5 e1puf3u2\">\n            <label class=\"components-base-control__label css-4dk55l e1puf3u1\" for=\"inspector-text-control-56\">Postal Town:</label>\n            <input class=\"components-text-control__input\" type=\"text\" id=\"inspector-text-control-56\" value=\"St Albans\">\n        </div>\n    </div>\n</div>\n\nReact Code:\nimport { __ } from '@wordpress/i18n';\nimport { useSelect } from '@wordpress/data';\nimport { useEntityProp } from '@wordpress/core-data';\nimport { registerPlugin } from '@wordpress/plugins';\nimport { PluginDocumentSettingPanel } from '@wordpress/edit-post';\nimport { TextControl, PanelRow } from '@wordpress/components';\n\nconst TextController = ({ postType }) => {\n    // Unpack meta data; key, value.\n    const [meta, setMeta] = useEntityProp('postType', postType, 'meta');\n\n    const updateMetaValue = (key, value) => {\n        // Clone the existing meta object.\n        const newMeta = { ...meta };\n\n        // Update the specific meta only.\n        newMeta[key] = value;\n\n        // Then set the updated meta.\n        setMeta(newMeta);\n    };\n\n    const controls = Object.entries(meta)\n        .filter(([key]) => key.includes('_postcode_pricing_'))\n        .map(([key, value]) => ({\n            key,\n            value,\n            label:\n                key\n                    .replace('_postcode_pricing_', '')\n                    .split('_')\n                    .map((s) => s[0].toUpperCase() + s.slice(1))\n                    .join(' ') + ':',\n        }))\n        .map(({ key, value, label, index }) => {\n            return (\n                <PanelRow key={index}>\n                    <TextControl\n                        label={__(label, 'postcode-pricing')}\n                        value={meta[key]}\n                        onChange={(value) => updateMetaValue(key, value)}\n                    />\n                </PanelRow>\n            );\n        });\n\n    return <>{controls}</>;\n};\n\nconst PostcodePricingBeDocSidebar = () => {\n    const postType = useSelect(\n        (select) => select('core/editor').getCurrentPostType(),\n        []\n    );\n\n    console.log('Post-type:', postType);\n\n    // Check the post-type, if no match (do nothing...)\n    if ('postcode_pricing_pt' != postType) {\n        return null;\n    }\n\n    return (\n        <PluginDocumentSettingPanel\n            name=\"postcode-pricing\"\n            title=\"Area Pricing\"\n            className=\"postcode-pricing\"\n        >\n            <TextController postType={postType} />\n        </PluginDocumentSettingPanel>\n    );\n};\n\n// render the panel\nregisterPlugin('postcode-pricing-be-doc-sidebar', {\n    render: PostcodePricingBeDocSidebar,\n});\n\nexport default PostcodePricingBeDocSidebar;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402461", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Check For get_post_meta on Author Archive Page I've had a good look thru the Similar Questions for an answer and i'm looking to check if a value for a custom field key on single posts has been added using get_post_meta(); however i want to use this check on the author archive page.\nThis is my code in functions.php\nglobal $wp_query;\n\n$post = $wp_query->get_queried_object_id();\n\n$meta  = get_post_meta( $post->ID, 'key', true );\n\nif ( $meta ) :\n\nUpdate : This function doesn't work on the author archive page.\nfunction author_has_name() {\nglobal $post;\n$name = get_post_meta ($post->ID, 'author_name', true);\nreturn !empty($name);\n}\n\nHowever, the code won't work in the author.php template\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402468", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why template_include filter does not work with WPML plugin? I have some issue with WPML. I use two different product page fro the phisical product and for the video lessons. Now I added one more language to the project ussin WPML plugin. And It's okay but my chunk of code I using for changed the template does not work. I use this code for changing template:\nadd_filter( 'template_include', 'bsl_single_product_template_include', 50, 1 );\nfunction bsl_single_product_template_include( $template ) {\nif ( is_singular('product') && (has_term( 'cosmetics', 'product_cat')) ) {\n    $template = get_stylesheet_directory() . '/woocommerce/single-product-cosmetics.php';\n}\n   return $template;\n}\n\nHow it should work: there is a product page and there is a video tutorial page. These pages have different templates. To change the template I use the code shown above. But after installing and configuring the second language when switching to the template does not occur. For example, I am on a physical product page, I switch the language and the page changes to the default one, although the product page should remain.\n\nA: Hi everyone I have found the solution. I think the comment of the @JacobPeattie help me to do that. Thank you @JacobPeattie! And here is the solution: in my code I use if statement for chacking what product category is:\nif ( is_singular('product') && (has_term( 'cosmetics', 'product_cat')) )\n\nBut I did not take into account the fact that the WPML changes the category for the extra language. That's my fault. Now I will know that. And here is the correct code:\nadd_filter( 'template_include', 'alexandra_template_include', 15, 1 );\nfunction alexandra_template_include( $template ) {\nglobal $post;\n$terms = wp_get_post_terms( $post->ID, 'product_cat' );\nforeach ( $terms as $term ) $categories[] = $term->slug;\n\nif(is_product() &&  in_array( 'cosmetics', $categories) || in_array( 'cosmetics- \nen', $categories)){\n    $template = get_stylesheet_directory() . '/woocommerce/single-product- \ncosmetics.php';\n }\n   return $template;\n  }\n\nI need it for specific purposes. But maybe it will be useful for someone else.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402470", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why My slider shortcode display above header //slider shortcode\nfunction slider_shortcode($atts) {\n    extract( shortcode_atts( array(\n            'id' => ''), $atts));\n        $id = $id;\n        ob_start();?>\n    <div class=\"gallary\">  \n        <?php  \n          // Check rows exists.\n         if( have_rows('slider',$id) ):\n\n            // Loop through rows.\n            while( have_rows('slider',$id) ) : the_row();\n                $slider_image = get_sub_field('slider_image');\n                $slider_heading = get_sub_field('slider_heading');\n                $slider_text = get_sub_field('slider_text');\n                $slider_button = get_sub_field('slider_button');\n                $slider_button_link = get_sub_field('slider_button_link');?>\n            <div>\n                <div class=\"display\">\n                    <div class=\"text\">\n                        <h3><?php echo $slider_heading; ?></h1>\n                        <p><?php echo $slider_text; ?></p>\n                        <a class=\"shop_now\" href=\"<?php echo $slider_button_link;?>\" class=\"btn_slide\"><?php echo $slider_button; ?></a>\n                    </div>\n                    <div class=\"image\">\n                            <img class=\"p_image\" src=\"<?php echo $slider_image; ?>\"/>\n                    </div>\n                </div>\n            </div>    \n            <?php\n\n        // End loop.\n        endwhile;\n\n    // No value.\n    else :\n       \n    endif;\n    ?>\n    </div>\n<?php \n}\nadd_shortcode('carousel', 'slider_shortcode');\n\n//js\njQuery(document).ready(function($){\n  jQuery(\".gallary\").slick({\n        dots:true,\n        autoplay: true,\n        fade: true,\n        autoplaySpeed: 3000,\n  });\n  });\n\npage links:https://theelectronicstore.in/demo/\nI think this error occur because of ob_get_clean() but when i add at last the whole slider gone hide any kind of help thanks in advance :)\n\nA: You need to return the value from the output buffer, like this:\n//slider shortcode\nfunction slider_shortcode($atts) {\n    extract( shortcode_atts( array(\n            'id' => ''), $atts));\n        $id = $id;\n        ob_start();?>\n    <div class=\"gallary\">  \n        <?php  \n          // Check rows exists.\n         if( have_rows('slider',$id) ):\n\n            // Loop through rows.\n            while( have_rows('slider',$id) ) : the_row();\n                $slider_image = get_sub_field('slider_image');\n                $slider_heading = get_sub_field('slider_heading');\n                $slider_text = get_sub_field('slider_text');\n                $slider_button = get_sub_field('slider_button');\n                $slider_button_link = get_sub_field('slider_button_link');?>\n            <div>\n                <div class=\"display\">\n                    <div class=\"text\">\n                        <h3><?php echo $slider_heading; ?></h1>\n                        <p><?php echo $slider_text; ?></p>\n                        <a class=\"shop_now\" href=\"<?php echo $slider_button_link;?>\" class=\"btn_slide\"><?php echo $slider_button; ?></a>\n                    </div>\n                    <div class=\"image\">\n                            <img class=\"p_image\" src=\"<?php echo $slider_image; ?>\"/>\n                    </div>\n                </div>\n            </div>    \n            <?php\n\n        // End loop.\n        endwhile;\n\n    // No value.\n    else :\n       \n    endif;\n    ?>\n    </div>\n<?php\n    $output_string = ob_get_contents();\n    ob_end_clean();\n    return $output_string;\n}\nadd_shortcode('carousel', 'slider_shortcode');\n\nI've added those lines to the very end of your function:\n$output_string = ob_get_contents();\nob_end_clean();\nreturn $output_string;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402471", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: Pagination on page 2+ only So here is the code I have\n<meta name=\"robots\" content=\"follow, <?php echo (get_query_var('paged')==1)?'index':'noindex'?>\" />\n\nI am trying to have it set to only execute on pages 2 & above. Thus far I have tried\n<meta name=\"robots\" content=\"follow, <?php echo (get_query_var('paged')==2)?'index':'noindex'?>\" />\n\nBut it's still executing on page 1?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402476", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Access to the template file of a plug-in I am developing a plugin that consists only of REST API queries.  It consists only of the myplugin.php and the template files (index.php, style.css & functions.js) and has no connection to the installed WP-theme.\nThe plugin should be accessible via the URL: example.com/myplugin, which I achieved with this entry in plugin.php:\nadd_action('init', function () {\n    add_rewrite_rule('myplugin', 'wp-content/plugins/myplugin/theme/index.php', 'top');\n});\n\nIn the index.php I can unfortunately only include the two external scripts (.css, .js) via absolute path, because if I define a variable in plugin.php, it is not output in index.php.\nHow can I integrate the template (index.php) so that it has access to the previously defined variables?\n\nA: maybe dirty, but it works:\n$slug = $_SERVER['REQUEST_URI'];\n$slug = explode('/', $slug);\n$slug = array_filter($slug);\n$slug = end($slug);\nif ($slug == 'myplugin') {\n    include(__DIR__.'/theme/index.php');\n    exit;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402481", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get custom text if in Category I have added some custom text at the end of all my articles. Now I want to remove that text if is in a certain category.\nFor that, I have the following code.\n<?php if(in_category('sample-category')) : ?>\n<?php else: ?>\n\n(this means I will NOT show my custom text at the end of articles posted in \"sample-category\") and it works perfectly.\nNow I want to do this with 2 or more categories. I have tried anything I know/found but without results, like:\n<?php if(in_category('sample-category', 'new-category')) : ?>\n\nTried by category name, category ID, category slug, but nothing works.\nWhat can I do to exclude the custom text I have added to each single post on 2 or more categories?\nThanks!\n\nA: in_category takes 2 parameters, the first being the categories to check, and the second being the post ID.\nIf we look at the official documentation on wordpress.org we can see these are the parameters that this function can accept:\nin_category( int|string|int[]|string[] $category, int|object $post = null )\n\nTaken from: https://developer.wordpress.org/reference/functions/in_category/\n\nWe can also see in the official documentation for that function an example of checking more than one category by using an array:\nif ( in_category( [ 'Tropical Birds', 'small-mammals' ] ) {\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402484", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Should I use two single WordPress installations because of SEO? I read somewhere that too many plugins can sometimes affect the performance of a website due to plugin conflicts, the way plugins were coded, etc.\nIn case there is some truth in this argument, I am wondering if the following website strategy can help to solve this problem:\n\n*\n\n*Create two websites in two single WordPress installations: Storefront (site 1), WooCommerce (site 2)\n\n*List all the products ONLY in my Storefront (site 1) and from there send users directly to the checkout page of WooCommerce (site 2)\n\n*Hide site 2 from google search engines since this site would only be used only for checkout and back-office purposes.\n\nI am new to the field of web development in general and WordPress in particular, so any advice on this matter would be very much appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402486", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Remove HTML Elements from Post Excerpt? I am Using the Following Code and want to remove HTML All Elements.\n<?php $exerpttext = substr(get_post_field('post_content', $post->ID), 0, 300);\nif (!empty($exerpttext)) { echo $exerpttext.'....'; }  ?>\n\n\nA: At first glance, this appears to be an XY Problem.\nIf you simply want to increase the length of the excerpt auto-generated from the post content, you can use the excerpt_length hook in functions.php.\nfunction modify_excerpt_length( $length ) {\n        return 300;\n}\nadd_filter( 'excerpt_length', 'modify_excerpt_length', 99 );\n\nThen simply call the excerpt in your template:\nthe_excerpt()\n\nThis will automatically remove all tags.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402489", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can I use custom CSS and js plugin to put JavaScript in to validate my forms I would like to put some front-end JavaScript validation to my forms, but was wondering, if I can put the JavaScript for the field validations in the custom CSS and js plugin, or do I need a specific plugin to do this.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402493", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Enqueue scripts not working with if is page conditional tag in functions.php Is this even the correct way of including scripts on a specific page?\nfunction insert_mapsvg_scripts() {\n  wp_enqueue_style( 'mapsvg_css', site_url('/mapsvg/css/mapsvg.css') );\n  wp_enqueue_style( 'nanoscroller_css', site_url('/mapsvg/css/nanoscroller.css') );\n  wp_enqueue_script( 'mousewheel_js', site_url('/mapsvg/js/jquery.mousewheel.min.js'), array('jquery'), '', true );\n  wp_enqueue_script( 'nanoscroller_js', site_url('/mapsvg/js/jquery.nanoscroller.min.js'), array('jquery'), '', true );\n  wp_enqueue_script( 'mapsvg_js', site_url('/mapsvg/js/mapsvg.min.js'), array('jquery'), '', true );\n} \n\nif( is_page( 37629 ) ) {\n    add_action('wp_enqueue_scripts', 'insert_mapsvg_scripts');\n}\n\n\nA: Try doing in the opposite way.  Add_action can always be active, and add the if statement into the function.  Like this:\nadd_action('wp_enqueue_scripts', 'insert_mapsvg_scripts');\n\nfunction insert_mapsvg_scripts() {\n  if( is_page( 37629 ) ) {\n    wp_enqueue_style( 'mapsvg_css', site_url('/mapsvg/css/mapsvg.css') );\n    wp_enqueue_style( 'nanoscroller_css', site_url('/mapsvg/css/nanoscroller.css') );\n    wp_enqueue_script( 'mousewheel_js', site_url('/mapsvg/js/jquery.mousewheel.min.js'), array('jquery'), '', true );\n    wp_enqueue_script( 'nanoscroller_js', site_url('/mapsvg/js/jquery.nanoscroller.min.js'), array('jquery'), '', true );\n    wp_enqueue_script( 'mapsvg_js', site_url('/mapsvg/js/mapsvg.min.js'), array('jquery'), '', true );\n  }\n}\n\nAlso, as @marktruitt commented.  Generally JS is stored in the plugin or theme folder.  If it's a custom theme an enqueue may look like this:\nwp_enqueue_script( 'mousewheel_js', get_template_directory_uri(). '/mapsvg/js/jquery.mousewheel.min.js', array('jquery'), '', true );\n\nWhereas if you're using a child theme it would look like this:\nwp_enqueue_script( 'mousewheel_js', get_stylesheet_directory_uri(). '/mapsvg/js/jquery.mousewheel.min.js', array('jquery'), '', true );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402499", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to track inexistent images request My server CPU is running high and one of the reasons is that it is requesting these images that don't even exist.\nHow can I track and find what exactly is requesting them?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402500", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Set two terms for a post when they differ only by an accent I face the following situation: after manually adding (in the backend) the terms with names (not slugs) M\u00e2nie and Manie, that differs only in an accent/diacritic (they are totally different words with totally different meanings), to a non-hierarchical custom taxonomy (tags), no matter what slugs were set (I tried the slug pairs minie/manie and manie/manie-2 for that term names), when I try to set these terms to a post, also from backend, when I save the post Wordpress randomly accepts only one of them.\nTo summarize, the terms are (can be) created / added to the taxonomy, but cannot be added together to the post, one of which being randomly excluded while saving the post.\nHow can I fix this? I haven't found any useful information so far. The non-hierarchical custom taxonomy was added by a code, but I don't think that's the cause of the problem.\n\nA: So, WordPress doesn't allow setting two terms (already existing in a taxonomy or being new, no difference) for a post, when editing it in backend (from Edit or Quick Edit) if they differ only by one accent / diacritical mark, randomly rejecting one of them. After several tests, I found that these terms can still be added to the post using a hook/filter - save_post() or save_post_{$post->post_type}. However, there's a problem here too: WordPress will remove randomly one of the two terms the next time the post will be saved/updated if the hook will be disabled, so the only solution I see in this situation is to add the terms in question to the post before every post saving/updating. Given that post savings are not done very often, it is not a big inconvenience.\nThis is the code (I chose to use the save_post_{$post->post_type} hook):\nadd_action( 'save_post_your_post_type_slug', function( $post_id ) {\n    $taxonomy = 'custom_taxonomy_slug';\n\n    // terms to add; I mention that they were added earlier to the custom\n    // taxonomy and the taxonomy may contain other terms for other posts\n    $new_terms = array( 'M\u00e2nie', 'Manie' );\n\n    // get existing taxonomy terms as an array with their IDs and names\n    $tax_terms = get_terms( array( 'taxonomy' => $taxonomy, \n        'fields' => 'id=>name', 'hide_empty' => false ) );\n\n    if( ! is_null( $tax_terms ) && ! empty( $tax_terms ) ) {\n        // check if the new terms exist in the custom taxonomy\n        $common_terms = array_intersect( $tax_terms, $new_terms );\n        if( ! is_null( $common_terms) && ! empty( $common_terms) ) {\n            // get IDs of new post terms\n            $terms_ids = array_keys( $common_terms );\n            // set new post terms\n            wp_set_post_terms( $post_id, $terms_ids, $taxonomy );\n        }\n    }\n} );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402501", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress load same script two times I write a basic plugin with custom css/js.\nI use wp_enqueue_script for my custom script and use hook 'init' to register script in front-end page.\nBut wordpress load this javascript file two times with different version. ( See in image )\nAnd I don't know why. I load this script one time and load it in one point of my code.\nI have tried clean cache wordpress, cache browser, but nothing do.\n\nMy site is esposte online : https://node.alfonsosomma.it/2022/02/04/articolo-prova/\nI write plugin to use add_shortcode function to create form; shortcode for the form in this page (articolo-prova).\nBest regards,\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402502", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Layout using Bootstrap not aligning correctly I have been stuck at a strange layout alignment issue. I have been using Bootstrap 4 to set layout of a section. Please take a look at the screenshot below -\n\nThis is here.\nIt is working as expected. Now, check here -\n\nThe exact same plugin breaking on another WordPress installation. This type of issue usually occurs due to the styling on an enclosing wrapper but couldn't find anything. I have been banging my head over it for the last couple of days but could not pin point the issue.\nAny help would be appreciated!\n\nA: The issue is due to box-sizing\nBootstrap expects box-sizing to be border-box to work properly, however in your second link it isn't so.\nA quick fix is to add this custom css to your project:\n.row * {\n    box-sizing: border-box;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402504", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Api rest_route 404 while building filter for custom posts (filtered by multiple meta keys / custom fields) I am working in a WordPress site that has many custom post types, and extensive use of Advanced Custom Fields (ACF). The site also uses node modules, custom code from scratch, and Git in favor of a pre-built theme and \"typical\" plugins. Many of the tasks I do involve working with code already written.\nThe site is a safari business. We have Continents, Countries (sometimes called Destinations in certain contexts), Places, and Testimonials - all are custom posts. None of which use any taxonomies at all, ever. The testimonials already have custom fields via ACF connecting the Testimonials with appropriate Continents, Countries, and Places.\nMy issue is pretty complex, and I'll do my best to explain it.\nMy goal\nCreate an Ajax filter to display Testimonials by Continent, Country, and (eventually) Place, without a plugin. Continent and Country can be select fields, and only one is required, optionally both can be set.\nThe site already has an almost identical version of this, working. It has dropdown selects that filter one of the other custom post types, Itineraries. What I need is exactly like this, just for Testimonials instead of Itineraries. That page is https://extraordinaryjourneys.com/plan-your-trip/itineraries/.\nIt uses NPM Select-custom and a few PHP and JS files. I've included two of them below.\nWhat I have tried\nI have made duplicated files of the Itineraries files for Testimonials, and trying to make those work just like that Itineraries page working example is. It might be easier to write meta_queries and if so I'll need a little guidance there, but i thought this would be easier. These are the files, including sections I've commented out because they were related to one of the dropdowns from the itineraries page that don't need to be on this testimonials page, like trip budget, or because it's part of me figuring out how this all works.\nWhere I am stuck\nI've pushed the code to the staging site, and you can see the console errors. Can you help me troubleshoot the api 404 call? The already existing Itineraries page linked above has the same, but without error. https://staging.extraordinaryjourneys.com/testimonial-troubleshooting You can click the Continent or Country selects and you'll get an alert, which must be related to the api call. Screenshot here showing what you'll see in console.\nIf there's anything else to include or add I am happy to.\n\n*\n\n*hero-filter-testimonials.js\nimport '../elements/filter-results-grid';\n\n$(document).ready(function () {\n   const $body = $('body');\n   const $filterTestimonials = $('.filter-testimonials');\n   \n   $body.on('click', '.btn-load-more', function (e) {\n       $(e.currentTarget).hide();\n       getResults(null, parseInt(e.currentTarget.dataset.page));\n   });\n\n   $('.clear-all').click(function () {\n       window.history.replaceState(null, null, '#');\n       triggerSearch(getParamsObject(), $filterTestimonials);\n   });\n\n   continentContainer.find('.custom-select__option').on('click', function (e) {\n       let continentId = e.currentTarget.dataset.value;\n       showCountriesOptions(continentId);\n   });\n\n   function showCountriesOptions(continentId = null) {\n       const $selectContainer = $filterTestimonials.find('#destination').parent();\n       console.log('Line 38 hero-filter-testimonials.js: continentId: ' + continentId);\n       if (continentId) {\n           $selectContainer.find('.custom-select__option').hide();\n           $selectContainer.find(\".custom-select__option[data-continent='\" + continentId + \"']\").show();\n       } else {\n           $selectContainer.find('.custom-select__option').not('[data-value=\"placeholder\"]').show();\n       }\n   }\n\n   function getResults(origin = null, page = 1) {\n       console.log(\"getResults(): \" + getResults);\n       let data = {action: 'get_testimonial_results'};\n\n       $filterTestimonials.find('.filter-panel').hide();\n\n       const $select = $filterTestimonials.find('.custom-select');\n\n       data = getDataFromSelectors(data, $select);\n\n       if (origin && origin === 'continent') {\n           if (data['destination']) {\n               delete data['destination'];\n               resetSingleSelector($filterTestimonials.find('#destination')[0]);\n           }\n       }\n\n      $filterTestimonials.find('#special_departures').prop(\"checked\");\n       console.log(\"Line below is log.data\");\n       console.log(data);\n       console.log(\"Line below is dir.data\");\n       console.dir(data);\n       updateUrl(data);\n\n       if (Object.keys(data).length === 1) {\n           getContainer().show();\n           getResultsContainer().hide();\n           $body.find('.clear-all-btn-container').hide();\n       } else {\n           let $loader = $body.find('.filter-loader');\n           $body.find('.clear-all-btn-container').show();\n           getFilterResults('get_testimonial_results', 'Testimonials', data, $loader, page);\n       }\n       addBadges($filterTestimonials, ['continent']);\n   }\n\n   window.getResults = getResults;\n\n   let data = getParamsObject();\n   console.log(\"Line below is data\");\n   console.table(data);\n   console.log(\"Line below is $filterTestimonials\");\n   console.table($filterTestimonials);\n   // console.log(JSON.stringify($filterTestimonials,null,2));\n   triggerSearch(data, $filterTestimonials);\n});\n\n\n*\n\n*testimonials_results.php\nThis page makes a custom api call that returns a 404, and I don't know why. It also has the query to get testimonials posts.\n\n<?php\n\nadd_action('rest_api_init', function () {\n    register_rest_route('ejourneysnineteen/v1', '/get_testimonial_results', array(\n        'methods' => 'POST',\n        'callback' => 'get_testimonial_results',\n        'permission_callback' => function () {\n            return true;\n        }\n    ));\n});\n\nfunction get_testimonial_results() {\n    $pageSize = $_REQUEST['pageSize'] ?? 10;\n\n    $args = [\n        'posts_per_page' => $pageSize,\n        'ignore_sticky_posts' => 1,\n        'post_type' => 'testimonial',\n        'orderby' => 'title',\n        'order' => 'ASC',\n    ];\n\n    if (isset($_REQUEST['page'])) {\n        $args['paged'] = $_REQUEST['page'];\n    }\n\n    if (isset($_REQUEST['continent']) || \n     isset($_REQUEST['destination']) \n    //  isset($_REQUEST['region']) ||\n    //  isset($_REQUEST['accommodation_type']\n     ) {\n        // $metaQueries = ['relation' => 'AND'];\n\n        if (isset($_REQUEST['region'])) {\n            $regions = explode(',', $_REQUEST['region']);\n            $subquery = [\n                'relation' => 'OR'\n            ];\n            foreach ($regions as $region) {\n                $subquery[] = [\n                    'key' => 'accommodation_region',\n                    'value' => $region,\n                    'compare' => 'LIKE'\n                ];\n            }\n            $metaQueries[] = $subquery;\n        }\n        else {\n            if (isset($_REQUEST['destination'])) {\n                $metaQueries[] = [\n                    'key' => 'testimonial_country',\n                    'value' => $_REQUEST['destination'],\n                    'compare' => 'LIKE',\n                ];\n            }\n            else {\n                if (isset($_REQUEST['continent'])) {\n                    $metaQueries[] = [\n                        'key' => 'testimonial_continent',\n                        'value' => $_REQUEST['continent'],\n                        'compare' => 'LIKE',\n                    ];\n                }\n            }\n        }\n\n              $args = array_merge($args, [\n            'meta_query' => $metaQueries\n        ]);\n    }\n\n    $result = [];\n    if (count($metaQueries) > 1) {\n        $query = new WP_Query($args);\n\n        foreach ($query->get_posts() as $post) {\n            $post_thumbnail_id = get_post_thumbnail_id($post);\n            $image_url = fly_get_attachment_image_src($post_thumbnail_id, [500, 500], true);\n            $result[] = [\n                'link' => get_the_permalink($post),\n                'title' => $post->post_title,\n                'excerpt' => html_entity_decode(ellipsis(get_the_excerpt($post), 80)),\n                'image_url' => $image_url,\n                'category' => 'Testimonial'\n            ];\n        }\n    }\n    wp_send_json_success([\n        'results' => $result,\n        'total' => $query->found_posts,\n        'pages' => $query->max_num_pages,\n        ]);\n}\n\nThere are other files but I'm so stuck I'm not sure if I should add them all there or not. Is this enough to help me troubleshoot the api call 404?\n\nA: As I said in my comment, I made a POST request to your custom endpoint (here) and then received a 404 error with this message: \"No route was found matching the URL and request method.\", which likely means the route was never registered, or that the request method was not supported, i.e. not in the methods list specified during registration (using register_rest_route()).\nSo you just need to ensure the route is registered properly and that your (AJAX) request is using the correct HTTP request method, and then the 404 error would be gone.\nAnd in your case, you can ensure the route is registered properly by loading the testimonials_results.php file from within the theme's functions.php file. E.g.\n// Assuming the file is at the same level as the functions.php file\nrequire_once __DIR__ . '/testimonials_results.php';\n\nOther issues in your code\n\n*\n\n*The $metaQueries variable is not defined, and should be defined before the if (isset($_REQUEST['continent']) ...) line.\n\n\n*The isset($_REQUEST['region']) should not be commented out, because otherwise if only the region parameter specified, then your custom posts query would never run.\n\n\n*The above posts query will also run only if $metaQueries has 2 or more items, so if the array is empty or has just 1 item, the $query in your return part would be an undefined and results in a PHP notice saying Undefined variable: query.\nAnd it's up to you on how should that be fixed.. but for example, you could add an else, and return an error.\n\n\n*When the WP_Query class is instantiated with a non-empty args, i.e. new WP_Query($args) as opposed to new WP_Query(), the get_posts() method will be automatically called, hence you should not call it manually.\nSo replace the $query->get_posts() with $query->posts to access/retrieve the posts that already retrieved via the automatic call to the get_posts() method.\n\n\n*From the REST API handbook:\n\nImportantly, a REST API route\u2019s callback should always return data;\nit shouldn\u2019t attempt to send the response body itself. This ensures\nthat the additional processing that the REST API server does, like\nhandling linking/embedding, sending headers, etc\u2026 takes place. In\nother words, don\u2019t call die( wp_json_encode( $data ) ); or\nwp_send_json( $data ).\n\nSo don't call wp_send_json_success() (which uses wp_send_json()), and simply return the data. I.e. return [ 'results' => $result, ... ];\nAdditional Notes/Info\n\n*\n\n*WordPress has a __return_true() function, so you could simply do 'permission_callback' => '__return_true' :)\n\n\n*The $args = array_merge($args, [ 'meta_query' => $metaQueries ]); could just be written as $args['meta_query'] = $metaQueries; ..\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402505", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Automatically refresh div id every 15 seconds with code snippet from .php file I want to automatically load song-history.php into the div id #song-history every 15 seconds via ajax without refreshing the actual template page in my child theme.\nsong-history.php is just a php file with a small code snippet fetching song history data via an api on a subdomain streaming music. This works as expected upon page load but I can not for the life of me get it to automatically refresh via ajax though, keeping the song history up to date as new songs are played. I've tried every google snippet possible.\nWhy won't this example, or any of the others I've tried work for me in WordPress? It seems really straightforward.\n<script type=\"text/javascript\">\nfunction loadlink(){\n    $('#song-history').load('song-history.php',function () {\n         $(this).unwrap();\n    });\n}\n\nloadlink(); // This will run on page load\nsetInterval(function(){\n    loadlink() // this will run after every 5 seconds\n}, 5000);\n</script>\n\nThanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402514", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Modify post slug before saving I would like to modify the slug of new posts by adding text before and after the original slug. The slug is then sent over an API via a plugin that hooks into save_posts and transition_post_status.\nadd_action( 'save_post', array( $this, 'action_save_post' ), 11 );\nadd_action( 'transition_post_status', array( $this, 'action_transition_post_status' ), 9, 3 );\n\nI was originally using a method as indicated here which uses save_post, however while this method did correctly change the post slug on the website, the old slug still got sent over the API.\nIn the method linked to above, I tried changing the save_post hook priority to 6 from 10, however that still didn't work.\nI then tried something totally new, which was this:\nfunction custom_permalink_slug( $original_slug, $slug, $post_id, $post_status, $post_type, $post_parent ) {\n    $support_post_type = array( 'deal' );\n    if ( in_array( $post_type, $support_post_type ) ) {\n        $rand = '';\n        $rands = get_the_terms($post_id, 'rand');\n        if (!empty($rands) && !is_wp_error($rands)) {\n            $rand = $rands[0]; // Only get first rand if there is more than one\n            $rand = sanitize_title( $rand->name );\n        }\n        if (empty( $rand ) || strpos(  $original_slug, $rand ) !== false) {\n            return; // No subtitle or already in slug\n        }\n        $slug = $rand . '-' . $slug . '-home';\n    }\n    return $slug;\n}\nadd_filter( 'pre_wp_unique_post_slug', 'custom_permalink_slug', 100, 6 );\n\nThis method seems like it changes the slug correctly, as it displays the new slug on the post edit screen, however in reality it is still using the old slug (presumably because it doesn't change the post_name meta field).\nAny ideas how to get this working correctly?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402515", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: admin-ajax.php 400 bad request I had created the ajax request\nadd_action('wp_ajax_test_action', 'test_action');\n\nit works fine until some point\n(Maybe i installed some plugin, but i had tried uninstall it but cant solve it)\nSo i try to add\nadd_action('wp_ajax_nopriv_test_action', 'test_action');\n\nthe request work again, but I don't understand\nwp_ajax_nopriv suppose to work for the user not logged in\nbut i am a logged in user, I tried to logged out then login again, but still need to add \"wp_ajax_nopriv\" to make it work.\nmy js code:\n//test ajax\n$('button#test').on('click', function(e){\n    e.preventDefault();\n    console.log('click');\n        $.ajax({\n            url: $ajax_url,\n            type: 'POST',\n            data: {\n                action: 'test_action',\n                value: \"send\"\n            },\n            success: function(data){\n                console.log( data);\n            },\n            error: function(data){\n                console.log('error');\n            }\n        });\n\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402517", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I display main query posts in random order using add_filter So I tried two methods to simply display the main query posts in random order - simple. I'm also trying to understand all this better.\n\n*\n\n*Using the_content add_filter, with my own instance of WP_Query class.\n\n\n*Using pre_get_posts add_filter.\nI couldn't get the add_filter to randomize the posts. I also have to mention, Elementor plugin is used as page builder, so it's serving the blog page. Perhaps it's overriding my filter? Or I'm missing something.\nAlso, what would be the best method to do this, if my attempts below are not ideal?\nMy code with both methods as follows:\nFIRST METHOD:\nadd_filter( 'the_content', 'thefunction',10 ,1 );\nfunction thefunction($content) {\n\n    $args = array(\n       'post_type' => 'post',\n       'orderby' => 'rand'\n    );\n\n    $mario_query = new  WP_Query( $args );\n\n    if ( $mario_query->have_posts() ) {\n        while ( $mario_query->have_posts() ) {\n            $mario_query->the_post();\n        }\n    } else { echo 'error: no posts retrieved.'; }\n\n    wp_reset_postdata();\n\n    return $content;\n}\n\n\nSECOND METHOD:\nadd_filter( 'pre_get_posts', 'thefunction');\nfunction thefunction($content) {\n\n    if ( ! is_admin() && $query->is_main_query() ) {\n        // Not a query for an admin page.\n        // It's the main query for a front end page of your site.\n \n            // Let's change the query using arguments.\n            $query->set( 'orderby', 'rand' );\n\n    }\n\n    return $content;\n}\n\n\n\nA: Should be add_action not add_filter when using pre_get_posts\nadd_action( 'pre_get_posts', 'thefunction');\nfunction thefunction($query) {\n\n    if ( ! is_admin() && $query->is_main_query() ) {\n        // Not a query for an admin page.\n        // It's the main query for a front end page of your site.\n \n            // Let's change the query using arguments.\n            $query->set( 'orderby', 'rand' );\n\n    }\n\n    return $query;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402521", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display all posts ordered by word count I have been using the following code on my other wordpress sites to show a list of all posts in the website oredered by word count. However, when I tried to use the same code in my new website wp 5.9 (I believe due to gutenberg) it shows the list and a number after the title, but the numbers are really small like 1 2 3, nowhere near the actual word count.\nrequire_once('wp-blog-header.php'); \n$args = array('post_type' => 'post', 'posts_per_page' => 500, 'post_status' => 'publish'); \n$results = get_posts($args);\n$nb_words = array();\n$title = array();\nforeach($results as $r){\n  $nb_words[] = str_word_count( strip_tags( $r->post_content ));\n  $title[] = $r->post_title;\n}\narray_multisort($nb_words, SORT_ASC, SORT_NUMERIC, $title);\necho \"<ol>\";\nfor ($i = 0; $i < sizeof($title); $i++) {\n  echo '<li>'.$title[$i] . ' => ' . $nb_words[$i] . '<br></li>';\n}\necho '</ol>';\n\nCould you suggest why the str_word_count doesn't work here?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402524", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: 200 Rewrite blog post links I have an self-hosted website and Wordpress where mywebpage.com is my main site and mywebpage.com/blog is my Wordpress Blog.\nI'm building an new website on AWS Amplify with more modern web languages, and because of that its not as easy to install wordpress in a project folder, and I don't want to lose my blog, so here what I've done so far:\nI wrote an 200 Rewrite rule on my new website (Let's call it newpage.com) so when I visit newpage.com/blog what I actually see is my Wordpress Blog page, I can even visit newpage.com/blog/interesting-post/and it would show me the correct post on my blog, all of this without an domain change on the browser.\nHere's my problem: The first page on my blog has links to popular posts, categories and etc. If i visit my blog trough my new domain and click on one of the posts there I'm redirected to mywebpage.com/popular-post, because the links are not following the 200 Rewrite Rule.\nIs there a way to change posts URL to follow the 200 Rewrite rule ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402531", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to pull all the contributer users records and order by Designation (which is users meta data)? I want to show all the contributors by the Designation. Following code is only pull the records and order by ID But I need to data order by Designation:\nfunction contributors() {\nglobal $wpdb;\n \n$authors = $wpdb->get_results(\"SELECT ID, user_nicename from $wpdb->users WHERE display_name <> 'admin' ORDER BY id DESC\");\n \nforeach ($authors as $author ) {\n \n    echo get_wp_user_avatar($author->ID);\n\n    the_author_meta('designation', $author->ID);\n\n    the_author_meta('fullname', $author->ID);\n\n    the_author_meta('company', $author->ID);\n\n    the_author_meta('address', $author->ID);\n\n    the_author_meta('phone', $author->ID);\n\n    }\n}\n\nCould you please help me out?\nThanks.\n\nA: I got the answer after went through WP_User_Query documentation. Following is the final query:\n$args = [\n    'role__not_in' => 'Administrator',\n    'meta_key' => 'designation',\n    'meta_query '=> [\n        'meta_key' => 'designation'\n    ],\n    'orderby' => array(\n        'meta_value'=>'ASC'\n    )\n];\n$my_user_query = new WP_User_Query( $args );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402540", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to find where an action is triggered? As far as I understand about the action hook, add_action is used to add callback functions to an exsiting action hook, which means, to make lines like\nadd_action('some_action_hook',function(){ // some function})\n\nwork, you need to have a line that says do_action some_action_hook somewhere in your code. Is this understanding right?\nI come across an action hook that I couldn't find where it is triggered: it is woocommerce's woocommerce_thankyou_bacs. I've done a thorough text search inside my website root folder for woocommerce_thankyou_bacs, the only line coming up is\nadd_action( 'woocommerce_thankyou_bacs', array( $this, 'thankyou_page' ) );\n\nin \\wp-content\\plugins\\woocommerce\\includes\\gateways\\bacs\\class-wc-gateway-bacs.php.\nI've also done a regex search for thankyou.*bacs, the result is same. I also search this action hook online and in Woocommerce's documentation, but didn't get much useful informations.\nThis itself is trivial, but I'd like to know:\n\n*\n\n*Is the understanding that where there is a do_action, there must be a corresponding add_action correct, or at least generally correct?\n\n*If 1) is correct, what is the solid way to find where do_action is for a certain action hook?\n\n\nA: In WooCommerce (my version v6.1.1) there is a file called /woocommerce/templates/checkout/thankyou.php and in line 79 you have trigger with dynamic payment method name so there is a place when each payment method do their magic\n<?php do_action( 'woocommerce_thankyou_' . $order->get_payment_method(), $order->get_id() ); ?>\n\nAnd answering your questions:\n\n*\n\n*The opposite. Where is add_action there is a corresponding do_action but i can be named dynamically just like we see it example above\n\n*There is no 100% way to find each do_action because all hook names depends on creativity of developer. So i can be hard to find at first glance just like example above\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402542", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: error_log PHP error log found. This file must not be in the production version of the theme. (wordpress theme check plugin) This appears when I check my theme but I can't see the error.log file. This is my wp-config configuration:\n// Enable WP_DEBUG mode\ndefine( 'WP_DEBUG', true );\n\n// Enable Debug logging to the /wp-content/debug.log file\ndefine( 'WP_DEBUG_LOG', true );\n\n// Disable display of errors and warnings\ndefine( 'WP_DEBUG_DISPLAY', false );\n@ini_set( 'display_errors', 0 );\n\n// Use dev versions of core JS and CSS files (only needed if you are modifying these core files)\ndefine( 'SCRIPT_DEBUG', true );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402543", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to rewrite the custom url in wordpress? I have tried to rewrite the url from\nhttp://example.com/club/?state=AL\nto\nhttp://example.com/club/AL\nAdded query vars and rewrite url in functions.php\nadd_filter('query_vars', 'my_query_vars', 10, 1);\n\nfunction my_query_vars($vars) {\n    $vars[] = 'club'; \n    return $vars;\n}\n\n\nfunction custom_rewrite_basic() \n{\n    add_rewrite_tag(\"%club%\", \"([a-z0-9\\-_]+)\");\n       add_rewrite_rule('^club/([a-z0-9\\-_]+)/?$', 'index.php?pagename=club&State=$matches[1]', 'top');\n\n}\nadd_action('init', 'custom_rewrite_basic');\n\n\nA: You can create an Apache .htaccess internal rewrite\nRewriteEngine on\nRewriteCond %{QUERY_STRING} ^state\\=AL$\nRewriteRule ^club/$ /club/AL? [L]\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402545", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Add, edit specific CPT with custom role Who can help me with roles and capabilities?\nI am stuck on this and I need some help.\nI want a role that only can add, remove edit etc. a specific CPT.\nWhat I have so far\nadd_action('init', function(){  \n    register_post_type( 'catalog',\n        array(\n            'capability_type'   => 'manage_catalog',\n            'labels' => array(\n                'name'          => 'Catalogus',\n                'add_new'       => 'Nieuw item',\n                'add_new_item'  => 'Nieuw item toevoegen',\n                'new_item'      => 'Nieuw item',\n            ),\n            'public' => true,\n            'query_var' => true,\n            'show_ui' => true,\n            'show_in_rest' => false,\n            'menu_icon' => 'dashicons-store',\n            'menu_position' => 2,\n            'supports' => array(\n                'title',\n                'thumbnail',\n            ),\n        )\n    );\n\nadd_action('load-themes.php', function(){\n    global $pagenow;\n\n    if('themes.php' == $pagenow && isset($_GET['activated'])){ \n        $role = get_role('subscriber');\n        $role->add_cap('manage_catalog'); \n    }else{\n        //Remove the capacity when theme is deactivate\n        $role = get_role('subscriber');\n        $role->remove_cap('manage_catalog');\n    }\n});\n\nWith the code above I can not see the CPT catalog in the menu on the admin side.\nWhat I am missing in my code?\n\nA: There's no such hook named load-themes.php in WordPress. One of the hooks you can use to add custom capabilities is after_setup_theme.\nAlso, there's no need to use 'themes.php' == $pagenow && isset($_GET['activated']) condition there. What are you trying to achieve this way?\nTry to use this code instead:\nadd_action( 'after_setup_theme', function() {\n  $role = get_role( 'subscriber' );\n\n  $singular = 'catalog';\n  $plural = 'catalogs';\n\n  $role->add_cap( \"edit_{$singular}\" ); \n  $role->add_cap( \"edit_{$plural}\" ); \n  $role->add_cap( \"edit_others_{$plural}\" ); \n  $role->add_cap( \"publish_{$plural}\" ); \n  $role->add_cap( \"read_{$singular}\" ); \n  $role->add_cap( \"read_private_{$plural}\" ); \n  $role->add_cap( \"delete_{$singular}\" ); \n  $role->add_cap( \"delete_{$plural}\" );\n  $role->add_cap( \"delete_private_{$plural}\" );\n  $role->add_cap( \"delete_others_{$plural}\" );\n  $role->add_cap( \"edit_published_{$plural}\" );\n  $role->add_cap( \"edit_private_{$plural}\" );\n  $role->add_cap( \"delete_published_{$plural}\" );\n} );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402546", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is it possible to use the MySQL's ORDER BY FIELD() clause as part of the pre_get_posts hook? I'm just curious if it is possible to use the ORDER BY FIELD() clause using the $query via pre_get_posts, or if I need to use a Custom Query for that.\nHere is the code I've tested but it didn't work:\n$query->set( 'orderby', 'FIELD(ID,5,3,4,1)' );\n\nThanks in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402553", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to create new users with JWT Auth Plugin? I'm trying to build an application using ReactJS and Wordpress Rest Api. I'm using JWT Auth Plugin and it works great but if I try to create a new user without being logged I get this error below:\n{\n  \"success\": false,\n  \"statusCode\": 403,\n  \"code\": \"jwt_auth_no_auth_header\",\n  \"message\": \"Authorization header not found.\",\n  \"data\": []\n}\n\nI understand that I need a token to make POST requests but if it's a new user that is trying to register on my application, how can I generate a token for a user that doesn't exist yet?\nHere is the code of my user_post.php:\n<?php \n\nfunction api_user_post($request){\n\n    $email = sanitize_email($request['email']);\n    $senha = $request['senha'];\n    $nome = sanitize_text_field($request['nome']);\n    $user_exists = username_exists($email);\n    $email_exists = email_exists($email);\n\n\n    if(!$user_exists && !$email_exists && $email && $senha) {\n        $user_id = wp_create_user($email, $senha, $email);\n        \n        $response = array(\n            'ID' => $user_id,\n            'display_name' => $nome,\n            'first_name' => $nome,\n            'role' =>  'professor'\n        );\n\n        wp_update_user($response);   \n        \n\n    }else{\n        $response = new WP_Error('email', 'Email j\u00e1 cadastrado.', array('status' => 403) );\n    }\n    return rest_ensure_response($response);\n}\n\nfunction resgister_api_user_post(){\n    register_rest_route('api', '/usuario', array(\n        array(\n            'methods' => WP_REST_Server::CREATABLE,\n            'callback' => 'api_user_post',\n        ),\n    ));\n}\n\nadd_action('rest_api_init', 'resgister_api_user_post');\n\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402555", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Solution to White Screen of Death that does not require Web Server access? I'm working on a live website, updated a plugin and got the dreaded White Screen of Death. I know exactly how to resolve the problem; simply deactivate or delete the plugin I upgraded.\nThe problem is I cant access the WordPress Dashboard to deactivate or delete the plugin. The WSD occurs in /wp-admin aswell. To make things worse the owner doesn't know their web server login credentials so I cannot just FTP or CPanel in and delete the plugin that way.\nIs there a way you know of to overcome the WSD that doesn't require web server access?\n\nA: No, without access to WP Admin you would need to rename the folder, but as you have no access to the filesystem this option is not feasible either.\nThe only remaining option is to connect to the database directly, assuming you know the login details from wp-config.php and the database is configured to allow this. If you do not know the details or the database is configured to not allow this then this option is not available to you. If it is though, then you can delete the activated plugins options in the options table.\nOtherwise, you will need to speak with your host to regain access, no technical avenues exist to recover your site unless you can put PHP files up or modify the filesystem in some way.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402556", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I have two or more WordPress Pro (paid) themes that form a single website? I am creating a social network website with Buddyboss as the central theme. I also want to have the freelancing features that Workreap offers. Other plugins like Gamipress also provide some additional functions which must be shared for both themes.\nI want people to register only once on the main site, and if they go to the freelancing segment/page, although within a different theme, the experience remains seamless.\nIn other words, they don't need to register again in Workreap; Also their profile name/picture, points earned in Gamipress, membership level, etc. in the Buddyboss theme is retained (as much as possible).\nIn fact, I don't want to treat the Workreap site as a completely separate and disconnected site.\nIs it possible to install the Workreap theme on a subdomain? Should I use the same database for both the main domain and subdomain?\nOr should I do something else altogether?\nAny answer to any part is appreciated.\nThanks a lot!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402558", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Assigning a capability to a user role (code check) I wrote this piece of code to add manage_options capability to my shop_managers, and it does work. I wanted to ask before i move this code to my live site, if the function is called in the right place.\nI thank you in advance!\nadd_action('init', 'activate_cap_shopmanagers');\nfunction activate_cap_shopmanagers() {\n        // get the shop manager role's object from WP_Role class\n        $shopmanager = get_role( 'shop_manager' );\n \n        // add the capability\n        $shopmanager->add_cap( 'manage_options' );\n    }\n\nEdit\nregister_activation_hook( __FILE__, 'my_plugin_activation' );\nfunction my_plugin_activation() {\n  add_option( 'my_plugin_activation','just-activated' );\n  $shopmanager = get_role( 'shop_manager' );\n  $shopmanager->add_cap( 'manage_options' );\n}\n\nadd_action( 'admin_init','my_plugin_initialize' );\nfunction my_plugin_initialize() {\n    if( is_shop_manager() && get_option( 'my_plugin_activation' ) == 'just-activated' ) {\n    delete_option( 'my_plugin_activation' );\n    }\n}\n\nis_shop_manager() is a function i have in my functions.php\nfunction is_shop_manager() {\n    global $current_user;\n    $user = wp_get_current_user();\n    if ( isset( $user->roles[0] ) && $user->roles[0] == 'shop_manager' ) {\n        return true;    // when user is shop manager\n    } else {\n        return false;   // when user is not shop manager\n    }\n}\n\n\nA: Your use of the init hook means that the cap is set on every page load.\nA better approach is to write a small plugin and set the cap once by using the plugin activation hook. And remove it using the deactivation hook.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402561", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom blog post summary on blog index page Is it possible to have a custom function to truncate the contents of a defined DIV on a blog post page to use as the summary on the blog index page. So rather than using $the_content or $the_excerpt - Is it possible to create $the_customContent and have some PHP which checks the blog post page and collects the content of the div with class \"ThisIsTheContentToUse\" - reason for this is that my blog posts have content on the page above the content I want to be included as the blog summary on the blog index page - so either want to tell WP to ignore those blocks of content, or, probably easier - just tell WP where the content to truncate is - e.g. in the \"ThisIsTheContentToUse\" div... possible? If so... how? Can't seem to find anything online that defines this custom functionality - surely I can't be the first person to want to do this...?\nWould apply_filters make this possible? https://developer.wordpress.org/reference/hooks/the_content/\nSo, The blog post is structured as:\n<div class=\"headerArea\">\n<h2>The title is here</h2>\n<ul>\n</div>\n<div class=\"bullets\">\n<li>Bullet 1</li>\n<li>Bullet 2</li>\n<li>Bullet 3</li>\n</ul>\n</div>\n<div class=\"ThisIsTheContentToUse\">\n<p>The content starts here</p>\n</div>\n\nSo, currently with the basic get_the_content - the result is:\n\"The title is here Bullet 1 Bullet 2 Bullet 3 The content starts here\"\nBut what I want is just the content of the \"ThisIsTheContentToUse\" div - so it would be:\n\"The content starts here\"\n\nA: I think the easiest way is using the Excerpt field in the editor or add a custom field to enter your summary and then filter https://developer.wordpress.org/reference/hooks/the_excerpt/ to return the right text.\nBecause recognizing automatically the right div will force to parse HTML, and it's more complicated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402564", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom Price for WooCommerce How can I have a product in WooCommerce with a base price of $ 20 but the user can buy that product at the desired price, for example the user can buy above the base price or below the base price, thank you for your help, how can I do this? I have the ability.\n\nA: Is this the \"Name your Price\" behaviour you need ?\nhttps://woocommerce.com/products/name-your-price/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402566", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Monitor all the queriers executed by my website I am extending the functionalities of one plugin. For the sake for this I would really like to know if there is anyway I could view all the queries that are done to my database live??\nThank you in advanced\n\nA: The plugin Query Monitor will show all queries done on a single page.\nAlso there is the query filter that you could use to log queries as they are made.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402577", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom endpoint filtering post by custom taxonomies I am trying to create a custom endpoint by custom taxonomies, I have already created another for the categories and it works well, however there is something I cannot solve with this\nfunction get_latest_posts_by_term($request) {\n\n    $args = array(\n            'term' => $request['term_id']\n    );\n\n    $posts = get_posts($args);\n    if (empty($posts)) {\n    return new WP_Error( 'empty_term', 'There are no posts to display', array('status' => 404) );\n\n    }\n\n    $response = new WP_REST_Response($posts);\n    $response->set_status(200);\n\n          $data = [];\n          $i = 0;\n\n    foreach($posts as $post) {\n        $data[$i]['id'] = $post->ID;\n        $data[$i]['title'] = $post->post_title;\n        $data[$i]['excerpt'] = $post->post_excerpt;\n        $data[$i]['date'] = $post->post_date;\n        $data[$i]['content'] = $post->post_content;\n        $data[$i]['slug'] = $post->post_name;\n        $data[$i]['author'] = get_the_author_meta('display_name', $post->post_author);\n        $data[$i]['category'] = get_the_category( $post->ID);  \n        $data[$i]['theme'] = get_the_terms($post->ID,'theme');\n        $data[$i]['Rute-geografic'] = get_the_terms($post->ID,'rute-geografice');\n        $data[$i]['featured_image']['thumbnail'] = get_the_post_thumbnail_url($post->ID, 'thumbnail');\n        \n        $data[$i]['post_tags'] = get_the_terms($post->ID,'post_tag');\n        \n        \n        \n        $i++;\n    }\n\n    return $data;\n}\n\nadd_action('rest_api_init', function() {\nregister_rest_route( 'wl/v1', 'posts/term/(?P<term_id>\\d+)',array(\n                'methods'  => 'GET',\n                'callback' => 'get_latest_posts_by_term'\n      ));\n    \n});\n\n\nA: Solved!!! A friend of my found the way\nfunction get_latest_posts_by_term($request) {\n\n    $parsed_args=[\n    'numberposts'      => 20,\n    'orderby'          => 'date',\n    'order'            => 'DESC',\n    'post_type'        => 'post',\n    'tax_query' => array(\n        array (\n            'taxonomy' => $request['slug'],\n            'field' => 'slug',\n            'terms' => $request->get_param('name'),\n        )\n    ),\n    ];\n    \n    $get_posts = new WP_Query;\n    $posts= $get_posts->query( $parsed_args );\n    //$posts = get_posts($args);\n    if (empty($posts)) {\n    return new WP_Error( 'empty_terms', 'There are no posts to display', array('status' => 404) );\n    }\n\n    $response = new WP_REST_Response($posts);\n    $response->set_status(200);\n\n          $data2 = [];\n          $i = 0;\n\n    foreach($posts as $post) {\n        $data2[$i]['id'] = $post->ID;\n        $data2[$i]['title'] = $post->post_title;\n        $data2[$i]['excerpt'] = $post->post_excerpt;\n        $data2[$i]['date'] = $post->post_date;\n        $data2[$i]['content'] = $post->post_content;\n        $data2[$i]['slug'] = $post->post_name;\n       \n        $i++;\n    }\n\n    return $data2;\n}\n\nadd_action('rest_api_init', function() {\n register_rest_route( 'wl/v1', 'posts/terms/(?P<slug>[a-zA-Z0-9-]+)',array(\n                'methods'  => 'GET',\n                'callback' => 'get_latest_posts_by_term'\n      ));\n    \n});```\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402579", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get Post Title from different post type based on current loops post_parent using So take a look at this wp_insert_post. The post_parent contains the ID of the post_type 'courses' that I want to return the post_title of.\n $enroll_data = apply_filters('tutor_enroll_data',\n                             array(\n                                 'post_type'     => 'tutor_enrolled',\n                                 'post_title'    => $title,\n                                 'post_status'   => $enrolment_status,\n                                 'post_author'   => $user_id,\n                                 'post_parent'   => $course_id,\n                             )\n                            );\n\n// Insert the post into the database\n$isEnrolled = wp_insert_post( $enroll_data );\n\nSo I'm creating a query with WP_Query but how do I....I guess \"customize\" the array returned?\n$query_args = array(\n    'author' => current_user_id(),\n    'post_type' => 'tutor_enrolled',\n    'post_status' => 'any',\n);\n\n// The Query\n$the_query = new WP_Query( $query_args );\n\n// The Loop\nif ( $the_query->have_posts() ) {\n    while ( $the_query->have_posts() ) {\n        $the_query->the_post();\n// I need to take post_parent\n    }\n    /* Restore original Post Data */\n    wp_reset_postdata();\n} else {\n    // no posts found\n}\n\nI need to get the post parent and look up that specific post and get the title and ID and somehow return that....maybe as post meta?\ntutor_enrolled is just a \"text string\" meaning the Title is what happened for this data (ie. Course Enrolled). It doesnt have the actual course title or any course data.\nI'm also trying to use all of this as a custom query in elementor so I can display the TutorLMS courses the current user is enrolled in.\n\nA: \nand somehow return that....maybe as post meta?\n\nI don't understand that , but you can use get_post_meta() to retrieve a post meta.\n\nI need to get the post parent and look up that specific post and get the title and ID\n\nAs for the ID, that would be the post parent itself, but correct me if I'm wrong or that you meant something else?\nAs for getting the current post's parent and the parent post's title (and other data), you can use get_post_field() and get_post(), like so:\n// Get the parent post ID.\n$post_parent = get_post_field( 'post_parent' );\n// Alternatively, you could add global $post; at the top in your code and just\n// use $post->post_parent in your loop.\n\n// Get the parent post object.\n$parent_post = get_post( $post_parent );\n\n// And display the parent post's title..\necho $parent_post->post_title;\n// .. or use echo get_the_title( $parent_post )\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402581", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Php page with filters for custom fields I have everal custom fields for my posts and I have created pages where I filter them by only 1 field by their value, for example\n\nField name: Near   Value: City name\n\nI have created a php template page, which I have placed inside my theme folder which has query to show all posts with specific city name.\nNow I want to create a search place, which contains all the city names and suggests them to the user when he starts typing, and then he can choose the city name and one or two other custom field filters. I know how to create this, but I don't know hot to pass the filters to the custom php page template.\nI want to sent the filters by either _GET or _POST, whichever is more convinient to a newly created php inside my theme folder. How do I properly send the values to that page, so that there I can access the values and create a wp query with the filters?\n\nA: I will share how I achieved to implement what I consider to be an advanced custom search using Wordpress out-of-the-box functionalities and ACF, without custom PHP scripts that are questionable.\n\n*\n\n*Creating a custom post type\n\n*Adding a custom field to the custom post type\n\n*Creating the search form\n\n*Outputting the search results\n\nCustom Post Type:\nFor the first step it is relatively easy, create your own custom post type, within your functions.php file or somewhere else:\n\nResources:\nhttps://www.codexworld.com/wordpress-custom-post-types-without-plugin/\n\n  function product_init() {\n        $labels = array(\n            'name' => 'Products',\n            'singular_name' => 'Product',\n            'add_new' => 'Add New Product',\n            'add_new_item' => 'Add New Product',\n            'edit_item' => 'Edit Product',\n            'new_item' => 'New Product',\n            'all_items' => 'All Products',\n            'view_item' => 'View Product',\n            'search_items' => 'Search Products',\n            'not_found' =>  'No Products Found',\n            'not_found_in_trash' => 'No Products found in Trash',\n            'parent_item_colon' => '',\n            'menu_name' => 'Products',\n        );\n    \n        $args = array(\n            'labels' => $labels,\n            'public' => true,\n            'has_archive' => true,\n            'show_ui' => true,\n            'capability_type' => 'post',\n            'hierarchical' => false,\n            'rewrite' => array('slug' => 'product'),\n            'query_var' => true,\n            'menu_icon' => 'dashicons-randomize',\n            'supports' => array(\n                'title',\n                'editor',\n                'excerpt',\n                'trackbacks',\n                'custom-fields',\n                'comments',\n                'revisions',\n                'thumbnail',\n                'author',\n                'page-attributes'\n            )\n        );\n        register_post_type( 'product', $args );\n        register_taxonomy('product_category', 'product', array('hierarchical' => true, 'label' => 'Category', 'query_var' => true, 'rewrite' => array( 'slug' => 'product-category' )));\n    }\n    \n    add_action( 'init', 'product_init' );\n\n\nCustom fields:\nCreating a custom field without ACF was more complicated than I expected, use Advanced Custom Fields plugin instead, and create a custom field applied to 'Type of Content' > 'Product' - or either custom post type you have. Create the fields such as: 'City', etc.\n\nSearch form:\nCreate a file called searchform.php within your template's folder, and it will contain a simple <form>:\n<form id=\"searchform\" method=\"get\" action=\"<?php echo esc_url( home_url( '/' ) ); ?>\">\n    <input type=\"text\" class=\"search-field\" name=\"s\" placeholder=\"Search\" value=\"<?php echo get_search_query(); ?>\">\n    <input type=\"hidden\" name=\"post_type[]\" value=\"product\" />\n    <input type=\"submit\" value=\"Search\">\n</form>\n\n\nResources:\nhttps://wordpress.stackexchange.com/a/17119/219065\nhttps://artisansweb.net/create-custom-search-form-wordpress/\n\n\nResults:\nWithin the search.php file, I go the following code:\n$args = array(\n    'post_type'  => 'product',\n    'meta_query' => array(\n        array( 'key' => 'city', 'value' => 'Moscow', 'meta_compare' => 'LIKE' ),\n        array( 'key' => 'city', 'value' => array('Edinburgh', 'Moscow'), 'meta_compare' => 'IN' ),\n        'relation' => 'OR'\n    )\n);\n\n$the_query = new WP_Query( $args );\n\nif ( $the_query->have_posts() ) {\n    while ( $the_query->have_posts() ) : $the_query->the_post();\n        echo get_the_title();\n    endwhile;\n} else {\n echo \"No posts\";\n}\n\nwp_reset_postdata();\n\nResources:\nhttps://www.smashingmagazine.com/2016/03/advanced-wordpress-search-with-wp_query/\nhttps://rudrastyh.com/wordpress/meta_query.html\nMeta_query compare operator explanation\n\n\n\npostscript. You will have to tweak and adapt a big portion of the code because it is of course not ready to handle all situations where you are going to be using the search function. And I found many elements in the code unnecessary and incomplete (check the resources for more), but it serves just as an example and I hope it helps you. \n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402587", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding preference buttons to main nav that persist via user sessions. (Woocommerce) I would prefer not installing a plugin to achieve this and I don't mind coding something myself.\nI'm simply unsure of the \"wordpress-y\" way to go about it.\nSo here goes,\nEach one of the products has four variations, always the same, they are the region selection and the prices are different based on those.\nHowever, I would like to have a dropdown in the main nav of the site where customers can specify what variation (region) price is displayed across the site for the whole duration of their session.\nSo it's a two-part thing, I would like to know the ideal method of saving this user preference in the $_SESSION (I'm assuming) and then retrieving this information when displaying prices by variation, I already have a hook to handle that in the category pages but at the moment it defaults to just a hardcoded region, instead it should be user preference OR default of america.\nThis information does not need to be persisted to disk or DB, it can just be in the session.\nThank you in advance, and please let me know if anything needs clarification.\n/edit\nJust noticed the wc offtopic tag, but although yes it's somewhat related to woocommerce, storing a value in the user session isn't a wc specific thing at all. It's a user session question, wc is just framing for the use case.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402588", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I was adding the custom CSS & JS using hooks and there was this error even I didn't touch the wp-class-hook Warning: call_user_func_array() expects parameter 1 to be a valid callback, function 'skfans_wp_enqueue_script()' not found or invalid function name in C:\\xampp\\htdocs\\plugin\\wp-includes\\class-wp-hook.php on line 306:\nadd_action('wp_enqueue_scripts','skfans_wp_enqueue_script()'); \n    function skfans_wp_enqueue_script() {\n        wp_enqueue_style('skfans_dev_plugin', plugin_dir_url(__FILE__).\"assets/css/style.css\");\n        wp_enqueue_script('skfans_dev_script',plugin_dir_url(__FILE__).\"assets/js/custom.js\",true);\n    }\n\n\nA: The text in the second parameter is not code to run, it is the name of a function. That is why it does not and cannot work. The warning is PHP telling you that no function with that name exists. Or more specifically that is it an invalid function name.\nA function with () in its name is not possible. For your code to work you would need a function named skfans_wp_enqueue_script() but that's impossible because it would mean your function looks like this:\nfunction skfans_wp_enqueue_script()() {\n\nThis would generate syntax errors and crash immediately.\nTo clarify the difference, this is what you believed it meant:\nadd_action('action/event name', 'run this PHP code inside these quotes when action/event happens');\n\nWhat it actually means:\nadd_action('action/event name', 'A thing to call when the action/event happens' );\n\ne.g.\nadd_action( 'save_post', 'wpdocs_my_save_post' );\nfunction wpdocs_my_save_post() {\n    // .....\n\nFurther reading:\n\n*\n\n*https://www.php.net/manual/en/language.types.callable.php\n\n*https://developer.wordpress.org/reference/functions/add_action/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402591", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: set automatically email address for WordPress users User registration on my site is done with a mobile number.\nI want the email with the structure \"{userid}@example.com\" to be registered automatically after user registration.\nHow can I do this?\nplease guide me.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402594", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: An extra ' is displayed in the title I've found a string that's showing the posts title - blogname as title in the browser, but it's adding an extra '\n\nThis is the code I'm using:\n<title><?php wp_title(\u2018 | \u2018, \u2018echo\u2019, \u2018right\u2019); ?>  - <?php bloginfo(\u2018name\u2019); ?></title>\n\nI can't see any extra ' so I don't know what's wrong.\n\nA: Those look like smart apostrophes to me. They have a curve on theme. Try:\n<title><?php wp_title(' | ', 'echo', 'right'); ?> - <?php bloginfo('name'); ?></title>\n\nOtherwise post what you have around that php section too.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402601", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Can't split the_title() by white space I am having issues splitting the_title() by white space in my template.\n$title_split = explode(\" \", trim(the_title()));\n\nand (from here: https://stackoverflow.com/questions/23206953/split-string-by-white-space)\n$words = preg_split('/\\s+/', $string, -1, PREG_SPLIT_NO_EMPTY);\n\n(To be clear I'm not using preg as was shown but customized for my use, it was just the first thing I found when looking for a \"proper\")\nBoth produce an empty array on the phrase 2022 Theme Challenge.\nI have also made sure the output uses white spaces, which it does. The template produces:\n<h2 class=\"post-title\">2022 Theme Challenge</h2>\n\nI am trying to replace the first word in a title with encapsulating <span> tags to style it greeen.\n\nA: The first way you tried should work if you use get_the_title() instead. It\u2019s because get_the_title returns the title, whereas the_title() function echos the title by default.\n$title_split = explode(\" \", trim(get_the_title()));\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402603", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I fix this: syntax error, unexpected ':', expecting ')' Here is the line that is effecting my site from loading...I am just getting a blank page for my site.  Please help as my business site is obviously down.  Thank you in advance to whomever can help me.\n$bg = (!$bgimage == '') ? 'style=\"background-image:url'(\"\".$bgimage[url].'\")' : '';\n\nA: Your code:\n$bg = (!$bgimage == '') ? 'style=\"background-image:url'(\"\".$bgimage[url].'\")' : '';\n\nThere's a confusion with the quote marks. You're closing your ' too early, but it's really hard to see in a construction like this. (Also, the array index needs to be wrapped in quotes, either single or double.)\n$bg = (!$bgimage == '') ? 'style=\"background-image:url(\"'.$bgimage['url'].'\")' : '';\n\nmight clear up the PHP error, but I'm not sure it'll still do what you want it to. There's still some confusion with quote marks in the CSS; also, is $bgimage a string or an array?\nI'd recommend not using the ternary operator, in this case, to make the code more readable.\n$bg = '';\nif ( ! empty( $bgimage ) ) {\n    $bg = 'style=\"background-image:url(\\'' . $bgimage['url'] . '\\')\";\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402604", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there any way we can restore the \"Additional CSS\" after being erased? My additional CSS got erased. how do I get that back?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402612", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Open login logo URL in new tab Using add_filter('login_headerurl', fn() => FRONTEND); i was able to change the login logo URL.\n\nBut i couldn't find a way to make it open in a new tab.\nOr in other words, how can i add target=\"blank\" to the login Logo link?\nKinda like:\n<h1><a href=\"https://ex.com/\" \"title=\"Some title\" target=\"_blank\">Site Name</a></h1>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402614", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Please help me clear my confusions about WordPress I am building a website in WooCommerce.\nWhat is most efficient way to replace the original theme site template pictures? Do we replace them with same size and pixel pictures and nothing wrong will happen to allignment? For example if main page header picture of a product is 1920 * 1000 then we crop pic to this size and replace it with ELEMENTOR? And then keep going on with all the pictures in the template to make it yours\nThank you\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402615", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get the records from start with A to G in php and mysql I have to show the records from A to G resutls from database. also tried the following code to show. Is there any mysql function available or should we use php to customize it.\nMysql query\nSELECT *  FROM `wp_postmeta` WHERE `meta_key` = 'state' AND `meta_value` LIKE 'A%G'\n\nExpected output\n    States start from A thru G  States H thru J\nAlabama                              Hawaii\nGeorgia                           Louisiana\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402619", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Media Import, images not in Media Library I have performed two imports using the WP Importer plugin, one of a custom post type and the 2nd of the Media Library. Both imports appear to work, on fact a second attempt to import the Media Library gives \"File Exists\" messages.\nIn the individual post the featured image is showing, with thumbnail, with the correct, updated URL.  In cPanel, all the images are in place with correct folder structure and thumbnails\nBut in the media library, there is nothing showing.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402621", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Widgets are not displaying in the admin panel I am using WordPress, I have an issue with the widget. I am not getting the widget in the WordPress admin panel.\nI am getting the error in the console\n\nUncaught (in promise) TypeError: null has no properties\n/wp-includes/js/dist/edit-widgets.min.js?ver=7ac5bb27bb662c888b918bc66c0a0a65:2\n\nAny idea how to solve this?\nI have disabled my all the plugins but still getting the error in the console.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402625", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: /wp-json/wp/v2/posts/?app=3 is returning random scripts tags I am so new to the world of API calling and apparently there is a script called in post API that is not letting me call them properly please see this link:\nhttps://acciers.com/wp-json/wp/v2/posts/?app=3\nHow can I remove this script tag from this file?\n<script type=\"text/javascript\">\n            window._nslDOMReady = function (callback) {\n                if ( document.readyState === \"complete\" || document.readyState === \"interactive\" ) {\n                    callback();\n                } else {\n                    document.addEventListener( \"DOMContentLoaded\", callback );\n                }\n            };\n            </script><script type='text/javascript' src='https://acciers.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>\n<script type='text/javascript' src='https://acciers.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402627", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Authenticate Subdomain I have a sub-domain which I'm trying to restrict to authenticated Wordpress users but the authentication isn't working.\nI've tried the following code:\nglobal $current_user; \nwp_get_current_user(); \nif ( is_user_logged_in() ) { \n    echo 'Username: ' . $current_user->user_login . \"\\n\"; \n    echo 'User display name: ' . $current_user->display_name . \"\\n\"; \n    } else { \n    wp_loginout(); \n    } \n\nThis works if I use the URL domain.com/intranet/page.php but not on intranet.domain.com/page.php\nHow can I get it to work for subdomains?\nI've tried adding the following to wp-config.php but that hasn't done anything:\ndefine('COOKIE_DOMAIN', '.domain.com'); // Used to authenticate subdomains\ndefine('COOKIEPATH', '/'); \n\nAny ideas?\n\nA: Ensure that COOKIEHASH has the same value for both, e.g.:\ndefine( 'COOKIEHASH', md5( 'https://yourdomain.com' ) );\ndefine( 'COOKIE_DOMAIN', '.yourdomain.com' );\n\nSee https://wordpress.stackexchange.com/a/264490/736\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402630", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I create new CustomPostType record using wp.api.collections? I would be very grateful for your help. Already racked my brain for today!\nSo, I used the CPT UI plugin and created my custom post type with it. Immediately when setting it up, I enabled RestAPI support (I always do this), and I also used the default WP_REST_Posts_Controller setting.\nWhen I give the command to add the default Post\nvar review = new wp.api.models.Post( { title: 'Test post' } );\nreview.save();\n\neverything is fine!\nBut when I try to specify my registered Review type instead of Post, I get an error\nUncaught (in promise) TypeError: wp.api.models.Review is not a constructor\nHow can I solve this problem? Thank you in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402631", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is it possible to access admin-ajax.php using PHP? This might be a weird question, but I need to access admin-ajax.php using PHP.\nOne of my plugins creates a PDF that is displayed only in admin-ajax.php, I want to download this PDF using a piece of PHP code. Now I have already figured how to download a PDF and place it in the right folder, but when I try to reach admin-ajax.php inside my code it only returns \"0\".\nI think this is because the PDF can only be reached by a logged-in user. So there is my question, is there anyway I can access admin-ajax.php using PHP?\nHere is the code I am currently:\nadd_action( 'woocommerce_payment_complete', 'so_payment_complete' );\n    function so_payment_complete( $order_id ){\n        // Static data for debugging\n        $url     =   'https://example.com/wp-admin/admin-ajax.php?action=wcpn_export&request=get_labels&shipment_ids=124687111&_wpnonce=2da91e54ad';\n\n    $arrContextOptions=array(\n      \"ssl\"=>array(\n        \"verify_peer\"=>false,\n        \"verify_peer_name\"=>false,\n      )\n    );\n\n    // Get the pdf data\n    $pdf_data = file_get_contents($url, false, stream_context_create($arrContextOptions));\n\n    if($pdf_data) :\n      //Save PDF on server\n      $pdf  = file_put_contents(__DIR__.\"/labels/$order_id.pdf\", $pdf_data);\n\n    else :\n\n      print_r(\"Error!\");\n\n    endif;\n\n}\n\n\nA: It returns a 0 because that AJAX handler is only meant for logged in requests, and no non_priv handler was registered. 0 is the final fallback.\nAttempt #1\nWhile you could register your own AJAX handler that calls the function that generates the PDF and put it in a mini plugin, there's an alternative:\nadd_action(\"wp_ajax_no_priv_wcpn_export\", function() {\n    do_action( \"wp_ajax_wcpn_export\" );\n} );\n\nThe code at the other end may not like this as it might be relying on the user being logged in, or maybe it doesn't check, either way this will trigger the logged in handler for that AJAX when the logged out is requested. A simple workaround.\nThis leads to the next problem:\nhttps://github.com/postnl/woocommerce/blob/master/includes/admin/class-wcpn-export.php#L232-L254\nPostNL performs a number of checks, that you're logged in, that the nonce is valid, that the logged in user has the appropriate access rights, etc.\nAttempt #2\nLets use inheritance! Lets create a new class, lets call it Martin_Export:\nclass Martin_Export extends WPCN_Export {\n...\n}\n\nOur class will do 2 things and only 2 things.\nFirst it will have a brand new export function. We'll copy paste the one from WCPN and remove those checks at the top. We won't copy paste anything else, just the export function.\nSecond, I'd recommend adding a new check for security, lets say a password parameter with a secret value only your PHP file knows. E.g. if ( $_GET['foo'] !== 'bar' ) { wp_die('get outta here'); }\nThen, we have a line at the end after the class or somewhere else that hooks the new version of export into admin-ajax.php for logged out users like this:\n$martin_export = new Martin_Export();\nadd_action(\"wp_ajax_no_priv_wcpn_export\", [ $martin_export, 'export' ] );\n\nNow when you make an AJAX request and you aren't logged in, it'll run your slightly tweaked version instead. Just remember to add the secret parameter we added to your PHP script\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402633", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Merge PDF files from post custom fields(ACF) into one PDF file and respond back the created PDF file, Wordpress(AJAX Request) I am using Advanced Custom Fields plugin(free version) for attaching 3 different pdf files to a single post.\nAfter displaying a list of posts on a template, with a button click I am making an AJAX Request to get the files of all displayed posts.\nSince every post has 3 PDF files, I want to merge all these files of all posts to a single PDF file and download that single file.\nWhat I did so far :\nAJAX Request on button click:\nfunction merklisteDownload() {\n    window.event.preventDefault()\n    var m = JSON.parse(window.sessionStorage.getItem('merkliste_items')) || []\n    var ids = []\n    if (m.length > 0) {\n        m.forEach(element => {\n            ids.push(element.id)\n        });\n    }\n    $.ajax({\n        type: 'POST',\n        url: '<?php echo admin_url('admin-ajax.php'); ?>',\n        dataType: \"json\",\n        data: {\n            action: 'get_post_files',\n            ids: ids\n        },\n        success: function(response) {\n            console.log(response.data)\n        },\n        error: function(error) {\n            console.log(error)\n        }\n    });\n}\n\nAnd admin-ajax.php code:\n    function get_post_files(){\n    $data = [];\n    foreach ($_POST['ids'] as $post_id) {\n        array_push($data, [\n            'id'                        => $post_id,\n            'title'                     => get_the_title($post_id),\n            'category'                  => get_the_category($post_id)[0]->name,\n            'front_image'               => get_field('front_image', $post_id)['sizes']['large'] == true ? get_field('front_image', $post_id)['sizes']['large'] : null,\n            'back_image'                => get_field('back_image', $post_id)['sizes']['large'] == true ? get_field('back_image', $post_id)['sizes']['large'] : null,\n            'technische_daten'          => get_field('technische_daten', $post_id)['url'], //file\n            'lichttechnische_parameter' => get_field('lichttechnische_parameter', $post_id)['url'], //file\n            'reach_zertifikat'          => get_field('reach-zertifikat', $post_id)['url'],  //file\n        ]);\n    }\n    wp_send_json_success($data);\n    wp_die();\n}\n\nadd_action('wp_ajax_get_post_files', 'get_post_files');\nadd_action('wp_ajax_nopriv_get_post_files', 'get_post_files');\n\nEverything is working till now, I am able to get the file URLs of each post, but I dont know how to merge these files into one and return the file as AJAX Response, then download that file.\nAny help?\nBest regards.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402634", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Database entry removed on browser refresh, Ajax PHP jQuery I have a form that updates columns in a database table on submit of a form via ajax. Everything works great, the database table columns get the information however once the browser is refreshed the information is removed from the database.\nPHP is set to execute the database update if a meta_value isn't present but the meta_value is in the database as it's created when the form is submitted as well.\nI would like the information to remain in the database until or unless the meta_value has been removed or isn't present.\nAny insight is appreciated.\nPHP\nadd_action('wp_ajax_hide_this', 'hide_this_by_id');\nadd_action('wp_ajax_nopriv_hide_this', 'hide_this_by_id');\nfunction hide_this_by_id()\n{\n    global $wpdb;\n    $wpdbPrefix = $wpdb->prefix . 'swpm_members_tbl';\n    $postdVlaue2 = $_POST['hidebtn2'];\n    $this_user = $_POST['thisuser'];\n    $this_num = $_POST['thisnum'];\n\n\n    if (is_user_logged_in()) {\n        $member_id = SwpmMemberUtils::get_logged_in_members_id();\n\n        $query = \"SELECT * FROM \" . $wpdb->prefix . \"swpm_members_tbl WHERE member_id = %d\";\n        $userData = $wpdb->get_row($wpdb->prepare($query, $member_id));\n\n        $membership_levels = $userData->membership_level;\n\n        $labelID4 = $membership_levels;\n\n        $insertdisUr = $wpdb->update( $wpdbPrefix, array( 'this_user' => $this_user), array( 'member_id' => $member_id));\n        $insertdisId = $wpdb->update( $wpdbPrefix, array( 'this_id' => $this_num), array( 'member_id' => $member_id));\n\n    } else {\n        $not_loggedin = 1;\n    }\n\n    if ($labelID4 == 10 ) {\n        $userlvlMeta2 = 1;\n        $alredyclick3 = get_user_meta($member_id, 'hidden-info', true);\n        if (empty($alredyclick3) &&  $postdVlaue2 == 1) {\n            $insertdisUr;\n            $insertdisId;\n            $alredyclick3 = 1;\n        }\n    }\n\n    $return4 = array(\n        'hIdethis2'  => $this_hide2,\n        'userlvlMeta2' => $userlvlMeta2,\n        'userlvlNolog' => $not_loggedin,\n    );\n\n    echo json_encode($return4);\n\n    die();\n}\n\njQuery\nfunction doAjaxRequest4(hidebtn2,getthisInfo,getthisInfo2) {\n\n    jQuery.ajax({\n        url: ajax_sib_front_object.ajax_url,\n        data: {\n            'action': 'hide_this',\n            'thisuser': getthisInfo,\n            'thisnum': getthisInfo2,\n            'hidebtn2': hidebtn2\n        },\n        dataType: 'JSON',\n        type: \"post\",\n        success: function (data) {\n            console.log(data.test);\n            var input = jQuery('.thisuser > input');\n            var input2 = jQuery('.thisnumber > input');\n            var is_name = input.length > 3;\n            var is_name2 = input2.length > 3;\n\n            if (!data.hIdethis2 == 1 && data.userlvlMeta2 == 1) {\n                jQuery(\"#this_col_1\").addClass(\"enable_this\");\n            } else if (data.hIdedisc2 == 1 && is_name && is_name2 ) {\n                jQuery(\"#this_col_1\").removeClass(\"enable_this\");\n                jQuery(\"#this_col_2\").addClass(\"enable_this\");\n\n            } \n        }\n    });\n}\n\nFunction Called by\nif ($('body').is('.page-id-9999') || $('body').is('.page-id-1111')) {\n\n    var thisbtn = document.querySelector('#this_verf_form > div > .wpcf7');\n\n    thisbtn.addEventListener('wpcf7submit', function (event) {\n        var status = event.detail.status;\n        console.log(status);\n        if (status === 'mail_sent') {\n            jQuery('#this_submtID').val(\"Submitted\");\n        }\n        setTimeout(function () {\n            doAjaxRequest4(1,getthisInfo,getthisInfo2);\n        }, 3500);\n    }, false);\n}\n\n\nA: Turns out that the $wpdb->update was running based on user being signed in via PHP. The variables that were placed into the condition statements were being ignored. To fix the issue I removed the $wpdb->update portion of the code from the 'user is signed in' condition and moved it to the 'if empty' conditional statements.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402635", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Set default landing page for buddypress member profile I've been trying to redirect users to the profile page when accessing profiles of users and self. Currently it's redirecting to activity page by default.\n\nEg: example.com/members/username\n\nis showing the activity page as default.\nI've tried setting the below line in wp-config.php as suggested in Buddypress forum. But doesn't seem to be working.\n\ndefine('BP_DEFAULT_COMPONENT', 'profile');\n\nIs there any workaround to implement this, instead of profile all the other links(friends, groups, notifications etc.) are working when setting in BP_DEFAULT_COMPONENT.\n\nA: Are you sure you've added the constant definition in the right place? As the BuddyPress codex says:\n\nWhen adding the code to wp-config.php, place it after\ndefine(\u2018DB_COLLATE\u2019, \u201d); and before the authentication keys. If you\nadd this line to the bottom of wp-config.php, it will not work.\n\n\nA: This got resolved when I set the Activity Streams Page to - None -  in Dashboard->Settings->Buddypress->Pages.\nI'm not sure what this setting has to do with the default page. Can someone explain about it?\n\nsite.com/wp-admin/admin.php?page=bp-page-settings\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402636", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change Link to Upload folder I'm working on a restyling of a wordpress site, which has an upload folder of almost 120gb. I made a copy of the entire site except the upload folder, I would like to avoid it, to make quick copies of testing.\nI was looking for a way to link to the Test site, the original upload folder, of the live site.\nIs there a way to tell Wordpress to look for the upload folder at another address?\nI hope it is clear.\nThank you\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402637", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Background Image Does Not Display on Page So I did what you said to correct the code and it fixed my site but I see that the pages that use this layout do not have the background images showing.  I have included the whole code for the section called Basic Content to see if you see any other issues for what may be causing this.  Thanks for your help!\n//Basic Content\nelseif( get_row_layout() == 'basic_content' ):\n  $bgimage      = get_sub_field('background_image');\n  $bgcolor      = get_sub_field('background_color');\n  $maincontent  = get_sub_field('main_content');\n  $sectionid    = get_sub_field('id');\n  $newsize      = get_sub_field('new_size');\n  $textalign    = get_sub_field('text_alignment');\n  \n            \n  $bg = (!$bgimage == '') ? 'style=\"background-image:url(\"'.$bgimage['url'].'\")' : '';\n\n  \n  if($textalign == 'Left'){ $ta = 'text-left'; } else { $ta = ''; }\n  \n  \n  echo  '<div id=\"'.$sectionid.'\" class=\"row basic '.$newsize.' '.$bgcolor.' '.$ta.'\" '.$bg.'>';\n    \n    if($newsize == 'full'){\n      \n      echo $maincontent;\n    \n    } elseif($newsize == 'medium') {\n      \n        echo '<div class=\"container\">' .\n          \n            $maincontent .\n            \n          '</div>';\n      \n    } elseif($newsize == 'small') {\n      \n        echo '<div class=\"small-container\">' .\n          \n            $maincontent .\n            \n          '</div>';\n          \n    } else {\n      \n      echo '<div class=\"small-container\">' .\n          \n            $maincontent .\n            \n          '</div>';\n          \n    }\n  \n  echo '</div>';\n\n\nA: Based on what's provided I would suggest doing some var_dump tests on the $bg variable, it would seem that the ternary logic there is equating to false and thus nothing is being assigned to the $bg variable.\nDo you have a default background image, if the $bgimage field is not set by a user?\nAlso, be sure to check the spelling of what you set up in ACF field names, I've had situations like this where ACF content wasn't showing up and the issue was a rogue space in the field name or a misspelled field name.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402639", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom ordering of CPT items not matching with the ordering of its pagination I have a CPT and I am changing its ordering by a numeric value of a custom field.  My custom field name is \"ordering\".  The ordering of my CPT is changed like this:\n$posts = get_posts(array(\n    'posts_per_page' => -1,\n    'post_type'      => 'staff',\n    'meta_key'       => 'ordering',\n    'orderby'        => 'meta_value',\n    'order'          => 'ASC'\n));\n\nThe ordering of CPT items is working fine but when I click a CPT item, I see the pagination is still follwoing the \"Created Date\" ordering format.  Is there a way to match the pagination ordering the same way the CPT items are ordered?\nI am using understrap_post_nav() to output my pagination.\nI tried to change the ordering of my pagination with these arguments but this didn't work:\nunderstrap_post_nav($args = array(\n    'orderby'        => 'meta_value',\n    'meta_key'       => 'ordering',\n    'order'          => 'ASC',\n    'post_type'      => 'staff',\n    'posts_per_page' => -1,\n));\n\nI believe understrap_post_nav() code is coming from here:\nhttps://github.com/understrap/understrap/blob/main/inc/template-tags.php\n\nand this is the while loop:\nhttps://github.com/understrap/understrap/blob/main/single.php\n\nHere's how I am getting the posts and I am getting these post in my custom page template called about-page.php:\n<?php\nwhile ( have_posts() ) {\n    the_post();\n    get_template_part( 'loop-templates/content', 'page' );\n}\n?>\n<div class=\"container\" id=\"team-members-loop\">                          \n    <?php\n    $posts = get_posts(array(\n        'posts_per_page' => -1,\n        'post_type'      => 'team-members',\n        'meta_key'       => 'ordering',\n        'orderby'        => 'meta_value',\n        'order'          => 'ASC'\n    ));\n\n    if( $posts ): ?>\n        \n        <div class=\"row\">\n            <?php foreach( $posts as $post ):\n                setup_postdata( $post );\n            ?>\n            <div class=\"col-sm-4\">\n                <a href=\"<?php the_permalink(); ?>\" class=\"team-link\">\n                    <div class=\"card_image_container\">\n                        <div class=\"card_image\" style=\"background-image:url(<?php the_field('thumbnail_photo') ?>)\"></div>\n                    </div>\n                    <div class=\"card_details\">\n                        <h4 class=\"card-title\"><?php the_title(); ?></h4>\n                        <h5 class=\"card-desc\"><?php echo the_field('title') ?></h5>\n                    </div>\n                </a>\n            </div>\n            <?php endforeach; ?>\n        </div>\n        <?php wp_reset_postdata(); ?>\n    \n    <?php endif; ?>\n</div>\n\n\nA: \nIs there a way to match the pagination ordering the same way the CPT items are ordered?\n\nThe custom pagination function that you're using (understrap_post_nav()) is using the default functions for navigating between singular posts like previous_post_link() and next_post_link() which do not support custom (posts) queries, so custom coding is needed to achieve the pagination you're trying to have.\nAnd one easy way I could think of is by using offset like so:\n\n*\n\n*In your loop in the about-page.php template, add a custom URL parameter to the post permalink.\nJust use any name that you like, but in my example (see the code at the bottom of this answer), the parameter name is current_ordering.\n\n\n*That parameter will store the offset of the current post in the $posts array, which contains all posts since you're using 'posts_per_page' => -1 which retrieves all found posts. I.e. There'd be no LIMIT clause added to the query/SQL.\n\n\n*Then in the single post template like single.php, make the same query in question, but query for 3 posts only starting from the post at the offset of the previous post, i.e. current_ordering - 1.\nAnd basically, the pagination will be generated based on the above 3 posts, and the pagination links will also need to have the current_ordering parameter which is passed to the next/previous post.\nSo here's a working example and just follow the steps:\n\n*\n\n*In the about-page.php, change the foreach( $posts as $post ) to foreach( $posts as $i => $post ) , i.e. add the post index/offset ($i).\nThen change the <?php the_permalink(); ?> to <?php my_ordering_permalink( $i ); ?>.\n\n\n*In your functions.php file, add this which defines the above function that outputs the permalink containing the current_ordering parameter:\n/**\n * Display or retrieve the current post permalink with a current_ordering parameter added.\n *\n * @param int         $offset Required. The post's position/offset in the posts array.\n * @param WP_Post|int $post   Optional. The post object or ID. Default null for current post.\n * @param bool        $echo   Optional. Whether to echo or return the URL. Default true.\n *\n * @return void|string Void if `$echo` argument is true, the permalink URL `$echo` is false.\n */\nfunction my_ordering_permalink( $offset, $post = null, $echo = true ) {\n    $url = add_query_arg( 'current_ordering', $offset, get_permalink( $post ) );\n\n    if ( ! $echo ) {\n        return $url;\n    }\n    echo $url;\n}\n\n\n\n*Also in the functions file, add this which outputs the pagination: (you can customize the HTML markup later on)\n/**\n * Displays a (simple) pagination to navigate between singular posts in a custom posts query.\n *\n * @uses understrap_post_nav()\n *\n * @param string $sep    Optional. String to use between the next/previous links. Default ' '.\n * @param string $before Optional. String to use before the pagination. Default empty.\n * @param string $after  Optional. String to use after the pagination. Default empty.\n */\nfunction my_ordering_post_nav( $sep = ' ', $before = '', $after = '' ) {\n    // Use understrap_post_nav() if the URL parameter isn't set, or if we're not on a\n    // single team-members CPT post page.\n    if ( ! isset( $_GET['current_ordering'] ) || ! is_singular( 'team-members' ) ) {\n        return understrap_post_nav();\n    }\n\n    $current = get_queried_object_id();\n    $offset  = $_GET['current_ordering'];\n\n    $ids = get_posts( array(\n        'fields'         => 'ids',\n        'offset'         => max( 0, $offset - 1 ),\n        'posts_per_page' => 3,\n        // the rest below should be the same as the one used with get_posts() in the\n        // about-page.php template\n        'post_type'      => 'team-members',\n        'meta_key'       => 'ordering',\n        'orderby'        => 'meta_value_num',\n        'order'          => 'ASC',\n    ) );\n\n    if ( empty( $ids ) ) {\n        return;\n    }\n\n    $current_index = array_search( $current, $ids );\n    if ( false === $current_index ) {\n        return;\n    }\n\n    $prev_index    = $current_index + 1;\n    $next_index    = $current_index - 1;\n    $links         = array();\n\n    if ( isset( $ids[ $prev_index ] ) ) {\n        $post_id = $ids[ $prev_index ];\n\n        $links[] = sprintf( '<a href=\"%s\">&laquo; %s</a>',\n            esc_url( my_ordering_permalink( $offset + 1, $post_id, false ) ),\n            esc_html( get_the_title( $post_id ) )\n        );\n    }\n\n    if ( isset( $ids[ $next_index ] ) ) {\n        $post_id = $ids[ $next_index ];\n\n        $links[] = sprintf( '<a href=\"%s\">%s &raquo;</a>',\n            esc_url( my_ordering_permalink( $offset - 1, $post_id, false ) ),\n            esc_html( get_the_title( $post_id ) )\n        );\n    }\n\n    echo $before . implode( $sep, $links ) . $after;\n}\n\n\n\n*Then in your single post template, change the understrap_post_nav(); to my_ordering_post_nav();.\nSo that's all, but keep in mind that the query arguments in the my_ordering_post_nav() function must match the ones in the about-page.php template (the args you pass to get_posts()), except for fields, offset and posts_per_page.\nAdditional Notes\n\n*\n\n*'posts_per_page' => -1 is equivalent to 'nopaging' => true, which can result in a huge query that can cause the site to run extremely slow if not completely down, depending on whether the database can handle the posts selection (which in your case selecting by a meta value), so use posts_per_page with a high number instead that you know would never actually going to be reached, but that can be handled by the database and that would also not cause timeouts (which can happen when looping over a large array or dataset).\n\n\n*\"I am changing its ordering by a numeric value of a custom field\" \u2014 if the meta value is a number, then you should use 'orderby' => 'meta_value_num' to make sure the values are sorted as numbers and not strings. That way, 1, 3, 10, 2 would correctly be sorted into 1, 2, 3, 10 and not 1, 10, 2, 3 which is what would happen when the values are sorted as strings.\n\n\n*get_posts() suppresses all filters by default, so I suggest you to add 'suppress_filters' => false to your args to ensure plugins can filter the query or run specific actions (for a good reason, of course).\n\n\n*You might want to create a single post template specific to your CPT, i.e. single-team-members.php, and edit that file to use the my_ordering_post_nav() function, which means you would not need to edit the single.php file.\n\n\n*In about-page.php, instead of simply if( $posts ), you should use if( ! empty( $posts ) ) to check or ensure that the $posts/array is not empty.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402642", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is it normal that get_post() gets run 300 times and the content of those posts aren't visible? Is it normal that get_post() gets run 300 times and the content of those posts aren't visible? Ran Query Monitor and saw get_post() from wp_query getting run 300 times, but it's on my homepage and I don't see the content of those posts since most of the content of the homepage are statically generated and don't get their content from posts. Is it possible that get_post gets run even when we don't need it? How do we find the culprit and get rid of those unnecessary calls? I found the count on Queries By Caller and I don't see a way to find where they're all getting called.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402647", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: post_type_link Filter - Too Few Arguments I am building a website for a client with an existing website and I need to set the URLs to be exactly like they are in his old website.\nI have created a custom post type with a custom taxonomy for this website.\nThis is the code for registering the taxonomy:\n// Args for the phone-category taxonomy\n$labels = array(\n    'name'                  => _x( 'Categories', 'Taxonomy General Name', 'ps_dev' ),\n    'singular_name'         => _x( 'Category', 'Taxonomy Singular Name', 'ps_dev' ),\n    'search_items'          => __( 'Search categories', 'ps_dev' ),\n    'all_items'             => __( 'All categories', 'ps_dev' ),\n    'parent_item'           => __( 'Parent category', 'ps_dev' ),\n    'parent_item_colon'     => __( 'Parent category:', 'ps_dev' ),\n    'edit_item'             => __( 'Edit category', 'ps_dev' ),\n    'update_item'           => __( 'Update category', 'ps_dev' ),\n    'add_new_item'          => __( 'Add new category', 'ps_dev' ),\n    'new_item_name'         => __( 'New category name', 'ps_dev' ),\n    'menu_name'             => __( 'Category', 'ps_dev' )\n);\n\n// Register the taxonomy\nregister_taxonomy( 'phone-category', array( 'phones' ), array(\n    'hierarchical'          => true,\n    'labels'                => $labels,\n    'show_ui'               => true,\n    'show_in_rest'          => true,\n    'show_admin_column'     => true,\n    'query_var'             => true,\n    'rewrite'               => array( 'slug' => '/phone', 'with_front' => false )\n) );\n\nAnd this is the code for registering the new custom post type:\n// Create the phones CPT\n$labels = array(\n    'name'                  => _x( 'Phones', 'Post Type General Name', 'ps_dev' ),\n    'singular_name'         => _x( 'Phone', 'Post type Singular Name', 'ps_dev' ),\n    'menu_name'             => __( 'Phones', 'ps_dev' ),\n    'parent_item_colon'     => __( 'Parent Phone', 'ps_dev' ),\n    'all_items'             => __( 'All Phones', 'ps_dev' ),\n    'view_item'             => __( 'View Phone', 'ps_dev' ),\n    'add_new_item'          => __( 'Add New Phone', 'ps_dev' ),\n    'add_new'               => __( 'Add New', 'ps_dev' ),\n    'edit_item'             => __( 'Edit Phone', 'ps_dev' ),\n    'update_item'           => __( 'Update Phone', 'ps_dev' ),\n    'search_items'          => __( 'Search Phone', 'ps_dev' ),\n    'not_found'             => __( 'Not Found', 'ps_dev' ),\n    'not_found_in_trash'    => __( 'Not found in Trash', 'ps_dev' ),\n);\n\n$args = array(\n    'label'                 => __( 'phones', 'ps_dev' ),\n    'description'           => __( 'Phone numbers' , 'ps_dev' ),\n    'labels'                => $labels,\n    'supports'              => array( 'title', 'editor', 'excerpt', 'thumbnail', 'revisions', 'custom-fields' ),\n    'taxonomies'            => array( 'phones-category' ),\n    'hierarchical'          => false,\n    'public'                => true,\n    'show_ui'               => true,\n    'show_ui_menu'          => true,\n    'show_in_nav_menu'      => true,\n    'show_in_admin_bar'     => true,\n    'can_export'            => true,\n    'has_archive'           => false,\n    'exclude_from_seach'    => false,\n    'publicly_queryable'    => true,\n    'capability_type'       => 'post',\n    'show_in_rest'          => true,\n    'rewrite'               => array( 'slug' => '/phone/%post_name%/', 'with_front' => false )\n);\n\nregister_post_type( 'phones', $args );\n\nAs can be seen in the code above, the URL structure I need for the CPT is /phone/%post_name%/ and the URL structure I need for the taxonomy is /phone/%taxonomy_title%/\nSo for example, if there is a phone item called test, its URL should be /phone/test/.\nIf we have a phone-category taxonomy called taxonomy_test, its URL should be /phone/taxonomy_test.\nThe taxonomy URL works well.\nThe issue is with the CPT's URL.\nI am trying to use this code:\nadd_filter( 'post_type_link', 'phone_custom_permalink' );\nfunction phone_custom_permalink( $post_link, $post ) {\n    if ( $post->post_type != 'phones' ) {\n        return $post_link;\n    }\n    return str_replace('/%post_name%/', $post->post_name, $post_link );\n}\n\nBut when I open the phones post's edit page, it throws an error:\n phone_custom_permalink(), 1 passed in D:\\Programs\\Xampp\\htdocs\\theindex\\wp-includes\\class-wp-hook.php on line 309 and exactly 2 expected in D:\\Programs\\Xampp\\htdocs\\theindex\\wp-content\\themes\\hello-elementor-child\\post-types\\phones.php:90 Stack trace: #0 D:\\Programs\\Xampp\\htdocs\\theindex\\wp-includes\\class-wp-hook.php(309): phone_custom_permalink('http://theindex...') #1 D:\\Programs\\Xampp\\htdocs\\theindex\\wp-includes\\plugin.php(189): WP_Hook->apply_filters('http://theindex...', Array) #2 D:\\Programs\\Xampp\\htdocs\\theindex\\wp-includes\\link-template.php(370): apply_filters('post_type_link', 'http://theindex...', Object(WP_Post), false, false) #3 D:\\Programs\\Xampp\\htdocs\\theindex\\wp-includes\\link-template.php(201): get_post_permalink(Object(WP_Post), false, false) #4 D:\\Programs\\Xampp\\htdocs\\theindex\\wp-includes\\rest-api\\endpoints\\class-wp-rest-posts-controller.php(1776): get_permalink(Object(WP_Post)) #5 D:\\Programs\\Xampp\\htdocs\\theindex\\wp-includes\\rest-a in D:\\Programs\\Xampp\\htdocs\\theindex\\wp-content\\themes\\hello-elementor-child\\post-types\\phones.php on line 90\n\nI tried to follow some guides but in each one, I am still getting this error.\nWhen I change it to this:\nadd_filter( 'post_type_link', 'phone_custom_permalink' );\nfunction phone_custom_permalink( $post_link, $post=0 ) { // The change is here\n    if ( $post->post_type != 'phones' ) {\n        return $post_link;\n    }\n    return str_replace('/%post_name%/', $post->post_name, $post_link );\n}\n\nI am not getting the error, but it just does not work (the URL in the post edit page is with /&post_name%/.\nWhat am I doing wrong?\n\nA: I think you just have to do :\nadd_filter( 'post_type_link', 'phone_custom_permalink', 10, 2 );\n\nTo tell the hook that you are passing it 2 arguments.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402652", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Set URL link to featured image of custom post type I am storing data from an API in a custom post type made up with Advanced Custom Field. The API returns image urls, where each is given a text field in Advanced Custom Field. I'd like to set a specific of those as the featured image of the post type.\nI found a few ways of doing it, if the image was a imagefield or galleryfield, but since it's just a URL for now, I am struggling with it.\nSo the question is boiled down to; how would I set a featured image from a given URL from a 3rd party?\nAny advice would be appreciated.\nSome code from functions.php\n// Setting Costum Post Type\nadd_action('init', 'register_cars');\nfunction register_cars(){\n    register_post_type('car', [\n        'label' => 'Cars',\n        'public' => true,\n        'capability_type' => 'post',\n        'publicly_queryable' => true,\n        'show_ui'            => true,\n        'hierarchical'       => true,\n        'has_archive'        => true,\n        'rewrite'            => array('slug' => 'car', 'with_front' => false),\n        'supports'           => array('title', 'editor', 'thumbnail'),\n        'menu_position'      => 31\n    ]);\n}\n\n// Getting the cars from our API\nfunction get_cars_from_api() {\n    \n    // Call the API and get a response \n    $url = \"URL_HERE\";\n\n    $curl = curl_init($url);\n    curl_setopt($curl, CURLOPT_URL, $url);\n    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n\n    $headers = array(\n       \"Authorization: Basic AUTH_HERE\",\n    );\n    curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);\n    \n    // For debug\n    curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false);\n    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);\n    \n    // Decode our response to json\n    $resp = curl_exec($curl);\n    curl_close($curl);\n    $arr = json_decode($resp, true);\n    $cars[] = $arr;\n    \n    // Loop through our response\n    foreach($arr['Vehicles'] as $car) {\n        $car_slug = sanitize_title($car['Make'] . ' ' . $car['Model'] . ' ' . $car['Variant'] . ' (ID: ' . $car['VehicleId'] . ')');\n        $car_name = $car['Make'] . ' ' . $car['Model'] . ' ' . $car['Variant'] . ' (ID: ' . $car['VehicleId'] . ')';\n        $existing_car = get_page_by_path($car_slug, 'OBJECT', 'car');\n\n        // Check if we need to create or update the car\n        if($existing_car === null) {\n            $inserted_car = wp_insert_post([\n                'post_name' => $car_slug,\n                'post_title' => $car_name,\n                'post_type' => 'car',\n                'post_status' => 'publish'\n            ]);\n\n            if(is_wp_error($inserted_car)) {\n                continue;\n            }\n            $fillable = [\n                ...\n                'field_61f2d2e5131b1' => $car['Pictures'][0],\n                ...\n            ];\n\n            foreach($fillable as $key => $name) {\n                update_field($key, $name, $inserted_car);\n            };\n        } else {\n            $existing_car_id = $existing_car->ID;\n            $existing_car_timestamp = get_field('ModifiedDate', $existing_car_id);\n\n            if($car['ModifiedDate'] >= $existing_car_timestamp){\n                $fillable = [\n                ...\n                'field_61f2d2e5131b1' => $car['Pictures'][0],\n                ...\n            ];\n\n            foreach($fillable as $key => $name) {\n                update_field($key, $name, $existing_car_id);\n            };\n            }\n        }\n    }\n    print_r('You can now close this page. Your cars are updated');\n}\nadd_shortcode('get_cars_from_api', 'get_cars_from_api'); \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402655", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Use meta_query in args for relationship I found this guide and I'm following it:\nhttps://rudrastyh.com/wordpress/meta_query.html\nBut I see that it doesn't work for relationship of Advanced Custom Field. Why?\nThis is my code:\n$args=array(\n        'post_type' => 'post',\n        'post_status' => 'publish',\n        'posts_per_page' => -1,\n        'meta_key'          => 'rtp_value',\n        'orderby'           => 'meta_value meta_value_num',\n        'order' => 'DESC',\n        'cat' => 16,\n        'meta_query' => array(\n        'relation'  => 'OR',\n        array(\n            'key'     => 'software_relationship',\n            'value'   => array('15813', '16013'),\n            'compare' => 'IN',\n        ),\n        ),\n    );\n\nIs it possible?\nUPDATE:\nI'm moving on, but now I have a new problem, how can I handle the meta_query for simple ACF texts?\nLooking around I saw that it would need to be done like this:\nhttps://www.advancedcustomfields.com/resources/query-posts-custom-fields/\nBut it doesn't work for me with \"=\" and \"LIKE\" operator.\nThis is my code:\n$tema_array_args = array();\n$i = 0;\nforeach ($tema_array as $tema_array_key) {\n    $tema_array_args[$i] = array('key' => 'tema_slot_machine', 'value' => '\"' . $tema_array_key . '\"', 'compare' => 'LIKE');\n    $i++;\n}\n\n$software_array_args = array();\n$i = 0;\nforeach ($software_array as $software_array_key) {\n    $software_array_key_id = get_post_id_by_slug(slugify($software_array_key));\n    $software_array_args[$i] = array('key' => 'software_relazione_slot_machine', 'value' => '\"' . $software_array_key_id . '\"', 'compare' => 'LIKE');\n    $i++;\n}\n\n$volatilita_array_args = array();\n$i = 0;\nforeach ($volatilita_array as $volatilita_array_key) {\n    $volatilita_array_args[$i] = array('key' => 'volatilita_slot_machine', 'value' => \"'\" . $volatilita_array_key . \"'\", 'compare' => '=');\n    $i++;\n}\n\nif($filtro_applicato == 'RTP pi\u00f9 alto') {\n\n    if($tema == '' && $software == '' && $volatilita == '') {\n\n        $args=array(\n            'post_type' => 'post',\n            'post_status' => 'publish',\n            'posts_per_page' => -1,\n            'meta_key'          => 'rtp_slot_machine',\n            'orderby'           => 'meta_value meta_value_num',\n            //'post__not_in'    => array(91690), // esclude l'articolo \"inizia qui\"\n            'order' => 'DESC',\n            'paged' => $paged,\n            'cat' => 16,\n        );\n\n    } elseif($tema != '' || $software != '' || $volatilita != '') {\n\n        if($tema != '' && $software == '' && $volatilita == '') {\n            $relazione = 'OR';\n        } elseif($tema == '' && $software != '' && $volatilita == '') {\n            $relazione = 'OR';\n        } elseif($tema != '' && $software == '' && $volatilita != '') {\n            $relazione = 'OR';\n        } else {\n            $relazione = 'AND';\n        }\n\n        $args=array(\n            'post_type' => 'post',\n            'post_status' => 'publish',\n            'posts_per_page' => -1,\n            'meta_key'          => 'rtp_slot_machine',\n            'orderby'           => 'meta_value meta_value_num',\n            //'post__not_in'    => array(91690), // esclude l'articolo \"inizia qui\"\n            'order' => 'DESC',\n            'paged' => $paged,\n            'cat' => 16,\n            'meta_query' => array(\n                'relation' => $relazione,\n                array(\n                'relation' => 'OR',\n                    $tema_array_args[0], $tema_array_args[1], $tema_array_args[2], $tema_array_args[3], $tema_array_args[4],\n                    $tema_array_args[5], $tema_array_args[6], $tema_array_args[7], $tema_array_args[8], $tema_array_args[9],\n                    $tema_array_args[10], $tema_array_args[11], $tema_array_args[12], $tema_array_args[13], $tema_array_args[14],\n                    $tema_array_args[15], $tema_array_args[16], $tema_array_args[17], $tema_array_args[18], $tema_array_args[19],\n                    $tema_array_args[20], $tema_array_args[21], $tema_array_args[22], $tema_array_args[23], $tema_array_args[24],\n                    $tema_array_args[25], $tema_array_args[26], $tema_array_args[27], $tema_array_args[28], $tema_array_args[29],\n                    $tema_array_args[30], $tema_array_args[31], $tema_array_args[32], $tema_array_args[33], $tema_array_args[34],\n                    $tema_array_args[35], $tema_array_args[36], $tema_array_args[37], $tema_array_args[38], $tema_array_args[39],\n                ),\n                array(\n                    'relation' => 'OR',\n                    $software_array_args[0], $software_array_args[1], $software_array_args[2], $software_array_args[3], $software_array_args[4],\n                    $software_array_args[5], $software_array_args[6], $software_array_args[7], $software_array_args[8], $software_array_args[9],\n                    $software_array_args[10], $software_array_args[11], $software_array_args[12], $software_array_args[13], $software_array_args[14],\n                    $software_array_args[15], $software_array_args[16], $software_array_args[17], $software_array_args[18], $software_array_args[19],\n                    $software_array_args[20], $software_array_args[21], $software_array_args[22], $software_array_args[23], $software_array_args[24],\n                    $software_array_args[25], $software_array_args[26], $software_array_args[27], $software_array_args[28], $software_array_args[29],\n                    $software_array_args[30], $software_array_args[31], $software_array_args[32], $software_array_args[33], $software_array_args[34],\n                    $software_array_args[35], $software_array_args[36], $software_array_args[37], $software_array_args[38], $software_array_args[39],\n                ),\n                array(\n                    'relation' => 'OR',\n                    $volatilita_array_args[0], $volatilita_array_args[1], $volatilita_array_args[2], $volatilita_array_args[3], $volatilita_array_args[4],\n                ),\n            ),\n        );\n\n    }\n\nWhat am I doing wrong?\n\nA: I finally managed to solve it myself, this is the code I used:\nif($tema == '' && $software == '' && $volatilita == '') {\n\n    $args=array(\n        'post_type' => 'post',\n        'post_status' => 'publish',\n        'posts_per_page' => -1,\n        'orderby'           => 'meta_value meta_value_num',\n        'order' => 'DESC',\n        'paged' => $paged,\n        'cat' => $categoria_slot_machine,\n    );\n\n} elseif($tema != '' || $software != '' || $volatilita != '') {\n\n    $args=array(\n        'post_type' => 'post',\n        'post_status' => 'publish',\n        'posts_per_page' => -1,\n        'orderby'           => 'meta_value meta_value_num',\n        'order' => 'DESC',\n        'paged' => $paged,\n        'cat' => $categoria_slot_machine,\n        'meta_query' => array(\n            'relation' => 'AND',\n            array(\n                'relation' => 'OR',\n            ),\n            array(\n                'relation' => 'OR',\n            ),\n            array(\n                'relation' => 'OR',\n            ),\n        )\n    );\n\n    $i = 0;\n    if ($tema != '') {\n        foreach ($tema_array as $tema_array_key) {\n            $args['meta_query'][0][$i] = array('key' => 'tema_slot_machine', 'value' => '\"' . $tema_array_key . '\"', 'compare' => 'LIKE');\n            $i++;\n        }\n    }\n    if ($software != '') {\n        foreach ($software_array as $software_array_key) {\n            $software_array_key_id = get_post_id_by_slug(slugify($software_array_key));\n            $args['meta_query'][1][$i] = array('key' => 'software_relazione_slot_machine', 'value' => '\"' . $software_array_key_id . '\"', 'compare' => 'LIKE');\n            $i++;\n        }\n    }\n\n    if ($volatilita != '') {\n        foreach ($volatilita_array as $volatilita_array_key) {\n            echo $volatilita_array_key;\n            $args['meta_query'][2][$i] = array('key' => 'volatilita_slot_machine', 'value' => $volatilita_array_key, 'compare' => '=');\n            $i++;\n        }\n    }\n}\n\nif($filtro_applicato == 'RTP pi\u00f9 alto') {\n\n    $args['meta_key'] = 'rtp_slot_machine';\n\n} elseif($filtro_applicato == 'Pi\u00f9 votate') {\n\n    $args['meta_key'] = '_kksr_ratings';\n\n} elseif($filtro_applicato == 'Nuove slot') {\n\n    $args['order'] = 'date';\n\n}\n\nI post because I hope it helps someone :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402660", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sending POST request on a wordpress page When I try to send a post request on a page using WP_Remote_post, I get an HTTP 500 error when I redirect to the page through the form.\nCan someone tell me what I am doing wrong?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402661", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to create wordpress install template/image? I'm looking to create a wordpress install image/package/template, not sure how it would be called.\nBasically I want to set a certain plugins, translations, settings and make a template of that wordpress and be able to install it with fewer clicks on another host.\nTwo ways I know of:\nWP All Import plugin, to just set up one wordpress site and export it. Problem with this method is that it will always install outdated plugins + I'm not sure if this is the cleanest method.\nSecond way: (I usually install WP on linux servers) is to use bash script and wp-cli to install all sorts of things, but I'm that seems tedious to do since there's a lot of stuff I want to change and do it all through bash script would require lots of code.\nDoes anyone know another good way to make a wordpress \"template\" install? Thanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402662", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: wp_new_user_notifications to notify user and admin about new user registration I am using wp_insert_user to insert new users and before inserting the user it checks whether the user exists or not and only the new user are registered. Now I want to notify both users and admins about the user registration.\nHere is the code of wp_insert_user :\n$user = $mail['header']->fromaddress;\n$email = strstr($mail['header']->fromaddress, '<',true);\nfor ($j=1; $j < $total; $j++) { \n    $mail = $emails-> get($j);\nif(email_exists($email)){\n    add_post_meta($post_id, 'ticket_username', $user, True);    \n    add_post_meta($post_id, 'ticket_email', $email, True);\n }else{\n         $userdata = array(\n        'user_login'    => ucwords(strstr($mail['header']->fromaddress, '<',true)),\n        'user_pass'     => '',\n        'user_nicename' => ucwords(strstr($mail['header']->fromaddress, '<',true)),   \n        'display_name'  => ucwords(strstr($mail['header']->fromaddress, '<',true)),\n        'user_email'    => strstr($mail['header']->fromaddress, '<'),\n        'role'          => 'support_customer',\n    );\n    $user_id = wp_insert_user($userdata);  \n            if ( ! is_wp_error( $user_id ) ) {\n                 wp_update_post( array(\n                  'ID'          => $post_id,\n                  'post_author' => $user_id,\n    ) );\n}\n}\n}\n\nAnd here is the code for notifying users and admins:\n\nif ( !function_exists( 'wp_new_user_notification' ) ) {\n  function wp_new_user_notification( $user_id, $plaintext_pass = '' ) {\n        $user            = new WP_User($user_id);\n        $user_data       = get_userdata( $user_id );\n        $firstname       = $user_data->first_name;\n        $user_login      = stripslashes( $user_data->user_login );\n        \n        // URLs\n        $site_url  = site_url();\n        $ads_url   = site_url( 'ads/' );\n        $login_url = site_url();\n         \n        // Email variables\n        $headers            = 'From: EXAMPLE.INFO <info@example.info>' . \"rn\";\n        $blog_name          = get_option( 'blogname' );\n        $admin_subject      = 'New User Registration on ' . $blog_name;\n        $welcome_subject    = 'Welcome to My site!';\n        $welcome_email      = stripslashes( $user_data->user_email );\n        $admin_email        = get_option('admin_email');\n       \n        $admin_message =\n<<<EOT\n<!DOCTYPE html><html xmlns=\"http://www.w3.org/1999/xhtml\"><head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n</head><body>\n<div class=\"content\">\n    <div class=\"wrapper\">\n        <p>New user registration on your blog: {$blog_name}.</p>\n        <p>Username: {$user_login}</p>\n        <p>Email: {$welcome_email}</p>\n    </div>\n</div>\n</body></html>\nEOT;\n        $welcome_message =\n<<<EOT\n<!DOCTYPE html><html xmlns=\"http://www.w3.org/1999/xhtml\"><head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n</head><body>\n<div class=\"content\">\n<div class=\"wrapper\">\n<table width=\"100%\"><tr><td>\nHello {$firstname},<br />\nTo log into your account, \ngo <a href=\"{$login_url}\">visit our site</a> \nand use the credentials below.<br />\nYour Username: {$user_login}<br />\nYour Password: {$plaintext_pass}<br />\n</td></tr></table>\n</div>\n</div>\n</body></html>\nEOT;\nprint_r($admin_email);\n//die()\n        wp_mail( $admin_email, $admin_subject, $admin_message, $headers );\n        wp_mail( $welcome_email, $welcome_subject, $welcome_message, $headers );\n\n    } // End of wp_new_user_notification()\n}\n\nThis code is not working I guess as it is not sending any emails.\nI am quite new to all this, so I am hoping to get some help here.\n\nA: If you're operating under the assumption that wp_insert_user() sends the notification, then that's where the problem is.  That function just inserts the user - it does not by itself send any emails.\nYou can use the function wp_send_new_user_notifications( $user_id ) to send user notification.  However, you need to trigger it based on the result of your wp_insert_user().  Check to make sure you have a user ID and not an error in your result:\nif ( ! is_wp_error( $user_id ) ) {\n     wp_send_new_user_notifications( $user_id );\n} else {\n     // you have an error...\n}\n\nNote that the wp_send_new_user_notifications() function will send to the user and an admin notification by default (so you don't have to specify \"both\").\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402663", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Line break before headings () appears from nowhere So, in the database row i've the following html code in post_content:\nSolo pochi giorni fa, esattamente il 15 marzo, \u00e8 stato presentato durante l'ultima edizione del SXSW Online un suggestivo cortometraggio intitolato <em>Don't Peek - Animal Crossing Horror Short</em> diretto da Julian Terry.\n<ul>\n    <li><strong>LEGGI ANCHE:\u00a0</strong><h2 class=\"h2-link-correlati\"><h2 class=\"h2-link-correlati\"><a href=\"https://videogiochi.badtaste.it/articoli/animal-crossing-new-horizons-e-al-primo-posto-tra-i-videogiochi-piu-venduti-del-2020-di-amazon-uk-e-us/\" rel=\"bookmark\">Animal Crossing: New Horizons \u00e8 al primo posto tra i videogiochi pi\u00f9 venduti del 2020 di Amazon UK e US</a></h2></h2></li>\n</ul>\nE ora, secondo quanto riportato da <a href=\"https://deadline.com/2021/03/timur-bekmambetov-sxsw-short-dont-peek-feature-horror-film-julian-terry-1234716264/\">Deadline,</a>\u00a0<strong>Timur Bekmambetov</strong> (<em>Wanted</em>,\u00a0<em>Hardcore Henry</em>) sarebbe gi\u00e0 pronto a realizzare un film horror tratto proprio dal cortometraggio sopracitato.\n\nAs you can se there is no line break/br before the .\nBUT\nIn frontend, and in backend (when editing the post), the line break appears. Like new line in the editor and like a  in frontend.\n\n\nHow is it possible?\n\nEDIT:\nit seems to be related to the wpautop filter (https://developer.wordpress.org/reference/functions/wpautop/) that made this wonderful thing: adding a line break before and after every html block\n$allblocks = '(?:table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)';\n\n// Add a double line break above block-level opening tags.\n$pee = preg_replace( '!(<' . $allblocks . '[\\s/>])!', \"\\n\\n$1\", $pee );\n\n// Add a double line break below block-level closing tags.\n$pee = preg_replace( '!(</' . $allblocks . '>)!', \"$1\\n\\n\", $pee );\n\nMy solution was this, but it's pretty ugly:\nremove_filter( 'the_content', 'wpautop' );\n$br = false;\nadd_filter( 'the_content', function( $content ) {\n    return wpautop( $content, false );\n}, 10 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402665", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Use wp_handle_upload outside of a POST I'm writing a script that will prefill my custom post type with posts. Each post has a file (zip or json) as post meta that has to be uploaded to the media folder. The problem is wp_handle_upload needs an array from the $_FILES superglobal as an argument, rather than a context stream to the file. I tried resolving this by moving the file to a temp directory and manually populating the $_FILES global like this-\n    $_FILES['tempFile'] = array(\n        'name' => pathinfo($file, PATHINFO_FILENAME),\n        'type' => mime_content_type($tempFile),\n        'tmp_name' => sys_get_temp_dir() . pathinfo($file, PATHINFO_FILENAME),\n        'error' => 0,\n        'size' => strlen(file_get_contents($tempFile)),\n    );\n\nHowever, I get the error Specified file failed upload test. when wp_handle_upload is called.\nIs there another method I should be using, or is there something else I'm missing? Thanks\n\nA: There is no uploading occurring here, but you did describe sideloading.\nSo use media_handle_sideload instead, e.g.\n$file_array = [\n    'name'     => 'test.jpg',\n    'tmp_name' => '/path/to/test.jpg'\n];\n\n$post_id = 0;\n$attachment_id = media_handle_sideload( $file_array, $post_id );\n \nif ( is_wp_error( $attachment_id ) ) {\n    // ... it failed\n}\n\n\n*\n\n*https://developer.wordpress.org/reference/functions/media_handle_sideload/\n\n*based on https://developer.wordpress.org/reference/functions/media_handle_sideload/#comment-983\nThere are other functions that build on this, e.g. media_sideload_image which takes the URL of an image, downloads it, and runs it through the sideload functions,\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402667", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do you do your big exports / imports? I have a big client (50k orders, 70k customers), I'm working today on the migration of his site on a new version of WordPress on a new server.\nI need to export and import the products / customers / orders on the new WordPress without any ID modification.\nProblem, after working on the site I realize that the import is impossible because various customer and order IDs are already taken.\nHow do you do exports / imports like this?\nDo you have a magic solution? ;)\nI have already done dozens of migrations on other e-commerce CMS like PrestaShop, Magento... I am shocked by the way Woocommerce works on this point which seems to me to be the basis.\nThanks to all !\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402668", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Does fixing PHP notices improves website performance? $geolocation = esc_sql($_COOKIE['geolocation']);\n\nI have this, and using Query Monitor, I've been able to find out that this notice is being thrown out 490 times on the home page alone, so I am wondering if it's something I should fix by wrapping it with:\nif(isset($_COOKIE['geolocation'])) {\n \n}\n\nIs it worth doing so, and how much of a performance gain will it have?\n\nA: It's worth doing so, though performance isn't always going to improve, notices are usually a sign of broken-ness or bad code.\nIn the example you cited, there's actually a mistake made and a potential security issue:\n$geolocation = esc_sql($_COOKIE['geolocation']);\n\n\n*\n\n*the code assumes there's cookies, and that a geolocation cookie is present\n\n*it uses esc_sql which should not be used here, esc_sql is almost never used by WP developers as it's mainly found inside the WPDB class\n\n*a Geolocation is not an SQL statement\n\n*esc_sql is an escaping function, not a sanitising function!\n\n*there is no default value for when it's undefined\n\nA better way of doing this would be:\n$geolocation = '';\nif ( !empty( $_COOKIE['geolocation'] ) ) {\n    $geolocation = wp_strip_all_tags( $_COOKIE['geolocation'] );\n}\n\nHere I'm not sure what the default value should be, or the format of this value, but you would swap out wp_strip_all_tags for an equivalent that sanitises it. You would also want a validation step to ensure it actually is a geolocation.\nNotices and warnings can be caused by lots of things, and a lot of them may have no impact on performance, but they can be signs of bugs, security problems, or just awful code quality! If you buy a product and it starts spamming you with PHP notices then that's a bad sign.\nPHP warnings and notices are like mugs with designs that peel off in the dishwasher, door handles that aren't screwed on properly, clothes in a shop that have stains on them, or cars that start making weird and ominous noises. Just because it doesn't make your site faster doesn't mean they shouldn't be fixed.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402671", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP_Query sorted by custom taxonomy I'm trying to query all of my custom type of \"Talent\" and sort them but a custom taxonomy of \"Level\". The levels consists of numbers 0,1,2,3,4,5,6. (sorted descending so 6,5,4,3,2,1,0). There is also a custom taxonomy of Location, but I'm not sorting by that.\nhere is my query which seems to ignore the order by part.\n  $location = 'location-1';\n\n  $args = \"\";\n\n  $args = array( \n    'orderby' => 'level',\n    'order' => 'DESC',\n    'post_type' => 'the-talent',\n    'tax_query' => array(\n        array (\n            'taxonomy' => 'location',\n            'field' => 'slug',\n            'terms' => $location,\n        )\n    ),\n    'posts_per_page'=>-1\n    );\n\n  $talent = new WP_Query( $args );\n      \n  if( $talent->have_posts() ) {\n    while( $talent->have_posts() ) {\n\nhere is the level taxonomy setup\n      $labels = array(\n        'name' => _x( 'Levels', 'taxonomy general name' ),\n        'singular_name' => _x( 'Level', 'taxonomy singular name' ),\n        'search_items' =>  __( 'Search Levels' ),\n        'popular_items' => __( 'Popular Levels' ),\n        'all_items' => __( 'All Levels' ),\n        'parent_item' => null,\n        'parent_item_colon' => null,\n        'edit_item' => __( 'Edit Level' ), \n        'update_item' => __( 'Update Level' ),\n        'add_new_item' => __( 'Add New Level' ),\n        'new_item_name' => __( 'New Level Name' ),\n        'separate_items_with_commas' => __( 'Separate Levels with commas' ),\n        'add_or_remove_items' => __( 'Add or remove Level' ),\n        'choose_from_most_used' => __( 'Choose from the most used Level' ),\n        'menu_name' => __( 'Levels' ),\n      ); \n     \n    // Now register the non-hierarchical taxonomy like tag\n      register_taxonomy('level','the-talent',array(\n        'hierarchical' => false,\n        'labels' => $labels,\n        'show_ui' => true,\n        'show_admin_column' => true,\n        'update_count_callback' => '_update_post_term_count',\n        'query_var' => true,\n        'rewrite' => array( 'slug' => 'level' ),\n      ));\n    }\n\nand the custom post type of 'Talent' if that helps\n        $args = array(\n            'supports' => $supports,\n            'labels' => $labels,\n            'public' => true,\n            'publicly_queryable' => true,\n            'query_var' => true,\n            'rewrite' => array('slug' => 'the-talent'),\n            'has_archive' => true,\n            'hierarchical' => false,\n        );\n        register_post_type('the-talent', $args);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402675", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Using One Function To Create Two Different Shortcodes To populate a player rollcall, an extensive query pulls data from tables in my external MySQL database. Part of this also extracts the player(s) who a) made the most appearances and b) scored the most goals. For a couple of reasons, I now want to move this into functions.php and output the most appearances AND most goals as separate shortcodes from one function. Is this possible? I've only managed to do one or the other at the moment.\nThe shortcodes I'm aiming to create are [seasonapps] and [seasongoals]. And the intention is that the first outputs the player who made the total number of appearances, while the second outputs the player who scored the most goals.\nThe function currently looks like this (appreciate it's a lot \u2013 have truncated parts for brevity):\nfunction seasonapps ( $atts ){\n    global $boroguideDB;\n    $seasonID = get_the_title();\n    $appsetup = $boroguideDB->get_results(\"SELECT re.date, re.venue, re.comp, re.opponent, re.score, re.att, ce.name, ce.ID, re.agg, re.ID, se.blurb, se.ID, re.season, re.compkey FROM resultengine re INNER JOIN clubengine ce ON re.opponent=ce.ID INNER JOIN seasonengine se ON se.season=re.season WHERE (re.season='\".$seasonID.\"') ORDER BY re.date ASC\", ARRAY_A);\n    foreach($appsetup as $row) {\n        $myHashMap = array();\n        if (!function_exists('processAppsUpdate'))   {      \n            function processAppsUpdate($myHashMap, $row) {\n                $id = $row['game'];\n                if (array_key_exists($id, $myHashMap)) {\n                    $tempApps = $myHashMap[$id]['apps'];\n                    $myHashMap[$id]['apps'] = $tempApps + $row['count'];\n                    $tempTotal = $myHashMap[$id]['totalapps'];\n                    $myHashMap[$id]['totalapps'] = $tempTotal + $row['count'];\n                } else {\n                    $tempArray = array();\n                    $tempArray[$id] = $id;\n                    $tempArray['fname'] = $row['first'];\n                    $tempArray['lname'] = $row['last'];\n                    $tempArray['playerID'] = $row['players'];     \n                    $tempArray['totalapps'] = $row['count'];\n                    $tempArray['apps'] = $row['count'];\n                    $tempArray['subs'] = 0;\n                    $tempArray['unused'] = 0;     \n                    $tempArray['goals'] = 0;\n                    $tempArray['yellow'] = 0;\n                    $tempArray['red'] = 0;        \n                    $tempArray['playerid'] = $id;\n                    $myHashMap[$id] = $tempArray;\n                }\n                return $myHashMap;\n            }                   \n            function processGoalsUpdate($myHashMap, $row) {\n                $id = $row['game'];\n                if (array_key_exists($id, $myHashMap)) {\n                    $tempApps = $myHashMap[$id]['goals'];\n                    $myHashMap[$id]['goals'] = $tempApps + $row['count'];\n                } else {\n                    $tempArray = array();\n                    $tempArray[$id] = $id;\n                    $tempArray['fname'] = $row['first'];\n                    $tempArray['lname'] = $row['last'];\n                    $tempArray['playerID'] = $row['players'];         \n                    $tempArray['apps'] = 0;\n                    $tempArray['unused'] = 0;     \n                    $tempArray['goals'] = $row['count'];\n                    $tempArray['yellow'] = 0;\n                    $tempArray['red'] = 0;    \n                    $tempArray['subs'] = 0;\n                    $tempArray['playerid'] = $id;\n                    $myHashMap[$id] = $tempArray;\n                }\n                return $myHashMap;\n            }\n\n            $PL1 = $boroguideDB->get_results(\"SELECT mt.ID1 as game,pe.firstname as first,pe.lastname as last,pe.ID as players,COUNT(*) as count FROM matchteam mt RIGHT JOIN playerengine pe ON mt.ID1=pe.ID RIGHT JOIN resultengine re ON mt.ID=re.ID WHERE (mt.ID1!='9998') AND (mt.ID1!='0') AND (mt.ID!='1624') AND (mt.ID!='1638') AND (mt.ID!='225') AND (mt.ID!='248') AND (re.season='\".$seasonID.\"') GROUP BY mt.ID1 ORDER BY COUNT(*) DESC\", ARRAY_A);\n            foreach($PL1 as $row) {\n                $myHashMap = processAppsUpdate($myHashMap, $row);\n            }\n            $PL2 = $boroguideDB->get_results(\"SELECT mt.ID2 as game,pe.firstname as first,pe.lastname as last,pe.ID as players,COUNT(*) as count FROM matchteam mt RIGHT JOIN playerengine pe ON mt.ID2=pe.ID RIGHT JOIN resultengine re ON mt.ID=re.ID WHERE (mt.ID2!='9998') AND (mt.ID2!='0') AND (mt.ID!='1624') AND (mt.ID!='1638') AND (mt.ID!='225') AND (mt.ID!='248') AND (re.season='\".$seasonID.\"') GROUP BY mt.ID2 ORDER BY COUNT(*) DESC\", ARRAY_A);\n            foreach($PL2 as $row) {\n                $myHashMap = processAppsUpdate($myHashMap, $row);\n            }\n\n...\n\n            $S1 = $boroguideDB->get_results(\"SELECT ms.S1 as game,pe.firstname as first,pe.lastname as last,pe.ID as players,COUNT(*) as count FROM matchscorer ms RIGHT JOIN playerengine pe ON ms.S1=pe.ID RIGHT JOIN resultengine re ON ms.ID=re.ID WHERE (ms.S1!='0') AND (ms.ID!='1624') AND (ms.ID!='1638') AND (ms.ID!='225') AND (ms.ID!='248') AND (re.season='\".$seasonID.\"') GROUP BY ms.S1 ORDER BY COUNT(*) DESC\", ARRAY_A);\n            foreach($S1 as $row) {\n                $myHashMap = processGoalsUpdate($myHashMap, $row);\n            }\n            $S2 = $boroguideDB->get_results(\"SELECT ms.S2 as game,pe.firstname as first,pe.lastname as last,pe.ID as players,COUNT(*) as count FROM matchscorer ms RIGHT JOIN playerengine pe ON ms.S2=pe.ID RIGHT JOIN resultengine re ON ms.ID=re.ID WHERE (ms.S2!='0') AND (ms.ID!='1624') AND (ms.ID!='1638') AND (ms.ID!='225') AND (ms.ID!='248') AND (re.season='\".$seasonID.\"') GROUP BY ms.S2 ORDER BY COUNT(*) DESC\", ARRAY_A);\n            foreach($S2 as $row) {\n                $myHashMap = processGoalsUpdate($myHashMap, $row);\n            }\n\n...\n\n            $maxTotalApps = 0;\n            $maxTotalApps = 0;\n            $maxTotalAppsPlayer = \"\";\n            $maxGoals = 0;\n            $maxGoalsPlayer = \"\";\n            foreach (array_keys($myHashMap) as $hashMapKey) {\n                $totapps = isset($myHashMap[$hashMapKey]['totalapps']) ? $myHashMap[$hashMapKey]['totalapps'] : '';\n                if ($totapps > $maxTotalApps) {\n                    $maxTotalApps = $myHashMap[$hashMapKey]['totalapps'];\n                    $maxTotalAppsPlayer = $myHashMap[$hashMapKey]['fname'].\" \".$myHashMap[$hashMapKey]['lname'];\n                } else if ($totapps == $maxTotalApps) {\n                    $maxTotalAppsPlayer = $maxTotalAppsPlayer.\" / \".$myHashMap[$hashMapKey]['fname'].\" \".$myHashMap[$hashMapKey]['lname'];\n                }\n            }\n        }\n    }\n    return $maxTotalAppsPlayer.\" - \".$maxTotalApps;\n}\nadd_shortcode( 'seasonapps', 'seasonapps' ); \n\n\nFor the second shortcode, I have got no further than \u2013 but see it's a separate function from the other and therefore isn't making the relationship with the query in the first:\nfunction seasongoals ( $atts ){\n    return $maxGoalsPlayer.\" - \".$maxGoals; \n}\nadd_shortcode( 'seasongoals', 'seasonapps' ); \n\nCan the two be combined? I've referred to other articles such as this and this but not sure the questions being asked are the same as this one.\nAnd, if a second shortcode output can be generated from the original function, can a third or fourth etc.?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402676", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disabling ajax code that does a POST request that ends in a 400 error code I have a javascript snippet that sends a POST request, but the backend no longer serves that request. Would removing that code significantly improve the website performance? The problem is that the ajax code is run on every single page. I am thinking yes, but I am not sure, because unlike a SQL request it doesn't really consume any CPU power.\n\nA: This depends on a lot of factors. The short answer, yes you should remove it as request still needs to be served and this might become problematic at scale. Besides you are slowing down your server without need, and could even block some other request depending on how this was coded.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402683", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: $wpdb->update() always need a second try I will use a custom endpoint of REST APi to update fields in a custom table.\nTherefore, i wrote this function:\nfunction update_table_single($request = null){\n    global $wpdb;\n    $data_key = trim($request['data_key']);\n    $data_value = trim($request['data_value']);\n    $where_key = trim($request['where_key']);\n    $where_value = trim($request['where_value']);\n    $table = trim($request['table']); \n\n    $data = [ $data_key => $data_value ];  \n    $where = [ $where_key => $where_value ]; \n    $wpdbupdate = $wpdb->update($wpdb->prefix.$table, $data, $where);\n \n    // $wpdbupdate =  $wpdb->query(\n    //     $wpdb->prepare( \"UPDATE $wpdb->prefix.$table SET $data_key = %s WHERE $where_key = %d\", $data_value, $where_value )\n    // );\n\n    $wpdb->show_errors = TRUE;\n    $wpdb->suppress_errors = FALSE;\n    if($wpdbupdate === 0){\n        $response['error'] = $wpdb->last_error;\n        $response['query'] = $wpdb->last_query;\n        $response['status'] = 200;\n    }else{\n        $response['error'] = $wpdb->last_error;\n        $response['query'] = $wpdb->last_query;\n        $response['status'] = 400;\n    }\n\n    return new WP_REST_Response($response, 123);\n}\n\nBut the strange thing is, that the first try to update the field with a new value always returns false (status:400).\nThe second try (just send POST request again) will update the field as expected.\nIn both cases, the queries are exactly the same:\n\"UPDATE izq5I_my_customer SET user_color = 'red' WHERE user_id = 2169\"\nI also tried the prepare() function, but this gives the same results.\nWhat else can i try to find the reason for this strange behavior?\n\nA: Short answer:\nYou have a logical error in your code, this condition is wrong:\n if($wpdbupdate === 0)\n\nReplace it with:\nif($wpdbupdate >= 0)\n\nand it will work as expected.\nLong explanation:\n$wpdb->update method returns the number of rows updated, which is 1 in your case, so your code continues to the next block and status 400 is assigned.\nSee WP documentation on $wpdb->update: https://developer.wordpress.org/reference/classes/wpdb/update/\n\nReturn #\n(int|false) The number of rows updated, or false on error.\n\nYour code only returns status 200 when nothing is updated and $wpdb->update returns zero, and the strange behaviour goes by this scenario:\n\n*\n\n*table row updated, the update returns 1, which triggers status 400\n\n*nothing is updated on second attempt, the update returns 0, which triggers status 200\n\nTo fix this, change your if condition to\nif($wpdbupdate >= 0)\n\nto return status 200 when a row is updated or ignored (because the update contains value equal to the existing one), or\nif($wpdbupdate > 0)\n\nto return status 200 only if a value is changed\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402689", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom menu not showing even though it shows as being registered? I'm running into a really weird problem.\nSome quick background: I cloned this workflow from one I've been using before but just updated everything including node packages and the gulp functions and workflow. This worked perfectly fine before and now it's suddenly giving errors and not working as expected.\nSo I'm trying to create custom menus and have them registered like I normally do:\nregister_nav_menus([\n            'primary' => 'Primary Menu',\n            'secondary' => 'Footer Menu',\n            'tertiary' => 'Legal Menu'\n        ]);\n\nI noticed it doesn't display at all but still shows up in the admin dashboard to add/remove items. So I did some testing and this is what I got:\n<?php\n                        $menus = get_registered_nav_menus();\n \n                        foreach ( $menus as $location => $description ) {\n                         \n                            echo $location . ': ' . $description . '<br />';\n                        }\n\n                        echo has_nav_menu('primary')?'true<br />':'false<br />';\n                        $registered_nav_menus = get_registered_nav_menus();\n                        echo isset( $registered_nav_menus[ 'primary' ])?'true<br />':'false<br />';\n                        \n                        $locations    = get_nav_menu_locations();\n                        var_dump($locations) ;\n\n                        $locations = get_theme_mod( 'nav_menu_locations' );\n                        print_r($locations);    \n\n                        wp_nav_menu( array( \n                            'menu' => 'primary', \n                            'theme_location' => 'primary',\n                        )); \n                        ?>\n\nAnd this code give me this output:\nprimary: Primary Menu\nsecondary: Footer Menu\ntertiary: Legal Menu\n\nfalse\ntrue\n\narray(0) { } \nArray ( )\n\n// These are not the correct menu items, it should only be showing the first 3. This is showing all pages on the website\nHome\nAbout\nContact\nPrivacy Policy\n\nBasically, some functions show that it is registered and show the registered menus, while others show it isn't. I normally don't ask questions here because it's usually an error on my end so I eventually manage to find the problem, but in this case I can't think of any other reason this could happen unless there's a bug in the latest WordPress version.\nIf anyone could provide some insight on this that'd be amazing as I'm completely stumped!\nWordPress version: 5.9\nPHP version: 7.4.27\n\nA: Do you check the menu already set to the location?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402691", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to separate two columns from one content on a page template? I am just creating my first serious web project built on Wordpress and during my task (basically learning by doing) i came to a following problem. The designer wants to show two columns of text on left and right side of the body of the webpage. Mostly that is of no problem, however the thing is, that the menu with some social media icons and quite a big logo is not located as a one straight flexbox or row, but makes a square on the upper right corner of the web page body.\nAnd now, i would like to archieve to somehow fit the right column of the text bellow the menu. I tried few CSS approaches, creating a special CSS classes but nothing basically works, as both columns are wrapped by the content function. The situation can be seen here: http://lachende.prognocon.cz/?page_id=30 for the sake of clarity i have highlighted the desired column to be moved with red colour.\nHere is the original drawing from the designer how he would like the page to be displayed - https://lachende.prognocon.cz/target2.png\nHere is the loop i use to call the content (my PHP proficiency is basically none, it is just that one works for me, so perhaps i did it all wrong):\n<?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>\n        <div id=\"content\" role=\"main\">\n\n        <?php  the_content(); ?>\n\n        </div><!-- #content -->\n\n<p><?php _e('Sorry, nothing here'); ?></p>\n\nThe only way i have been able to solve it is to create two separate div blocks in the page itself and align those, which basically works fine, however i would to find any sollution where i can input the text through the Wordpress page/content creation, so end-users can edit and create the texts themselves. Maybe there is some way how do it with some Javascript or use different method od PHP loop? Any help would be appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402693", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to encode author ID in the author permalink My permalink urls for users look like /author/1 (original author ID)\nIs it possible to replace author ID with an encoded number\nIn my dream author permalink should look like /author/56c96e766f8334 (a limited encoded string).\nThanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402696", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How does one update complex options? I'm using Tom McFarlin's WordPress-Plugin-Boilerplate along with JoeSz's Tutorial.\nI'm loading in a complex options item using\n$options = get_option($this->plugin_name);\n\nThis works fine for the load and for accessing the items. What I don't understand as yet is how to update the modified options back into the db.\nFor example, if I update the $options blob with\n$options['stamp1'] = (isset($input['stamp1']) && !empty($input['stamp1'])) ? esc_attr($input['stamp1']) : (new DateTime('NOW'))->format('c');\n$options['stamp2'] = (isset($input['stamp2']) && !empty($input['stamp2'])) ? esc_attr($input['stamp2']) : (new DateTime('NOW'))->format('c');\n$options['stamp3'] = (isset($input['stamp3']) && !empty($input['stamp3'])) ? esc_attr($input['stamp3']) : (new DateTime('NOW'))->format('c');\n$options['stamp4'] = (isset($input['stamp4']) && !empty($input['stamp4'])) ? esc_attr($input['stamp4']) : (new DateTime('NOW'))->format('c');\n\nthe documentation for update_option makes it's obvious that\nupdate_option($this->plugin_name );\n\nisn't going to work.\nThere is a register_setting in my class-...-public.php but it's not particularly obvious (to me anyway) how this gets called and whether it's actually updating the options in the db.\nClues?\n\nA: Having figured it out I'm a bit embarrassed. Nevertheless,\n        update_option($this->plugin_name, $options);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402698", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: porto theme pagination on woocommerce not working here i use code shortcode of woo commerce and whenever i reload page pagination showed up then hide\ni used this code\n[products limit=\"12\" columns=\"5\" paginate=\"true\" visibility=\"featured\" ]\nand when i check with inspect tool\n\nthe css have\nelement.style {\nopacity: 1;\ndisplay: none;\n}\nthis code but when i uncheck diplay pagination showed up and i found a this line in content product archive\ndo_action( 'woocommerce_no_products_found' );\n?>\n\n<div class=\"shop-loop-after clearfix\" style=\"none\"> </div>\n\n<?php\n\nnothing happen if i change style setting\\\nplz someone help me out\ni m using default option not ajax pagination style\n\nA: ok i add these code in additional css\n.shop-loop-after {\ndisplay: block !important;\n}\n.shop-loop-before {\ndisplay: flex !important;\n}\npagination showed up but when i click to change page , pagination and deafualt sorting not working and also not changing into list style or grid style\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402700", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: image resizing on post content without css and html tags Background:\nI am using WordPress posts for Newsletter. I am importing the posts through an api and use them in a Newsletter tool to send them out. I am downsizing the featured image before feeding to the Newsletter tool. But now I am facing some troubles, sometimes I have High resolution post content images.\nIssue:\nI need to resize those inner images of post content but without using any css and html image tags attributes as I am using them for the Newsletter purpose.\nI know that how to handle that with html and css tags like bellow;\n<img class=\"wp-image-290893 aligncenter lazyloaded\" src=\"https://fcam.b-cdn.net/blog/wp-content/uploads/Finnair_A350_Business_Class_Seat_Champagne_Glass.jpg\" alt=\"\" sizes=\"(max-width: 1000px) 100vw, 1000px\" srcset=\"https://fcam.b-cdn.net/blog/wp-content/uploads/Finnair_A350_Business_Class_Seat_Champagne_Glass.jpg 1985w, https://fcam.b-cdn.net/blog/wp-content/uploads/Finnair_A350_Business_Class_Seat_Champagne_Glass-158x100.jpg 158w, https://fcam.b-cdn.net/blog/wp-content/uploads/Finnair_A350_Business_Class_Seat_Champagne_Glass-768x485.jpg 768w, https://fcam.b-cdn.net/blog/wp-content/uploads/Finnair_A350_Business_Class_Seat_Champagne_Glass-1024x646.jpg 1024w, https://fcam.b-cdn.net/blog/wp-content/uploads/Finnair_A350_Business_Class_Seat_Champagne_Glass-237x150.jpg 237w\" data-ll-status=\"loaded\" width=\"1000\" height=\"631\">\n\nMy question is whether there is anyway to downsize these images if those are exceeding certain width(perhaps 800px) in real. This optimization helps to save lot of bandwidth as per my calculation.\nAny help would be really appreciating.\n\nA: You should look at the following: https://developer.wordpress.org/reference/functions/add_image_size/\neg add this to your theme's functions.php or plugin:\nadd_image_size( 'newsletter-image', 800, 600 ); // 800 pixels wide by 600 pixels tall, soft proportional crop mode\n\nThen use the image like this:\nif ( has_post_thumbnail() ) { \n    the_post_thumbnail( 'newsletter-image' ); \n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402703", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: A plugin that downloads other plugins Is it possible to create a plugin that allows me to download certain plugins from the WordPress repository?\nI wish to install my custom plugin and from a list of plugin in it, i want to download them.\nBecause i need specific plugins for every site.\nThanks\n\nA: A lots of Premium theme use http://tgmpluginactivation.com/.\nIt should do the job.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402704", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Understrap child theme JS not working in custom-javascript.js file I'm developing a Wordpress custom theme using the child-theme of Understrap.\nI'm adding my custom jQuery to child-theme > src > js > custom-javascript.js, and the file is already commented with \"// Add your custom JS here.\"\nhttps://github.com/understrap/understrap-child/blob/main/src/js/custom-javascript.js\nI did this as instructed from the Understrap Documentation:\n\n\"Add your own JS to /src/js/custom-javascript.js to have them bundled into /js/child-theme.js.\"\nhttps://docs.understrap.com/#/understrap-child/npm\n\nI've run the script in the console, and it works as intended, so the error is not with my script.\nYes, I have tried clearing my cache.\nI've seen a few other questions related to needing to update a gulpfile.js, but no such file is included in my child OR parent theme, I have used the search function, and I also cannot find it on the Understrap GitHub repo.\nIs the script not enqueuing properly? Have I missed something?\nThanks in advance.\nEDIT: RESOLVED\nWas unable to find the source of the error. Ended up doing a fresh install of the Understrap child theme, and migrating my custom files over. This eventually resolved my problem and the JavaScript started working again.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402705", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to merge the array values in foreach? I have tried to get the checkbox values from postmeta field but cant merge the array into single result\n$get_info_contact =     get_post_meta( $result, 'wpcf-society-info-contact', true );\n\n$combined = '';\n                            foreach($get_info_contact as $contacts){\n                                 foreach($contacts as $contact) {\n                                     $combined .= 'and';\n                                    $combined .= $contact;\n                                }\n                            }\n                            \n                            echo $combined;\n\n    Output: \n    \nandalcorandpresident\n\n    Expected output:\n    \n   alcor and president\n\n\nA: $combined = '';\n\n$k=0;\nforeach($get_info_contact as $contacts){\n    foreach($contacts as  $contact) {\n        //$combined .= 'and';\n        //if(in_array($key\n        if($k==0){\n            $combined .= ucfirst($contact);\n        }else{\n            $combined .= ' and '.ucfirst($contact);\n        }\n    }\n    \n    $k++;\n}\n\noutput:\n   alcor and president\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402708", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get main URL from subdirectory with php I have a WordPress site that contains multiple subdirectory installations of WordPress with individual databases inside one WordPress installation, and I want to link them together in the themes. But I couldn't figure out how to dynamically get the main URL from the base WordPress directory for one of the subdirectories.\nFor example, I tried to use get_home_url() but it only returns https://mytestsite.com/instance1 instead of https://mytestsite.com\nThis might be something basic but i couldn't find anything in my resarch that could help me out.\n\nA: site_url gets you the current sites URL, but you can get the site URL of the root blog at / via get_site_url by passing its ID, which is likely to be 1, e.g.:\n$url = get_site_url( 1 );\n\n\nAs an aside, you may find switch_to_blog and restore_current_blog to be useful, just know that they're not cheap to call, and it won't load code from the other blog/site, if the other site relies on a custom plugin or filters it won't be present unless it's also present on the current site.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402724", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I recompile js file in dist folder? I'm working on a project that loads a minified js file from my theme into a page <script type='text/javascript' src='http://localhost/mysite/wp-content/themes/mytheme-2021/dist/app.js?ver=5.9' id='app-js'></script>\nI have a webpack.mix.js file in my theme root directory:\nlet mix = require('laravel-mix');\n\nconst dist = `dist`\n\nmix\n  .options({ processCssUrls: false })\n  .copyDirectory('resources/fonts', dist)\n  .copyDirectory('resources/images', dist)\n  .js('resources/js/app.js', dist)\n  .sass('resources/sass/app.sass', dist);\n\nand a package.json\n{\n  \"dependencies\": {\n    \"laravel-mix\": \"^6.0.6\",\n    \"normalize-scss\": \"^7.0.1\",\n    \"reset-css\": \"^5.0.1\",\n    \"sass-mq\": \"^5.0.1\"\n  },\n  \"devDependencies\": {\n    \"sass\": \"^1.37.5\",\n    \"sass-loader\": \"^12.1.0\"\n  }\n}\n\nI've made changes to the resources/js/app.js file and I'm trying to understand how can I make the app rebuild the file? I've tried from command line npx webpack but without success. Maybe it's done via a plugin?\nCan anyone explain how is this thing working? Thanks in advance\n\nA: It appears that calling the following from your theme folder should do the job:\nnpm install\nnpm run build\n\nSource: \"How to Use Webpack in WordPress\".\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402727", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Problems with Layout inherit in theme.json I have in the theme.json of my FSE theme the following lines in the code:\n\"version\": 2,\n   \"settings\": {\n      \"layout\": {\n         \"contentSize\": \"840px\",\n         \"wideSize\": \"1100px\"\n      }\n   }\n}\n\nIf I now insert the following block in my index.html, it will be collapsed to the ContentSize width:\n<!-- wp:group {\"layout\":{\"inherit\":true},\"tagName\":\"main\"} -->\n<main class=\"wp-block-group\">\n\n<!-- wp:query -->\n<div class=\"wp-block-query\">\n    <!-- wp:post-template -->\n    <!-- wp:post-title /-->\n    <!-- wp:post-date /-->\n    <!-- wp:post-excerpt /-->\n    <!-- /wp:post-template -->\n \n    <!-- wp:query-pagination -->\n    <div class=\"wp-block-query-pagination\">\n        <!-- wp:query-pagination-previous /-->\n        <!-- wp:query-pagination-numbers /-->\n        <!-- wp:query-pagination-next /-->\n    </div>\n    <!-- /wp:query-pagination -->\n</div>\n<!-- /wp:query -->\n   \n</main>\n<!-- /wp:group -->\n\nNow when I want to do the same in the Footer, the content is not collapsed to the ContentSize:\n<!-- wp:group {\"layout\":{\"inherit\":true}} -->\n<div class=\"\"> Made by Reto Ulrich Mediendesign AG, <a href=\"https://www.rumede.ch\" class=\"link-primary\" target=\"_blank\">www.rumede.ch</a> </div>\n<!-- /wp:group --> \n\nCan someone tell me when exactly the layout:inherit works, or what has to be considered for it? And is there a possibility to scale to the wideSize instead of the ContentSize?\n\nA: To scale to wideSize you need to enable the wide alignment on the child block(s).\n-The second code example is incomplete, perhaps that is why the width was not correct for the footer.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402731", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "4"}}
{"text": "Q: Any ideas to trigger some code after plugin update? I have developed a plugin, that requires to do some maintenance tasks after a certain WordPress plugin has been updated in my sites.\nCurrently, what I do, is to have this WP plugin on manual updates, and every time I update it manually, I run the code afterwards.\nBut I would like to automate this process.\nAny ideas to makes this possible?\n\nA: I've always used the upgrader_process_complete hook:\nfunction my_plugins_update_completed( $upgrader_object, $options ) {\n\n    // If an update has taken place and the updated type is plugins and the plugins element exists\n    if ( $options['action'] == 'update' && $options['type'] == 'plugin' && isset( $options['plugins'] ) ) {\n        foreach( $options['plugins'] as $plugin ) {\n            // Check to ensure it's my plugin\n            if( $plugin == plugin_basename( __FILE__ ) ) {\n                // do stuff here\n            }\n        }\n    }\n}\nadd_action( 'upgrader_process_complete', 'my_plugins_update_completed', 10, 2 );\n\nMore info in the Codex: https://developer.wordpress.org/reference/hooks/upgrader_process_complete/\nHope that helps\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402738", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: wp_mail Allow Remote Attachments from CDN I came across a problem with WP_Mail for sending form submissions with file attachments. Our site uses a CDN, so everything uploaded to the site, whether images and media by site builders or documents by users gets put on an external server.\nThis poses a problem for WP_Mail because it uses the PHPMailer addAttachment method to attach files, which expects local files. I was able to fix this by changing the line in wp_mail to use addStringAttachment, but of course modifying core files isn't really a fix. What is the right way to do this?\nThanks.\n\nA: Solved by Tom J Nowell's suggestion. Our form plugin fortunately has a filter before the data is passed to wp mail, so there I was able to swap the attachment url for one pointing to the temporary folder.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402739", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Strange issue saving custom field data for a WooCommerce order I have an issue with WordPress update_post_meta() function.\nSo I have made a custom input field for WooCommerce orders which hold Tracking number.\nMost of the time everything is running smooth and I am able to add and update this number.\nHowever on some rare occasions I find that the tracking number is not saved for the order which is open, but rather is saved for another order.\nWhat I mean by that. For example if my $item_id is 2000, after the update has finished, I see in the logs or database that completely different ID has been updated (e.g. 1986).\nHere is the example code:\n$item_tracking_nr_data = 'EU373655223'\nupdate_post_meta( $item_id, '_custom_print_providers_item_tracking_nr', $item_tracking_nr_data );\n\nWhat I have tried:\n\n*\n\n*Deactivating all plugins\n\n*Switching to default WordPress theme\n\n*Manually setting the $item_id = 2000 and saving the tracking number\n\nI also tried hoking into custom field update process to see what goes on inside there to learn that yes, before and after the saving process the ID is indeed 2000, however during the saving process inside the function the value somehow has changed to 1986.\nHere is the test I did to learn that the\nfunction test_meta_data($check, $item_id, $meta_key, $meta_value, $unique) {\n    var_dump( $item_id ); //This returns 1986 during the test\n}\n\nadd_filter('add_post_metadata', 'test_meta_data', 20, 5);\nadd_filter('update_post_metadata', 'test_meta_data', 20, 5);\n\nMaybe somebody has had something similar or notices if I'm doing something the wrong way?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402742", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Correct Way To Make Changes To A Wordpress Theme I'm just getting started with WordPress development and trying to understand the correct way to change small elements within a page such as Woocommerce: How to remove page title from storefront theme homepage\nIs creating a child theme standard in most WordPress site implementations? Or is it more common to add a lot of code to the  Additional CSS section of the Theme Customization page?\n\nA: If you're not the author of the parent theme, then it is better to create a child theme which overwrites the changes in the parent theme.\nWith a child theme, you can do more than just additional CSS, you can modify template layouts and add custom functions.\n\nA: God was away for a long while but when he paid attention to earth again he created GIT ;)\nMost themes (number out of thin air, but that is my experiance) do not understand that in order that \"clients\" will be able to use a child theme without worrying about future upgrades to the main theme breaking the site, the main theme has to have frozen interface which include APIs, hook usage and class usage. In practice this mostly means that any new updates are either a bug fixez or add functionality that have nothing to do with the already existing functionality of the theme.\nFew theme developers understand that, even fewer can manage to follow that rule.\nTherefor it is not clear at all that the main  advantage of child themes - being able to upgrade the main theme without breaking anythin, actually happens in real life.\nIf your changes are not trivial, you should concider creating a git repository, set the main theme on its own branch and have a separate branch for your production theme. When the main theme updates you can push the updates to its branch and merge them into your production branch.\nIf your site has many code modifications to the main theme, you might not going to bothere with that and just pick \"manually\" whatever security improvment there were in the main theme and ignore everything else.\nThis might be over your head right now if you just trying out wordpress development. In that case you might want to do it first in the \"canonical\" way with a child theme, but you are hopefully going to start using git if you haven't yet, and then it will take much less effort to just move to development model I described above.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402744", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to display a warning when an uploaded image is too small? I want to display a warning when a user uploads an image with too low a resolution. I don't want to block the upload, just give a warning.\nThe only option I see is wp_handle_upload_prefilter, but there you can only return an error which blocks the upload.\nadd_filter( 'wp_handle_upload_prefilter', function ( $file ) {\n    if ( str_contains( $file['type'], 'image' ) ) {\n        $image = getimagesize( $file['tmp_name'] );\n        if ( $image[0] < 1200 ) {\n            //How do I display this warning but not block uploading?        \n            $file['error'] = 'Image too small!';\n        }\n    }\n\n    return $file;\n} );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402746", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Best Constant to use to check if WordPress is running I have a program that can run standalone (outside WP) or inside WP. If the program is running 'inside' WP (via a custom template using appropriate enqueue scripts and add_actions), then there is a constant that the program needs to be defined - an email address that the standalone program will use.\nIf the program is running on a WP site (inside WP), then the program needs to use the WP admin email address (via the  get_option( 'admin_email' ) function.\nIf the program is standalone (on a non-WP site), then there is a different process that is used to set the email address used by the program.\nThere are many constants defined within wp-config.php and wp-settings.php. What is a good  constant to use to check if WP is running? For instance, an option is ABSPATH.\nI am looking for a 'best practice' of which WP constant to check - and ideally would be a constant that is not likely to be used in a non-WP site (although I understand that this is impossible to guarantee).\n\nA: I don't know if others CMS or system may use ABSPATH or not but it's seems to be a generic words.\nI think I would check for a only-WP constant as WPINC or check if a WordPress function or Class exists\n\nA: Based on the other answer, I decided that looking for a specific WP function is the best approach to determine if my code is running in WP or not.\nI used this code block:\nif (function_exists('get_bloginfo')) {    // most likely a WordPress function\n    if (get_bloginfo('admin_email')) {   // set it only if there is a value (a double-check)\n        $admin_email = get_bloginfo('admin_email');\n    }\n}\n\nIt first checks if the get_bloginfo function exists, because I need to let a prior setting of $admin_email 'stand' if not running withing WP.\nThe second line checks for a value for the 'admin_email', which will be set in any WP installation. This is to handle any chance that there is a get_bloginfo() in a non-WP site. There might be a get_bloginfo() in the non-WP site, but even less a possibility that there is a 'admin_email' setting that will be available on a non-WP site.\nThe next line sets that variable.\nThis is probably not a perfect solution, but I think it handles enough possibilities that it is 'good enough'. With this code, I can get the WP site's admin-email, if the application is running on a WP site. Otherwise, I use the value previously set in the program.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402749", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Wordpress Set A Static Page/Template For All Sub-Pages I have a wordpress install where I want to serve a static page/template for anyone arriving at a child of a certain page, e.g.\nhttps://example.com/products/*\n\nWould all serve a php template from within Wordpress (or even just a static file) without changing the slug, so the following:\nhttps://example.com/products/some-product-slug\nhttps://example.com/products/another-product-slug\n\nWould both serve the same file without changing/redirecting the URL.\nThis template would also handle 404s internally, so a slug like:\nhttps://example.com/products/does-not-exist\n\nWould still serve the same static template.\nIs this possible to configure within wordpress?\nImagine that the page/template being redirected to is completely unrelated to a post type or hierarchy, as it is serving external resources based on the slug.\n\nA: Okay so I have resolved this by combining several different wordpress functionalities:\n\n*\n\n*Catches the template include conditionally add_filter( 'template_include', '...' );, in my case based on a regex match of the expected URI pattern\n\n*locate_template('example-template.php') to then resolve my (essentially) static template\n\n*A query within my example-template.php that externally retrieves the resource\n\n*This must handle 404s interally as the response will always assume the post can't be found, I am always setting the header response (before get_header in the template to 202 where the resource is found.\n\n*Example; if ($resource) { @header($_SERVER['SERVER_PROTOCOL'] . ' 202 Accepted', true, 202); }\nBit convoluted, but really not too much work for what I required.\n\nA: This solve the problem for me, only need the Parent-Post-ID and the full path of the template to be used for all subpages\nIn functions.php I have this code:\nadd_filter( 'template_include', 'template_subpage', 99 );\nfunction template_subpage( $template ) {\n\n    global $post;\n    if($post->post_parent == $selected_parent_id){ // the id of the parent\n\n        $template = get_template_directory() . '/template-subpage.php'; // template to assign to subpages\n    }\n    return $template;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402750", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to determine primary editor for a page/post We are working on a plugin that is trying to hook into the WordPress Classic Editor, but only want to load the code if the Classic Editor itself is going to be used on the page/post for editing.\nWe don't want to load the code on the page/post editor page if it's one that a page builder like Elementor is set up on and the Classic Editor wont appear anyway. While we know how to check to see if a plugin is installed and active or not, since page builders can be active on the website but not being used on a specific page/post we we're looking for a way to check for that so the code will only run if the Classic Editor is actually going to show up.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402761", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Setting wp_temp_dir and permissions not working for \"Missing A Temporary Folder\" error I have a problem uploading files to my main webpress site (e.g. www.main.com) and all the other pages that live in it (e.g. www.main.com/anotherpage). I know there is a method to set a temp folder like\ndefine( 'WP_TEMP_DIR', dirname(__FILE__) . '/wp-content/temp/' );\nbut I have already put this line in the wp-config.php file but I did have any success. Also I have already changed all permissions to the folders using (maybe is better to use 775, but I wanted to check if that could help)\nsudo chmod 777 /wp-content/temp\nBut I did not have any success either. I am not really sure where this problem came from; maybe after a plugin update.\nI am pretty new in wordpress and I'm not sure how to proceed. I hope someone can give a hint with this problem. Thanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402763", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to display list of custom post taxonomy terms and their posts (if any)? So I've created a custom post type (location) and a custom taxonomy (city) to go with it. I'm trying to set up a page where it lists the taxonomy terms followed by any posts associated with that term. But if there are no posts for that term, then nothing shows up.\nI'm trying to do something like:\nTerm 1\n\n*\n\n*post\n\n*post\n\n*post\n\nTerm 2\n\n*\n\n*post\n\n*post\n\nTerm 3 (empty)\n\n*\n\n*there are no posts for this term\n\nHow do I do that? Here is the code that I have (code updated to reflect recommendations from the comments below):\n<?php\n    $taxonomy       = 'city';\n    $args           = array(\n        'taxonomy' => $taxonomy,\n        'hide_empty'     => false,\n        'orderby'  => 'count',\n        'order'    => 'DESC',\n    );\n    $taxonomy_terms = get_terms( $args );\n\n    if ( $taxonomy_terms ) {\n        foreach ( $taxonomy_terms as $taxonomy_term ) {\n\n            $args = array(\n                'post_type'      => 'location',\n                'posts_per_page' => - 1,\n                'hide_empty'     => false,\n                'tax_query'      => array(\n                    'relation' => 'AND',\n                    'taxonomy' => $taxonomy,\n                    'terms'    => $taxonomy_term->slug,\n                    'field'    => 'slug',\n\n                ),\n            );\n\n        $query = new WP_Query( $args );\n\n        if ( $query->have_posts() ) : ?>\n            <h4><?php echo $taxonomy_term->name; ?></h4>\n            \n            <div class=\"locations\">\n            \n            <?php while ( $query->have_posts() ) : $query->the_post(); ?>\n\n                <div class=\"location\">\n                    <div class=\"price\"><a href=\"<?php the_permalink(); ?>\"><?php the_field('price_per_month'); ?> / month</a></div>\n                    <a href=\"<?php the_permalink(); ?>\">\n                        <h3><?php the_field('street_address'); ?></h3>\n                        <h4><?php the_field('city'); ?>, <?php the_field('state'); ?></h4>\n                    </a>\n                    <a href=\"<?php the_field('google_map_link'); ?>\" rel=\"noreferrer\" target=\"_blank\"><i class=\"fal fa-map-marker-alt\"></i> Google Maps</a>\n                </div>\n                \n            <?php endwhile; ?>\n\n            </div>\n\n        <?php else : ?>\n\n            <h4><?php echo $taxonomy_term->name; ?> (Coming Soon)</h4>\n\n            <div class=\"locations\">\n\n                  <div class=\"location coming\">\n                      <h3></h3>\n                      <h4></h4>\n                      <a href=\"#\" target=\"_blank\"></a>\n                  </div>\n\n                  <div class=\"location coming\">\n                      <h3></h3>\n                      <h4></h4>\n                      <a href=\"#\" target=\"_blank\"></a>\n                </div>\n\n            </div>\n\n        <?php wp_reset_postdata();\n        endif;\n\n    }\n}\n?>\n\nAny help would be hugely appreciated!\n\nA: As per the docs: https://developer.wordpress.org/reference/functions/get_terms/ the way to get terms has changed in WP 4.5. It's always good to keep the new way of dev.\nThats said, this code seems to work on my side:\n    $taxonomy       = 'city';\n    $args           = array(\n        'taxonomy' => $taxonomy,\n        'orderby'  => 'count',\n        'order'    => 'DESC',\n    );\n    $taxonomy_terms = get_terms( $args );\n\n    if ( $taxonomy_terms ) {\n        foreach ( $taxonomy_terms as $taxonomy_term ) {\n\n            $args = array(\n                'post_type'      => 'location',\n                'posts_per_page' => - 1,\n                'hide_empty'     => false,\n                'tax_query'      => array(\n                    'relation' => 'AND',\n                    'taxonomy' => $taxonomy,\n                    'terms'    => $taxonomy_term->slug,\n                    'field'    => 'slug',\n\n                ),\n            );\n\nI usually use https://generatewp.com/wp_query/ to generate my queries.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402764", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Oxygen Repeater Advanced Query Looking for some help with a repeater using an advanced query using ACF.\nI've got two custom post types: Product, Vendor\nVendor has a sponsored field.\nProduct has a relationship field connected to Vendor\nI am trying to sort the Product Archive loop by the sponsored field, so that Vendors that are sponsored have their products show at the top of the list.\nI can't for the life of me figure out who that query should be written. It's been like 3 hours of attempting everything to no avail!\n\nA: I hope this helps\nI added comments to the WP_Query array below.\n<?php \n\n// query\n$the_query = new WP_Query(array(\n    'post_type'         => 'event',  // (the post type / custom post type)\n    'posts_per_page'    => -1,\n    'meta_key'          => 'featured',  // (acf-field-name-NOT-label)\n    'orderby'           => 'meta_value', // (Don't change)\n    'order'             => 'DESC' // (or ASC or RAND)\n));\n\n?>\n<?php if( $the_query->have_posts() ): ?>\n    <ul>\n    <?php while( $the_query->have_posts() ) : $the_query->the_post(); \n        \n        $class = get_field('featured') ? 'class=\"featured\"' : '';\n        \n        ?>\n        <li <?php echo $class; ?>>\n            <a href=\"<?php the_permalink(); ?>\"><?php the_title(); ?></a>\n        </li>\n    <?php endwhile; ?>\n    </ul>\n<?php endif; ?>\n\n<?php wp_reset_query();  // Restore global post data stomped by the_post(). ?>\n\nhttps://www.advancedcustomfields.com/resources/orde-posts-by-custom-fields/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402766", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: \"Products\" Title changed \nHow can I change this title? I would like to chage it \"products\" instead of \"PRODUCTOos\"\n\nA: Which WordPress locale do you use?\nSpanish (es_ES) seems to be correctly translated: https://translate.wordpress.org/projects/wp-plugins/woocommerce/stable/es/default/?filters%5Bstatus%5D=either&filters%5Boriginal_id%5D=579432&filters%5Btranslation_id%5D=23145308\nAre your translation up to date ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402767", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: getBoundingClientRect() showing different values on load vs scroll I'm working on a site for a client and trying to implement custom parallax functionality. I have used the following code -\nvar inView = function(element) {\n    // get window height\n    var windowHeight = window.innerHeight;\n    // Get Element Height\n    var elementHeight = element.clientHeight;\n    // get number of pixels that the document is scrolled\n    var scrollY = window.scrollY || window.pageYOffset;\n\n    // get current scroll position (distance from the top of the page to the bottom of the current viewport)\n    var scrollPosition = scrollY + windowHeight;\n\n    var elementPosition = element.getBoundingClientRect().top + scrollY;\n\n    var elementScrolled = elementPosition + element.clientHeight + windowHeight\n\n    // is scroll position greater than element position? (is element in view?)\n    if (scrollPosition > elementPosition && scrollPosition < elementScrolled) {\n    return true;\n    }\n    return false;\n}\n\n// Get all the elements to be parallaxed\nconst parallaxElements = {\n    element: document.querySelectorAll('#header-image img'),\n    ratio: 0.25\n}\n\n// The parallax function\nconst parallax = elements => {\n    let items       = [...elements.element],\n        itemRatio   = elements.ratio\n\n    if ('undefined' !== items && items.length > 0 ) {\n        items.forEach( item => {\n            if ( inView(item) == true ) {\n                item.style.transform = 'translate3d(0, ' + (itemRatio * (window.innerHeight - item.getBoundingClientRect().top)) + 'px ,0)'\n            }\n        })\n    }\n}\n\n//If element is in viewport, set its position\nparallax(parallaxElements)\n\n//Call the function on scroll\nwindow.onscroll = () => {\n    parallax(parallaxElements)\n}\n\nIt's working ok except that when the page is loaded initially and the user starts scrolling, the position of element (#header-image img in this case) changes abruptly. I did some digging and noticed that the value of getBoundingClientRect().top is causing the issue.\nWhen the page is loaded, it has some value, and as soon as the user starts scrolling, it abruptly changes to another value.\nI am not able to figure out why this is happening. getBoundingClientRect().top is supposed to get the value of element from top of viewport, right?\nAny help is greatly appreciated. Thanks!\nPls check the screenshot of inspect element below -\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402772", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Post Publish date not display on Umaya Child themes I can't find out the option of published date or modified date on my blog post. I write the this code <?php echo get_the_date() ?> but can't display the date. this is my blog post where I try to display the published or modified date. My website Link: www.applavia.com\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402774", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Error establishing a database connection in wordpress site , website not opening i had my website using wordpress in cpanel with PHP 7.4 version ,\nmysql 5.6.41-84.1 version , i got Error establishing a database connection\ntried enable\ndefine('WP_DEBUG', true); \n\ngot\nWarning: mysqli_real_connect(): The server requested authentication method unknown to the client [mysql_old_password] in /home/user/public_html/abc/wp-includes/wp-db.php on line 1612\nWarning: mysqli_real_connect(): (HY000/2054): The server requested authentication method unknown to the client in /home/user/public_html/abc/wp-includes/wp-db.php on line 1612\nWarning: mysql_connect(): The server requested authentication method unknown to the client [mysql_old_password] in /home/user/public_html/abc/wp-includes/wp-db.php on line 1643\nWarning: mysql_connect(): The server requested authentication method unknown to the client in /home/user/public_html/abc/wp-includes/wp-db.php on line 1643\nThe server requested authentication method unknown to the client\nany clues to resolve this issue\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402776", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Compare custom field values I have created a page that receives information and filters the posts by that choice. The page gets the information with _GET and I use the following code to send the query\n$postss = new WP_Query([\n                'post_type'      => 'post',\n                'meta_query' => \n                array( \n                    array(\n                        'key' => 'City:',\n                        'value' => $city,\n                        'compare' => 'LIKE',\n                    ),\n                    array(\n                        'relation' => 'OR',\n                        array('key' => 'Time:',\n                        'value' => 'hour',\n                        'compare' => 'LIKE',\n                        ),\n                        array('key' => 'Time:',\n                        'value' => 'min',\n                        'compare' => 'LIKE',\n                        ),\n                    ),\n                ),\n                'cat' => $category,\n                'posts_per_page' => 9,\n                'post_status'    => 'publish',\n                'paged'          => $paged\n            ]);\n\nHowever my issue is, I have an input where the user can specify the city, then the category and then the time. The city and category work fine, but when we come to time I have placed few options with a drop down : under 1 hour, under 2 hours, under 3 hours etc . With this I can easily check with php if the time value is 1 2 3 etc and simply create the query\nwhere time LIKE '%hour%'\n\nhowever when the user chooses the 1, means that it's not just 1 hour, but it can also include minutes, so for example 30 minutes, so the results shold include 1 hour, but all minutes, so the query should be something like\nwhere time like '%min%' OR time like '%hour%' \n\nAlso there is an issue, I don't know how exactly to add the % symbol (because sometimes there is 10 min sometimes it's 20 minutes - plural) so\nLIKE '%min%' \n\nwould be okay, but not the same for hous, since if i do\nLIKE '%hour%'\n\nit will also include hours (2 3, not just 1 hour), so it should be\nwhere time like '%hour'\n\nin sql is easy, but with the wp_query I am not sure where to place the % symbol.\nps:I read that when I use the LIKE with meta_query automatically adds the % symbols at fron and end of the string, is there a way to remove them and just add it at front or in back, but not both?\nExample values in meta:\nCity:New York, Tokyo, London\nTime:10 minutes, 5 minutes, 20 minutes, 1 hour, 1.5 hours, 2 hours, 3 hours\n\nA: Instead of storing your values as \"5 hours 13 minutes\" instead store them as timestamps, e.g. 5:13 for 5h 13m\nThis way you can use the date/time comparator operations to answer questions\nE.g. to get items under 5 hours and 30 minutes:\n$args = [\n    ...\n    'meta_query' => [\n        [\n            'meta_key'     => 'time',\n            'meta_value'   => date( \"5:30\" ),\n            'meta_compare' => '<',\n            'type'         => 'TIME',\n        ],\n    ],\n];\n$query = new WP_Query( $args );\n\nThis will match a 3 hour post, or a 4:20 post, or a 5h 29min post.\nYou may need to add :00 for the seconds on to the end of all code and values.\nFor display you can use human_readable_duration. This will include the seconds though, but the function is very simple so copying and modifying it to your requirements should be straight forward.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402779", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Fetch all data of Users I am trying to fetch users All information by using below code.\nif($_POST['orga_id']) {\n        $users_query = new WP_User_Query(array(\n            'meta_query' => array(\n                'relation' => 'AND',\n                array(\n                    'relation' => 'OR',\n                    array(\n                        'key'     => 'first_name',\n                        'value'   => $_POST['search'],\n                        'compare' => 'LIKE'\n                    ),\n                    array(\n                        'key'       => 'last_name',\n                        'value'     => $_POST['search'],\n                        'compare'   => 'LIKE',\n                    ),\n                ),\n                array(\n                    'key'       => 'organisation',\n                    'value'     => $_POST['orga_id'],\n                    'compare'   => 'LIKE',\n                ),\n                array(\n                    'key'       => 'available',\n                    'value'     =>  1,\n                    'compare'   => '=',\n                ),          \n            )\n        ));\n    } else {\n        $users_query = new WP_User_Query(array(\n            'meta_query' => array(\n                'relation' => 'AND',\n                array(\n                    'relation' => 'OR',\n                    array(\n                        'key'     => 'first_name',\n                        'value'   => $_POST['search'],\n                        'compare' => 'LIKE'\n                    ),\n                    array(\n                        'key'       => 'last_name',\n                        'value'     => $_POST['search'],\n                        'compare'   => 'LIKE',\n                    ),\n                ),\n                array(\n                    'key'       => 'available',\n                    'value'     =>  1,\n                    'compare'   => '=',\n                ),          \n            )\n        ));\n    }\n\n    //$users_found = $users->get_results();\n\n    $args = array(\n        'fields' => 'all',\n        'orderby'     => array( 'last_name' => 'asc', 'first_name' => 'asc' ),\n        'meta_query' => $users_query,\n    );\n\n    $users2 = get_users($args);\n\nBut I am getting only few information like below.\nID: \"548\"\n\u200b\u200b\u200b\u200b\ndisplay_name: \"AaronKew\"\n\u200b\u200b\u200b\u200b\nuser_activation_key: \"\"\n\u200b\u200b\u200b\u200b\nuser_email: \"aaron.kew@nsw.scouts.com.au\"\n\u200b\u200b\u200b\u200b\nuser_login: \"AaronKew\"\n\u200b\u200b\u200b\u200b\nuser_nicename: \"aaronkew\"\n\u200b\u200b\u200b\u200b\nuser_pass: \"$P$BauZua136ZxKPY9Nu2FpmZT1LRmOLr1\"\n\u200b\u200b\u200b\u200b\nuser_registered: \"2022-02-06 03:17:50\"\n\u200b\u200b\u200b\u200b\nuser_status: \"0\"\n\u200b\u200b\u200b\u200b\nuser_url: \"\"\n\n\nI am not getting first_name and last_name of users.\n\nA: Actually since you already have the ID you could just loop through and get the meta.\nhttps://developer.wordpress.org/reference/functions/get_user_meta/\nget_user_meta(ID)\n\n\nA: There's been a fundamental misunderstanding of how meta_query works. meta_query is meant to be an array, not a new WP_User_Query.\nThis is what you've done:\nget_users( [\n    ...args\n    'meta_query' => new WP_User_Query( [ ...meta args ] ) // incorrect usage!\n] );\n\nThis is what you should do instead:\n$query = new WP_User_Query( [\n    ... args,\n    'meta_query' => [ .... meta args ]\n] );\n\nRemember, get_users is a wrapper around WP_User_Query, and WP_User_Query is for finding users, not specifying meta parameters.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402786", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to limit post (Exception pages) for current user in each role in front end? Thank you for reading this question\nI need an option or code for each user in each role to see only their posts at the front end, and other users' posts to be completely hidden from them, even in search results (without any messages or effects).\nMore details:\nThe user has to log in to receive the content, and when they log in, they only sees their posts (as if there are no other posts on the website).\nI need all pages to be excluded (show for all). Only hide other users' posts\nAny help would be appreciated\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402789", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How Place a Custom Form Fields in a specific location on the User Profile Page? I am seeing a lot of how to add to fields to the user's profile page, via the\nfunction your_user_profile_fields($user)\n{\n//.... code here for field\necho '<h3 class=\"heading\">SubRoles : License</h3>';\n}\n\nadd_action( 'show_user_profile', 'your_user_profile_fields' );\nadd_action( 'edit_user_profile', 'your_user_profile_fields' );\n\nWhat I would like to know, is there a way to specifically place where these new fields go?\nFor example, I want my new field to go directly under the \"Role\" definition.  The data I am placing is a licensing info and directly related to personal information.\nName\nUsername XXXX\nRole    Customer\nLicense: XXXXXX <====== new field here\nFirst Name XXXX\nLast Name XXXX\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402794", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Group and list posts by custom taxonomy I'm trying to list posts from a CPT named \"exposition\" and group them based on a custom taxonomy called \"date-exposition\" (which are meant to be years such as 2010, 2015, 2017,...) in the following form :\n2019\n\n*\n\n*post 1\n\n*post 2\n\n2018\n\n*\n\n*post 3\n\n*post 4\n\netc...\nClosest code I managed to compile is this (it only shows one date/taxonomy-value and not the posts...) :\n<?php\n    // Get current Category\n    $get_current_cat = get_term_by('name', single_cat_title('',false), 'category');\n    $current_cat = $get_current_cat->term_id;\n\n\n    // List posts by the terms for a custom taxonomy of any post type\n    $post_type = 'exposition';\n    $tax = 'date-exposition';\n    $tax_terms = get_terms( $tax, 'orderby=name&order=ASC');\n    if ($tax_terms) {\n        foreach ($tax_terms  as $tax_term) {\n            $args = array(\n                'post_type'         => $post_type,\n                \"$tax\"              => $tax_term->slug,\n                'post_status'       => 'publish',\n                'posts_per_page'    => -1,\n                'category__in'      => $current_cat // Only posts in current category (category.php)\n            );\n\n            $my_query = null;\n            $my_query = new WP_Query($args);\n\n            if( $my_query->have_posts() ) : ?>\n\n                <h2><?php echo $tax_term->name; // Group name (taxonomy) ?></h2>\n\n                <?php while ( $my_query->have_posts() ) : $my_query->the_post(); ?>\n                    <?php $term_list = wp_get_post_terms($post->ID, 'category', array(\"fields\" => \"ids\")); // Get post categories IDs?>\n\n                    <?php if (in_array($current_cat, $term_list) ): // Display only posts that have current category ID ?>\n                        <h3><?php the_title(); ?></h3>\n                    <?php endif; // if in_array ?>\n\n                <?php endwhile; // end of loop ?>\n\n            <?php endif; // if have_posts()\n            wp_reset_query();\n\n        } // end foreach #tax_terms\n    } // end if tax_terms\n?>\n\nThanks for help. Please note I am really not good at PHP.\n\nA: I re-factored your code, there were quite some parts which seemed overly complex or used deprecated methods.\nIn the code below, I'm looping through your terms, and within that loop, I'm finding the posts relating to that term. Probably there's a more efficient way, since this is using several queries, but it should achieve the desired result.\n<?php\n// get the terms, ordered by name\n// https://developer.wordpress.org/reference/functions/get_terms/\n// https://developer.wordpress.org/reference/classes/wp_term_query/__construct/\n$taxonomy = 'date-exposition';\n$tax_terms = get_terms( \n  array(\n    'taxonomy' => $taxonomy,\n    'hide_empty' => false, // change to true if you don't want empty terms\n    'orderby' => 'name',\n    'order' => 'DESC',\n    'fields' => 'names', // return the term names only\n  )\n);\n\nforeach($tax_terms as $tax_term) { // loop through the terms\n  echo '<h2>' . $tax_term . '</h2>'; // echo the term name as a h2\n  $term_posts = get_posts( // find posts with the correct term\n    array(\n      'no_found_rows' => true, // for performance\n      'ignore_sticky_posts' => true, // for performance\n      'post_type' => 'exposition',\n      'posts_per_page' => -1, // return all results\n      'tax_query' => array( // https://developer.wordpress.org/reference/classes/wp_tax_query/\n        array(\n              'taxonomy' => $taxonomy,\n              'field'    => 'name',\n              'terms'    => array( $tax_term )\n          )\n      ),\n      'fields' = 'ids', // return the post IDs only\n    )\n  );\n  \n  echo '<ul>'; // open bullet list\n  foreach($term_posts as $term_post_id) { // loop through posts\n    $post_title = get_the_title($term_post_id); // get post title\n    $post_permalink = get_the_permalink($term_post_id); // get post link\n    echo '<li>'; // open list item\n    echo '<a href=\"' . $post_permalink . '\">' . $post_title . '</a>'; // add link to post with post title as link text\n    echo '</li>'; // close list item\n  }\n  echo '</ul>'; // close bullet list\n}\n?>\n\nhttps://codeshare.io/Jbyqvd\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402796", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: wp_temp_dir does not change the /tmp temporary default directory I have a problem changing the temporary folder. I have have define the new temporary folder using\ndefine( 'WP_TEMP_DIR', dirname(__FILE__) . '/wp-content/temp/' );\nbefore the line\n/* That's all, stop editing! Happy publishing. */\nbut without any success. I have created a small test.php script to checking the success of changing to the new temporary folder such that\n<?php echo sys_get_temp_dir() . PHP_EOL; ?> \nwith the output\n/tmp\nI have checked the permissions of the wp-config.php, wp-content/temp/ and wp-includes/functions.php files and they are the equivalent to 777.\nI am not sure how to proceed and I have not found a lot information on internet. I hope someone could give me a hint. Thanks in advance\n\nA: sys_get_temp_dir is not a WordPress function, it's a core PHP function. It cannot be modified or changed using WordPress constants. To modify this would require changes to the servers operating system by the root user.\nInstead, WP_TEMP_DIR can be used to influence the value of get_temp_dir which is a WordPress function.\n\nIn the event that this function does not find a writable location, It may be overridden by the WP_TEMP_DIR constant in your wp-config.php file.\n\nhttps://developer.wordpress.org/reference/functions/get_temp_dir/\nWP_TEMP_DIR gives you the opportunity to set up a temporary folder WordPress can use if it cannot find a system folder to do it. Perhaps because you are on a server that has been misconfigured, or perhaps systemd has been configured with PrivateTmp=true preventing /tmp from being used.\nget_temp_dir is used when generating files for download, or for setting constants for 3rd party libraries.\nI'm not sure what the problem is that you hoped to solve by changing the returned value of sys_get_temp_dir, but WP_TEMP_DIR is not the solution you hoped it to be, and does not do what you thought it did. You should create a question asking how to solve your original problem.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402799", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: wp post_tag change minlength I try to change minlength value from post tag search in wp-admin\n(wp-admin/js/tags-suggest.js) -> .fn.wpTagsSuggest -> options -> minLength \n\nbut  cant override this value\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402803", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hide 2022 Parent Theme Templates / Parts I'm playing with the new FSE and 2022 theme. I made a child theme and know how to create my own custom template/block parts but how can I hide the parent theme template I don't wish to use like templates/page-large-header.html?\nIs there a way to do this without modifying the parent theme?\n\nA: Update, after doing a ton of research and reading around, unregistering parent theme templates/parts like you can with blocks isn't possible. You can only copy files into the child theme and override. There is no way to hide unused parent theme template parts as I write this.\n\nA: The best way to handle this situation is via child-template overwrite.\nSince you already have a child theme (which is good), you only need to overwrite the according parts, in your case - the header template.\nNow - first you need to find out which template file you want to overwrite, because a header template may consist of several smaller child templates too.\nBest way to do this in my opinion is to use \"What the file\", small plugin which will show some template info in the upper right corner on the frontend (which file to overwrite).\nThen, create a new file with the same name, which will overrule the parent template/template-part.\nLeave that file empty (e.g. header.php), or return something else at that place/in that file as you wish. This is a simple template overwrite.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402806", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: For using google api is it necessary to install the google client libraries for using Oauth 2 in wordpress installation? In a wordpress installation I am trying to fetch data from the search google console api.\nSeems I need Oauth 2.0\nIs there some short code that I can use without installing all the libraries with composer?\nCannot find code which does it without the libraries.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402810", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Wordpress Template Reverts to default template after changing I am experiencing a problem regarding wordpress page template. after I change the wordpress template to \"Home Page\", it reverts to default template after update. I tried installing WP Super Cache then purging cache, but still no luck. I also Increased memory limit in server but still reverts to default. are there any fix to this? your help is greatly appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402815", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Rest API- Allow creation of users with identical email addresses when only using rest api I'am working on a new wordpress website, and I would like to create multiple users with the same exact email address. The purpose of this is to route several customer service accounts to a common email as means of consolidation.\nI started by registering an email field in the rest api, as email field is not included in the default rest api settings.\nHence the following code was added in my functions.php file:\nregister_rest_field( 'user', 'user_email',\n                        array(\n                            'get_callback'    => function ( $user ) {\n                                return get_userdata($user['id'])->user_email;\n                            },\n                            'schema'          => null,\n                        )\n                    );\n                \n\nThen I issue 2 simple post requests using python to create 2 accounts with the same email,as follows:\nimport base64\nimport requests\nimport json\n\nurl='https://mywebsite.com/wp-json/wp/v2/users'\n\nfrom Load_Credentials import user,password\n\ncredentials = user + ':' + password\ntoken = base64.b64encode(credentials.encode())\nheader = {'Authorization': 'Basic ' + token.decode('utf-8'),'Content-Type': 'application/json','User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36'}\n\n\n#first POST request with same email\nx1={\"username\": \"newuser1\",\"email\":\"newemail@newemail.com\",\"password\":\"check123\"}\nx1=json.dumps(x1)\nx1=json.loads(x1)\nr1=requests.post(url+'?status=publish',headers=header,json=x1)\n\n#second post request with same email\nx2={\"username\": \"newuser2\",\"email\":\"newemail@newemail.com\",\"password\":\"check123\"}\nx2=json.dumps(x2)\nx2=json.loads(x2)\nr2=requests.post(url+'?status=publish',headers=header,json=x2)\n\nThis is the response I'am getting:\n{'code': 'existing_user_email', 'message': 'Sorry, that email address is already used!', 'data': None}\n\nIs there a way to allow creating 2 accounts with the same email ONLY when using the rest api. (normal registration procedure should continue to flag duplicate emails)\nI appreciate your support on this matter.\n\nA: I don't think it's possible.\nUsing rest API or not do not change the fact WordPress is preventing it AT https://github.com/WordPress/wordpress-develop/blob/5.9/src/wp-includes/user.php#L2032\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402817", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Disable auto id attributes in Heading tag? I don\u2019t know why but WP is automatically adding id attributes to h2 tags. I am not supplying any id or class attribute and I don\u2019t need it. Also, it\u2019s adding type=\"1\" to <ol> tag that\u2019s not needed in my case.\nYou can see it on this page:\nhttps://idioms.a2hosted.com/2022/02/15/its-not-brain-surgery/\nPlease help, how to stop it?\nI need this:\n<h2>Meaning</h2>\n<h2>Example Sentences</h2>\n<h2>Origin</h2>\nThis is what WP doing with it.\n<h2 id=\"meaning\">Meaning</h2>\n<h2 id=\"example-sentences\">Example Sentences</h2>\n<h2 id=\"origin\">Origin</h2>\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402819", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: While creating Block Themes in Wordpress, how can I query custom posts for an Archive view? I am new to wordpress .. so please be kind..:-)..\nI was excited that WP could be used without knowing a lot of PHP. So I've gone ahead and created a block design and created a theme.. and it seems to be all working out well.\nHowever now I am at an obstacle. I am able to create a query loop as below (I used it from the Twentytwentytwo theme) and it works fine for Posts (the regular post type) and I have a custom post type called 'Products' so I assumed that by changing the post type in the query to 'product' it should work.. but it does not.\n    <!-- wp:query {\"query\":{\"perPage\":10,\"pages\":0,\"offset\":0,\"postType\":\"post\",\"categoryIds\":[],\"tagIds\":[],\"order\":\"desc\",\"orderBy\":\"date\",\"author\":\"\",\"search\":\"\",\"exclude\":[],\"sticky\":\"\",\"inherit\":true},\"layout\":{\"inherit\":true},\"tagName\":\"\"} -->\n    <!-- wp:post-template -->\n\n    <!-- wp:post-featured-image /-->\n    <!-- wp:post-title /-->\n\n    <!-- /wp:post-template -->\n    <!-- /wp:query -->\n\n\nSo my question is\n\n*\n\n*Is there a way to query custom post types in WordPress 5.9?\n\n*If not, then can you guide me on how I can use the block design template and use PHP to achieve displaying custom post types in an archive view?\n\n*Also can you please share some links on where I can find some info on how to create these queries by code.. basically the list of options available to use in the JSON format query option\n\nAny help or advise would be appreciated.\n\nA: I found a solution for this. So for those of you who face a similar situation, here's what I did (based on this solution : https://stackoverflow.com/questions/68871598/wordpress-query-loop-block-not-showing-custom-post-types)\nSo basically the custom post type that I had created needed to have this argument while registering the post-type in functions.php\n'show_in_rest' => true\n\n\nAnd then I just had to replace the post type in the query and all the results of the query showed up.\nAnd for those using the Full Site Editor view in WordPress the Block section for query loop will then display the registered custom post type in addition to 'Post' and 'Page' in the drop-down menu.\nSo custom posts types are supported in the query loop and it works well!!..:-)..\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402822", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to delete user using rest api without reassigning Iam trying to delete a subscriber user using rest api admin api account. However, the api seems to require specifying reassign user id however i dont want to reassign.\nIam using the python requests module, and I'am issuing a basic delete request as follows:\nimport base64\nimport requests\nimport json\n\nfrom Load_Credentials import user,password\n\nuserurl='https://mywebsite.com/wp-json/wp/v2/users'\ncredentials = user + ':' + password\ntoken = base64.b64encode(credentials.encode())\nheader = {'Authorization': 'Basic ' + token.decode('utf-8'),'Content-Type': 'application/json','User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36'}\n\nuserid=139\ndeleteurl='https://mywebsite.com/wp-json/wp/v2/users/139?force=True'\nresponse = requests.delete(deleteurl, headers=header)\n\nprint(response.json())\n\nThis is the response Iam getting:\n'code': 'rest_missing_callback_param', 'message': 'Missing parameter(s): reassign', 'data': {'status': 400, 'params': ['reassign']}}\n\nI understand that the request requires the reassign parameter, however, i dont want to reassign, I want to delete without reassigning. I tried reassign=false but also did not work:\ndeleteurl=https://myywebsite.com/wp-json/wp/v2/users/139?reassign=false?force=True\n\nheres the response:\n{'code': 'rest_invalid_param', 'message': 'Invalid parameter(s): reassign', 'data': {'status': 400, 'params': {'reassign': 'Invalid user parameter(s).'}, 'details': {'reassign': {'code': 'rest_invalid_param', 'message': 'Invalid user parameter(s).', 'data': {'status': 400}}}}}\n\nAny suggestions?\n\nA: Looking at the code for the users endpoint, I don't think this is possible. I also dug up this ticket on the issue which links to this ticket that confirms that this is a deliberate limitation.\nThe explanation is that WordPress does not give the option to delete users without either deleting their content or reassigning it to another author. This is because WordPress does not support content without an author. If this parameter were optional then it would be possible to leave behind content without an author.\nIt looks like there was talk about allowing deletion of a user's content by passing a false value, but that does not appear to have been implemented.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402823", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get specific values from WordPress meta_value a:1:{s:9:\"toys_item\";a:1:{s:16:\"toys_item_ranger\";a:11:{i:0;s:31:\"2 x Seadoo GTX 230/IBR Jet-Skis\";i:1;s:30:\"1 x HD Runway 10\u2032 Waterslide\";i:2;s:14:\"4 x F5 Seabobs\";i:3;s:49:\"3 x Water-Skis for children, teenagers and adults\";i:4;s:43:\"1 x 2 Person Nereus Kayak w/paddles & seats\";i:5;s:14:\"1 x Wake Board\";i:6;s:35:\"2 x Jobe Parana bamboo Paddleboards\";i:7;s:44:\"Seadoo Spark 900HO AXE 2UP/IBR Trixx Jet-Ski\";i:8;s:31:\"2 x Seadoo GTX 230/IBR Jet-Skis\";i:9;s:14:\"4 x F5 Seabobs\";i:10;s:43:\"1 x 2 Person Nereus Kayak w/paddles & seats\";}}}\nI want to show specific text from the above results, something like this:\n2 x Seadoo GTX 230/IBR Jet-Skis\n1 x HD Runway 10\u2032 Waterslide\n4 x F5 Seabobs\n3 x Water-Skis for children, teenagers, and adults\n1 x 2 Person Nereus Kayak w/paddles & seats\n1 x Wake Board\n2 x Jobe Parana bamboo Paddleboards\nSeadoo Spark 900HO AXE 2UP/IBR Trixx Jet-Ski\n2 x Seadoo GTX 230/IBR Jet-Skis\n4 x F5 Seabobs\n1 x 2 Person Nereus Kayak w/paddles & seats\nhere is my code\n<?php\nglobal $wpdb;\n$results = $wpdb->get_results( \"SELECT * FROM wp_postmeta where meta_key = 'fat-mb-boat-toys' AND post_id = $post_id\"); // Query to fetch data from database table and storing in $results\nif(!empty($results))\n    // Checking if $results have some values or not\n{    \n        echo \"<table>\";\n        echo \"<tr>\";\n        echo \"<th> Post ID <th>\";\n        echo \"<th> Meta Key <th>\";\n        echo \"<th> Meta Value <th>\";\n        echo \"</tr>\";\n\n    foreach($results as $row){\n       echo \"<tr>\";\n       echo \"<td>\". $row->post_id .\"<td>\";\n       echo \"<td>\". $row->meta_key .\"<td>\";\n       echo \"<td>\". $row->meta_value .\"<td>\";\n       echo \"</tr>\";\n    }\n        echo \"<table>\";\n\n\n}\n?> ```\n\n\nA: You should pretty much never need to use $wpdb to grab data. There are helper functions built into WordPress that will do what you need.\nIn this case, use get_post_meta().\nHaving used https://www.unserialize.com/ to unserialize your data, it looks like the item list in your question is in $meta['toys_item']['toys_item_ranger']. I'll use that in my code snippet to make a list like the one you're looking for.\n$meta = get_post_meta( $post_id, 'fat-mb-boat-toys', true );\nif (\n    ! empty( $meta )\n    && ! empty( $meta['toys_item'] )\n    && ! empty( $meta['toys_item']['toys_item_ranger'] ) \n) {\n    foreach ( $meta['toys_item']['toys_item_ranger'] as $toy ) {\n        echo $toy . '<br />';\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402826", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: When WP_CLI runs Wordpress from the command line, are hooks called? Yesterday, I found out that a website I worked on as a writer (I have no admin access) had been injecting malicious Javascript code in all its pages, as described in this article by Luke Leal.\nAccording to that article, a fake Wordpress plugin musts have been installed on that website to inject the malicious code.\nI want to draw your attention to this section of the malicious code:\n// This code is defined inside a PHP class...\nfunction save_striplple_plugin() {\n    global $wp_list_table;\n   $h = array('wp-striplple/wp-striplple.php');\n    $myplugins = $wp_list_table->items;\n    foreach ($myplugins as $key => $val) {\n        if (in_array($key,$h)) {\n        unset($wp_list_table->items[$key]);\n        }\n   }\n    \n}\n\npublic function striplple_start(){\n    ...\n    add_action('pre_current_active_plugins', [$this, 'save_striplple_plugin']);\n}\n\nThe second method adds the first method to the pre_current_active_plugins hook. According to the official documentation, that hook runs before creating a list of the installed plugins; not the active plugins, the installed plugins.\nThe first method runs when that action is called and deletes the fake plugin from the list of installed plugins.\nSo, I wondered how we could create a list of the installed plugins on a website that could not be manipulated by an attacker. A first way, from the top of my head, is to access the website through the FTP and see what's in the /plugins folder.\nThen I wondered if WP_CLI would show us this fake Wordpress plugin in the list of plugins. Although I've used WP_CLI before, I don't think I really understand its inner processes and how it interacts with a Wordpress installation.\nWhen WP_CLI runs Wordpress from the command line, are hooks called? Would a list of plugins generated with WP_CLI be manipulated by this fake Wordpress plugin?\n\nA: WP CLI will run plugins by default, so any hooks used in active plugins would be run.\nYou can tell WP CLI to not run the active plugins, though. To get the full list of plugins, even if a malicious plugin tries to hide itself, the following should work:\nwp plugin list --skip-plugins\n(Caveat: any must-use plugins will still be loaded. To disable MU plugins, you'd need to remove them from the wp-content/mu-plugins directory.)\n--skip-plugins is a global parameter, so you should be able to use it on any wp * command. --skip-themes is also available.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402829", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Load in wp admin assets from child theme I started  to create a child theme from a BoldThemes theme with custom icons. I am able to see icons when edit directly page,\n\nbut when try to edit page from wp admin, I've this issue\n\nI discovered with DevTools when I try to edit page from wp admin, system don't load assets from child but only from original theme\nThis is my functions.php\n<?php\nfunction my_theme_enqueue_styles() {\n\n    $parent_style = 'parent-style';\n\n    wp_enqueue_style( $parent_style, get_parent_theme_file_uri( 'style.css' ) );\n    wp_enqueue_style( 'child-style',\n        get_theme_file_uri( 'style.css' ),\n        array( $parent_style ),\n        wp_get_theme()->get('Version')\n    );\n}\nadd_action( 'wp_enqueue_scripts', 'my_theme_enqueue_styles' );\n\n?>\n\nOther info\nWordPress version wordpress:5.9.0-php8.0-apache  ( docker enviroment )\nI follow official documentation for create my cutom icons\nI copied admin-style.php from theme to child and added this line\n@font-face{font-family:\"Chess\"; src:url(\"' . get_stylesheet_directory_uri() . '/fonts/Chess/Chess.woff\") format(\"woff\"),url(\"' . get_stylesheet_directory_uri() . '/fonts/Chess/Chess.ttf\") format(\"truetype\");}\n*[data-ico-chess]:before{ font-family: Chess; content:attr(data-ico-chess); }\n.bt_bb_icon_preview.bt_bb_icon_preview_chess { font-family:Chess; }\n\n\nand the same for icons.php\n@font-face{  font-family:\"Chess\"; src:url(\"' . get_stylesheet_directory_uri() . '/fonts/Chess/Chess.woff\") format(\"woff\"),url(\"' . get_stylesheet_directory_uri() . '/fonts/Chess/Chess.ttf\") format(\"truetype\");\n}  *[data-ico-chess]:before{ font-family:Chess; content:attr(data-ico-Chess); }\n.bt_bb_icon_preview.bt_bb_icon_preview_chess{ font-family:Chess; }\n\nIf copy all in original theme work all, but  I want know if is possible resolve this problem with child theme ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402830", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: What's the most efficient way to write multiple WP_Queries on a page? This is a follow-up to my previous post regarding multiple categories/posts on one page.\nCurrently, I have a page filled with multiple loops of each category of a custom post type. The problem is that the code is becoming a bit much to edit and organize. Here's a small example of the multiple categories I have:\n$stratocaster_args = array(\n    'post_type' => 'diagram',\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'diagram-category', // Taxonomy slug\n            'terms' => 'stratocaster-wiring-diagrams', // Taxonomy term slug\n            'field' => 'slug',    // Taxonomy field\n        )\n    )\n);\n\n$telecaster_args = array(\n    'post_type' => 'diagram',\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'diagram-category', // Taxonomy slug\n            'terms' => 'telecaster-wiring-diagrams', // Taxonomy term slug\n            'field' => 'slug',    // Taxonomy field\n        )\n    )\n);\n$misc_fender_args = array(\n    'post_type' => 'diagram',\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'diagram-category', // Taxonomy slug\n            'terms' => 'misc-fender-wiring-diagrams', // Taxonomy term slug\n            'field' => 'slug',    // Taxonomy field\n        )\n    )\n);\n\n$stratocaster_query = new WP_Query($stratocaster_args);\n$telecaster_query = new WP_Query($telecaster_args);\n$misc_fender_query = new WP_Query($misc_fender_args);\n\n?>\n\n<div class=\"blog-archive\">\n\n    <?php get_template_part('template-parts/page', 'header'); ?>\n\n    <?php page_wrapper_open('wiring-diagrams'); ?>\n\n\n\n    <?php\n\n    /**Begin Wiring Diagram Results */\n\n    /**Strat */\n\n    if ($stratocaster_query->have_posts()) :\n\n        echo '<h2 class=\"main-heading gold-line\">STRATOCASTER WIRING DIAGRAMS:</h2>';\n\n        echo '<div class=\"wiring-diagram-results grid-4\">';\n\n        while ($stratocaster_query->have_posts()) :\n            $stratocaster_query->the_post();\n            get_template_part('template-parts/content', 'wiring-diagram');\n        endwhile;\n\n        echo '</div>';\n\n        wp_reset_postdata();\n\n    endif;\n\n    /**Telecaster */\n\n    if ($telecaster_query->have_posts()) :\n\n        echo '<h2 class=\"main-heading gold-line\">TELECASTER WIRING DIAGRAMS:</h2>';\n\n        echo '<div class=\"wiring-diagram-results grid-4\">';\n\n        while ($telecaster_query->have_posts()) :\n            $telecaster_query->the_post();\n            get_template_part('template-parts/content', 'wiring-diagram');\n        endwhile;\n\n        echo '</div>';\n\n        wp_reset_postdata();\n\n    endif;\n\n    /**Misc Fender */\n\n    if ($misc_fender_query->have_posts()) :\n\n        echo '<h2 class=\"main-heading gold-line\">MISC. FENDER WIRING DIAGRAMS:</h2>';\n\n        echo '<div class=\"wiring-diagram-results grid-4\">';\n\n        while ($misc_fender_query->have_posts()) :\n            $misc_fender_query->the_post();\n            get_template_part('template-parts/content', 'wiring-diagram');\n        endwhile;\n\n        echo '</div>';\n\n        wp_reset_postdata();\n\n    endif;\n\n........etc.\n\nIs there a more efficient way to write this to manage the code a little better? Sorry for the noob question.\n\nA: Split your code into smaller parts. For example, you can use a separate template part for each loop.\nThe get_template_part() function might be a good choice in your case.\n\nA: You could move the query configs into one config array and loop that for querying the posts and rendering the content sections. Inside the content section partial you'd have another loop for the posts.\nThe magic ingredient here is the third $args parameter you can use with get_template_part(). Use it to pass data to the partial file.\n$configs = array(\n  array(\n    'query' => array(\n      'post_type' => 'diagram',\n      'tax_query' => array(\n        array(\n          'taxonomy' => 'diagram-category',\n          'terms' => 'stratocaster-wiring-diagrams',\n          'field' => 'slug',\n        )\n      )\n    ),\n    'template_name' => 'wiring-diagram',\n    'heading' => 'Some heading text',\n  ),\n  // more configs...\n);\n\nforeach ( $configs as $config ) {\n  $config['query'] = new WP_Query( $config['query'] );\n  if ( ! $config['query']->posts ) {\n    continue;\n  }\n  \n  get_template_part( 'template-parts/content-section', null, $config );\n}\n\nSection partial,\n<h2 class=\"main-heading gold-line\"><?php echo esc_html( $args['heading'] ); ?></h2>\n<div class=\"wiring-diagram-results grid-4\">\n  <?php\n    while( $args['query']->have_posts() ) {\n      $args['query']->the_post();\n      get_template_part( 'template-parts/content', $args['template_name'] );\n    }\n    wp_reset_postdata();\n  ?>\n</div>\n\nThe config array could also be placed into a separate file or function and not to have it hard-coded on the template file.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402836", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: Why is my insert row only inserting the final row from the loop into the database rather than just inserting one     <?php\nsession_start();\n\nif(is_user_logged_in()) {\n    global $wpdb;\n    $id = get_current_user_id();\n    $recoveryID = null;\n//     $results = $wpdb->get_results('SELECT * FROM wp_recovery_details where not exists (select driverID ,recoveryID from wp_recovery_bids where driverID='$id')');\n//     \n$results = $wpdb->get_results('SELECT * FROM wp_recovery_details');\n    \n//     \n//  EXISTS (select driverID ,bidAmount from wp_recovery_bids)\n\n  // output data of each row\n  foreach ($results as $row) {\n    //  $recoveryID = $row->recoveryID;\n      \n//  $result = $wpdb->get_results('select * from wp_recovery_details where not exists(select driverID from wp_recovery_details where recoveryID ='$recoveryID' ');\n      \n//    if(count($result) > 0){\n          \n      \n\n//    $numberPlate = str_replace(' ', '', $row -> custNoPlate);\n//    \n        $_SESSION['recoveryID'] = $row -> recoveryID;\n      $image = $row -> imageURL;\n      echo \n        \"<table role='table'>\n    <thead>\n    <tr>\n\u00a0 \u00a0\u00a0<th>Vehicle</th>\n\u00a0\u00a0\u00a0\u00a0<th>Location</th>\n\u00a0\u00a0\u00a0\u00a0<th>Destination</th>\n    <th>Estimated Time of Arrival</th>\n    <th>Your price</th>\n\u00a0\u00a0  </tr>\n    </thead>\n    <tr>\n    <th> \n    <form method='post' action =''>\n     <h1> \".$row -> recoveryID.\"  </h1>\n    <img src='https://www.recovermenow.co.uk/{$image}'\n      width='150' height='70'/>\n        \". $row -> custNoPlate.\"\n    \n    <th>\" .$row -> pickUp. \"</th>\n    <th>\" .$row -> destination. \"</th>\n    <th><input type='time' name='eta'/></th>\n    <th><input type='text' name='price'/></th>\n    <th><input type='submit' name='submit'/></th>\n    </form>\n</table>\"; \n             \n//   }\n   \n      };\n     \n     if(isset($_POST['submit'])){\n        \n            $table_name = $wpdb->prefix.'recovery_bids';\n                 \n            $bidAmount = $_POST['price'];\n            $estimatedTime = $_POST['eta'];\n         \n                 \n                $bidID = rand(10,10000);\n                \n                $driverID = get_current_user_id();\n         \n                $recoveryID = $_SESSION['recoveryID'];\n                 \n                 $wpdb->insert($table_name, array(\n                    'bidID' => $bidID,\n                    'bidAmount' => $bidAmount,\n                    'estimatedTime'=> $estimatedTime,\n                    'driverID' => $driverID,\n                    'recoveryID' => $recoveryID ,\n                     ),\n                        array(\n                    '%s',\n                    '%s',\n                    '%s',\n                    '%s',\n                    '%s',\n                ));\n        }   \n} else{\n    echo \"Login to view this page\";\n}\n        \n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402838", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add a sortable date column in an admin page? I'm trying to add a date column to an admin table (to woocommerce order page, just to be specific, but this code is not plugin dependent). The code works for adding the column, but whenever I try to sort the column tapping the sorting triangle button on the order page it returns 'No record found'. Maybe there is a problem with date format in the function returning the date? The rest of the code is pretty standard\n// Adding a new column to ADMIN order list\nadd_filter( 'manage_edit-shop_order_columns', 'custom_shop_order_column', 20 );\nfunction custom_shop_order_column($columns)\n{\n    $reordered_columns = array();\n\n    // Inserting columns to a specific location\n    foreach( $columns as $key => $column){\n        $reordered_columns[$key] = $column;\n        if( $key ==  'order_status' ){\n            // Inserting after \"Status\" column\n            $reordered_columns['closing_date_column'] = __( 'Validaci\u00f3n','theme_domain');\n        }\n    }\n    return $reordered_columns;\n}\n\n// Adding custom fields meta data for new column in ADMIN order list\n// to add closing date to order solicitado passed to en espera (being so closed)\nadd_action( 'manage_shop_order_posts_custom_column' , 'custom_orders_list_column_content', 20, 2 );\nfunction custom_orders_list_column_content( $column, $post_id )\n{\n    switch ( $column )\n    {\n        case 'closing_date_column' :\n            echo calculateClosingDate($post_id);\n            break;\n    }\n}\n\n// Make custom column sortable\nadd_filter( \"manage_edit-shop_order_sortable_columns\", 'shop_order_column_meta_field_sortable' );\nfunction shop_order_column_meta_field_sortable( $columns )\n{\n    $meta_key = 'closing_date_column';\n    return wp_parse_args( array('closing_date_column' => $meta_key), $columns );\n}\n\n// Make sorting work properly \nadd_action('pre_get_posts', 'shop_order_column_meta_field_sortable_orderby' );\nfunction shop_order_column_meta_field_sortable_orderby( $query ) {\n    global $pagenow;\n\n    $orderby  = $query->get( 'orderby');\n    if ('closing_date_column' === $orderby){\n        $query->set('meta_key','closing_date_column');\n        $query->set('orderby', 'meta_value_date');\n    }    \n}\n// Adding a new column to ADMIN order list\nfunction calculateClosingDate($post_id){\n    // doing stuff\n}\n\nEDIT: I think the problem may be that the data shown in the custom table is calculated and not stored in a metakey value on the db, so whenever it tries to sort is searching on the db for not existing data. So How I can sort with the calculated data?\n\nA: Just for people passing by, for putting together all this code was not trivial. The problem was actually the lack of data. I solved adding data as metakey (added in my case when the order changes status) and echoing it as the column value. So the full code is:\n// Adding a new column to ADMIN order list\nadd_filter( 'manage_edit-shop_order_columns', 'custom_shop_order_column', 20 );\nfunction custom_shop_order_column($columns)\n{\n    $reordered_columns = array();\n\n    // Inserting columns to a specific location\n    foreach( $columns as $key => $column){\n        $reordered_columns[$key] = $column;\n        if( $key ==  'order_status' ){\n            // Inserting after \"Status\" column\n            $reordered_columns['closing_date_column'] = __( 'Validaci\u00f3n','theme_domain');\n        }\n    }\n    return $reordered_columns;\n}\n\n// Echoing custom fields meta data for new column in ADMIN order list\nadd_action( 'manage_shop_order_posts_custom_column' , 'custom_orders_list_column_content', 20, 2 );\nfunction custom_orders_list_column_content( $column, $post_id )\n{\n    switch ( $column )\n    {\n        case 'closing_date_column' :\n            echo get_post_meta( $post_id, 'closing_date_column', true );\n            break;\n    }\n}\n\n// Make custom column sortable\nadd_filter( \"manage_edit-shop_order_sortable_columns\", 'shop_order_column_meta_field_sortable' );\nfunction shop_order_column_meta_field_sortable( $columns )\n{\n    $meta_key = 'closing_date_column';\n    return wp_parse_args( array('closing_date_column' => $meta_key), $columns );\n}\n\n// Make sorting work properly for date field\nadd_action('pre_get_posts', 'shop_order_column_meta_field_sortable_orderby' );\nfunction shop_order_column_meta_field_sortable_orderby( $query ) {\n    global $pagenow;\n\n    $orderby  = $query->get( 'orderby');\n    if ('closing_date_column' === $orderby){\n        $query->set('meta_key','closing_date_column');\n        $query->set('orderby', 'meta_value_date');\n    }    \n}\n\n// add closing date to order meta when it changes status\n// The format is \"Y-m-d\" for sorting doesn't work with any date format\nadd_action( 'woocommerce_order_status_changed', 'action_woocommerce_order_status_changed', 10, 4 ); \nfunction action_woocommerce_order_status_changed( $this_get_id, $this_status_transition_from, $this_status_transition_to, $instance ) { \n    update_post_meta( $this_get_id, 'closing_date_column', date(\"Y-m-d\") );\n}; \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402842", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Form will not popup, when clicking on the link to the form I am creating a form that must popup, when a user clicks on a profile link. I have tried using javascript and various ways to do this, but I couldn't get the form to show. The page just jumps. I am trying to do this on the same page. I have now tried to get it to show with jquery. I have put the css and js in custom css and js plugin, so it should work.\nHere is the code:\n<!-- wp:image {\"id\":665,\"sizeSlug\":\"full\",\"linkDestination\":\"none\"} -->\n<figure class=\"wp-block-image size-full\"><img src=\"http://webyardcraft2.local/wp-content/uploads/2022/02/me-3.png\" alt=\"\" class=\"wp-image-665\"/><figcaption><a id=\"mylink\" href=\"/webyardcraft2.local/freelancers\" class=\"show_form\" onclick=\"MyFunction();return false;\">Ask John a question</a>\n<!-- /wp:image -->\n\n\n<div id=\"form_wrapper\">\n<form id=\"Johnsform\" action=\"http://webyardcraft2.local/freelancers\" method=\"post\" accept-charset=\"UTF-8&quot;\">\n<li><label for=\"Fname\">First Name</label><br><input id=\"first_name\" name=\"first_name\" type=\"text\" required=\"\"></li>\n<li><label for=\"Lname\">Last Name</label><br><input id=\"last_name\" name=\"last_name\" type=\"text\" required=\"\"></li>\n<li><label for=\"email\">Email</label><br>\n<input id=\"mail\" name=\"email\" type=\"email\" required=\"\"></li>\n<p><label for\"jquestion\"=\"\">Place your questions for John</label><br>\n<input id=\"j_question\" name=\"j_question\" type=\"text\">\n</p>\n</form>\n</div>\n\n#form_wrapper {\n  display:none;\n}\njQuery(document).ready(function( $ ){\n    $(\"a-show_form\").click(function(){\n   $('form_wrapper').show():\n    });\n   \n\n\n\n\n\n\nA: check this ..\nreplace YOUR.BUTTON.CLASS with Your Link Class\nhtml body .show-important {\n    display: block !important; // or flex\n    opacity: 1 !important;\n    filter: opacity(100%) !important;\n}\nhtml body .hide-important {\n    display: none !important;\n}\nhtml body .hide-important * {\n    display: none !important;\n}\n(function($){\n    $(document).ready(function(){\n        //when page loaded hide form\n        $(\"#form_wrapper\").hide(); // or $('#form_wrapper').removeClass(\"show-important\").addClass(\"hide-important\");\n        $(\"YOUR.BUTTON.CLASS\").on(\"click\",function(){\n            //if click the Button Show the Form\n            $('#form_wrapper').show(); // or $('#form_wrapper').addClass(\"show-important\").removeClass(\"hide-important\");\n        });\n    });\n})(jQuery)\n\nif not worked , remove :\n#form_wrapper {\n  display:none;\n}\n\nand check again. any problem? type in comment plz.\ni hope useful for you\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402845", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I import one custom block into another? I've been writing various custom blocks, but have run into a small issue: I'd like to be able to directly reference a custom child block inside a custom parent block. The problem is I already have an InnerBlocks component in the parent.\nThe child block works fine in a standalone context \u2014 its purpose being to fetch data from a third party API on certain events. The index.js is pretty standard:\nimport edit from './edit';\nimport save from './save';\nimport metadata from './block.json';\n\nregisterBlockType( metadata.name, {\n    /**\n     * @see ./edit.js\n     */\n    edit,\n\n    /**\n     * @see ./save.js\n     */\n    save,\n} );\n\nThe parent block is currently just a thin wrapper around the core/embed block with some extra content appended within its save method. When the core/embed updates, however, an event is triggered that I'd like to pass on to the custom child block.\nThe parent block currently makes use of the InnerBlocks component\nreturn (\n    <div { ...useBlockProps({ className: customClass }) }>\n        <InnerBlocks\n            allowedBlocks={['core/embed']}\n            template={EMBED_TEMPLATE}\n            templateLock=\"all\"\n            __experimentalLayout={defaultLayout}\n        ></InnerBlocks>\n\n        /* And then ideally... */\n        <ChildBlock propsAndListeners/>\n    </div>\n)\n\nTo be clear: the parent/child blocks are not for public use, they're solely for use at a specific company, complete with their own branding etc, so reuse is not really a priority at this time. The aim is to hand over a gutenberg site builder with custom blocks specific to their needs.\nI assumed that I could export the child block from its index.js, but haven't had any luck with this. How do I go about exporting this so I can simply import ChildBlock from '../path in another file, in much the same way I can reference core blocks?\n\nA: You cannot embed blocks as react components this way, and you should not try to use other blocks as user interface components by setting innerblocks with a locked template.\nInstead, use 2 filters to modify the core/embed block:\n\n*\n\n*Use editor.BlockListBlock on core/embed to modify the edit component, wrapping it in your own component that has extra user interface react components\n\n*Use the blocks.registerBlockType filter to modify the core/embed registration to include your additional attributes\n\n*Use PHP to adjust how the core/embed block is rendered using filters\n\nThis way you can use the standard core embed block and no longer need to register new blocks.\nFor example this adds a button to the toolbar of every block:\nimport { BlockControls } from '@wordpress/block-editor';\nimport {\n    ToolbarButton,\n    ToolbarGroup,\n} from '@wordpress/components';\nimport { createHigherOrderComponent } from '@wordpress/compose';\nimport { addFilter } from '@wordpress/hooks';\n\naddFilter(\n    'editor.BlockListBlock',\n    'verism/toolbar-button',\n    AddToolbarButton,\n    10\n);\nconst AddToolbarButton = createHigherOrderComponent( BlockEdit => {\n    return ( props ) => {\n        if ( props.name != 'core/embed' ) {\n            return <BlockEdit { ...props } />;\n        }\n        return (\n            <Fragment>\n                <BlockControls>\n                    <ToolbarGroup>\n                        <ToolbarButton\n                            className=\"verisms-really-nice-button\"\n                            label=\"Verisms really nice button\"\n                            onClick={ () => {\n                                console.log( 'button pressed' );\n                            } }\n                        />\n                    </ToolbarGroup>\n                </BlockControls>\n                <BlockEdit { ...props } />\n            </Fragment>\n        );\n    };\n}, 'AddToolbarButton' );\n\nhttps://developer.wordpress.org/block-editor/reference-guides/filters/block-filters/#editor-blockedit\nYou could insert sidebar panels, textfields, toolbar buttons etc.\nYou could also filter the attributes in PHP via the block_type_metadata filter:\nhttps://developer.wordpress.org/block-editor/reference-guides/filters/block-filters/#block_type_metadata\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402856", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: CheckboxControl does not visible change I use the following code to add a custom option in the Gutenberg-sidebar. Its visible and saving the Checkbox-value works.\nBut: if I click on the CheckboxControl nothing visible changes on it. If it is not checked and I want to check it, it does not go checked. The \"Update\"-button goes active and I see the checked Checkbox after it.\nWhy?\nimport { CheckboxControl } from '@wordpress/components';\nimport { dispatch, select } from '@wordpress/data';\nimport { PluginDocumentSettingPanel } from '@wordpress/edit-post';\nimport { Component  } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\n\nexport default class Sidebar extends Component {\n    render() {\n        const meta = select( 'core/editor' ).getEditedPostAttribute( 'meta' );\n        const toggleState = meta['code'];\n\n        return (\n            <PluginDocumentSettingPanel\n                name=\"code\"\n                title={ __( 'Display Settings', 'myplugin' ) }\n            >\n                <CheckboxControl\n                    checked={ toggleState }\n                    help={ __( 'My help.', 'myplugin' ) }\n                    label={ __( 'My Label', 'myplugin' ) }\n                    onChange={ ( value ) => {\n                        dispatch( 'core/editor' ).editPost( {\n                            meta: {\n                                'code': value,\n                            },\n                        } );\n                    } }\n                />\n            </PluginDocumentSettingPanel>\n        );\n    }\n}\n\n\nA: Solution found:\nconst { __ } = wp.i18n;\nconst { useSelect, useDispatch } = wp.data;\nconst { PluginDocumentSettingPanel } = wp.editPost;\nconst { CheckboxControl, PanelRow } = wp.components;\n\nconst Sidebar = () => {\n    const { postMeta } = useSelect( ( select ) => {\n        return {\n            postMeta: select( 'core/editor' ).getEditedPostAttribute( 'meta' ),\n        };\n    } );\n    const { editPost } = useDispatch( 'core/editor', [ postMeta.code ] );\n\n    return(\n        <PluginDocumentSettingPanel title={ __( 'Display Settings', 'myplugin') }>\n            <PanelRow>\n                <CheckboxControl\n                    label={ __( 'My Label', 'myplugin' ) }\n                    checked={ postMeta.code }\n                    onChange={ ( value ) => editPost( { meta: { code: value } } ) }\n                />\n            </PanelRow>\n        </PluginDocumentSettingPanel>\n    );\n}\n\nexport default Sidebar;\n\n\nA: Because React is unaware that anything changed, all the props are the same, and so is the state, so no updates are needed. This is because you used select and dispatch directly from the @wordpress/data package.\nYou shouldn't use select and dispatch directly, you're meant to use the useSelect and useDispatch hooks.\nYou'll also need to convert this to a function based component, you can't use hooks with class based components\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402862", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Remove the inline styling added in wp_get_attachment_image() Here is how I am calling wp_get_attachment_image:\n$id = attachment_url_to_postid( get_theme_mod( 'blue_logo' ));\necho wp_get_attachment_image($id, $size = 'blue_logo', $icon = false, array(\n   \"class\" => \"blue_logo\"\n))\n\n'blue_logo' size is referencing an image size that I am creating in functions.php. Here is what the output element looks like.\n<img width=\"216\" height=\"67\" src=\"http://34.219.141.113/wp-\ncontent/uploads/2022/02/Q7_WHM_HOR_BLUE-1.jpg\" class=\"blue_logo\" alt=\"\" loading=\"lazy\" \nsrcset=\"http://34.219.141.113/wp-content/uploads/2022/02/Q7_WHM_HOR_BLUE-1.jpg 2062w, \nhttp://34.219.141.113/wp-content/uploads/2022/02/Q7_WHM_HOR_BLUE-1-300x93.jpg 300w, \nhttp://34.219.141.113/wp-content/uploads/2022/02/Q7_WHM_HOR_BLUE-1-1024x317.jpg 1024w, \nhttp://34.219.141.113/wp-content/uploads/2022/02/Q7_WHM_HOR_BLUE-1-768x238.jpg 768w, \nhttp://34.219.141.113/wp-content/uploads/2022/02/Q7_WHM_HOR_BLUE-1-1536x476.jpg 1536w, \nhttp://34.219.141.113/wp-content/uploads/2022/02/Q7_WHM_HOR_BLUE-1-2048x635.jpg 2048w, \nhttp://34.219.141.113/wp-content/uploads/2022/02/Q7_WHM_HOR_BLUE-1-1568x486.jpg 1568w\" sizes=\"\n(max-width: 216px) 100vw, 216px\" style=\"width:100%;height:30.99%;max-width:2062px;\">\n\nI understand that I can override the styling with CSS, but when I do that it's causing some compression which is causing the image to lose quality. Is it possible to not have the inline styling at all in the first place? My ultimate goal here is to be able to display an image that is being uploaded via a custom WP_Customize_Image_Control and set the image size with as little image compression/loss in quality possible.\nThank you for the help!\n\nA: You could try using get_attachment_image_url() instead.  This will give you the url for the full image.  You can\nCall it like this:\necho '<img class=\"blue_logo\" src=\"'.get_attachment_image_url($id, 'blue_logo').'\">';\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402863", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Add hook after content without formatting I want to add a table after the_content with a hook, but it's adding <p> tags in certain areas. This is a plugin, I don't want to remove <p> tags from all the_content, just the table I'm trying to add.\nHere's an example, but my table is bigger and inside it's adding p tags in different spots.\nfunction addTable( $content ) {\n  $table = '<table><tbody><tr><td>Example html here</td></tr></tbody></table>';\n\n  $content .= $table;\n\n  return $content;\n}\n\nadd_filter( 'the_content', 'addTable', 20 );\n\nSomeone asked this in 2012, no answer but I'm trying to do the same thing:\nAdding a form at the end of the content\nI do not want to remove <p> tags from a theme's entire blog post, only the content I am appending. In this case, I'm appending a table.\nIs there a way to disable the formatting for only the content I'm appending? Otherwise, how is it possible in WordPress to attach a form or table to a post with hooks without it adding formatting?\n\nA: Pull from the provided answer back in 2012 and testing with the 2021 theme it works as intended.\nfunction addTable( $content ) {\n        \n        ob_start(); \n        echo '<table><tbody><tr><td>Example html here</td></tr></tbody></table>';\n        $table = ob_get_clean();\n        \n        $content .= $table;\n      \n        return $content;\n    }\n      \n    add_filter( 'the_content', \"addTable\", 20 );\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402865", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Where to filter Shortcode string prior to execution Whatever WP function assembles the $att array from the [myShortcode att1=\"...\" att2=\"...\" ...] string uses the \" character to delimit the data.  However, the \u201c and the \u201d characters seem to be read as text, not delimeters; and their use in place of \" can lead to shortcode errors.\nIn theory, there shouldn't ever be a problem because \u201c and \u201d are not characters on the qwerty keyboard, and so would not be encountered with manual entry. Yet, cutting and pasting from sources that use \u201c and \u201d allow for their inclusion (and there should be error checking for that situation).  For example, the page The Beginner\u2019s Guide to Writing Your Own Custom Shortcode says that [helloworld name=\u201dBob\u201d] outputs Hello Bob!, which is not the case because the webpage cutely styled \" into \u201d. Cutting and pasting [helloworld name=\u201dBob\u201d] outputs Hello \u201dBob\u201d!;  and [helloworld name=\u201dBob Smith\u201d] outputs Hello \u201dBob!, since the space between Bob and Smith is read as a delimeter and the array says that [name] = \"Bob and that [0] = Smith.\nDoing a preg_replace on the shortcode string before it is parsed into the $atts array seems like the best way to prevent errors.  The question is where to do that.\n\nA: shortcode_atts_{$shortcode} seems to be the WordPress filter you need.\nhttps://developer.wordpress.org/reference/hooks/shortcode_atts_shortcode/\nIt is used in the shortcode_atts() function:\nhttps://developer.wordpress.org/reference/functions/shortcode_atts/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402869", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Getting Same Description in All the Custom Taxonomy Posts I have developed a custom taxonomy post type. I have displayed categories & inside categories posts/(products).\nI am getting the Post title & Image as they should be (which I add), but the descriptions of all the posts are same.\nI have no idea why same desc keeps displaying,even though everything else is dynamic.\nHere is the code I am using:\n$taxID = get_queried_object()->term_id;\n$args = array(\n    'post_type' => 'industrial_product',\n    'fields' => 'ids',\n    'posts_per_page' => -1,\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'industrial_product_cat',\n            'terms' => $taxID,\n            'field' => 'term_id',\n            'operator' => 'IN'\n        )\n    ),\n  );\n     $query = new WP_Query($args);\n    if ($query->have_posts()):\n        $i=1;\n    foreach( $query->posts as $id ):?>\n            <div class=\"row mb-4\">\n                <div class=\"col-md-4 col-12\">\n                    <?php\n                    $image_palette = wp_get_attachment_image_src( get_post_thumbnail_id( $id ), 'single-post-thumbnail' ); \n                    ?>\n                <img src=\"<?php echo $image_palette[0]; ?>\" alt=\"\" class=\"img-fluid\" style=\"max-width:100%;\">\n                    \n                </div>\n                <div class=\"col-md-8 col-12\">\n                     <ul class=\"nav nav-tabs\" id=\"myTab\" role=\"tablist\">\n                        <li class=\"nav-item m-0\" role=\"presentation\">\n                            <a class=\"nav-link active  c-2\" id=\"productInfo<?php echo $i;?>-tab\" data-toggle=\"tab\" href=\"#productInfo<?php echo $i;?>\" role=\"tab\" aria-controls=\"productInfo<?php echo $i;?>\" aria-selected=\"true\">Product Information</a>\n                         </li>\n                        <li class=\"nav-item m-0\" role=\"presentation\">\n                            <a class=\"nav-link  c-2\" id=\"std_tds<?php echo $i;?>-tab\" data-toggle=\"tab\" href=\"#std_tds<?php echo $i;?>\" role=\"tab\" aria-controls=\"std_tds<?php echo $i;?>\" aria-selected=\"false\">STD / TDS</a>\n                        </li>\n                    </ul>\n                    <div class=\"tab-content p-3\" id=\"myTabContent<?php echo $i;?>\">\n                        <div class=\"tab-pane fade show active\" id=\"productInfo<?php echo $i;?>\" role=\"tabpanel\" aria-labelledby=\"productInfo<?php echo $i;?>-tab\">\n                            <h5><?php echo get_the_title($id); ?></h5>\n                            <p><?php echo get_the_content($id); ?></p>\n                        </div>\n                        \n                        <div class=\"tab-pane fade\" id=\"std_tds<?php echo $i;?>\" role=\"tabpanel\" aria-labelledby=\"std_tds<?php echo $i;?>-tab\">\n                        <?php\n                                if(get_field('std_tds_description', $id)){\n                                    the_field('std_tds_description',  $id);\n                                }\n                                else{\n                                    echo \"No, Content.\";\n                                }\n                            ?>\n                        </div>\n                    </div>  \n                </div>\n        </div>\n        <?php\n        $i++;\n    endforeach;\n    endif;\n//              \n            }\n             \n    ?>\n\nHere is a screenshot of the result:\n\nCan somebody point out what is the problem here. I've tried all sort of stuff but It still shows same desc.\nThanks & Sorry If I'm doing something stupid, still learning!\n\nA: The correct WordPress loop structure is:\n// WP_Query arguments\n$args = array(\n);\n\n// The Query\n$query = new WP_Query( $args );\n\n// The Loop\nif ( $query->have_posts() ) {\n    while ( $query->have_posts() ) {\n        $query->the_post();\n        // do something\n    }\n} else {\n    // no posts found\n}\n\n// Restore original Post Data\nwp_reset_postdata();\n\nDoes this code is working ?\n    $taxID = get_queried_object()->term_id;\n    $args  = array(\n        'post_type'      => 'industrial_product',\n        'fields'         => 'ids',\n        'posts_per_page' => - 1,\n        'tax_query'      => array(\n            array(\n                'taxonomy' => 'industrial_product_cat',\n                'terms'    => $taxID,\n                'field'    => 'term_id',\n                'operator' => 'IN'\n            )\n        ),\n    );\n    $query = new WP_Query( $args );\n    if ( $query->have_posts() ):\n        $i = 1;\n        while ( $query->have_posts() ):\n            $query->the_post();\n            $id = get_the_ID();\n            ?>\n            <div class=\"row mb-4\">\n                <div class=\"col-md-4 col-12\">\n                    <?php\n                    $image_palette = wp_get_attachment_image_src( get_post_thumbnail_id( $id ), 'single-post-thumbnail' );\n                    ?>\n                    <img src=\"<?php echo $image_palette[0]; ?>\" alt=\"\" class=\"img-fluid\" style=\"max-width:100%;\">\n\n                </div>\n                <div class=\"col-md-8 col-12\">\n                    <ul class=\"nav nav-tabs\" id=\"myTab\" role=\"tablist\">\n                        <li class=\"nav-item m-0\" role=\"presentation\">\n                            <a class=\"nav-link active  c-2\" id=\"productInfo<?php echo $i; ?>-tab\" data-toggle=\"tab\"\n                               href=\"#productInfo<?php echo $i; ?>\" role=\"tab\" aria-controls=\"productInfo<?php echo $i; ?>\" aria-selected=\"true\">Product\n                                Information</a>\n                        </li>\n                        <li class=\"nav-item m-0\" role=\"presentation\">\n                            <a class=\"nav-link  c-2\" id=\"std_tds<?php echo $i; ?>-tab\" data-toggle=\"tab\" href=\"#std_tds<?php echo $i; ?>\" role=\"tab\"\n                               aria-controls=\"std_tds<?php echo $i; ?>\" aria-selected=\"false\">STD / TDS</a>\n                        </li>\n                    </ul>\n                    <div class=\"tab-content p-3\" id=\"myTabContent<?php echo $i; ?>\">\n                        <div class=\"tab-pane fade show active\" id=\"productInfo<?php echo $i; ?>\" role=\"tabpanel\"\n                             aria-labelledby=\"productInfo<?php echo $i; ?>-tab\">\n                            <h5><?php echo get_the_title( $id ); ?></h5>\n                            <p><?php echo get_the_content( $id ); ?></p>\n                        </div>\n\n                        <div class=\"tab-pane fade\" id=\"std_tds<?php echo $i; ?>\" role=\"tabpanel\" aria-labelledby=\"std_tds<?php echo $i; ?>-tab\">\n                            <?php\n                            if ( get_field( 'std_tds_description', $id ) ) {\n                                the_field( 'std_tds_description', $id );\n                            } else {\n                                echo \"No, Content.\";\n                            }\n                            ?>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <?php\n            $i ++;\n        endwhile;\n    endif;\n    wp_reset_postdata();\n\n\nA: I just changed the call\nOld: <?php echo get_the_content( $id ); ?>\nNew: echo get_post_field('post_content', $id);\nDon't know what was wrong but, It worked.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402874", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom Post Archive Page not working add_action('init', function() {\n    register_post_type('vendorpost', [\n        'label' => __('Vendor Post', 'txtdomain'),\n        'public' => true,\n        'menu_position' => 5,\n        'menu_icon' => 'dashicons-admin-users',\n        'supports' => ['title', 'editor', 'thumbnail', 'tag', 'revisions', 'comments'],\n        'show_in_rest' => true,\n        'rewrite' => ['slug' => 'vendorposts'],\n        'taxonomies' => ['vendorpost_author', 'vendorpost_genre'],\n        'labels' => [\n            'singular_name' => __('Vendor Post', 'txtdomain'),\n            'add_new_item' => __('Add new vendor post', 'txtdomain'),\n            'new_item' => __('New Vendor Post', 'txtdomain'),\n            'view_item' => __('View Vendor Post', 'txtdomain'),\n            'not_found' => __('No Vendor Post found', 'txtdomain'),\n            'not_found_in_trash' => __('No Vendor Post found in trash', 'txtdomain'),\n            'all_items' => __('All Vendor Post', 'txtdomain'),\n            'insert_into_item' => __('Insert into Vendor Post', 'txtdomain')\n        ],      \n    ]);\n \n    register_taxonomy('vendorpost_category', ['vendorpost'], [\n        'label' => __('Categories', 'txtdomain'),\n        'hierarchical' => true,\n        'rewrite' => ['slug' => 'vendorposts-category'],\n        'show_admin_column' => true,\n        'show_in_rest' => true,\n        'labels' => [\n            'singular_name' => __('Category', 'txtdomain'),\n            'all_items' => __('All Category', 'txtdomain'),\n            'edit_item' => __('Edit Category', 'txtdomain'),\n            'view_item' => __('View Category', 'txtdomain'),\n            'update_item' => __('Update Category', 'txtdomain'),\n            'add_new_item' => __('Add New Category', 'txtdomain'),\n            'new_item_name' => __('New Category Name', 'txtdomain'),\n            'search_items' => __('Search Categorys', 'txtdomain'),\n            'parent_item' => __('Parent Category', 'txtdomain'),\n            'parent_item_colon' => __('Parent Category:', 'txtdomain'),\n            'not_found' => __('No Category found', 'txtdomain'),\n        ]\n    ]);\n    register_taxonomy_for_object_type('vendorpost_category', 'vendorpost');\n \n    register_taxonomy('vendorpost_tag', ['vendorpost'], [\n        'label' => __('Tags', 'txtdomain'),\n        'hierarchical' => false,\n        'rewrite' => ['slug' => 'vendorposts-tag'],\n        'show_admin_column' => true,\n        'labels' => [\n            'singular_name' => __('Tag', 'txtdomain'),\n            'all_items' => __('All Tags', 'txtdomain'),\n            'edit_item' => __('Edit Tag', 'txtdomain'),\n            'view_item' => __('View Tag', 'txtdomain'),\n            'update_item' => __('Update Tag', 'txtdomain'),\n            'add_new_item' => __('Add New Tag', 'txtdomain'),\n            'new_item_name' => __('New Tag Name', 'txtdomain'),\n            'search_items' => __('Search Tags', 'txtdomain'),\n            'popular_items' => __('Popular Tags', 'txtdomain'),\n            'separate_items_with_commas' => __('Separate Tags with comma', 'txtdomain'),\n            'choose_from_most_used' => __('Choose from most used Tags', 'txtdomain'),\n            'not_found' => __('No Tags found', 'txtdomain'),\n        ]\n    ]);\n    register_taxonomy_for_object_type('vendorpost_tag', 'vendorpost');\n});\n\n\nA: If you are wanting to see the archive of you custom posts the archive will be:\narchive-vendorpost.php\nWhen you switch to a category there is a separate template wordpress uses:\ntaxonomy-vendorpost_category.php\nRemember also, that you'll need to visit the permalinks page to reset them after as your code doesn't do that for you.\nI've tested your code on my system and everything is working properly for me.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402876", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Fetch custom post related to a User I am trying to fetch custom post related to a User. I am using below code.\n$args = array(\n            'post_type'     => 'tasks',\n            'meta_query'    => array(\n                'relation'  => 'AND',\n                array(\n                    'key' => 'users',\n                    'id' => $user->ID,\n                    'compare' => '=',\n                ),\n            ),\n        );\n\n        $query = new WP_Query($args);\n        $posts = $query->posts;\n\nBut I am not getting any output.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402879", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Drag and drop widget always inserts image I am drag and dropping a widget into a section using Elementor plugin. But it does not matter, which widget I am choosing, somehow always an image gets inserted. Am I doing something wrong? I am new to wordpress and this is my first experience :(.\n\n\nA: This error seems Browser-related, as it works as expected using Firefox instead of Chrome.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402881", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: This code is supposed to only allow user to be authenticated if accountVerified is equal to 1, but it still allows user to be authenticated otherwise  global $user_id;\n    global $wpdb;\n    if(is_user_logged_in()){\n        header(\"Location:https://www.recovermenow.co.uk\");\n\n    } \n    if(!$user_id){\n        if($_POST){\n        \n        $username = $_POST['email'];\n        $password = $_POST['password'];\n        \n        $login_data = array();\n        $login_data['user_login'] = $_POST['email'];\n        $login_data['user_password'] = $_POST['password'];\n\n        $user = wp_signon( $login_data, false);\n        \n        echo var_dump($user);\n        \n        if ( is_wp_error($user) ) {\n            echo $user->get_error_message();\n        } else {   \n             wp_set_auth_cookie($user->ID, true);\n            header(\"Location:https://www.recovermenow.co.uk/\");\n        }\n    \n        \n        \n\n    } else{\n        \n        echo \"\n                <html>\n                <body>\n                <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>\n                <script type='text/javascript' src='https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places&key=AIzaSyD-q6DH3L2eG9pzQYxUZ9YzIzIuJbqJAGU&ver=3.exp'></script>\n\n\n                <div class='container-fluid' id='grad1'>\n\n                    <div class='row justify-content-center mt-0'>\n                        <div class='col-11 col-sm-9 col-md-7 col-lg-6 text-center p-0 mt-3 mb-2'>\n                            <div class='card px-0 pt-4 pb-0 mt-3 mb-3'>\n\n\n                                <div class='row'>\n\n                                        <form id='loginform' method='post' action=''>\n                                            <fieldset>\n                                                <div class='form-card'>\n\n\n                                    <label>Username</label>\n\n                                   <input \n                                    id='username' \n                                    placeholder='Please enter your email'\n                                    type='text' \n                                    class='form-control' \n                                    name='email'/>\n\n                                   <label>Password</label>\n\n                                <input \n                                    type='password' \n                                    class='password' \n                                    name='password' \n                                    class='form-control' \n                                    placeholder='Enter password' \n                                    id='password'/> \n\n                                    <input \n                                    type='submit' \n                                    name='loginButton' \n                                    id='loginButton'\n                                    value='Login'/> \n                                            </div> \n\n\n                                            </fieldset>\n                                        </form>\n                                </div>\n                            </div>\n                        </div>\n                        <a id='forgottenPassword' href='forgottenPassword'>Forgotten Password?</a>\n                        <a id='registration' href='registration'>Click here to sign up</a>\n                    </div>\n                    \n                </div>\n                \n\n                </body>\n                </html>\";\n        \n    }\n    \n} else{\n    header(\"Location:https://www.recovermenow.co.uk/\");\n}\n \n\n\n\n\n\nfunction isUserActivated($username){\n    // First need to get the user object\n    $user = get_user_by('login', $username);\n\n    if(!$user) {\n        $userID = $user->ID;\n        if(!$user) {\n            echo $user;\n           return $username;\n        }\n    }\n\n    $userStatus = get_user_meta($user->ID, 'Account Verified', true);\n\n    //for testing $userStatus = 1;\n    $login_page  = home_url('/log-in-failed/');\n    if($userStatus!= 1){\n        wp_redirect($login_page);\n        echo \"Not verified\";\n        return 0;\n        exit;\n    }\n\n}\n\nadd_action('wp_authenticate', 'isUserActivated');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402883", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP Use Profile Fields is missing The entire User Profile Fields link is missing and I cant make new pages. We use Vibe BP and WPLMS systems and every time there is a critical error, WP cites the issue in line 69 in vibe bp code\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402885", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Plugin is attempting to start a session with WordPress. WP Session Manager will not work! DomPdf I get the error message \"Another plugin is attempting to start a session with WordPress. WP Session Manager will not work!  how to find error\"\nI am trying to correct the code of somebody. He uses dompf. There is stuff like $_Session in the code. What do I need to do with the code so there is no error anymore?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402887", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress responds to the ajax request with readyState 1, 2, 3 before responding with 4 readyState= 1\nthis.status= 0\nreadyState= 2\nthis.status= 200\nreadyState= 3\nthis.status= 200\nreadyState= 4\nthis.status= 200\n\nThese are the responses I get, and in the end it finally responds with 4 and 200. My php function just echoes \"hello from php\". I used ob_clean() before echo and wp_die() as per Codex recommendations because it said there may be unnecessary responses mixed in with ajax but still didn't help at all.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402890", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How To Query For An Empty Taxonomy Field I want to write a query that looks up taxonomies.  One condition is that taxonomyA returns x, and a second condition is that taxonomyB returns empty.  I don't know how to query for empty.\nThis is what I have:\n$args = [\n    'post_type' => 'post',\n    'tax_query' => [\n        'relation' => 'AND',\n        [\n            'taxonomy'         => 'areaoflondon',\n            'field'            => 'name',\n            'terms'            => 'South London',\n            'include_children' => false,\n        ],\n        [\n            'taxonomy'         => 'yearofvisit',\n            'field'            => 'name',\n            'terms'            => '',\n            'include_children' => false,\n          ]\n    ],\n    'posts_per_page'     => 5,\n    'meta_key' => 'rating',\n    'meta_type' => 'NUMERIC',\n    'order' => 'DESC',\n    'orderby' => 'meta_value_num',\n];\n\nHowever this doesn't return any results.\nHow can I query that a taxonomy is empty?  Is it even possible?\nThanks\nJames\n\nA: Thanks to Sally for the answer, which is to use the NOT EXISTS operator:\n$args = [\n    'post_type' => 'post',\n    'tax_query' => [\n        'relation' => 'AND',\n        [\n            'taxonomy'         => 'areaoflondon',\n            'field'            => 'name',\n            'terms'            => 'South London',\n            'include_children' => false,\n        ],\n        [\n            'taxonomy'         => 'yearofvisit',\n            'operator' => 'NOT EXISTS'\n          ]\n    ],\n    'posts_per_page'     => 5,\n    'meta_key' => 'rating',\n    'meta_type' => 'NUMERIC',\n    'order' => 'DESC',\n    'orderby' => 'meta_value_num',\n];\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402894", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there any risk setting Wordpress file permissions and FS method to 'direct' on localhost? After installing a fresh WordPress on my computer using XAMPP, I got this message when I tried uploading a theme:\n\nConnection Information\nTo perform the requested action, WordPress needs to access your web server. Please enter your FTP credentials to proceed. If you do not remember your credentials, you should contact your web host.\n\nI added the code\ndefine('FS_METHOD', 'direct');\n\nto the config.php file for it to upload without asking for any ftp credentials.\nCan I leave define('FS_METHOD', 'direct') in the config.php file forever?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402896", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to access index file in Block Themes? I'm new to wordpress code and read that index.php is located in the root/themes/yourtheme/index.php.\nWhen I open index.php in the twentytwentytwo folder in my wordpress directory, it sais that block themes do not use php templates:\n\nWhere do I find the file with <head> and <body> tags etc. ?\n\nA: The relevant file is located in wp-includes/theme-compat/header.php\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402899", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change the slug of a particular page every x hours Is it possible to rewrite the slug of a particular page (e.g. Page-ID 123) with a wordpress function?\nI found this somewhere but It doesnt work and I am also looking to simplify it as I just want to change the permalink of a single page\nfunction rudr_post_permalink( $url, $post ){\n    if( !is_object( $post ) )\n        $post = get_post( $post_id );\n        \n    $replace = $post->post_name;\n        \n    /* We should use a post ID to make a replacement. It is required if you use urf-8 characters in your URLs */\n        \n    if( $post->ID == 1 ) \n        $replace = 'hello-planet';\n    if( $post->ID == 12 ) \n        $replace = 'Contacts';\n        \n    $url = str_replace($post->post_name, $replace, $url );\n    return $url;\n}\n\nadd_filter( 'post_link', 'rudr_post_permalink', 'edit_files', 2 );\nadd_filter( 'page_link', 'rudr_post_permalink', 'edit_files', 2 );\nadd_filter( 'post_type_link', 'rudr_post_permalink', 'edit_files', 2 );\n\nThe reason I want to do this is because I want to change the slug of a particular page every x hours. I do not want to redirect the old slug to the new slug.\n\nA: You'll need a two step process for that.\n\n*\n\n*Create a function that actually changes the slug (not rewrite it)\n\n*Schedule an event in WordPress to run that function in every X hours.\n\nHere are something to start with\nfunction wpse402903_schedule_event() {\n\n    add_action( 'wpse402903_cron', 'wpse402903_cron_callback' );\n    \n    if ( !wp_next_scheduled('wpse402903_cron') ) {\n        //Change 12 to your interval\n        wp_schedule_event( time(), 12 * HOUR_IN_SECONDS, 'wpse402903_cron' );\n    }\n}\nadd_action( 'init', 'wpse402903_schedule_event' );\n\nfunction wpse402903_cron_callback() {\n    \n    $post_id = 123; //The ID of the Post\n    \n    $postID = wp_insert_post( array(\n        'ID' => $post_id,\n        'post_name' => 'your-new-slug', //always use sanitize_title() if this generates dynamically.\n    ));\n}  \n\nThe only drawback is the WP Cron. It acivates only if someone visits your site. For a site with regular traffic, this is not a problem though.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402903", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Getting blog pagination to work on page set as front page From what I understand, if the page is the front page (using front-page.php) you would use get_query_var('page') and for other pages you would use get_query_var('paged'). I have a condition for this and the pagination works to an extent. If I click on \"Next\" it shows the next set of records however on the home page the pagination itself doesn't change ie: on page 2, the number 2 isn't highlighted and the 'previous' button isn't present like on other pages.\nif( is_front_page() ) {\n    $paged = (get_query_var('page')) ? get_query_var('page') : 1;\n}else {\n    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n}\n\n$args = array(\n    'posts_per_page' => 12,\n    'post_status' => 'publish',\n    'paged' => $paged,\n);\n\n$all_posts = new WP_Query($args);\n\n\n <?php while ($all_posts->have_posts() ): $all_posts->the_post(); ?>\n    display post title, date etc. here\n <?php endwhile; wp_reset_postdata();?>\n \n<div class=\"pagination\">\n    <?php\n$big = 999999999;\necho paginate_links(\n    array(\n        'prev_text' => __( 'Previous' ),\n        'next_text' => __( 'Next' ),\n        'base' => str_replace($big, '%#%', esc_url( get_pagenum_link( $big ) ) ),\n        'format' => '?paged=%#%',\n        'current' => max(\n            1,\n            get_query_var('paged')\n        ),\n        'total' => $all_posts->max_num_pages\n    )\n);\n?>\n</div>\n\n\nA: Yes, you're correct that on the static front page, we use get_query_var('page') to get the current page number.\nAnd actually, the issue in question (\"the number 2 isn't highlighted\") happened because you used get_query_var('paged') (note the paged) with the current arg for paginate_links(), which means you're passing the wrong number.\n'current' => max(\n    1,\n    get_query_var('paged')\n),\n\nSo all you need to do is replace that with 'current' => $paged, and the problem will be gone.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402904", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Count when a post of a custom post type is deleted and store it in a theme option I work on a website that shows products in a catalogue without checkout. Those products can be bougth stationary, and then the product will be deleted from a custom post type. So, I basically want to count all deleted posts of a certain post type, add them to a theme option value, and then update the theme option value with the new value. I thought of something like this:\nfunction getSoldProductsCount() {\n\n    $addCount                  = 0;\n    $oldCount                  = get_option( 'sold_products_count', 'number' );\n    $newCount                  = $oldCount + $addCount;\n\n    /*\n    * Here I want to do something like: for each deleted post of posttype 'product', increase the counter value by 1\n    */\n\n    return '<span class=\"sold-products-count\">'. $newCount .'</span>';\n    update_option( 'sold_products_count', $newCount );\n}\n\nadd_shortcode( 'sold_products_count', __NAMESPACE__ . '\\\\getSoldProductsCount' );\n\nNow I am stuck here, because I don't know which hook I should use to increase my counter. Ist there a possibility to count all delete actions of a certain custom post type? Sorry if the question is silly, I am very new to Wordpress.\n\nA: The hook played by WordPress just before a post is \"definitively\"  deleted is https://developer.wordpress.org/reference/hooks/delete_post/\n+the comment left by @tom-j-nowell.\nRegards\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402909", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to store the third party script with HTML code in the wordpress custom input field? I have created a custom field on my custom post. Below is the code I am using for the custom field.\n<?php \n\nfunction wpt_add_thirdpartyvideo_metaboxes() {\n  add_meta_box(\n    'wpt_thirdpartyvideo_extra',\n    'Information',\n    'wpt_thirdpartyvideo_extra',\n    'partyvideo',\n    'normal',\n    'default'\n  );  \n}\nadd_action( 'add_meta_boxes', 'wpt_add_thirdpartyvideo_metaboxes' );\n\nfunction wpt_thirdpartyvideo_extra() {\n  global $post;\n  // Nonce field to validate form request came from current site\n  wp_nonce_field( basename( __FILE__ ), 'thirdpartyvideo_extra' );\n  // Output the field\n  echo '<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"10\">\n  <tr>\n        <td>Video Script here </td>\n        <td>\n      <div class=\"form-check\">\n       <textarea name=\"thirdpartyvideoscript\">' . esc_textarea( get_post_meta( $post->ID, 'thirdpartyvideoscript', true ) )  . '</textarea>\n       \n      </div>\n      </td>\n        </tr>   \n    </table>';\n}\nfunction wpt_save_thirdpartyvideo_meta( $post_id, $post ) {\n  if ( ! current_user_can( 'edit_post', $post_id ) ) {\n    return $post_id;\n  }\n  if ( ! isset( $_POST['thirdpartyvideoscript'] ) ) {\n    return $post_id;\n  }\n\n  $events_meta['thirdpartyvideoscript'] = esc_textarea( $_POST['thirdpartyvideoscript'] );\n  \n  foreach ( $events_meta as $key => $value ) :\n    if ( 'revision' === $post->post_type ) {\n      return;\n    }\n    if ( get_post_meta( $post_id, $key, false ) ) {\n      update_post_meta( $post_id, $key, $value );\n    } else {\n      add_post_meta( $post_id, $key, $value);\n    }\n    if ( ! $value ) {\n      delete_post_meta( $post_id, $key );\n    }\n  endforeach;\n}\nadd_action( 'save_post', 'wpt_save_thirdpartyvideo_meta', 1, 2 );\n\n ?>\n\nI have tried to add some dummy content and it's working.  Now I have to add the third-party video code which is script and HTML tags like below Third-party example.\n<script src=\"//fast.wistia.com/embed/medias/s3lqfi0zn7.jsonp\" async></script>\n<script src=\"//fast.wistia.com/assets/external/E-v1.js\" async></script>\n<div class=\"wistia_embed wistia_async_s3lqfi0zn7\" style=\"height:349px;width:620px\">&nbsp;</div>\n\nIf I add the above code then I am getting the below output\n&lt;script src=&quot;//fast.wistia.com/embed/medias/s3lqfi0zn7.jsonp&quot; async&gt;&lt;/script&gt;\n    &lt;script src=&quot;//fast.wistia.com/assets/external/E-v1.js&quot; async&gt;&lt;/script&gt;\n    &lt;div class=&quot;wistia_embed wistia_async_s3lqfi0zn7&quot; style=&quot;height:349px;width:620px&quot;&gt;&amp;nbsp;&lt;/div&gt;\n\n\nA: You are using esc_textarea() to output the content - so it's doing exactly that.\nThis is of course the correct thing to do with user input, so you have a few options here.\n\n*\n\n*Only ask for the embed id  - then reconstruct it in php. Something like:\n\n<!-- Meta box input example -->\n<input name=\"thirdpartyvideoscript\" placeholder=\"eg. s3lqfi0zn7\" />\n<!-- expected input format is \"s3lqfi0zn7\" -->\n\n<?php if ( ! empty( $meta_embed_value ) ) { // $meta_embed_value is your returned meta box (get_post_meta) ?>\n    <script src=\"//fast.wistia.com/embed/medias/<?php echo esc_attr( $meta_embed_value ); ?>.jsonp\" async></script>\n    <script src=\"//fast.wistia.com/assets/external/E-v1.js\" async></script>\n    <div class=\"wistia_embed wistia_async_<?php echo esc_attr( $meta_embed_value ); ?>\" style=\"height:349px;width:620px\">&nbsp;</div>\n<?php } ?>\n\n\n\n\n*You can deconstruct the input using a RegEx and match the expected input - ie allow the whole script to be pasted into the textedit area - then use the same code above to print out your matches - in your allowed and safe format.\n\n\n*Throw caution to the wind... open yourself up to stored XSS attacks and do the unthinkable - trust user input. Which if I hadn't made myself clear enough - isn't a good thing to do.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402915", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Plugin with action 'save_post' needs to press publish twice on order to publish I have an old plugin, which used to work fine (years ago). Now I have to press publish twice to publich the post.\nThe problem is in the blocks below. The used variables are declared above the code below. And there is no error there.\nAny effort to help will be much welcome. I have tried to use wp_insert_post instead. The error is still there.\nfunction prfx_meta_save( $post_id ) {\n\n\n \n\nif( is_null( get_post_meta( $post_id, $key = 'navn', true) ) ) {\n add_post_meta( $post_id, 'Elev_ID', $navn, true);\n} else {\n    update_post_meta( $post_id, 'navn', $navn );\n}\n\n\n if( is_null( get_post_meta( $post_id, $key = 'Elev_ID', true) ) ) {\n    add_post_meta( $post_id, 'Elev_ID', $Elev_ID, true);\n} else {\n         update_post_meta( $post_id, 'Elev_ID', $Elev_ID );\n}\n\nif( is_null( get_post_meta( $post_id, $key = 'XPRSfag_1', true) ) ) {\n add_post_meta( $post_id, 'XPRSfag_1', $XPRSfag_1, true);\n} else {\n        update_post_meta( $post_id, 'XPRSfag_1', $XPRSfag_1 );\n}\n\nif( is_null( get_post_meta( $post_id, $key = 'XPRSfag_2', true) ) ) {\n add_post_meta( $post_id, 'XPRSfag_2', $XPRSfag_2, true);\n} else {\n        update_post_meta( $post_id, 'XPRSfag_2', $XPRSfag_2 );\n}\n\nif( is_null( get_post_meta( $post_id, $key = 'L\u00e6rer_1', true) ) ) {\n add_post_meta( $post_id, 'L\u00e6rer_1', $L\u00e6rer_1, true);\n} else {\n        update_post_meta( $post_id, 'L\u00e6rer_1', $L\u00e6rer_1 );\n}\n\nif( is_null( get_post_meta( $post_id, $key = 'L\u00e6rer_2', true) ) ) {\n add_post_meta( $post_id, 'L\u00e6rer_2', $L\u00e6rer_2, true);\n} else {\n        update_post_meta( $post_id, 'L\u00e6rer_2', $L\u00e6rer_2 );\n}\n\nif( is_null( get_post_meta( $post_id, $key = 'Year', true) ) ) {\n add_post_meta( $post_id, 'Year', $Year, true);\n} else {\n        update_post_meta( $post_id, 'Year', $Year );\n}\n\n\n\n$katid1 = term_exists( $XPRSfag_1, 'category');\nif (is_null($katid1)) {\n    wp_create_category( $XPRSfag_1 );\n\n}\n\n$katid2 = term_exists( $XPRSfag_2, 'category' );\nif (is_null($katid2)) {\n    wp_create_category( $XPRSfag_2 );\n    $katid1 = term_exists( $XPRSfag_1 );\n    $katid2 = term_exists( $XPRSfag_2 );\n    wp_set_post_terms( $post_id, array( $katid1 , $katid2 ), 'category');\n} else {\n    $katid1 = term_exists( $XPRSfag_1 );\n    $katid2 = term_exists( $XPRSfag_2 );\n    wp_set_post_terms( $post_id, array( $katid1, $katid2 ), 'category');\n}\n\n\n\n\n}\n\n\nadd_action( 'save_post', 'prfx_meta_save', 99);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402918", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Exporting a form to a CSV file does not work in WordPress but it does in PHP I have a form with some fields that I need to implement in a WordPress template. If I do it in vanilla PHP it works but when I put it in a WordPress template it doesn't work, can it be a problem with $_POST?\n<?php\n/**\n * Template Name: Telesales\n */\n?>\n\n<?php if(isset($_POST['submit'])){\n\n    \n    $firstName = $_POST['firstName'];\n    $lastName = $_POST['lastName'];\n    $DOFMonth = $_POST['DOFMonth'];\n    $DOFDay = $_POST['DOFDay'];\n    $DOFYear = $_POST['DOFYear'];\n\n    \n   \n\n        $Content = \"Name,LastName,Birthday\\n\";\n        $Content .= \"$firstName,$lastName,$DOFMonth-$DOFDay-$DOFYear\\n\";\n\n        $FileName = $firstName.\"-\".date(\"d-m-y-h:i:s\").\".csv\";\n        header('Content-Type: application/csv'); \n        header('Content-Disposition: attachment; filename=\"' . $FileName . '\"'); \n        echo $Content;\n        exit();\n    \n} ?>\n\n<form action=\"\" method=\"post\">\n\n  <label>First name</label>\n  <input type=\"text\" name=\"firstName\" placeholder=\"Rose\" required=\"\" value=\"\">\n  <br>\n\n  <label>Last name</label>\n  <input type=\"text\" name=\"lastName\" placeholder=\"McDonnell\" required=\"\" value=\"\">\n  <br>\n\n  <label>Date of Birth</label>\n  <select name=\"DOFMonth\" required=\"\">\n    <option value=\"null\">Month</option>\n    <option value=\"January\">January</option>\n    <option value=\"February\">February</option>\n  </select>\n\n  <select name=\"DOFDay\" required=\"\">\n    <option value=\"null\">Day</option>\n    <option value=\"1\">1</option>\n    <option value=\"2\">2</option>\n    <option value=\"3\">3</option>\n    <option value=\"4\">4</option>\n    <option value=\"5\">5</option>\n  </select>\n  <select name=\"DOFYear\" required=\"\">\n    <option value=\"null\">Year</option>\n    <option value=\"1920\">1920</option>\n\n  </select>\n\n\n  <input type=\"submit\" name=\"submit\" value=\"Submit\">\n\n</form>\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402919", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Insert woocommerce products programmatically with featured image and gallery I'm inserting WooCommerce products programmatically to the database, but I'm having trouble inserting and linking first image as featured image and multiple images for gallery assigned respectively to each product from multiple URLs, Would you have any idea how to do it?\n<?php\n    if(!empty($girls))\n    {\n        $ops = array_map('str_getcsv', file(get_option('siteurl') . '/wp-content/uploads/2022/02/'. $girls));\n        \n        $myres = array_map('array_filter', $ops);\n        $ops2 = array_filter($myres);\n        \n        $items = array();\n        foreach($ops2 as $username) {\n        $items[] = $username;\n        }\n\n        foreach ($items as $it) {\n            \n\n            $title = array_key_exists(2, $it) ? $it[2] : null;\n            $description = array_key_exists(3, $it) ? $it[3] : null;\n            // Multiple images in each key\n            $img = array_key_exists(4, $it) ? $it[4] : null;\n            $secimg = explode(';', $img);\n            $category = array_key_exists(5, $it) ? $it[5] : null;\n            $price = array_key_exists(8, $it) ? $it[8] : null;\n            $stock = array_key_exists(6, $it) ? $it[6] : null;\n            \n                    foreach ($secimg as $rurl) {\n                    // <img height=\"200px\" src=\"https://static.wixstatic.com/media/'.$newtxt[0].'\"/>\n                    \n                        $postarr = array(\n                            'post_title' => wp_strip_all_tags($title),\n                            'post_name' => $title,\n                            'post_content' => $description,\n                            'post_type' => 'product',\n                            'post_status' => 'publish',\n                        );\n                        $insert_id = wp_insert_post($postarr, true);\n\n                        \n                        foreach ($secimg as $rurl) {\n                            if($rurl){\n                                \n                                // <img height=\"200px\" src=\"https://static.wixstatic.com/media/'.$newtxt[0].'\"/>\n                                    $image_url = \"https://static.wixstatic.com/media/\";\n                                    $image_url .= $rurl;//This is the sanitized image url.\n\n\n                            $urlimg = download_url( $image_url);\n    \n                            update_post_meta($insert_id, '_product_image_gallery', implode(',', array_keys($urlimg)));\n                            \n                            //update_post_meta($post_id,  array_push($post_id, '_product_image_gallery', $value ));\n                        }\n\n                    }\n\n\n                    //set Product Category\n                    wp_set_object_terms($insert_id, $category, 'product_cat');\n\n                    //set product type\n                    wp_set_object_terms($insert_id, 'simple', 'product_type');\n\n                    update_post_meta( $insert_id, '_price', $price );\n                    update_post_meta($insert_id, '_sku', $stock);\n                    update_post_meta($insert_id, 'total_sales', '0');\n                    \n                }// End first foreach\n            \n            \n        }\n\n    }?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402920", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to change the login-URL with function.php? I would to change the login URL of my site from http://example.com/wp-admin to http://example.com/example.\nI don't wanna use a plugin for do that, so can I do that from function.php ?\n\nA: It is simple to design a login page without the use of a plugin. Simply follow these simple steps to construct a login page using a template or a shortcode, both of which are discussed in this post.\nCreate Login Page In WordPress Without Using Plugin\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402922", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Categories are not listing their respective products I would like to know if anyone has faced this problem, I created some categories and registered some products in that category, when I try to open the category it does not load the products.\nI've tried several settings on the permalinks, but no success, if anyone has an idea of what may be happening, I would be very grateful if you could tell me!\n\nA: Normally, while creating a store, you'd go with the third choice, items and categories/subcategories. This means that users can either choose products directly from the main page or refine their search by going to a product category archive.\nThis tutorial will teach you how to show categories in a separate list before showing items.\nDistinguish the WooCommerce code that is used to display categories and subcategories on archive pages.\nMake a code plugin.\nCreate a function that places categories or subcategories before of product listings.\nCustomize the output\nNavigate to WooCommerce > Settings, then to the Products tab, and finally to the Display option. Select Show both for each of the Shop Page Display and Default Category Display choices.\nWooCommerce Product Category Display\nTo save your changes, click the Save changes button.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402924", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Not able to retrieve image id from sibling site within a switch_to_blog Here is how I am trying to grab the image id for 'white_logo'.\nswitch_to_blog($site->blog_id);\necho attachment_url_to_postid( get_theme_mod('white_logo'));\nrestore_current_blog();\n\nThe echo is printing '0'. It seems that when I use 'attachment_url_to_postid' for grabbing IDs of images that are within the current site's media library that it works. But when I try to grab IDs of images within other sites media libraries I'm not getting the desired response.\nIs there an alternative way to achieve this? Thank you!\nEDIT NOTE:\nI should add that I do know the 'switch_to_blog' is working properly as I am able to get the image url with 'get_theme_mod()'. I'm just unable to retrieve the ID with 'attachment_url_to_postid()'.\n\nA: Just keep in mind this is only going to get you the image ID, but it should do the trick... does in my circumstance at least.\n// switch to the correct blog\nswitch_to_blog( $site -> blog_id );\n\n// pull in our db global\nglobal $wpdb;\n\n// get the image ID\n$_image_id = $wpdb -> get_col( $wpdb -> prepare( \"SELECT ID FROM $wpdb->posts WHERE guid='%s';\", get_theme_mod( 'white_logo' ) ) );\n\n// switch back to the original blog\nrestore_current_blog( );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402932", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to change all external links to \"nofollow\" but only by user role I am looking for this question\nHow can I nofollow all external links by user role?\nI have found these codes to convert all links to Nofallow, can anyone change these codes according to the user's role\nhttps://www.codespeedy.com/relnofollow-for-all-external-links-in-wordpress-using-code/\n// add nofollow to links\nfunction nofollow_for_external($content) {\n    $content = preg_replace_callback( '/<a[^>]*href=[\"|\\']([^\"|\\']*)[\"|\\'][^>]*>([^<]*)<\\/a>/i', function($m) {\n     if (strpos($m[1], \"domain.com\") === false)\n          return '<a href=\"'.$m[1].'\" rel=\"nofollow\">'.$m[2].'</a>';\n     else\n         return '<a href=\"'.$m[1].'\">'.$m[2].'</a>';\n     },\n     $content );\n     return $content;\n }\n add_filter('the_content', 'nofollow_for_external');\n// Stop self pingback\nfunction disable_self_ping( &$links ) {\n    $home = get_option( 'home' );\n    foreach ( $links as $l => $link )\n        if ( 0 === strpos( $link, $home ) )\n            unset($links[$l]);\n}\nadd_action( 'pre_ping', 'disable_self_ping' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402933", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Posts missing in Dashboard, but are still on blog pages After a recent update I received a message from a customer saying they couldn't leave a post to one of my blogs.  I went to the Dashboard, and the menu item \"Posts\" and \"See all posts\" now come up with zero posts, although it looks like all the original posts are still on the blog pages they were written to.  Also, the \"View Posts\" link at the very top menu strip is mapped to the URL of my welcome page now and will only lead to it.\nhhoyt\nI tried disabling all plugins, all posts are still not reflected in the 'Posts' page in WP Dashboard, although they are all still on their respective Blog pages.  Any other ideas?\nThanks for the help!\nhhoyt\n\nA: This could be the result of a plugin or theme incompatibility. Please turn off all plugins and change themes. If that works, start enabling each plugin one by one to find the source.\nYou can also install the Health Check plugin. You can use its troubleshooting to have all plugins disabled and the theme changed for you. This will occur while you are still logged in and should not effect normal site visitors.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402935", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to disable activation email to specific user role? I'm using Ultimate Member to manage my user roles. I have the Activation Emails active and it sends to new subscribers as expected. But when a user with role \"Employee\" subscribes, I don't want them to get this activation email.\nRight now someone with the role \"Employee\" is getting two emails, the one I want and the extra activation one.\nIs there a way to deactivate the activation email for a specific user role?\nThanks in advance!\n\nA: The ultimate member is truly magical, although it is a little difficult to comprehend. If you wish to prevent certain user role notifications, utilise the ultimate member hook from the link below.\nUltimate Members Hooks\nhttps://docs.ultimatemember.com/article/1324-hooks-list?hook=um_email_notifications\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402936", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WPDB If primary key already exists, add +1 to integer field I need a system in which I check if a Primary key (string) already exists.\nIf it does, then I want to add 1 to a second column.\nIf it doesn't, then I want to add a new row and set the second column value to 1.\nHere is my attempt:\n$foodWishNameStr = ($_POST[\"foodWishName\"]);\n\n$foodWishPoint = 1;\n\n\n$sanitized_foodWish = sanitize_text_field($foodWishNameStr); /* Checks for problematic things in the string like invalid UTF-8, it converts < characters to entities, strips all tags, removes line breaks, tabs and extra white space. */\n\n\nglobal $wpdb;\n\n\n    //my column names in the table are foodWishName and foodWishPoints:\n    $sql = \"INSERT INTO foodWishes (foodWishName,foodWishPoints) VALUES (%s,%d) ON DUPLICATE KEY UPDATE foodWishPoints + 1 = %d\";\n    // var_dump($sql); // debug\n    $sql = $wpdb->prepare($sql,$sanitized_foodWish,$foodWishPoint, $foodWishPoint);\n    // var_dump($sql); // debug\n    $wpdb->query($sql);\n\n    if($sql){ //return the response\n        echo $sql;\n    }else{\n    echo \"something went very wrong\";\n    }\n\n    exit();\n\nThat gives me this error:\n<div id=\"error\"><p class=\"wpdberror\"><strong>WordPress database error:</strong> [You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;+ 1 = 1&#039; at line 1]<br /><code>INSERT INTO foodWishes (foodWishName,foodWishPoints) VALUES (&#039;redwinevinegar&#039;,1) ON DUPLICATE KEY UPDATE foodWishPoints + 1 = 1</code></p></div>INSERT INTO foodWishes (foodWishName,foodWishPoints) VALUES ('redwinevinegar',1) ON DUPLICATE KEY UPDATE foodWishPoints + 1 = 1\n\n\nA: This ended up being the correct formula in my case:\n$sql = \"INSERT INTO foodWishes(foodWishName,foodWishPoints) VALUES (%s,%d) ON DUPLICATE KEY UPDATE foodWishPoints = foodWishPoints +1\";\n    // var_dump($sql); // debug\n    $sql = $wpdb->prepare($sql,$sanitized_foodWish,$foodWishPoint,);\n    // var_dump($sql); // debug\n    $wpdb->query($sql);\n\n    if($sql){ //return the response\n        echo $sql;\n    }else{\n    echo \"something went very very wrong\";\n    }\n\n    exit();\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402944", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to call a function from a shortcode function in an oop plugin I\u2019m developing an OOP plugin based on WordPress-Plugin-Boilerplate by Devin Vinson.\nIn the includes folder, I\u2019ve created a class for shortcodes:\nclass My_Plugin_Shortcodes {\n\n    public static function foo_shortcode( $atts ) {\n        \n        // get parameters\n        $a = shortcode_atts( array(\n            'arg1' => '',\n            'arg2' => '',\n        ), $atts );\n        \n        // do something\n        \n        return $myFooVar;\n        \n    }   \n        \n    public static function bar_shortcode( $atts ) {\n        \n        // get parameters\n        $a = shortcode_atts( array(\n            'arg3' => '',\n            'arg4' => '',\n        ), $atts );\n        \n        // do something\n        \n        return $myBarVar;\n        \n    }   \n    \n}\n\nThe shortcodes are added in the primary plugin class, also in the includes folder:\nclass My_Plugin {\n\n    public function __construct() {\n\n        ...\n        \n        $this->load_shortcodes();\n        \n        ...\n        \n    }\n    \n    ...\n\n    private function load_shortcodes() {\n\n        $plugin_shortcodes = new My_Plugin_Shortcodes();\n\n        add_shortcode( 'foo', array( $plugin_shortcodes, 'foo_shortcode' ) );\n        add_shortcode( 'bar', array( $plugin_shortcodes, 'bar_shortcode' ) );\n    \n    \n    }\n\n}\n\nSo far, so good.\nBut a large part of what happens in Foo is identical to a large part of what happens in Bar, and I want to place the common code in a (subroutine) function that can be called by both Foo and Bar.  Procedurally, that might look like this:\nclass My_Plugin_Shortcodes {\n\n    public function foo_bar_subroutine( $a ) {\n        \n        // do something\n        \n        return $mySubVar;\n        \n    }   \n        \n    public static function foo_shortcode( $atts ) {\n        \n        // get parameters\n        $a = shortcode_atts( array(\n            'arg1' => '',\n            'arg2' => '',\n        ), $atts );\n        \n        // do something\n        \n        $myFooVar = foo_bar_subroutine( $a )\n        \n        return $myFooVar;\n        \n    }   \n        \n    public static function bar_shortcode( $atts ) {\n        \n        // get parameters\n        $a = shortcode_atts( array(\n            'arg3' => '',\n            'arg4' => '',\n        ), $atts );\n        \n        // do something\n        \n        $myBarVar = foo_bar_subroutine( $a )\n        \n        return $myBarVar;\n        \n    }   \n    \n}\n\nwhich doesn't work because it doesn't follow OOP conventions.  But I don't know how to set it up to follow both OOP conventions and WP conventions.  I assume that the subroutine doesn't get declared by either add_shortcode or add_action. But, if not, how does it get in?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402945", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Does `viewScript` in `block.json` actually enqueue a js file? If I have declared, viewScript in my block.json file. Do I need to enqueue the script manually within my register_block_type(); function also? (I didn't think it was necessary for 5.9?)\nMy Block.json\n\"textdomain\": \"postcode-pricing-wizard\",\n\"editorScript\": \"file:./index.js\",\n\"viewScript\": \"file:./view.js\",\n\"style\": \"file:./style-index.css\"\n\nMy Problem\nI've enqueued the script, as shown above, I can see a completed build directory and I can also see my block within the editor.\nview.js However, isn't loading for me on my front-end? I'm not too sure why?\nUnless I've misinterpreted the doc's Block Editor Handbook - Metadata\n{ \"viewScript\": \"file:./build/view.js\" }\n\n// Block type frontend script definition. \n// It will be enqueued only when viewing the content on the front of the site.\n// Since WordPress 5.9.0 (My WP Version - 5.9)\n\n--\nHere's my register_block_type() function just in case it's needed.\nregister_block_type( PPW_DIR_PATH . '/build/pricing-wizard-block/',\n    array(\n        'render_callback' => function( $attributes, $content ) {\n            if(!is_admin()) {\n                wp_localize_script( 'wp-block-ppw-postcode-pricing-wizard-js', 'data', ['ajax_url' => admin_url('admin-ajax.php')]);\n            }\n\n            ob_start();\n            include_once plugin_dir_path( __FILE__ ) . '/includes/block-editor/pricing-wizard-block/views' . '/block.php';\n            return ob_get_clean();\n        },\n    )\n);\n\n\nA: Note to self, rest-up and re-read the docs.\nSo it turns out that the answer is written in the docs, but rather obscurely. If you check out the Frontend Enqueueing section of the Block Editor Handbook, you'll see this statement.\nFrontend Enqueueing #Frontend Enqueueing\nStarting in the WordPress 5.8 release, it is possible to instruct WordPress to enqueue scripts and styles for a block type only when rendered on the frontend. It applies to the following asset fields in the block.json file:\n\n- script\n- viewScript (when the block defines render_callback during registration in PHP, then the block author is responsible for enqueuing the script)\n- style\n\nAs it turns out I have defined a render_callback so I do need to manually enqueue my view.js script.\nYou know when you're just that tired you get tunnel vision. Yeah, this was one of those times. Anyway, thanks for reading. Figured I'd answer for anyone else that came along with a similar issue. \n\nA: EVEN NEWER EDIT: I actively participated as contributor in changing this rule. Starting from WordPress 6.1, viewScript will enqueue javascript even for dynamic blocks.\nSee trac #56470.\nEDIT: I spoke yesterday with WP developers, viewScript does not actually enqueue script, but only registers it.\nThe reason is that in render_callback you might conclude that script is not necessary and not enqueue it. So, only for dynamic blocks, viewScript registers the script, while you must enqueue it in render_callback. For regular React blocks, script is automatically enqueued.\n\nI tested this with WordPress 5.9.3 and @wordpress/scripts 22.5.0 and script does get enqueued. I think the original error was \"viewScript\": \"file:./build/view.js\" in block.json. Block.json should be placed in src directory, together with view script and they are copied in the build process to build directory. Afterwards, block is initialized from build directory.\ni.e. for dynamic block logos (it has php for front end showing)\n...\nrequire 'logos/src/index.php';\nregister_block_type( \"$dir/logos/build\",\n    ['render_callback' => 'render_logos'] );\n...\n\nin block.json:\n...\n\"editorScript\": \"file:index.js\",\n\"editorStyle\": \"file:index.css\",\n\"style\": \"file:style-index.css\",\n\"viewScript\": \"file:logos-front.js\",\n...\n\n\nA: I had a similar problem, but it was because my wp script build and wp script start used a custom entry point.\nI had to add my viewScript manually to the build/start commands as in this example. Then in block.json I pointed the viewScript to the build folder, and it began enqueuing automatically:\n\"build:custom\": \"wp-scripts build index.js view.js --output-path=build\"\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402946", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "4"}}
{"text": "Q: How to change background slider image when hovering on text? I'd like to have a full screen slider with several project title headers on top. My goal is that when the user hovers on the name of a project, the backgorund image changes to an image specific to that project (whether that's using the slider or another way). And when the user is not hovered on a project title, the slider just keeps showing its images normally.\nI'm guessing that this would involve some JS or CSS, but I'm not sure. I'm relatively new to WordPress.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402950", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Settings API not saving values to database Here is what I'm attempting to do:\n\n*\n\n*I have two fields called Client ID and Client Secret.\n\n*I would like to save each individual item in the database as the following keys: instagram_client_id and instagram_client_secret.\n\nDoes anyone see what I'm doing wrong with the Settings API? As you can see, I am showing the fields but when I input any value, it doesn't create a database key or save any values.\n\n\nSo I have the following items setup:\nprivate function create_site_admin_page()\n{\n    add_action('admin_menu', [$this, 'add_instagram_settings_page'], 1);\n    add_action('admin_init', [$this, 'register_client_settings'], 2);\n}\n\npublic function add_instagram_settings_page()\n{\n    add_options_page(\n        'Instagram',\n        'Instagram',\n        'manage_options',\n        'instagram',\n        [\n            $this,\n            'render_options_page'\n        ]\n    );\n}\n\npublic function render_options_page()\n{\n    // Show API Credentials fields if user is admin\n    if (is_admin()) {\n        $this->get_api_credentials();\n    }\n\n    echo $this->get_instagram_settings_content();\n}\n\npublic function get_api_credentials()\n{\n    ?>\n    <h2>API Credentials</h2>\n    <form action=\"options.php\" method=\"post\">\n        <?php\n        settings_fields('client_section');\n        do_settings_sections('instagram');\n        submit_button();\n        ?>\n    </form>\n    <?php\n}\n\npublic function register_client_settings()\n{\n    add_settings_section(\n        'client_section',\n        '',\n        '',\n        'instagram'\n    );\n\n    // Credentials Key\n    add_settings_field(\n        'client_id_field',\n        'Client ID',\n        [$this, 'render_client_id_field'],\n        'instagram',\n        'client_section'\n    );\n\n    // Credentials Secret\n    add_settings_field(\n        'client_secret_field',\n        'Client Secret',\n        [$this, 'render_client_secret_field'],\n        'instagram',\n        'client_section'\n    );\n\n    register_setting(\n        'client_section',\n        'client_id_field',\n        'validate_client_settings_inputs'\n    );\n\n    register_setting(\n        'client_section',\n        'client_secret_field',\n        'validate_client_settings_inputs'\n    );\n}\n\npublic function validate_client_settings_inputs($input): array\n{\n    $output['client_id_field'] = sanitize_text_field($input['client_id_field']);\n    $output['client_secret_field'] = sanitize_text_field($input['client_secret_field']);\n\n    return $output;\n}\n\npublic function render_client_id_field() {\n    $client_id = get_option('instagram_client_id');\n    printf(\n        '<input type=\"text\" name=\"%s\" value=\"%s\" />',\n        esc_attr(\n            'client_id'\n        ),\n        esc_attr(\n            $client_id\n        )\n    );\n}\n\npublic function render_client_secret_field() {\n    $client_secret = get_option('instagram_client_secret');\n    printf(\n        '<input type=\"text\" name=\"%s\" value=\"%s\" />',\n        esc_attr(\n            'client_secret'\n        ),\n        esc_attr(\n            $client_secret\n        )\n    );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402952", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to create custom post page in WordPress? I want to create a post page template for my website.\nI am currently using the theme's default post page. I created a template (Template 1) with wp-bakery in  pages section with JegTheme addons :\n\nWhen a users enters a blog post, they should see that post with the template that I prepared.\nI tried to change it from settings -> reading -> Post page: Template 1\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402954", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom post category name showing empty I have a custom post type and category. I have the below function on my page. I am getting the post but I am not getting the category name on the page.\nI am getting the empty array\narray(0) { } \n\nBelow is the function code.\n<?php \nfunction blogView( $atts ){\n  global $post;\n\n  if($atts['cat']=='All'){      \n    $blog_post = get_posts(array(\n      'showposts' => 80, //add -1 if you want to show all posts\n      'post_type' => 'blog'\n      ));\n  }else{  \n    $blog_post = get_posts(array(\n      'showposts' => 10, //add -1 if you want to show all posts\n      'post_type' => 'blog',\n      'tax_query' => array(\n        array(\n      'taxonomy' => 'blogs_cats',\n      'field' => 'slug',\n      'terms' => $atts['cat'] //pass your term name here\n        )\n      ))\n       );\n  }\n     \n$data='<ul class=\"post-grid-list\">';\n    foreach($blog_post as $t){\n    $tid = $t->ID;\n\n         /*Display category code here*/\n          $category_detail=get_the_category('4');//$post->ID\n          foreach($category_detail as $cd){\n          echo $cd->cat_name;\n          }\n        /*end here*/\n\n\n         $data.='';\n\n    }\n    $data.='</ul>';\n\n    return $data; \n\n}\nadd_shortcode( 'blog', 'blogView');\n\n\nA: Note that the get_the_category() documentation stated that:\n\nNote: This function only returns results from the default \"category\"\ntaxonomy. For custom taxonomies use\nget_the_terms().\n\nSo if I guessed it correctly that you're trying to display the blogs_cats terms for the current post, then you should use get_the_terms() instead.\nThere's also get_the_term_list() if you just want to display a list of terms like Foo Bar, Term 2 where each term links to their own archive page.\nExamples:\n\n*\n\n*Manually loop through the terms returned by get_the_terms() to output a simple list of term names (only):\n$category_detail = get_the_terms( $tid, 'blogs_cats' );\n\n$cats = array();\nif ( is_array( $category_detail ) ) {\n    foreach ( $category_detail as $cd ) {\n        $cats[] = $cd->name;\n    }\n}\n\n$data .= \"<li>blogs_cats for $tid: \" . implode( ', ', $cats ) . '</li>';\n\n\n\n*Or use get_the_term_list() to output a list of term names + links:\n$cat_list = get_the_term_list( $tid, 'blogs_cats', '<i>', ', ', '</i>' );\n$data .= \"<li>blogs_cats for $tid: $cat_list</li>\";\n\nAdditionally, you should call shortcode_atts() to ensure that the cat argument exists in $atts (e.g. when using just [blog], i.e. without specifying any parameters). E.g.\nfunction blogView( $atts ){\n    global $post;\n\n    $atts = shortcode_atts( array(\n        'cat' => 'All',\n    ), $atts );\n\n    // ... your code.\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402956", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can I disable xml-rpc by setting it to false? I've been searching about it and came across with this snippet code, will it disable safely the xml-rpc?\n// set below line to false in /public_html/xmlrpc.php \n...\ndefine( 'XMLRPC_REQUEST', true );\n...\n\nUpdate\nI've installed and activated Disable XML-RPC plugin, but the wordpress security scanner still showing it is enabled!\n\n(I'm newbie in wordpress/php code development )\nUpdate2\nI've installed wpscan and just use it to test my web site and here is the result for xml-rpc:\n\n[+] XML-RPC seems to be enabled: https://..../xmlrpc.php\n | Found By: Link Tag (Passive Detection)\n | Confidence: 100%\n | Confirmed By: Direct Access (Aggressive Detection), 100% confidence\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n\n[+] WordPress version 5.9 identified (Latest, released on 2022-01-25).\n | Found By: Rss Generator (Passive Detection)\n |  - https://..../feed/, <generator>https://wordpress.org/?v=5.9</generator>\n |  - https://cafedx.com/comments/feed/, <generator>https://wordpress.org/?v=5.9</generator>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402957", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom User Registration Form not showing I need help to show my own created user registration form. Whatever I do, WP 5.9 is always showing the default registration form.\nI have used many different plugins to create a customer registration form and followed all steps described in the plugins. Whatever I do, WP always shows the default registration form. Is there a way/setting to replace the default form?\nThank you so much,\nHump\n\nA: Presuming you have your custom registration form set up to its own URL, such as /custom-register-page/ or something like it, then you can use the following code to change the register URL on the default WP login page:\nadd_filter( 'register_url', 'update_register_url' );\nfunction update_register_url( $url ) {\n    if( is_admin() ) {\n        return $url;\n    }\n    return \"/custom-register-page/\";\n}\n\nAdd this code to your template's functions.php file, if that makes sense, or create a plugin to use this code. Make sure to update the code to use your custom register page URL.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402959", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: My combination of 'post_type' and 'tax_query' not working? I want to filter search results by custom post type and custom taxonomy terms, the result is here:\n\nadd_action('pre_get_posts','search_filter');\nfunction search_filter($query) {\n    if($query->query_vars['s'] != '' && is_search())\n    {\n        $query->set('post_type', array('partner','event','product'));\n        $tax_query = array(\n            'relation' => 'OR',\n            array(\n                'taxonomy' => 'city',\n                'field'    => 'slug',\n                'terms'    => array( 'belgrade' )\n            )\n        );\n        $query->set( 'tax_query', $tax_query );\n    }\n}\n\nPosts from specific CPT works, but filter by a category, not.\nWhy? :)\n\nA: I think the issue here is you're using the relation where you only have one inner tax array. So, it should be without one.\n$tax_query = array(\n      array(\n         'taxonomy' => 'city',\n         'field'    => 'slug',\n         'terms'    => array( 'belgrade' )\n   )\n);\n\nHere's a detailed explanation from WP: Taxonomy Parameters\n\n*\n\n*relation (string) \u2013 The logical relationship between each inner taxonomy array when there is more than one. Possible values are \u2018AND\u2019, \u2018OR\u2019. Do not use with a single inner taxonomy array.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402961", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Search Ajax + Isotope + InfiniteScroll Custom Ajax Search filter for WordPress Search\nI want to give a complete breakdown so you can easily analyse the problem and see that the issue is nowhere else, but the JavaScript. If you are not new to this please just scroll to the javaScript CUSTOM-SEARCH.JS section.\nI found an article on how to add ajax search filters.\nsearchform.php (Standard Search Form)\nTHE STANDARD SEARCH FORM\nBefore the filters, I edited the search form so a user can search based on post type (opone,optwo,opthree).\n<form role=\"search\" method=\"get\" class=\"search-form\" action=\"<?php echo esc_url( home_url( '/' ) ); ?>\">\n<select id=\"drpdwn_search\">\n    <option value=\"any\" selected>Choose Type</option>\n    <option value=\"opone\">Option 1</option>\n    <option value=\"optwo\">Option 2</option>\n    <option value=\"opthree\">Option 3</option>\n</select>\n\n<input type=\"search\" class=\"search-field form-control\" name=\"s\" placeholder=\"Search\" value=\"<?php echo esc_attr( get_search_query() ); ?>\" title=\"<?php _ex( 'Search for:', 'label', 'wp-bootstrap-starter' ); ?>\">\n    <input type=\"hidden\" name=\"post_type\" value=\"any\" />\n        <input type=\"submit\" class=\"search-submit btn btn-default\" value=\"<?php echo esc_attr_x( 'Search', 'submit button', 'wp-bootstrap-starter' ); ?>\">\n</form>\n\nThe site was working normally where the search results were shown and InfiniteScroll was used for pagination, but I wanted to be able to filter the search results so I tried creating an ajax search filter form.\nsearch.php (AJAX Filter Form/Search Results template)\nIgnore $actual_link - Since I am using a staging server without SSL $actual_link variable supports HTTP and HTTPS, but will change in production if the variable gets used.\nQuery Moved\nI moved the query into a function according to the instructions to implement the ajax filter so it is no longer in search.php.\nAjax Filter Form\nFor the AJAX filter form, I got the search term using the get_search_query() function in the search field input and post type (opone,optwo,opthree) from the query string in the URL (http://somedomain.com/?s={SEARCH TERM}&post_type={POST TYPE})and stored it as a variable ($param). Based on the post type selected, only its custom taxonomy \"categories\" ('opone_cat','optwo_cat','opthree_cat') will be an option in the AJAX filter form. Then created radio buttons in the AJAX filter form so users can display results ascending or descending.\nAjax search filter form and response div (.scroll-content) in search results template (search.php):\n<?php\n$actual_link = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? \"https\" : \"http\") . \"://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]\";\n$param = filter_input(INPUT_GET, 'post_type', FILTER_SANITIZE_URL);\n?>\n<form action=\"<?php echo site_url() ?>/wp-admin/admin-ajax.php\" method=\"POST\" id=\"filter\">\n<input type=\"search\" class=\"search-field form-control\" name=\"s\" placeholder=\"Search\" value=\"<?php echo esc_attr( get_search_query() ); ?>\" title=\"<?php _ex( 'Search for:', 'label', 'wp-bootstrap-starter' ); ?>\">\n<input type=\"hidden\" class=\"form-control\" name=\"post_type\" value=\"<?php echo $param; ?>\" />\n<?php \nif('opone' == $param) {\nif( $terms = get_terms( array(\n    'taxonomy' => 'opone_cat', \n    'orderby' => 'name'\n) ) ) : \n    // if categories exist, display the dropdown\n    echo '<select name=\"categoryfilter\" class=\"form-select\" aria-label=\"Default select example\"><option value=\"\">Select category...</option>';\n    foreach ( $terms as $term ) :\n        echo '<option value=\"' . $term->term_id . '\">' . $term->name . '</option>'; // ID of the category as an option value\n    endforeach;\n    echo '</select>';\nendif;\n} else if('optwo' == $param) {\nif( $terms = get_terms( array(\n    'taxonomy' => 'optwo_cat', \n    'orderby' => 'name'\n) ) ) : \n    // if categories exist, display the dropdown\n    echo '<select name=\"categoryfilter\" class=\"form-select\" aria-label=\"Default select example\"><option value=\"\">Select category...</option>';\n    foreach ( $terms as $term ) :\n        echo '<option value=\"' . $term->term_id . '\">' . $term->name . '</option>'; // ID of the category as an option value\n    endforeach;\n    echo '</select>';\nendif;\n} else if('opthree' == $param) {\nif( $terms = get_terms( array(\n    'taxonomy' => 'opthree_cat', \n    'orderby' => 'name'\n) ) ) : \n    // if categories exist, display the dropdown\n    echo '<select name=\"categoryfilter\" class=\"form-select\" aria-label=\"Default select example\"><option value=\"\">Select category...</option>';\n    foreach ( $terms as $term ) :\n        echo '<option value=\"' . $term->term_id . '\">' . $term->name . '</option>'; // ID of the category as an option value\n    endforeach;\n    echo '</select>';\nendif;\n} else {\nif( $terms = get_terms( array(\n    'taxonomy' => array('opone_cat','optwo_cat','opthree_cat'), \n    'orderby' => 'date'\n) ) ) : \n    // if categories exist, display the dropdown\n    echo '<select name=\"categoryfilter\" class=\"form-select\" aria-label=\"Default select example\"><option value=\"\">Select category...</option>';\n    foreach ( $terms as $term ) :\n        echo '<option value=\"' . $term->term_id . '\">' . $term->name . '</option>'; // ID of the category as an option value\n    endforeach;\n    echo '</select>';\nendif;\n}\n?>\n<div class=\"form-check form-check-inline\">\n    <input class=\"form-check-input\" type=\"radio\" id=\"asc\" name=\"date\" value=\"ASC\" />\n    <label class=\"form-check-label\" for=\"asc\">Date: Ascending</label>\n</div>\n<div class=\"form-check form-check-inline\">\n    <input class=\"form-check-input\" type=\"radio\" id=\"dsc\" name=\"date\" value=\"DESC\" selected=\"selected\" />\n    <label class=\"form-check-label\" for=\"dsc\">Date: Descending</label>\n</div>\n<button class=\"btn btn-primary btn-filter btn-lg\">Apply filter</button>\n    <input type=\"hidden\" name=\"action\" value=\"myfilter\">\n</form>\n</div>\n\n<div class=\"scroll-content col-sm-12 col-md-9\"></div>\n\n\nIf you look at the ajax search filter form above in search.php (search results template), we have a hidden action input with the value myfilter.\n<input type=\"hidden\" name=\"action\" value=\"myfilter\">\n\nfunctions.php\nmyfilter - the name of the AJAX action callback being fired.\nIn the instructions to implement the Ajax search filter, we are to put the query in a function and add these ajax action hooks to handle the request. One hook is for logged-in (wp_ajax_myfilter) users and the other for non-logged-in (wp_ajax_nopriv_myfilter) users.\nadd_action('wp_ajax_myfilter', 'search_filter_function'); \nadd_action('wp_ajax_nopriv_myfilter', 'search_filter_function');\n\n\nThe function below has the search query loop. From the ajax filter form, we were able to get the search term $_POST['s'], post type $_POST['post_type'], date $_POST['date'], and post type taxonomies $_POST['categoryfilter'] as arguments for the search query loop.\nThe other arguments ($args) include the standard paging variable to use for the paged argument (pagination), set post_status to make sure only published posts are in the results, and posts_per_page to show only six posts per page.\nAs you can see I am using get_template_part() to add the content (posts) and pagination.\nadd_action('wp_ajax_myfilter', 'search_filter_function'); \nadd_action('wp_ajax_nopriv_myfilter', 'search_filter_function');\n\nfunction search_filter_function(){\n    global $wp_post_types, $wp_query;\n    $wp_post_types['page']->exclude_from_search = true; \n    $paged = ( get_query_var( 'paged' ) ) ? get_query_var( 'paged' ) : 1;\n    $args = array(\n        's' => $_POST['s'],\n        'post_type' => $_POST['post_type'],\n        'post_status' => 'publish',\n        'posts_per_page' => 6,\n        'orderby' => 'date', // we will sort posts by date\n        'order' => $_POST['date'], // ASC or DESC\n        'paged' => $paged\n    );\n \n    // for taxonomies / categories\n    if( isset( $_POST['categoryfilter'] ) )\n         $args['tax_query'] = array(\n            'relation' => 'OR',\n            array(\n                'taxonomy' => 'opone',\n                'field'    => 'id',\n                'terms'    =>  $_POST['categoryfilter'],\n            ),\n            array(\n                'taxonomy' => 'optwo',\n                'field'    => 'id',\n                'terms'    =>  $_POST['categoryfilter'],\n            ),\n            array(\n                'taxonomy' => 'opthree',\n                'field'    => 'id',\n                'terms'    => $_POST['categoryfilter'],\n            ),\n        );  \n\n$search =  new WP_Query( $args );\n\nif ( $search->have_posts() ) : while ( $search->have_posts() ) : $search->the_post();\n\n\n            get_template_part( 'template-parts/content', 'search' );\n\n        endwhile; \n\n            get_template_part( 'template-parts/pagination', 'notabs' );\n\n        else :\n\n            get_template_part( 'template-parts/content', 'none' ); \n            \n        endif;\n\n    \n    die();\n}\n\n/TEMPLATE-PARTS/CONTENT-SEARCH.PHP\nThe template parts were working before adding the ajax filter and as you can see I know better not to add any custom scripts to these particular files.\nI also excluded the page post type as well.\nHere is the content template:\n<article id=\"post-<?php the_ID(); ?>\" <?php post_class('scroll-post'); ?> data-category=\"<?php echo get_post_type(); ?>\">\n    <div class=\"post-thumbnail\">\n        <?php the_post_thumbnail(); ?>\n    </div>\n    <header class=\"entry-header\">\n        <?php\n            the_title( '<h2 class=\"entry-title\"><a href=\"' . esc_url( get_permalink() ) . '\" rel=\"bookmark\">', '</a></h2>' );\n\n ?>\n        <div class=\"entry-meta\">\n            <?php wp_bootstrap_starter_posted_on(); ?>\n        </div><!-- .entry-meta -->\n    </header><!-- .entry-header -->\n    <!-- <div class=\"entry-content\">excerpt</div> -->\n    <footer class=\"entry-footer\">\n        <?php wp_bootstrap_starter_entry_footer(); ?>\n    </footer><!-- .entry-footer -->\n</article><!-- #post-## -->\n\n\n/TEMPLATE-PARTS/PAGINATION-NOTABS.PHP\nHere is the pagination template:\n<?php if(wp_script_is( 'infinite', 'enqueued' )) : ?>\n    <div class=\"page-load-status\">\n      <div class=\"loader-ellips infinite-scroll-request\">\n        <span class=\"loader-ellips__dot\"></span>\n        <span class=\"loader-ellips__dot\"></span>\n        <span class=\"loader-ellips__dot\"></span>\n        <span class=\"loader-ellips__dot\"></span>\n      </div>\n      <p class=\"infinite-scroll-last\">End of content</p>\n      <p class=\"infinite-scroll-error\">No more pages to load</p>\n    </div>\n      <p>\n      <button class=\"btn btn-primary btn-scroll btn-lg\">View more</button>\n    </p>\n    <div id=\"nav-below infinite\" class=\"pagination\">\n        <div class=\"next-post\"><?php next_posts_link() ?></div>\n    </div>\n<?php endif; ?>\n\nFUNCTIONS.PHP (JavaScript)\nI had already enqueued the Isotope script and its layout fitRows. Also added the InfiniteScroll script and registered/localized a custom javaScript file (custom-search.js) so I can pass a PHP variable ($search_param) with the search term since it will be needed in the custom-search.js file.\nVersions:\n\n*\n\n*Isotope PACKAGED v3.0.6\n\n*Infinite Scroll PACKAGED v3.0.6\n\nwp_enqueue_script('isotope', get_template_directory_uri() . '/inc/assets/js/isotope/isotope.pkgd.min.js', array('jquery'), '', false);\n\nwp_enqueue_script('fitrows', get_template_directory_uri() . '/inc/assets/js/isotope/layout-modes/fit-rows.js', array('isotope'), '', false);\n\nif( is_search() ) {\nwp_register_script( 'custom-search', get_template_directory_uri() . '/inc/assets/js/isotope/archive-search.js', array('infinite'), '', true );\n\n$search_query = get_search_query();\n$search_param = array('search_term' => $search_query);\n \n     wp_enqueue_script('infinite', get_template_directory_uri() . '/inc/assets/js/isotope/infinitescroll.pkgd.min.js', array('jquery'), '', false);\n        wp_enqueue_script('custom-search', get_template_directory_uri() . '/inc/assets/js/isotope/custom-search.js', array('infinite'), '', true);\n\nwp_localize_script( 'custom-search', 'searchParam', $search_param );\n\n}\n\n\nCUSTOM-SEARCH.JS (JavaScript)\nGreat news! The filter works but...\nKey problem - Isotope and InfiniteScroll does not work on the filtered posts and posts do not show without the filter being applied.\nIsotope and InfiniteScroll stopped working after adding the AJAX filter form in the search results template (search.php) and after moving the query to a function (functions.php). I copied the Ajax call from the instructions and added above the previously working InfiniteScroll and Isotope below in custom-search.js.\n**From what I know, I need to apply the Isotope fitRows layout when appending posts. I think InfiniteScroll for pagination is a problem due to it only being initialised here based on the post type in the URL query string.\nI also need to show the initial search results by default (before filters are applied) and hide (fade out) the initial search results before the filtered posts are displayed.**\nThis is where I need help.\njQuery(window).on('load', function () {\n    jQuery('#filter').submit(function () {\n        var filter = jQuery('#filter');\n        jQuery.ajax({\n            url: filter.attr('action'),\n            data: filter.serialize(),\n            type: filter.attr('method'), // POST\n            beforeSend: function (xhr) {\n                filter.find('.btn-filter').text('Processing...');\n            },\n            success: function (data) {\n                filter.find('.btn-filter').text('Apply filter');\n                jQuery('.scroll-content').html(data); // insert data\n            } //success\n        }); // jQuery ajax\n        return false;\n    }); //submit function\n\n    let currentLocation = window.location.href;\n    const ptParams = new Proxy(new URLSearchParams(window.location.search), {get: (searchParams, prop) => searchParams.get(prop),});\n\n    let post_type_value = ptParams.post_type;\n    let $scroll_container = jQuery('.scroll-content');\n    let fhsFit = $scroll_container.data('isotope');\n    \n    $scroll_container.isotope({\n        layoutMode: 'fitRows',\n        itemSelector: '.scroll-post'\n    }); //isotope\n\n \n    if ( post_type_value === 'opone' || post_type_value === 'optwo' || post_type_value === 'opthree' ) {\n        $scroll_container.infiniteScroll({\n            path: 'page/{{#}}/?s=' + searchParam.search_term + '&post_type=' + post_type_value,\n            append: '.scroll-post',\n            button: '.btn-scroll',\n            outlayer: fhsFit,\n            loadOnScroll: false,\n            scrollThreshold: 300,\n            status: '.page-load-status',\n            hideNav: '.pagination'\n        }); //infinite scroll\n    } else {\n        $scroll_container.infiniteScroll({\n            path: 'page/{{#}}/?s=' + searchParam.search_term + '&post_type=any',\n            append: '.scroll-post',\n            button: '.btn-scroll',\n            outlayer: fhsFit,\n            loadOnScroll: false,\n            scrollThreshold: 300,\n            status: '.page-load-status',\n            hideNav: '.pagination'\n        }); //infinite scroll\n    } //if statement\n\n    jQuery('.btn-scroll').on('click', function () {\n        $scroll_container.on('load.infiniteScroll', function (event) {\n            $scroll_container.isotope('layout');\n            jQuery('.page-load-status').detach().appendTo(jQuery('.scroll-content'));\n        }); //on load function\n    }); // on click function\n}); // window on load\n\n\n\nA: I was able to figure it out...well as long as jQuery and AJAX are alive and utilized by WordPress (I know it may be best to use WordPress REST API, but ...this works)!\nGET STARTED\nI did have to edit searchform.php, functions.php, search.php, and custom-search.js. Please make sure taxonomies and post types are queryable (public) and query vars are set to true. If you used CPT UI you can edit them here:\nhttp://domain.com/wp-admin/admin.php?page=cptui_manage_taxonomies&action=edit\nSet the 'Public Queryable' option to 'true' and 'Query Var' to 'true'.\nSEARCHFORM.PHP\nI had to turn off auto-complete on the search and ajax filter form in case of users using the back button since the InfiniteScroll option for history by default is set to true.\n<form role=\"search\" method=\"get\" class=\"search-form\" action=\"<?php echo esc_url( home_url( '/' ) ); ?>\" autocomplete=\"off\">\n<select id=\"drpdwn_search\">\n    <option value=\"any\" selected>All</option>\n    <option value=\"opone\">One</option>\n    <option value=\"optwo\">Two</option>\n    <option value=\"opthree\">Three</option>\n</select>\n\n<input type=\"search\" class=\"search-field form-control\" name=\"s\" placeholder=\"Search\" value=\"<?php echo esc_attr( get_search_query() ); ?>\" title=\"<?php _ex( 'Search for:', 'label', 'wp-bootstrap-starter' ); ?>\">\n    <input type=\"hidden\" name=\"post_type\" value=\"any\" />\n        <input type=\"submit\" class=\"search-submit btn btn-default\" value=\"<?php echo esc_attr_x( 'Search', 'submit button', 'wp-bootstrap-starter' ); ?>\">\n</form>\n\nAs you can see if a user does not select a post type it defaults to any' post type for the value.\n<input type=\"hidden\" name=\"post_type\" value=\"any\" />\n\nSEARCH.PHP\nThe ajax filter form fields should all be required through HTML.\nAjax Filter - Form Tag\nI added the autocomplete attribute on the form tag and set it to off.\nAjax Filter Form - Taxonomies\nFYI: My taxonomies are custom post type categories created with CPT UI - as you can see throughout the whole thing I did not use WP Core Categories.\nIn the ajax filter form, I edited the taxonomies filter to get all terms when the post type is set to any in the else statement.\nAjax Filter Form - Search Field\nI then set the search-field input type to hidden so they can only filter the search term from the form in searchform.php. I plan on displaying the search form in the header (header.php) so it can be everywhere so... the search field in the ajax filter form can remain hidden unless you want to filter with it on the search results page).\nDefault Search Results Query  (Not in AJAX Callback Duh..)\nI use the default search query loop ($wp_query) for non-ajax-filtered results. We do not need to use a custom search query. This link explains the mistake that I made. The loop in the AJAX callback function uses query_posts() although many articles state not to use it. One reason is that it breaks paging, but it is okay since I will use a hard-coded URL path for the AJAX InfiniteScroll instance.\nAjax Filter Search Results Query - Container DIV\nI wanted the ajax call to have its own container, so I added a div with only the same bootstrap classes as the default search query container, but with the id (#ajax_container).\n<section class=\"row\">\n    <div id=\"secondary\" class=\"content-area col-sm-12 col-md-2\">\n<?php\n$actual_link = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? \"https\" : \"http\") . \"://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]\";\n$param = filter_input(INPUT_GET, 'post_type', FILTER_SANITIZE_URL);\n?>\n<form action=\"<?php echo site_url() ?>/wp-admin/admin-ajax.php\" method=\"POST\" id=\"filter\" autocomplete=\"off\">\n<input type=\"hidden\" class=\"search-field form-control\" name=\"s\" placeholder=\"Search\" value=\"<?php echo esc_attr(get_search_query()); ?>\" title=\"<?php _ex('Search for:', 'label', 'wp-bootstrap-starter'); ?>\">\n<input type=\"hidden\" class=\"form-control\" name=\"post_type\" value=\"<?php echo $param; ?>\" />\n<?php\nif ('font' == $param) {\n    if ($terms = get_terms(array('taxonomy' => 'font_cat', 'hide_empty' => false, 'orderby' => 'name'))):\n        // if categories exist, display the dropdown\n        echo '<select name=\"categoryfilter\" class=\"form-select\" aria-label=\"One categories\"><option value=\"\">Select category...</option>';\n        foreach ($terms as $term):\n            echo '<option value=\"' . $term->term_id . '\">' . $term->name . '</option>'; // ID of the category as an option value\n            \n        endforeach;\n        echo '</select>';\n    endif;\n} else if ('snipp' == $param) {\n    if ($terms = get_terms(array('taxonomy' => 'snipp_cat', 'hide_empty' => false, 'orderby' => 'name'))):\n        // if categories exist, display the dropdown\n        echo '<select name=\"categoryfilter\" class=\"form-select\" aria-label=\"Two categories\"><option value=\"\">Select category...</option>';\n        foreach ($terms as $term):\n            echo '<option value=\"' . $term->term_id . '\">' . $term->name . '</option>'; // ID of the category as an option value\n            \n        endforeach;\n        echo '</select>';\n    endif;\n} else if ('post' == $param) {\n    if ($terms = get_terms(array('taxonomy' => 'blog_cat', 'hide_empty' => false, 'orderby' => 'name'))):\n        // if categories exist, display the dropdown\n        echo '<select name=\"categoryfilter\" class=\"form-select\" aria-label=\"Three categories\"><option value=\"\">Select category...</option>';\n        foreach ($terms as $term):\n            echo '<option value=\"' . $term->term_id . '\">' . $term->name . '</option>'; // ID of the category as an option value\n            \n        endforeach;\n        echo '</select>';\n    endif;\n} else {\n    $term_args = array('taxonomy' => array('font_cat', 'snipp_cat', 'blog_cat'), 'hide_empty' => false, 'fields' => 'all', 'count' => true,);\n    $term_query = new WP_Term_Query($term_args);\n    $term_taxs = $term_args[\"taxonomy\"];\n    echo '<select name=\"categoryfilter\" class=\"form-select\" aria-label=\"All categories\" required><option value=\"\">Select category...</option>';\n    foreach ($term_taxs as $term_tax):\n        if ($term_tax === 'font_cat'):\n            echo '<option value=\"\" disabled>Font Categories</option>';\n            foreach ($term_query->terms as $term):\n                if ($term->taxonomy == 'font_cat'):\n                    echo '<option value=\"' . $term->term_id . '\">' . $term->name . '</option>';\n                endif;\n            endforeach;\n        endif;\n        if ($term_tax === 'snipp_cat'):\n            echo '<option value=\"\" disabled>Snippet Categories</option>';\n            foreach ($term_query->terms as $term):\n                if ($term->taxonomy == 'snipp_cat'):\n                    echo '<option value=\"' . $term->term_id . '\">' . $term->name . '</option>';\n                endif;\n            endforeach;\n        endif;\n        if ($term_tax === 'blog_cat'):\n            echo '<option value=\"\" disabled>Blog Categories</option>';\n            foreach ($term_query->terms as $term):\n                if ($term->taxonomy == 'blog_cat'):\n                    echo '<option value=\"' . $term->term_id . '\">' . $term->name . '</option>';\n                endif;\n            endforeach;\n        endif;\n    endforeach;\n    echo '</select>';\n}\n?>\n<div class=\"form-check form-check-inline\">\n    <input class=\"form-check-input\" type=\"radio\" id=\"asc\" name=\"date\" value=\"asc\" />\n    <label class=\"form-check-label\" for=\"asc\">Date: Ascending</label>\n</div>\n<div class=\"form-check form-check-inline\">\n    <input class=\"form-check-input\" type=\"radio\" id=\"desc\" name=\"date\" value=\"desc\" selected=\"selected\" required />\n    <label class=\"form-check-label\" for=\"dsc\">Date: Descending</label>\n</div>\n<button class=\"btn btn-primary btn-filter btn-lg\">Apply filter</button>\n    <input type=\"hidden\" name=\"action\" value=\"myfilter\">\n</form>\n</div>\n\n\n        <div class=\"scroll-content col-sm-12 col-md-10\">\n        \n<?php\nglobal $wp_post_types, $wp_query;\n$wp_post_types['page']->exclude_from_search = true;\nif (have_posts()):\n    while (have_posts()):\n        the_post();\n        get_template_part('template-parts/content', 'archive');\n    endwhile;\n    get_template_part('template-parts/pagination', 'notabs');\nelse:\n    get_template_part('template-parts/content', 'none');\nendif;\n?>\n        \n        </div><!-- .scroll-content -->\n<div id=\"ajax_container\" class=\"col-sm-12 col-md-10\"></div>\n</section> <!-- row -->\n\nFUNCTIONS.PHP\nAJAX Callback Function - Protocol\nSince HTTP and HTTPS are flexible for my domain,  I had to specify the protocol for the ajax URL. Of course, HTTPS will only be used in production so this can be removed if HTTPS is forced.\nAJAX Callback Function - Query Loop\nAs stated, since I decided to modify the main query for the search - I used query_posts() and wp_reset_query() after pagination.\nadd_action('wp_ajax_myfilter', 'search_filter_function'); \nadd_action('wp_ajax_nopriv_myfilter', 'search_filter_function');\n\nfunction search_filter_function(){\n    global $wp_post_types, $wp_query;\n    $wp_post_types['page']->exclude_from_search = true; \n    $paged = ( get_query_var( 'paged' ) ) ? get_query_var( 'paged' ) : 1;\n    $protocol = isset( $_SERVER['HTTPS'] ) ? 'https://' : 'http://';\n    $args = array(\n        'ajaxurl' => admin_url( 'admin-ajax.php', $protocol ),\n        'query'   => $wp_query->query,\n        's' => $_POST['s'],\n        'post_type' => $_POST['post_type'],\n        'post_status' => 'publish',\n        'posts_per_page' => 6,\n        'orderby' => 'date',  \n        'order' => $_POST['date'], // ASC or DESC\n        'paged' => $paged\n    );\n    \n    \n    // for taxonomies \n    if( isset( $_POST['categoryfilter'] ) ) {\n        $args['tax_query'] = array(\n            'relation' => 'OR',\n            array(\n                'taxonomy' => 'font_cat',\n                'field'    => 'id',\n                'terms'    =>  $_POST['categoryfilter'],\n            ),\n            array(\n                'taxonomy' => 'snipp_cat',\n                'field'    => 'id',\n                'terms'    =>  $_POST['categoryfilter'],\n            ),\n            array(\n                'taxonomy' => 'blog_cat',\n                'field'    => 'id',\n                'terms'    => $_POST['categoryfilter'],\n            ),\n        );\n    }\n\n    query_posts( $args );\n\n    if ( have_posts() ) : while ( have_posts() ) : the_post();\n\n            get_template_part( 'template-parts/content', 'search' );\n\n        endwhile; \n\n            get_template_part( 'template-parts/pagination', 'notabs' );\n            wp_reset_query();\n\n        else :\n\n            get_template_part( 'template-parts/content', 'none' ); \n            \n        endif;\n\n    \n    die();\n}\n\nFUNCTIONS.PHP (Continued)\nNext Link for Pagination\nI needed to add a class to the next paging link so I added a filter to the next_post_link() function for the non-ajax InfiniteScroll instance.\nFYI: This is important for the non-ajax InfiniteScroll instance path option since I do not want a hard-coded URL.\nadd_filter('next_posts_link_attributes', 'next_link_class_attribute');\nfunction next_link_class_attribute() {\n  return 'class=\"next-post-link\"';\n}\n\nIn order to avoid an empty search field, I added this function to send the user to the 404 page if no search term is entered.\n//if search is empty to display 404\nadd_action( 'pre_get_posts', function ( $q )\n{\n    if($q->is_search() // Only target the search page\n    ) {\n        // Get the search terms\n        $search_terms = $q->get( 's' );\n\n        // Set a 404 if s is empty\n        if ( !$search_terms ) {\n            add_action( 'wp', function () use ( $q )\n            {\n                $q->set_404();\n                status_header(404);\n                nocache_headers();\n            });\n        }\n    }\n});\n\nI also set 404 if there are only one or more invalid query vars. I do not recommend this function if you have not registered custom query vars.\nhttps://gist.github.com/carlodaniele/1ca4110fa06902123349a0651d454057\n//set 404 only if one or more invalid query vars (invalid taxonomy names but not only) are in the query\nadd_action( 'template_redirect', 'my_page_template_redirect' );\nfunction my_page_template_redirect() {\n  global $wp_query, $wp;\n  // this get an array of the query vars in the url\n  parse_str( parse_url ( add_query_arg( array() ), PHP_URL_QUERY ), $qv);\n  if ( ! empty( $qv ) ) { // if there are some query vars in the url\n    $queried = array_keys( $qv ); // get the query vars name\n    $valid = $wp->public_query_vars; // this are the valid query vars accepted by WP\n    // intersect array to retrieve the queried vars tha are included in the valid vars\n    $good = array_intersect($valid, $queried); \n    // if there are no good query vars or if there are at least one not valid var\n    if ( empty($good) || count($good) !== count($queried)  ) {\n     $wp_query->set_404();\n     status_header(404);\n     nocache_headers();\n    }\n  }\n}\n\nUPGRADE InfiniteScroll to v4\nI did upgrade to InfiniteScroll v4 because loadNextPage returns a Promise, so basically I can use then() in case I want to do something after each load of posts. Also, because of its backward compatibility with v3.\nCUSTOM-SEARCH.JS\nAJAX Filter - Submit without Reload\nI had to bind the filter button to a click event so we can apply filters without having to reload the entire page.\nAJAX Filter - InfiniteScroll and Isotope Sessions\nOnce a user clicks submit on the filter, I use the InfiniteScroll and Isotope destroy method on both containers ($scroll_container and $ajax_container) in case isotope or infinite scroll already exists (destroy session on success to first create new).\nFYI: .data('inifiniteScroll') and InfiniteScroll.data( element ) does not work in v3 and v4 so I cannot check if InifinteScroll is initialized before using destroy method so error will show in console.\nI then empty the AJAX container (#ajax_container.empty()) as well to make sure new results are displayed every time the user filters with the ajax filter form.\nAJAX Filter - Isotope\nI was able to get Isotope to work on the results by turning the response (data) to a jQuery object before inserting the data with Isotope.\nlet $data = $(data); // store data in jQuery object\n$ajax_container.append($data);\n$ajax_container.isotope('insert', $data ); \n\nAJAX Filter - InfiniteScroll\nI did find a solution to fix InfiniteScroll by setting the path correctly - found through console logging the data to get the query strings for pagination (console.log(filter.serialize())). \nAs stated prior, now only the AJAX InfiniteScroll instance uses a hard-coded path option. I tried creating the path with just public query vars but had issues with paged results after setting pretty links (customizing the slug - rewrites) for post types and taxonomies.\nThis was done with the CPT UI plugin:\nhttp://domain.com/wp-admin/admin.php?page=cptui_manage_taxonomies&action=edit\nI set 'Rewrite' to 'true', added 'Custom Rewrite Slug' text, and set 'Rewrite With Front' to 'true'.\nAs stated prior, I still would have to manually build the path URL for the AJAX InfiniteScroll instance.\nThe good news is paging is possible with rewrites based on my setup.\nhttp://domain.com/[taxonomy rewrite slug]/[taxonomy term]/page/{{#}}/?s=[search term]&orderby=date&order=[asc or desc]\nAs you can see the path option for the AJAX InfiniteScroll Instance is now set properly.\njQuery(window).on('load', function () {\n\n    let $scroll_container = jQuery('.scroll-content');\n     \n    $scroll_container.isotope({\n        layoutMode: 'fitRows',\n        itemSelector: '.scroll-post'\n    }); //isotope\n\n    let currentLocation = window.location.href;\n    const ptParams = new Proxy(new URLSearchParams(window.location.search), {get: (searchParams, prop) => searchParams.get(prop),});\n\n    let post_type_value = ptParams.post_type;\n    let iso = $scroll_container.data('isotope');\n    \n    if(iso) {\n    $scroll_container.infiniteScroll({\n        //path: 'page/{{#}}/?s=' + searchParam.search_term + '&post_type=' + post_type_value,\n        path: '.next-post-link',\n        append: '.scroll-post',\n        button: '.btn-scroll',\n        outlayer: iso,\n        loadOnScroll: false,\n        scrollThreshold: 300,\n        status: '.page-load-status',        \n        hideNav: '.pagination'\n    }); //infinite scroll\n    \n    jQuery('.btn-scroll').on('click', function () {                             \n        $scroll_container.on('load.infiniteScroll', function (event) {\n            $scroll_container.isotope('layout');\n            jQuery('.page-load-status').detach().appendTo(jQuery('.scroll-content'));\n        }); //on load function  \n    }); //on click function \n} //iso check\n    \n    /*\n     * Filter\n     */\n    let $ajax_container = jQuery('#ajax_container'); \n    let s_term = jQuery('.search-field').val();\n    let s_cat_text = jQuery(\".form-select :selected\").text(); //not needed for query string\n    let s_cat_val = jQuery(\".form-select :selected\").val(); \n    let s_order = jQuery(\"input[type='radio'][name='date']:checked\").val();\n    let s_post_type = jQuery(\"input[type='hidden'][name='post_type']\").val();\n    \n    \n     //ajax call\n    jQuery('#filter').submit(function(e) { \n        //jQuery('.btn-filter').on('click', function () {\n        e.preventDefault();\n        let filter = jQuery('#filter');\n        jQuery.ajax({\n            url: filter.attr('action'),\n            data: filter.serialize(), // form data\n            type : filter.attr('method'),\n            beforeSend : function(xhr) {\n                filter.find('.btn-filter').text('Filtering...');\n                console.log(filter.serialize());\n            },\n            success : function( data ) {\n                filter.find('.btn-filter').text('Apply filter');\n                \n                let iso = $scroll_container.data('isotope');\n                let inf = $scroll_container.data('infniteScroll');\n                \n                //remove initial results infinite scroll and isotope for ajax call\n                if(inf) {\n                    $scroll_container.infiniteScroll('destroy');\n                }\n                \n                if(iso) {\n                    $scroll_container.isotope('destroy');\n                }\n                \n                $scroll_container.remove(); //completely remove initial results\n\n\n                let iso_ajax = $ajax_container.data('isotope');\n                //let inf_ajax = $ajax_container.data('infniteScroll'); //does not work, reported to developer\n                //InfiniteScroll.data( element ); Infinite Scroll instance via its element does not work either\n                \n                //if ajax infinite scroll and isotope exist already remove so reset     \n                    $ajax_container.infiniteScroll('destroy');  \n\n                if(iso_ajax) {\n                    $ajax_container.isotope('destroy');\n                    $ajax_container.empty();\n                }\n            \n                //create \"new\" isotope instance\n                $ajax_container.isotope({\n                    layoutMode: 'fitRows',\n                    itemSelector: '.scroll-post'\n                }); //isotope\n\n                let $data = $(data); // store data in jQuery object\n                $ajax_container.append($data);\n                $ajax_container.isotope('insert', $data );  \n\n                let isoajax = $ajax_container.data('isotope');          \n                \n                //create \"new\" infinite scroll instance\n                $ajax_container.infiniteScroll({\n                    path: '/page/{{#}}/?s=' + s_term + '&post_type=' + s_post_type + '&categoryfilter=' + s_cat_val + '&date=' + s_order,\n                    append: '.scroll-post',\n                    button: '.btn-scroll',\n                    outlayer: isoajax, \n                    loadOnScroll: false,\n                    scrollThreshold: 300,\n                    checkLastPage: true,\n                    history: false,\n                    status: '.page-load-status',\n                    hideNav: '.pagination',\n                    debug: true\n                }); //infinitescroll \n\n                    jQuery('.btn-scroll').on('click', function () {\n                            console.log('click ajax inside');\n                        $ajax_container.on('load.infiniteScroll', function (event) {\n                            console.log('infinite ajax inside');\n                        $ajax_container.isotope('layout');\n                            jQuery('.page-load-status').detach().appendTo(jQuery('#ajax_container'));\n                        }); //on load function\n                    }); // on click function \n                // reset filter \n                //filter[0].reset();             \n            } // success\n        }); //ajax call\n        //return false; //e.preventDefault is used\n    }); //submit function\n    \n    //Bind click event listener to the submit button\n    jQuery(document).on('click', 'button[type=\"submit\"]', function() {\n      jQuery(this).parents('form').submit();\n    }); \n}); // window on load\n\nPlease excuse my indentation, thats it!\nIf you can optimize this code to make it better or come up with a it will be greatly appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402963", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Create Woocommerce product without creating api credentials I am creating a plugin to interact with WooCommerce.\nCurrently, if I want to create a product I need to generate API credentials in the WooCommerce settings and add those credentials into a form in the menu page created by my plugin which is then, in turn, saving them as wp_options and then accessing them when I connect to the WooCommerce rest API.\nThese seem like too many steps to follow for anyone else who is using the plugin and might not be too familiar with WordPress.\nIs there a way to programmatically generate these credentials or even interact with WooCommerce without these credentials altogether?\nThis plugin will only run on WordPress and any data in it will remain on the domain it is installed. There will be no external API calls only to the WooCommerce installed on the same WordPress my plugin is installed on.\nI managed to create the keys automatically with the WooCommerce auth endpoint but I can't get the keys from the callback url.\n\nA: Here is my solution.\nYou can directly interact with WooCommerce if you include the main woocommerce file from woocommerce/woocommerce.php\nThe classes I specifically used were WC_Product and WC_Product_Query\nWith these classes, you can get existing products and create new ones. I included links to the docs for these two classes\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402965", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add ACF field in a query I am trying to set category_name of a query using an ACF text field but I am getting all posts instead the post of the category I want.\n          $category1 = the_field('category1');\n          $args1=array(\n            'posts_per_page' => 3,\n            'post_type'      => 'post',\n            'post_status'   => 'publish',\n            'category_name' => $category1,\n            );\n\nDoes anybody have any solution on that?\nThanks\n\nA: the_field is used to output, get_field is used to return.\nSo instead of\n$category1 = the_field('category1');\n\nIt should be\n$category1 = get_field('category1');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402967", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom image uploader without widgets I'm developing a site that is using Wordpress for database interactions, but I'm not really using features like pages or posts or widgets.\nI'm trying to create an input form that allows the user to upload an image without having to go to the media library.\nThe image files do go to the uploads folder, but for some reason their size is 0kb and they don't work. I can't open them in a image viewer program and they don't show up in the media library.\nHere is my attempt:\nAjax part:\nasync function sendImageToWordpress(thePath) {\n\n\n    let responseForPostToDatabase = '';\n\n    /* Ajax call here */\n\n    let myAjax = await jQuery.ajax({\n\n        type: \"POST\",\n        url: adminAjaxURL, /* this adminAjaxURL variable has been defined in header.php */\n        data: ({\n\n            action: \"add_attachment\",\n            thePath: thePath,\n\n\n        }),\n\n        success: function(response){\n\n            responseForPostToDatabase = response;\n\n            return('success');\n\n        },\n\n        error: function(){\n\n            return('ajax error!!!!');\n\n        }\n\n    })\n\n    return(responseForPostToDatabase);\n\n    /* Return statement here */\n\n}\n\nHere is the relevant parts from functions.php:\n//SEND IMAGE INTO WORDPRESS\n\nfunction new_attachment(){\n\n    $image_url = ($_POST[\"thePath\"]);\n\n    $upload_dir = wp_upload_dir();\n\n    $image_data = file_get_contents( $image_url );\n\n    $filename = basename( $image_url );\n\n    if ( wp_mkdir_p( $upload_dir['path'] ) ) {\n    $file = $upload_dir['path'] . '/' . $filename;\n    }\n    else {\n    $file = $upload_dir['basedir'] . '/' . $filename;\n    }\n\n    file_put_contents( $file, $image_data );\n\n    $wp_filetype = wp_check_filetype( $filename, null );\n\n    echo $image_url;\n\n    exit();\n}\n\nadd_action('wp_ajax_add_attachment','new_attachment'); //add an image file\n\nCan you point me in the right direction?\n\nA: Ended up doing it like this:\nIn functions.php:\n//SEND IMAGE INTO WORDPRESS\n\nfunction new_attachment(){\n\n//echo 'talking to new_attachement in functions.php';\n\nif(\n\n! wp_verify_nonce( $_POST['client-file-upload'], 'add_attachement' ) //adding a layer of security by verifying a nonce that was set in the addrecipe.php form field\n){\n\n    wp_nonce_ays( '' ); //Display \u201cAre You Sure\u201d message to confirm the action being taken. A = are Y = You S = Sure. Don't know if needed here.\n}\n\nrequire_once(ABSPATH . 'wp-admin/includes/admin.php');\n$myfiles = $_POST[\"async-upload\"];\n$id = media_handle_upload('async-upload', 0); //post id of Client Files page\n$attachment_url = wp_get_attachment_url($id);\nunset($myfiles);\n\n\nif ( is_wp_error($id) ) {\n    $errors['upload_error'] = $id;\n    $id = false;\n}\n\nif ($errors) {\n    echo \"<p>There was an error uploading your file.</p>\";\n} else {\n    echo  $attachment_url;\n}\n\nexit();\n\n\n\n\n}\nadd_action('wp_ajax_add_attachement','new_attachment'); //add an image file \n\nJavascript:\n    jQuery('#file-form').submit(\n    function (e) {\n        e.preventDefault();\n        let mydata = new FormData(this);\n        mydata.append('action', 'add_attachement');\n        jQuery.ajax({\n            url: adminAjaxURL,\n            type: 'POST',\n            data: mydata,\n            processData: false,\n            contentType: false,\n            success: function (result) {\n                console.log(result);\n                jQuery('#imageURLs').val(result);\n                //$(\"#div1\").html(str);\n            }\n        })\n    });\n\nPHP and HTML:\n<form id=\"file-form\" enctype=\"multipart/form-data\">\n    <p id=\"async-upload-wrap\">\n    <label for=\"async-upload\">Lataa kuva</label>\n    <input type=\"file\" id=\"async-upload\" name=\"async-upload\"> <input type=\"submit\" value=\"Lataa\" name=\"html-upload\">\n    </p>\n\n    <p>\n    <input type=\"hidden\" name=\"post_id\" id=\"post_id\" value=\"<?php echo '0';?>\" />\n    <?php wp_nonce_field('add_attachement', 'client-file-upload'); ?>\n    </p>\n\n    <p>\n    <input type=\"submit\" value=\"Save all changes\" name=\"save\" style=\"display: none;\">\n    </p>\n    </form>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402971", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I use wp_nav_menu? I try to add dynamically a menu which structure of css ul/li link look like that\n            <ul class=\"navbar-nav ml-auto\">\n              <li class=\"nav-item\">\n                  <a class=\"nav-link tm-nav-link\" href=\"#infinite\">Home</a>\n              </li>\n              <li class=\"nav-item\">\n                  <a class=\"nav-link tm-nav-link\" href=\"#whatwedo\">What We Do</a>\n              </li>\n              <li class=\"nav-item\">\n                <a class=\"nav-link tm-nav-link\" href=\"#testimonials\">Testimonials</a>\n              </li>\n              <li class=\"nav-item\">\n                  <a class=\"nav-link tm-nav-link\" href=\"#gallery\">Gallery</a>\n              </li>\n              <li class=\"nav-item\">\n                  <a class=\"nav-link tm-nav-link\" href=\"#contact\">Contact</a>\n              </li>                    \n            </ul>\n          </div>        \n        </div>\n      </nav> \n\nI try it to register\n  <?php\n              wp_nav_menu(array(\n              \"theme_location\" => \"\",\n                  'menu_class'=> 'navbar-nav ml-auto'\n              'container_class' => 'navbar navbar-expand-md tm-navbar')); ?>     \n\nbut know only how to add class to <ul> but not to all <li> it make huge problem because my nav menu looks ugly.\n\nA: An alternative approach: use inherited CSS classes.\n.navbar-nav.ml-auto > li {\n   background: yellow;\n}\n\n.navbar-nav.ml-auto > li > a {\n   color: blue;\n}\n\nThat way, you only need to set the class on the <ul>.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402974", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: String translation for esc_html__() when registering string I am trying to translate the string 'Home' in wordpress that is registered as an esc_html__().\nThis is the code registering the themes functions.php:\nif(!function_exists('gem_breadcrumbs')) {\nfunction gem_breadcrumbs($new = false)\n{\n    $text['home'] = esc_html__('Home', 'thegem'); }}\n/* there many more strings in the function but I only need to  translate 'Home'\n\nTo register the string I am using polylang (but it could be anything not specific to polylang) and the documentation refers to registering a simple string _e() using the following:\npll_register_string('breadcrumb', 'Home', 'thegem','true');\n\nThe string translation appears in the polyang plugin, but does not get translated on the front end.\nI believe it has to do with the esc_html__() in the theme functions.php, I also tried this:\npll_register_string('breadcrumbs', esc_html__('Home'), 'thegem', 'true');\n\nBut it did not work either. Any help would be appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402975", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Pre insert data when adding new custom post fire a json error here is what i have tried\nfunction mec_locations_cpt_add_content ( $data, $postarr) {        //, $postarr\n    if ( 'mec_locations_cpt' !== $postarr['post_type'] ) {\n         return $data;\n    }\n    if ( 'publish' !== $postarr['post_status'] ) {\n         return $data;\n    }\n    $post = get_post( $postarr['ID'] );\n    //$mec_location_shortcode='[mec-location id=\u201d{LOCATION_ID}\u201d limit_events=\u201d{NUMBER}\u201d]';        //to get from an admin field\n    //$mec_location_shortcode ='<!-- wp:shortcode -->[mec-location id=128]<!-- /wp:shortcode -->';\n    $data['post_content'] .= '<!-- wp:shortcode -->[mec-location id=128]<!-- /wp:shortcode -->';\n    $data['post_content'] .= '<!-- wp:paragraph -->#####################################################'.'post='.print_r($post,true).'<!-- /wp:paragraph -->';\n    $data['post_content'] .= '<!-- wp:paragraph -->@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'.'data='.print_r($data,true).'<!-- /wp:paragraph -->';\n    $data['post_content'] .= '<!-- wp:paragraph -->&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&'.'postarr='.print_r($postarr,true).'<!-- /wp:paragraph -->';\n    //$data['post_title']   .= 'some text';\n    //$data['post_excerpt']  = 'This is my excerpt inserted for new post';\n    // If value is not in content, append it onto the end\n    //if ( stristr( $data['post_content'], $content_shortcode ) === FALSE ) $data['post_content'] .= 'add this'.$meta_value .($meta_value);\n    //$postarr['post_title'] .='add some text';\n    //$postarr['post_content'] .='ok ! added ' . $mec_location_shortcode;\n    //$postarr['post_excerpt']  ='My new updated excerpt';\n    return $data;\n}\nadd_filter('wp_insert_post_data', 'mec_locations_cpt_add_content' ,100 ,2);\n\nbut asap i try to add a new post, i have an error message\nLa sauvegarde de cet article dans votre navigateur est diff\u00e9rente de la version ci-dessous.\nmeaning ~ : the post is diferent than the one in browser\nwhen i edit title and content and try to publish the post it give a json error\nLa publication a \u00e9chou\u00e9. La r\u00e9ponse n\u2019est pas une r\u00e9ponse JSON valide.\nI have tried to change permalink setting with no success\ni get the same error without adding any content\nbut the strange is if i cancel publish the post is saved in db and the array are included twice...\nif i edit again the post, it fires again a json error but the post content is updated again\nDoes it mean that wp_insert_post_data is fired before insert and again at the save_post ????\ni know that making it this way will add content each time. i planed to add some check content before adding it but for now i try to remove only the error message\n\nA: You should use content_save_pre filter. And maybe try some \"simple\" content first.\nwp_insert_post_data is fired in a lot of situations :-) Even at deleting.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402977", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to remove a specific script from bulk wordpress posts and images description? My site got hacked and I found  on the end of each post and image description. Is there any way to remove it?\nThank you\nGusti\n\nA: For sure not only your Posts include Code. There will be also hacked php files. Cleaning the posts wont help until the secuity hole is fixed.\nAfter closing the secuity hole you could use Better Search an Replace for Replacing the Code.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402978", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: Display all Categories except ones with a specific parent I'm trying to display all post-categories except those who have an specific parent-categorie.\nCan someone help me?\nThis is my current code:\n<?php\n$categories = get_categories( array(\n    'orderby' => 'name',\n    'order'   => 'ASC',\n    'hide_empty'  => 0,\n) );\n\necho '<ul>';\n\nforeach( $categories as $category ) {\n    echo '<li><a href=\"' . get_category_link($category->term_id) . '\">' . $category->name . '</a></li>';   \n} \n\necho '</ul>';\n\n?>\n\n\nA: get_categories() gives you an array of WP_Term objects, which has the parent property. This contains the ID of the parent category. Inside your loop you can do a simple comparison to see, if the current iteration category has the specific parent category's ID or not, and if it does, skip it.\n$parent_id = 123; // change to actual term id\nforeach( $categories as $category ) {\n  if ( $parent_id === $category->parent ) {\n    continue;\n  }\n  \n  // rest of the code...   \n} \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402979", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Set Taxonomy based on post status I am setting a taxonomy based on the post_status. It works as needed except I want to allow the taxonomy to be overridden if a particular taxonomy is selected.\nHere is the code\nfunction add_categories_automatically($postID) {\n    if(get_post_status($postID) == 'draft'){\n        $catsID = array(1); //active\n        wp_set_post_categories($postID, $catsID);\n    }\n    if(get_post_status($postID) == 'publish'){\n        $catsID = array(5); //complete\n        wp_set_post_categories($postID, $catsID);\n    }\n    if(get_post_status($postID) == 'publish' && has_category( 'billed' ) ){\n        $catsID = array(16); //billed\n        wp_set_post_categories($postID, $catsID);\n    }\n}\nadd_action('save_post', 'add_categories_automatically');\n\nOn the last if statement I have tried to use && to set a new category if the post is published AND the category billed is selected. It just keeps being set as id 5 from the previous if statement.\nAny ideas on how I can make the last if statement work?\n\nA: This is what works with the help of WebElaine above. I had to pass the postID to has_category() and then set variables.\nfunction add_categories_automatically($postID) {\n    $p_published = get_post_status($postID) == 'publish';\n    $p_draft = get_post_status($postID) == 'draft';\n    $p_cat = has_category( 'billed', $postID);  \n    \n    if ($p_draft == 'draft'){\n        $catsID = array(1); //active\n        wp_set_post_categories($postID, $catsID);\n    }\n    if ($p_published == 'publish'){\n        $catsID = array(5); //complete\n        wp_set_post_categories($postID, $catsID);\n    }\n    if($p_published == 'publish' && $p_cat ){\n        $catsID = array(16); //billed\n        wp_set_post_categories($postID, $catsID);\n    }\n}\nadd_action('save_post', 'add_categories_automatically');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402982", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display Author name PHP (Selfmade Plug-IN) I have a problem for which I need help, because I just can not find a solution myself.\nI have taken over a site where a selfmade plugin was created by someone before..\nUsing the default plug-in \u201eContact Form 7\u201c, people can create posts on the page. ( https://gyazo.com/c8b20adecacd90fb9bfe72ad2138a980 )\nAbout the self-created plug-in \u201eContact Form 7 extender\u201c, the post is generated in the background via a PHP code. (https://gyazo.com/115a6c7c9afafd2970b66fd421ca76a3)\nThis is how it should work:\nIf a user is not logged in, the author becomes \u201eHyperspace_Bot\u201c.\nIf a user is logged in, the Author name of the user is displayed.\nNow the problem:\nWhen a user who is logged in creates a post via the contact form, no Author is displayed\u2026.\n(https://gyazo.com/b51653a1c5fc08b875a50b926c7565d3)\n(https://gyazo.com/54e4067ecf1227831898a79e1577affa)\nAs you can see on the screenshots again, there is no author entered. Currently I always have to enter them manually afterwards.\nHere is the important part of the code of the plug-in:\nadd_action('wpcf7_before_send_mail', 'createPostData' );\n\nfunction createPostData() {\n     //get user id\n     //$user = get_userdatabylogin('myusername');\n     //$user = get_user_by('login', $user_login);\n     //$udi = $user->ID;\n\n     get_currentuserinfo();\n\n     if ($_POST['aut'] == '') {\n             // Create post object\n             $my_post = array(\n                     'post_title' => $_POST['title'],\n                     'post_content' => $_POST['Description'],\n                     'post_status' => 'pending',\n                     'post_author' => 3,\n                     'post_category' => array($_POST['postcategory'])\n             );\n     } else {\n             $my_post = array(\n                     'post_title' => $_POST['title'],\n                     'post_content' => $_POST['Description'],\n                     'post_status' => 'publish',\n                     //'post_author' => $user,\n                     'post_author' => $user_ID,\n                     'post_category' => array($_POST['postcategory'])\n             );\n     }\n\nThe problem is with \u201apost_author\u2018 => $User_ID in the second part I think\u2026. I\u2019ve already tried different ways with get_current_user_id() or $author_id = get_the_author_meta( \u201aID\u2018 ), but can\u2019t find a solution.\nIf someone has an idea, I would be very grateful!\nThanks a lot in advance.\nBest regards\nFabian\nWhole plugin:\nhttps://pastebin.com/8RFRPRLw\n\nA: Your $my_post array contains 'post_author' => $user_ID, but $user_ID isn't defined.\nAccording to WP codex, get_currentuserinfo is deprecated, and should be replaced with wp_get_current_user. But in this case you want the ID, so a better option would be get_current_user_id\nSo if you replace this line:\nget_currentuserinfo();\n\nWith:\n$user_ID = get_current_user_id();\n\nYou should be in business.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402983", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why my theme's css not working on another site I work on my on theme based on Neve theme. First I had problem with scripts, because not working but i had to change their location from footer.php to header.php to everything was good.\nNew some scripts not work because of the fact that css is not loading at all.\nI tried 5 different approach but all fail.\n\n*\n\n*In header.php I just give them like <style> </style>\n\n*I used register style in functions.php, header.php and footer.php\n\n    function my_theme_enqueue_styles() {\n \n \n    wp_enqueue_style( $parent_style, get_template_directory_uri() . '/css/tooplate-infinite-loop.css' );\n   \n}\nadd_action( 'wp_enqueue_scripts', 'my_theme_enqueue_styles' );\n\n\n\n*I try using them by put them on header.php\n\n    <link rel=\"stylesheet\" href=\"<?php echo get_template_directory_uri(); ?>/css/tooplate-infinite-loop.css\" />\n\n\n4 and 5) are very similar I used costume style in element or, theme builder etc.\n\nA: This sounds strange if you have tried all these methods correctly and properly.\nI think you have to check these points:\n\n*\n\n*Purge cache in the whole website if you use a plugin for that\n\n*Check your css file name if is written correctly, and is the correct path\n\nTo solve this problem definitely and quickly, i recommend you to use a child theme generator plugin, to achieve this task. One of the best option is a plugin called Child Theme Configurator which you can find at Child Theme Configurator\nHope this help you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402984", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I check if a visitor can read a post? I know how to check capabilities for logged in users, with\n$can_read = current_user_can('read',$post->ID);\n\nBut the above code returnes false when the user is not logged.\nSo how can I check if the visitor has access to it?\nThanks!\n\nA: Vistors usually always have the rights to access a post. Only exceptions that I know are drafts, password protected posts or post_types that are not public accessable.\nYou could use get_post_status() and post_password_required()\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402985", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hide Author By-Line if After Certain Date I'm trying to use functions.php to hide the by-line on posts after a certain date. I'm using the following code but it isn't working. I think it's due to not properly grabbing the post date. How do I get the post date in functions.php?\n// Hide By-Line\n\nadd_action('wp_head','my_head_css');\nfunction my_head_css(){\n\n$excludeDate = date(\"2021-06-02\");\n$postDate = get_the_date('Y-m-d');\n\nif($postDate > $excludeDate){\n\n    echo \"<style> .entry-author {display:none !important;} </style>\";\n    \n    }\n}\n\n\nA: It's probably getting the date as you expect, but the > is essentially a mathematical operator and you're trying to use it to compare two strings.\nYou can use strtotime() to convert the dates to integers (# of seconds elapsed since 1970-01-01), and compare those.\n// Hide By-Line\n\nadd_action('wp_head','my_head_css');\nfunction my_head_css(){\n\n$excludeDate = date(\"2021-06-02\");\n$postDate = get_the_date('Y-m-d');\n\nif( strtotime( $postDate ) > strtotime( $excludeDate ) ){\n\n    echo \"<style> .entry-author {display:none !important;} </style>\";\n    \n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402992", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I have a wordpress website which uses a really weird font on Opera. What do I need to do to fix it? I have a website which gets this font:\n\nwhen shown in Opera. Other websites work just fine and that very website works just fine in Firefox and Chrome.\nIs there something improperly setup in my Wordpress website?\nNotes:\n\n*\n\n*I'm using the default Twenty Twenty-One theme with small tweaks, but not in link with the fonts at first;\n\n*Now I force \"sans-serif\", but I still see the issue with Opera...\n\n\nA: Now there is a weird one...\nI killed and then restarted Opera and things are fixed. It works as expected. No funky font. This is not the answer I expected, though.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402994", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: After updating to 5.9, when the posts page is loaded in the browser it uses wp-includes/template-canvas.php? My WordPress site uses the following:\n\n*\n\n*Header.php file from the theme.\n\n*Footer.php file from the theme.\n\n*Apart from the Posts Page, the rest of the site makes use of Gutenberg blocks (not header or footer area).\n\n*The posts page uses the site's index.php file at wp-content/themes/meow/index.php\n\nWhen I updated the site to 5.9, the posts page no longer looked the same. I checked what file loads when the posts page is viewed in the browser:\n\n*\n\n*Before the update to 5.9, the site loads: wp-content/themes/meow/index.php.\n\n*After the update, the site loads: wp-includes/template-canvas.php\n\nI thought WordPress was supposed to be future-proof. How can I make use of index.php, instead of template-canvas.php, when the site is updated to 5.9?\n\nA: this happens because wp_enable_block_templates() is enabled.\nTry to navigate to wp-includes/theme-templates.php and comment that function, its placed at the end of the file.\nLet me know if it worked, good luck!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402995", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Looking for most performant way to execute several similar WP queries within shortcodes I have a very data-driven website where each page contains several (5-10) shortcodes, each of which execute WP queries and display the results.\nThe queries are usually quite similar - I've added 3 examples of a var_dump of the WP query $args to this codeshare: https://codeshare.io/3AvRgv\nI'm looking for a way to improve performance, and wonder if there's a better way of doing this than having a new WP_query every time.\nFor example could I set some query parameters in a custom field, run the query when the page loads, save the array of post_ids to a variable, and then modify them to suit? Would that help?\nAny ideas welcome!\n\nA: I think, it would be hard to achieve this, on the PHP-side as there is not much to gain in how you execute the WP_Query, because it will still result in the same WP_Queries executing the same logic under the hood.\nThere is however \"easy\" performance to gain by either; not using WP_Query and for instance writing a more specific SQL query by using (e.g.) $wpdb (which in my experience still doesn't do a whole lot, depending of course on how many meta_queries are adding JOINS and using extra tables etc.), but the biggest gain would be to execute the query's themselves less, by e.g. caching their results.\nBut this is only a good idea depending on how quickly your data changes.\nSince days of php7 versions and especially now with php8, the execution of php itself wouldn't be the bottleneck as much as in the past.\nAlthough, WordPress in itself is not built on \"modern\" ideas or php, the biggest performance is lost in it's simple, but not very performance-friendly database structure.\nFinally if you can't cache your data, or use $wpdb, the key would be in making your queries as simple as the wanted response allows them to be, and try to avoid meta_queries as much as possible.\nOh, and also, avoid ordering your posts by random.\nI will add a little snippet below, I once wrote to explain why not, to some colleagues, it could be useful:\nFurther, if you really can only try and speed up the php code itself, try to use as many type-hinting, and strict type comparisons (=== instead of ==) as you can in your functions, this is often overlooked, because it is generally not promoted in the WordPress docs (because they want to be backwards-compatible as far as possible), but this makes the compiler have to do less work.\nAnother thing you could try is be as direct as possible. What I mean by this, is WordPress gives you a lot of wrapper functions which just wrap around other code, which might be harder to understand, or performing extra checks. If you look at the get_posts() function it checks a lot of conditions, which eventually lead to the creation of a new WP_Query instance, where if you would create that yourself you could skip a bunch of checks (If you are using wp functions, try to take a look at what they do, and if you can replicate that in a simpler manner).\nBut once again, I don't think the performance gains, in writing faster code would be consistent and substantial enough.\nIf you want to make a function to \"generate\" your similar WP_Queries faster, do consider that your code for creating the WP_Query is probably for php 10% of the work opposed to the 90% of work that is triggered by the WP_Query class itself, so I think the key would be in caching and re-using retrieved data where you can and also to keep your queries as simple as possible.\nThe snippet (do note that these results where not really consistent or substantial):\n   /**\n     * Get a random post ID from wpdb or, when passed, a random ID of a post which meets the requirements.\n     *\n     */\n    function sb_get_random_post_id(string $post_type = null, string $post_status = 'publish'): int\n    {\n        global $wpdb;\n    \n        $query           = \"SELECT ID FROM {$wpdb->prefix}posts WHERE post_status = '%s' \";\n        $query_arguments = [$post_status];\n    \n        if ($post_type) {\n            $query             .= \"AND post_type = '%s' \";\n            $query_arguments[] = $post_type;\n        }\n    \n        $prepared_statement = $wpdb->prepare($query, ...$query_arguments);\n        $postID             = $wpdb->get_var($prepared_statement);\n    \n        return (int) $postID;\n    }\n    \n    /**\n     * Get a random post or, a random post within the defined parameters.\n     */\n    function sb_get_random_post(string $post_type = null, string $post_status = 'publish'): ?\\WP_Post\n    {\n        $random_id = sb_get_random_post_id($post_type, $post_status);\n    \n        return \\get_post($random_id);\n    }\n    \n    /**\n     * Random post\n     */\n    $random_post = sb_get_random_post();\n    \n    /**\n     * Random Woocommerce Order, shop_order uses defferent statusses so one with status 'publish' wouldn't exist.\n     */\n    $random_completed_wc_order = sb_get_random_post('shop_order', 'wc-completed');\n    \n    /**\n     * Why would you go this length?\n     * Here's a function using WP_Query\n     * \n     * When timing sb_get_random_post() vs get_random_query_post() the results are:\n     * sb_get_random_post:    0.004508972167968\n     * get_random_query_post: 0.011613130569458\n     \n     * random_query_post executes one db query and takes almost three times as long as our function which executes two\n     * queries because it first queries our ID and effectively has to run a second query when get_post($random_id) is called.\n     * Just imagine that a wordpress page load does up till 100+ queries on average, which will cause every page load to\n     * take seconds.\n     */\n    function get_random_query_post(string $post_type = null, string $post_status = 'publish')\n    {\n        $args = [\n            'post_status'    => $post_status,\n            'posts_per_page' => 1,\n            'order'          => 'rand',\n            'orderby'        => 'ID',\n        ];\n    \n        $query = new \\WP_Query($args);\n        return $query->get_posts();\n    } \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402996", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Moving wordpress to different url/server creates redirect loop I'm trying to move my wordpress site in to different server and url.\nHow ever i seem to have a persistent redirect loop problem. I think this is not a cache, cookie or plugin problem and I am suspecting incorrect/missing settings in .htaccess file might be the culprit.\nThe server where i am doing the moving from, uses nginx web server and does not have .htaccess file.\nThe hosting provider that i am trying to move into uses apache2 and does have following .htaccess file in html folder:\nRewriteEngine On\n \nRewriteCond %{HTTPS} off\n \nRewriteCond %{HTTP:X-LB-Forwarded-Proto} !https \n \nRewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301,NE]\n\nAddHandler application/x-httpd-php73 .php\n\nCan somebody interpret if this .htaccess file is causing the redirect loop and/or what should be in the .htaccess file when using wordpress?\n\nA: As WordPress documentation says about .htaccess file:\n\nWordPress uses this file to manipulate how Apache serves files from\nits root directory, and subdirectories thereof. Most notably, WP\nmodifies this file to be able to handle pretty permalinks.\n\nAnd a basic .htaccess file content will looks like this:\n# BEGIN WordPress\n\nRewriteEngine On\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /index.php [L]\n\n# END WordPress\n\nIf that .htaccess that you says is inside your WordPress directory, you can rename it, and try to access you WP admin panel, go to your permalinks settings dashboard, hit without any change Save changes button at the bottom of that page, to regenerate a new .htaccess file on you installation directory automatically, with your current rewrite files rules, that matches with your website configuration.\nMake sure to take a backup of your previous website installation if you made some changes to that file in the past, and copy the rules in the new generated files to preserve your old changes.\n\nA: WordPress' standard .htaccess file contains:\n# BEGIN WordPress\n\nRewriteEngine On\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /index.php [L]\n\n# END WordPress\n\nIt does look like your current .htaccess file is set up to redirect every request that comes in on any domain and any path. You can delete it and let WP generate its own, or use the standard one above.\nWhen changing domains, you'll also need to make sure to run a migration script to update all instances of the old domain within your database. The WP CLI command wp search-replace is one fast way to do this; there are also plugins that will do the replacement, or your host may be able to run the migration for you. Also double-check that your wp-config.php file has the credentials for the new server rather than the old.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/402999", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Double container elements on custom block in editor The custom block I have created gets duplicate container elements in the editor. And the custom classes I set only gets applied to the inner container. On the front end the block output is as expected.\nI've found one other thread on github about this, but it didn't have a solution.\nblocks.registerBlockType( 'my-custom-blocks/section', {\n        title: 'Section',\n        category: 'design',\n \n        edit: function () {\n            var blockProps = useBlockProps({\n                className: 'section'\n            });\n \n            return el(\n                'section',\n                blockProps,\n                el(\n                    InnerBlocks,\n                    {\n                        template: SECTION_TEMPLATE,\n                        allowedBlocks: [\n                            'my-custom-blocks/row'\n                        ]\n                    }\n                )\n            );\n        },\n \n        save: function () {\n            var blockProps = useBlockProps.save({\n                className: 'section'\n            });\n \n            return el( 'section', blockProps, el( InnerBlocks.Content ) );\n        },\n    } );\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403014", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: need click to clipboard button on my site I'm using this code\n<!-- The text field -->\n<input type=\"text\" value=\"[gamipress_referral_url]\" id=\"myInput\">\n\n<!-- The button used to copy the text -->\n<button onclick=\"myFunction()\">Copy text</button>\nfunction myFunction() {\n  /* Get the text field */\n  var copyText = document.getElementById(\"myInput\");\n\n  /* Select the text field */\n  copyText.select();\n  copyText.setSelectionRange(0, 99999); /* For mobile devices */\n\n   /* Copy the text inside the text field */\n  navigator.clipboard.writeText(copyText.value);\n}\n\nWhat I want to happen is, if I click on copy text button then copy the generated link which is I used [shortcode] on input type.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403017", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress template file if else issue I'm trying to show information on a template page I made in WordPress. I am trying to show posts with GPS data if they don't have a tag that says no-gps. I want to check which pages are missing the GPS data. Is there an easy way to do that? I'm thinking of using an if else statement to add a mark so that I can do a search for the pages in WordPress and manually add the missing GPS data. Any ideas are greatly appreciated though. How do I put the extra if else statement into the current if statement? Here's my code:\n<?php if(!has_tag('no-gps')){\n//the_tags();\necho '<span id=\"topgps\"><strong>GPS</strong>: '; \nthe_field(\"GPS\");\necho '</span>';\n} ?>\n\nI want to write:\nIf there is a page that doesn't have the no-gps tag, with GPS data, show the value. This works now.\nNew bit: But if the GPS value is missing (no value at all) on a page that doesn't have the no-gps tag show a star \u2605 instead.\n\nA: Try changing the code for the line with the_field(\"GPS\"); to:\n$gps = get_field(\"GPS\");\necho ($gps == '') ? '*' : $gps;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403018", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to send bulk messages using wp mail function? I was working in custom plugin development. I have created customer table in woocommerce and create form to reminder customer for new offers. I am using wp mail function to send multiple email to customer but its works with single customer mail.\nhere its my code\n<form class=\"formpopup\" action=\"#\" method=\"post\">\n                            <div>\n                            <label>To</label><input id=\"customer_to_mail\" type=\"text\" class=\"modalform\" style=\"width: 70%;\" value=\"\" name=\"customer_to_mail\" required></div><br>\n                            <div><label>Subject</label><input class=\"modalform\" style=\"width: 70%;\" type=\"text\" name=\"customer_subject\" required></div><br>\n                            <div class=\"descr\"><label>Description</label><textarea class=\"modalform\" style=\"width: 70%; height: 150px;\" name=\"customer_description\" required></textarea></div><br>\n                            <input style=\"margin: 20px auto; display: flex;\" type=\"submit\" name=\"send-mail\" value=\"Send Email\">\n                            <?php\n                            $to = array($_POST['customer_to_mail']); //sendto@example.com\n                                    $subject = $_POST['customer_subject'];\n                                    $body = $_POST['customer_description'];\n                                    $headers = array('Content-Type: text/html; charset=UTF-8');\n\n                                    wp_mail( $to, $subject, $body, $headers ); ?>\n                        </form>\n\nAnd Js code to automatic give customer email in to field\njQuery(document).ready(function() {\n    jQuery('.emlchk').click(function() {\n       \n        var selectedEmailAddress = '';\n\n                jQuery('.emlchk:checked').each(function() {    // $(':checkbox:checked')\n                    jQuery('.checkbox_value').text(this.value + ' ');   \n\n                     var emailAdd = jQuery(\"#EmailAddressTD_\"+this.value+\"\").text();\n\n                     selectedEmailAddress = \"\"+selectedEmailAddress+\"\"+emailAdd+\"\";\n\n                });\n         jQuery(\"#customer_to_mail\").val(selectedEmailAddress);\n\n    });\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403023", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: get_option() and update_option() in a transaction (for an autoincrement value) I need an autoincremented ID for a custom post type to manage order IDs. For this, I would use the WP Options API, but I'm afraid of a typical transaction issue:\n$count = get_option('my_id');\nupdate_option('my_id', $count + 1);\n\nWhen there is running a parallel request, $count could be the same value in both requests.\nSo: Is it somehow possible to set this code part as a transaction to prevent this issue?\nEdit: Example scenario for a failed autoincrement:\nIf two users hit at the exact time time the process, where the code above will be executed, this may happen:\nuser 1: $count = get_option('my_id') // $count = 1\nuser 2: $count = get_option('my_id') // $count = 1\nuser 1: update_option('my_id', $count + 1); // 'my_id' = 2\nuser 2: update_option('my_id', $count + 1); // 'my_id' = 2\n\nIn a transaction, the database would wait for user 1 to get and update the value for 'my_id'. When user 1 finished the transaction process, user 2 would get the correct updated value.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403024", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to return a 410 code for previously published posts now set to draft? I'd like to return a 410 code for posts (of custom type \"news\") which have previously been published (and therefore have a url indexed by search engines), but have now had the post status set to draft.\nHere's my attempt:\nfunction news_gone() {\n    global $post;\n    if ( is_singular( 'news' ) && get_post_status($post->id) == \"draft\"  ) {\n        global $wp_query;\n        $wp_query->set_404();\n        status_header(410);\n    }\n}\nadd_action( 'template_redirect', 'news_gone' );\n\nThis, however, has no effect - is template_redirect the correct hook, or is there a better approach?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403032", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Unreadable pagination I act according to the Output of posts\nThere is a file blog.php\n    <?php\n/*\nTemplate Name: Myblogpage\n*/\n?>\n\n<?php get_header('third'); ?>\n\n\n   <!-- Content\n   ================================================== -->\n   <div class=\"content-outer\">\n\n      <div id=\"page-content\" class=\"row\">\n\n         <div id=\"primary\" class=\"eight columns\">\n\n            <?php /*if (have_posts()) { while (have_posts()) { the_post(); */ $query = new WP_Query(['post_type' => 'post']);\n            /*print_r($query);*/\n            while ( $query->have_posts() ) {\n                $query->the_post();\n                ?>\n            \n            <article class=\"post\">\n\n               <div class=\"entry-header cf\">\n\n                  <h1><a href=\"<?php the_permalink() ?>\" title=\"\"><?php the_title() ?></a></h1>\n\n                  <p class=\"post-meta\">\n\n                     <time class=\"date\" datetime=\"2014-01-14T11:24\"><?php the_time('F jS, Y') ?></time>\n                     /\n                     <span class=\"categories\">\n                     <?php the_category($separator=' / ', '') ?>\n                     <!--\n                     <a href=\"#\">Design</a> /\n                     <a href=\"#\">User Inferface</a> /\n                     <a href=\"#\">Web Design</a>\n                     -->\n                     </span>\n\n                  </p>\n\n               </div>\n\n               <div class=\"post-thumb\">\n                  <a href=\"<?php the_permalink() ?>\" title=\"\"><?php the_post_thumbnail('post_thumb') ?><!--<img src=\"images/post-image/post-image-1300x500-01.jpg\" alt=\"post-image\" title=\"post-image\">--></a>\n               </div>\n\n               <div class=\"post-content\">\n\n                  <p><?php the_excerpt() ?></p>\n\n               </div>\n\n            </article> <!-- post end -->\n            \n            <?php } \n            \n            the_posts_pagination();\n            \n            ?>\n            \n            <!--<?php the_posts_pagination(); ?>-->\n\n            <!-- Pagination -->\n            <!--\n            <nav class=\"col full pagination\">\n                  <ul>\n                  <li><span class=\"page-numbers prev inactive\">Prev</span></li>\n                      <li><span class=\"page-numbers current\">1</span></li>\n                      <li><a href=\"#\" class=\"page-numbers\">2</a></li>\n                  <li><a href=\"#\" class=\"page-numbers\">3</a></li>\n                  <li><a href=\"#\" class=\"page-numbers\">4</a></li>\n                  <li><a href=\"#\" class=\"page-numbers\">5</a></li>\n                  <li><a href=\"#\" class=\"page-numbers\">6</a></li>\n                  <li><a href=\"#\" class=\"page-numbers\">7</a></li>\n                  <li><a href=\"#\" class=\"page-numbers\">8</a></li>\n                  <li><a href=\"#\" class=\"page-numbers\">9</a></li>\n                      <li><a href=\"#\" class=\"page-numbers next\">Next</a></li>\n                  </ul>\n              </nav>\n            -->\n         </div> <!-- Primary End-->\n\n         <div id=\"secondary\" class=\"four columns end\">\n\n            <!--\n            <aside id=\"sidebar\">\n\n               <div class=\"widget widget_search\">\n                  <h5>Search</h5>\n                  <form action=\"#\">\n\n                     <input class=\"text-search\" type=\"text\" onfocus=\"if (this.value == 'Search here...') { this.value = ''; }\" onblur=\"if(this.value == '') { this.value = 'Search here...'; }\" value=\"Search here...\">\n                     <input type=\"submit\" class=\"submit-search\" value=\"\">\n\n                  </form>\n               </div>\n\n               <div class=\"widget widget_text\">\n                  <h5 class=\"widget-title\">Text Widget</h5>\n                  <div class=\"textwidget\">Proin gravida nibh vel velit auctor aliquet.\n                  Aenean sollicitudin, lorem quis bibendum auctor, nisi elit consequat ipsum,\n                  nec sagittis sem nibh id elit. Duis sed odio sit amet nibh vulputate cursus\n                  a sit amet mauris. Morbi accumsan ipsum velit. </div>\n                 </div>\n\n               <div class=\"widget widget_categories\">\n                  <h5 class=\"widget-title\">Categories</h5>\n                  <ul class=\"link-list cf\">\n                     <li><a href=\"#\">Designs</a></li>\n                     <li><a href=\"#\">Internet</a></li>\n                     <li><a href=\"#\">Typography</a></li>\n                     <li><a href=\"#\">Photography</a></li>\n                     <li><a href=\"#\">Web Development</a></li>\n                     <li><a href=\"#\">Projects</a></li>\n                     <li><a href=\"#\">Other Stuff</a></li>\n                  </ul>\n               </div>\n\n               <div class=\"widget widget_tag_cloud\">\n                  <h5 class=\"widget-title\">Tags</h5>\n                  <div class=\"tagcloud cf\">\n                     <a href=\"#\">drupal</a>\n                     <a href=\"#\">joomla</a>\n                     <a href=\"#\">ghost</a>\n                     <a href=\"#\">wordpress</a>\n                  </div>\n               </div>\n\n               <div class=\"widget widget_photostream\">\n                  <h5>Photostream</h5>\n                  <ul class=\"photostream cf\">\n                     <li><a href=\"#\"><img src=\"images/thumb.jpg\" alt=\"thumbnail\"></a></li>\n                     <li><a href=\"#\"><img src=\"images/thumb.jpg\" alt=\"thumbnail\"></a></li>\n                     <li><a href=\"#\"><img src=\"images/thumb.jpg\" alt=\"thumbnail\"></a></li>\n                     <li><a href=\"#\"><img src=\"images/thumb.jpg\" alt=\"thumbnail\"></a></li>\n                     <li><a href=\"#\"><img src=\"images/thumb.jpg\" alt=\"thumbnail\"></a></li>\n                     <li><a href=\"#\"><img src=\"images/thumb.jpg\" alt=\"thumbnail\"></a></li>\n                     <li><a href=\"#\"><img src=\"images/thumb.jpg\" alt=\"thumbnail\"></a></li>\n                     <li><a href=\"#\"><img src=\"images/thumb.jpg\" alt=\"thumbnail\"></a></li>\n                  </ul>\n                </div>\n\n            </aside>\n            -->\n            \n            <?php get_sidebar(); ?>\n\n         </div> <!-- Secondary End-->\n\n      </div>\n\n   </div> <!-- Content End-->\n\n   <!-- Tweets Section\n   ================================================== -->\n   <section id=\"tweets\">\n\n      <div class=\"row\">\n\n         <div class=\"tweeter-icon align-center\">\n            <i class=\"fa fa-twitter\"></i>\n         </div>\n\n         <ul id=\"twitter\" class=\"align-center\">\n            <li>\n               <span>\n               This is Photoshop's version  of Lorem Ipsum. Proin gravida nibh vel velit auctor aliquet.\n               Aenean sollicitudin, lorem quis bibendum auctor, nisi elit consequat ipsum\n               <a href=\"#\">http://t.co/CGIrdxIlI3</a>\n               </span>\n               <b><a href=\"#\">2 Days Ago</a></b>\n            </li>\n            <!--\n            <li>\n               <span>\n               This is Photoshop's version  of Lorem Ipsum. Proin gravida nibh vel velit auctor aliquet.\n               Aenean sollicitudin, lorem quis bibendum auctor, nisi elit consequat ipsum\n               <a href=\"#\">http://t.co/CGIrdxIlI3</a>\n               </span>\n               <b><a href=\"#\">3 Days Ago</a></b>\n            </li>\n            -->\n         </ul>\n\n         <p class=\"align-center\"><a href=\"#\" class=\"button\">Follow us</a></p>\n\n      </div>\n\n   </section> <!-- Tweets Section End-->\n\n<?php get_footer(); ?>\n\nfile functions.php\n    <?php\n\nadd_action('wp_enqueue_scripts', 'style_theme');\nadd_action('wp_footer', 'scripts_theme');\nadd_action('after_setup_theme', 'theme_register_nav_menu');\nadd_action( 'widgets_init', 'register_my_widgets' );\n\nfunction register_my_widgets(){\n\n    register_sidebar( array(\n        'name'          => 'Right Sidebar',\n        'id'            => \"right_sidebar\",\n        'description'   => '\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043d\u0430\u0448\u0435\u0433\u043e \u0441\u0430\u0439\u0434\u0431\u0430\u0440\u0430',\n        'class'         => '',\n        'before_widget' => '<li id=\"%1$s\" class=\"widget %2$s\">',\n        'after_widget'  => \"</li>\\n\",\n        'before_title'  => '<h2 class=\"widgettitle\">',\n        'after_title'   => \"</h2>\\n\",\n        'before_sidebar' => '', // WP 5.6\n        'after_sidebar'  => '', // WP 5.6\n    ) );\n}\n\nfunction theme_register_nav_menu()\n{\n    register_nav_menu('top', '\u041c\u0435\u043d\u044e \u0432 \u0448\u0430\u043f\u043a\u0435');\n    register_nav_menu('bottom', '\u041c\u0435\u043d\u044e \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435');\n    add_theme_support('post-thumbnails', array('post'));\n    add_image_size('post_thumb', 1300, 500, true);\n\n    // \u0443\u0434\u0430\u043b\u044f\u0435\u0442 H2 \u0438\u0437 \u0448\u0430\u0431\u043b\u043e\u043d\u0430 \u043f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u0438\n    \n    add_filter('navigation_markup_template', 'my_navigation_template', 2, 1 );\n    function my_navigation_template( $template, $class ){*/\n        /*\n        \u0412\u0438\u0434 \u0431\u0430\u0437\u043e\u0432\u043e\u0433\u043e \u0448\u0430\u0431\u043b\u043e\u043d\u0430:\n        <nav class=\"navigation %1$s\" role=\"navigation\">\n            <h2 class=\"screen-reader-text\">%2$s</h2>\n            <div class=\"nav-links\">%3$s</div>\n        </nav>\n        */\n        \n    \n        return '\n        <nav class=\"navigation %1$s\" role=\"navigation\">\n            <div class=\"nav-links\">%3$s</div>\n        </nav>\n        ';\n        \n    }\n\n    // \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u043f\u0430\u0433\u0438\u043d\u0430\u0446\u0438\u044e\n    \n    the_posts_pagination( array(\n        'end_size' => 1,\n    ) );\n        \n}\n\nfunction style_theme()\n{\n    wp_enqueue_style('style', get_stylesheet_uri());\n    wp_enqueue_style('default', get_template_directory_uri().'/assets/css/default.css');\n    wp_enqueue_style('layout', get_template_directory_uri().'/assets/css/layout.css');\n    wp_enqueue_style('media-queries', get_template_directory_uri().'/assets/css/media-queries.css');\n    wp_enqueue_script('modernizr', get_template_directory_uri().'/assets/js/modernizr.js');\n}\n\nfunction scripts_theme()\n{\n    wp_enqueue_script('localjquery', get_template_directory_uri().'/assets/js/jquery.min.js');\n    /*echo \"<script>window.jQuery || document.write('<script src=\"/assets/js/jquery.min.js\"></script>')</script>\";*/\n    wp_enqueue_script('jquerymigrate121', get_template_directory_uri().'/assets/js/jquery-migrate-1.2.1.min.js');\n    wp_enqueue_script('flexslider', get_template_directory_uri().'/assets/js/jquery.flexslider.js');\n    wp_enqueue_script('doubletaptogo', get_template_directory_uri().'/assets/js/doubletaptogo.js');\n    wp_enqueue_script('init', get_template_directory_uri().'/assets/js/init.js');\n}\n\n\n?>\n\npagination settings\n\nBut as a result I get a page without pagination\n\nHow to achieve pagination display?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403033", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Wordpress search only showing a few posts I am working on a Website and am linking category links to the search page.\nNow the search behaves seemingly random as seen here: https://hasel.dev/?s=dizh\nThe search for the post returns the post, so far so good. If I click the 'Developer Productivity' Tag (= search for it), however, it returns a number of posts, not including the 'DIZH' post. If I click the 'papers' tag, I don't get any results at all, although having added the category to over 20 posts.\n\nI am using custom post types but that doesn't seem to be an issue since this also concerns default posts.\nAlso I have modified the search.php file only slightly to display my tiles:\n<?php\n    if ( have_posts() ) : while ( have_posts() ) : the_post();\n    \n        get_template_part( 'template_parts/elements/tile' );\n    \n    endwhile; endif; wp_reset_postdata();\n?>\n\nWhat is the issue here?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403038", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Query to get result by Title or Meta along with tax_query parameter If I use the following code, it is working:\nnew WP_Query([\n            'post_status'    => 'publish',\n            'post_type'      => \"some_custom_post_type\",\n            'orderby'        => 'DATE',\n            'order'          => 'DESC',\n            'facetwp'        => true,\n            'posts_per_page' => 15,\n            'paged'          => $paged,\n            '_meta_or_title'=> $_POST['query'],\n            'meta_query'    => array(\n                'relation'      => 'OR',\n                array(\n                    'key'       => 'some_meta_value1',\n                    'value'     => $_POST['query'],\n                    'compare'   => 'LIKE',\n                ),\n                array(\n                    'key'       => 'some_meta_value2',\n                    'value'     => $_POST['query'],\n                    'compare'   => 'LIKE',\n                ),\n            )\n        ])\n\nBut whenever I use tax_quey, it is not working, e.g.:\nnew WP_Query([\n                'post_status'    => 'publish',\n                'post_type'      => \"some_custom_post_type\",\n                'orderby'        => 'DATE',\n                'order'          => 'DESC',\n                'facetwp'        => true,\n                'posts_per_page' => 15,\n                'paged'          => $paged,\n                'tax_query'      => [[\n                   'taxonomy' => 'some_taxonomy',\n                   'terms'    => ['some_terms_slug'],\n                   'field'    => 'slug',\n                   'operator' => 'IN',\n                ]],\n                '_meta_or_title'=> $_POST['query'],\n                'meta_query'    => array(\n                    'relation'      => 'OR',\n                    array(\n                        'key'       => 'some_meta_value1',\n                        'value'     => $_POST['query'],\n                        'compare'   => 'LIKE',\n                    ),\n                    array(\n                        'key'       => 'some_meta_value2',\n                        'value'     => $_POST['query'],\n                        'compare'   => 'LIKE',\n                    ),\n                )\n            ])\n\nMeta query modifier code\nadd_action( 'pre_get_posts', function( $q )\n{\n    if( $title = $q->get( '_meta_or_title' ) )\n    {\n        add_filter( 'get_meta_sql', function( $sql ) use ( $title )\n        {\n            global $wpdb;\n\n            // Only run once:\n            static $nr = 0; \n            if( 0 != $nr++ ) return $sql;\n\n            // Modified WHERE\n            $sql['where'] = sprintf(\n                \" AND ( %s OR %s ) \",\n                $wpdb->prepare( \"{$wpdb->posts}.post_title like '%%%s%%'\", $title),\n                mb_substr( $sql['where'], 5, mb_strlen( $sql['where'] ) )\n            );\n            return $sql;\n        });\n    }\n});\n\nI need to filter out the data Meta Values or Title, Any suggestions? Thanks in advance\n\nA: From the documentation:\n\napply_filters_ref_array( 'get_meta_sql', string[] $sql, array $queries, string $type, string $primary_table, string $primary_id_column, object $context )\nFilters the meta query\u2019s generated SQL.\n\nand\n\n$type\n(string) Type of meta. Possible values include but are not limited to 'post', 'comment', 'blog', 'term', and 'user'.\n\nSo because a hook like the one above can run multiple times on a page, which means your filter/closure could be called multiple times for the same posts query (i.e. WP_Query call), then you should do something like if ( 'post' === $type ) { modify the $sql['where'] } to modify the WHERE only if the meta type is exactly post.\nAnd basically after I tested your code, I noticed that the conditional if( 0 != $nr++ ) return $sql; skipped modifying the post meta query and instead modified a term meta query, which means when the hook called your closure for the 1st time, it was for a term meta query.\nHence, that explains why the \"whenever I use tax_query, it is not working\".\nHow can you fix the issue\n\n*\n\n*Change the add_filter( 'get_meta_sql', function( $sql ) use ( $title ) to add_filter( 'get_meta_sql', function( $sql, $queries, $type ) use ( $title ).\n\n\n*Change the return $sql; }); to return $sql; }, 10, 3); (i.e. let the above closure accepts 3 parameters).\n\n\n*Then change the if( 0 != $nr++ ) return $sql; to if( 'post' !== $type || 0 != $nr++ ) return $sql;\nAdditional Code\nYou could use get_meta_sql alone without having to use pre_get_posts to add a filter for get_meta_sql, like so:\nadd_filter( 'get_meta_sql', 'my_get_meta_sql', 10, 6 );\nfunction my_get_meta_sql( $sql, $queries, $type, $primary_table, $primary_id_column, $context ) {\n    // Check that it's a post meta type and that the main query object is an instance of WP_Query.\n    if ( 'post' === $type && $context instanceof WP_Query &&\n        // And check that the _meta_or_title arg is set.\n        ( $title = $context->get( '_meta_or_title' ) )\n    ) {\n        global $wpdb;\n\n        $sql['where'] = 'YOUR CODE..';\n    }\n\n    return $sql;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403040", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Should I add the IP of the server that hosts my sites to the list of authorized IPs in the wp-admin/.htaccess? All of my sites were recently hacked and I had to restrict access to the WordPress admin.\nThe logs are now full of denied connections, but I also see errors coming from the IP of the server  that hosting them :\n[access_compat:error] [pid 944] [client XXX.XXX.XXX.XXX:45316] AH01797: client denied by server configuration: /var/www/my-website/wordpress/wp-admin/admin-ajax.php, referer: https://www.my-website.com/wp-admin/admin-ajax.php?action=wp_1_wc_privacy_cleanup&nonce=XXXX\nwhere XXX.XXX.XXX.XXX is my server IP\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403042", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Wordpress Pagination - 301 Redirect Issue I have this wordpress problem with pagination and redirects.\nLet's take this scenario - I have a blog on my website and it has a lot of articles, therefore the blog expands to /page-35/.\nLet's say that I redirect one blog article from /blog-article/ to /blog-article-2/.\nWhen I search the blog for that article in the paginated series, let's say it appears on /page-6/ it will appear in the snippet as /blog-article/, not the new version of the url, causing a 301 redirect.\nSo, is there a way to stop this from happening?\nI hope I've explained it clearly enough and sorry if this is a common topic, but I didn't know how to search for this issue I'm having.\n\nA: Are your /old-article/ and /new-article/ posts both separate WordPress posts? If they are separate (published) posts, and all you've done is redirect /old-article/ to /new-article/, then as far as WordPress knows, both posts are still published in the backend, therefore both /old-article/ and /new-article/ will show in the blog feed, regardless of the redirects. You have to draft or delete your /old-article/, OR change the permalink on /old-article/ to /new-article/. Otherwise, it will still show in your blog feed.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403043", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: JS button animation for ajax the WordPress style I'm creating a backend ajax functionality form, and I'd like it to stay within the WordPress style.\nThere is a small spinning circle animation that appears on certain forms, like when you try to search for a plugin in the repo in the\nHow can I recreate that spinning animation?\n\nA: Thanks for Paj J pointing the way. Just do this:\n<div class = \"spinner is-active\"></div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403046", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Security of a Wordpress Plugin What security mechanisms exist in Wordpress to ensure that a popular plugin doesn't contain malicious code which for example tries to gain access to the database or make downstream DDOS attacks?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403047", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp_query with multiple arguments with AND $loop3 = new WP_Query( array( \n    'posts_per_page' => 10000, \n    'post_type' => 'volunteers',  \n    'meta_key' => 'state',\n    'meta_value' => $stateselect,\n    'meta_compare' => '=',\n    'meta_key' => 'volunteer_type',\n    'meta_value' => 'painter',\n    'meta_compare' => '=',\n    ) ); \n \n       \n\nHello.  I'm new to PHP and WordPress.  I'm having trouble understanding how WP_Query works.  I'm trying to get a dataset that looks like this pseudocode:\nstate=$stateselect AND volunteer_type=painter\nThe code above seems to be rewriting 'meta_key' and returning results from all 'states', since 'volunteer_type' appears to be overwriting.  How do I ...\n\n*\n\n*Retrieve the results of two different criteria,\n\n*do equivalent of AND between the two different meta_key criterias?\n\nAlso, I want to sort the results by a meta_key that is not in the arguments.  e.g. There's a field called 'Section' which is alpanumerical.  How is sort ASC or DESC done on a field that is not part of the arguments?\nThanks\n\nA: You want to use the newer meta_query methodology...\nYou establish a meta_query and then use arrays for the different conditions you want met, preface them with the relationship relation => 'AND' or relation => 'OR'\n$loop3 = new WP_Query( array( \n    'posts_per_page' => 10000, \n    'post_type' => 'volunteers',  \n    'meta_query' => array(\n        'relation' = 'AND',\n        array(\n            'key' => 'state',\n            'value' => $stateselect,\n            'compare' => '=',\n        ),\n        array(\n            'key' => 'volunteer_type',\n            'value' => 'painter',\n            'compare' => '=',\n        ),\n    ),\n) );\n\nCodex has a write-up here:\nhttps://developer.wordpress.org/reference/classes/wp_query/#custom-field-post-meta-parameters\nNote\nThat's a lot, like A LOT, of posts_per_page.\n\nA: You should use meta_query:\n\n\n$loop3 = new WP_Query( array( \n    'posts_per_page' => 10000, \n    'post_type' => 'volunteers',  \n    'meta_query' => array(\n        'relation' => 'AND',\n        array(\n            'key'     => 'state',\n            'value'   => $stateselect,\n        ),\n        array(\n            'key'     => 'volunteer_type',\n            'value'   => 'painter',\n        ),\n)); \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403052", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: New user signup via REST API The following question has some answers that give custom code for new user sign up via the REST API: How to use the WP REST API for new user registration (sign up form)?\nAs of version 5.9 the documentation seems to indicate that this functionality is included.\nAre the answers to the above question still relevant or have they been superceded by the built in functionality?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403055", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Automatic updates and merging manual changes I have Wordpress running on my dedicated server, and I thought it would be a good idea to use Git so that I can track changes that I make over time.\nI have updated a few things, mostly just little changes to CSS or commenting out some HTML from PHP pages.\nQ1: Will Wordpress notice these changes and merge them into new versions of the files it installs?\nA few days ago I was able to update translations and a plugin with out any problems. Today I update WP to 5.9.1 from 5.9.0. But when I now try and update translations or another plugin, it wants me to enter an FTP username/password. I don't run FTP on my server, and I don't want to either.\nI now have a critical issue on the site health status:\nBackground updates ensure that WordPress can auto-update \nif a security update is released for the version you are currently using.\n\nWarning The folder /var/www/html/ was detected as being under version control (.git).\n\nError Your installation of WordPress prompts for FTP credentials to perform updates.\n(Your site is performing updates over FTP due to file ownership. Talk to your hosting company.)\n\nI saw the warning about version control before, but the warning about FTP seems to be new.\nQ2: is this normal? why has this second warning appeared after the update?\nQ3: how can I fix it?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403058", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Help to display the current categories and tags of a post I am using a shortcode to try to display the tags and categories of a post.\nSpecifically, this is a portfolio post, so when a user visits a post they will see the associated categories and tags. example here\nMy shortcode is pulling all portfolio-categorys or portfolio-tags, not just those of the current post.\n<?php\nclass ListCategories{\n  static function list_categories($atts, $content = null) {\n    $atts = shortcode_atts(\n      array(\n        'child_of'            => 0,\n        'current_category'    => 0,\n        'depth'               => 0,\n        'echo'                => 1,\n        'exclude'             => '',\n        'exclude_tree'        => '',\n        'feed'                => '',\n        'feed_image'          => '',\n        'feed_type'           => '',\n        'hide_empty'          => 1,\n        'hide_title_if_empty' => false,\n        'hierarchical'        => 1,\n        'include'             => '',\n        'number'              => null,\n        'order'               => 'ASC',\n        'orderby'             => 'name',\n        'pad_counts'          => 0,\n        'show_count'          => 0,\n        'show_option_all'     => '',\n        'show_option_none'    => __( 'No categories' ),\n        'style'               => 'list',\n        'taxonomy'            => 'category',\n        'title_li'            => __( 'Categories' ),\n        'use_desc_for_title'  => 1,\n        'walker'              => null,\n      ), $atts\n    );\n\n    ob_start();\n    wp_list_categories($atts);\n    $output = ob_get_contents();\n    ob_end_clean();\n    return $output;\n  }\n}\n\nadd_shortcode( 'categories', array('ListCategories', 'list_categories') );\n\n\nA: If you're using the default category and post_tag taxonomies for your portfolio posts, then have a look at get_the_tags() and get_the_category(). These will return arrays of tags and categories for the current post. Pass post ID as parameter to the functions, when using outside the Loop.\nIf on the other hand you have custom taxonomies, then use get_the_terms() directly, for which you can pass the custom taxonomy slug as the 2nd parameter, post ID being the 1st.\nIf you want to use wp_list_categories(), then you should pass include as one of the parameters so that the list is limited to the given term IDs. There's a nice example on the documentation how to do this with the help of wp_get_object_terms().\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403061", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Media library style not loading correctly when selecting a page featured image? I'm trying to set a featured image to some pages, so when I press select featured images the media library upload UI not loading correctly its own stylesheet ( get images and search are working perfectly)\nThis is a screenshot of the problem\nand the thing is the problem occurs only on some pages ( with the same template!!! )\n\nWhat I've tried:\n\n*\n\n*Checked every single plugin deactivate&activate ( no changes)\n\n*Add a define( 'CONCATENATE_SCRIPTS', false ); in  wp-config.php file ( no changes)\n\n*Checked console there are no errors.\n\n*Different browsers on 2 different devices ( no changes )\n\nAny ideas would be appreciated, Thanks.\n\nA: After some search, the problem was in the pages which contains ACF blocks\nACF plugin is not compatible with the latest WP 5.9.1\ntemporary fixes until the update has been released :\n1- In your functions.php file add these lines:\n function acf_fix_preload_path( $preload_paths ) {\n        global $post;\n        $rest_path   = rest_get_route_for_post( $post );\n        $remove_path = add_query_arg( 'context', 'edit', $rest_path );\n        return array_filter(\n            $preload_paths,\n            function( $url ) use ( $remove_path ) {\n                return $url !== $remove_path;\n            });}\n        add_filter( 'block_editor_rest_api_preload_paths', 'acf_fix_preload_path', 10, 1 );\n\nOr\nrollback to the previous version of WordPress like 5.9\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403074", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How can I remove a function that has been added to wordpress with add_filter? to begin with I am trying to modify a wordpress plugin.\nI have created a function named fuxia_is_the_best. Then I add this function to the sanitize_title filter, with the use of this code:\nadd_filter('sanitize_title', 'fuxia_is_the_best');\n\nand this add_filter function goes inside an if statement:\nif ( $lama == 'green' ) {\n  add_filter('sanitize_title', 'fuxia_is_the_best');\n} else {\n  remove_filter('sanitize_title', 'fuxia_is_the_best');\n}\n\nIf you noticed I have an else statement in which I'm using the remove_filter() function.\nBut there goes my problem and the cause of this question in general. The remove_filter() \ndoesn't actually remove the filter :/ .\nQuestion:\n\n*\n\n*What could have gone wrong?\n\n*Is there anything wrong in this php code above?\n\nclosure:\nThanks in advance for your time, you're awesome!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403076", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to hide particular plain text with link from different subscribers I have a question about how to hide particular plain text with link from different subscribers?\nFor example if user_A logins to dashboard page he will be able to see only text with URL \"Client A\" which will redirect him to his webpage. If user_B logins to Dashboard page he can see Text with URL \"Client B\"\nDo you have any suggestions or plugins how to make it work on custom \"Dashboard\" Page\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403077", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What is the practical difference between is_admin() and is_blog_admin()? I can see that the 2 functions are almost identical. Only difference is in one line:\n@is_admin()\nreturn $GLOBALS['current_screen']->in_admin();\n@is_blog_admin()\nreturn $GLOBALS['current_screen']->in_admin( 'site' );\nWhat is the practical purpose / reason behind this? Or where can i read more about it?\nI can see that is_blog_admin() 'born' much later, and since it's giving the 'site' parameter to the in_admin() function that it calls internally, it works as a stricter condition, thus being more specific and probably not good idea to use it as an 'alias' to 'is_admin()' (since it's not). I just would like to see where this is used in practice?\n\nA: On a multisite network is_admin() is true for everything under /wp-admin, including the multisite network admin at /wp-admin/network, but is_blog_admin() is only true for the admin for an individual site/blog on the network, and is not true for /wp-admin/network.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403080", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Post Thumbnail missing when using webp format while sharing I have a problem when I upload a featured image for my post in jpg format, I get the featured image's thumbnail while sharing my post through any kind of messenger e.g whatsapp etc. But when I try to upload the featured image in webp format. My post thumbnail gets missing while sharing it. As far as I have studied about it till last year og:image for webp wasn't supported in wordpress. Is it still the same. Is there any way? Any wordpress hooks that I can use to get webp format supported too. Any guidance will be appreciated\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403081", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress How to reorder Page/Post Settings I am trying to move Yoast Seo to the bottom of my Post/Page settings sidebar. I am not sure how to hook into those so I can change the order.\nOrder I need\n\n*\n\n*Status & Visibility\n\n*Permalinks\n\n*Discussion\n\n*Page Attributes\n\n*Yoast Seo\n\nCurrently it looks like\n\n*\n\n*Status & Visibility\n\n*Yoast Seo\n\n*Permalinks\n\n*Discussion\n\n*Page Attributes\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403083", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disable Wordpress Theme Browser and Plugin Browser Does the Wordpress theme browser have a name? I looked in its code and don't see something spesific and when I search Google I get other topics.\nTo disable the theme browser and keep upload theme button active, I would like to add some code like:\nadd_filter('theme_browser', '__return_false');\n\nActually I want to disable both the theme browser and the plugin browser. Is there a way to do this but keep the upload theme button active and upload plugin button active?\n\nA: You can block the API.\nadd_action('themes_api', 'se_block_api');\nadd_action('plugins_api', 'se_block_api');\nfunction se_block_api(){\n    exit;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403087", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Placing category specific banner/html at top of respective category pages I have 3 categories in my Wordpress site and I've linked them to 3 specific pages so the URL is site.com/tag/candles, etc.\nMy issue is that I'd like to add a banner specific to each category, so on the Candles category page I want a banner at the top related to candles, and then the same for the other two categories.\nIs there a way I can add a category specific banner at the top of each page? I know that I can go to Posts->categories and edit descriptions and other items but I'm referring to custom html or a banner image for each one. I was planning on using an if statement to check for the three category names and display the appropriate image\nI can go to Theme File Editor where I have a categories.php file, but I'm just not sure where I would need to place my PHP/HTML\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403089", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show all posts by author I used to have a page on my site where it would show all posts by a user and it worked. This was the code it was using:\n    <?php\n    //$wp_query = new WP_Query( array( 'post_per_page' => 12 ));\n    $wp_query->query_vars[\"posts_per_page\"] = 24;\n    $wp_query->query_vars[\"orderby\"] = 'title';\n    $wp_query->query_vars[\"order\"] = 'ASC';\n    $wp_query->get_posts();\n    ?>\n\n    <?php if ( have_posts() ) : ?>\n\nNothing has changed but it recently stopped showing results. Any ideas what has gone wrong?\n\nA: You should uncomment first line and add author query var.\n $wp_query->query_vars[\"author_name\"] = \"John\";\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403092", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is it possible to pin a post in second position from top as the topic says i wish to keep a post not on top but in second position so that new posts are on top while one of my choice will be just after the latest.\nIs that possible, can't find a plugin that does it.\nEdit: I have posts on frontpage 1 by 1 below each other, like a google search result, i want a 'featured' post to stick always below the new/first post which is on top of the homepage. The sticky one shall remain always below the first on top which is at the same time the latest post.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403093", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I need to update the post query? I am trying to simply update the post query to only query posts with the taxonomy.\n\nA: You should use tax_query.\n$args = \n  [\n    'posts_per_page' => 10,\n    'post_type'  => 'post',\n    'post_status' => 'publish'\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'state',\n            'field'    => 'slug',\n            'terms'    => 'minnesota', // lowercase m\n        ),\n  ];\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403095", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: Blog Posts - Scroll to view more I have a page with all my blog posts in it and I have it set to show all my posts on one page. (See screenshot) Now am I looking for away to only show 10 posts at a time and on scroll show more. I see there are plugins like this https://en-ca.wordpress.org/plugins/ajax-load-more/ but this needs a pagination, I do not want a pagination because of SEO reasons. (new SEO errors come up when a new page for the pagination comes up)\nIs there away to this with jquery or javascript?\n\nA: Load all the posts and hide them exclude 10. If the user scroll to page bottom show more 10.\n$('article').each((i, el) => {\n   if (i > 9){\n      $(el).hide();\n   }\n});\n$(window).scroll(() => {\n       if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {\n          $('article:hidden').first().show();\n    }\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403097", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get bool with `get_option()` when already registered setting with type `boolean` When I register a boolean setting using register_setting() I already pass the data type:\n        register_setting(\n            option_group: '\u2026',\n            option_name: '\u2026',\n            args: [\n                'type' => 'boolean',\n                'description' => '\u2026',\n                'sanitize_callback' => function (mixed $value): bool {\n                    return (bool) $value;\n                },\n                'show_in_rest' => false,\n                'default' => false,\n            ],\n        );\n\nHowever, when calling the option with get_option(), it still returns me a string value:\n\"1\"\n\nI would like to compare values with === and would like to AVOID something like:\n(bool) get_option('\u2026') === true\n\nAND\nboolval(get_option('\u2026')) === true;\n\nI'm thinking of creating a helper function, that acts like a proxy, checks the data value of the setting for the given option name, convert it accordingly and return it.\nSomething like:\n    /**\n     * Get option with a value converted into the correct data type as registered with `register_setting()`.\n     */\n    public static function getOption(string $optionName): mixed\n    {\n        $optionValue = get_option($optionName);\n\n        $settingArgs = get_setting_args($optionName); // ???\n\n        if (empty($settingArgs['type'])) {\n            return $optionValue;\n        }\n\n        switch ($settingArgs['type']) {\n            case 'string':\n                return (string) $optionValue;\n            case 'int':\n                return (int) $optionValue;\n            case 'bool':\n                return (bool) $optionValue;\n            case 'array':\n                return (array) $optionValue;\n            case 'object':\n                return (object) $optionValue;\n            case 'float':\n                return (float) $optionValue;\n            default:\n                return $optionValue;\n        }\n    }\n\nAs marked in the code with ??? I have no idea to access the arguments of a registered setting in WordPress. How can I do so? Or should my goal be accomplished in another way?\n\nA: The type argument is only relevant for the REST API and relatively new. If you want it to be enforced on get_option() you will need your own helper function, as you've noticed. This is probably for backwards compatibility reasons. I would avoid attempting to enforce this for all get_options() calls via a filter, and stick to using a helper function.\nRegistered settings are in the global $wp_registered_settings variable which you can retrieve with get_registered_settings(). The key of the array for your settings would be whatever you used for option_name.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403099", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to get and set the post tag value within WP Query from URL? This is new grounds for me.  I'm on a hunt trying to figure out how can use a WPQuery to list all posts, that are filtered by the tag which the user clicked on.  So for example if the end-user is on one of my posts, and clicks on a tag that is part of that post, it goes to a new page with the following URL...\nhttp://pm.local:57786/tag/beaches/\nOn that beaches page, I know from my child theme I can create a template called tag.php and build & brand the logic for that page. But from this same  tag.php template, how can WP Query list all posts that are associated to the tag beaches because its the value in the URL?\n\nA: You don't need to make a new WP_Query to display the posts in the requested tag (beaches in question), because when the page is requested, WordPress will parse the query args from the URL (or the rewrite rule that matches the URL path) and automatically make a WP_Query call which fetches the tag's posts from the database. And that query is called the \"main query\" which runs automatically on page load, before the template like tag.php or single.php is determined.\nSo in your tag template, you just need to display the (main) loop, or the posts for the main query, i.e. while ( have_posts() ) { the_post(); /* your code here; e.g. call the_title() */ }.\nHowever, if you wanted to know how to retrieve the current tag object (which is an instance of WP_Term), then use get_queried_object(). Or get_queried_object_id() to retrieve just the tag ID.\nOr have I misread your question?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403101", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Uncaught ReferenceError: jQuery is not defined - although jQuery is loaded I'm aware that this is a well discussed question, nevertheless I did not find any answer for my issue. I have the following code on a Wordpress page (inline, necessary for this project):\n<script>\n(function ($) {\n    $(document).ready(function () {\n    $('.choosekurs').on('click', function() {\n        $('textarea[name=\"textarea\"]').text($(this).attr('data-attr-package')); \n     });\n})(jQuery);\n</script>\n\nI also tried it the other way around:\n<script>\njQuery(document).ready( function($){\n    $('.choosekurs').on('click', function() {\n        $('textarea[name=\"textarea\"]').text($(this).attr('data-attr-package')); \n  });\n});\n</script> \n\nUnfortunately I still get the same error. I can see jQuery being loaded in the footer (v3.6.0 as well as 3.3.2 migrate version), so I'm not really sure what I'm doing wrong. Any help is greatly appreciated!\n\nA: The error is self-explanatory. When you insert your code, jQuery has not been defined. You have to put that script after jQuery is loaded.\nIf you can't change where jQuery is defined, as you say in your comment to Pat J's answer, then insert your script in the <footer>.\n\nA: If the inline <script> is in the <head> or <body> of your page, and jQuery is loaded in the footer (ie, at the end), then jQuery doesn't exist when you're trying to run your jQuery code.\nEither enqueue jquery to load in the header (ie, set the $in_footer parameter to false), or\u2014the better option\u2014use wp_enqueue_script() to properly load your script. This latter option will also let you define jquery as a dependency for your script.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403103", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Remove style `?ver=` from `/wp-admin/upgrade.php` Using style_loader_src hook to remove the version query works just fine, but on /wp-admin/upgrade.php the version queries won't go away.\nIs there a way to also remove the versions strings from the /wp-admin/upgrade.php page?\n\nA: Turning the plugin code into a must-use plugin seems to work.\nBut not exactly what I am looking for tbh.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403104", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to display post tag on each post? I need to display it on each post.\n\nA: \nI need to display it on each post and only the first state if it has\nmultiple states\n\nI noticed there are $categories = get_the_category(); and echo esc_html($categories[0]->name); in your code, which display the first category for the current post, but then note that get_the_category() only returns results for the default/core category taxonomy.\nFor custom taxonomies, you should use get_the_terms() instead of get_the_category(). And just so you know, for tags, i.e. the default post_tag taxonomy, you can use get_the_tags().\nWorking Examples\n\n*\n\n*Display the first category term for the current post:\n(you already have this in your code, but I included this just for completeness)\n$categories = get_the_category();\nif ( ! empty( $categories ) ) {\n    echo esc_html( $categories[0]->name );\n}\n\n\n\n*Display the first post_tag term for the current post:\n$tags = get_the_tags();\nif ( is_array( $tags ) && ! empty( $tags ) ) {\n    echo esc_html( $tags[0]->name );\n}\n\n\n\n*Display the first state term for the current post:\n$states = get_the_terms( get_the_ID(), 'state' );\nif ( is_array( $states ) && ! empty( $states ) ) {\n    echo esc_html( $states[0]->name );\n}\n\nSo as you could see, in the last example, I used get_the_terms() because state is a custom taxonomy.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403107", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I need to add a filter to prepend the term 'National - ' to the post title if the post is tagged to multiple states I am trying to add a filter to add the word \"National - \" to the beginning of the the post title if the post has multiple states that it is in.\nHere is a screenshot:\n\nI just figured out the add filter that adds the word \"National - \" to the beginning of the post title, but I can't figure out the if statement because I only need the word \"National - to be added if the post has multiple states.\nHere is the filter:\nadd_filter( 'the_title', function($title) { \nreturn 'National - ' . $title;\n});\n\n\nA: Your \"states\" appear to be terms in a custom taxonomy. In the code below I've assumed the taxonomy's name is my_state; you'll need to make sure that's updated to match the actual taxonomy name.\nadd_filter( 'the_title', function( $title, $id ) {\n    // Gets the list of 'states' the post belongs to.\n    $states = wp_get_post_terms( $id, 'my_state' );\n    // If there's more than 1 state, prepend 'National - ' to the title.\n    if ( 1 < count( $states ) ) {\n        $title = 'National - ' . $title;\n    }\n    return $title;\n}, 10, 2 );\n\nReferences\n\n*\n\n*wp_get_post_terms()\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403127", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show date post published in Gutenberg component I am coming from the PHP world where I would just put\n<div>\n  <h1><?= get_the_title() ?></h1>\n  <p><?= the_time('j F  Y'); ?></p>\n</div>\n\nNow I have a Gutenberg Edit.js block.\n<div>\n    <RichText\n        className=\"snug huge\"\n        placeholder=\"Your title here\"\n        onChange={(content) => setAttributes({ title: content })}\n        value={attributes.title}\n        tagName=\"h1\"\n    />\n    <p>[The date of the page or post needs to be formatted and placed here]</p>\n</div>\n\nHow on earth do I put the date the post was published in?\nEdit:\nRecently I have found a list of all PHP template tags and their Gutenberg counterparts:\nhttps://github.com/WordPress/gutenberg/issues/22724\nThis has lead me to find the Post Date \u2014\u00a0however there is no documentation at all for it. I think it is what I am after, however I'm unsure how to use it.\nhttps://github.com/WordPress/gutenberg/tree/trunk/packages/block-library/src/post-date\n\nA: I was able to get there by doing the following.\nimport * as wpDate from \"@wordpress/date\";\n\nYou can find the very limited documentation on that here: https://developer.wordpress.org/block-editor/reference-guides/packages/packages-date/\nI was able to use the following:\nconst post = wp.data.select(\"core/editor\").getCurrentPost();\nconst postDate = wpDate.format(\"d|m|Y\", post.date);\n\nThen, when I needed it:\n<div>\n    <RichText\n        className=\"snug huge\"\n        placeholder=\"Your title here\"\n        onChange={(content) => setAttributes({ title: content })}\n        value={attributes.title}\n        tagName=\"h1\"\n    />\n    <p>{postDate}</p>\n</div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403129", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Why I get File Not Found (404 error) when the file is actual there? The directory at my website (ConcoursBuilder.us) looks like this in Filezilla:\n\nPer SiteGround conventions, non-WordPress files must be uploaded to manual-uploads under a separate public_html directory. However, to access a file in a browser, public_html is omitted because it is the default \"home\" for a user.\nThe problem is when I put a properly constructed URL in the browser I get a file not found 404 error.\nThere are many reports and offered \"solutions\" to this problem, including recreating the \"htaccess.\" I've done that, but it didn't help.\nTo rule out possible errors in the real files such as ChampionSpecial.pdf (created & uploaded by my Windows app), I used FileZilla to upload a simple text file to various places in the online data structure. What I learned was if I put AboutCB.txt in public_html/manual-uploads it works, i.e., the text is properly displayed in the browser. However, if put it anywhere below that, e.g., public_html/manual-uploads/JOCLA, it causes a 404 error.\nMy guess is it's a file permissions error. I played with that a bit, but no joy.\nWhat am I missing?\nEd\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403135", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: posts_per_page in custom WP_Query does not override \"Reading\" settings? I am trying to use WP_Query loop (below) to show all instances of a certain post type.\n(This loop is not in the custom post type\u2019s archive \u2014 it is in a template part that appears as a page section on two different pages of the site.)\nI have posts_per_page set in the WP_query args, but the argument is ignored and the number of posts displayed is instead whatever number of blog posts is set in the Wordpress \"Reading\" settings.\nMy (two-part) question is:\n\n*\n\n*How do I display all of the posts in this custom post type loop (while leaving the blog archive (index.php) set to display just 9 posts at a time)?\n\n*What is the point of the posts_per_page argument existing and being available to set on individual queries, if it is overridden by the global setting in the dashboard GUI?? What does this argument even do if it can't be used to set the number of posts displayed by an individual query?\n\nHere is the code I am using for my query/loop:\n<?php\n\n$args = array(\n  'posts_per_page' => -1, /* have also tried setting to 999 or using a variable -- is still ignored */\n  'post_type' => 'department',\n  'status'    => 'published'\n);\n\n$serviceIcons = new WP_Query($args);\n\nif ($serviceIcons->have_posts() ) : \n  // Loop department posts\n  while ($serviceIcons->have_posts() ) : $serviceIcons->the_post();\n\n    get_template_part( 'template-parts/icon-grid-item' );\n\n  endwhile;\n          \nendif;\n\nwp_reset_postdata();\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403141", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Categories not posts at the frontpage can someone please help, i just need a way to display only categories at the frontpage without posts, visitor will enter the website first what he see is the categories , searched all over the web without success\nthanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403144", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP Rest Api- Update callback (POST request) to existing database table through the rest api I have registed a new rest route to existing database table called wpso_messages. I was able to create a get_callback function that fetches all the data from the database.\nI want to add a POST request functionality, that allows me to introduce new data rows to the wpso_messages table through the rest api. Any advise how to accomplish that?\nbelow is my code for registering the rest route and get_callback:\n<?php\n\n\n\nfunction get_wp_query() {\n    global $wpdb;\n    $rows = $wpdb->get_results(\"SELECT * FROM wpso_messages\");\n    foreach( $rows as $index => $row ) {\n    \n           $user_from_id = $rows[$index]->user_from; \n           $user_to_id = $rows[$index]->user_to; \n           $rows[$index]->username_from = get_user_by('id', $user_from_id)->display_name;\n           $rows[$index]->username_to = get_user_by('id', $user_to_id)->display_name;\n    }\n    return $rows;\n};\nadd_action( 'rest_api_init', function () {\n    register_rest_route( 'wp/v2', 'messages', array(\n        'methods' => 'GET',\n        'callback' => 'get_wp_query'\n        ) );\n    } );\n\nFor the POST request, below is an example of an input json to create new entry in the wpso_messages table:\n{\"user_from\": \"82\", \"user_to\": \"1\", \"message\": \"Iam interested to bid\", \"listing_id\": \"22775\"}\n\nFinal Solution based on Sally C.J answer:\nNote that it includes few checks such as that user ids are valid and that the key values in the json body are in the SQL database columns.\n#GET request function\n\nfunction get_wp_query() {\n    global $wpdb;\n    $rows = $wpdb->get_results(\"SELECT * FROM wpso_messages\");\n    foreach( $rows as $index => $row ) {\n    \n           $user_from_id = $rows[$index]->user_from; \n           $user_to_id = $rows[$index]->user_to; \n           $rows[$index]->username_from = get_user_by('id', $user_from_id)->display_name;\n           $rows[$index]->username_to = get_user_by('id', $user_to_id)->display_name;\n           $rows[$index]->author= array('Welcome'=>'Home');\n    }\n    return $rows;\n};\n\n#POST request arguments validation\n\nfunction my_create_item_args() {\n    return array(\n        'user_from' => array(\n            'required'          => true,\n            'validate_callback' => function ( $param ) {\n                return is_numeric( $param );\n            },\n        ),\n        'user_to' => array(\n            'required'          => true,\n            'validate_callback' => function ( $param ) {\n                return is_numeric( $param );\n            },\n        ),\n        'message'   => array(\n            'required'          => true,\n            'sanitize_callback' => function ( $param ) {\n                // this allows basic HTML tags like <strong> and <em>\n                #return wp_filter_kses( $param );\n\n                // this allows line breaks, but strips all HTML tags\n                return sanitize_textarea_field( $param );\n            },\n        ),\n        'listing_id' => array(\n            'required'          => true,\n            'validate_callback' => function ( $param ) {\n                return is_numeric( $param );\n            },\n        ),\n        ''\n        // ... other args.\n    );\n}\n\n#Post request function\nfunction post_function( WP_REST_Request $request ) {\n\n\n\n    #getting json body\n    $body = $request->get_json_params();\n    \n    #checking if there is an invalid entry otherwise it wont be processed (example unseen)\n    $valid_entries=[\"user_from\",\"message\",\"user_to\",\"listing_id\",\"seen\"];\n    foreach( $body as $keysx1=>$valuesx1 ) {\n        if (in_array($keysx1, $valid_entries, true)) {\n        \n        } else {\n        return new WP_Error( 'invalid entry', __($keysx1 . ' is an invalid entry'), array( 'status' => 400 ) );\n        }\n    }\n    \n    #######Checking users\n    $users = get_users();\n    foreach( $users as $user ) {\n        // get user names from the object and add them to the array\n        $useridlist[] = $user->id;\n    }\n    $userfromx1=$body['user_from'];\n    $usertox1=$body['user_to'];\n    #Checking sender and reciever are not same\n    if ($userfromx1!=$usertox1) {\n        \n        } else {\n        return new WP_Error( 'invalid message', __('Sender and reciever cant be same'), array( 'status' => 400 ) );\n        }\n    #Checking userto and userfrom are in users list\n    if (in_array($userfromx1, $useridlist, true)) {\n        \n        } else {\n        return new WP_Error( 'invalid user id', __('user id specified in user_from is invalid'), array( 'status' => 400 ) );\n        }\n    \n    if (in_array($usertox1, $useridlist, true)) {\n        \n        } else {\n        return new WP_Error( 'invalid user id', __('user id specified in user_to is invalid'), array( 'status' => 400 ) );\n        }\n    \n    global $wpdb;\n    $body[\"created_at\"] = current_time('mysql');\n    $wpdb->insert('wpso_messages', $body);  \n    return $body;\n\n}\n\nadd_action( 'rest_api_init', function () {\n    register_rest_route( 'my-plugin/v1', 'messages', array(array(\n        'methods' => 'GET',\n        'callback' => 'get_wp_query'\n        ),\n        array(\n        'methods'  => 'POST',\n        'callback' => 'post_function',\n        'args'                => my_create_item_args(),\n        'permission_callback' => function () {\n        // This is just an example of checking the user's permissions..\n        return current_user_can( 'edit_posts' );\n    },)));\n    });\n\n\nA: \nI want to add a POST request functionality, that allows me to\nintroduce new data rows to the wpso_messages table through the rest\napi. Any advise how to accomplish that?\n\nYes, and note that I wrote this based on the official REST API handbook and the core endpoints.\nSo from the \"Routes and Endpoints \u2192 Routes vs Endpoints\" section \u2014 note the part I highlighted:\n\nA route is the \u201cname\u201d you use to access endpoints, used in the URL.\nA route can have multiple endpoints associated with it, and which is used depends on the HTTP verb.\n\nWhere \"HTTP verb\" here is essentially a HTTP request method like GET or POST.\nSo for example, the core /wp/v2/posts route has 2 endpoints \u2014 one with a GET method (for retrieving posts) and the other with a POST method (for creating a post).\nTherefore, you could follow the same approach, i.e. add an endpoint to your \"messages\" route, possibly with the POST method, like so:\n// I intentionally used my-plugin as the vendor name, and not \"wp\". See the\n// \"Additional Notes\" at the bottom in my answer.\nregister_rest_route( 'my-plugin/v2', 'messages', array(\n    // Endpoint 1 - list items.\n    array(\n        'methods'  => 'GET',\n        'callback' => 'get_wp_query',\n        // ... other args.\n    ),\n\n    // Endpoint 2 - create items.\n    array(\n        'methods'  => 'POST',\n        'callback' => 'my_create_item',\n        // ... other args.\n    )\n) );\n\nfunction my_create_item( WP_REST_Request $request ) {\n    // your code here...\n}\n\nThe actual code that performs the new row/data insertion will depend entirely on you, but you would want to use wpdb::insert().\nAdditional Notes\n\n*\n\n*A route's namespace is composed of <vendor name>/<version>, and you should use your own vendor name, e.g. my-plugin, and not wp. So my-plugin/v2 is good, but wp/v2 shouldn't be used.\nBecause the \"Routes and Endpoints \u2192 Namespaces\" section stated:\n\nDo not place anything into the wp  namespace unless you are making endpoints with the intention of merging them into core.\n\n\n\n*Remember to always set a permission callback for your endpoints.\nSee \"Routes and Endpoints \u2192 Permissions Callback\" and \"Adding Custom Endpoints \u2192 Permissions Callback\" for more details, but for REST API routes that are intended to be public, one can use __return_true() as the permission callback, i.e. 'permission_callback' => '__return_true'.\n\n\n*You would also want to register your endpoint arguments using the args key, and set a validate and sanitize callback which will validate/sanitize the arguments. E.g.\n\n*\n\n*The args for Endpoint 2 above:\n// Endpoint 2 - create items.\narray(\n    'methods'             => 'POST',\n    'callback'            => 'my_create_item',\n    'permission_callback' => function () {\n        // This is just an example of checking the user's permissions..\n        return current_user_can( 'edit_posts' );\n    },\n    'args'                => my_create_item_args(),\n)\n\n\n\n*The my_create_item_args() function:\nfunction my_create_item_args() {\n    return array(\n        'user_from' => array(\n            'required'          => true,\n            'validate_callback' => function ( $param ) {\n                return is_numeric( $param );\n            },\n        ),\n        'message'   => array(\n            'required'          => true,\n            'sanitize_callback' => function ( $param ) {\n                // this allows basic HTML tags like <strong> and <em>\n                return wp_filter_kses( $param );\n\n                // this allows line breaks, but strips all HTML tags\n//              return sanitize_textarea_field( $param );\n            },\n        ),\n        // ... other args.\n    );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403148", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ACF flexible content block not showing on live site (works locally) I've made a flexible content section in ACF for a specific category that allows the user to post text and different image galleries onto their post.  This all works perfectly whilst I'm on my localhost but now I've uploaded the site none of the content is showing.\nMy code is quite messy but the code in my single.php is below and this is the link to a live post https://www.exoticsoftware.co.uk/2021/12/01/pendas-fen/, the only things that show on the page are the post thumbnail (haven't added a post thumbnail to this, so that's why that's missing) and the post title, there's also a section at the bottom which should loop through two other posts but that isn't showing, the footer also isn't showing on this page but does work on other pages?\nWhen I inspect the page none of the code is there - I don't understand what is missing that is causing this to work fine locally and then not at all on the live site.,\n<main id=\"primary\" class=\"site-main\">\n\n    <div class=\"article\">\n        \n        \n\n        <div class=\"article-lead-image\">\n            <div class=\"\"><?php echo the_post_thumbnail();?></div>\n        </div>\n\n\n        <div class=\"article-title\">\n            <?php\n                if ( is_singular() ) :\n                    the_title( '<h1 class=\"entry-title\">', '</h1>' );\n                else :\n                    the_title( '<h2 class=\"entry-title\"><a href=\"' . esc_url( get_permalink() ) . '\" rel=\"bookmark\">', '</a></h2>' );\n                endif; \n            ?>\n        </div>\n\n\n        <div class=\"article-info\">\n            <div class=\"article-author\">\n                By&nbsp;<?php echo get_field(author); ?>\n            </div>\n            <div class=\"article-date\">\n                <?php echo the_date( 'dS F Y' ); ?>\n            </div>\n        </div>\n\n\n        <div class=\"article-content\">\n            <!-- if we have some flexible content, let\u2019s loop through it -->\n            <?php if( have_rows('content') ): while ( have_rows('content') ) : the_row();\n            // if it\u2019s a header, go through the data\n            if( get_row_layout() == 'text_block' ): ?>\n                <!-- data shared from our ero -->\n                <div class=\"article-text\">\n                    <?php the_sub_field('text'); ?>\n                </div>\n                \n            <!-- if it\u2019s a text component, show us the data -->\n            <?php elseif( get_row_layout() == 'quote_block' ): ?>\n\n                <div class=\"article-quote\">\n\n                    <?php the_sub_field('quote'); ?>\n\n                </div>\n\n            <?php elseif( get_row_layout() == 'large_image' ): ?>\n\n                    <div class=\"large_image\">\n                        <?php $images = get_sub_field('large_image'); ?>\n                        <?php foreach ($images as $image) : ?>\n                            <?php echo wp_get_attachment_image($image['id'], 'full' ); ?>\n                        <?php endforeach; ?> \n                    </div>\n\n\n                \n            <?php elseif( get_row_layout() == 'medium_image' ): ?>\n\n                    <div class=\"medium_image\">\n                        <?php $images = get_sub_field('medium_image'); ?>\n                        <?php foreach ($images as $image) : ?>\n                            <?php echo wp_get_attachment_image($image['id'], 'full' ); ?>\n                        <?php endforeach; ?> \n                    </div>      \n            \n            <?php elseif( get_row_layout() == 'two_images' ): ?>\n\n                    <div class=\"two_images\">\n                        <?php $images = get_sub_field('two_images'); ?>\n                        <?php foreach ($images as $image) : ?>\n                            <div class=\"image-container2\"><div class=\"container-2\"><?php echo wp_get_attachment_image($image['id'], 'full' ); ?></div></div>\n                        <?php endforeach; ?> \n                    </div>      \n\n\n            <?php elseif( get_row_layout() == 'three_images' ): ?>\n\n                    <div class=\"three_images\">\n                        <?php $images = get_sub_field('three_images'); ?>\n                        <?php foreach ($images as $image) : ?>\n                            <div class=\"image-container3\"><div class=\"container-3\"><?php echo wp_get_attachment_image($image['id'], 'full' ); ?></div></div>\n                        <?php endforeach; ?> \n                    </div>  \n\n\n\n                <?php endif; \n            endwhile; endif; ?>\n\n\n        </div>\n\n\n\n        <div class=\"read-more\">\n\n            <div class=\"title\">Read more</div>\n\n            <div class=\"read-more-loop\">\n                <div class=\"container-readmore\">\n                <?php\n                $args = array(\n                    'posts_per_page' => 2,\n                    'orderby' => 'rand', \n                    'post__not_in' => array($post->ID)\n                );\n                $query = new WP_Query ($args);\n                if ($query-> have_posts()): while ($query->have_posts()): $query->the_post();?>\n\n\n                <a href=\"<?php the_permalink(); ?>\">\n\n                    <div class=\"thumbnail\">\n                        <?php exotic_post_thumbnail(); ?>\n                    </div>\n                    \n                    <div class=\"entry-header\">\n                        \n                        <div class=\"read-more-title\">\n                            <?php\n                            if ( is_singular() ) :\n                                the_title( '<h1 class=\"entry-title\">', '</h1>' );\n                            else :\n                                the_title( '<h2 class=\"entry-title\"><a href=\"' . esc_url( get_permalink() ) . '\" rel=\"bookmark\">', '</a></h2>' );\n                            endif; ?>\n                        </div>\n\n            \n                        <div class=\"read-more-info\">\n                            <div class=\"read-more-author\">\n                                By&nbsp;<?php echo get_field(author); ?>,\n                            </div>\n                            <div class=\"read-more-date\">\n                                <?php echo get_the_date( 'dS F Y' ); ?>\n                            </div>\n                        </div>\n\n                    </div><!-- .entry-header -->\n        \n                </a>\n\n                <?php endwhile; endif; ?>\n                        </div>\n            </div>\n        </div>\n\n\n\n\n    </div>\n\n</main><!-- #main -->\n\n\nA: Seems like you have a PHP error.\nTry adding this to the top of your php file that you are having an issue with.\n<?php\nini_set('display_errors', '1');\nini_set('display_startup_errors', '1');\nerror_reporting(E_ALL);\n?>\n\nYou can also open your wp-config.php and change\ndefine('WP_DEBUG', false);\n\nto\ndefine('WP_DEBUG', true);\n\nAlso, it looks like you site is already working.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403149", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I completely disable a WordPress installation? I would like to completely disable a Wordpress website. I'd like it to be completely inaccessible to visitors, and have no activity taking place on the server (no updates, cron jobs, etc.) I'd like to do this in a non-destructive manner, so that I can access the files if I need to (via FTP), or even re-enable the site at a future date.\nIn other words, \"put it in mothballs.\"\nI've tried searching but only come up with \"maintenance mode\" solutions, in which there is still activity on the server.\nCan I do something simple, for example: rename index.php in the root folder, to index-disabled.php? Are there any other options, besides deleting the entire contents of the site? What is the best and safest way to do this?\n(SEO is of no concern.)\n\nA: You could move the files to a non-web-accessible directory and change the password on the database user.\neg, if your site's root directory is /var/www/html, you could create a directory elswhere on the server (say /home/me/site-archive) and move the files from /var/www/html into /home/me/site-archive.\nIf you ever want to re-activate the site, you can move the files from /home/me/site-archive back to /var/www/html, and set the database user's password back to what you find in wp-config.php (or update wp-config.php to use the new password).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403152", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is there a way to check for an attribute of a script when using script_loader_tag? The block of code adds the attribute async to a array of Javascript files.\nIs there a way to check if the files have already have the attribute assigned and if yes, to skip it?\nfunction async_scripts( $tag, $handler, $src ) {\n    \n    /**\n     * An array of JavaScripts files. The value should be the filename.\n     */\n    $scripts = array(\n        'script_one.js',\n        'script_two.js'\n    );\n    \n    /**\n     * Loop through each file in the $scripts array and add an async option.\n     */\n    foreach ( $scripts as $script ) {\n\n        if ( true == strpos( $tag, $script ) )\n        return str_replace( ' src', ' async src', $tag );\n    }\n\n    return $tag;\n\n}\nadd_filter( 'script_loader_tag', 'async_scripts', 10, 3 );\n\nI tried looping through global $wp_scripts however it doesn't appear to work with script_loader_tag\nforeach( $wp_scripts->registered as $script ) {\n            if ( ! empty( $script->extra['async'] ) && $script->extra['async'] === true ) {\n                return $tag;\n            }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403155", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to upload images in a specific folder using API I have installed wordpress plugins Real Media library, Real Physical Media, and Media file renamed. Using this I am able to physically move images and organize images in the upload folder as per categories.\nBoth these plugins have API -\nhttps://docs.devowl.io/real-media-library/api/index.html\nhttps://docs.devowl.io/real-physical-media/api/index.html\nbut they don't seem to provide any option to upload files.\nIt means for uploading I still need to use the classic Wordpress rest API.\nSo how do I then physically move the files, do I upload using classic way, and the images get uploaded in the date file structure format, and use a second API call to move those uploaded images? Or directly while uploading itself I can set the destination folder.\n\nA: The problem is solved.\nActually in the regular Wordpress API for uploading media\nwp/v2/media\nplease add one more form data entry rmlFolder: <the_id_of_destination_folder>\nThat is all, it gets uploaded in the correct folder.\nI am posting my code (in Java based on a library not written by me)\n\nAfter the patch\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403156", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: My wordpress website does not show 404 page and results in http 500 error My wordpress website does not show 404 page and results in http 500 error when I search a particular query and the results are not available. For any page if the results are not available, it shows http 500 error.\nIf I change the theme, everything comes back to normal.\n\nA: Since changing your theme makes everything come back to normal, then, basically, it means the problem is from the theme you wish to use.\nIt looks like the theme is missing templates that should show up upon returning 'no results' for your query, or, there are errors in the template(s) supposed to display.\nThis scenario should show a 'no results' template and not really a 404 page.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403160", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sort scheduled posts in ascending order by default I have a self-hosted WordPress blog (5.9).  When I go to view scheduled posts, I want the default sort order to have the soonest scheduled posts on top.\nI can do this by manually hitting the date column header, or by visiting /wp-admin/edit.php?post_status=future&post_type=post&orderby=date&order=asc\nI have lots of posts scheduled for the far future. But I mostly want to see what I've got being published next week.\nIs there an action I can add to my theme - or a setting I can change - which alters the default sort for scheduled posts only?\n\nA: \nWhen I go to view scheduled posts, I want the default sort order to\nhave the soonest scheduled posts on top.\n\nThe posts by default are indeed being sorted by the post date in descending order, so if you want the order be ascending instead, then there's no admin setting for that, but you can use the pre_get_posts hook like so:\nadd_action( 'pre_get_posts', 'my_admin_pre_get_posts' );\nfunction my_admin_pre_get_posts( $query ) {\n    // Do nothing if the post_status parameter in the URL is not \"future\", or that\n    // a specific orderby (e.g. title) is set.\n    if ( ! isset( $_GET['post_status'] ) || 'future' !== $_GET['post_status'] ||\n        ! empty( $_GET['orderby'] )\n    ) {\n        return;\n    }\n\n    // Modify the query args if we're on the admin Posts page for managing posts\n    // in the default \"post\" type.\n    if ( is_admin() && $query->is_main_query() &&\n        'edit-post' === get_current_screen()->id\n    ) {\n        $query->set( 'orderby', 'date' ); // default: date\n        $query->set( 'order', 'ASC' );    // default: DESC\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403162", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Accessing an instanciated class I've a PHP  class doing stuff:\n<?php\n\n\nclass Cart {\n\n    //....\n}\n\n$cart = new Cart();\n$cart->init();\n\nfunction deposit_total(){\n    global  $cart;\n    $totals = array_sum( $cart::$deposits );\n    return $totals;\n}\n\n\nHow is possible to use the $cart just instanciated in a function (deposit_total()) outside the class ?\nThank you\n\nA: I've done something like that:\n<?php\n\n\nclass Cart {\n    protected static $_instance = null;\n\n    public static function instance() {\n        if ( is_null( self::$_instance ) ) {\n            self::$_instance = new self();\n        }\n        return self::$_instance;\n    }\n    //....\n}\n\n$cart = new Cart();\n$cart->init();\n\nfunction EVA_Cart() {\n    return Cart::instance();\n}\n\nfunction deposit_total(){\n    $cart = EVA_Cart();\n    $totals = array_sum( $cart->deposits );\n    return wc_price( $totals );\n}\n\nIs it the best way ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403163", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to secure wordpress website from google dorking can anyone explain how can we secure any wordpress based website from google dorking? the wordpress website enables REST api like any other websites and it shows a JSON file always now the point is how can we secure website from google Dorking from exposing personal information eg. pdf files and db password or wp-config.php file information etc. is there any specific official wordpress patchset available for this?\ngoogle dorking\n\nA: There is an extremely high chance that this article is stoking the paranoia. It's correct but only in the strictest of senses. In practicality it's just a fancy name for \"when you leak things that aren't meant to be public, people who saw it might tell you if you ask them\", but specifically Google.\nGoogle dorking is just a fancy name for \"searching the google bot cache\". It cannot reveal data that has never been made publicly available on your site, and it is not a secret backdoor to uncover previously unavailable secrets.\n\ncan anyone explain how can we secure any wordpress based website from google dorking?\n\nDon't expose confidential information, and when it is exposed notify those affected as you're required to be law/regulations. Invalidate change or revoke anything that does get leaked. This is no different for things in google cache or just if there's a security breach on your site.\n\nthe wordpress website enables REST api like any other websites and it shows a JSON file\n\nNo JSON files are involved in the REST API, just like there is no file for each blog post.\n\nalways now the point is how can we secure website from google Dorking from exposing personal information eg. pdf files\n\nGoogle dorking can only expose information that has already been exposed. If that data is exposed then it is already too late. Otherwise you need to ask in a Google community how to remove search results.\n\nand db password or wp-config.php file information etc.\n\nThis would only happen if you had suffered a massive security breach. If this happened you would need to change all your database details immediatley and reset all passwords. You can't just hide secrets, once they are out it is too late and they must be changed.\nIf at any point your wp-config.php is being served as a text file and not a PHP file then you have suffered a major security breach and must notify your host, invalidate the database details, fix the problem, then apply new details once it is re-secured. It is not possible to get the contents of wp-config.php via google dorking unless you have suffered this kind of breach.\n\nis there any specific official wordpress patchset available for this?\n\nNo, and asking for one doesn't make sense because there is no vulnerability to fix. Short of just blocking Google and disappearing from search results.\nGoogle Dorking is not a way to exploit code to reveal secrets, it's just a fancy name for browsing cached data from Google. It's like asking if there is a patch for WordPress that fixes the way back machine\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403166", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to resolve error after installing plugin? Topic to close. I find errors in my scripts, there was a tons of them like onchange  instead of onChange and many more syntax.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403171", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Table Sorter sort by span title? I'm using table sorter plugin to sort a table on my website.\nOne column has only unsortable signs as content.\nHowever I'm trying to sort this column by value.\nIt's the column IMDb here: https://flimmerzimmer.eu/filmothek/\nSo I added span title to the span with corresponding value but it's not sortable.\nAny ideas how to sort this column?\n\nA: Just added:\n\"<p style=\\\"display: none;\\\">\" . $rating . \"</p>\";\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403172", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Thumbnails not being generated for PDF files I have installed all the required extensions like ImageMagick, Imagick, and Ghostscript. I used a plugin to test the requirements and everything passed.\nImageMagick:     Installed\nImagick:     Installed\nGhostscript:     Installed\nWordPress >= 4.7:    Installed\n\nGPL Ghostscript 9.27 (2019-04-04)\nBut for some reason, WordPress does not generate thumbnails for PDF files while uploading them directly from the media manager or from the post editor. I also tried using the Regenerate Thumbnails plugin but it did not scan for the PDF file.\nI have hosted my website on the Plesk server. Is there anything that I might be missing?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403175", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding an \"Upgrade Subscription\" button to an Elementor page I'm working on a website with Woocommerce Subscriptions and Elementor Pro. What I'm only trying to achieve is to add an \"Upgrade Subscription\" button to one of the pages.\nSomeone has already gave me an idea from stackoverflow on how to do this, but I just don't know on how to work on this since I'm still not that good in PHP. This is partial description of my post from the other website:\n\nThe subscription is under a variable product that has Monthly and Yearly options. As far as I know, upgrading a product is different from buying the subscription again with a higher value since the URL for switching has the the additional \"?switch-subscription=XXXX&item=XX&_wcsnonce=XXXXXXXXXX\" included in the address that is uniquely different per user. I just want to know if it's possible to generate the proper URL for subscription switching so that I can add that link to a button, or a better workaround.\n\nI would really appreciate it if someone can guide me with this (especially on how to implement the code in Elementor. Thanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403178", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: override plugin function in a class not working there is a class \"CUSTOM_WC_REST_Orders_Controller\" called in a plugin like that:\nadd_action('woocommerce_init', 'woocommerce_mstore_init');\n    function woocommerce_mstore_init()\n    {\n        include_once plugin_dir_path(__FILE__) . \"controllers/flutter-order.php\";\n    }\n\nwhile in that flutter-order.php the code is\nclass CUSTOM_WC_REST_Orders_Controller extends WC_REST_Orders_Controller\n    {\n        bla bla bla\n        function create_new_order($request)\n        {\n             bla bla bla\n        }\n\n    }\nnew CUSTOM_WC_REST_Orders_Controller();\n\nin my custom plugin I have tried to do this ( but it's not working at all )\nadd_action('woocommerce_init', 'hmp_custom_woocommerce_mstore_init', 999);\nfunction hmp_custom_woocommerce_mstore_init(){\nif (!class_exists('CUSTOM_WC_REST_Orders_Controller') ) {\n    return;\n}\nclass hmp_CUSTOM_WC_REST_Orders_Controller extends CUSTOM_WC_REST_Orders_Controller\n{\n    function create_new_order($request)\n    {\n        return(\"test44\");\n        \n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403182", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What is the significance of 'root' in getEntityRecords? I've gone through the documentation and the source code but I couldn't understand.\nI have 2 queries:\ngetEntityRecords( 'postType', 'post' ); and getEntityRecords( 'root', 'user' ).\n\n*\n\n*Why does the 2nd query require root as the 1st argument?\n\n*What does it mean?\n\n*How to determine when to use it?\n\nThe doc describes the parameters of getEntityRecords as following:\nParameters:\n\n*\n\n*state Object: State tree\n\n*kind string: Entity kind.\n\n*name string: Entity name.\n\n*query ?Object: Optional terms query.\n\n\n\n*Are postType and root both state trees?\n\n*How does state relate to kind while referring to entities.js?\n\n\nA: The important thing to note is that post is a kind/sub-type of the post types entity, all posts regardless of type share the same table and general data structure and fields etc.\nThis contrasts with other major entity types such as comments or users.\nHowever, what if there is no kind or sub-type? What if your entity is a user? What would you put as the entity kind/sub-type? There is only 1 kind of user! So you go one level up, and that's where root comes from.\nIt's also useful to know that entities are very related to the REST API and endpoints, and that this is the only connection to the PHP side of things. Entities only exist in the WP javascript packages. It's possible to use the REST API and javascript without referring to entities on the frontend, but if you're working with the block editor it's highly relevant.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403183", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Pagination on template page for custom query redirecting to index.php I'm building my first theme and have a template page \"page-blog\" with a custom wp_query. I've tried adding pagination to the query but so far the pagination redirects to the index page. As expected the url structure shows /blog/page/2.\nWhat am I doing wrong here? Do I need to just create my own pagination method?\n<div class=\"blog-listings\">\n        <?php\n            $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n            $args = array(\n                'post_type' => 'blog',\n                'post_status' => 'publish',\n                'posts_per_page' => '2',\n                'paged' => $paged,\n                'orderby' => 'date',\n            );\n            $blog_loop = new WP_Query( $args );\n            if ($blog_loop->have_posts()) : \n                while ($blog_loop->have_posts()) : $blog_loop->the_post();\n                    include('template-parts/content/content-single-blog.php');\n                endwhile;\n                $total_pages = $blog_loop->max_num_pages;\n\n                if ($total_pages > 1){\n\n                    $current_page = max(1, get_query_var('paged'));\n\n                    echo paginate_links(array(\n                        'base' => get_pagenum_link(1) . '%_%',\n                        'format' => '/page/%#%',\n                        'current' => $current_page,\n                        'total' => $total_pages,\n                        'prev_text'    => __('prev'),\n                        'next_text'    => __('next'),\n                    ));\n                }    \n                wp_reset_postdata();\n            endif;\n        ?>\n    </div>\n\n\nA: Ok the issue was that the page slug was the same name as the post type. Changing the post type from 'blog' to 'blogposts' solved it.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403188", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Append a query string to the end of every URL I'm trying to append a query string to the end of every URL for logged in users for cache busting purposes. Here is the code I have but it doesn't seem to work. Any ideas?\nfunction add_admin_qs($url){\n    if ( is_user_logged_in() ) {\n        return add_query_arg('nocfcache', 'true', $url);\n    }\n}\n    \nif ( is_user_logged_in() ) {\n    add_filter( 'home_url', 'add_admin_qs', 11, 1);\n    add_filter( 'post_link', 'add_admin_qs', 10, 1);\n    add_filter( 'page_link', 'add_admin_qs', 10, 1);\n    add_filter( 'post_type_link', 'add_admin_qs', 10, 1);\n    add_filter( 'category_link', 'add_admin_qs', 11, 1);\n    add_filter( 'tag_link', 'add_admin_qs', 10, 1);\n    add_filter( 'author_link', 'add_admin_qs', 11, 1);\n    add_filter( 'day_link', 'add_admin_qs', 11, 1);\n    add_filter( 'month_link', 'add_admin_qs', 11, 1);\n    add_filter( 'year_link', 'add_admin_qs', 11, 1);\n}\n\n\nA: The problem is that I used the wrong type of quote marks. You cannot see it in my first post because apparently they were changed when I pasted in the code.\n\n\nA: Does\nfunction add_admin_qs($url){\n    if ( is_user_logged_in() ) {\n        return add_query_arg('nocfcache', 'true', $url);\n    }\n}\n\nadd_action( 'plugins_loaded', function(){   \nif ( is_user_logged_in() ) {\n    add_filter( 'home_url', 'add_admin_qs', 11, 1);\n    add_filter( 'post_link', 'add_admin_qs', 10, 1);\n    add_filter( 'page_link', 'add_admin_qs', 10, 1);\n    add_filter( 'post_type_link', 'add_admin_qs', 10, 1);\n    add_filter( 'category_link', 'add_admin_qs', 11, 1);\n    add_filter( 'tag_link', 'add_admin_qs', 10, 1);\n    add_filter( 'author_link', 'add_admin_qs', 11, 1);\n    add_filter( 'day_link', 'add_admin_qs', 11, 1);\n    add_filter( 'month_link', 'add_admin_qs', 11, 1);\n    add_filter( 'year_link', 'add_admin_qs', 11, 1);\n}\n});\n\nI think the main problem is you're loading your code at the WP load and maybe before you're really logged in for WP.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403191", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: can't add EVENT LISTENER to a element I'm trying to add a click eventListener to a element in homepage, it doesn't work. the event is not even added to the element.\n\nthe above picture shows the html of the homepage. where I wanted to add click eventListener to li element with id = \"menu-item-297\". 1st I tried to add the click event using browser console.\n\nstill nothing changed in homepage. homepage remain same like the 1st image. I'm using woostify theme. so I checked their source code. the navbar uses navigation.min.js script. so I explore the source code and add the same eventListener code there. saved and refresh. yet still nothing change. no eventListener is added to the li element.\nhere is the navigation.min.js code\n/**\n * Navigation.js\n *\n * @package woostify\n */\n\n'use strict';\n\n\n// Open Menu mobile.\nfunction nav() {\n    \n    \n    var menu = document.getElementById(\"menu-item-297\");\n    menu.addEventListener(\"click\", function(e){console.log(\"clicked\");});\n        \n    var menuToggleBtn = document.getElementsByClassName( 'toggle-sidebar-menu-btn' );\n\n    if ( ! menuToggleBtn.length ) {\n        return;\n    }\n\n    for ( var i = 0, j = menuToggleBtn.length; i < j; i++ ) {\n        menuToggleBtn[i].addEventListener(\n            'click',\n            function() {\n                document.documentElement.classList.add( 'sidebar-menu-open' );\n                closeAll();\n            }\n        );\n    }\n}\n\n// Accordion menu on sidebar.\nfunction sidebarMenu( node ) {\n    \n    \n    var menu = document.getElementById(\"menu-item-297\");\n\n    menu.addEventListener('click',function(e){\n      console.log('clicked');\n    });\n    \n    \n    var selector = ( arguments.length > 0 && undefined !== arguments[0] ) ? jQuery( node ) : jQuery( '.sidebar-menu .primary-navigation' ),\n        arrow    = selector.find( '.arrow-icon' );\n\n    jQuery( arrow ).on(\n        'click',\n        function( e ) {\n            e.preventDefault();\n\n            var t        = jQuery( this ),\n                siblings = t.parent().siblings( 'ul' ),\n                arrow    = t.parent().parent().parent().find( '.arrow-icon' ),\n                subMenu  = t.parent().parent().parent().find( 'li .sub-menu, li .sub-mega-menu' );\n\n            if ( siblings.hasClass( 'show' ) ) {\n                siblings.slideUp(\n                    200,\n                    function() {\n                        jQuery( this ).removeClass( 'show' );\n                    }\n                );\n\n                // Remove active state.\n                t.removeClass( 'active' );\n            } else {\n                subMenu.slideUp(\n                    200,\n                    function() {\n                        jQuery( this ).removeClass( 'show' );\n                    }\n                );\n                siblings.slideToggle(\n                    200,\n                    function() {\n                        jQuery( this ).toggleClass( 'show' );\n                    }\n                );\n\n                // Add active state for current arrow.\n                arrow.removeClass( 'active' );\n                t.addClass( 'active' );\n            }\n        }\n    );\n}\n\n// Fallback for other dev.\nfunction navFallback() {\n    if ( window.matchMedia( '( min-width: 992px )' ).matches ) {\n        return;\n    }\n\n    var userArgent = navigator.userAgent;\n\n    if ( userArgent && ( userArgent.includes( 'Android' ) || userArgent.includes( 'Mobile' ) ) ) {\n        return;\n    }\n\n    document.documentElement.classList.remove( 'cart-sidebar-open', 'sidebar-menu-open' );\n}\n\ndocument.addEventListener(\n    'DOMContentLoaded',\n    function() {\n        nav();\n        sidebarMenu();\n    }\n);\n\nwindow.addEventListener( 'resize', navFallback );\n\nI'm new to wordpress. what mistake I'm making? by the way I'm trying to add a click event to a woostify theme navigation bar. do theme override my code? I don't what happening. can someone explain whats going on. thanks :)\n\nA: I fix this myself. I don't know I'm right or wrong. In Wordpress plain JS script doesn't work. I don't know why.\nI tried to solve the above mentioned problem using jQuery and it worked. both are JS only.but still I don't know why. I'm begineer.\ncheck below image:\n\nthe event is added successfully:\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403192", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: Turn off display for custom sidebar post widget when on the post it's displaying Hope my title makes sense, I've attached a picture for what I mean.\nI'm trying to use a simple bit of CSS.\nbody.page-id-60748, .widget_its-single-post {\n     display: none !important;\n}\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403196", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Which WordPress hook fires after post content loaded? Is there any hook that fires after post contents load? before comments and ...\nI need to add an element at the bottom of the post content.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403197", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to check if a WordPress core block is active in sidebar I have a widget area and I want to enqueue a stylesheet only if a core block is active in it. I tried the following code:\n// if has audio block.\nif (has_block('audio')) {\n    wp_enqueue_style('audio-css', get_template_directory_uri() . '/assets/css/audio.css');\n}\n\nAnd it kinda worked. The problem is it only works if the audio block is added in a post. But I want to check if the audio block is added to widget areas like the sidebar. And not just on a post but also on the front page if the block is active in the sidebar.\nI even tried the following code, but it didn't work.\nif (is_home()) {\n    if (has_block('audio')) {\n        wp_enqueue_style('audio-css', get_template_directory_uri() . '/assets/css/audio.css');\n    }\n}\n\nI'm hoping someone can help me solve this or point me in the right direction to solving this.\nThanks :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403200", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: why doesn't this update part of this plugin work? it take me to nothing here page Below is my plugin. Everything works except the update part. It will show the little table with the existing values and when I click on the update button in that little table, it takes me to Nothing Here page, instead of calling the page again.\nThe url doesn't update to the page url, it still has the parameter on the end of the url too. Thanks in advanced for your time.\nDean-O\n<?php\n/*\nPlugin Name: deano CRUD Operations\nPlugin URI: \nDescription: A simple plugin that allows you to perform CRUD operations on custom database table\nVersion: 1.0.0\nAuthor: Dean-O\nAuthor URI: \nLicense: GPL2\n*/\n\n\n\n\nfunction deanocrud() {\n  global $wpdb;\n  //$table_name = $wpdb->prefix . 'books';\n  $table_name = 'books';\n\n  // get current user ID, with default value, if empty\n  $current_user_id = get_current_user_id();\n  error_log('current_user_id '.$current_user_id);\n\n  if (isset($_POST['newsubmit'])) {\n\n    error_log('newsubmit here');\n    $wp_id = $_POST['wp_id'];\n    $title = $_POST['title'];\n    $author = $_POST['author'];\n    $wpdb->query(\"INSERT INTO $table_name(wp_id,title,author) VALUES('$wp_id','$title','$author')\");\n    //echo \"<script>location.replace('admin.php?page=crud.php');</script>\";\n    //wp_redirect( \"http://localhost/tadpolewp/deano-plugin-successful/\" );\n    //wp_redirect( \"http://localhost/tadpolewp/deano-crud/\" );\n        ?>\n    <script type=\"text/javascript\">\n      document.location.href=\"http://localhost/tadpolewp/deano-crud/\";\n  </script>\n  <?php\n    \n  }\n  if (isset($_POST['uptsubmit'])) {\n    error_log('uptsubmit here');\n    $id = $_POST['uptid'];\n    $title = $_POST['title'];\n    $author = $_POST['author'];\n    error_log('upt_id = '.$id);\n    error_log('title = '.$title);\n    error_log('author = '.$author);\n    $wpdb->query(\"UPDATE $table_name SET title='$title',author='$author' WHERE id='$id'\");\n    //echo \"<script>location.replace('admin.php?page=crud.php');</script>\";\n    //echo \"<script>location.replace('http://localhost/tadpolewp/deano-crud/');</script>\";\n          ?>\n    <script type=\"text/javascript\">\n      document.location.href=\"http://localhost/tadpolewp/deano-crud/\";\n  </script>\n  <?php\n    \n  }\n  if (isset($_GET['del'])) {\n    $del_id = $_GET['del'];\n    $wpdb->query(\"DELETE FROM $table_name WHERE user_id='$del_id'\");\n    //echo \"<script>location.replace('admin.php?page=crud.php');</script>\";\n    echo \"<script>location.replace('http://localhost/tadpolewp/deano-crud/');</script>\";\n  }\n  ?>\n  <div class=\"wrap\">\n    <h2>CRUD Operations</h2>\n    <table class=\"wp-list-table widefat striped\">\n      <thead>\n        <tr>\n          \n          <th width=\"25%\">USER_ID1</th>\n          <th width=\"25%\">__</th>\n          <th width=\"25%\">Title</th>\n          <th width=\"25%\">Author</th>\n          <th width=\"25%\">Actions</th>\n        </tr>\n      </thead>\n      <tbody>\n        <form action=\"\" method=\"post\">\n          <tr>\n            <td><input type=\"text\" value=\"AUTO_GENERATED\" disabled></td>\n            <td><input type=\"hidden\" name=\"wp_id\" value=\"<?php echo esc_attr( $current_user_id ); ?>\" ></td>\n    \n            <td><input type=\"text\" id=\"title\" name=\"title\"></td>\n            <td><input type=\"text\" id=\"author\" name=\"author\"></td>\n            <td><button id=\"newsubmit\" name=\"newsubmit\" type=\"submit\">INSERT</button></td>\n          </tr>\n        </form>\n        <?php\n          \n          $result = $wpdb->get_results(\"SELECT * FROM $table_name where wp_id='$current_user_id'\");\n          foreach ($result as $print) {\n            echo \"\n            \n              <tr>\n                \n                <td width='25%'>$print->wp_id</td>\n                <td width='25%'></td>\n                <td width='25%'>$print->title</td>\n                <td width='25%'>$print->author</td>\n                <td width='25%'><a href='index.php?page=deano-crud.php&upt=$print->id'><button type='button'>UPDATE</button> <a href='index.php?page=deano-crud.php&del=$print->id'><button type='button'>DELETE</button></a></td>\n              </tr>\n              \n           \";\n          }\n        ?>\n\n      </tbody>  \n    </table>\n    <br>\n    <br>\n    <?php\n      if (isset($_GET['upt'])) {\n        $upt_id = $_GET['upt'];\n        error_log('upt_id = '.$upt_id);\n        $result = $wpdb->get_results(\"SELECT * FROM $table_name WHERE id='$upt_id'\");\n        foreach($result as $print) {\n          $title = $print->title;\n          $author = $print->author;\n           error_log('title = '.$title);    \n           error_log('author = '.$author);\n           error_log('id = '.$print->id);\n        }\n        echo \"\n        <table class='wp-list-table widefat striped'>\n          <thead>\n            <tr>\n              <th width='25%'>ID</th>\n              <th width='25%'>Title</th>\n              <th width='25%'>Author</th>\n              <th width='25%'>Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            <form action='' method='post'>\n              <tr>\n                <td width='25%'>$print->id <input type='hidden' id='uptid' name='uptid' value='$print->id'></td>\n                <td width='25%'><input type='text' id='title' name='title' value='$print->title'></td>\n                <td width='25%'><input type='text' id='author' name='author' value='$print->author'></td>\n                <td width='25%'><button id='uptsubmit' name='uptsubmit' type='submit'>UPDATE</button> <a href='index.php?page=deano-crud'><button type='button'>CANCEL</button></a></td>\n              </tr>\n            </form>\n          </tbody>\n        </table>\";\n      }\n    ?>\n  </div>\n  <?php\n}\nadd_shortcode('deanocrud_sc','deanocrud');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403203", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Trying to link to a php template file but its blank From this Stack Overflow qestion It shows a bunch of ways to make page templates. But I don't want to use a page template that uses Gutenberg.\nIs there another way to make a PHP file like a tos.php, and link to it by\n<?php echo get_template_directory_uri() . '/tos.php'; ?>\nI tried to link the page that way but gives be a blank page.\n    <?php \n    /* Template Name: ghfjghjg*/\n\n    get_header();\n    ?>\n\n    <main id=\"primary\" class=\"site-main main-header\">\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor    incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\n\n    </main><!-- #main -->\n\n    <?php\n    get_footer();\n\nAlso tried, adding this to my functions.php.\nfunction include_TOS() {\n    return  __DIR__ . 'tos.php';\n\n}\napply_filters( 'template_include', 'include_TOS' );\n\n\nA: get_header() and get_footer() are WordPress functions, not native PHP. If the code snippet you've posted is the entire content of tos.php, you're not loading WordPress at all, the functions don't exist, and so tos.php is throwing a fatal error. It's likely that your web host is configured to not display fatal errors, so you see an entirely blank page.\nFurther: Gutenberg is an editor, and shouldn't affect the display of pages on the front end. If you're trying to specify that a given post or page should use your tos.php template, you should have a look at the template_include filter.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403206", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress add a rewrite rule to a page to accept a GET variable I want to rewrite\nmysite.com/events/submission/test-event-01\nto\nmysite.com/events/submission?epl=test-event-01\nThis is what I have done so far without any result. I get a 404 error (mysite.com/events/submission/test-event-01). Can anyone suggest the correct rule?\nadd_action( 'init', 'epl_rewrite');\nadd_filter( 'query_vars', 'epl_query_vars');\n        \nfunction epl_rewrite()\n{\n    add_rewrite_rule('^submission/([^/]*)[/]?', 'index.php?pagename=submission&epl=$matches[1]', 'top');\n}\n        \nfunction epl_query_vars( $query_vars )\n{\n    $query_vars[] = 'epl';\n    return $query_vars;\n}\n\nNote:\n\n*\n\n*Permalinks are re-saved to flush the rewrite rules.\n\n*mysite.com/events/submission page is already added.\n\nThank you in advance.\n\nA: Since 'submission' is a child page of 'events', the rewrite rule should include the parent path\nadd_rewrite_rule('events/([^/]*)/submission/?', 'index.php?pagename=events/submission&epl=$matches[1]', 'top');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403209", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I combine Wordpress default Tags and bbPress tags into one archive page? I'm trying to figure out how to combine two taxonomies?\nI've got three things going on:\n\n*\n\n*Tags from Buddyboss's Forums (Buddypress/bbpress)\n\n*Tags from The Events Calendar Pro\n\n*Tags from Wordpress's WP_TAGS\n\nThe events calendar uses the standard WP_TAGS that Wordpress blog posts also use, but the forums have their own tag type.\nI'd like to combine the tags so that clicking the same word takes you to one page, with forum discussions, blog posts, and events related to that tag.\nIs this possible?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403216", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to backup just pages from my site, but not posts with other post_type values I want to backup just pages from my site, but not posts with other post_type values, so my first question is \u2013 will this do the trick?\n\n*\n\n*enter cPanel phpMyAdmin\n\n*filter the table wp_posts for post_type=page\n\n*export it as a SQL command\n\n*in case of need, import that SQL command\n\nMy knowledge of SQL is basic (and PHP zero), so I\u2019m afraid exported SQL command on import will drop the table and create a new table just with backed-up pages, while my intention is to insert/overwrite backed-up pages and keep everything else in the table as it was.\nMy second question: is the whole content of a page in this table, or maybe some parts are kept in some other WP tables and interconnected through IDs with wp_posts? In other words, is manipulating wp_posts enough for backup and restore of pages?\n3rd question \u2013 I found no plugin that is doing exactly this job, or that can be easily modified to do it. Do you know any?\nOr, is there some other way this SQL job can be automatized on WordPress or cPanel?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403217", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom PLU field in woocommerce email I have added my custom PLU field to the woocommerce product. I need to add this field to admin email after order. Im not sure how to do it. Thank you for any help\nfunction woocommerce_render_plu_field() {\n\n$input   = array(\n'id'          => '_plu',\n'label'       => sprintf(\n'<abbr title=\"%1$s\">%2$s</abbr>',\n_x( 'Vlastny identifikator', 'field label', 'my-theme' ),\n_x( 'PLU', 'abbreviated field label', 'my-theme' )\n),\n'value'       => get_post_meta( get_the_ID(), '_plu', true ),\n'desc_tip'    => true,\n'description' => __( 'Vlastny identifikator (PLU, UPC, EAN, ISBN, atd.)', 'my-theme' ),\n);\n?>\n<div id=\"plu_attr\" class=\"options_group\">\n      <?php woocommerce_wp_text_input( $input ); ?>\n</div>\n<?php\n}\n\nadd_action( 'woocommerce_product_options_inventory_product_data', 'woocommerce_render_plu_field' );\n\n/**\n* Save the product's PLU number, if provided.\n*\n* @param int $product_id The ID of the product being saved.\n*/\n\nfunction woocommerce_save_plu_field( $product_id ) {\nif (\n      ! isset( $_POST['_plu'], $_POST['woocommerce_meta_nonce'] )\n       || ( defined( 'DOING_AJAX' ) && DOING_AJAX )\n       || ! current_user_can( 'edit_products' )\n       || ! wp_verify_nonce( $_POST['woocommerce_meta_nonce'], 'woocommerce_save_data' )\n) {\n     return;\n}\n$plu = sanitize_text_field( $_POST['_plu'] );\nupdate_post_meta( $product_id, '_plu', $plu );\n}\nadd_action( 'woocommerce_process_product_meta','woocommerce_save_plu_field' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403218", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Image modification I am a beginner at CSS. I have followed Airbnb clone challenge. I believe that I follow everything the instructor does.\nHere is my problem. I added an image from my wix website. And, I added layout, objectift and objectposition according to the instructor.\n\nWhen  is written, the image has to change its shape and size. But, nothing happen.\nCan you please help me what is problem?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403219", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: update_post_meta I am trying to update a custom field for a custom post type with this function\nphp\nadd_action('wp_ajax_updatemeta', 'toggle_task_status');\nadd_action('wp_ajax_nopriv_updatemeta', 'toggle_task_status');\nfunction toggle_task_status () {\n    $post_id = $data['post_id'];\n    return update_post_meta($post_id , 'task_status', 'open');\n}\n\njavascript\n\njQuery(\"form\").on(\"submit\", function () {\n    console.log(\"hello\");\n    var post_id = jQuery(\"#post_id\").val();\n    console.log(post_id);\n    var post_data = {\n                    action: \"updatemeta\",\n                    data: {\n                        post_id: post_id,\n                    }\n                };\n    jQuery.ajax({\n        type: \"POST\",\n        url: \"http://cloud-accounting.com/wp-admin/admin-ajax.php\",\n        data: post_data,\n        dataType: \"json\",\n        cache: false,\n        error: function (jqHXR, textStatus, errorThrown) {\n            console.error(\"it is not working   \"+textStatus, errorThrown);\n        },\n        success: function () {\n            console.log(\"it is working\");\n        }\n    \n    })\n})\n\nand the code gives me success but it doesn't work , I see the same before and after the request\n\nA: I don't think you're actually getting the post ID sent by the javascript.\nfunction toggle_task_status () {\n    $post_id = $_POST['data']['post_id'];\n    $update = update_post_meta($post_id , 'task_status', 'open');\n    if($update){\n        wp_send_json('success');\n    } else {\n        wp_send_json('fail');\n    }\n    wp_die();\n}\n\nand then in your javascript\nsuccess: function (response) {\n    console.log(response); // should be either 'success'  or 'fail'\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403223", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: When trying to access home page, Wordpress appends /wordpress to domain name which gives 404 error When trying to access the home page, on https://www.andersonclassics.uk Wordpress appends /wordpress to the domain name as https://www.andersonclassics.uk/wordpress which gives a 404 error - there is no /wordpress folder, Wordpress is installed in the website root folder. https://www.andersonclassics.uk/about works correctly from the browser address bar.\nI have four other WP sites which work correctly with similar setup\nI checked .htaccess which has has only the standard WP settings.\nWordpress Address URL has https://www.andersonclassics.uk and Site Address URL has https://www.andersonclassics.uk. I checked the database table wp_options fields siteurl and home which both have https://www.andersonclassics.uk.\nI've tried everything I can listed for 404 errors in the forums, and even tried changing the Theme to twentytwelve which works on my other four sites.\nI'd appreciate your help.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403227", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to sort WP_Query by a custom text field (written as a date dd/mm/yyyy) I have an ACF text field for a CPT that is holding a date in DD/MM/YYYY format (it's a text field and not a datepicker field as the data was imported from a CSV file).\nMy Wordpress loop then sorts by this field in DESC order but of course as it stands this means it displays the entries for the 31st of the month first as the day is the first part of the string. Is there any way to convert this field on-the-fly so it reads YYYY/MM/DD before being parsed by the loop?\nI know how to output the date in the format I want in the front-end:\n$date = the_field('date'); // eg. 15/05/2020\n$orgD = substr($date, 0, 2);\n$orgM = substr($date, 3, 2);\n$orgY = substr($date, 6, 4);\n$newFormat = $orgY . $orgM . $orgD;\n$newDate = date(\"Y/m/d\", strtotime($newFormat)); // eg. 2020/05/15\n\nBut I'm sure that doesn't help in any way for this purpose.\nIs there a function I can add that will convert it or create a new custom field in the alternative format?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403228", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: TwentyTwentyTwo - How to add PHP logic to Post templates? I'm testing out the new TwentyTwentyTwo theme for WordPress 5.9.\nI can see that when I enter a post, on the right side I have the option to either Edit or Create New Templates.\n\nIn edit mode, it brings us into the edit view of that template (which kinda reminds me of a reusable block in a way..)\n\nBut how do we \"edit and save\" PHP code for these templates?  Like loops, actions, do_actions, etc... I don't see the templates being auto generated in my Visual Studio Code environment anywhere....\n\nA: \nBut how do we \"edit and save\" PHP code for these templates? Like loops, actions, do_actions, etc... I don't see the templates being auto generated in my Visual Studio Code environment anywhere....\n\nYou don't, these are block templates, not PHP templates. When in the filesystem in a theme they are plain .html files, and when you modify or create them in the user interface they're saved in the database.\nIn order to run PHP code in these templates you would need one of the following:\n\n*\n\n*a custom block that renders in PHP\n\n*a custom shortcode inserted via a shortcode block\n\nThis is the same as asking how to run PHP inside a posts content, and the solutions are the same. Custom blocks and shortcodes.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403229", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: After upgrading Debian Buster to Bullseye, Wordpress sites no longer updating Today I upgraded my webserver from Debian Buster to Bullseye and it was in fact a pretty straightforward upgrade. Everything seemed to work until I tried to reach a few WordPress sites on the server. At first I got some error about a missing MySQL module. The error message I got from PHPMyAdmin gave me a better clue: it said it was missing the mysqli module.\nSo I installed it with  apt install php7.4-mysqli  and that in fact made my WordPress sites work again.\nThe only problem now however, is that I can't update Wordpress. Everytime I try to update WordPress, I get an error:\n\nSo what am I missing here? Do I need to install suphp (even though that wasn't installed under Buster)?\nEDIT:\nI took me quite a while to figure out what actually was going on. Now I know, I have no idea how to solve the problem.\nThe error message WP is giving, is actually incorrect. As it turns out, it is able to unpack the update just fine in the proper folder. But it\u2019s when it checks if the files have actually unpacked, where it goes wrong. The problem lies in this piece of code in update-core.php:\nforeach ( $roots as $root ) {\n  if ( $wp_filesystem->exists( $from . $root . 'readme.html' )\n    && $wp_filesystem->exists( $from . $root . 'wp-includes/version.php' )\n  ) {\n    $distro = $root;\n    break;\n  }\n}\n    \nif ( ! $distro ) {\n  $wp_filesystem->delete( $from, true );\n  return new WP_Error( 'insane_distro', __( 'The update could not be unpacked.' ) );\n}\n\nWhat it does here, is simply check if two files exists in the folder it has just unpacked the zip file to. This fails. And the reason is as follows:\nI use FTP method for installing updates. So when I tell it to update, it first figures out the folder it should download the zipfile to. This folder is stored in $working_dir and is used from that moment on for the rest of the update process. The true path on the server is /domains/domainname.com/htdocs/wp-content/upgrade/ but since FTP users are chrooted, WP finds and stores /htdocs/wp-content/upgrade/ instead. The update file is downloaded to this folder and then unpacked.\nNext it does the above check. And that fails because it tries to find a file in /htdocs/wp-content/upgrade/ while the true location is /domains/domainname.com/htdocs/wp-content/upgrade/.\nI understand why it downloads the package just fine (since FTP users are chrooted). But I don\u2019t understand why it doesn\u2019t fail unpacking afterwards but it does fail when checking for the existence of the files...\nI have checked all php settings and can\u2019t find anything different with the settings from before the Debian upgrade\u2026\n\nA: It took me a while to figure out exactly what was going on but it's actually a problem with WordPress. Bullseye installs version 1.0.49 of PureFTPd where in Buster v1.0.47 was installed. According to PureFTPd's changelog here, globbing was removed from the NLST command in v1.0.48 (which makes sense since it's actually not allowed according to the RFC).\nThe WordPress developers are aware of the problem and have patched the exists() function. The patch is available here; applying it is one of two ways to upgrade WordPress if your using PureFTPd version 1.0.48 or up and are stuck with upgrading through FTP.\nYou can also replace the function yourself in /wp-admin/includes/class-wp-filesystem-ftpext.php (or /wp-admin/includes/class-wp-filesystem-ftpsockets.php if you are using FTPSockets) with the following (which is actually my own implementation of the function):\n\n        public function exists( $file ) {\n          $retval = false;\n\n          $list = ftp_nlist( $this->link, $file );\n          if( ! empty( $list ) ) {\n            // if ftp_nlist returns *something*, the file or directory exists, on any FTP server\n            $retval = true;\n          } else {\n            // if ftp_nlist returns nothing, either the file/dir doesn't exist or it's a file and\n            // the FTP server's NLST command doesn't support globbing (i.e. Pure-FTPD > v1.0.47)\n            // Check if it'a file\n            if( ftp_size( $this->link, $file ) >= 0 ) {\n              $retval = true;\n            }\n          }\n          return $retval;\n\n        }\n\nWordPress 6.0 will have the new function by default.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403230", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How do I disable XML-RPC in WordPress Multisite? I have tried a couple of go-to plugins, but I still get a response from XML-RPC.\nIs there something specific that needs to be done in a multisite installation?\nPlugins tested: Disable XML-RPC Pingback and Disable XML-RPC\n\nA: The simplest solution is a rule inside the .htaccess of the installation, if it is an Apache server. The following syntax should support you.\nProtect the whole access\n# PROTECT xmlrpc.php\n<Files xmlrpc.php>\n  Order Allow,Deny\n  Deny from all\n</Files>\n\nAccess for several apps\n# ACCESS for xmlrpc surface only for different apps\n<IfModule mod_setenvif.c>\n  <Files xmlrpc.php>\n    # blogs\n    BrowserMatch \"WordPress\" allowed\n    # poster\n    BrowserMatch \"Poster\" allowed\n    # Windows Livew Writer\n    BrowserMatch \"Windows Live Writer\" allowed\n    # WP 4 iOS\n    BrowserMatch \"wp-iphone\" allowed\n    # WP 4 Android\n    BrowserMatch \"wp-android\" allowed\n    \n    Order Allow,Deny\n    Deny from All\n    Allow from env=allowed\n  </Files>\n</IfModule>\n\nDeactivation via Filter\nThere is also an option to deactivate the functionality about a filter. Copy the following example in a custom plugin and use it. It is also possible to use it as 'Must Use plugin'. In your case in a Multisite installation, you should the plugin activates as 'Network Wide', about all sites of the network.\nadd_filter( 'xmlrpc_enabled', '__return_false' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403232", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to show categories and date on posts I want to categorise posts and show them on my WordPress website. So in order to achieve that I've written a code. My code is below.\nfunction wpb_postsbycategory() {\n// the query\n$the_query = new WP_Query( array( \n    'category_name' => 'travel', \n    'posts_per_page' => 5 \n) ); \n   \n// The Loop\nif ( $the_query->have_posts() ) {\n    $string .= '<ul class=\"postsbycategory widget_recent_entries\">';\n    while ( $the_query->have_posts() ) {\n        $the_query->the_post();\n            if ( has_post_thumbnail() ) {\n            $string .= '<li>';\n            $string .= '<a href=\"' . get_the_permalink() .'\" rel=\"bookmark\">' . get_the_post_thumbnail($post_id, array( 50, 50) ) . get_the_title() .'</a></li>';\n            } else { \n            // if no featured image is found\n            $string .= '<li><a href=\"' . get_the_permalink() .'\" rel=\"bookmark\">' . get_the_title() .'</a></li>';\n            }\n            }\n    } else {\n    // no posts found\n $string .= '<li>No Posts Found</li>';\n}\n$string .= '</ul>';\n   \nreturn $string;\n   \n/* Restore original Post Data */\nwp_reset_postdata();\n}\n// Add a shortcode\nadd_shortcode('categoryposts', 'wpb_postsbycategory');\n\nThis code works perfectly fine. However, I want to show posts meta descriptions as well (i.e post created date and the category). How would I achieve that? Right now It only extracts the post heading and the image. Thanks so much for helping me out.\n\nA: Something like this for the category term should work. That's for the slug you probably want the name.\n<?php $terms = get_the_terms( $post->ID, 'category' ); ?>\n<?php foreach( $terms as $term ) echo ',' . $term->slug; ?>\n \n\nThe date is pretty simple just follow the documentation\nhttps://developer.wordpress.org/reference/functions/get_the_date/ it has lots of examples at the bottom.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403233", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Substitute original WordPress url by another domain name I do have a very basic question, but struggle to understand things.\nI do have a Wordpress, host on WorldLite by Planet Hoster. Url is something like \"mysite.go.yo\".\nWhen I go to a post, url becomes \"mysite.go.yo/my-awesome-post\".\nNow, I simply would like to switch from \"mysite.go.yo\" to something more sexy, like \"mysite.com\". I am just talking about the browser url display, purely cosmetic, not actually moving files.\nI would also like that links appear as \"mysite.com/my-awsome-post\" rather than \"mysite.go.yo/my-awesome-post\" or always \"mysite.com\".\nI do have the domain \"mysite.com\" with OVH but I clearly struggle to get desired result. Is it possible to achieve expected result when domain name is not host by the WordPress host?\n\nA: For future reference, to achieve this result one shall:\n\n*\n\n*Create a CNAME redirection from its .com to its .go.yo,\n\n*Update default DNS Zone from OVH by the one of the PH host,\n\n*Create an domain name alias on PH,\n\n*Update WordPress with new url\n\nBut things are easier if host & .com are held by the same company.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403236", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to change Akismet commenter privacy notice? I read the supposed explanation posted on their blog, and came away unenlightened.\nThe following site-specific plugin does nothing (I have enabled it):\n<?php\n/*\nPlugin Name: Akismet Better Privacy Notice\nDescription: Inform users about what's actually happening with their data\n*/\n\napply_filters(\n    'akismet_comment_form_privacy_notice_markup',\n    '<p class=\"akismet_comment_form_privacy_notice\">' .\n    'Warning: This site uses Akismet to filter spam.' .\n    ' Until or unless I can find a suitable replacement anti-spam solution, this means that' .\n    ' (per their <a href=\"%s\" target=\"_blank\">indemnification document</a>)' .\n    ' <strong>all commenters\\' IP addresses will be sent to Automattic, Inc.</strong>,' .\n    ' who may choose to share such with 3rd parties.' .\n    '<br />If this is unacceptable to you,' .\n    ' I highly recommend using an anonymous proxy or public Wi-Fi connection' .\n    ' when commenting.' .\n    '</p>'\n);\n\n?>\n\n\nHow can I change this privacy message?\n\nA: Aha, I finally got it working:\n<?php\n/*\nPlugin Name: Akismet Better Privacy Notice\nDescription: Inform users about what's actually happening with their data\n*/\n\nadd_filter (\n    'akismet_comment_form_privacy_notice_markup', 'better_display_comment_form_privacy_notice'\n);\n\nfunction better_display_comment_form_privacy_notice() {\n    echo sprintf(\n        '<p class=\"akismet_comment_form_privacy_notice\">' .\n        'Warning: This site uses Akismet to filter spam.' .\n        ' Until or unless I can find a suitable replacement anti-spam solution, this means that' .\n        ' (per their <a href=\"%s\" target=\"_blank\">indemnification document</a>)' .\n        ' <strong>all commenters\\' IP addresses will be sent to Automattic, Inc.</strong>,' .\n        ' who may choose to share such with 3rd parties.' .\n        '<br />If this is unacceptable to you,' .\n        ' I highly recommend using an anonymous proxy or public Wi-Fi connection' .\n        ' when commenting.' .\n        '</p>' ,\n        'https://akismet.com/privacy/'\n    );\n}\n\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403240", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I add a line break to a string that is output by PHP? There is a heading output in my ad statistics page (WordPress):\n<h3 id=\"ad-title\"><?php printf( __( 'Statistics for %s', 'advanced-ads-tracking' ), $ad_name ); ?></h3>\n\nI want to add a line break after the \u201cStatistics for\u201d part.\nThe Find and Replace plugin (filters HTML after generated by WP and before it\u2019s sent to the browser) is not able to replace the string, I am not sure why \u2013 my ad stats page is generated within the WordPress context so it should work, but it doesn\u2019t.\nThere is no filter hook in ad-stats.php, there is only an action hook. But I cannot use an action hook to replace a string, I would need a filter hook.\nI want to use str_replace to replace the string, adding the line break in it.\nHow do I do that?\nOr can I add a filter hook?\n\nA: just add <br />in this way.\n\\n is only working with echo or nl2br() method.\nbut when we need to break line in print_r() we use<br/>this way and it works.\ni create example for you, please check.\nhttps://www.awesomescreenshot.com/image/23177408?init_open=true\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403243", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Use a hook or filter, or overwrite this Gamipress function? Currently, Gamipress allows you to import a CSV file that lists a username (email or ID), and a points value to add to the points type for that user. It uses this function to achieve this, which writes to the gamipress log.\n/**\n * AJAX handler for the import points tool\n *\n * @since 1.6.4\n */\nfunction gamipress_import_export_points_tool_ajax_import() {\n    // Security check, forces to die if not security passed\n    check_ajax_referer( 'gamipress_admin', 'nonce' );\n\n    // Check user capabilities\n    if( ! current_user_can( gamipress_get_manager_capability() ) ) {\n        wp_send_json_error( __( 'You are not allowed to perform this action.', 'gamipress' ) );\n    }\n\n    // Check parameters received\n    if( ! isset( $_FILES['file'] ) ) {\n        wp_send_json_error( __( 'No file to import.', 'gamipress' ) );\n    }\n\n    $import_file = $_FILES['file']['tmp_name'];\n\n    if( empty( $import_file ) ) {\n        wp_send_json_error( __( 'Can\\'t retrieve the file to import, check server file permissions.', 'gamipress' ) );\n    }\n\n    ignore_user_abort( true );\n\n    if ( ! gamipress_is_function_disabled( 'set_time_limit' ) ) {\n        set_time_limit( 0 );\n    }\n\n    // Retrieve the content from the file\n    $file_contents = file_get_contents( $import_file );\n\n    if( empty( $file_contents ) ) {\n        wp_send_json_error( __( 'Empty file, so nothing to import.', 'gamipress' ) );\n    }\n\n    // Setup vars\n    $points_types = gamipress_get_points_types();\n\n    // Explode by line breaks\n    $lines = explode( \"\\n\", $file_contents );\n\n    foreach( $lines as $number => $line ) {\n\n        $columns = str_getcsv( $line );\n\n        if( count( $columns ) >= 3 ) {\n\n            $user = false;\n            $points = 0;\n            $points_type = '';\n            $log_description = '';\n            $deduct = false;\n\n            // User\n            if( isset( $columns[0] ) && ! empty( $columns[0] ) ) {\n\n                $user_field = 'login';\n\n                if( filter_var( $columns[0], FILTER_VALIDATE_EMAIL ) ) {\n                    $user_field = 'email';\n                } else if( is_numeric( $columns[0] ) ) {\n                    $user_field = 'id';\n                }\n\n                $user = get_user_by( $user_field, $columns[0] );\n\n            }\n\n            // Points\n            if( isset( $columns[1] ) && is_numeric( $columns[1] ) ) {\n\n                // If points amount has a negative sign, then user is looking for deduct\n                if ( substr( $columns[1], 0, 1 ) === '-') {\n                    $deduct = true;\n                    $columns[1] = substr( $columns[1], 1); // Remove the negative sign\n                }\n\n                $points = absint( $columns[1] );\n\n            }\n\n            // Points Type\n            if( isset( $columns[2] ) && ! empty( $columns[2] ) && isset( $points_types[$columns[2]] ) ) {\n\n                $points_type = $columns[2];\n\n            }\n\n            // Log Description\n            if( isset( $columns[3] ) && ! empty( $columns[3] ) ) {\n\n                $log_description = $columns[3];\n\n            }\n\n            // Check if everything is done\n            if( $user && $points > 0 && ! empty( $points_type ) ) {\n\n                // When award points passing an admin ID, we need to pass the full new amount\n                $current_points = gamipress_get_user_points( $user->ID, $points_type );\n\n                $args = array(\n                    'admin_id'  => get_current_user_id(),\n                    'reason'    => $log_description,\n                    'log_type'  => 'points_award'\n                );\n\n                // If log description is empty, let GamiPress to setup it from log settings\n                if( empty( $log_description ) ) {\n                    $args = array( 'admin_id'  => get_current_user_id() );\n                }\n\n                if( $deduct ) {\n                    // Deduct points to the user\n                    gamipress_deduct_points_to_user( $user->ID, $current_points - $points, $points_type, $args );\n                } else {\n                    // Award points to the user\n                    gamipress_award_points_to_user( $user->ID, $points + $current_points, $points_type, $args );\n                }\n\n            }\n\n        }\n\n    }\n\n    // Return a success message\n    wp_send_json_success( __( 'User\\'s points balances has been updated successfully.', 'gamipress' ) );\n}\nadd_action( 'wp_ajax_gamipress_import_export_points_tool_import', 'gamipress_import_export_points_tool_ajax_import' );\n\nThis function does not add the points to the users points total. It just writes it to the log. I then have this function I have written to register the points for the user. However, it registers the total amount of points, rather than adds the points value - as the import function passes points +/- current points. I would like to register the points value - not the points +/- current points.\n//Gamipress - Register user points when importing points from CSV\nfunction ofc_insert_user_earning_on_import_points_tool( $user_id, $points, $points_type, $args ) {\n\n    if( ! defined( 'DOING_AJAX' ) ) return;\n    if( ! DOING_AJAX ) return;\n    if( ! isset( $_REQUEST['action'] ) ) return;\n    if( $_REQUEST['action'] !== 'gamipress_import_export_points_tool_import' ) return;\n\n    $points_type_obj = gamipress_get_points_type( $points_type );\n    $award = ( current_filter() === 'gamipress_award_points_to_user' );\n\n    if( ! $award ) {\n        $points *= -1;\n    }\n\n\n    gamipress_insert_user_earning( $user_id, array(\n        'title'         => ( isset( $args['reason'] ) ? $args['reason'] : '' ),\n        'post_id'       => $points_type_obj['ID'],\n        'post_type'     => 'points-type',\n        'points'        => $points,\n        'points_type'   => $points_type,\n        'date'          => date( 'Y-m-d H:i:s', current_time( 'timestamp' ) ),\n    ) );\n\n}\nadd_action( 'gamipress_award_points_to_user', 'ofc_insert_user_earning_on_import_points_tool', 10, 4 );\nadd_action( 'gamipress_deduct_points_to_user', 'ofc_insert_user_earning_on_import_points_tool', 10, 4 );\n\nHow do I tap into the gamipress_import_export_points_tool_ajax_import function to get the $points instead of the points total? (Hopefully that makes sense)\n\nA: Turns out it was as simple as adding this line to my function:\n$current_total_points = gamipress_get_user_points( $user_id, $points_type);\n\nand then passing $points - $current_total_points to Gamipress's insert user earnings function.\nfunction ofc_insert_user_earning_on_import_points_tool( $user_id, $points, $points_type, $args ) {\n\n    if( ! defined( 'DOING_AJAX' ) ) return;\n    if( ! DOING_AJAX ) return;\n    if( ! isset( $_REQUEST['action'] ) ) return;\n    if( $_REQUEST['action'] !== 'gamipress_import_export_points_tool_import' ) return;\n\n    $points_type_obj = gamipress_get_points_type( $points_type );\n    $award = ( current_filter() === 'gamipress_award_points_to_user' );\n\n    //if we are deducting points, then make the points negative\n    if( ! $award ) {\n        $points *= -1;\n    }\n\n    $current_total_points = gamipress_get_user_points( $user_id, $points_type);\n\n    gamipress_insert_user_earning( $user_id, array(\n        'title'         => ( isset( $args['reason'] ) ? $args['reason'] : '' ),\n        'post_id'       => $points_type_obj['ID'],\n        'post_type'     => 'points-type',\n        'points'        => $points - $current_total_points,\n        'points_type'   => $points_type,\n        'date'          => date( 'Y-m-d H:i:s', current_time( 'timestamp' ) ),\n    ) );\n\n}\nadd_action( 'gamipress_award_points_to_user', 'ofc_insert_user_earning_on_import_points_tool', 10, 4 );\nadd_action( 'gamipress_deduct_points_to_user', 'ofc_insert_user_earning_on_import_points_tool', 10, 4 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403246", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to replace characters in CPT posts with a newline using Better Search Replace I see some corruption in some CPT posts.\nI need to replace\n_x000D_\n_x000D_ \n\nwith 2 new line breaks.\nHow would I do this using the Better Search Replace plugin, please?\nHelp appreciated.\n\nA: I searched the database for \\n newline characters and there were none.\nSo I replaced _x000D_ with _x000D_<br>.\nThis worked for us.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403250", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Modify src attribute on image block Been googling like crazy but come up empty. Is it possible to modify the src attribute with the core image block? I want to replace src with data-src for lazy loading images without the native functionality.\n\nA: You want to take a look at the Codex about Block Filters.\nYou'll need to make a filter using add_filter and hook into render_callback by re-registering core/image and modifying the render callback.\nCheckout this WPSE post from uruk.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403252", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Pass user role to javascript code inside body I know this question has been answered before, but it's not exactly the info I am looking for.\nRight now I am developing a chatbot for a client. I am kind of new to web development, but especially to wordpress (this is what the client is using).\nThe chatbot is added to the pages using the Insert Headers and Footers plugin from wordpress.\nI add it to the header. But I guess it would also work in the body.\nGiven that I don't know PHP/Wordpress, I don't know how I could pass the user role to the bot, so it would offer support only to certain user roles.\nI know there are some php functions (is_user_loggedin, or  wp_get_current_user) but I don't know how to actually run these.\nI tried adding them between script tags like below to at least try to dump the info to the browser console, but it didn't work..\n<script>\n\n<?php\n$user = wp_get_current_user();\nvar_dump($user);\n?>\n\n</script> \n\nThis is how I add the chatbot to the website:\nI add the following to the Header of the app using the previously mentioned plugin.\n<script>!(function () {\n  let e = document.createElement(\"script\"),\n    t = document.head || document.getElementsByTagName(\"head\")[0];\n  (e.src =\n    \"https://cdn.jsdelivr.net/npm/rasa-webchat@1.x.x/lib/index.js\"),\n    // Replace 1.x.x with the version that you want\n    (e.async = !0),\n    (e.onload = () => {\n      window.WebChat.default(\n        {\n          params: { storage:\"session\"},\n          title: \"TestBot\",\n          initPayload: 'hello',\n          customData: { language: \"en\" },\n          socketUrl: \"https://testlink.com\",\n          inputTextFieldHint: \"Ask question here\",\n          // add other props here\n        },\n        null\n      );\n    }),\n    t.insertBefore(e, t.firstChild);\n})();\n</script>\n\nI am trying to pass the user role to the initPayload attribute. But I am really having trouble here understanding how to actually run and store the result of the php code.\nI would really appreciate some help!\n\nA: To my understanding the mentioned plugin is intended for adding either css or js to the site's header, body or footer, not PHP.\nI would recommend creating a custom plugin for integrating your custom script on the site. This way you're not depending on other plugins and you have complete control on how and when the script is added to the site.\nYou can learn more about creating a custom plugin from the WP Dev docs, Plugin Basics.\nIn your custom plugin you could then add the script conditionally based on the user and one's role. Simple example below. Uncomment if statements, or add more, as needed.\nadd_action( 'wp_head', 'my_maybe_add_chatbot' );\nfunction my_maybe_add_chatbot() {\n\n  // only logged in users?\n  // if ( ! is_user_logged_in() ) {\n  //   return;\n  // }\n\n  // Only certain role\n  // $user = wp_get_current_user();\n  // $allowed_role = 'some_role';\n  // if ( ! in_array( $allowed_role, (array) $user->roles ) ) {\n  //   return;\n  // }\n\n  // other guards..\n\n  my_print_chatbot_script();\n}\n\nfunction my_print_chatbot_script() {\n  ?>\n  <!-- script here -->\n  <?php\n}\n\nYou can of course leave out the PHP if statements, always print the script, and just print the roles in the middle of the script. But I don't think this is a clean way to do things.\nadd_action( 'wp_head', 'my_print_chatbot_script_with_role' );\nfunction my_print_chatbot_script_with_role() {\n  $user = wp_get_current_user();\n  ?>\n  <script>\n    // script...\n    title: \"TestBot\",\n    initPayload: <?php echo (array) $user->roles[0]; ?>,\n    customData: { language: \"en\" },\n    // script...\n  </script>\n  <?php\n}\n\nThird option is to put the script into a separate js file and enqueue it with PHP. Then inline the role data to be used in the main script file.\nadd_action( 'wp_enqueue_scripts', 'my_enqueue_scripts' );\nfunction my_enqueue_scripts() {\n  $user = wp_get_current_user();\n  \n  wp_enqueue_script(\n    'my-script',\n    plugin_dir_url( __FILE__ ) . '/js/script.js',\n    array(),\n    '1.0.0',\n    true\n  );\n\n  // access in js console.log( MY_SCRIPT_USER_ROLES );\n  wp_add_inline_script(\n    'my-script', \n    'const MY_SCRIPT_USER_ROLES = ' . json_encode( (array) $user->roles ), \n    'before'\n  );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403253", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Class active for Archive link - looped out I want to have the current Archive page link to have the class \"selected\". So if I'm in /category/featured/ that button on the menu should have the class selected.\nAfter trying several different ways all im managing to do is make all the archive links have the class if Im in any of those. How can i make it so it only targets one ?\nWhen /category/featured/ is active the rest should not have class selected..\nSo i have all my categories looped out so:\n<?php $categories = get_categories(); ?>\n\n \n\n<?php  foreach($categories as $category) {\n   \n   echo '<a class=\"'. (( is_archive()?'selected\"':\"\")) .'\" href=\"'. get_category_link($category->term_id) . '\">' . $category->name . '</a>';\n} ?>\n\n\nA: One way to do this is to get the current object ID with get_queried_object_id() and compare it against the category term ID inside the foreach loop. E.g.\n$current_object_id = get_queried_object_id();\n\nforeach (get_categories() as $category) {\n\n  $classes = '';\n  if ( $category->term_id === $current_object_id ) {\n    $classes .= 'selected';\n  }\n\n  printf(\n    '<a class=\"%s\" href=\"%s\">%s</a>',\n    $classes,\n    get_category_link($category->term_id),\n    $category->name\n  );\n}\n\nis_category() should work too as it is basically a fancy wrapper for the same check as above.\nforeach (get_categories() as $category) {\n\n  $classes = '';\n  // Parameter can be category ID, name, slug, or array of such\n  if ( is_category( $category->term_id ) ) {\n    $classes .= 'selected';\n  }\n\n  printf(\n    '<a class=\"%s\" href=\"%s\">%s</a>',\n    $classes,\n    get_category_link($category->term_id),\n    $category->name\n  );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403256", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How do I add an action using namespaces, and file separation? I'm working on a plugin, and I'm trying to get to grips with namespaces and how they work with actions. In a separate file, I have a single function with a namespace declared at the top:\nnamespace verism\\ImageUpload;\n\nfunction image_upload() {\n    ...\n    echo 'function successfully called';\n    wp_die();\n}\n\nIn the main plugin php file I'm trying to add an action as follows:\nnamespace verism;\n\nuse function verism\\ImageUpload\\image_upload as image_upload;\n\nadd_action( 'wp_ajax_set_image_from_url', 'image_upload' );\nadd_action( 'wp_ajax_nopriv_set_image_from_url', 'image_upload' );\n\nI have also tried:\nnamespace verism;\n\nuse function verism\\ImageUpload\\image_upload as image_upload;\n\nadd_action( 'wp_ajax_set_image_from_url', '\\verism\\ImageUpload\\image_upload' );\nadd_action( 'wp_ajax_nopriv_set_image_from_url', '\\verism\\ImageUpload\\image_upload' );\n\nHowever, none of these approaches work - when I log the AJAX result to the console, I always get \"0\".\nNote: If I copy the image_upload function into the main file, I can see the correct result, the issue seems to only be when it's located in a separate file.\nCan anyone shed some light?\nEDIT: This question was deemed too similar to an existing one, and so has been closed, so I cannot accept an answer. However, this question deals with a different issue, namely that of requiring\u2014rather than using\u2014a separate file. User Rup was kind enough to offer the correct answer to the problem, in the comments.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403257", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding data to User profile Some plugins for wordpress add fields to the users profile. For example \"Company\" or \"Store\" or \"Group\". How can I add the values to this fields from a custom a frontend registration form, with custom fields, compatible with the users new profile fields.\nThank you\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403262", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: CPT loop doesn't seem to account for post date? I have some custom post types called \"products\", all with different published dates. Below is my loop that grabs these posts:\n $args = array(  \n    'post_type' => 'product',\n    'post_status' => 'publish',\n    'posts_per_page' => $numposts, \n    'orderby' => 'date',\n    'order' => 'DESC',\n    'product-category' => $cat,\n    'paged' => $paged,\n    'author' => $author,\n);\n\n$loop = new WP_Query( $args ); \nif (!$loop->have_posts()){\n    return 'No products available.';\n}\n\nI have my orderby set to date desc, but it's not taking effect on the frontend (they're just randomly ordered). What's also odd is that in the backend, if I look at my custom posts and sort by the \"date\" column, they don't sort there either. It's like it can't read the published date even though the date is showing on each post. Thoughts?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403263", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get terms hiding empty I have different taxonomies, let's say category and colour, these 2 tax have different terms, the tax are in parallel, a product can be in the category A and have colours X, in my frontend when I go in the page for the category A I show all the products in the category A, in this page I also show all the colours as filter, I'd like to hide all the colour that are not present in any product in the category A.\nHere an example that should help understand my issue:\nProduct 1:\n\n*\n\n*category: car\n\n*color: red\n\nProduct 2:\n\n*\n\n*category: car\n\n*color: black\n\nProduct 3:\n\n*\n\n*category: bike\n\n*color: purple\n\nif I go in the page of category \"car\" and I do something like:\nget_terms('colours', array(\n  'hide_empty' => true\n))\n\nI'm able to see purple, even if in this category there are no product with colour purple, that make sense because WP check the total count for that particular taxonomy but I would like to find a way to get the colour only for the products in the category A\nso:\nget_terms('colours', array(\n  'hide_empty' => true\n))\n\nshould returns only [\"red\", \"black\"]\nmany thanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403264", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: A special character I am trying to include in a page keeps getting rejected with error \"Updating failed. The response is not a valid JSON response.\" I'm working on a site that contains passages in old spellings of the Luxembourgish language. This means that it contains an extreme assortment of weird diacritics, strangely placed apostrophes and mixtures of characters, in order to create the various \"Umlauts\" that the language contains. (Our  grammar and orthography were standardized very late.)\nMy problem is that for some reason the letter \u00fb (u circumflex) is not accepted and throws an error however I enter it. I have tried to insert it in the Gutenberg editor, the WPBakery editor, even in HTML, both literally and as a HTML code (both &ucirc; and &#94; u don't work), but nothing works.\nI always get a message that says: Updating failed. The response is not a valid JSON response.\nIn case it's important or the prior characters affect it in a weird way, the whole sentence is:\n\n\u00c9ch hun dir \u011bw\u00e9g Trei geschw\u00fbor.\n\nIn the above sentence, there are a multitude of weird characters, but only the \u00fb makes wordpress scream and throw a tantrum. Why?\nDoes Wordpress use this character as a placeholder for something? Or is it the server the site is hosted on? I've tried every way I know to insert that letter into the text and I am at a loss.\nThanks in advance.\nEDIT:\nHere is the JSON request it sends out and the response it gets to this request.\n{\"id\":[[an id number]],\"content\":\"<!-- wp:separator -->\\n<hr class=\\\"wp-block-separator\\\"/>\\n<!-- /wp:separator -->\\n\\n<!-- wp:heading {\\\"textAlign\\\":\\\"center\\\",\\\"level\\\":3} -->\\n<h3 class=\\\"has-text-align-center\\\"><em>Onst Heemechtsland</em></h3>\\n<!-- /wp:heading -->\\n\\n<!-- wp:separator -->\\n<hr class=\\\"wp-block-separator\\\"/>\\n<!-- /wp:separator -->\\n\\n<!-- wp:paragraph {\\\"style\\\":{\\\"color\\\":{\\\"text\\\":\\\"#808000\\\"}}} -->\\n<p class=\\\"has-text-color\\\" style=\\\"color:#808000\\\"><em><strong>Werkinformationen:</strong></em></p>\\n<!-- /wp:paragraph -->\\n\\n<p style=\\\"padding-left: 40px;\\\"><strong>Titel: </strong>Onst Heemechtsland</p>\\n<p style=\\\"padding-left: 40px;\\\"><strong>Komponist:  </strong>Laurent Menager</p>\\n<p style=\\\"padding-left: 40px;\\\"><strong>Text:</strong> Jean Nicolas Moes</p>\\n<p style=\\\"padding-left: 40px;\\\"><strong>Datum: </strong>Unbekannt</p>\\n<p style=\\\"padding-left: 40px;\\\"><strong>Besetzung: </strong>TTBB a cappella</p>\\n<p style=\\\"padding-left: 40px;\\\"><strong>Einordnung:</strong> weltliches Vokalwerk, Chorlied TTBB a cappella</p>\\n<p style=\\\"padding-left: 40px;\\\"><strong>Textincipit:</strong> ,,\u00c9ch hun dir \u011bw\u00e9g Trei geschw\u00fbor\\\"</p>\\n\\n<!-- wp:paragraph {\\\"style\\\":{\\\"color\\\":{\\\"text\\\":\\\"#808000\\\"}}} -->\\n<p class=\\\"has-text-color\\\" style=\\\"color:#808000\\\"><strong><em>Materialbeschreibung:</em></strong></p>\\n<!-- /wp:paragraph -->\\n\\n<p style=\\\"padding-left: 40px\\\"><strong>Typ: </strong>Edition: Partitur, Verlag Decker-M\u00fcllendorff, Luxembourg</p>\\n<p style=\\\"padding-left: 40px\\\"><strong>Quellenart &amp; Umfang:</strong>&nbsp; Partitur, 10 S.</p>\\n<p style=\\\"padding-left: 40px\\\"><strong>Format: </strong>17,2 x 27,2 cm</p>\\n<p style=\\\"padding-left: 40px\\\"><strong>Signatur:</strong> Archiv des Sang &amp; Klang, O2</p>\"}\n\n<html><head><title>Request Rejected</title></head><body>The requested URL was rejected. Please consult with your administrator.<br><br>Your support ID is: [[a long id number]]<br><br><a href='javascript:history.back();'>[Go Back]</a></body></html>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403266", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Media changes not updating posts What happens:\n\n*\n\n*Write a post\n\n*Create a gallery\n\n*Upload a random picture\n\n*Set caption to \"test\"\n\n*Publish Post\n\n*Go to Media -> Select the picture from before\n\n*Set caption to \"changed\" and save\n\n*Go back to post\n\n*Check the image\n\n*Image caption still shows \"test\" -> Should be \"changed\"\n\nSo if I ever update the media library with proper captions, alt text and titles it looks like they will never be updated on older posts. Is this how it should work?\nIf this is not a bug, but a feature, how to fix this? Where are these block-information on the post saved?\nKind Regards,\nBen\n\nA: Yes, that is Core behavior. The Post Editor saves whatever alt text, caption, and title you use while editing a specific Post/Page/CPT into its post content, in HTML if you are using the Classic Editor, or in Image block attributes if you are using the Block Editor.\nOne workaround is to always upload media directly to the Media Library. While you upload, set your desired alt text, captions, and titles. After you're done there, edit the Posts/Pages/CPTs where you want to add the images. Since the info is stored in the Media Library, when you add the image to a post's content, that will prepopulate from what you already entered.\nIf you need to go back and change existing image info in posts, it is probably easiest to follow a similar pattern: set the alt text, captions, and titles in the Media Library first. Then, you'll have to search through your Posts/Pages/CPTs, but you can remove the images there and re-add them, and they'll have the info prepopulated.\n\nA: I've found a solution to this and created a plugin for the current WordPress Version: https://github.com/DasBen/CasualBen-Automatic-Alt-And-Caption-Text/tree/1.1.0\nEverytime an image is rendered, there will now be a query to update alt-text and captions.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403272", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to show posts as custom field in specific post type? I have two post types called astronomy club and astro info. I need to link the astro info to astronnomy club which can be multiple select. In the backend how to create custom field with the list of astronomy club post and save into the database.\nExample\nAstronomy club: \ncode: 9310\n\nAstronomical info post type:\n email id firstname lastname\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403274", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Create a custom post with custom post-metadata with WP API I'm using WP API to insert a custom post in Wordpress. The custom post is \"property\".\nWhat I now need to do is assign that post a \"metadata\" (DB table \"wp_postmeta\")\nAt first I thought It was going to be easy like (I'm using Symfony Http class here):\nHttp::withBasicAuth($user, $password)->post(\"{$endpoint}/property\", [\n    'date' => now(),\n    'status'  => 'publish',\n    'title' => 'Test',\n    //etc...\n    'meta' => [\n        'custom_metadata' => 1234 \n    ]\n]);\n\nThe custom property post gets created but the meta does not.\nI did register my custom post in functions.php like so:\n//Add \"property\" listing capability\nfunction my_custom_post_type_rest_support() {\n\n    global $wp_post_types;\n    $post_type_name = 'property';\n\n    if( isset( $wp_post_types[ $post_type_name ] ) ) {\n        $wp_post_types[$post_type_name]->show_in_rest = true;\n    }\n}\nadd_action( 'init', 'my_custom_post_type_rest_support', 25 );\n\nAnd I do get listings and I can filter specific property posts.\nI cannot add metadata to the post and I cannot figure out how to do it, and I have a hard time the documentation.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403275", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to remove parent style.css from the header in a child theme of WP theme \"twenty-twenty-one\" I like to remove the original style.css of the parent theme - based in the link-tag id='twenty-twenty-one-style-css' - from the header.\nHere is the code\n    <link rel='stylesheet' id='twenty-twenty-one-style-css'  href='http://localhost/ml_wp_220228/wp-content/themes/twentytwentyone/style.css?ver=6.1.1.1646164756' media='all' />\n    <link rel='stylesheet' id='chld_thm_cfg_separate-css'  href='http://localhost/ml_wp_220228/wp-content/themes/cpeach_theme_21/ctc-style.css?ver=6.1.1.1646164756' media='all' />\n\nThe first css-link-tag - id \"twenty-twenty-one-style-css\" - should be removed, only the second - my own css - should stay.\nI tried it with some coding in the function.php of the child theme.\n    function dequeue_css() {\n        wp_dequeue_style('twenty-twenty-one-style');\n        wp_deregister_style('twenty-twenty-one-style');\n    }\n    add_action('wp_enqueue_scripts','dequeue_css');\n\nWhen I tried the function with a style, I created by myself before - for instance id \"css-link chld_thm_cfg_separate-css\" - everything worked fine.\nTrying the same with the style.css of the parent - id='twenty-twenty-one-style-css' - didn't work.\nPlease, can you give me a hint.\nThanks\nFrank\n\nA: The file 'style.css' is integrated via function 'twenty_twenty_one_scripts' in the parent themes functions.php.\nfunction twenty_twenty_one_scripts() {\n    // Note, the is_IE global variable is defined by WordPress and is used\n    // to detect if the current browser is internet explorer.\n\n    global $is_IE, $wp_scripts;\n\n    if ( $is_IE ) {\n        // If IE 11 or below, use a flattened stylesheet with static values replacing CSS Variables.\n        wp_enqueue_style( 'twenty-twenty-one-style', get_template_directory_uri() . '/assets/css/ie.css', array(), wp_get_theme()->get( 'Version' ) );\n    } else {\n        // If not IE, use the standard stylesheet.\n        wp_enqueue_style( 'twenty-twenty-one-style', get_template_directory_uri() . '/style.css', array(), wp_get_theme()->get( 'Version' ) );\n    }\n\n    // RTL styles.\n    wp_style_add_data( 'twenty-twenty-one-style', 'rtl', 'replace' );\n\n    // Print styles.\n    wp_enqueue_style( 'twenty-twenty-one-print-style', get_template_directory_uri() . '/assets/css/print.css', array(), wp_get_theme()->get( 'Version' ), 'print' );\n...\n\nTo change this, disable function 'twenty_twenty_one_scripts' in the child themes function.php\nfunction remove_my_action() {\n    remove_action( 'wp_enqueue_scripts', 'twenty_twenty_one_scripts' );\n}\nadd_action( 'wp_head', 'remove_my_action' );\n\nCopy the Code of function 'twenty_twenty_one_scripts' into the child themes function.php, rename it and remove (or comment out) the first section of the function:\nfunction my_twenty_twenty_one_scripts() {\n    // Note, the is_IE global variable is defined by WordPress and is used\n    // to detect if the current browser is internet explorer.\n\n    global $is_IE, $wp_scripts;\n\n    /*\n    if ( $is_IE ) {\n        // If IE 11 or below, use a flattened stylesheet with static values replacing CSS Variables.\n        wp_enqueue_style( 'twenty-twenty-one-style', get_template_directory_uri() . '/assets/css/ie.css', array(), wp_get_theme()->get( 'Version' ) );\n    } else {\n        // If not IE, use the standard stylesheet.\n        wp_enqueue_style( 'twenty-twenty-one-style', get_template_directory_uri() . '/style.css', array(), wp_get_theme()->get( 'Version' ) );\n    }\n    */\n\n    // RTL styles.\n    wp_style_add_data( 'twenty-twenty-one-style', 'rtl', 'replace' );\n\n    // Print styles.\n    wp_enqueue_style( 'twenty-twenty-one-print-style', get_template_directory_uri() . '/assets/css/print.css', array(), wp_get_theme()->get( 'Version' ), 'print' );\n...\n\nActivate the new function 'my_twenty_twenty_one_scripts' in child themes function.php\nadd_action( 'wp_enqueue_scripts', 'my_twenty_twenty_one_scripts' );\n\n\nA: For the moment I solved it the brutal way: I removed the link-tag with the parent-css ( <link rel='stylesheet' id='twenty-twenty-one-style-css'... ) using javascript.\nin JS\nconst parentStyleCss = document.querySelector('#twenty-twenty-one-style-css');\nparentStyleCss.parentNode.removeChild(parentStyleCss);\n\nThis is not the best way to go, I know.\nSo, if anybody can give a hint to remove the line via coding in Wordpress's function.php I'd be happy to hear it.\nFrank\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403278", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Redirect after scrolling the page is it possible to create a redirect only after the page has been scrooled, for example, in the middle and redirects to another page? I tried various solutions and plugins but couldn't find anything that suited me\n\nA: Try this solution: You can easily do this by using jQuery.\njQuery(document).scroll(function() {\n  var y = $(this).scrollTop();\n  if (y > 800) {\n    window.location.replace(\"http://stackoverflow.com\");\n  } else {\n    console.log('test');\n  }\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403279", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to configure Woocommerce Payment Methods programmatically? I'm currently developing a Wordpress Multisite website. I need to have the mainsites payment methods on all subsites (Any user should be able to create their own subsite, thats why I can't do this manually).\nOn this stackoverflow post they show how to get the payment gateways, but I wasn't able to find any information on how to modify those variables programatically.\nI have also found this post on how to unset any payment method, but again, they don't say how to set a new payment method or how to modify existing payment methods.\nI've tryed this code with no success:\nadd_filter('woocommerce_available_payment_gateways', 'filter_gateways', 1);\nfunction filter_gateways($gateways){\n    global $woocommerce;\n    switch_to_blog( 1 );   \n    $wc_gateways      = new WC_Payment_Gateways();\n    $mainsite_gateways = $wc_gateways->get_available_payment_gateways();\n    restore_current_blog();\n\n    return $mainsite_gateways;\n}\n\nAlso tried this just to be sure that it didn't work and nothing happened\nadd_filter('woocommerce_available_payment_gateways', 'filter_gateways', 1, 100);\nfunction filter_gateways($gateways){\n    global $woocommerce;\n    switch_to_blog( 1 );   \n    $mainsite_gateways = WC()->payment_gateways->get_available_payment_gateways(); //modified this\n    restore_current_blog();\n\n    return $mainsite_gateways;\n}\n\nI have a similar issue with emails. I need the mainsite email address to handle all woocommerce emails using the mainsite email templates...\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403280", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How can I remove the kses filters when saving a specific post type ? (it breaks my JSON) I want to store JSON in my post_content, but the kses filters makes it break.\nI would like to remove the kses filters when creating or updating (well, saving) a specific post type; anywhere in the code (thus using filters, I guess).\nHow could I do that ?\nThanks !\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403282", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to show parent taxonomy using get_the_terms? I have registered one custom taxonomy. I am using this code to show this taxonomy on single.php.\nBut it shows parent and child terms as well.\nfunction showorganisation()\n{\n    $terms = get_the_terms($post->ID, 'organization');\n    foreach ($terms as $term) {\n        $term_link = get_term_link($term, 'organization');\n        if (is_wp_error($term_link))\n            continue;\n        echo '<a href=\"' . $term_link . '\">' . $term->name . '</a>';\n    }\n}\n\nHow can I make it show parent terms only?\n\nA: get_the_terms() gives you an array of WP_Term objects. The object has parent (int) property, which tells you, if the term is a child and has a parent term or not.\nThis means that in your loop you can skip child terms with a simple if statement.\nforeach ($terms as $term) {\n\n  // Is it a child term?\n  if ( $term->parent ) {\n    continue;\n  }\n\n  // code...\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403285", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to disable login in iframe which is hosted in same domain? I want to disable auto login on iframe which is embeded in wordpress dashboard page. I have page(/booking) which uses login info to prefill customer data. I want to embed that page in iframe in wp-admin dasboard without being logged in. Is it possible.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403293", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Uncaught TypeError: extract(): Argument #1 ($array) must be of type array, null given My WordPress site is using a custom theme written by a third-party. I am getting the white screen error on my pages saying There has been a critical error on this website.\nIn attempt to diagnose the error I turned on debugging in the wp-config.php file with the following:\ndefine('WP_DEBUG', true);\ndefine( 'WP_DEBUG_DISPLAY', false );\ndefine( 'WP_DEBUG_LOG', true );\n\nI then checked the wp-content/debug.log and found the following error:\nPHP Fatal error:  Uncaught TypeError: extract(): Argument #1 ($array) must be of type array, null given in /home/.../public_html/.../wp-content/themes/.../includes/shortcodes/shortcode.tabs/_shortcode.advanced.tabs.php:301\nThe _shortcode.advanced.tabs.php section of code with the error is below. Line 301 with the error is near the beginning:\nextract($this->atts[ $this->id ]);\nfunction register_tab_item($atts, $tab_content =  NULL){\n    extract(shortcode_atts(array(\n        'title'             => '',\n        'icon'              => '',\n        'hash'              => '',\n    ), $atts));\n\n    if ( !isset($this->child[ $this->id ]) )\n        $this->child[ $this->id ] = 0;\n\n    $this->child[ $this->id ]++;\n\n    extract($this->atts[ $this->id ]);\n\n    $i = $this->child[ $this->id ]; \n    $tabs_count = $this->total[ $this->id ]; \n\n    $icon = cloudfw_make_icon($icon, 'ui--icon');\n\n    $hash = sanitize_html_class( $hash, \"tab-\". $this->id .\"-{$i}\" );\n    if ( !empty($hash) && ($hash[strlen($hash)-1] == '/') )\n            $hash .= '/';\n\n    if ( empty($title) && empty($icon) )\n        $title = \"Tab {$i}\";\n\n\n    $title = html_entity_decode(stripcslashes($title)); \n\n    $this->titles[ $this->id ] .= \"<li class=\\\"\";\n    if ( empty($title) ) {\n        $this->titles[ $this->id ] .= ' empty-title';\n    }\n\n    $this->titles[ $this->id ] .= \"\\\">\";\n    if ( $title_element ) {\n        $this->titles[ $this->id ] .= \"<$title_element>\";\n    }\n\n        $this->titles[ $this->id ] .= \"<a href=\\\"#{$hash}\\\">{$icon}{$title}</a>\";\n\n    if ( $title_element ) {\n        $this->titles[ $this->id ] .= \"</$title_element>\";\n    }\n    $this->titles[ $this->id ] .= \"</li>\";\n\n\n    $tab_content = do_shortcode($tab_content);\n    $this->contents[ $this->id ] .= \"<li class=\\\"hidden\\\">\";\n    $this->contents[ $this->id ] .= \"{$tab_content}</li>\";\n\n}\n\nEDIT\nI attempted to log more of the variables to help diagnose the error.\nThe variable logging is as follows:\n$this->atts = $atts;\nvar_dump($this->id);\nvar_dump($this->atts);\nvar_dump($this->atts[ $this->id ]);\n\nI am setting $this->atts = $atts; because $this->atts was empty before.\n$this->id is set to int(0).\n$this->atts is set to array(1) { [\"title\"]=> string(8) \"Overview\" }.\n$this->atts[ $this->id ] is returning NULL though. I'm not sure why this is though as I assume you can do index selection with an array in php.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403302", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: struggling to order by title i have the following page https://gundog.world/my-favorites/  (to view,user=stack pass=exchange)\nthe page functions correctly but i am trying to put the generated list into ascending order by post title. i have tried numerous $args but not seem to be correct. can any one see any obvious errors? please be kind this is only a hobby. many thanks in advance\nthe list generated are post types ,i am usinng the titles of the posts plus a few fields.\n<?php\n    // If this file is called directly, abort.\n    if ( ! defined( 'WPINC' ) ) {\n        die;\n    }\n\n$args = array( 'orderby' => 'title', 'order'   => 'ASC', );\n$object_id          = $item->object_id ;\n$object_type        = $item->object_type;\n$field = get_field('label', $object_id);\n  $value = $field['value'];\n  $label = $field['label'];\n    $user_id = get_current_user_id();\n\n\necho '<li class=\"cbxwpbookmark-mylist-item '.$sub_item_class.'\" style=\"text-align: center !important; list-style:none !important;\">';\n\n?>\n\n<div style=\"background: #dff0d8; border-radius: 5px; border:black 3px solid;padding: 15px; margin-bottom:10px;\">\n    <h2 class=\"club_title\"><div style=\"padding-top: 15px;\"><?php    do_action( 'cbxwpbookmark_bookmarkpost_single_item_start',$args,$object_id, $item );\n        echo '<a href=\"' . get_permalink( $object_id ) . '\">' . get_the_title( $object_id ) . '</a>' . $action_html;\n            do_action( 'cbxwpbookmark_bookmarkpost_single_item_end', $object_id, $item );?></div></h2>\n        <?php   $field = get_field_object('subs_due_for_renewal_on', $object_id);\n         echo '<div class=\"due_on\">'.$field['label']; ?><?php echo $field['value'].'</div>'; ?>\n<?php\n    $buttons = array(\n        'subs_paid' => 'Subs Paid: ',\n        'sched_rec' => 'Schedule Received: ',\n        'tri_ent' => 'Trials Entred: '\n    );\n    foreach($buttons as $key => $val){\n        $m_val = ucfirst(get_user_meta( $user_id, $key.'_'.$object_id, true ));\n        $a_class = '';\n        if( empty( $m_val ) ){\n            $m_val = 'No';\n        }\n        else if($m_val == 'Yes'){\n            $a_class = 'is_active';\n        }\n        echo '<button class=\"button button_toggle '.$a_class.'\" data-user_id=\"'.$user_id.'\" data-meta_key=\"'.$key.'_'.$object_id.'\" data-meta_value=\"'.$m_val.'\"><span>'.$val.' <span class=\"status\">'.$m_val.'</span></span></button>';\n    }\n    echo '<button class=\"button clear_line\" data-user_id=\"'.$user_id.'\" data-option_id=\"'.$object_id.'\">Clear Selections</button>';\n?>\n </div>\n<?php\necho    '</li>';\n\n*emphasized text*\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403311", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Old missing file in wp-content/uploads/ returns a 500 error, how to catch and redirect? I have a new site running but Google has an old PDF file indexed. The PDF file does not exist at that address on the new site, it's gone completely.\nThe odd thing to me is instead of the request coming back a 404, it's a 500. For example:\nhttps://example.com/wp-content/uploads/2019/2/obsolete.pdf gives me a 500, but if I remove the dated directories I get a 404. It seems multiple missing directories in the request cause this?\nAny advice or references for how a I can redirect to a 404 or the index when I get a 500 error for this type of request?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403314", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Remove all external links from posts I have website what contain hundreads articles.\nis there some way, how to remove all external links from all posts by one click/script?\n\nA: You can do this by a SQL query, example:\nUPDATE wp_posts\nSET post_content = CONCAT(\n    LEFT(post_content, LOCATE('<a', post_content) - 1), \n    SUBSTRING(post_content, LOCATE('</a>', post_content, LOCATE('<a', post_content) + 2) + 4))\nWHERE post_content LIKE '%<a%';\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403324", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Fatal error in wordpress htdocs I need help with this\n\nFatal error: Array and string offset access syntax with curly braces is no longer supported in /homepages/25/d502821911/htdocs/...../wp-includes/script-loader.php on line 757\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403325", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Determine if block has already been registered In gutenberg/block-editor, how can I check whether I've already registered a block type? Is there a function I can use? Searching through the Block Editor Handbook I couldn't see a function to check this.\nAn example of what I am trying to do is below:\nclass My_Block {\n\n    public function __construct() {\n        if ( ! SOME_FUNCTION_block_exists('foo/column') ) {\n            register_block_type( 'foo/column', my_args );\n        }\n    }\n    \n}\n\n\nA: EDIT\nI just realized you're doing this on the PHP side. There is a class called WP_Block_Type_Registry that you can use to see what is already registered:\n$registry = WP_Block_Type_Registry::get_instance();\nif ( ! $registry->get_registered( 'foo/column' ) ) {\n    // YOUR CODE\n}\n\nGutenberg should fire a console error if a block has already been registered. See the registerBlockType src here.\n\nA: When editing a page using Gutenberg, you can use the Developers Console to execute wp.blocks.getBlockTypes() and get all active registered blocks in Gutenberg.\nYou can also use the WP_Block_Type_Registry Class in order get all server-side registered Blocks.\nYou can than either use get_all_registered() or get_instance():\nWP_Block_Type_Registry::get_all_registered();\n\nor\nWP_Block_Type_Registry::get_instance()->get_all_registered();\n\nBoth do the same. get_instance() returns itself.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403327", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to make if statement in react plugin? I Create Guttenberg pluggin by react. My problem is that I cannot use if statement.\n const priceforextrashop =  parseFloat(props.priceextra)\n const priceforegoodshop = parseFloat(props.pricegoood)\n const priceforstandardshop = parseFloat(props.pricestandard)\n const priceforsmallshop = parseFloat(props.pricesmall)\n   React.useEffect(() => {\n     if(wynik<20000){\n      setPrice(priceforextrashop);\n    }\n     if(wynik<15000){\n      setPrice(priceforegoodshop);\n    }\n     if(wynik<10000){\n      setPrice(priceforstandardshop);\n    }\n   if(wynik<5000){\n    setPrice(priceforsmallshop);\n  }\n\n}, [wynik]);\n\nprops.prices reffer to attritubutes I add on editor-block side of plugin. The value work good, I  exposed them on screen.\nproblem is just with these if statement because always show the same value.\nI know that the if statement should work good because on editor-black side or in another scripts, I put the same if statement and it worked.\nPlease indicate me answer.\nupdate:\nI add dependence \"wynik\" but it not resolve my problem. Just count 2from 4 variables not all of them.\nI try without useEffect but then it make an error.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403328", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to show related post having same relationship filed under single CPT? I have registred two CPT.\n1= Exam\n2= Exam Type\nHere i have added relationship filed to exam {1st} CPT. CPT 2 have 20-30 posts.\nNow I want show related posts under 1st CPT from same cpt having same relationship filed.\nI tried everything but nothing worked.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403330", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: \"transition_post_status\" action creating two post with wp_insert_post What I'm tiring,  I've created a custom post-type called the recipe\nwhen creating a new post on the recipe, I have inserted a new post on another post-type\nit working fine but post created two times on every published post\n    function post_create_on_publish_only( $new_status, $old_status, $post ) {\n\n   if ( ( 'publish' === $new_status )\n       && 'recipe' === $post->post_type\n   ) {\n      $my_post = array(\n         'post_title'    => get_the_title($post),\n         'post_status'   => 'publish',\n         'post_type' => 'wpcf7_contact_form',\n      );\n      $get_post = get_page_by_title(get_the_title($post));\n      if ( !is_page($get_post->ID) && did_action( 'transition_post_status' ) === 1){\n         $id = wp_insert_post( $my_post );\n      }\n   }\n}\nadd_action( 'transition_post_status', 'post_create_on_publish_only', 10, 3 );\n\n\nHow can I solve this issue? anyone can help me?\n\nA: I remember having a similar issue in a passed and checking if someone published custom post type first was solving the issue for me, something like this:\nadd_action( 'transition_post_status', 'post_create_on_publish_only', 10, 3 );\nfunction post_create_on_publish_only( $new_status, $old_status, $post ) {\n\n    if ( ( $new_status == 'publish' ) && ( $old_status != 'publish' ) && ( $post->post_type == 'recipe' ) ) {\n        $my_post = array(\n            'post_title'    => get_the_title($post),\n            'post_status'   => 'publish',\n            'post_type' => 'wpcf7_contact_form',\n        );\n        $get_post = get_page_by_title(get_the_title($post));\n        if ( !is_page($get_post->ID) && did_action( 'transition_post_status' ) === 1){\n            $id = wp_insert_post( $my_post );\n        }\n    } else {\n        return;\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403332", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: You do not have permission to create Navigation Menus - Twenty Twenty-Two theme I have a WP Multisite, where I am the super-admin of the Network and the only admin (also super-admin) of this particular site.\nEverything is working fine, but whenever I try to edit/add Navigation menu, it keeps giving this error you do not have permission to create Navigation Menus\nI have checked database, the wp_capabilities in wp_usermeta are a:1:{s:13:\"administrator\";s:1:\"1\";} which I checked should be for the admins. The value is also 10 in wp_user_level column.\nWhat else can I do/check in order to change the Navigation Menu?\nThanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403333", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Ajax on the Administration Side of plugin - returns 0 I have built a plugin and  I need to use ajax in the admin and have followed the documentation here:  https://codex.wordpress.org/AJAX_in_Plugins\nHowever, the response I keep getting is 0.\nI know there are many posts with the same issue and I have been through them all but cannot find the solution for me.  Please help.\nI use a class for the plugin and have the jquery in a seperate file.\nmyplugin-admin.js\nfunction getFeatureIDs(selectObject){\n    var value = selectObject.value;  \n    console.log(value);\n    console.log(ajax_object.we_value);\n    console.log(ajax_object.ajax_url);\n    var data = {\n        'action': 'get_etim',\n        'whatever': ajax_object.we_value   \n    };\n   \n    \n    jQuery.post(ajax_object.ajax_url, data, function(response) {\n        alert('Got this from the server: ' + response);\n\n    });\n\n}\n\nclass-myplugin-admin.php\nclass myplugin_Admin {\n    private $myplugin;\n    private $version;\n\n    public function __construct($myplugin,$version ) {\n        \n        add_action('wp_ajax_get_etim', 'get_etim');\n        add_action( 'wp_ajax_nopriv_get_etim', 'get_etim' );\n    }\n\n    public function enqueue_scripts() {\n\n        wp_enqueue_script( $this->myplugin, plugin_dir_url( __FILE__ ) . 'js/myplugin-admin.js', array( 'jquery' ), $this->version, false );\n\n        wp_localize_script( $this->myplugin, 'ajax_object', array( 'ajax_url' => admin_url( 'admin-ajax.php' ), 'we_value' => 1234 ) );\n    }\n\n    public function get_etim() {\n\n        echo $_REQUEST['whatever'];\n\n        wp_die();\n    }\n}\n\nResults in console:\nEC003025\n1234\nhttps://mytestsite.plesk.page/wp-admin/admin-ajax.php\n\nAlert is always,\n\n\"Got this from the server: 0\"\n\nwhich suggests the action function is not being called.\nPlease, what am I missing?\nThanks\n\nA: This is because you chose to use a class but did not change the add_action to account:\nadd_action( 'wp_ajax_nopriv_get_etim', 'get_etim' );\n\nThat is not how you hook a class function to an action or filter. So your Javascript is correct, but your handler is not connected to the hook. That is why your AJAX handler fails, incorrect use of add_action.\nThe solution here is the same as the other questions on the site asking how to hook a class function.\nGeneral notes:\n\n*\n\n*the use of a class does not improve this code, it is not OO\n\n*\n\n*ask yourself, if it's meant to call get_etim, which get_etim? a class can be turned into an object multiple times, how would it know which one to call? And if you only create/use it once what was the point of the class\n\n\n\n*this is using the old legacy API, you should use the new REST API for AJAX via register_rest_route which avoids lots of pitfalls, and gives you a pretty URL to make requests to\n\n*The codex is old and was retired several years ago, and can contain out of date information. You should refer to the developer page instead at https://developer.wordpress.org/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403334", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Contact form 7 - automatic email delay I would like to ask if there is a way to automatically delay emails after completion?\nI want these emails to arrive 1-2 hours later.\nIs there a snippet of code for this?\nThank you!\n\nA: not tested but maybe you could simply use sleep using wpcf7_before_send_email\nsomething like this:\nadd_action(\"wpcf7_before_send_mail\", \"wpcf7_pause_send\");  \nfunction wpcf7_pause_send($cf7) {\n    \n    sleep(3600);\n}\n\n\nA: I don't know CF7 well enough to give you specifics, but I think you'll need to\n\n*\n\n*Write the form data to the database so you can read it back later, when you want to send the email. I don't believe CF does this automatically (although e.g. Gravity forms do)\n\n*On submission\n\n*\n\n*Cancel the existing email send: I'd guess there's an event you can hook and return false that'll do this\n\n*Either schedule a one-off event for two hours time using wp_schedule_single_event() and the saved data's database ID, and in that event handler call back to the CF7 with the data to send the email, and then either deletes the saved form data from the database or otherwise marks it as sent\n\n*Or set up a regular scheduled job with wp_schedule_event() that runs every five minutes or so and checks if it needs to send any emails, e.g. there is a new saved form data record from >2 hours ago that is not already marked as sent in the database, and if so sends the email and marks that form sent\n\n\n\n*Depending on your traffic levels you may want to set up an alternative cron mechanism to ensure these jobs run on time: Hooking WP-Cron into the system scheduler\nAlternatively depending on how you're sending emails you may be able to generate them on the initial form submission to be sent later, e.g. if you're sending them through Outlook.com or if your wp_mail hander has built-in retry and scheduling (as I'd guess WP Offload SES might?)\n\nA: In some cases, if you are not logged in on your site your form doesn't get submitted. Try submitting the form being logged in on site.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403342", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Getting white screen of death on category pages because of body_class() function Category pages \"example.com/categeories/blah\" were working fine and then suddenly started showing white screens.\nDebug showed no output. No errors in apache logs either. So I started debugging with print statement and found the issue in header.php file: Commenting out body_class fixes the issue and the category pages load:\n<body <?php //body_class(); ?>>\nHow might I find the root cause of this problem?\nUPDATE: Commenting out this code in get_body_class() function fixes the problem, too:\n            } elseif ( is_category() ) {\n                        /*\n                        $cat       = $wp_query->get_queried_object();\n                        $classes[] = 'category';\n                        if ( isset( $cat->term_id ) ) {\n                                $cat_class = sanitize_html_class( $cat->slug, $cat->term_id );\n                                if ( is_numeric( $cat_class ) || ! trim( $cat_class, '-' ) ) {\n                                        $cat_class = $cat->term_id;\n                                }\n\n                                $classes[] = 'category-' . $cat_class;\n                                $classes[] = 'category-' . $cat->term_id;\n                        }\n                         */\n\nUPDATE 2: This is really weird. If I drop a echo '.' statement right after the $cat       = $wp_query->get_queried_object(); line in the portion of the get_body_class function shown above, everything works! If I do echo ' ' instead, it breaks again! WTF???\nUPDATE 3: This is also really weird. If I get rid of the echo statement and change the $classes[] = 'category'; to $classes[] = ''; the problem if fixed as well. In fact, if I change it to any other string, it works. So it only chokes when it is set to category. How weird is that?\n\nA: OK, figured out this bizarreness. My big mistake: assuming a white screen of death was some kind of code error with PHP. It was actually some badly coded css on my part that hid the entire body from view! All I had to do is look at the source code to see all the code was there.\nSo that explains why there were no errors and why throwing an echo statement that output to the screen magically \"fixed\" things; because it broke the css rendering.\nOne of those days.\nAnd pro tip: don't work on 3 hours of sleep.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403344", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Making a column vector in wordpress blog using Latex I am new to blogging and using latex here. I want to make a column vector as\n\nI can do this in regular latex platforms like overleaf.\nBut when I type\n$latex h = \\begin{bmatrix}\n\nh_1 \\\\\n\nh_2 \\\\\n\n\\vdots \\\\\n\nh_n\n\n\\end{bmatrix}\n\n$\n\nin WordPress, nothing happens and I get the exact same output in the preview.\nSo, how do I make a column vector?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403349", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can I automatically assign a page template to a custom post type (i.e page-slug.php file) I am making my first WordPress theme and I am trying to assign a page template to my custom post type automatically. (i.e page-slug.php)\nAs an example: you can make a page file in WordPress called page-events.php and then when you create a page called Events, it will automatically select this template to use instead of you having to go into the page and manually select the template.\nI have made a custom post type 'Products' and I want to make several custom templates files to use with this post type in my theme.\nBut I want to make the theme automatically select the template based on the page name like the example above. However, when I make a page called \"View Products\" and a template file called page-view-products.php, it does not automatically select the template for me.\nIs there a way to make WordPress automatically select the template for the custom post type?\nI tried naming the file products-view-products.php, thinking you put the custom post type in the file name, but that doesn't work.\nTo be clear, I want each page to have a unique template that is selected autmatically based on the page name, just like wordpress already does for the Pages post type.\nI know how to manually select a custom template in the dashboard for my custom post type, that works fine. But I cannot find the answer for this question anywhere, so any help would be appreciated.\nI am still a novice at theme development, but it is so fun!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403360", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Ajax on the Administration Side of plugin - wp_localize_script - how to pass value from JQuery to PHP function in class? I have built a plugin and  I need to use ajax in the admin and have followed the documentation here:  https://codex.wordpress.org/AJAX_in_Plugins\nHowever, this is out of date and I cannot find any good examples to get it working.\nI use a class for the plugin and have the jquery in a seperate file.  So apparently I need to use the wp_localize_script to pass the variables.  This is where I am struggling to understand how to pass the variable from the selectObject.value in the JQuery to the PHP function.\nCan anyone assist?\nmyplugin-admin.js\nfunction getFeatureIDs(selectObject){\n    var value = selectObject.value;  \n    console.log(value);  //I want to pass this value but it doesnt work\n    console.log(ajax_object.we_value); \n\n    var data = {\n        'action': 'get_etim',\n        'whatever': ajax_object.we_value   \n    };\n   \n    \n    jQuery.post(ajax_object.ajax_url, data, function(response) {\n        alert('Got this from the server: ' + response);\n\n    });\n\n}\n\nclass-myplugin-admin.php\nclass myplugin_Admin {\n    private $myplugin;\n    private $version;\n\n    public function __construct($myplugin,$version ) {\n        \n        add_action( 'wp_ajax_get_etim', array( $this, 'get_etim' ) );\n\n    }\n\n    public function enqueue_scripts() {\n\n        wp_enqueue_script( $this->myplugin, plugin_dir_url( __FILE__ ) . 'js/myplugin-admin.js', array( 'jquery' ), $this->version, false );\n\n        wp_localize_script( $this->myplugin, 'ajax_object', array( 'ajax_url' => admin_url( 'admin-ajax.php' ), 'we_value' => 1234 ) );\n    }\n\n    public function get_etim() {\n\n        echo $_POST['whatever'];\n\n        wp_die();\n    }\n}\n\nResults in console:\nEC003025\n1234\nhttps://mytestsite.plesk.page/wp-admin/admin-ajax.php\n\nAlert is,\n\n\"Got this from the server: 1234\"\n\nThis needs to be the select variable.\n\nA: You put your value JS variable that you created in the data that gets sent to your php function via ajax like:\nvar data = {\n    'action': 'get_etim',\n    'whatever': ajax_object.we_value,\n    'select_value': value   \n};\n\nThen in the php function that Ajax sends to  you can use select_value the same way you used whatever in your code like:\necho \u201cWhatever is: \u201c . $_POST[\u2018whatever\u2019] . \u201c, and Select value is: \u201c . $_POST[\u2018select_value\u2019];\n\nDon\u2019t forget to use a nonce, sanitize input data, and escape output.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403362", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How many .htaccess files should a Wordpress multisite (subdirectory set up) have? We have a multsite subdirectory site with two sites.  We set this up several years ago and everything has been working correctly until recently.  One thing I'm trying to find out is how many htaccess files there should be in the whole directory structure.  We currently have two; one at the root of the directory and one inside of the wordpress folder.  Are both needed?  If not, which one is not needed?  Thank you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403365", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Combine 2 arrays in a query parameter I'm trying to exclude upsells using post__not_in but I already have a value and do not know how to combine the two.\nI tried this:\n'post__not_in' => get_upsell_ids(), [get_the_ID()]\n\nBut it is not working.\nMy code:\nfunction eligo_custom_related_products_by_label() {\n    \n    if (is_product() && has_term('records', 'product_cat')) {\n\n        global $post;\n\n        if ( ! $post ) {\n            return;\n        }\n\n        $related_by_same_label = wp_get_post_terms($post->ID, 'pa_label', ['fields' => 'slugs']);\n\n        $args = [\n            'post_type' => 'product',\n            'post_status' => 'publish',\n            'orderby' => 'rand',\n            'posts_per_page' => 4,\n            'post__not_in' => [get_the_ID()],\n            'tax_query' => [\n                'relation' => 'AND',\n                [\n                    'taxonomy' => 'product_visibility',\n                    'field'    => 'name',\n                    'terms'    => array('outofstock'),\n                    'operator' => 'NOT IN'\n                ],\n                [\n                    'taxonomy' => 'pa_label',\n                    'field' => 'slug',\n                    'terms' => $related_by_same_label,\n                    'operator' => 'IN',\n                ],\n            ],\n        ];\n\n        $loop = new WP_Query($args);\n\n        if ($loop->have_posts()) { ?>\n\n            <section class=\"related products\">\n                <div class=\"related__inner\">\n                    <?php\n                    $attribute_names = ['pa_label'];\n                    foreach ($attribute_names as $attribute_name) {\n                        $taxonomy = get_taxonomy($attribute_name);\n                        if ($taxonomy && !is_wp_error($taxonomy)) {\n                            $terms = wp_get_post_terms($post->ID, $attribute_name);\n                            $terms_array = [];\n                            if (!empty($terms)) {\n                                foreach ($terms as $term) {\n                                    $archive_link = get_term_link($term->slug, $attribute_name);\n                                    $full_line = '<a href=\"' . $archive_link . '\">' . $term->name . '</a>';\n                                    array_push($terms_array, $full_line);\n                                }\n                                echo '<h3 class=\"section__title\">' . esc_html__('More from', 'eligo') . ': ' . implode(', ', $terms_array) . '</h3>';\n                            }\n                        }\n                    }\n\n                    woocommerce_product_loop_start(); \n\n                    while ($loop->have_posts()):\n                        $loop->the_post();\n                        wc_get_template_part('content', 'product');\n                    endwhile;\n                    \n                    ?>\n                </div>\n            </section>\n            <?php\n\n        } \n\n        wp_reset_postdata();\n    }\n}\nadd_action('woocommerce_after_single_product_summary', 'eligo_custom_related_products_by_label', 20);\n\nThanks in advance.\n\nA: This does not work because this is not how you merge two arrays:\n'post__not_in' => get_upsell_ids(), [get_the_ID()]\n\nInstead you need to take those 2 arrays and combine them using array_merge, a standard PHP function:\nhttps://www.php.net/manual/en/function.array-merge.php\nNote that __not_in type parameters have a very high performance cost and do not scale, this query will be very slow and require caching.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403368", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why WordPress is picking archive.php instead of page.php? I have a Custom Post Type (CPT) called \"Careers\" with \"careers\" as slug.\nI created my Careers listing page with Elementor (the page slug is also \"careers\"), dropped the Posts widget and used the Query settings to select my Careers CPT. Then I used Elementor again to create a Single post theme for my single careers posts. The single posts are working okay but now when I click back to my Careers listing page, I get the archive page that doesn't look anything like the page I created with Elementor (I see the page is now using archive.php with Reveal template plugin). I tried to force the template by selecting a custom page template, but that didn't help. I also tried resetting the Permalinks, that didn't help either.\nWhen I try to open my Careers page in Elementor, I get the \"Preview could not be loaded Error\".  When I change the page URL from \"careers\" to \"career\" or \"open-positions\" then the error goes away, I can open the page with Elementor now (with a new slug).\nIs this a correct assumption that the CPT slug cannot be the same as the page slug? Is there a better way to accomplish this (preferably with the same slug for both the page and the CPT)? Or even with the help of Elementor pro?\nThis is my CPT code:\nfunction create_careers_posttype() {\n    register_post_type( 'careers',\n        array(\n            'labels' => array(\n                'name' => __('Careers'),\n                'singular_name' => __('Career')\n            ),\n            'public' => true,\n            'has_archive' => true,\n            'rewrite' => array('slug' => 'careers'),\n            'show_in_rest' => true,\n            'supports' => array('title', 'page-attributes'),\n        )\n    );\n}\nadd_action( 'init', 'create_careers_posttype' );\n\n\nA: You can't use the slug careers as a page slug as it's already in use as the CPT name. /careers is your post types archive, that is why it's loaded archive.php and not page.php.\nEven if you did have a page with that slug, the archive rewrite rule has a higher priority. You'll also find it in the generated sitemap, and the /careers slug is also used to generate the permalinks for individual posts of that type.\nThe closest you can get is turning off the archive.\n\nI tried to force the template by selecting a custom page template but that didn't help.\n\nThis doesn't work because the page is never what is being displayed to begin with. WordPress believes based on the main query it is on an archive of posts of type careers and will behave according to the standard template hierarchy, choosing the most specific template it can find that matches. E.g. if archive-careers.php was available it would have loaded that instead.\nRemember, the template chosen is determined by the parameters of the main query. WordPress didn't load a page because you were on page.php, it's the other way round, it loaded page.php because the main query said it was for a page, and it may decide to load a custom page template if that page in the query specifies one. But if it's an archive that doesn't happen. Look at the template hierarchy for more details.\n\nOr even with the help of Elementor pro?\n\nIf you want to style that archive using Elementor, then you will need to contact Elementor support or post in an Elementor community. 3rd party plugin dev support is off topic here and not in this stacks scope.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403370", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP REST API GET Method Works But Not The POST Method I'm just trying to learn how to develop with WordPress Gutenberg. No problem with GET Method however with the post method anything I try results in an errors message No route was found matching the URL and request method. How can I send the data under a POST method?  Going into store is a bit much for something this simple.\nedit.js\nexport default function Edit({attributes, setAttributes }) {\n\nconst { getCurrentPostId } = wp.data.select(\"core/editor\");\n\nconst onPriceChange = (new_price) =>{\nsetAttributes({price:new_price});\n\nif(document.readyState != 'loading'){\n    woobergSendRequest(new_price);\n}else {\n    document.addEventListener('DOMContentLoaded', woobergSendRequest);\n}\n\n}\n\nfunction woobergSendRequest(new_price){\n\nconst post_id = getCurrentPostId();\nconst get_url = 'wooberg/v2/product?_method&product_id='+post_id+'&product_price='+new_price;\nconsole.log(post_id);\n\nconst sendData = {product_id:459,product_price:1.00};\n\napiFetch( {\n    path: 'wooberg/v2/product',\n    method:'POST',\n    data:sendData\n} ).then( data => {\n    console.log( data );\n} );\n   }\n\n\n return (\n\n\n\n<div { ...useBlockProps() }>\n\n    \n\n<NumberControl\n        isShiftStepEnabled={ true }\n        onChange={ onPriceChange}\n        step={0.01}\n        shiftStep={ 0.01 }\n        value= { attributes.price}\n    />\n\n    \n</div>\n );\n\n}\n\nindex.php\nadd_action('rest_api_init', function () {\n\n    register_rest_route( 'wooberg/v2', '/product', [\n        'method'   => 'POST',\n        'callback' => 'wooberg_product_price_callback',\n        'args' => [\n            'product_id' => [\n                'required' => false,\n                'type' => 'number,'\n            ],\n\n            'product_price' => [\n                'required' => false,\n                'type' => 'number,'\n            ],\n        ],\n        'permission_callback' => function(){\n            return current_user_can( 'edit_others_posts' );\n           \n       } \n    ]  \n);\n\n\n });\n\n\n  function wooberg_product_price_callback($request){\n\n\n\n$product_id = $request->get_param('product_id');\n$product_price = $request->get_param('product_price');\n\n$product_id = $request['product_id'];\n$product_price = $request['product_price'];\nif(! empty($product_id)){\n\n    $product = wc_get_product($product_id);\n    $curret_price = $product->get_price;\n    $product->set_price($product_price);\n    $product->set_regular_price($product_price);\n    $product->save();\n\n\n    $response = $product->get_name() .'Has be update from '. $curret_price .' to '.$product->get_price();\n     return rest_ensure_response( $response,200 );\n}else{\n    $response = \"No Id found\";\n    return new WP_REST_Response( [\n        'message' => 'Product was not found',\n    ], 400 );\n}\n \n    \n\n}\n\nA: Your apiFetch() usage is correct, but you're getting the \"No route was found\" error because of the 'method'   => 'POST' part which should actually use methods and not method. (Note that an endpoint can allow one or more HTTP methods)\nSo when it's method, it's not used and thus the HTTP method defaults to GET only.\nAnd all you need to do is use 'methods'   => 'POST' (or 'methods'   => 'GET,POST' if you wanted to allow both GET and POST methods), and the error would be gone.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403373", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: {$taxonomy}_row_actions for all custom taxonomies I want to add a row action to ALL custom taxonomies.  This is for use in a plugin so I want this to apply to whatever taxonomies exist rather than adding a filter for each taxonomy manually like below.  I can't figure out a simple way to do this.\n    add_filter( 'category_row_actions', 'category_row_actions', 10, 2 );\n\n\nA: You could use the tag_row_actions hook (which was deprecated in WP v3.0.0, but then restored in WP v5.4.2) to target any taxonomies (Tags/post_tag, Categories/category, a_custom_taxonomy, etc.), so just replace the category_row_actions with tag_row_actions:\nadd_filter( 'tag_row_actions', 'category_row_actions', 10, 2 );\n\nOr you could use get_taxonomies() with an early hook like admin_init (that runs after init), and then add your filter for the target taxonomies like so:\nadd_action( 'admin_init', function () {\n    // This adds the filter for *all* taxonomies.\n    foreach ( get_taxonomies() as $taxonomy ) {\n        add_filter( \"{$taxonomy}_row_actions\", 'category_row_actions', 10, 2 );\n    }\n\n/*\n    // This one adds the filter for *public* taxonomies only.\n    foreach ( get_taxonomies( array( 'public' => true ) ) as $taxonomy ) {\n        add_filter( \"{$taxonomy}_row_actions\", 'category_row_actions', 10, 2 );\n    }\n*/\n} );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403374", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: code block does not show in excerpt I am creating some blog pages with example codes, and I would like to show the codes in excerpts, but WordPress automatically excludes code blocks from excerpts, is there a workaround for showing code blocks in the excerpt?\n\nA: Try getting it in raw form from the DB:\nglobal $wpdb;\n$post_excerpt = $wpdb->get_var(\n        $wpdb->prepare(\n            \"SELECT post_excerpt FROM $wpdb->posts\n             WHERE ID = %d\n            \",\n            $post->ID\n        )\n    );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403377", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP_Query orderby I am trying to workout the best way to do a slightly abnormal orderby.\nI have a query that returns 2 types (Post and Event). As expected by default it orders both, together, by publish date.\nWhat I want is, posts to be ordered by publish date, events by event->start_date\nI could just get them, loop over them and manually sort myself, but that seems counter intuitive.\nAny help much appreceiated.\nCheers\nDrogo\n\nA: You can do this by adding these two lines in your query:\n'orderby' => 'publish_date',\n'order' => 'ASC',\n\n\nA: In the code below I assume that event->start_date is a post meta field on the Event post type.\n'orderby' => array(\n    'meta_value'   => 'ASC',\n    'publish_date' => 'DESC'\n),\n'meta_key'  => 'start_date',\n'meta_type' => 'DATE',\n\nThis assumes that the Posts don't have the start_date meta set, ie, that it's only present for the Events. Also I've assumed you want the Events in ascending order by their start_date and the Posts in descending publish_date order.\nReference\n\n*\n\n*WP_Query Order/Order By\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403379", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add videos/images preview to bbPress attachment In my blog I installed bbPress with few plugin such as GD bbPress Attachments, GD bbPress Tools and Image Upload for BBPress.\nWhen I create a new post, I can upload new images or videos and I can see a thumb for each of them.\nI like to show the attachment as a big image or a player if it is a video.\nHow can I do that?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403380", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: cURL External API request displays content above other content on page I've built a plugin to display our customer feedback on our WordPress website. We use an external feedback system called 'Customer Thermometer'. They have a simple API to use a URL to request stats and comments etc. This example is showing total stats but I have a bigger comments block function that shows recent comments in a slider.\nSample URL to get the total responses back: https://app.customerthermometer.com/api.php?apiKey=[apiKey-here]&getMethod=getNumResponsesValue\nI can get the responses back fine using the code below but the cURL request and code I implement is always at the top of the page regardless of where I add the shortcode.\nCall method in my class 'picts_ct_api_connection':\npublic function call($call) {\n\n    $url = $this->get_url();\n    $apikey = $this->get_api_key();\n    $method = $this->build_apicall($call);\n    \n    $request_url = $url.$apikey.$method;\n    \n    $curl = curl_init($request_url);\n\n    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);\n    curl_setopt($curl, CURLOPT_VERBOSE, 1);\n    curl_setopt($curl, CURLOPT_POST, false);\n    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);\n    curl_setopt($curl, CURLOPT_HEADER, false);\n\n    $response = curl_exec($curl);\n\n    curl_close($curl);\n\n    return $response;\n}\n\nShortcode function to display response\nfunction picts_ct_responses( $atts = [], $content=null, $tag='' ) {\n\n    $method = array(\n        'getMethod' => 'getNumResponsesValue'\n    );\n \n    $api_call = new picts_ct_api_connection();\n\n    $response = $api_call->call($method);\n\n    echo $response;\n}\nadd_shortcode( 'total_responses', 'picts_ct_responses' );\n\nI've added my shortcode here (shown below) in the middle of some dummy text on my page:\n\nBut it shows on my page here:\n\nI also get a JSON responses error when saving the page so I feel it's something to do with the cURL response printing to the page early and not being added to my variable and being used in the correct place.\nI've searched online and not found anything to help on this. Any help would be much appreciated.\nJohn\n\nA: Excerpt from the Shortcode API handbook (italic formatting added by me):\n\nThe return value of a shortcode handler function is inserted into the\npost content output in place of the shortcode macro. Remember to\nuse return and not echo \u2013 anything that is echoed will be output to the browser, but it won\u2019t appear in the correct place on the page.\n\nSo the issues in question (misplaced output and JSON responses error) happened because you used echo $response; instead of return $response; in your shortcode handler function, i.e. picts_ct_responses().\nAnd to fix the issues, all you need to do is simply replace that echo with return and the error would be gone.\n\nAdditionally, WordPress provides various helper functions like wp_remote_get() for making HTTP requests to an external service/API/website, so you should use those helper functions instead of manually calling cURL functions like curl_setopt().\nAnd you'd also would want to cache (e.g. using the Transients API) the responses received from your HTTP requests for performance reasons, particularly in the case of shortcodes which can be automatically called multiple times on the same page.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403381", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is @wordpress/env locked to node v14 or can I also use node v16? Can I use node v16 with @wordpress/env? Docs seems to force you to install v14, but I need v16 for other projects.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403382", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: WordPress CPT Taxonomy Dashboard Search - How to include taxonomy in search? I am having great difficulty extending my Custom Post Type (CPT) with custom taxonomies to have taxomonies that are searchable when viewing the posts in the WordPress Dashboard.\nThe CPT's and taxonomies are added easy enough using functions everyone will be familiar with if you're now looking to add the search functionality (keeping this a brief list of functions as this is not related to the question, further information can be found by searching for how to create a CPT or how to filter CPT by taxonomy):\nregister_post_types()\nheading_columns()\ncustom_columns()\nsortable_columns()\nsortable_column_query()\n\nAfter plugging in the specifics of a CPT into the above functions I now have my CPT showing in my WordPress dashboard, along with columns headed with the taxonomies I wish to search, the taxonomies can be clicked and ordered into alphabetical order ASC & DESC.\nThere is also a search box stating 'Search CPT'. If I make use of this, the results are only ever shown if I search the title of the posts. This is where the question I have spent hours researching with no success comes in.\nHow do I extend this CPTs Dashboard search bar to include taxonomies?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403384", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Leave focus on custom Gutenberg block when pressing enter I have a Gutenberg block. It works as expected. However when I press enter it doesn't create a new paragraph.\nrender() {\n    const {value, onUpdate, className} = this.props;\n\n    return (\n      <div className={className}>\n        <PlainText\n          placeholder=\"Placeholder...\"\n          onChange={content => onUpdate(content)}\n          value={value}\n        />\n      </div>\n    );\n  }\n\nI would like to make it that it leave the focus and create a new paragraph like in core/paragraph.\nHow can I accomplish this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403386", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how give a link to an Elementor Pro widget with variable part I'm trying to give link to one button in Elementor like this (for sharing the post on a social media site):\nhttps://eitaa.com/share/url?url={url}\n\nby {url} I mean the current post url. but when I put this as link for button it doesn't work\nanyone can help?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403388", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Javascript fetch on wordpress plugins not working I'm using onesignal that sends notifications but the onesignal popup is not showing and it's giving and error. After tracking the error a noticed that the fetch method that is using the api to get the image of the popup from onesignal.\nconst response = await fetch(url);\n\nthe response is coming as undefined from onesignal but if I try it on different site the api works good.\nThe error message is : 'There was an error showing the OneSignal Slidedown: TypeError: Cannot read properties of undefined (reading 'json')'\nbut i have the same error when i try to sync the yoast seo\n\nif anyone can know what is blocking this api.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403389", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Auto Delete Users (auto_delete_users) I need some help cause I couldn't find any solution for my problem and haven't the knowledge to solve the problem on my own.\nWhat I'm trying to do:\nI want to delte every WordPress user (subscriber) which is older than X days. For testing purposes I needed short intervals, in production the users should be deleted after 6 months. So each subscriber should be deleted after 6 months, after their registration.\nWhat I've tried for testing purposes:\nfunction wcs_auto_delete_users() {\n    global $wpdb;\n    $query = $wpdb->prepare( \"SELECT ID FROM $wpdb->users WHERE datediff( now(), user_registered ) > 0.1\" );\n    if ( $oldUsers = $wpdb->get_results( $query, ARRAY_N ) ) {\n        foreach ( $oldUsers as $user_id ) {\n            wp_delete_user( $user_id[0] );\n        }\n    }\n}\nadd_action( 'wcs_daily_clean_database', 'wcs_auto_delete_users' );\nwp_schedule_event( time(), 'hourly', 'wcs_daily_clean_database' );\n\nThe snippet above works, but it deletes every user, which I don't want.\nSo that's what I've tried further for testing purposes:\nfunction auto_delete_users() {\n    global $wpdb;\n    $userlevel = 0; //0 = subscriber\n    $deleteafter = (1/48); //delete User after 30 mins\n\n    $query = $wpdb->prepare(\"SELECT $wpdb->users.ID FROM $wpdb->users LEFT JOIN $wpdb->usermeta ON $wpdb->users.ID = $wpdb->usermeta.user_id WHERE $wpdb->usermeta.meta_key = %s AND $wpdb->usermeta.meta_value = %d AND DATEDIFF(CURDATE(), $wpdb->users.user_registered) > %d\", $wpdb->prefix.'user_level',$userlevel,$deleteafter);\n\n    if($oldUsers = $wpdb->get_results($query, ARRAY_N)){\n        foreach ($oldUsers as $user_id) {\n            wp_delete_user($user_id[0]);\n        }\n    }\n}\nadd_action('daily_clean_database', 'auto_delete_users');\nwp_schedule_event(time(), 'hourly', 'daily_clean_database');\n\nThe snippet above doesn't work and maybe you could explain what I'm doing wrong or what I would have to adjust.\nI also tried to schedule the event with \"cron_schedules\" every 15 minutes to avoid waiting 1 hour to call the function, but that's not important now.\nYour help would be much appreciated.\n\nA: You do not need to use raw SQL, WordPress already provides WP_User_Query, and even provides examples of date based queries, for example the official docs say that this will retrieve all users registered within the last 12 hours:\n$args = array(\n    'date_query' => array( \n        array( 'after' => '12 hours ago', 'inclusive' => true )  \n    )\n);\n$user_query = new WP_User_Query( $args );\n\nTaken from: https://developer.wordpress.org/reference/classes/wp_user_query/#date-parameters\nWhich suggests this might work:\n$args = [\n    'date_query' => [\n        [\n            'before' => '6 months ago',\n            'inclusive' => true\n        ]\n    ]\n];\n$user_query = new WP_User_Query( $args );\nif ( ! empty( $user_query->get_results() ) ) {\n    foreach ( $user_query->get_results() as $user ) {\n        echo '<p>delete: ' . $user->display_name . '</p>';\n    }\n} else {\n    echo 'No users found.';\n}\n\nIf you need to use raw SQL to get something in WordPress and you're not working with custom tables, then it generally means you've done something wrong or aren't aware of an important core API or parameter.\nOther things to note:\n\n*\n\n*This won't scale if your site gets popular as there's no limit on how many users your query fetches, you should run this more often and in batches\n\n*unless your host has a system level cron job this won't happen exactly every 6 months, there'll be a little variance depending on how busy your site is\n\n*there may be legal and regulatory obligations that require longer than 6 months, if the goal here is to prevent access after a subscription for example then this isn't the best way (no upsells to re-subscribe? Or message that the 6 months are up?)\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403390", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Getting different functions data while using while loop in wordpress I have added this code in the function.php file but when I use while loop in any other files this function is getting triggered.\n<?php\nadd_action('loop_start', 'userlogin');\nfunction userlogin()\n{\nif (is_user_logged_in()) :\n$current_user = wp_get_current_user();\n?>\n    <div class=\"dropdown na-dropdown\">\n        <button class=\"na-btndropdown\" id=\"na-dropdowndashboard\" type=\"button\" data-toggle=\"dropdown\">\n            <img src=\"<?php echo esc_url(get_avatar_url($current_user->ID)); ?>\" alt=\"User Image\">\n            <span><?php echo $current_user->display_name; ?> </span>\n\n            <i class=\"fa fa-caret-down\"></i>\n        </button>\n        <ul class=\"dropdown-menu na-dropdownusermenu\" aria-labelledby=\"na-dropdowndashboard\">\n            <li><a href=\"<?php echo get_dashboard_url(); ?>\">Dashboard</a></li>\n            <li><a href=\"<?php echo get_edit_profile_url(); ?>\">Edit Profile</a></li>\n            <li><a href=\"<?php echo wp_logout_url(); ?>\">Sign Out</a></li>\n        </ul>\n    </div>\n<?php else : ?>\n    <a id=\"na-btnsignin\" class=\"na-btn\" href=\"<?php echo wp_login_url(); ?>\"><span>Login</span></a>\n<?php endif;\n}\n?>\n\nThe above function value is getting loaded anywhere where I have used While loop.\n<?php\nwhile ($the_query->have_posts()) {\n$the_query->the_post();              \n ?>\n\nSorry for bad english\nThank You\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403394", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to get previous and Next Post Url in the_post_navigation <?php \nthe_post_navigation(\narray(\n    'prev_text' => '<div class=\"na-prevpost\"> <a href=\"#\"> <i class=\"fa fa-angle-left\"></i><span>Previous Reading</span> <h2>%title</h2> </a> </div>',\n    'next_text' => '<div class=\"na-nextpost\"> <a href=\"#\"> <span>Next Reading</span><i class=\"fa fa-angle-right\"></i> <h2>%title</h2></a> </div>',                              \n)\n)\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403397", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress API Create post content I am basically trying to duplicate wordpress pages using the Wordpress API.\nI do get the page content using \"GET /wp/v2/pages/\" endpoint.\nI receive the the JSON data which includes:\n\"content\": \"<style>/*! elementor - v3.5.5 - 03-02-2022 */\\n.elementor-heading-title{padding:0;margin:0;line-height:1}.elementor-widget-heading .elementor-heading-title[class*=elementor-size-]>a{color:inherit;font-size:inherit;line-height:inherit}.elementor-widget-heading .elementor-heading-title.elementor-size-small{font-size:15px}.elementor-widget-heading .elementor-heading-title.elementor-size-medium{font-size:19px}.elementor-widget-heading .elementor-heading-title.elementor-size-large{font-size:29px}.elementor-widget-heading .elementor-heading-title.elementor-size-xl{font-size:39px}.elementor-widget-heading .elementor-heading-title.elementor-size-xxl{font-size:59px}</style><h3>Abi '22 me\n\nBut when I use this content to send a request to \"POST /wp/v2/pages\" endpoint including the same content it looks really crappy.\nAs you can see, I use elementor. Is that the reason it looks weird?\n\nThis is how it should look like. Beautifully designed, background image...\n\nAnd this is how it looks...\nDoes anyone know what I am doing wrong?\nI know there are plugins to duplicate pages but this duplicating process is just a first step for me to then change the page's content to my specific needs...\nThank you very much,\nRichard\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403401", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to check if woocommerce_order_item_name is use in email? I am using woocommerce_order_item_name to add meta info to item names in order detail page.\nI am adding a shortcode.\nUnfortunately the same shortcode is added to transactional emails and not parsed since it uses website only javascript.\nHow can I check if wordpress is using woocommerce_order_item_name hook to compose an email message and avoid changing order item names in such a case?\nSomething like this:\n// define the woocommerce_order_item_name callback \nfunction filter_woocommerce_order_item_name( $item_name, $item ) {\n        // not working, just an example\n        if(!is_this_en_email()){\n                $info_icon = do_shortcode(popupContent(\"some info_icon_content\", \"button Title\", \"popupTitle\", \"faIcon\"));\n        }\n}\n\n// add the filter \nadd_filter( 'woocommerce_order_item_name', 'filter_woocommerce_order_item_name', 10, 2 ); \n\n\nThanks everybody!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403402", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get this taxonomy name from wp_get_object_terms()? So I have this code that shows me what's inside this object.\n<pre>\n    <?php $id = get_the_ID();\n        $curerntpost = wp_get_object_terms($id, 'state');\n    echo var_dump($curerntpost);?>\n</pre>\n\nThis is the Output\n    object(WP_Term)#2427 (10) {\n  [\"term_id\"]=>\n  int(5)\n  [\"name\"]=>\n  string(7) \"Montana\"\n  [\"slug\"]=>\n  string(7) \"montana\"\n  [\"term_group\"]=>\n  int(0)\n  [\"term_taxonomy_id\"]=>\n  int(5)\n  [\"taxonomy\"]=>\n  string(5) \"state\"\n  [\"description\"]=>\n  string(0) \"\"\n  [\"parent\"]=>\n  int(0)\n  [\"count\"]=>\n  int(2)\n  [\"filter\"]=>\n  string(3) \"raw\"\n}\n\nFor some reason, I am not able to get the ['slug']\nI tried different things such as $curerntpost -> slug  also tried $curerntpost['slug'] and even $curerntpost[0]['slug'] but no luck. How are you supposed to get that piece of data?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403403", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Switch MultiSite main site with another (multilingual sites) - with subfolder - no subdomain I have a WordPress Multisite with two blogs / sites. The main site is English and the second one is German.\n\n\n\n\nSite\nURL\n\n\n\n\nCurrent Main Site: English\nexample.org\n\n\nGerman Site\nexample.org/de\n\n\n\n\nHow can I switch these sites (with all settings and content)? The German site should become the primary one and the English one will not be used.\n\n\n\n\nSite\nURL\n\n\n\n\nNew Main Site: German\nexample.org\n\n\nEnglish Site\nexample.org/en\n\n\n\n\nI already read this about \"Switching primary site in WordPress Multisite\" but I'm not sure if it's still up to date and if it's the solution for my purpose.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403404", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: wp_query can't get max_num_pages in custom post type Array of query gives to me to different value for max_num_pages\n\n            [post] => WP_Post Object\n                (\n                    [ID] => 628\n                    [post_author] => 1\n                    [post_date] => 2022-03-02 22:51:16\n                    [post_date_gmt] => 2022-03-02 22:51:1\n                    [post_title] => Fashion industry\n                    [post_excerpt] => \n                    [post_status] => publish\n                    [post_mime_type] => \n                    [comment_count] => 0\n                    [filter] => raw\n                )\n\n            [comment_count] => 0\n            [current_comment] => -1\n            [found_posts] => 9\n            [max_num_pages] => 3\n            [max_num_comment_pages] => 0\n\n\n        )\n\n    [post_count] => 9\n    [current_post] => -1\n    [in_the_loop] => \n    [post] => WP_Post Object\n        (\n            [ID] => 628\n            [post_author] => 1\n            [post_date] => 2022-03-02 22:51:16\n            [post_date_gmt] => 2022-03-02 22:51:16\n\n\n    [comment_count] => 0\n    [current_comment] => -1\n    [found_posts] => 9\n    [max_num_pages] => 1\n    [max_num_comment_pages] => 0\n    [is_single] => \n    [is_preview] => \n\n[max_num_pages] => 1 & [max_num_pages] => 3\nWhy this happend ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403405", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to find what pages/posts contain a particular reusable block? How can I find out what pages and post on a site contain a particular reusable block?\nTypically, to find content on a site, I issue wp db search *itemlookingfor* (like the post ID, part of a file name, or a word)\nOR\nwp db query 'SELECT ID FROM the_posts_table WHERE post_content LIKE \"%itemlookingfor%\" AND post_status=\"publish\"'\nIn my case, I used the reusable block's ID and no results were returned for either command.\nI replaced the ID of the reusable block with other common words on my site and results were returned so I think it's something special with reusable blocks.\nIdeally, I'd like to use a wp-cli command or failing that, a sql command to search my database.\n\nA: Those commands do work now after I stepped away for a few hours from the problem; so it was something on my end.\nIn my examples in the question, You can substitute the reusable block's post_id with the itemlookingfor to obtain the pages that contain your reusable block.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403406", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is XML-RPC still a security risk? Is XML-RPC still a security risk?\nShould it always be disabled if there is no use case for it?\nLet's say starting at WP Version 5.9.1.\n\nA: yes it is a security risk. Should it be disabled? most likely. Is it a OMG BBQ type of emergency? no.\nIf you have strong passwords for your accounts, it is not more of a security risk than the login form. It is a pointless security risk in the sense that it provides an additional attack vector and it code is probably not well maintained.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403407", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get list of category from a specific post with get_term() I want to get a list of categories from a post. and them hide a specific category with all child\n    $args = array(\n                            'orderby' => 'term_order',\n                            'exclude_tree' => array('vip'),\n                            'fields' => array('names', 'slugs'),\n                            'term_id' => $current_post_id,\n                            'taxonomy' => 'category',                        \n                             );\n\n                            $terms = get_terms($args);\n\n                            var_dump($terms);\n\nbut I got a null array. I know I have a stupid problem. because I am new to WordPress\nUPDATE:\nmy problem is about to add 'taxonomy' => 'category' and give a integer to exclude_tree\nright now I correct my code and its work but I have a problem with that\n                    $args = array(\n                        'orderby' => 'term_order',\n                         'exclude_tree' => [2621],\n                        'fields' => 'names',\n                    );\n\n                    try {\n\n                        $terms = wp_get_post_categories($current_post_id,$args);\n\nIt seems 'fields' just get one string. I want to get the name of the category with their link.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403408", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Pagination in custom post type archive.php not working // Get Limited Posts per page\n$args = array(\n    'post_type' => 'portfolio',\n    'posts_per_page' => 3,\n);\n\n$posts = new WP_Query($args);\n\nfunction.php\n// Create Pagination\nfunction numb_pagination(){\n\n    global $wp_query;\n\n    $all_pages = $wp_query->max_num_pages;\n\n    $current_page = max(1, get_query_var('paged'));\n\n    if($all_pages > 1){\n        return paginate_links(array(\n            \"base\" => get_pagenum_link() . \"%_%\",\n            \"format\" => \"/page/%#%\",\n            \"current\" => $current_page,\n            \"total\" => $all_pages\n        ));\n    }\n\n}\n\n\nThe problem in $all_pages = $wp_query->max_num_pages; Output => 1\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403410", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: understand what code is doing when prepending /blog I am new to Wordpress and php coding.\nWe are moving from a different container system to wordpress and to keep the links intact I need to prepend /blog to all post articles.\nI tried it through the individual permalink using https://www.example.com/blog/%postname%/\nIt works nicely for the post articles, but I realized that it seems to also impact i.e. custom layouts from Astra, making the following url: https://www.example.com/blog/astra-advanced-hook/12345\nAlthough I am not sure this is an issue, but being an orderly person I really don't like such a strange URL convention.\nSo I searched the net and found the following reply from Zeth and Chaoste\nChange permalinks for post type 'post' only\nfunction wp1482371_custom_post_type_args( $args, $post_type ) {\n    if ( $post_type == \"post\" ) {\n        $args['rewrite'] = array(\n            'slug' => 'blog'\n        );\n    }\n    return $args;\n}\n\nadd_filter( 'register_post_type_args', 'wp1482371_custom_post_type_args', 20, 2 );\n\nfunction my_change_post_link($permalink, $post, $leavename) {   \n    if (get_post_type($post) == 'post') {     \n        return \"/blog\" . $permalink;   }   \n    return $permalink; \n}\n\nadd_filter('pre_post_link', 'my_change_post_link', 10, 3);\n\nI went on and created a child theme, posted the above to function php and it is working (when I posted just the first function and add_filter, there didn't seem to be any change). But being an inquisitive person, I would really like to know what exactly this is doing?\nI guess add_filter is what triggers the function when some action happens. The if checks if it is the post type.\n\n*\n\n*But what does the first function do and what does the second one do?\n\n*Why do I need both functions?\n\nThank you for helping me learn!\n\nA: add_filter( 'register_post_type_args', 'wp1482371_custom_post_type_args', 20, 2 );\n\nWhen you register a post type, this filter is called, and wp1482371_custom_post_type_args is using this opportunity to modify the parameters for the post post type to change the slug\nadd_filter('pre_post_link', 'my_change_post_link', 10, 3);\n\nJust because your posts are now available at a new URL, doesn't mean WordPress knows this and will change the permalinks! It's not psychic, it has to be told explicitly or the URLs shown in the user interface won't match and will still be missing the /blog part. pre_post_link gives you an opportunity to filter them, and if it's a post it add /blog to the beginning.\n\n2.) Why do I need both functions?\n\nBecause if you just change the posts URL that doesn't mean WP knows what to do with /blog URLs.\nAnd if you only add /blog URLs that doesn't mean WP knows to put /blog in front of every posts URL.\n\nAs an aside, just because you found this particular solution, does not mean it is the best solution. There are solutions that don't involve WordPress at all and sit deeper down at the Apache/Nginx level, you can also 301 redirect to versions that don't have /blog, as well as many other options.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403412", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to hide content on mobile in the functions.php file - woocommerce I have inserted an image onto my woo-commerce single product page using the below hook and code written into my functions.php file:\nadd_action('woocommerce_after_single_product_summary', add_content_on_woocommerce_after_single_product_summary',1);\n\nfunction add_content_on_woocommerce_after_single_product_summary() {\n    \n      echo \"<img src='https://mywebsite/wp-content/uploads/2022/02/blocks.png' >\" ;\n}\n\nI only want this image to display on mobile and not desktop. Is there any code I can add to this in my functions.php file to achieve this?\n\nA: Probably the easiest method would be assign the image a class and display:none it based on media query.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403413", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add checkbox in admin post list - show checked post in widget I try to make a plugin with a widget where I can mark / check posts, maybe old post I want to bring back to life.\nI want to add a checkbox in the field before the title, like I try to show in the example below.\nAnd then, If I check the checkbox for a post, the post will show up in a widget at the front side of my site. Somethink like \"Did you see this ?\" or \"Did you remember this ?\"\nWith the post title, featured image and a link to the post.\nI find a lot of plugins that users can review the posts, and then I can show the post with most reviews / stars.\nThat is not what I want...  I want the admin / editor etc. to mark / check post that they think the viewers / users want to see again.\nMaybe a carusell that shows the 3-5 posts that admin checked, example 20 seconds each. But that could be in another version.\nFirst of all I need to find a way to make checkbox in every posts in the post list, and let the widget in front side show the post I marked.\nSomebody to understand what I need and how to make it ?\n\n\nA: To get you started:\n<?php\n\n/*\nPlugin Name: The Checkbox Plugin\nPlugin URI:  https://www.yourawesomedomain.de/plugins/\nDescription: A plugin with a checkbox to mark posts.\nVersion:     0.0.1\nAuthor:      bjovaar\nAuthor URI:  https://www.bjovaar.maybe/\nLicense:     GPL2\nLicense URI: https://www.bjovaar.de/disclaimer\nText Domain: bjovaar\nDomain Path: /languages\n*/\n\nif(!defined('ABSPATH')) {\n    exit('No access');\n}\n// This path variable can be used for the textdomain setup, ignore if not needed\n$dir = plugin_dir_path(__FILE__);\n\n\nadd_action('manage_post_posts_custom_column', function($column_key, $post_id) {\n// $checked_post should contain your result from your database\n// which I didn't show to save\n$checked_post = get_post_meta($post_id, 'checked_post', true);\n?>\n<input type=\"checkbox\" value=\"true\" checked>\n<?php\n}, 10, 2);\n// Add title to head and bottom of column\nadd_filter('manage_post_posts_columns', function($columns) {\n    return array_merge($columns, ['verified' => __('Marked posts', 'bjovaar')]);\n});\n\nThe code above will create a plugin and add a checkbox to your admin dashboard in the posts list. The first add_action \"manage_post_posts_custom_colum\" will call a function and create the new column. Please read under \"more information\" for further details of this hook. This column can also be rearranged via array sorting (depending on where you want it).\nNow, at this point the following question should come up, while developing this thing (from my perspective).\nWhich hook do you want to use on the overview to save your checked input field since there is no \"save_post\" hook on this page.\nThe only solution from what I can think of right now would be to register a rest endpoint, and trigger an ajax request.\nThis is not a full answer but should show you the path to go..\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403414", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Line Breaks are stripped off when direction property is found The line breaks are stripped off when the p tag has a dir attribute inserted, to explain further I'll list some examples.\nLet's say we have 2 lines of text as following\n<p>Text Paragraph Number One Goes Here</p>\n<p>Text Paragraph Number Two Goes Here</p>\n\nIf I want to add line breaks between the two paragraphs it works fine to become like:\n<p>Text Paragraph Number One Goes Here</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>Text Paragraph Number Two Goes Here</p>\n\nHowever if the paragraphs have a dir attribute as below\n<p dir=\"ltr\">Text Paragraph Number One Goes Here</p>\n<p dir=\"ltr\">Text Paragraph Number Two Goes Here</p>\n\nAll <p dir=\"ltr\">&nbsp;</p> are removed and no line breaks are inserted.\nThe site has TinyMCE plugin which has an option to keep paragraph tags in the Classic block and the Classic Editor but this didn't solve the problem. I disabled the plugin and also didn't resolve the issue.\nAnd also I added the wpautop hook in functions\n  remove_filter( 'the_content', 'wpautop' );\n  remove_filter( 'the_excerpt', 'wpautop' );\n\nThis also didn't resolve the issue.\nThe line breaks works perfectly if p tags have no direction attribute while when it has the dir attribute like this <p dir=\"ltr\">&nbsp;</p> they are removed.\nAny line break after it gets stripped off especially if it's a non-latin language.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403416", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add a custom redirect rule for Post as subdomains? I am trying to write a custom redirect rule to open a download matching pages.\nExample: postname.example.com/download\nExample2: postname.es.example.com/download\n\nI am using the following code in my functions.php:\nadd_rewrite_rule('^([^/]+)\\.example\\.com/download?$','index.php?pagename=download&postnames=$matches[1]','top');\nadd_rewrite_rule('^([^/]+)\\es.example\\.com/download?$','index.php?language=es&pagename=download&postnames=$matches[1]','top');\n\nI've also added wildcard forwarding for all subdomains from my DNS and verified.\nbut these rule not work can please help me out how open my download page like this\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403420", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to restrict shipping zone in a specific interval time I want to set a shipping zone to be activated between 4 am and 1 pm every day in the Dubai zone and this shipping zone must be activated only in Dubai\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403422", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Active class with custom wp_get_archives HTML output I use a filter on get_archives_link for the HTML output and I try to reproduce the default aria-current=\"page\" attribute on the <a> tag when we are on the archive page.\nif ( ! function_exists( 'o2_archives_html' ) ) :\n    function o2_archives_html( $link_html, $url, $text, $format, $before, $after ) {\n\n        if ( 'html' === $format )\n        $link_html = \"\\t<li>$before<a href='$url'><span class='label'><span class='title'>$text</span></span></a>$after</li>\\n\";\n\n        return $link_html;\n\n    }\nendif; // o2_archives_html()\nadd_filter( 'get_archives_link', 'o2_archives_html', 10, 6 );\n\nI would like to put an \"active\" class on the <li class=\"active\"> tag when we are for example on February 2022 site.com/blog/2022/02/page/2/.\nWhat condition does this?\n\nA: I haven't found an easy way but here is a solution:\nI get the month and year from the current archive and compare them with the text.\n$year      = get_query_var( 'year' );\n$monthnum  = get_query_var( 'monthnum' );\n$monthname = $GLOBALS['wp_locale']->get_month( $monthnum );\n$date      = $monthname . ' ' . $year;\n\nif ( $text === $date )\n$active_class = 'class=\"current-menu-item\"';\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403423", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wordpress is generating too many Image Sizes I have removed the default image sizes, and added my custom image sizes with this code:\n// Remove default image sizes\nfunction remove_default_image_sizes( $sizes ) {\n  \n    /* Default WordPress */\n    unset( $sizes[ 'thumbnail' ]);       // Remove Thumbnail (150 x 150 hard cropped)\n    unset( $sizes[ 'medium' ]);          // Remove Medium resolution (300 x 300 max height 300px)\n    unset( $sizes[ 'medium_large' ]);    // Remove Medium Large (added in WP 4.4) resolution (768 x 0 infinite height)\n    unset( $sizes[ 'large' ]);           // Remove Large resolution (1024 x 1024 max height 1024px)\n\n    /* With WooCommerce */\n    unset( $sizes[ 'shop_thumbnail' ]);  // Remove Shop thumbnail (180 x 180 hard cropped)\n    unset( $sizes[ 'shop_catalog' ]);    // Remove Shop catalog (300 x 300 hard cropped)\n    unset( $sizes[ 'shop_single' ]);     // Shop single (600 x 600 hard cropped)\n\n    return $sizes;\n    }\n  \n    add_filter( 'intermediate_image_sizes_advanced', 'remove_default_image_sizes' );\n//\n\n\n// post thumbnail sizes\n    \n\n    add_action( 'after_setup_theme', 'vkb_setup_theme' );\n    function vkb_setup_theme() {\n\n        add_theme_support( 'post-thumbnails' );\n\n        set_post_thumbnail_size( 250, 250, true );\n\n        add_image_size( 'XS', 128 );\n        add_image_size( 'S', 256 );\n        add_image_size( 'M', 512 );\n        add_image_size( 'XL', 1024 );\n    }\n//\n\n\nThere should be XS, S, M, XL, Post_thumbnail, and the original size, that`s 6.\nHowever when I uploaded a big image(2898 x 2346) for testing, I have 9 images, I have additional this 3 sizes: -1536x1253, -2048x1671, and one named -scaled with the size of 2560x2088.\nWhy do I have this additional sizes, and how can I get rid of them?\nThank you.\n\nA: I fonud the answer here:\nhttps://gist.github.com/iftee/73cbd9f080c5c7a943cff5e806997f90?permalink_comment_id=3314876#gistcomment-3314876\nI added:\nunset( $sizes['1536x1536'] );\nunset( $sizes['2048x2048'] );\n\nremove_image_size( '1536x1536' );\nremove_image_size( '2048x2048' );\n\nThis removes the two big image sizes, but the -scaled image size is still there\nI found out this:\nWhen a new image is uploaded, WordPress will detect if it is a \u201cbig\u201d image by checking if its height or its width is above a big_image threshold. The default threshold value is 2560px, filterable with the new big_image_size_threshold filter. If an image height or width is above this threshold, it will be scaled down, with the threshold being used as max-height and max-width value. The scaled-down image will be used as the largest available size. In this case, the original image file is stored in the uploads directory and its name is stored in another array key in the image meta array: original_image. To be able to always get the path to an originally uploaded image a new function wp_get_original_image_path() was introduced.\nsource:\nhttps://make.wordpress.org/core/2019/10/09/introducing-handling-of-big-images-in-wordpress-5-3/\nTo remove it:\nadd_filter( 'big_image_size_threshold', '__return_false' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403425", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: Where does the removing of widget through appearance - customize take affect I was working with a webshop and having an added theme (newestore-pro). There must be something wrong with the theme, because after having clicked \"remove block\" (latest post?) when \"customizing\" the page (contact us) the whole site crached. Are the widgets connected to a page linked in the database? If so, in what table? Could the php-templates have been modified?\nThe page started working, but I leave the question, since it might be good to know the way to alter widgets \"codewise\".\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403428", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Plugins to generate reflinks in Wordpress I am looking for a plugin that allows you to create reflinks and collect data on how many items people buy through that particular link\nI want the plugin to count only the purchase, not the clicks on the reflink.\nif there is an option in woocommerce, please send me some tutorial about it.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403430", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Tax Query only returns for the first of several terms I'm trying to query a customer post type where the results may be within one of several associated terms. The issue however is that only the first term yellow-gold-jewellery is being returned for, and all others excluded.\nSee my query below, by default the WP Query docs note that the operator on the 0 entry of my tax_query should be IN. Despite this it is only returning products in the yellow-gold-jewellery and neither of the latter two.\n{\n    \"posts_per_page\": 9,\n    \"status\": \"publish\",\n    \"tax_query\": {\n        \"0\": {\n            \"taxonomy\": \"jewellery_metal\",\n            \"field\": \"slug\",\n            \"terms\": [\n                \"yellow-gold-jewellery\",\n                \"white-gold-jewellery\",\n                \"rose-gold-jewellery\"\n            ]\n        },\n        \"1\": {\n            \"taxonomy\": \"jewellery_availability\",\n            \"field\": \"slug\",\n            \"terms\": [\n                \"sold\",\n                \"unaccounted\"\n            ],\n            \"operator\": \"NOT IN\"\n        },\n        \"relation\": \"AND\"\n    },\n    \"per_page\": \"9\",\n    \"post_type\": \"product\"\n}\n\nI've tried restructuring this several ways:\n\n*\n\n*Nesting with an OR relation separate to the top level AND\n\n*Removing the top level AND\n\n*Manually adding operator IN to object 0\nNone have worked and the above seems to be exactly what is prescribed by WP docs.\nI have done the obvious in checking that none of the items trip the secondary AND condition (they don't) and removing the yellow-gold-jewellery then defers to the white-gold-jewellery (and still not the rose-gold-jewellery).\nIt's as if it's only finding the first matched term and nothing else.\nIs this how this is supposed to work? Or have I misunderstood the syntax/structure?\n\nA: Related issue: Multiple relationship for multiple tax_query in WP_Query\nThe issue here was that mixed multi-relationship lookups are only permitted using the term_taxonomy_ids field in the query, the above worked fine once switched like so:\n$params = [\n    \"status\" => \"publish\",\n    \"tax_query\" => [\n        [\n            \"taxonomy\" => \"jewellery_metal\",\n            \"field\" => \"term_taxonomy_id\",\n            \"terms\" => [\n                36, // \"yellow-gold-jewellery\"\n                37, // \"white-gold-jewellery\"\n                34, // \"rose-gold-jewellery\"\n            ]\n        ],\n        [\n            \"taxonomy\" => \"jewellery_availability\",\n            \"field\" => \"term_taxonomy_id\",\n            \"terms\" => [\n                44, // \"sold\"\n                49, // \"unaccounted\"\n            ],\n            \"operator\" => \"NOT IN\"\n        ],\n        \"relation\" => \"AND\"\n    ],\n    \"post_type\" => \"product\"\n]\n\nAnnoying Wordpress Docs don't specify this, or at minimum suggest all queries are done on the term_taxonomy_id if it's the only one that supports all specified functionality.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403434", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can i get the code of Shop Page Woocommerce? I'm trying to write the codes of the shop page in woocommerce, especially in the main div\n\nAll of them are inside div with class-main, and I want to know how I can create one by myself with the standards code\n\nA: there are many hooks you can use to change certain code on archive pages. see here\nit is not recommended to change template files, but if you need to, create the copy of archive-product in the child theme with same folder structure as parent theme. this will affect all archive pages, shop, archive and tags. however, you can also rename it and set up a conditional, if( is_page( archive-shop )) then display the new template.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403436", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to catch wordpress post ID when it's published I am trying to either automatically a forum section when a post is published - like a discussion page. Normally, I wanted to make the users create the topic but I realized a forum category with many other topics under it would be better for discussion.\nWhat I am trying to do is somehow catch the post's id when it is first published, create a forum category linked to that id, and display the link to that forum on post's page. I was plannig to create a separate table in the database for these correspondence but metadata tables might be a better idea, I am not sure. I am using bbPress plugin for forums, Newspaper 11 as theme.\nI can't say I fully grasp the whole hooks system on WordPress so I am open to any info right now.\n\nA: To put it briefly, WordPress hooks let you modify parameters or output of functions (filters) or execute custom code when something happens (actions). Both types of hooks usually pass one or more arguments to the callback functions that are attached to them.\nDuring a page request WordPress goes through series of steps to get the page rendered. There's a nice summary of the actions that run during a typical request on the old Codex. To have your custom code run at the correct step, you need to add the callback to the action or filter before it runs.\nWordPress uses wp_insert_post() to insert and update posts in the database. When looking at the function's source code on Trac, you can see there are bunch of apply_filters  and do_actions inside it. The former is for calling the filtering callbacks and the latter for action callbacks.\nFor example you can see that the last do_action is wp_insert_post with three parameters - $post_ID, $post, $update. You can either read the comments on the source code or have a look at the action's documentation page to learn more about it.\nBasic example how to use an action hook,\nadd_action( 'wp_insert_post', 'example_wp_insert_post', 10, 3 ); // hook, callback, priority, # of accepted args\nfunction example_wp_insert_post( int $post_ID, WP_Post $post, bool $update ) {\n\n  // is the post new or was this an update?\n  if ( $update ) {\n    // don't do anything\n    return;\n  }\n\n  // was the post published?\n  if ( 'publish' !== $post->post_status ) {\n    // bail\n    return;\n  }\n\n  // do something with ID and/or post..\n  \n}\n\nOne thing to notice is that wp_insert_post() returns post ID on success. So if you use it somewhere in your code, then you don't have to bother with hooks - just use the return result directly!\n// somewhere in your code\n$new_post_id = wp_insert_post( $postarr, $wp_error );\nif ( ! is_wp_error( $new_post_id ) ) {\n  // do something with the new post's ID\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403439", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How would you set Theme Customizer API Previewer Preview URL of a Logged out Page or Login Screen How would you set the WP_Customizer preview iframe to a Logged out page like the Login Screen /wp-login.php?\nI'm aware of how to set the preview page on expansion of panels or sections, but  I have some subtle theme mods for the login screen I'd like the user to preview when customizing. Any Ideas? I looked at the code to some Custom Login plugins and it appears they might print out a fake clone or duplicate of the login page and form. I'd like to keep the code as small as possible preferably just showing the regular login screen if possible.\nATTEMPT\nThis is a non working modified code snippet from Weston Ruter from one of his blog posts to change preview url when you expand 'login_screen_settings' or whatever your panel is named. You can use it with sections too, you just change that api.panel -> api.section\n// Not currently working - just an example\n    api.panel('login_screen_settings', function (section) {\n        var previousUrl, clearPreviousUrl, previewUrlValue;\n        previewUrlValue = api.previewer.previewUrl;\n        clearPreviousUrl = function () {\n            previousUrl = null;\n        };\n\n        section.expanded.bind(function (isExpanded) {\n            var url;\n            if (isExpanded) {\n                url = api.settings.url.home + '/wp-login.php';\n                previousUrl = previewUrlValue.get();\n                previewUrlValue.set(url);\n                previewUrlValue.bind(clearPreviousUrl);\n            } else {\n                previewUrlValue.unbind(clearPreviousUrl);\n                if (previousUrl) {\n                    previewUrlValue.set(previousUrl);\n                }\n            }\n        });\n    });\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403440", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to setAttributes in Gutenberg block? I try to make a Gutenberg plugin but I have problem to set a value of attributes.\nI npm this template\nnpx @wordpress/create-block example-plugin --template @ryanwelcher/multiple-blocks-template\nbecause I want create a multiblock plugin.\nthe problem is where and how register attributes.\nI register it on block.json:\n \"attributes\": {\n        \"content\": {\n            \"type\": \"string\",\n            \"selector\": \"h2\"\n        }\n    },\n\nThen I used it on edit.js\n export default function Edit({attributes: {content}, setAttribute}) {\n      const blockProps = useBlockProps();\n\n     return (\n      \n         <p {...useBlockProps()}>\n             <input value={content} />\n               <TextControl label=\"Question:\" value={content}\n                allowedFormats={[\"core/italic\"]}\n                onChange={x => setAttributes({content: x})} >\n             {__('larum ipsume', 'page-builder')}\n         </p>\n     );\n }\n\nthis method work but I have an error.\nI cannot write all sentence but just first letter and it refresh my input.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403442", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: how to disable blockrenderAppender inside all Innerblocks? I used multiple inner blocks to make a new block for me. And I found a problem. The problem is after every block if I hover over there is a block appender popping up though I used the props template lock=\"all\". Codes are as follows\n <InnerBlocks\n            template={ [\n\n                ['core/columns', { columns: 1 },\n                    [\n                        ['core/column', {}, \n                    \n                            [\n                                [ 'core/heading', { level: 2, content: 'Example Nested Block Template' } ],\n                                [ 'core/paragraph', { content: 'Lorem ipsum dolor sit amet labore cras venenatis.' } ],\n                                [ 'core/columns', { columns: 2 },\n                                [\n                                    [ 'core/column', {}, [\n                                        [ 'core/image', { } ],\n                                    ]\n                                ],\n                                [ 'core/column', {}, [\n                                                [ 'core/list', { content: 'list item' } ],\n                                            ]\n                                        ],\n                                    ]\n                                ],\n\n                                [ 'core/button', { text: 'Buy Now' } ],\n                            ]\n                        ]\n                    ]\n                ]\n              \n            ] }\n            templateLock=\"all\"\n        />\n\nthe result is shown in the image I've shared.\n\nAs you can see there is a block appender symbol popped up even after I used templatelock. Whats is the reason behind this problem and how can i disable it?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403443", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to Remove all Traces of a WordPress Plugin? I've installed a couple of plugins like ivory search and some others, and now I want to remove them with all of their traces. I've tried the plugin section to deactivate and remove them, but it seems that some table/files/folder has been remained as junk.\nHow Can one do that? How do you handle this?\n\nA: Always deactivate and then delete the plugin from the WP plugin menu as opposed to in the file system.\nYou can google around, there is many plugins that remove orphan plugin tables and other data https://onlinemediamasters.com/clean-wordpress-database/\nJust be careful and backup, I have done this numerous of times.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403444", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I remove/reset all current widgets from the database? I recently migrated a site from a dev server to a web server and I appear to be stuck with a menu sidebar I had built in the old site that doesn't appear in the widget area of the new site's dashboard but appears on a page with side navigation regardless of settings applied.\nIf I add in the correct menu with styling, I end up with both menus one above the other.\nI think it's something still stuck/stored in the options database.\nDoes anyone know how to delete/reset all widgets from phpMyAdmin?\nI can see the widgets in sidebars_widgets but have read you shouldn't edit the entry directly from phpMyAdmin.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403445", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Move position in post list for a custom checkbox column I have made checkboxes to every post in post list.\nQuestion:\nHow can I change the the position for the new column.\nNow it`s at the right side of the post list. After \"Date\".\nHow can I move it example before the title column ?\nThe files for the plugin is here, if you would take a look.\nhttps://github.com/bjovaar/terplugin\n\n\n\nA: manage_posts_columns is a filter that you can use to change the order of the columns.\nIt takes two parameters - list of columns and type of the post (for which the table is displayed).\nIf the post type is post change the order of the array elements keeping the keys and values.\nThe column name is set as the CSS class in the table cell, like\n<td class=\"recommendations column-recommendations\"`\n\nSample solution:\nadd_filter( 'manage_posts_columns', 'wpse403447_reorder_cols', 100, 2 );\n\nfunction wpse403447_reorder_cols( $columns, $post_type )\n{\n    //\n    // column to move\n    $moved_col_key = '{name-of-the-recommendation-column}';\n    $moved_col_title = '';\n\n    if ( $post_type != 'post' || !isset( $columns[$moved_col_key] ) )\n        return $columns;\n\n    //\n    // \"title\" column\n    $title_col = 'title';\n    $reordered = [];\n    foreach( $columns as $col => $title ) {\n        if ( $col == $moved_col_key ) {\n            $moved_col_title = $title;\n            continue;\n        }\n        if ( $col == $title_col )\n            $reordered[ $moved_col_key ] = '';\n            \n        $reordered[ $col ] = $title;\n    }\n    $reordered[ $moved_col_key ] = $moved_col_title;\n    \n    return $reordered;\n}\n\n\nA: Quoting from https://www.isitwp.com/change-wordpress-admin-post-columns-order/\nAll you have to do is add this code to your theme\u2019s functions.php file or in a site-specific plugin:\nadd_filter('manage_posts_columns', 'column_order');\nfunction column_order($columns) {\n  $n_columns = array();\n  $move = 'author'; // what to move\n  $before = 'title'; // move before this\n  foreach($columns as $key => $value) {\n    if ($key==$before){\n      $n_columns[$move] = $move;\n    }\n      $n_columns[$key] = $value;\n  }\n  return $n_columns;\n}\n\nIf you want to move multiple columns you will need to do things in another way as the above code was just to make things as simple as possible. The next snippet will move both the date and author columns before the post title column.\nadd_filter('manage_posts_columns', 'column_order');\nfunction column_order($columns) {\n  $n_columns = array();\n  $before = 'title'; // move before this\n \n  foreach($columns as $key => $value) {\n    if ($key==$before){\n      $n_columns['date'] = '';\n      $n_columns['author'] = '';\n    }\n      $n_columns[$key] = $value;\n  }\n  return $n_columns;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403447", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom Logo Link WordPress I am trying to change the logo link of my wordpress website. But I am unable to achieve it. I am using child theme and using the code.\nfunction crunchify_custom_logo_url ( $crunchify_logo_html ) {\n \n    $crunchify_custom_logo_id = get_theme_mod( 'custom_logo' );\n \n    // Make sure to replace your updated site URL\n    $crunchify_new_url = 'https://demystifytravel.com/home/';\n \n    $crunchify_logo_html = sprintf( '<a href=\"%1$s\" class=\"custom-logo-link\" rel=\"home\" itemprop=\"url\">%2$s</a>',\n        esc_url( $crunchify_new_url ),\n        wp_get_attachment_image( $crunchify_custom_logo_id, 'full', false, array(\n            'class'    => 'custom-logo',\n        ) )\n    );\n    return $crunchify_logo_html;\n}\n \nadd_filter( 'get_custom_logo',  'crunchify_custom_logo_url' );\n\nThis code is not giving the error but its not working as it should. Any help where I am going wrong.\n\nA: Try to do some debugging, parent theme may be causing this issue, especially if your code is not showing errors.\nRemove the parent filter get_custom_logo https://developer.wordpress.org/reference/functions/remove_filter/\nIf you filter works then it could be sign of priority issue.\n$priority\n(int) (Optional) Used to specify the order in which the functions associated with a particular filter are executed. Lower numbers correspond with earlier execution, and functions with the same priority are executed in the order in which they were added to the filter.\nDefault value: 10\nhttps://developer.wordpress.org/reference/functions/add_filter/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403450", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Block Variation for Gallery Columns I had this code to extend the column count to 10 for a specific need.\nwp.blocks.registerBlockVariation('core/gallery', {\n  name: 'prefix-gallery',\n  title: 'Custom Gallery',\n  attributes: {\n    columns: 10,\n  },\n  isDefault: true,\n});\n\nBut that doesn't seem to work any longer. I see the updated Block Gallery attributes has this:\nattributes: {\n  {\n    columns: {\n      \"type\": \"number\",\n      \"minimum\": 1,\n      \"maximum\": 10,\n    },\n  },\n}\n\nSo I tried:\nwp.blocks.registerBlockVariation('core/gallery', {\n  name: 'prefix-gallery',\n  title: 'Custom Gallery',\n  attributes: {\n    columns: {\n      minimum: 1,\n      maximum: 10,\n    },\n  },\n  isDefault: true,\n});\n\nThat doesn't seem to work to extend the column count to 10.\nAnyone now how to adjust the block variation to 10 instead of the default 8?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403451", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: How can I replace the text at the top of a custom column into a icon? Question\nHow can I change the text at the top of the column into an icon ?\nExample a star or a thumbs up.\nLike the \"Comment\" field. There is no text, just a icon.\nThe files for the plugin is here, if you would take a look.\nhttps://github.com/bjovaar/terplugin\n\n\nA: The posts list table headings can be modified with the manage_posts_custom_column filter. Looking at how the default comment icon is handleded on WP_Posts_List_Table we can see, that you can use a html string as the column heading.\nThe linked plugin uses verified as the key for the custom column it adds to the table. As the plugin doesn't define an explicit priority for the anonymous functions it hooks to the filter, the callback is fired at the default priority of 10.\nWith this information a custom filter, with a later priority, can be added to the site to change the column title from text to icon. The filter can be either added to the theme's functions.php file or to a custom plugin. Or if you are the author of the linked plugin, then copy the sprintf part of the example to the plugin.\nExample,\nadd_filter( 'manage_post_posts_columns', 'filter_manage_post_posts_columns', 11, 1 );\nfunction filter_manage_post_posts_columns( $columns ) {\n\n  // just to be sure the custom column is present\n  if ( ! isset( $columns['verified'] ) ) {\n    return $columns;\n  }\n\n  // Lets imitate how the default comments icon is handeled\n  $columns['verified'] = sprintf(\n    '<span class=\"dashicons dashicons-star-filled\" title=\"%1$s\"><span class=\"screen-reader-text\">%2$s</span></span>',\n    __('Recommendations', 'terplugin-lang'), // copied from the plugin to use translated text, if it exists\n    __('Recommendations', 'terplugin-lang')\n  );\n\n  // modified array\n  return $columns;\n}\n\nOther dashicons can be found on the Dashicon developer documentation page.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403453", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to show multiple posts thumbnail, title and date in widget I`m making a plugin with a widget to show a post that I recommend or mark with a checkbox in the post list.\nQuestion:\nI have said in the code that I want to show 2 post per page.\nIt only show one with thumbnail image and title, and the second one with just a title.\nBut if I said I want 3 post per page it shows 2 complete with image and title, and the third with only title.\nWhat did I do wrong ?\nThe files for the plugin is here, if you would take a look.\nhttps://github.com/bjovaar/terplugin\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403455", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: no_rest_route in Unit Testing for REST endpoint for CPT registered via show_in_rest I've created a REST route for custom post type 'book' by passing\n'show_in_rest' => true,\nas args in register_post_type('books', $args);\nSo, when I enter in URL https://localhost/wordpress/wp-json/wp/v2/books\nI can get the CPT. All good at this point.\nBut, when using it in the tests, I'm facing an issue:\nTest Class:\n    private $server;\n    public function setUp() {\n            parent::setUp();\n    \n            global $wp_rest_server;\n    \n            $wp_rest_server = new WP_REST_Server;\n            $this->server   = $wp_rest_server;\n    \n            do_action('rest_api_init');\n        }\n\nthe actual test:\npublic function testBookEndpoint() {\n       $request = new WP_REST_Request('GET', '/wp/v2/books');\n       $response = $this->server->dispatch($request);     \n   \n       print_r( $response );\n\n       $this->assertEquals( 200, $response->get_status() )\n}\n\nThe $response here displays the error:\n[code] => rest_no_route                                                                                                                                                                         \n[message] => No route was found matching the URL and request method.\n\nwhile the   $request = new WP_REST_Request('GET', '/wp/v2/posts'); works, the /books doesnot.\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403459", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disabled delete_others_posts if post is from admin I need some help with capabilities.\nI created a new role for my theme with the capability \"delete_others_posts\".\nThis role can delete posts from other users and also from admins.\nIs there a way to block this so the user can delete other posts but not from admins?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403467", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add audio files to audio player in WordPress custom theme? I want to add the native html5 audio player to the header of my custom WordPress theme but I want to be able to upload and change the audio files from wordpress admin.\nNo idea which direction I should take... (Custom Post Types ?)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403475", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Delete all users when they don't update profile_fields \n*\n\n*I create a profile_fields named name, when users sign up for an account they will receive an email containing the nickname.\n\n*When the user logs in, there will be a page to enter profile_fields (name), if profile_fields = nickname (from email), they will be redirected to the main edit page.\n\n(1,2 I did it).\nI want users who can't update profile_fields (name) for a day, to be permanently deleted.\nIs there any way to make this work? please, i have searched many places but to no avail\nI found a code and corrected it but I don't know if it's wrong???\nfunction my_clearOldUsers() {\n    global $wpdb;\n    $query = $wpdb->prepare(\"SELECT ID FROM $wpdb->users WHERE datediff(now(), user_registered) > 1\");\n    if ($oldUsers = $wpdb->get_results($query, ARRAY_N)) {\n        foreach ($oldUsers as $user_id) {\n            $nickname = $user->user_login\n            $xacminh = get_user_meta( $user_id[0], 'name', true );\n            if($xacminh != $nickname) {\n            wp_delete_user($user_id[0]); \n            } \n        }\n    }\n}\nadd_action('my_dailyClearOut', 'my_clearOldUsers');  ```\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403479", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Load Posts on Click via Ajax into a DIV Is it possible to load a specific amount of posts on click into a DIV via ajax?\nI've found a lot of tutorials, but all of them make use of the load-more- / next-page-functionality of a theme.\nWhat I need is, that the initial DIV is empty and the posts are only loaded into the div, if u click a toggle-button.\nIs this possible? Thanks in advance!\n\nA: The short answer to your question is simply, yes it is possible. It involves code across JS and PHP and is beyond what I would be able to show in an answer here. However I did a simple Google search for \"wordpress load posts with ajax\" and this link is the first result. https://wpmudev.com/blog/load-posts-ajax/ I scanned through the tutorial and it appears to be very detailed and I believe it should help you get where you need to be.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403480", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Long contextual help needs two clicks to close In our plugin, we are using enough contextual help on one page that you have to scroll to reach the \"Help\" button (#contextual-help-link\") to close it again. When this happens (or in fact, if I scroll before clicking on the \"Help\" button to close the section even if there isn't a lot of text), then the first attempt to close the section fails. A second click on the \"Help\" button then successfully closes it.\nIs there a way to prevent having to click \"Help\" twice to close the open section?\nFurther notes: I have a live expression for document.activeElement in the console. On the first attempt to close the section, the document.activeElement shows:\nbutton#contextual-help-link.button.show-settings.screen-meta-active\non the second, click it shows:\nbutton#contextual-help-link.button.show-settings\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403481", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I disable an attribute from a Gutenberg block included in a template via InnerBlocks? So I have this block that I created using templates and InnerBlocks, it's a block that my authors will use to insert a Hero Image section at the top of the page.\nexport default function Edit() {\n    const template = [\n        [ 'core/cover', {}, [\n            [ 'core/heading', { placeholder: 'Section title' } ],\n            [ 'core/button', { placeholder: 'Call to action' } ],\n        ] ],\n    ];\n\n    return (\n        <InnerBlocks\n            template={ template }\n            templateLock='all'\n        />\n    );\n}\n\nIt works fine, however, I want to disable some attributes from the Heading and Button child blocks, so that all the author does is enter content, no styling changes to the blocks.\nWhy do I need that? Because this section already has all the styling it needs, and I wouldn't want my authors to change some alignment or text color that would break the section styling.\nIs there any way of doing this?\nI tried this but didn't work:\nconst template = [\n    [ 'core/cover', {}, [\n        [ 'core/heading', { placeholder: 'Section title' } ],\n        [ 'core/button', { placeholder: 'Call to action', supports: { align: false, ... } ],\n    ] ],\n];\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403483", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Delete all posts with a specific custom field using meta_query I'm building a listings website using WooCommerce.\nA listing is either set to live or sold inside of a custom field key status\nOnce a listing is sold then the custom field status is updated with sold.  This allows the listing to be hidden from the website, yet still able to be viewed directly, just in case users still click a link and end up on the listing page.\nI am looking to automatically delete (or move to trash for now) all sold listings within 10 days of being sold.\nWhen the post is updated to sold this also gives the post modified date as a point of reference for the 10 days.\nI've almost got it working, after many hours of trying, and digging around online.\nThe cron parts are all working OK and it is almost doing what is intended...\nThe issue I am having is that even though I have the meta_query and the date_query set, it seems to ignore both of these and deletes ALL posts, whether the status custom field is sold or live, and regardless of the date specified.\nAny ideas what I may be doing wrong?  Below is what I have so far.\nAlso tried it without the date query and just with the custom field query and it still deletes all posts, not just posts that have the custom field set to sold.\nOne things to note - some posts do not have the custom field status at all yet, could this be affecting it?\nThanks in advance for any help.\nfunction get_delete_sold_listings() {\n    // Set query arguments\n    $args = array(\n        'fields'         => 'ids',\n        'post_type'      => 'product',\n        'post_status'    => 'publish',\n        'posts_per_page' => -1,\n        'meta_query'     => array(\n            array(\n            'key'     => 'status',\n            'value'   => 'sold'\n            )\n        ),\n        'date_query'     => array(\n            array(\n            'column'  => 'post_modified_gmt',\n            'before'  => '10 days'\n            )\n        )\n    );\n    $q = get_posts( $args );\n\n    // Check if any posts to delete, if not - return false\n    if ( !$q )\n        return false;\n\n    // if have posts to delete - delete them\n    foreach ( $q as $id )\n        wp_trash_post( $id );\n}\n\n// Fires when the Cron is executed\nadd_action( 'sold_listing_delete', 'get_delete_sold_listings' );\n\n\n// Register event to wp\nadd_action( 'wp', 'register_daily_listings_delete_event');\n\nfunction register_daily_listings_delete_event() {\n    // Make sure this event hasn't been scheduled\n    if( !wp_next_scheduled( 'sold_listing_delete' ) ) {\n        // Schedule the event\n        wp_schedule_event( time(), 'daily', 'sold_listing_delete' );\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403485", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I want to setup a button/popup/whatever that will prompt users on the site to input their email address Newish to programming. I am decent at python and have some experience with building API's.But I have very little experience with PHP/HTML. However after looking at it it seems very simple to learn.\nA friend of mine gave me a project for him. He has a wordpress website and would like users to submit their email address so that they can sign up for a marketing list. He will then take the emails from the database I will setup and do what he wants with them. I dont think I will have a problem with all the backend stuff as python makes it easy to process data(setting up database, creating a clean list of emails, etc). But I dont really know where to begin with front end.\nSimply, I want to create my own version of WPforms \"Newsletter signup form template\". https://wpforms.com/templates/newsletter-signup-form-template/?utm_source=WordPress&utm_campaign=liteplugin&utm_medium=builder-templates&utm_content=Newsletter%20Signup%20Form\nWhere do I even begin? What can I use to add my custom code to his website? Do I need to create a custom plugin? I guess im not familiar with how much flexibility etc. wordpress gives to devs.\nI am not looking for code on how to implement this. And I know existing plugins/software exists for this type of feature, but the point of this project is primarily for me to learn. So I would appreciate some pointers in the right direction so that I can get started. I looked for this type of question before but couldn't find it. If it has been asked please do link it. Thank you!\nUPDATE #1\nAfter doing some more research, it seems what I am looking to do is create my own custom plugin. The plugin is made up of PHP code that can include other assets such as css, images, and JS.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403486", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to safely trigger password reset emails for thousands of users I'm going to be migrating ~17,000 user accounts from a non-WordPress platform to a new WP site. I'll be importing them using WP All Import, which I've done before.\nOnce the users are imported, I'll need to send all of them a password reset email. I know from prior experience that trying to send to all of these users at once will cause the server\u2014even a beastly one\u2014to choke. Not to mention the potentially debilitating load associated with inviting many thousands of people to log in at once.\nIs there a way to \"stagger\" the password reset emails? E.g., send to 200 users every hour? I have a feeling I'm going to need to write a small plugin to do this, but I figured I'd ask if anybody has already found a creative solution.\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403489", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Issue adding custom taxonomies to custom post type (PHP) I have an issue updating custom taxonomies in a custom post type.\nFollowing setup:\n\n*\n\n*I have a custom post type 'listing'\n\n*There are two custom taxonomies connected to 'listing': 'sector' and 'location'.\n\n*Users can submit a form and WordPress generates a new 'listing'-post with the data.\n\nNow, everything except for the 'sector' and 'location' data works fine and appears in the new listing post (draft).\nThere must be something wrong in my code/ thinking. Even if I change the values for 'sector' and 'location' to something static (like in the code below) it does not write it to the new post.\n            $my_post = array(\n                'post_author' => 1,\n                'post_title' => sanitize_text_field($params['fieldname6']),\n                'post_content' => wp_kses_post($params['fieldname8']),\n                'post_type' => 'listing',\n                'post_status' => 'publish',\n            );\n\n        $post_id = wp_insert_post($my_post);\n        wp_set_object_terms( $post_id, array(21), 'sector', false );\n    \n        add_post_meta($post_id, 'phone', $params['fieldname18'], true);\n        add_post_meta($post_id, 'phone_link', 'tel:' . $params['fieldname18'], true);\n        add_post_meta($post_id, 'email', $params['fieldname17'], true);\n        add_post_meta($post_id, 'email_link', 'email:' . $params['fieldname17'], true);\n        add_post_meta($post_id, 'website', $params['fieldname7'], true);\n        add_post_meta($post_id, 'address', $params['fieldname14'] . ', ' . $params['fieldname15'] . ', ' . $params['fieldname16'], true);\n        add_post_meta($post_id, 'placement', $params['fieldname1'], true);\n\nEDIT: I added the full code. I also changed the approach to use wp_set_object_terms. I've tried IDs and slugs, true and false and changed the taxonomies from hierarchical to non-hierarchical. All to no effect.\nTo explain the code: I'm using a plugin (Calculated Fields Form) that returns the values of all form field in an array \"$params\". That part works well anyway. The only line that does not result in the desired outcome is:\n        wp_set_object_terms( $post_id, array(21), 'sector', false );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403490", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: In a WP_Query can I force the results' is_singular() to be set to false? I have a custom page template that includes a basic query after the main content. like this:\n$myPosts = new WP_Query(\n  array(\n    'post_type' => array('post', 'contentTypeA', 'contentTypeB' ),\n    'posts_per_page' => 10,\n    'order' => 'DESC',\n  )\n);\n\nif ( $myPosts->have_posts() ) :\n  while ( $myPosts->have_posts() ) : $myPosts->the_post();\n    get_template_part( 'template-parts/content', get_post_type() );\n  endwhile;\nendif;\nwp_reset_postdata();\n\nMy problem is that the results think that they are single pages. The template part linked by get_template_part() has a condition that if is_singular() is true, among many other things, render the title as <h1>, otherwise render as <h2>.\nIn my WP_Query feed, all the results are using <h1> for titles because is_singular() is registering as true for the posts.\nSo, my question is: is there an argument I can pass to my WP_Query to force the results to think that is_singular() is false? In other words, to make this output like a standard archive page.\nI have discovered that if I use if ( is_singular() && in_the_loop() ) : it sort of does the trick, but I am hoping there is a much simpler solution than adding that to the dozens of template partials I have that rely on is_singular().\n\nA: If you really think the is_singular() function of your query should be returning true for singular but isn't, you can force it to be true by setting the public property is_singular directly after the query, since that function just returns the value of that property when no $post_types parameter is specified:\n$the_query = new WP_Query($args);\n$the_query->is_singular = true;\n\nOr if you need to do so for the main query:\nglobal $wp_query;\n$wp_query->is_singular = true;\n\nI can't speak to the wisdom of whether or not this should be done\u2014it probably depends largely on your implementation\u2014but it can be done since that property is public.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403495", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: get wpforms ID value from ACF text field I have wpforms and ACF plugin installed. I used ACF text field (form_box) to be able to put WP forms shortcode to be displayed in the post. my objective is to be able to get the ID of each WP forms that attached to the post. my thinking is by capturing the shortcode value in the ACF text field than take the ID from it. But the problems is when i use get_field() and echo it to debug the value, it didn't give me the shortcode, and instead it display the form. below is my code:\nwhile( $recent->have_posts() ) : $recent->the_post();\n$countryID = get_field('country', get_the_ID());\n$formID = get_field( 'form_box', get_the_ID());\n$flag = 0;\n$i = 1;\n$groupTitle = \"\";\nforeach($groupingCountry as $groupID => $groupObj){\n  foreach($groupObj['group_list'] as $key => $value){\n     if($countryID == $value){\n       $flag = 1;\n       $groupTitle = $groupObj['group_title'];\n       //echo \"groupID =\".$groupID.\" | group_title =\".$groupObj['group_title'].\" | group_list =\".$value.\" | countrycode =\".$countryID ;\n       echo \";\n       $folder = array(\n        'post_id' => get_the_ID(),\n        'post_title' => get_the_title(),\n        'post_url' => get_the_permalink(),\n        'post_country' => $countryID,\n        'post_folder_group' => $i,\n        'post_folder_group_title' => $groupTitle\n      );\n      $folders[] = $folder;\n      break 2;\n     } \n  }\n  $i++;\n}\n\nendwhile;\nmy quesiton, how do i get the shortcode in textformat value so i can take the id from it?\nThanks,\nDeva\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403497", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: sortable columns for multiple custom post types not working I have two custom post types named professor and campus.\nTo each of these CPT's I have added two custom admin columns named image and last_modified, which currently display correctly on both CPT's admin tables.\nI have also filtered each CPT by post_type, however the manage_edit-post_sortable_columns is not displaying the titles as sortable in the admin tables.\nI thought if I used manage_edit-post_sortable_columns I could target the ones I have conditionally checked for?\nAm I missing something?\nHere is the code:\n// add featured image and last modified columns to cpt admin tables (works correctly)\nfunction cpt_columns($columns) {\n    global $current_screen;\n    if (in_array($current_screen->post_type, array('professor', 'campus'))) {\n        $columns['last_modified'] = 'Last Modified';\n        $columns['post_thumbs'] = 'Image';\n    }\n    return $columns;\n}\nadd_filter('manage_posts_columns', 'cpt_columns');\n\n\n// custom columns as sortable (not working)\nfunction cpt_columns_sortable($columns) {\n    global $current_screen;\n    if (in_array($current_screen->post_type, array('professor', 'campus'))) {\n        $columns['last_modified'] = 'Last Modified';\n        $columns['post_thumbs'] = 'Image';\n    }\n    return $columns;\n}\nadd_filter('manage_edit-post_sortable_columns', 'cpt_columns_sortable');\n\n\n// output custom column content\nfunction cpt_columns_content($column_id, $post_id) {\n    if ($column_id == 'last_modified') {\n        echo get_post_field('post_modified', $post_id);\n    } else if ('post_thumbs') {\n        echo the_post_thumbnail('xsm_thumbnail');\n    }\n}\nadd_action('manage_posts_custom_column', 'cpt_columns_content', 10, 2);\n\n\nA: \nI thought if I used manage_edit-post_sortable_columns I could target\nthe ones I have conditionally checked for?\n\nThat hook runs only on the \"Posts\" page (at wp-admin/edit.php) for managing posts in the default/core post post type. I.e. When the post_type parameter in the (current page) URL is not set or empty, or that it's set to post.\nFor other post types like page and your campus CPT, use edit-<post type> in place of edit-post.\nSo replace the add_filter('manage_edit-post_sortable_columns', 'cpt_columns_sortable'); with:\nadd_filter('manage_edit-campus_sortable_columns',    'cpt_columns_sortable');\nadd_filter('manage_edit-professor_sortable_columns', 'cpt_columns_sortable');\n\nApart from that, you also need to correct the $columns format you used, where the correct one is $columns['<column name/slug>'] = '<orderby value passed to WP_Query>', and not $columns['<column name/slug>'] = '<column title>'.\nTherefore in your cpt_columns_sortable() function:\n// Use this:\n$columns['last_modified'] = 'modified';    // 'modified' is a synonym for post_modified\n$columns['post_thumbs']   = 'post_thumbs'; // post_thumbs is a custom orderby value\n\n/* Not this:\n$columns['last_modified'] = 'Last Modified';\n$columns['post_thumbs'] = 'Image';\n*/\n\nAnd that should work, for making the posts sortable by the modification date, because modified is a standard orderby value for WP_Query.\nBut as for sorting the posts by the post thumbnails (?), you'll need to handle that on your own, e.g. using the pre_get_posts hook.\nAnd note that the_post_thumbnail() echo the output, so don't do \"echo the_post_thumbnail\".\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403500", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to assign a role to a simple visitor? I'd like to know how to assign a role to a visitor/guest.. I've searched for a plugin or else, but none were able to do that !\nCan anyone help me ?\nThanks a lot\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403501", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Transfer XAMPP local Wordpress website from one PC to another I use XAMPP to build my wordpress site locally. How can I transfer my website to another computer and continue the build from there also locally?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403502", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Include last post date in get_categories loop I have a simple get_categories loop on a template page which works fine to display a list of categories within the parent category 52 (as shown below).\nI would like to also display the last post date with each category so it displays the date of the latest posts within the category. Is this possible:\n<?php\n$args = array('parent' => 52);\n$categories = get_categories( $args );\nforeach($categories as $category) { \n    \n    echo '<p>Category: <a href=\"' . get_category_link( $category->term_id ) . '\" title=\"' . sprintf( __( \"View all posts in %s\" ), $category->name ) . '\" ' . '>' . $category->name.'</a> </p> ';\n    echo '<p> Description:'. $category->description . '</p>';\n    echo '<p> Post Count: '. $category->count . '</p>';\n}\n?>\n\nThank you\nLuke\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403503", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Permalinks do not include www subdomain I recently migrated a website which was both hosted with and without www subdomain. I configured the .htaccess to always redirect to www:\nRewriteCond %{HTTP_HOST} ^[^.]+\\.[^.]+$\nRewriteCond %{HTTPS}s ^on(s)|\nRewriteRule ^ http%1://www.%{HTTP_HOST}%{REQUEST_URI} [L,R=301]\n\nAlso the site address is now configured to use www:\n\nAnd the permalinks also seem to use to www subdomain:\n\nHowever, if I configure a slug for a page as bellow and try to access the page using the post name,  the server will send a 301 redirect (GET www.example.com/example-post -> 301 with location https://example.com/example-slug which will redirect again to https://www.example.com/example-slug due to the .htaccess config). Also, all guids inside the database do not contain the www.\n\nIs there a way to prevent these unnecessary redirects? My SEO analysis tool is complaining about redirection chains.\n\nA: Settings in .htaccess tell the server how to handle requests. Since the site previously allowed both www and non-www URLs, you'll want to keep your .htaccess in place, so old links redirect properly. However, that doesn't tell WP that it's now living in the www subdomain; it stores URLs in many places.\nYou can ignore the GUIDs - they're just unique IDs - but you can run a search and replace script or plugin to update all the other URLs in the database.\nIf you have WP CLI enabled, the command is\nwp search-replace 'https://example.com' 'https://www.example.com'\n\nIf not, there are also database migration plugins available that will update all the URLs and re-serialize them properly in the database.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403504", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sort by alphabetical order archive.php page <?php if ( have_posts() ) : ?>\n    <?php while ( have_posts() ) :  the_post();\n    $image = wp_get_attachment_image_src( get_post_thumbnail_id( $post->ID ), 'full' ); \n            \n    ?>          \n                    \n            <div class=\"col-md-4 col-lg-3\">\n                <div class=\"servicecard\">\n                  <div class=\"border icon rounded-circle shadow text-center\">\n                      \n                      <?php if(get_field('add_service_icon')){?>\n                      <img src=\"<?php the_field('add_service_icon'); ?>\">\n                      <?php } else {?>\n                      <img src=\"<?php echo get_template_directory_uri(); ?>/assets/images/camera (1).png\" class=\"w-100  rounded\">\n                      <?php } ?>\n                      \n                      </div>\n                  <h3 class=\"fw-bold text-theme mb-3 fs-5\"><?php the_title(); ?></h3>\n<!--                   <h6 class=\"mb-3 \">A NEW PARADIGM INONLINE DISPLAY ADVERTISING.</h6> -->\n                  <p><?php echo wp_trim_words(get_the_content(),20);?></p>\n                  <a href=\"<?php the_permalink(); ?>\" class=\"animated bg-black border border-white bounceInUp d-inline-block hvr-bg hvr-text joinbtn mt-2 text-white\" style=\"animation-delay: 0.3s;\">Know More</a>\n                  \n               </div>\n            </div>\n            \n            \n        \n    <?php endwhile; ?>\n<?php else : ?> \n            <h1 class=\"text-center\">Sorry. No Services Found!</h1>\n<?php endif; ?>\n\nI am using the above code to display my services in archive.php page. Let me know how can I sort those outputs alphabetically. Thanks in advance. I want to pass arguments before the loop.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403506", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: List latest post for each tag with a category I have a page where the latest posts are displayed from within a specific category.\narray( \n    'posts_per_page' => -1,\n    'post_status'=>\"publish\",\n    'post_type'=>\"post\",\n    'orderby'=>\"post_date\",\n    'order'=>'DESC',\n    'cat'=>\"5\"\n)\n\nWithin this I would like to only show the latest post for each tag. I don't know if this is possible but I'm hoping I'm wrong.\n\nA: I think I've cracked it. So now the latest post for each tag type is now displayed. A bit beyond my coding level but its working.\n<?php $args = array(\n'type' => 'post',\n'orderby' => 'post_date');\n$tags = get_tags($args);\nforeach($tags as $tag) { \n    $the_query = new WP_Query( 'tag='.$tag->slug );\n    if ( $the_query->have_posts() ) {\n        $the_query->the_post();\n        $desired_posts[] = get_the_ID(); // all the post IDs stored here.\n    } else {\n    // no posts found\n    }\n    wp_reset_postdata();\n}\n$args1 = array(\n    'post_type' => 'post',\n    'orderby' => 'date',\n    'post__in' => $desired_posts,\n    'posts_per_page' => -1\n); \n$the_query = new WP_Query( $args1 );\n    if ( $the_query->have_posts() ) {\n        while ( $the_query->have_posts() ) {\n        $the_query->the_post(); ?>\n            \n      <div class=\"\">MY HTML STUFF HERE</div>                    \n                        \n       <? } } else {\n    // no posts found\n    }; ?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403510", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce plugin - How to create two versions of the same plugin with slightly different implementation for different users I am working on the development of a woocommerce plugin and this plugin is shipped to 2 different set of customers. I'd like to manage both of those versions in one git repository. But then ship to each customer their version (I send them a zipped folder of the plugin).\nIssue:\nIt is a hassle to maintain two versions on two separate git branches and there is no complier for example to apply certain changes based on which version of the plugin I am creating\nGoal:\nI am trying to manage two different versions of a plugin in the same repository\nMethods I've tried:\nHaving the files the are different between both versions in separate folders and making an alias in the cmd that I use to copy the files intended for this version before zipping the folder\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403514", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Don't update modify time post on Quick Edit How can I disable updating modify post time when something is changed in Quick Edit mode?\nI found this snippet but I don't know how to implement that to reflect in Quick Edit mode?\nfunction stop_modified_date_update( $new, $old ) {\n$new['post_modified'] = $old['post_modified'];\n$new['post_modified_gmt'] = $old['post_modified_gmt'];\nreturn $new;\n}\nadd_filter( 'wp_insert_post_data', 'stop_modified_date_update', 10, 2 );\nremove_filter( 'wp_insert_post_data', 'stop_modified_date_update', 10, 2 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403515", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: update_post_meta() updating nested array in Multidimensional array with empty sub-array How can i update/remove/empty a sub-array on user post submission in admin area?\nhere ist the reference on how to update nested array  i am using but it is not working\nif ( $post->post_type == 'ds_product' ) {\n     \n    \n    if ( isset( $_POST['meta'] ) ) { \n        if ( !empty($_POST['meta']['ds_product_gallery']) ){\n             \n            $gallery_data = []; \n\n            for ($i = 0; $i < count( $_POST['meta']['ds_product_gallery']['picture'] ); $i++ )\n            {\n                if ( !empty($_POST['meta']['ds_product_gallery']['picture'][ $i ]))\n                {\n                    $gallery_data['picture'][ ]    = $_POST['meta']['ds_product_gallery']['picture'][ $i ];\n                    $gallery_data['figcaption'][ ] = $_POST['meta']['ds_product_gallery']['figcaption'][ $i ];\n                }\n            }\n\n            if ( !empty($gallery_data) ) {\n                $_POST['meta']['ds_product_gallery'] = $gallery_data;\n            } \n        \n        }else{  \n            // this section doesn't clear the array\n            $data = get_post_meta( $post->ID, 'meta', true );  \n            $data['ds_product_gallery'][0][0] = [];\n            update_post_meta( $post_ID, 'meta', $data[0] ); \n            \n        } \n        foreach( $_POST['meta'] as $key => $value ){\n            update_post_meta( $post_id, $key, $value );\n        }\n    } \n}\n\n\nA: You would do it the same way as any other PHP application, this isn't a WordPress problem.\nTo remove an item from an array in PHP, use unset( thing to remove ).\nE.g.\n$test = [ 'banana', 'cucumber', 'apple' ];\nunset( $test[1] );\n// cucumber is no longer in the test array, and the array now has 2 not 3 items\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403516", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add custom text automatically on each post Suppose I have a post and it's the first paragraph is:\n\"This a Pen. The color is red.\"\nI want to add a custom text like \"2022\" after \"Pen\" on first sentence, at the end of the text line.\nExample: \"This a Pen, 2022. The color is red.\"\nI need to add this to all of the posts automatically. Is there a way to do that?\nOr do I have to replace in the database?\n\nA: You can use a regular expression to sniff for it on the the_content filter.\nadd_filter( 'the_content', 'wpse403518_custom_text' );\nfunction wpse403518_custom_text( $content ) {\n    $regex   = '/^([^\\.!?]+)([\\.!?])(.*)$/';\n    $replace = '$1 2022$2$3';\n    $content = preg_replace( $regex, $replace, $content );\n    return $content;\n}\n\nThe regex\nThe $regex variable is a regular expression, and what it does, roughly, is this:\n\n*\n\n*^ means the start of the string; then\n\n*([^\\.!?]+) means \"match everything that is not a ., !, or ? one or more times\" (ie, the first sentence, until we hit a ., !, or ?); then\n\n*([\\.!?]) means \"match a single ., !, or ?\" (ie, the first sentence-ending punctuation in the string); then\n\n*(.*) means \"all the characters\"; then\n\n*$ means \"the end of the string\".\n\nThe $replace variable assigns $1 to the first group above (the first sentence), $2 to the second group (ie, the first ., !, or ?), and $3 to the third group (ie, the rest of the content). So what happens is that the  2022 gets inserted between the first sentence and the punctuation at its end, then the rest of the text gets printed as normal.\nReferences\n\n*\n\n*the_content filter\n\n*preg_replace()\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403518", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show list of woo commerce orders where particular zip code exists using pre_get_posts? I am working on a project where I have to show a list of woo-commerce orders where a particular postcode/zip code exists.\nI am using hook pre_get_posts to achieve that when I pass a single key and value order start showing but when I add multiple key and values no order is showing.\nThe code I am using is from wordpress.stackexchange.com but still, it is not working for multiple keys and values.\nI am sure there is something wrong in the code that I can identify any help will be appreciated. Thanks\nadd_action( 'pre_get_posts', array($this, 'zipcode_wise_post_filter') );\nfunction zipcode_wise_post_filter( $query ) {\n\nif( !$query->is_main_query() ) return;\n\nif(isset(wp_get_current_user()->roles[0]) && wp_get_current_user()->roles[0] == 'order_manager'){\n    $user_id = get_current_user_id();\n    $zip_code = array(60643,1600, 02134);\n\n\n    $meta_query = $query->get(\"meta_query\");\n    $meta_query = array(\n        \"relation\" => \"AND\",\n    );\n\n    $query->set('post_type', 'shop_order' );\n\n    foreach ($zip_code as $code) {\n      $meta_query[]  =   array(\n          'key'=>'_billing_postcode',\n          'value'=>$code,\n          'compare' => 'EXISTS',\n      );\n    }\n\n\n    $query->set('meta_query',$meta_query ); \n\n} \n\nreturn $query; \n}\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403519", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Fallback media image for featured image not working in admin column I want to display a fallback image if a custom post type does not have a featured image set and displayed in a custom admin table column.\nHowever all that is being output is the image url and not the image from the media library.\nI have used wp_get_attachment_image_src() to output the image, though I may not be going about it correctly?\n// fill column header content\nfunction cpt_columns_content($column_id, $post_id) {\n    if ($column_id == 'last_modified') {\n        echo get_post_field('post_modified', $post_id);\n    } else if ('post_thumbs') {\n        the_post_thumbnail('xsm_thumbnail');\n\n    // not sure this is the correct way to go?\n    } if (!has_post_thumbnail()) {\n        // 156 is the specific media image id\n        echo wp_get_attachment_image_src(156, 'archive_thumbnail')[0];\n    }\n}\nadd_action('manage_professor_posts_custom_column', 'cpt_columns_content', 10, 2);\nadd_action('manage_campus_posts_custom_column', 'cpt_columns_content', 10, 2);\n\n\nA: wp_get_attachment_image_src(156, 'archive_thumbnail')[0] will only echo the URL of the image.  You need to add it to html to display the image.  Try this:\necho '<img src=\"'.wp_get_attachment_image_src(156, 'archive_thumbnail')[0].'\"/>';\n\nYou could add the width etc as well\necho '<img src=\"'.wp_get_attachment_image_src(156, 'archive_thumbnail')[0].'\" width=\".wp_get_attachment_image_src(156, 'archive_thumbnail')[1].\" height=\".wp_get_attachment_image_src(156, 'archive_thumbnail')[2].\" />';\n\nwhat happens if someone deletes this image though?  Do you have a fallback?\nIt may be better to add the fallback image to your theme or plugin directory and reference it that way.\nUPDATE\nIf you just want to add the image as simply as possible. You could also try this:\nwp_get_attachment_image( 156, 'archive_thumbnail' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403521", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Wordpress paginate_links function: How do i ensure the page number is not less than 1 and not greater than last I have a $wpdb query that selects all rows from MySQL table written in a custom php file. The query returns 2122 results. I have set the the code to output 20 rows per page which means i have a total of 107 pages.\nThe last page url renders like so:\nlocalhost/index.php/publications/?cpage=107\n\nMy problem is that when i insert an argument like 108 e.g.,localhost/index.php/publications/?cpage=108 (which is greater than last page) or the argument 0(which is less than 1) e.g., localhost/index.php/publications/?cpage=0 in the the link, wordpress goes ahead and renders a blank page. How does wordpress validate pagination urls? What should i change to ensure that when a user enters an argument less than 1 they are redirected to page 1? Likewise, how do i ensure that if a user inserts a page number greater than the last page in the url wordpress redirects to the lastpage?\nHere is my code:\n<?php\n$totalresults = $wpdb->get_var(\"SELECT COUNT(*) FROM \".$wpdb->prefix.\"refs1 \");\n$limit = 20;\n$currentpage = isset($_GET['cpage']) ? (int)$_GET['cpage'] : 1;\n$offset = ($currentpage * $limit) - $limit;\n$numbering = ((($currentpage*$limit)-$limit)+20);\n$lastpage = ceil($totalresults / $limit);\n\n//Here is my attempt to ensure users are redirected to lastpage/first page if the enter wrong arguments in the url\nif($lastpage <1){\n    $lastpage = 1;\n} \n//\n$pagenumber = 1;\n//\nif(isset($_GET['cpage'])){\n    $pagenum = preg_replace('#[^0-9]#', '', $_GET['cpage']);\n}\nif ($pagenum < 1){\n    $pagenum = 1;\n} else if ($pagenum > $lastpage){\n    echo \"past lastpage\";\n    $pagenum = $lastpage;\n}\n\n\n$get = $wpdb->get_results(\"SELECT * FROM \".$wpdb->prefix.\"refs1 \" . \"LIMIT $offset, $limit\");\n$i = $offset+1;\nforeach ($get as $result){\n    $citation = $result->citation;\n    $cit1 = strtok($citation, \".\");\n    $cit2 = substr($citation, strpos($citation, \".\") + 1);\n    //echo $cit2 . \"<br>\";\n    echo \"<p>\" . $i++ . \". \" . \"<a href = '#'>\" . $result->title . \".\" . \"</a>\". \"<br>\" . $result->authors . \"<br>\" . \"<u>\" . $cit1 . \".\" . \"</u>\" . $cit2 . \"<br>\" ;\n    \n} \n//pagination_pages();\necho paginate_links( array(\n    'base' => add_query_arg( 'cpage', '%#%' ),\n    'format' => '',\n    'prev_text' => __('&laquo;'),\n    'next_text' => __('&raquo;'), \n    'total' => ceil($totalresults / $limit),\n    'current' => $pagenum\n    ));\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403525", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is doing_wp_cron a necessary query string when scheduling cron.php as a cron job? I have seen various ways to schedule the WordPress cron so that it is triggered by the server. Some will run the php file directory from the crontab and others will use a wget and reference the url. I have noticed some sites suggesting this:\nwget -q -O - https://domain.com/wp-cron.php?doing_wp_cron >/dev/null 2>&1\n\nWhat is the difference between this and just using\nwget -q -O - https://domain.com/wp-cron.php >/dev/null 2>&1\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403526", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: How to use in Block Editor - react-bootstrap? I want to use in Guttenberg block some of tools used in react-bootstrap but something not work in my code property.\nFirst I npm install react-bootstrap bootstrap@5.1.3 the newest version, and this is register in package.json as well. Then in edit.js I try to import all dependencies:\n import { useBlockProps, InnerBlocks } from '@wordpress/block-editor';\n import Card from 'react-bootstrap/Card';\n  import React, { Component } from \"react\";\n  import { IWPGBlock } from 'react-gutenberg/'\nimport * as React from 'react'\n\n\nand for sure that I made it correctly use an example from react's page.\nexport default function Edit() {\n\n     return (\n         <p {...useBlockProps()}>\n<Card style={{ width: '18rem' }}>\n  <Card.Img variant=\"top\" src=\"holder.js/100px180\" />\n  <Card.Body>\n    <Card.Title>Card Title</Card.Title>\n    <Card.Text>\n      Some quick example text to build on the card title and make up the bulk of\n      the card's content.\n    </Card.Text>\n    <Button variant=\"primary\">Go somewhere</Button>\n  </Card.Body>\n</Card>\n\n         </p>\n     );\n }\n\n\nunfortunetelly, it did not work. I have no clue what I should change, can you give me a feedback?\nUPDATE:\nI try another way to solve this problem. I create another file to make my own component: komponent.js\nimport Card from 'react-bootstrap/Card';\nimport React, { Component } from \"react\";\n\n\nexport default class  cardcomponents extends Component  {\nrender(){\n    return (\n        <p {...useBlockProps()}>\n<Card style={{ width: '18rem' }}>\n <Card.Img variant=\"top\" src=\"holder.js/100px180\" />\n <Card.Body>\n   <Card.Title>Card Title</Card.Title>\n   <Card.Text>\n     Some quick example text to build on the card title and make up the bulk of\n     the card's content.\n   </Card.Text>\n   <Button variant=\"primary\">Go somewhere</Button>\n </Card.Body>\n</Card>\n\n        </p>\n    );\n}\n}\n\nthen it import to edit.js just like that import {cardcomponents} from './komponent.js';\nand try to render\n export default function Edit() {\n\n     return (\n         <p {...useBlockProps()}>\n\n<effectivecards />\n<p>another div</p>\n         </p>\n     );\n }\n\nbut this show me just another div. somewhere must be a mistake.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403529", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Single field to search for matches on post ID or meta values I'm sure someone else had this need somewhere... I just couldn't find it!\nSo I have a search field where I want to write something and what I write returns me WooCommerce orders.\nThis is my working code that searchs for first and last billing names:\n$args = array(\n    'post_type'       => 'shop_order',\n    'posts_per_page'  => '-1',\n    'post_status'     => array_keys( wc_get_order_statuses() ),\n    'meta_query'      => array(\n        'relation'    => 'OR',\n        array(\n            'key'     => '_billing_first_name',\n            'compare' => 'LIKE',\n            'value'   => $_GET['sc'],\n        ),\n        array(\n            'key'     => '_billing_last_name',\n            'compare' => 'LIKE',\n            'value'   => $_GET['sc'],\n        )\n    )\n);\n\nBut I also want to be able to search for post ID so that I can allow, on that one field, for users to search for order ID, first and last billing names.\nHow can I achieve this?\nEDIT:\nAfter the suggestion from the user mukto90, I did some changes and the code now works perfectly.\n$args = array(\n    'post_type'       => 'shop_order',\n    'posts_per_page'  => '-1',\n    'post_status'     => array_keys( wc_get_order_statuses() ),\n);\n\nif( 'shop_order' == get_post_type( $sc_esc ) ) {\n    $args['p'] = $sc_esc;\n} else {\n    $args['meta_query'] = array(\n        'relation'    => 'OR',\n        array(\n            'key'     => '_billing_first_name',\n            'compare' => 'LIKE',\n            'value'   => $sc_esc,\n        ),\n        array(\n            'key'     => '_billing_last_name',\n            'compare' => 'LIKE',\n            'value'   => $sc_esc,\n        )\n    );\n}\n\n\nA: Use this code instead-\n$args = array(\n    'post_type'       => 'shop_order',\n    'posts_per_page'  => '-1',\n    'post_status'     => array_keys( wc_get_order_statuses() ),\n    'meta_query'      => array(\n        'relation'    => 'OR',\n        array(\n            'key'     => '_billing_first_name',\n            'compare' => 'LIKE',\n            'value'   => $_GET['sc'], // you should escape this\n        ),\n        array(\n            'key'     => '_billing_last_name',\n            'compare' => 'LIKE',\n            'value'   => $_GET['sc'], // you should escape this\n        )\n    )\n);\n\n// if there is an order that has the same ID as what user inputs, include that in the query too\nif( 'shop_order' == get_post_type( $_GET['sc'] ) ) {\n    $args['p'] = $_GET['sc']; // you should escape this\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403533", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to save Setting pages data to the database? I have created a setting page and I have a basic form in there I want to save its data in the database how can I achieve that.\nThis is the HTML form:\n<label class=\"\"><?php _e('Message', 'domain'); ?> </label>\n<textarea class=\"message form-control\" name=\"my_settings_fields[message]\"><?php echo esc_html($my_setting_data[ 'message' ]); ?></textarea>\n\nThis is how I registered my setting page:\n  public function my_register_settings()\n  {\n    register_setting('my_setting_option_page', 'my_settings_fields', 'sd_callback_function');\n  }\n\n  /**\n   * Register the plugin settings page.\n   *\n   * @since    1.0.0\n   */\n  public function my_register_menu_page()\n  {\n    add_submenu_page(\n        'edit.php?post_type=post',\n        __('FAQPress Settings', 'domain'),\n        __('Settings', 'domain'),\n        'manage_options', 'my_settings',\n        array($this, 'my_add_setting_page'));\n  }\n\n  /**\n   * Callback for plugin setting page registration.\n   *\n   * @since    1.0.0\n   */\n  public function my_add_setting_page()\n  {\n    require plugin_dir_path(__FILE__) . 'partials/my-admin-settings.php';\n  }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403536", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to redirect on login to a specific page if a specific meta user is empty I would like to indicate that if you do not have the first_name filled in when logging in, you will be redirected to a specific page, for example /onboarding and if the first_name field is filled, you would be redirected to the home page. I would like it to always perform the check and redirect whenever first_name is empty\nI am trying the following code but it does not work.\nfunction login_redirect( $redirect, $user ) {    \n// Get user meta\n$field_empty = get_user_meta( $user->ID, 'first_name', true );\n\n// Empty\nif ( empty( $field_empty ) ) {\n    $redirect = '/onboarding';\n} else {\n \n    $redirect = '/';     \n}\n\nreturn $redirect;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403541", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: comment_notification_text filter not working I want to customize notification for post author when comment is posted.\nMy code in functions.php is :\n//add notifications when comment\nadd_action( 'wp_insert_comment', 'wp_notify_postauthor' );\n\n//change email notification comment\nfunction wpd_comment_notification_text( $notify_message, $comment_id ){\n    // get the current comment and post data\n    $comment = get_comment( $comment_id );\n    $post = get_post( $comment->comment_post_ID );\n    // don't modify trackbacks or pingbacks\n    if( '' == $comment->comment_type ){\n        // build the new message text\n        $notify_message  = sprintf( __( 'New comment on your post \"%s\"' ), $post->post_title ) . \"\\r\\n\";\n        $notify_message .= sprintf( __('Author : %1$s'), $comment->comment_author ) . \"\\r\\n\";\n        $notify_message .= sprintf( __('E-mail : %s'), $comment->comment_author_email ) . \"\\r\\n\";\n        $notify_message .= __('Comment: ') . \"\\r\\n\" . $comment->comment_content . \"\\r\\n\\r\\n\";\n        $notify_message .= __('You can see all comments on this post here: ') . \"\\r\\n\";\n        $notify_message .= get_permalink($comment->comment_post_ID) . \"#comments\\r\\n\\r\\n\";\n        $notify_message .= sprintf( __('Permalink: %s'), get_comment_link( $comment_id ) ) . \"\\r\\n\";\n\n        if ( user_can( $post->post_author, 'edit_comment', $comment_id ) ) {\n            if ( EMPTY_TRASH_DAYS )\n                $notify_message .= sprintf( __('Trash it: %s'), admin_url(\"comment.php?action=trash&c=$comment_id\") ) . \"\\r\\n\";\n            else\n                $notify_message .= sprintf( __('Delete it: %s'), admin_url(\"comment.php?action=delete&c=$comment_id\") ) . \"\\r\\n\";\n            $notify_message .= sprintf( __('Spam it: %s'), admin_url(\"comment.php?action=spam&c=$comment_id\") ) . \"\\r\\n\";\n        }\n    }\n    // return the notification text\n    return $notify_message;\n}\nadd_filter( 'comment_notification_text', 'wpd_comment_notification_text', 1, 2 );\nadd_filter( 'comment_moderation_text', 'wpd_comment_notification_text', 1, 2 );\n\nNow, notification is send but with default message (I remove URL and whois in mine).\nI don't understand why my filter is not working.\nThanks a lot\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403543", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress 404 on Subdomain I have taken a copy of my Wordpress website and set up a subdomain, and virtual host (/var/www/subdomain/) on the existing websites server.\nAfter moving the copy of the website I am getting a 404 error on all pages except the Home Page and WP Admin area.\nApache Conf file below;\n<VirtualHost *:80>\nServerName subdomain.example.com\nServerAlias subdomain.example.com\nDocumentRoot /var/www/subdomain\nRewriteEngine on\nRewriteCond %{SERVER_NAME} =subdomain.example.com\nRewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]\n</VirtualHost>\n\nEdited\nAlso below is the SSL Cert apache conf\n<IfModule mod_ssl.c>\n<VirtualHost *:443>\nServerName subdomain.example.com\nServerAlias subdomain.example.com\nDocumentRoot /var/www/subdomain\n\nSSLCertificateFile /certfile/directory/\nSSLCertificateKeyFile /certfile/directory/\nInclude /certfile/directory/\n</VirtualHost>\n</IfModule>\n\nI have ensured the htaccess file is present, site url and home url are updated and resaved the permalinks, but the 404 error is still happening.\nI have also tried disabling plugins to make sure nothing was clashing\nHTACCESS File below;\n# BEGIN WordPress\n<IfModule mod_rewrite.c>\nRewriteEngine On\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /index.php [L]\n</IfModule>\n# END WordPress\n\nThe existing Wordpress website on the server (/var/www/html/) is working fine and has no errors.\nAny suggestions on things I might have missed / not set up correctly would be greatly appreciated.\nThank you\n\nA: You don't appear to have allowed .htaccess overrides in the <VirtualHost *:443> container, so .htaccess is effectively disabled. Without .htaccess you'll naturally get 404s for anything other than the homepage if you are using \"pretty\" permalinks. (.htaccess is not required for requests to the homepage, since index.php is served by mod_dir which is no doubt configured elsewhere in the main server config.)\nYou need something like this inside the <VirtualHost *:443> container:\n<Directory /var/www/subdomain>\n    Require all granted\n\n    # Enable .htaccess overrides\n    AllowOverride All\n</Directory>\n\nYou don't appear to be allowing access (ie. Require all granted) in the config you've posted so you are presumably handling this outside of the vHost? But make sure you are not enabling access to too much.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403544", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Website jumps to top when scrolling down I have a problem with one of my customers pages. When I click a link on the website or when I refresh the page, it automatically jumps back to the top when I immediately start scrolling. If I wait for some seconds it won't do that. Any suggestions on how to solve that problem?\nThis is the website I'm describing:\nhttps://www.ingenieur-group.de/\n\nA: If you start to scroll before the page finish loading, it will jump back to the top.\nYou can add a Preloader to hide the content of the page until it is fully loaded to prevent this (https://wordpress.org/plugins/search/preloader/).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403545", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ACF - Hiding metaboxes through screen settings doesn't work Hiding ACF metaboxes through screen settings seems to be properly saved in user settings (wp_usermeta.meta_key = 'metaboxhidden_{contentType}):\n+--------+-------+----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|umeta_id|user_id|meta_key              |meta_value                                                                                                                                                                                                                                                        |\n+--------+-------+----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|2602    |73     |metaboxhidden_vehicule|a:8:{i:0;s:23:\"wp-statuses-publish-box\";i:1;s:21:\"controltower_meta_box\";i:2;s:21:\"tagsdiv-type_vehicule\";i:3;s:16:\"history_meta_box\";i:4;s:23:\"acf-group_6225c9161faad\";i:5;s:23:\"acf-group_6225d0a97d028\";i:6;s:23:\"acf-group_621dea45ea7be\";i:7;s:7:\"slugdiv\";}|\n+--------+-------+----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\nOn page refresh, screen settings shows the metabox checkbox back to its \"checked\" state, and the metabox is still shown.\nInspecting WP's rendered HTML content shows the checkbox setting in its unchecked state, as expected.\nIt seems that ACF overwrites the metabox visibility checkbox on client side, and forces its checked state:\n// acf-input.js#11260\n\n// Create new hide toggle.\nif( $('#adv-settings').length ) {\n    var $prefs = $('#adv-settings .metabox-prefs');\n    var $label = $([\n        '<label for=\"' + result.id + '-hide\">',\n            '<input class=\"hide-postbox-tog\" name=\"' + result.id + '-hide\" type=\"checkbox\" id=\"' + result.id + '-hide\" value=\"' + result.id + '\" checked=\"checked\">',\n            ' ' + result.title,\n        '</label>'\n    ].join(''));\n    \n    // Copy default WP events onto checkbox.\n    copyEvents( $prefs.find('input').first(), $label.find('input') );\n    \n    // Append hide label\n    $prefs.append( $label );\n}\n\n\nIs there any way to make ACF respect user's metaboxed visibility preferences?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403549", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: gravityform - retrieve multiple check answers \"keys\" instead of \"values\" I need to implement a custom math sum relative to the answers of a multiple checkbox question.\nLet's suppose I have a question like this:\nQuestion:\n\n*\n\n*first choice\n\n*second choice\n\n*third choice\n\nIf I \"show values\", by default, the value will be equal to the key. so:\n\n*\n\n*first choice = \"first choice\"\n\n*second choice = \"second choice\"\n\n*third choice = \"third choice\"\n\nLet's suppose I give these 3 answers numeric values, for example:\n\n*\n\n*first choice = 3\n\n*second choice = 1\n\n*third choice = 5\n\nlike this I will be able with a numeric field to make a sum of the values just by calling the mergetags. Let's suppose the above question has ID 26, on my numeric field I will just activate the math calculation and I will have the sum just by using {:26.1} + {:26.2} + {:26.3}\nBut doing so, on my admin side, when a user submit the form, it will display the numeric values. Let's suppose the user chose answer 1 and answer 3, the output on the admin panel will be something like this:\nQuestion:\n3 <- corresponding to first choice numeric value\n5 <- corresponding to third choice numeric value\nDoing so I'm not able to see what answer they actually chose, but only the value.\nIs there any way on the admin side to retrieve the key instead of the value to be able to display the text answer instead of its numeric value?\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403550", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Setting boolean and array values using wp theme mod set I need to set a couple of Theme Mods to boolean and array values using WP CLI but can't find any way to do achieve it.\nI have already tried the following for booleans, but they appear to be treated as string:\nwp theme mod set my_theme_mod true\nwp theme mod set my_theme_mod 1\n\nFor arrays, I don't even know where to start, so have not tried anything yet.\nAny pointers please?\n\nA: Funny how you find the answer just after posting a question. Posting here, in case someone comes looking for it.\nAs per @Kero's comment above, that's correct. The command-line option will only recognise strings.\nThere is however an eval-file command that can be used to achieve this (and now that I have discovered it, a lot more).\nHere are the steps for achieving the goal I posted in my question, however as the eval-file WP CLI command can be used to execute a PHP file, we can code anything that we deem fit.\nStep 1: Create a PHP file with the required code. In my example here, I added the following:\n<?php\nset_theme_mod('my_boolean_mod', false);\nset_theme_mod('my_array_mod', array(1, 2, 3));\n\nThe above code will use the WordPress set_theme_mod function to create/update mods named my_boolean_mod and my_array_mod.\nStep 2: Execute the above file using the WP CLI eval-file command\n wp eval-file my_file.php\n\nThat's it. Hope this is useful!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403551", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Multiple jQuery inputs or binds in Customizer Control Javascripts If I have 2 javascript parts (for the Wordpress customizer), how do I get part_two to have access to use the data entry from part_one? See example below. The part_two script needs access to part_one and part_two simultaneously. (Not asking about php part, only the javascript part.)\nI assume the script needs to all be in one single script instead of two scripts pointing at 2 parts. Because if it was combined in one script it would have access to both parts I assume. I don't know how to write one single script for this type of formula.\napi('yeah[part_one]' , function (value) {\n value.bind(function(part_one) {\n  $('#htmlcss > location > yes-in').css({ 'specificcode' : part_one });\n });\n});\n\napi('yeah[part_two]' , function (value) {\n value.bind(function(part_two) {\n  $('#htmlcss > location > yes-ok').css({ 'specificcode' : part_one + part_two });\n });\n});\n\nSee part_two simply needs to print as if it is able to print the css just side by side so whatever the value of part_one is it prints it before (or after if placed after) part_two, in this example it would be before.\nIf you don't understand me here is what the output would look like from the result of the final part_two script:\n#htmlcss > location > yes-ok {\n specificcode:1px 2px;\n}\n\nFor example: 1px would be data from part_one and 2px would be data from part_two.\n\nSomeone wrote to me privately and said my words are not clear enough. I don't know the correct terms but maybe its called, I am wanting to write js to BIND to 2 wordpress settings in customizer. Here is another example of what I am trying to write and note this would be in the wordpress customizer.js file:\napi('yeah[part_one]' , function (value) {\n var part_two=api('yeah[part_two]').val();\n value.bind(function(part_one) {\n  $('#htmlcss > location > yes-ok').css({ 'specificcode' : part_one + part_two });\n });\n});\n\n\nA: I think the part you may be missing is that you don't have to use the value that is passed to the function. You can still reference the setting inside the callback function, including other settings. So you can do this:\n// Run a callback when both of the settings are registered.\nwp.customize( 'yeah[part_one]', 'yeah[part_two]', ( part_one, part_two ) => {\n    // Run callback when part one is changed.\n    part_one.bind( () => {\n        $( '#htmlcss > location > yes-in' ).css( { 'specificcode': part_one.get() } );\n    } );\n\n    // Run callback when part two is changed, but using the values of both part one and two.\n    part_two.bind( () => {\n        $( '#htmlcss > location > yes-ok' ).css( { 'specificcode': part_one.get() + part_two.get() } );\n    } );\n} );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403554", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to use wp_enqueue_script properly? I'm trying to load mine scripts, but it doesn't work properly.\nfunction theme_enqueue_assets() {\n    wp_enqueue_script('load_more', get_stylesheet_directory_uri() . '/assets/js/load_more.js', array('jquery'), '1.0', true);\n}\n\nadd_action('wp_enqueue_scripts', 'theme_enqueue_assets');\n\nI've checked the path, and it's 100% ok.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403556", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: One Custom post type 404's others don't I've created 7 custom post types and all but one works. I don't even know where to go from here. I've flushed my permalink structure, and that didn't work. The following code is the array that I'm passing to my custom post type construction function:\n<?php\nrequire('CustomPostTypes.php');\nrequire('CustomPostTaxonomies.php');\nrequire('SaveCustomPosts.php');\nfunction createposts(){\n    $PostList = array('Jobs'                    =>array('plural'    =>'Jobs',\n                                                        'singular'  =>'Job',\n                                                        'taxonomies'=>array('post_tag','Departments')),\n                      'Display Products'    =>array('plural'    =>'Display Products',\n                                                        'singular'  =>'Display Products',\n                                                        'taxonomies'=>array('post_tag','display-types')),\n                      'Partners'                =>array('plural'    =>'Partners',\n                                                        'singular'  =>'Partner',\n                                                        'taxonomies'=>array('post_tag','partner-types')),\n                      'Events'                  =>array('plural'    =>'Events',\n                                                        'singular'  =>'Event',\n                                                        'taxonomies'=>array('post_tag','event-types')),\n                      'Product Profiles'        =>array('plural'    =>'Product Profiles',\n                                                        'singular'  =>'Product Profile',\n                                                        //'hierarchical' => true,\n                                                       //'exclude-from-search' => true,\n                                                       ),\n                      'Service Reports'         =>array('plural'    =>'Service Reports',\n                                                        'singular'  =>'Service Report',\n                                                       'exclude-from-search'=>true,),\n                      'Intake Damage Report'    =>array('plural'    =>'Damage Reports',\n                                                        'singular'  =>'Damage Report',\n                                                        'exclude-from-search'=>true,));\n    \n    add_custom_posts($PostList);\n}\n\nAnd this is the code that I'm using to create the custom post types:\n<?php\n\nfunction add_custom_posts($PostList){\n    foreach($PostList as $PostType){\n        if(isset($PostType['singular'])){\n            $PostSingular = $PostType['singular'];\n        } else {\n            $PostSingular = '';\n        }\n        if(isset($PostType['plural'])){\n            $PostPlural = $PostType['plural'];\n        }else{\n            $PostPlural = '';\n        }\n        if(isset($PostType['hierarchical'])){\n            $Hierarchical = true;\n        }else{\n            $Hierarchical = false;\n        }\n        if(isset($PostType['parent'])){\n            $Parent = $PostType['parent'];\n        }else{\n            $Parent = '';\n        }\n        if(isset($PostType['taxonomies'])){\n            $Taxonomies = $PostType['taxonomies'];\n        }else{\n            $Taxonomies = '';\n        }\n        if(isset($PostType['exclude_from_search'])){\n            $ExcludeFromSearch = $PostType['exclude_from_search'];\n        }else{\n            $ExcludeFromSearch = false;\n        }\n        custom_post_type($PostSingular,$PostPlural,$Hierarchical,$Parent,$Taxonomies,$ExcludeFromSearch);\n    }\n}\n\nfunction custom_post_type($PostSingular,$PostPlural,$Hierarchical,$Parent,$Taxonomies,$ExcludeFromSearch) {\n\n    $PostLabels = array(\n        'name'                  => __( $PostPlural),\n        'singular_name'         => __( $PostSingular),\n        'menu_name'             => __( $PostPlural),\n        'parent_item_colon'     => __( 'Parent '.$PostSingular),\n        'all_items'             => __( 'All '.$PostPlural),\n        'view_item'             => __( 'View '.$PostSingular),\n        'add_new_item'          => __( 'Add New '.$PostSingular),\n        'add_new'               => __( 'Add '.$PostSingular),\n        'edit_item'             => __( 'Edit '.$PostSingular),\n        'update_item'           => __( 'Update '.$PostSingular),\n        'search_items'          => __( 'Search '.$PostPlural),\n        'not_found'             => __( 'Not Found'),\n        'not_found_in_trash'    => __( 'Not found in Trash'),\n    );\n    \n    $PostArgs = array(\n        'label'                 => __( $PostPlural),\n        'description'           => __( $PostPlural),\n        'labels'                => $PostLabels,\n        'supports'              => array( 'title', 'editor', 'author', 'revisions', 'custom-fields', ),\n        'hierarchical'          => $Hierarchical,\n        'public'                => true,\n        'show_ui'               => true,\n        'show_in_menu'          => true,\n        'show_in_nav_menus'     => true,\n        'show_in_admin_bar'     => true,\n        'can_export'            => true,\n        'has_archive'           => true,\n        'exclude_from_search'   => $ExcludeFromSearch,\n        'yarpp_support'         => true,\n        'publicly_queryable'    => true,\n        'capability_type'       => 'post',\n        'show_in_rest'          => true,\n        'position'              => 5,\n\n    );\n    if($Hierarchical === true){\n        $PostArgs['rewrite'] = array('slug'=>str_replace(' ','-',strtolower($PostPlural)),'with_front' => false,);\n        array_push($PostArgs['supports'],'page-attributes');\n    }\n    if($Parent !== ''){\n        $PostLabels['parent_item'] = 'Parent ' . str_replace(' ','-',strtolower($Parent));\n        $PostLabels['parent_item_colon'] = 'Parent ' . str_replace(' ','-',strtolower($Parent)) . ':';\n    }\n    if($Taxonomies !== ''){\n        $PostArgs['taxonomies']= $Taxonomies;\n    }\n    register_post_type(str_replace(' ','-',strtolower($PostPlural)), $PostArgs );\n}\n\nThe custom post in question should be sitting at the following URL, but it keeps returning a 404 error:\nwww.example-domain.com/product-profiles/%product-profile%\nAll of the other custom post types resolve correctly and there's nothing in the debug log. As such, I'm completely lost as to how to resolve this issue. Any help would be greatly appreciated.\n\nA: So, I still have no idea what was going on. I had to disable the custom post type and drop all references to the 'product-profiles' entries that I had created from the wp_posts table manually, including autodrafts and revisions. After that I was able to re-enable the 'product-profile' post type and it ended up working\nIf anyone has any insight as to what caused this, please chime in.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403557", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP-Bakery - Add custom colors to buttons with template colors I'd like to add custom colors to the wp-bakery-front editor.\nAdding all the colors works but I just want to add the color of the current template.\nMy function.php in the theme has the folowing function to add the colors to the button settings.\nfunction change_vc_button_colors() {\n    $param = WPBMap::getParam( 'vc_btn', 'color' );\n     \n    $param['value'] = [];\n        \n    $param['value'][__('Custom-Color-1', 'theme-name' )] = 'active-orange';\n    $param['value'][__('Custom-Color-Template1-blue', 'theme-name' )] = 'active-orange';\n    $param['value'][__('Custom-Color-Template2-green', 'theme-name' )] = 'active-orange';\n    $param['value'][__('Custom-Color-Template3-orange', 'theme-name' )] = 'active-orange';\n    $param['value'][__('Custom-Color-Template4-yellow', 'theme-name' )] = 'active-orange';\n    \n    //Finally \"update\" with the new values\n    vc_update_shortcode_param( 'vc_btn', $param );\n}\n\n\nIs it possible to ask in this function the current used template name and add only this colors (like over a if-clause) ?\nBecuase this don't work:\nglobal $template\nif (str_contains($template, 'template.php')) \n{\n    $param['value'][__('Custom-Color-1', 'theme-name' )] = 'active-orange';\n}\n\nor with\nget_post_meta( $post->ID, '_wp_page_template', true );\n\nWhen the page has the themplate \"template1\" it should be like this (so only one additional color):\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403558", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change Image Size option in the settings in bulk I was wondering if I can change Image Size option in the post settings panel. From Large to Full Size. Automatically in all posts? I have about 500 posts... :) Seem can not find any answer to that. Thank you!\n\n\nA: Well, i think you totally right, there is no way to bulk change like that. But i found solution. Since Google Discover uses Featured Images for display, i can add my big size Featured Image to the post <?php the_post_thumbnail('full'); ?> and hide it with css from the page rendering, but Google will use it as a display image.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403560", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress link to post links to category (loop) Mindnumbing problem.\n\n*\n\n*create a blog post in WP backend\n\n*select category for post (e.g. podcast)\n\n*click update\n\nNavigate to blog category page (https://www.bioelectricshield.com/in-the-media/category/podcast)\nClick on post (https://www.bioelectricshield.com/in-the-media/emfs-empaths-need-to-know)\nURL stays the same in the location bar (url), does not show post, instead redirects to some category (unknown) that lists one blog post. Clicking on THIS post also does not show the post, but redirects to some other URL that shows a category listing of blog posts.\nSome posts do work. Not sure why some and not others. Any useful direction is appreciated.\n\nA: Found the problem It was theme (Impreza) related (thank you @cjbj).\nWhen the blog post category was created, it created a loop via the theme:\nincorrect:\n\ncorrect:\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403563", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to show ACF fields in Gridbuilder custom block I'm using GridBuilder WP (great plugin, average support) to show a grid of a custom post type. Ultimately, I need to show an ACF taxonomy field, and their support have recommended using one of their nifty Custom Blocks, but at the moment I'm struggling to just show a text field (as a test) in a Custom Block. This is the suggested code, but it always shows the label \"Email\" with an empty field, even though there is a normal block above showing the custom field successfully.\nadd_filter(\n    'wp_grid_builder/blocks',\n    function( $blocks ) {\n\n        $blocks['email_block'] = [\n            'name'            => __( 'Email block', 'text-domain' ),\n            'render_callback' => function() {\n\n                // Get email from ACF field.\n                global $post;\n                $post = wpgb_get_post();\n                setup_postdata( $post );\n                $email = get_field('email');\n\n                if( $email ) {\n                    printf(\n                        '<a href=\"mailto:%1$s\" rel=\"external noopener noreferrer\" target=\"_blank\">%2$s</a>',\n                        esc_attr( rawurlencode( $email ) ),\n                        esc_html( 'Email' )\n                    );              \n                }\n                wp_reset_postdata();\n                \n\n            },\n        ];\n\n        return $blocks;\n\n    }\n);\n\nHas anyone managed to show custom fields in a Gridbuilder WP custom block?\n\nA: Not sure if you have already resolved your issue, but I am in a similar situation. You could take a look at this webpage for guidance:\nhttps://wpdevdesign.com/how-to-create-custom-blocks-in-wp-grid-builder/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403564", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Need to edit author permissions | custom taxonomy I created custom taxonomy (like category) for default post.\nI want to change access permission for this taxonomy. Like below\nAdmin can edit, create on this custom taxonomy. But Author can't edit, create.\nCan you help me. How to change permission\nThis my taxonomy code\nfunction cptui_register_my_taxes() {\n\n    /**\n     * Taxonomy: Content Status.\n     */\n\n    $labels = [\n        \"name\" => __( \"Content Status\", \"feminine-lite\" ),\n        \"singular_name\" => __( \"Content Status\", \"feminine-lite\" ),\n    ];\n\n    \n    $args = [\n        \"label\" => __( \"Content Status\", \"feminine-lite\" ),\n        \"labels\" => $labels,\n        \"public\" => false,\n        \"publicly_queryable\" => false,\n        \"hierarchical\" => true,\n        \"show_ui\" => true,\n        \"show_in_menu\" => true,\n        \"show_in_nav_menus\" => true,\n        \"query_var\" => true,\n        \"rewrite\" => [ 'slug' => 'content_status', 'with_front' => true, ],\n        \"show_admin_column\" => true,\n        \"show_in_rest\" => true,\n        \"show_tagcloud\" => true,\n        \"rest_base\" => \"content_status\",\n        \"rest_controller_class\" => \"WP_REST_Terms_Controller\",\n        \"show_in_quick_edit\" => true,\n        \"show_in_graphql\" => false,\n    ];\n    register_taxonomy( \"content_status\", [ \"post\" ], $args );\n}\nadd_action( 'init', 'cptui_register_my_taxes' );\n\n\n\n\n\nfunction cptui_register_my_taxes_content_status() {\n\n    /**\n     * Taxonomy: Content Status.\n     */\n\n    $labels = [\n        \"name\" => __( \"Content Status\", \"feminine-lite\" ),\n        \"singular_name\" => __( \"Content Status\", \"feminine-lite\" ),\n    ];\n\n    \n    $args = [\n        \"label\" => __( \"Content Status\", \"feminine-lite\" ),\n        \"labels\" => $labels,\n        \"public\" => false,\n        \"publicly_queryable\" => false,\n        \"hierarchical\" => true,\n        \"show_ui\" => true,\n        \"show_in_menu\" => true,\n        \"show_in_nav_menus\" => true,\n        \"query_var\" => true,\n        \"rewrite\" => [ 'slug' => 'content_status', 'with_front' => true, ],\n        \"show_admin_column\" => true,\n        \"show_in_rest\" => true,\n        \"show_tagcloud\" => true,\n        \"rest_base\" => \"content_status\",\n        \"rest_controller_class\" => \"WP_REST_Terms_Controller\",\n        \"show_in_quick_edit\" => true,\n        \"show_in_graphql\" => false,\n    ];\n    register_taxonomy( \"content_status\", [ \"post\" ], $args );\n}\nadd_action( 'init', 'cptui_register_my_taxes_content_status' );\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403565", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Edit and delete permissions pages and posts Does anybody know if it is possible to protects some pages and posts from editing / deleting unless if the role is admin?\nNot all posts and pages has to be protected against this!\nI can not read something about this in the documentation of roles and capabillities.\nHope somebody can help me out with this.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403566", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: need to find duplicated meta value in custom filed and view the posts that have the same value I used this code but return blank\n<?php\nglobal $post;\nglobal $wpdb;\n\n$duplicate_titles = $wpdb->get_results(\"\n    SELECT meta_value FROM $wpdb->postmeta\n    INNER JOIN $wpdb->posts\n      {$wpdb->posts}.ID = {$wpdb->postmeta}.post_id\n    WHERE meta_key= wpcf-bank_no \n    AND {$wpdb->posts}.post_type = 'passpor' \"\n\n);\n    \n    foreach( $duplicate_titles as $metakey ) {\n    $post_ids = $wpdb->get_col( $wpdb->prepare( \"SELECT post_id FROM {$wpdb->postmeta} INNER JOIN $wpdb->posts\n      {$wpdb->posts}.ID = {$wpdb->postmeta}.post_id WHERE meta_value=%s\", $metakey ) ); \n            \n        \n     foreach( array_slice( $post_ids, 1 ) as $post_id ) {\n\n        \n     echo get_the_title( $post_id ) ; \n   }\n}\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403567", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: List unused javascript for easy removal My page speed is suffering from unused javascript. I am using the Perfmatters plugin. IN Perfmatters, you can list the javascript for each page.\nIs there a list somewhere of what each of these Wordpress related javascripts do? Or is there a tool that will tell me which ones are unneeded on my site? I would do trial and error but that always backfires.\nI'd love to know which of these I can just turn off.\nThanks!\n\n\nA: \nIs there a list somewhere of what each of these Wordpress related javascripts do?\n\nThere is no comprehensive list that does this, and many of those items would not appear on it as they're not WordPress internal files or may be required by non-WordPress files to function. Those files may be built to require them even if they don't always use their contents.\n\nOr is there a tool that will tell me which ones are unneeded on my site?\n\nI believe you've already used that tool and it told you there was lots of unused javascript. Keep in mind that just because it was unused, doesn't mean it isn't in use. A person who has only ever seen a bedroom may consider a bath or shower an unused and unnecessary item in a house by this logic.\n\nI would do trial and error but that always backfires.\n\nThis is the only method available to you that can give you certainty.\nFundamentally, the real question is why you have so many javascript files being loaded in the first place. Using this plugin to block them being loaded is a patch/workaround at best that doesn't address the root problem or poorly built plugins/themes or too many plugins on your site. Assuming there was a problem at all, not all tools provide useful answers, many can make misleading recommendations based on out of date practices or missing context.\nAlso, there is no guarantee that the list in your screenshot is a list of files that are being loaded. This looks like a full list of everything WordPress has, even the things that are only loaded in WP-Admin. Many of those toggles will make zero difference to your frontend performance as they were never loaded to begin with.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403568", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: Yoast Metadata API to adjust/override the meta description I wanted to use the following function to override the Yoast meta description:\nadd_filter('wpseo_metadesc','custom_meta');\nfunction custom_meta( $desc ){\n\n    if (/* do your test here to check template or any other values*/) {\n        $desc = \"Change the description\";\n    } \n\n    return $desc;\n}\n\nHowever, Yoast SEO support recommends the Metadata API.\nFrom this page, I understand I can use the wpseo_metadesc filter to adjust the Meta_Description_Presenter, but I am unsure how it is done; I am not a programmer.\nI'd love some assistance to create some functions.php code that will grab the first 160 characters of the content if the meta description hasn't been set already.\nHelp appreciated.\nSteve\n\nA: I think you're on the right track here. You can use the wpseo_metadesc filter to alter the meta description any way you want. Check out below code, maybe it'll help you with your function.\nadd_filter( 'wpseo_metadesc', 'my_custom_meta_description' );\nfunction my_custom_meta_description($description) {\n    if ( !$description || empty($description) ) {\n        global $post;\n        $content = get_the_content($post->ID);\n        if ( $content && !empty($content) ) {\n            $description = substr($content, 0, 160);\n        }\n    }\n    return $description;\n}\n\nI haven't tested the function so you may need to customize it for your need.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403569", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Could add_query_arg() redirect user to external site? I was reading this to learn to create my own WooC payment gateway. It says,\n\nBut if you want the customer to process the payment on the gateway\nwebsite then use the add_query_arg() function instead.\n\nCould I use add_query_arg() to process the payment outside of my site such as add_query_arg( 'key', 'value', 'http://externalpaymentsite.com' ); by redirecting my user to that site outside of mine?\n\nA: The function add_query_arg() will generate a link with query parameters.\nYou should also handle the redirect additionally. Something like this will work:\n$url = add_query_arg('key', 'value', 'http://externalpaymentsite.com');\nwp_redirect($url)\nexit;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403570", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do you save the values from custom fields to a products data So Ive got alot of custom fields on the page to create a product and I\u2019m trying to figure out how to save each field. Also I need to save a few fields as an attribute of the product as I\u2019ve got a table plugin that displays attributes in a different way to the other data in it.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403571", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WooCommerce login redirect based on cart I want to apply following 2 case :\nIf User not logged in and cart has product: Then redirect user to login and after login redirect to checkout page. I have used a code but it redirecting to the current page i.e if we check out from home page it will redirect to home page itself after login, if it is from shop page it will redirect to shop page. I want to redirect to checkout page only.\nMy code\nadd_action('template_redirect','check_if_logged_in');\nfunction check_if_logged_in()\n{\n    $pageid = get_option( 'woocommerce_checkout_page_id' );\n    if(!is_user_logged_in() && is_page($pageid))\n    {\n        $url = add_query_arg(\n            'redirect_to',\n            get_permalink($pagid),\n            site_url('/my-account/') // your my account url\n        );\n        wp_redirect($url);\n        exit;\n    }\n    if(is_user_logged_in())\n    {\n    if(is_page(get_option( 'woocommerce_myaccount_page_id' )))\n    {\n        \n        $redirect = $_GET['redirect_to'];\n        if (isset($redirect)) {\n        echo '<script>window.location.href = \"'.$redirect.'\";</script>';\n        }\n\n    }\n    }\n}\n\n\nA: case 1:\nfunction wpse_131562_redirect() {\n    if (\n        ! is_user_logged_in()\n        && (is_cart() || is_checkout())\n    ) {\n        // feel free to customize the following line to suit your needs\n         wp_redirect( home_url( '/my-account/' ) );\n        exit;\n    }\n}\nadd_action('template_redirect', 'wpse_131562_redirect');\n\n\nA: case 2:\nadd_filter( 'woocommerce_login_redirect', 'jabir_woocommerce_redirect_after_login', 9999, 2 );\n \nfunction jabir_woocommerce_redirect_after_login( $redirect, $user ) {\n     \n        \n        $redirect = wc_get_page_permalink( 'checkout' ); // checkout\n        \n    \n  \n    return $redirect;\n}\n\nHope This two hooks help you to get what you want, thank you :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403572", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add Paypal button redirect to a specific page after completing I have created a new page on my WordPress site to test the paypal payment flow. I have subscription based products. Attached code is for the paypal subscription button code.\n <div id=\"paypal-button-container-P-91F08612M1573283BMIUWMOA\"></div>\n<script src=\"https://www.paypal.com/sdk/js?client-id=AfGWAPJxdGbCj7b51a2mpoZQYI5y63txxxxxxxxIe1UDh2Vxcr05AFJxxxxNSCNDf8y-xopaJ6&vault=true&intent=subscription\" data-sdk-integration-source=\"button-factory\"></script>\n<script>\n  paypal.Buttons({\n      style: {\n          shape: 'rect',\n          color: 'gold',\n          layout: 'vertical',\n          label: 'subscribe'\n      },\n      createSubscription: function(data, actions) {\n        return actions.subscription.create({\n          /* Creates the subscription */\n          plan_id: 'P-91xxxxxxxxxxxxxxx'\n        });\n      },\n      onApprove: function(data, actions) {\n        alert(data.subscriptionID); // You can add optional success message for the subscriber here\n      }\n  }).render('#paypal-button-container-P-91F08612M1573283BMIUWMOA'); // Renders the PayPal button\n</script>\n\nMy outcome was success and it shows this message. \nOn completion, I just get an order number pop-up and then it stays on the same page. (check the image) What I want now is to redirect my user to a specific page after successful payment. I already set the URL auto return path from paypal but it won't working. See my paypal configuration from the below image. \nHow can I redirect user by adjusting the code? Will I be able to make that change?\n\nA: https://www.paypal.com/us/smarthelp/article/how-do-i-use-paypal's-auto-return-feature-to-redirect-customers-back-to-my-website-faq3651\npaypal provide this auto redirect to merchant please try again may be it should work.\n\nA: This would redirect you to a specific page\n onApprove: function(data, actions) {\n        actions.redirect('https://gutsycreatives.com/'); // You can add optional success message for the subscriber here\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403573", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Translate website without duplicate custom post I have a website where anyone can post jobs from frontend. The jobs pages are rendered by custom archive and single pages in my custom theme.\nI want the website to be multi language with switcher. The problem is to translate the static text in archive-job.php and singe-job.php, without translating the content of jobs.\nI tried polylang, but that one needs multiple posts, one for each language. Which means that I need to duplicate the post content\nIs there a way to assign multiple languages to same post, without creating redundant posts in polylang (or a free alternative, excepting WPML)?\n\nA: You could create one post with each language variation wrapped in a custom tag. You would need to create a parser then to extract the language you require but it would avoid creating redundant posts like you wished.\nFor example the post content would be:\n<eb>This is my post<en><de>Das ist mein Beitrag<de>\n\nI currently use WPML and would highly reccomend it!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403577", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Multisite Subdirectory Site Dashboard redirect loop I recently activated multisite and received my code to add to wp-config.php.\nWordPress wanted to force me to use subdomains.\nI wanted to use subdirectories, so I used:\ndefine( 'WP_ALLOW_MULTISITE', true);\ndefine( 'MULTISITE', true );\ndefine( 'SUBDOMAIN_INSTALL', false );\ndefine( 'DOMAIN_CURRENT_SITE', 'www.example.com' );\ndefine( 'PATH_CURRENT_SITE', '/' );\ndefine( 'SITE_ID_CURRENT_SITE', 1 );\ndefine( 'BLOG_ID_CURRENT_SITE', 1 );\n\nI then used the .htaccess code from this answer:\nRewriteEngine On\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\n\n# uploaded files\nRewriteRule ^([_0-9a-zA-Z-]+/)?files/(.+) /wp-includes/ms-files.php?file=$2 [L]\n\n# add a trailing slash to /wp-admin\nRewriteRule ^([_0-9a-zA-Z-]+/)?wp-admin$ $1wp-admin/ [R=301,L]\n\nRewriteCond %{REQUEST_FILENAME} -f [OR]\nRewriteCond %{REQUEST_FILENAME} -d\nRewriteRule ^ - [L]\nRewriteRule ^([_0-9a-zA-Z-]+/)?(wp-(content|admin|includes).*) /$2 [L]\nRewriteRule ^([_0-9a-zA-Z-]+/)?(.*\\.php)$ /$2 [L]\nRewriteRule . index.php [L]\n\nHowever, I still receive a redirect loop when trying to load www.example.com/au/wp-admin/:\nThis page isn\u2019t working \nwww.example.com redirected you too many times.\nTry clearing your cookies.\nERR_TOO_MANY_REDIRECTS\n\nI have cleared my cookies and the issue remains.\nHelp appreciated.\nEDIT\nI created a blank local MU subdirectory site and copied its .htaccess:\nRewriteEngine On\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\n\n# add a trailing slash to /wp-admin\nRewriteRule ^([_0-9a-zA-Z-]+/)?wp-admin$ $1wp-admin/ [R=301,L]\n\nRewriteCond %{REQUEST_FILENAME} -f [OR]\nRewriteCond %{REQUEST_FILENAME} -d\nRewriteRule ^ - [L]\nRewriteRule ^([_0-9a-zA-Z-]+/)?(wp-(content|admin|includes).*) $2 [L]\nRewriteRule ^([_0-9a-zA-Z-]+/)?(.*\\.php)$ $2 [L]\nRewriteRule . index.php [L]\n\nbut the error remains.\n\nA: I spoke to the web host, WP Engine, who advised us that an extra license is required to turn a WP site into MU, which we don't currently have.\nThey confirmed the error was caused by our lack of a MU license.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403578", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to use attributes in competent of Gutenberg I try to make my new plugin to develop my skills. I have problem to use attributes and set them in component.\nIn block.json I register:\n    \"attributes\":{\n        \"title\": {\n            \"type\": \"string\"\n        }, \n        \"content\": {\n            \"type\": \"string\",\n            \"selector\": \"h2\"\n        },\n        \"footer\": {\n            \"type\": \"string\"\n        }\n    },\n\nbut I do not know where and how I should use them in komponent.js:\nimport React, { Component, Fragment } from \"react\";\nimport {\n  TextControl,\n  Card,\n  CardHeader,\n  CardBody,\n  CardFooter,\n  __experimentalText as Text,\n  __experimentalHeading as Heading,\n} from '@wordpress/components';\nimport {  InnerBlocks } from '@wordpress/block-editor';\n\n\n\n\nexport class  EffectiveCards extends Component  {\n\n  constructor() {\n        super( ...arguments );\n\n        this.onChangeTitle = this.onChangeTitle.bind( this );\n    this.onFocusTitle = this.onFocusTitle.bind( this );\n\n    }\n\n  onChangeTitle( value ) {\n        this.props.setAttributes( { title: value } );\n    }\n  \n  onFocusTitle( focus ) {\n        this.props.setFocus( _.extend( {}, focus, { TextControl: 'title' } ) );\n    }\n\n  render() {\n    \n\n  \n\n    return (\n\n      <Fragment >\n\n      <Card>\n        <CardHeader>\n        <InnerBlocks\ntemplate={ MY_TEMPLATE }\ntemplateLock=\"insert\"\n\n/>\n    \n        </CardHeader>\n        <CardBody>\n        <TextControl\n                            tagName=\"h2\"\n                            placeholder={ __( 'Write title\u2026' ) }\n                            value={ attributes.title }\n                            onChange={ this.onChangeTitle }\n                            focus={ focusedTextControl === 'title' }\n                            onFocus={ this.onFocusTitle }\n                        />\n        </CardBody>\n        <CardFooter>\n     \n            </CardFooter>\n    </Card>\n</Fragment>\n        )\n    }\n}\n\n\nconst MY_TEMPLATE =  [[ 'core/column', {}, [\n  [ 'core/heading', { content: 'Tytu\u0142', selector: 'h2' } ], \n  [ 'core/image', { default: 'Rounded' } ],\n    \n]]];\n\n\nexport default Cocoszka\n\n\nI this component export to edit.js and there it work good, unless I try to use attributes.\nin edit.js it is simple I put edit ({attributes, setAttributes}) but  here? I have no clue.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403580", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Archive page of CPT's custom Taxonomy I have a Custom Post Type: \"Sponsors\"\nSponsors have a Custom Taxonomy: \"Sponsor Ranks\"\nSponsor Ranks are divided like Platinum Sponsors - Gold Sponsors - Silver Sponsors and so on\nI want to make an archive page that will show me all sponsors within their respected rank\nCurrently I have something that works perfectly fine but I am unsure if this is the right way. I am basically making a new query every time, that doesn't feel right.\n    <div class=\"row\">\n        <?php\n            $args = array(\n                'post_type' => 'dev_sponsors',\n                'tax_query' => array(\n                'relation' => 'AND',\n                    array(\n                        'taxonomy' => 'sponsor_ranks',\n                        'field' => 'slug',\n                        'terms' => array( 'platinum-sponsors' )\n                    )\n                )\n            );\n            $query = new WP_Query( $args );     \n        ?>\n        Platinum Sponsors:<br />\n        <?php if ( $query->have_posts() ) : while ( $query->have_posts() ) : $query->the_post(); ?>\n            <?php $img = get_the_post_thumbnail(get_the_ID(), 'gold'); ?>\n            <div class=\"col-3\">\n            <?php echo $img; ?><br />\n            <?php echo $post->post_title; ?>    \n            </div>\n         <?php endwhile; \n         wp_reset_postdata();           \n         endif; ?>          \n    </div>      \n    <div class=\"row\">\n        <?php\n            $args = array(\n                'post_type' => 'dev_sponsors',\n                'tax_query' => array(\n                'relation' => 'AND',\n                    array(\n                        'taxonomy' => 'sponsor_ranks',\n                        'field' => 'slug',\n                        'terms' => array( 'gold-sponsors' )\n                    )\n                )\n            );\n            $query = new WP_Query( $args );     \n        ?>\n        Gold Sponsors:<br />\n        <?php if ( $query->have_posts() ) : while ( $query->have_posts() ) : $query->the_post(); ?>\n            <?php $img = get_the_post_thumbnail(get_the_ID(), 'gold'); ?>\n            <div class=\"col-3\">\n            <?php echo $img; ?><br />\n            <?php echo $post->post_title; ?>    \n            </div>\n         <?php endwhile; \n         wp_reset_postdata();           \n         endif; ?>          \n    </div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403582", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP function won't work on 404 template page I made a custom template of error 404 page.\nIn my header.php i use the_time() function to display current date.\nThere is some problem with 404 page because the_time() function won't work, not return any date.\nWhy is that happen?\n\nA: the_time does not display the current date, it displays the date of the current post, and 404 pages do not have a current post.\nFor this reason, if it ever returned a date on the 404 page then it would be a bug.\nInstead you should use the PHP functions that come with PHP to display the current date and time.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403583", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce variable product's total amount by javascript I have a plugin that update the product price depended on selected variation. My problem is that there are two prices that my plugin change just one of them. I want to change the code to update the total amount too. I want to know how can I change this amount by javascript.\n\nI checked the page's template in single-product/add-to-cart/variation.php and find this line that generate the secound/total price:\n<div class=\"woocommerce-variation-price\">{{{ data.variation.price_html }}}</div>\n\nIs there any way to update this price that can show total amount by javascript?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403584", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Creating mySQL procedure with $wpdb I'm trying to create a calendar table upon activation of a custom plugin I am building. The procedure script I am using can be seen here:\n\nhttps://gist.github.com/bryhal/4129042\n\nThe first part that creates the time_dimension table works fine but the procedure does not. I read a post about using dbDelta() instead of $wpdb but it hasn't helped. There is an error on line 13 of the script on the github page but I have resolved that.\nWhen I go into phpMyAdmin and run the script manually it works fine but an alert does pop up to confirm that you want to run the procedure so I wonder is that causing an issue.\nThanks for reading!\nfunction activate_wp_ssm()\n{\n\nrequire_once plugin_dir_path(__FILE__) . 'includes/class-wp-ssm-activator.php';\nwp_ssm_Activator::activate();\nrequire_once(ABSPATH . 'wp-admin/includes/upgrade.php');\n\nglobal $wpdb;\n$sql = \"DROP TABLE IF EXISTS time_dimension;\nCREATE TABLE time_dimension (\n        id                      INTEGER PRIMARY KEY,  -- year*10000+month*100+day\n        db_date                 DATE NOT NULL,\n        year                    INTEGER NOT NULL,\n        month                   INTEGER NOT NULL, -- 1 to 12\n        day                     INTEGER NOT NULL, -- 1 to 31\n        quarter                 INTEGER NOT NULL, -- 1 to 4\n        week                    INTEGER NOT NULL, -- 1 to 52/53\n        day_name                VARCHAR(9) NOT NULL, -- 'Monday', 'Tuesday'...\n        month_name              VARCHAR(9) NOT NULL, -- 'January', 'February'...\n        holiday_flag            CHAR(1) DEFAULT 'f' CHECK (holiday_flag in ('t', 'f')),\n        weekend_flag            CHAR(1) DEFAULT 'f' CHECK (weekend_flag in ('t', 'f')),\n        event                   VARCHAR(50),\n        UNIQUE td_ymd_idx (year,month,day),\n        UNIQUE td_dbdate_idx (db_date)\n\n) Engine=MyISAM;\";\n\n$create_procedure = \"DROP PROCEDURE IF EXISTS fill_date_dimension;\nDELIMITER //\nCREATE PROCEDURE fill_date_dimension(IN startdate DATE,IN stopdate DATE)\nBEGIN\nDECLARE currentdate DATE;\nSET currentdate = startdate;\nWHILE currentdate < stopdate DO\n    INSERT INTO time_dimension VALUES (\n                YEAR(currentdate)*10000+MONTH(currentdate)*100 + DAY(currentdate),\n                currentdate,\n                YEAR(currentdate),\n                MONTH(currentdate),\n                DAY(currentdate),\n                QUARTER(currentdate),\n                WEEKOFYEAR(currentdate),\n                DATE_FORMAT(currentdate,'%W'),\n                DATE_FORMAT(currentdate,'%M'),\n                'f',\n                CASE DAYOFWEEK(currentdate) WHEN 1 THEN 't' WHEN 7 then 't' ELSE 'f' END,\n                NULL);\nSET currentdate = ADDDATE(currentdate,INTERVAL 1 DAY);\nEND WHILE;\nEND\n// DELIMITER;\n\nTRUNCATE TABLE time_dimension;\";\n\n$call_procedure = \"CALL fill_date_dimension('1-01-01','2015-01-01');\nOPTIMIZE TABLE time_dimension\";\n\ndbDelta($sql);\ndbDelta( $create_procedure );\ndbDelta( $call_procedure );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403587", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to disable wp_mail for all users except for admins? I am using the following code to disable wp_mail however how do I disable it only for non-admins. Any user with admin privileges should still receive their emails.\nadd_filter('wp_mail','disabling_emails', 10,1);\nfunction disabling_emails( $args ){\n    unset ( $args['to'] );\n    return $args;\n}\n\n\nA: You could use the email address to get the user object, which will include the user ID.  You can use the user ID to check the user's capabilities to see if they have a capability assigned to the admin user role, and if not, unset the address:\nadd_filter('wp_mail','disabling_emails');\nfunction disabling_emails( $args ){\n    $user = get_user_by( 'email', $args['to'] );\n    if ( ! user_can( $user->ID, 'create_users' ) ) {\n        unset ( $args['to'] );\n    }\n    return $args;\n}\n\nSome notes about what is being done here:\n\n*\n\n*Note that I used user_can() to check a capability.  People tend to use current_user_can() and user_can() to check if a user has a role.  This is an improper use of the function.  You can do it, and it will generally work, but why do it wrong when you can do it right?  Pick a capability that users you intend to send email to will have that other users will not have.  In a default WP setup, only admins will have create_users capability, so this is a good one to check against.\n\n*I would be judicious in using this.  Depending on how users interact with the site (if at all), what if a user needs to reset a forgotten password?  A non-admin user will not be able to receive a password reset.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403589", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: URL with login details included for public members I've come across this How can I automatically login using a URL? for providing login details within the URL for admin access. How would I modify to use variable URLs for different posts?\neg. https://www.blahblahblah.co.uk/events/event-id#details?username=XXX&password=YYY\nUser roles are defined as 'entrant'.\nDifferent use - sent within an email reminder from a template where event-id is defined by the plugin's placeholder.I'd like to log the entrant back into the site if they aren't already to take them to information only available once a signed up entrant to specific events, it gets anonymised as it goes through the SMTP server so any login information is hidden.\nSorry I'm not a coder but have a with a basic understanding and am good at ctrl+c & ctrl+v\nThanks for any help.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403590", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display term picture of each post in a loop I'm trying to solve a problem I have for many days. I'm posting it here in case some of you would know the answer.\n\n*\n\n*I want to display a grid of 9 posts on my homepage. Each of these posts has one custom taxonomy apply to them. It's their issue name.\n\n\n*If one of the posts doesn't have a featured image, I want the issue image to appear. I added a field with ACF to be able to have a picture for my custom taxonomy.\nThanks in advance for your help.\nFran\u00e7ois\n<?php\n\n$args = [\n    \"posts_per_page\" => 9,\n    \"post_type\" => \"post\",\n    \"post_status\" => \"publish\",\n    \"order\" => \"ASC\",\n];\n$query = new WP_Query($args);\nif ($query->have_posts()): ?>\n\n<section class=\"home-grid\">\n\n<?php while ($query->have_posts()):\n    $query->the_post(); ?>\n\n<div>\n\n<div class=\"pb-3\">\n\n<?php if (has_post_thumbnail()): ?>\n\n<a href=\"<?php the_permalink(); ?>\">\n\n<?php the_post_thumbnail(\"article-large\"); ?>\n\n</a>\n\n<?php else:$terms = wp_get_post_terms($post->ID, \"issues\");\n\n    foreach ($terms as $cat):\n\n        $size = \"article-large\";\n\n        $image_id = get_field(\"image_tag\", $cat, false);\n        $image = wp_get_attachment_image_src($image_id, $size);\n        ?>\n\n\n<img src=\"<?php echo $image[0]; ?>\" />\n\n<?php endforeach;endif; ?>\n\n</div>\n\n<div class=\"px-1\">\n\n\n<h3><a href=\"<?php the_permalink(); ?>\"><?php the_title(); ?></a></h3>\n\n<div class=\"author-link\">\n<?php $confirm = get_field(\"other_type_of_byline\"); ?>\n\n<h4><?php the_field(\"other_type_of_byline\"); ?></h4>\n\n</div>\n\n<div class=\"read-more\"><a href=\"<?php the_permalink(); ?>\">\n<span class=\"text\">read</span><span class=\"icon\">\n     <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\" style=\"width:24px;height:24px;margin-left:5px;fill:#F46767\"><path d=\"M 21.1875 9.28125 L 19.78125 10.71875 L 24.0625 15 L 4 15 L 4 17 L 24.0625 17 L 19.78125 21.28125 L 21.1875 22.71875 L 27.90625 16 Z\"></path></svg>                   \n</span></a></div>\n\n</div>\n</div>\n\n<?php\nendwhile; ?>\n\n\n</section>\n<?php endif;\nwp_reset_postdata();\n\n?>\n\n\n\n\nA: So, I finally found the solution. Maybe there are better ways to arrive to the same result, but at least, it works.\nHere it goes:\n\n<?php       \n\n    $terms = get_the_terms( $post->ID , 'issues' );\n    \n    foreach ($terms as $key) :\n            \n        $size = \"article-small\";\n\n        $image_id = get_field(\"image_tag\", $key, false);\n        $image = wp_get_attachment_image_src($image_id, $size);\n\n        ?>\n\n\n<img src=\"<?php echo $image[0]; ?>\" />\n\n<?php endforeach;  ?>\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403593", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress is already installed I installed WP however I don't remember the login and password. So I need to do the configuration again where I set the email and password. However when I acesss that page:\nhttp://localhost:80/wp-admin/install.php\n\nIt shows a message saying that Wordpress is already installed: \"You appear to have already installed WordPress. To reinstall please clear your old database tables first.\nDo you know what is necessary to do to do the initial configuration again? Thanks in advance.\n\nA: You can see the username in the database and change the password easily. You do not need to reinstall wordpress.\nIf you need to reconfigure, there are several ways:\n\n*\n\n*Delete wp-config.php and htaccess files and re run install\n\n*Delete the information in the database and reconfigure it\n\nBut if you want an easy way to find your username as well as change your password, you can do the following:\nJust go to phpMyAdmin and find the ** wp_users ** table and click on it\nYou will now see the rows in your WordPress user table. Continue and click the edit button next to the username whose password you want to change.\nNow delete the value in the user_pass field and replace it with your new password. Below the function column, select MD5 from the drop-down menu and then click the Go button at the bottom of the form.\nJust as easily! You have successfully changed your WordPress password.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403597", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Dropdown list control in a post I don't know if I'm missing something, but I've really tried searching and I cannot find a drop-down list control that can be inserted into a WordPress page or post.\nI run a sports website and what I'd like is to be on the league table page and have a drop-down in the post/page that the user can select another year and it goes to the associated page/post.\nAny ideas how that can be achieved?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403598", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: \"pre_get_posts\" orderby custom date field in different format? I can set the query just fine for posts that have the date stored in the database in Y-m-d format, but I have a custom post type where dates are stored as n/j/Y (month/day/year), and would like to sort the posts by this incorrectly formatted date. Is there a workaround?\nHere is what I have tried, but it is just sorting by month, day, year, or just doesn't sort with some of the other variations of meta_type and orderby:\nfunction sort_admin_column($query) {\n    // Get the post type from the query\n    $post_type = $query->get('post_type');\n            \n    // Make sure we're not on front end and we're only looking at trainings\n    if( !is_admin() || $post_type != 'trainings' )\n        return;\n\n    // Get the orderby qs\n    $orderby = $query->get( 'orderby');\n\n    // Check if we have event_date in the query string\n    if ($orderby == 'event_date') {\n        \n        // Set the query\n        $query->set('meta_key', 'event_date');\n        $query->set('meta_type', 'DATE');\n        $query->set('orderby', 'meta_value');\n    }\n\n    // Return it\n    return $query;\n}\nadd_action('pre_get_posts', 'sort_admin_column');\n\nI have also tried several different things without success:\n$query->set('meta_type', 'DATE');\n$query->set('orderby', 'meta_value_num');\n\n$query->set('meta_type', 'DATETIME');\n$query->set('orderby', 'meta_value_num');\n\n$query->set('meta_type', 'DATE');\n$query->set('orderby', 'meta_value_date');\n\n$query->set('meta_type', 'DATETIME');\n$query->set('orderby', 'meta_value_datetime');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403599", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Migrate VB.net website to wordpress website I have a vb.net website that I developed years ago, right now I'm facing issues with the posts that it's not opening, the database is throwing errors on me, so my question is:\n\"Is there any way I can migrate my vb.net site to a WordPress site without losing any data?\"\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403601", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: protect files from downloading on other than my site I have a website Files apk I store these files on a separate server How do I make downloading these files only through my site? I mean, the person who clicks on the download link on my site starts the download And if he took the link and put it on another site, it doesn't work Or if you put it directly in the browser\nI hope someone can understand me\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403602", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add Tags to a Custom Post Type from a FrontEnd Form I have a code that allows users to submit content from the front end of the site, like this.\n     if(isset($_POST['submit'])){\n    $title=$_POST['title'];\n    $body=$_POST['body'];\n    $difficulty=$_POST['difficulty'];\n    \n    $post = array(\n    'post_title'    => $title,\n    'post_content'  => $body,\n    'post_type'     =>'server',\n    'post_status'   => 'publish',\n    'post_author' => $user_id,\n    'meta_input' => array( 'web' => $web )\n    );\n\n$post_id = wp_insert_post( $post, $wp_error='' );\n\n$web = array($web); \n$web = array_map( 'intval', $web );\n$web = array_unique( $web );\n$term_taxonomy_ids = wp_set_object_terms($post_id, $web, 'web' );\n\n\n\necho \"New successfully added\";\n    }        \n     }\n      \n<form action=\"\" method=\"post\" enctype=\"multipart/form-data\">    \n    <label for=\"game_name\">Game Name:</label>\n    <input type=\"text\" name=\"title\" />\n    <label for=\"website\">Game Website:</label>\n    <input type=\"text\" name=\"web\" id=\"web\"></input>\n    <label for=\"deck\">Description:</label>\n    <textarea name=\"body\" ></textarea>\n    </form>\n\nWhat I want to do is that the value entered in this input appears as a label in this taxonomy.\n<input type=\"text\" name=\"web\" id=\"web\"></input>\n\nthis taxonomy,\n        array('the_type' => 'web',\n        'single' => 'Website',\n        'plural' => 'Website',\n        'hierarchical' => false,\n        'rewrite' => array( 'slug' => 'web' ),\n        )\n\nHow can I make the value entered in the input appear as a label?\nI tried this way, but it cannot be edited from the admin panel because it is not at the tag level.\n 'meta_input' => array( 'web' => $web )\n\n\n   echo get_post_meta( get_the_ID(), 'web', true );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403603", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress action - Pass arguments into action in an AJAX call? My theme uses a custom action which expects two arguments. I am trying to call the function in an AJAX call but because I am not passing those arguments I end up getting a 500 error.\nThe action is formatted like this:\nfunction newsletterSignup($id, $source) {\n   // code here\n}\nadd_action('wp_ajax_nopriv_newsletter_signup', 'newsletterSignup');\nadd_action('wp_ajax_newsletter_signup', 'newsletterSignup');\n\nMy ajax call looks like this:\n$('form').on('submit', function(e) {\n    e.preventDefault();\n    var $form = $(this),\n        fd = new FormData($form[0]);\n\n    fd.append('action','newsletter_signup');\n    fd.append('source','homepage');\n\n    $.ajax({\n        type: 'POST',\n        url: user_object.ajaxurl,\n        data: fd,\n        processData: false,\n        contentType: false,\n        dataType: 'json',\n        success: function(data, textStatus, jqXHR) {\n            // registered\n        },\n        error: function (request, status, error) {\n            //error\n        }\n    });\n});\n\nAs mentioned, I am getting a 500 error on this request because the action does not include the $id and $source arguments. Is it possible to pass arguments into the action via JavaScript?\n\nA: You can't pass arguments to wp_ajax_ callbacks. You need to pass the data via the data property of the AJAX request. Then you get those values with $_POST and pass them to a function:\nfunction newsletterSignupAjax() {\n   $id     = $_POST['id'];\n   $source = $_POST['source'];\n\n    /* Make sure to validate and sanitize those values. */\n\n    newsletterSignup( $id, $source );\n}\nadd_action('wp_ajax_nopriv_newsletter_signup', 'newsletterSignupAjax');\nadd_action('wp_ajax_newsletter_signup', 'newsletterSignupAjax');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403609", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Cover block always has margin I'm working on a website where I want to have some group blocks where I want to add some images of patterns to just make the website a bit nicer than just plain colors. I'm using a cover block to hold the image and have content on top of it. I want to have the cover cover the whole group block it is in but there is margins on both sides on the group. In the example below it's the light blue parts:\n\nHere is the structure for this group:\n\nHow do I fix this?\n\nA: Use the cover block instead, the group block isn't necessary, and will have padding if it's given a background colour.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403611", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress certain directories not connected Within the main directory ./about the admin bar does not show up and the front page is uneditable(page is being modified but updates do not show) ive come to the conclusion that somehow this is loading a different file external to wordpress.\nis there a way to stop this from happening and to use wordpress as every other directory works perfectly fine other than those 2\nI am also currently using siteground\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403614", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Divi CSS Flex/Margin Error Coming here since I am out of ideas for debugging.\nhttps://www.biographic.com/the-tale-of-the-trojan-trout/\nStarting at 2193px this row shifts from where it originally sits to almost one column over.\nHere is the screenshot for the error:\n\nThe rows are all duplicates from each other and there is no custom css inside of this particular row.\nI was wondering if anyone had encountered this sort of issue.\nI've tried removing margin. using justify/align-items: center. I tried added flex and justify/align-items: center to the parent section but nothing seems to be able to make it readjust.\nAny help would be greatly appreciated:) Thanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403615", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Filter Author Link for Numerous Authors for each to go to unique page I was looking here:\nChange destination author link\nBut there doesn't seem to be a suggestion on how to work with multiple authors (not co-authors, but each author publishing their own stories.\nThis is the main portion of the Link class in a plugin I'm working on. This simply turns every author link to the same link. The code is fine for a single author blog.\nAm I not using author_link appropriately? Because adding dump(var) actually lists the author ID 3 times in a single post - with the first dump being \"null\".\npublic function hook() {\n    add_filter( 'author_link', array( $this, 'xenword_author_link' ), 10, 1 );\n}\n\n/**\n * @return mixed|string\n */\npublic function xenword_author_link($link, $author_id, $author_nicename) {\n\n    if ( ! class_exists( '\\XF' ) ) {\n        return false;\n    }\n\n    // $author_id = get_the_author_meta('ID');\n\n    if ($author_id == '') {\n        return false;\n    }\n\n    if ($link == '') {\n        return false;\n    }\n\n    $xf_author = XF::app()->finder('XF:User')->where('user_id', $author_id )->fetchOne();\n\n    $link = XF::app()->router('public')->buildLink( 'canonical:members/#recent-content', $xf_author );\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403618", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Smart Design for Blog + Woocommerce + LearnDash + Forum/Bodyboss I am migrating a page plus new to Wordpress and picked a nice project for a steep learning curve :). I am looking for input, on how to best design this (1 domain, subdomains, or any other structure) for a good performance:\n- static page (20 pages)\n- blog (100 posts and growing) - currently about 1k-2k hits a month\n- LearnDash integration\n- Woocommerce shop (for courses and physical products)\n- Future: Forum or some kind of a social platform\n\nI read in multiple places that it is not recommended to use more than 20 plugins, otherwise the whole page will be slow.\nIf I count the needed plugins I surpass them significantly:\nPage + Blog + Shop (16 Plugins)\n- Astra Pro\n- Elementor\n- Elementor Pro\n- Folders (for the management of media/sites/posts)\n- Preso Player\n- Rank Math SEO \n- Starter Templates \n- Ultimate Addons for Gutenberg (for posts, as we want to keep them simple)\n- Woocommerce 3x\n- WPForms Lite  \n- Firewall (some kind)\n- Mail system integration (with woocommerce)\n- Cookies plugin\n- WP Statistics\n\nLearnDash absolute minimum (11 Plugins)\n- the various plugins to make a great course; I talked to LearnDash and all their Add-ons are plugins and behave as such\n\nSocial 2+?\n- Buddyboss / Forum\n- Spam plugin\n\nI might realize I actually need 1 or two more (security?) as I develop everything. So right now I am easily at 30 plugins.\nMy initial though was to have 1 WP for the site/blog/woocommerce and 1 subdomain for LearnDash (little though went into the forum, as that I am still in the process of learning all the other things and trying to get those running) and somehow connect them.\nOf course I want on my static page / blog to show the products and courses overview (LD course grid plugin). So I wrote to LearnDash and they said that LearnDash and Woocommerce need to be on the same domain, otherwise I would need some Zapier intergartion and that would be quite complex.\nPlus if I integrated it on a separate domain, I would not be able to show the courses on the other domain, because the grid plugin is only available on the one where you have LD installed.\nI found an article stating that I could also work with webhooks for woocommerce being on the blog site (and LD by itself) or with Uncanny Automator Pro, but there is very little details available, plus also found a page mentionen that that does not work reliably....\nOur Wordpress is hosted at SiteGround with\n- nginx direct delivery on\n- nginx dynamic cache on\n- and memcached can be turned on\n- PHP memory_limit 768M\n- DB MySQL connections 500\n\nMy questions are:\nIs it likely (there is no sure thing I know) that I can run this from one site (any guesses of up to how many congruent users) at a reasonable loading speed?\nHow would you structure such a site?\nThank you very much for sharing your knowledge and experience!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403620", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Result of API Request to global variable? I have an API Request for weather and the account of this weather stuff has a limitation of requests per minute. In my theme I have the weather information twice on the same page. So if I would make a function of the request it would fire twice. I thought about a global variable, where I could save the request once and grap this variable where ever I want.\nIs this a good idea? I read something about, that global variables aren't a good choice!? Is there an other solution?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403622", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How do I add a custom sub menu menu under Woo-commerce marketing? I am developing a plugin and I want to add a menu under the woo-commerce marketing menu like the coupons and overview submenus. How am able to archieve that?\nI did this but it didn't work.\nadd_submenu_page(\n    'admin.php?page=wc-admin&path=/marketing',\n     __( 'Sub Menu' ),\n    'manage_woocommerce',\n    'sub-menu-slug',\n    'sub_menu_page_callback'\n);\n\n\nA: If available the $GLOBALS[ 'menu' ] array holds data for each top level menu item in the dashboard, and in the sub array for the Woocommerce \"Marketing\" menu item, key 2 has the value you're looking for: \"woocommerce-marketing\".\nSo with that your add_submenu_page should look like the below to make your sub menu item show up under the Woocommerce Marketing menu item:\nadd_submenu_page(\n    'woocommerce-marketing',\n     __( 'Sub Menu' ),\n    'manage_woocommerce',\n    'sub-menu-slug',\n    'sub_menu_page_callback'\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403623", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Service status plugin Sup guys. I need a service status Widget that shows when a service of another system is down or not. Like 1.1.1.1:8080 is on/offline. Do you know a plugin for that, my google search wasn't that successful.\n\nA: Found this one on the official wp plugin list\nhttps://de.wordpress.org/plugins/atr-server-status/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403625", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display posts ONLY from the current logged in user and current week/year/month Elementor posts I want to show the posts my users have added in three different sections. That would be \"Your Posts from This week\" and so on. I am currently using:\nadd_action( 'elementor/query/currentuser', function( $query ) {\n    if ( is_user_logged_in() ){\n        $query->set( 'author', get_current_user_id() );\n    }\n} );\n\nto display posts by current logged in users. But any idea what I can add to this query to also display posts from current week/month/year?\nPS: Sorry for my week English, it is not my first language :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403627", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I stop redirecting from a search to a taxonomy archive page I have a search form that searches through custom taxonomies, but instead of printing the results on the search page it redirects to the taxonomy archive. I leave the url before and after the redirect to explain myself better. How can I disable the redirect?\nSEARCH\n/?area=tuscany&guests_2=0%3B50&post_type=property\nREDIRECT AFTER SEARCH\n/area/tuscany/?guests_2=0%3B50&post_type=property\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403630", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: accessing the Admin page My problem is that I did have Xampp and Word Press downloaded and was working on them just fine. Unfortunately over the course of the pandemic I didn't access them for quite a while. I had to upgrade the OS on my MAC and then ended up reinstalling Xampp and WordPress. I can get to the website (thankfully I did bookmark it) but I can't get to the admin page to revise anything. I would appreciate any help that you may be able to provide.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403635", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Block editor not recognizing markdown I'm under the impression that I should be able to paste Markdown text into the block editor and that it should pick that up and convert it as per: https://github.com/WordPress/gutenberg/tree/trunk/packages/blocks/src/api/raw-handling\nBut that does not work.\nIn my example I have some text that's like this:\n> bq1\n\n> bq2\n\nI would expect that copy pasting that into the editor would result in two quote blocks being created. At the moment the markdown syntax is not interpreted at all. This is the same for headings etc.\nIs this standard behaviour? Is there some other way to be able to paste formatted text into the editor?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403639", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Images not appearing after applying Smush Upon enabling the Smush plugin to compress images, my sites logo and a few other images are not loading. I have tried resizing the images or disabling Bulk Smushing and Lazy Load to no avail. Here is my site where you can see the error on the first page. I do not develop in WordPress, any help appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403644", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: php script in elementor How would one add a php script like the one below in elementor?  This page tells you to create a shortcode reference add it to a functions.php file and call it using a shortcode block.  But where is this functions.php file?\n<?php\n\n//if the submit button is clicked, follow logic to insert record\nif (isset($_POST['submit'])) {\n\n    $insert_value = 1;\n\n    //make a database connection\n    $conn = mysqli_connect('localhost', 'myuser', 'mypassword', 'motordata');    \n\n    //prepared statement to insert the record\n    $stmt_insert_record = $conn->prepare(\"INSERT INTO MotorOn (command) VALUES (?)\");\n    $stmt_insert_record->bind_param(\"i\", $insert_value);\n    $stmt_insert_record->execute();\n    $stmt_insert_record->close();\n}\n?>\n\n<!-- Form that will submit to the document's address ie. the same page-->\n<form method=\"post\">\n    <input type=\"submit\" value=\"Shutdown\" style=\"background-color: red;\">\n</form>\n\n\nA: Your functions.php file is located at Appearance > Theme Editor.\nHowever, my suggestion is to create a custom plugin or find a ready-made plugin to handle your form submission data. Here's a link to more information about this: https://www.sitepoint.com/build-your-own-wordpress-contact-form-plugin-in-5-minutes/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403645", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Format array of objects to json for wp-json So I can't seem to figure this out, so I'm reaching out to see if someone might be able to help me.\nI've tried to include as many details as possible if it makes sense, so please let me know if I'm missing something before downvoting.\nI have the following method:\nfunction instagram_posts(): bool|string\n{\n    if (!function_exists('is_plugin_active')) {\n        include_once(ABSPATH . 'wp-admin/includes/plugin.php');\n    }\n    if (!is_plugin_active('fh-instagram/autoload.php')) {\n        return false;\n    }\n    if (empty($items = Instagram::get_items_for_api(50))) {\n        return false;\n    }\n    var_dump($items);\n\n    var_dump(json_encode($items));\n\n    return json_encode($items);\n}\n\nvar_dump($items); gives me the following output:\narray(50) {\n  [0]=>\n  object(Plugin\\Instagram\\Item)#976 (7) {\n    [\"id\":\"Plugin\\Instagram\\Item\":private]=>\n  }\n  [1]=>\n  object(Plugin\\Instagram\\Item)#1030 (7) {\n    [\"id\":\"Plugin\\Instagram\\Item\":private]=>\n    string(17) \"17842233125750202\"\n  }\n}\n\nWhen I run var_dump(json_encode($items)); I get the following output:\nstring(151) \"[{},{}]\"\n\nHow can I convert my array of objects so that it can transform it to json and then use it within Postman? This is what it currently looks like in Postman:\narray(50) {\n  [0]=>\n  object(Plugin\\Instagram\\Item)#973 (7) {\n    [\"id\":\"Plugin\\Instagram\\Item\":private]=>\n    string(17) \"17992874035441353\"\n  }\n  [1]=>\n  object(Plugin\\Instagram\\Item)#1027 (7) {\n    [\"id\":\"Plugin\\Instagram\\Item\":private]=>\n    string(17) \"17842233125750202\"\n  }\n}\n\nIt should be outputted such as:\n[\n  {\"id\": etc..}\n]\n\nAll help will be appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403646", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how does 'init' /'parse_request' hook work for wordpress? I wanna try to collect statistics for my wordpress website with my own plugin. the information I need is stored in $_SERVER variable. by surfing the Internet, I've two useful hooks to insert my code:\n\n*\n\n*parse_request 2. init\n\nEverything works fine with localhost. no data is missed, no matter it's by mobile phone or desktop, from page links or offline documents, inside apps or browser.\nwhile it's running online, something is different. After several days collecting, i've found the collected info is not complete; sometimes i visited the website directly with mobile phone through browser or inside an app, the info will not be recorded.\nbut I checked the access.log, it's normal. And when running on localhost, data is saved soundly.\nI cannot figure out why when put online, it will omit some data\nfunction get_statistics(){\nglobal $wpdb;\n$table_name = 'table_name';\n$split_str = 'separation_str';\n$logdata=$_SERVER['REQUEST_TIME'].$split_str.$_SERVER['HTTP_REFERER'].$split_str.$_SERVER['HTTP_USER_AGENT'].$split_str.$_SERVER['REMOTE_ADDR'].$split_str.$_SERVER['REQUEST_URI'].$split_str.$_SERVER['HTTP_COOKIE'];\n$logdata =substr($logdata,0,1500);\n\n$wpdb->query( $wpdb->prepare( 'insert into '.$table_name.'(logdata) values(%s)', $logdata) );}\nadd_action('init','get_statistics',1);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403647", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Boombox theme, lightbox on zombify post photos I use the theme Boombox, I'm searching for a solution to use lightboxes in the zombify posts. I have searched all the internet but I can't find anything. Installing a plugin doesn't work for this. Does anyone have an idea?\nThank you\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403654", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change searching from world level to first letter Iwant to change the search filter from word level to first letter in terms when creating custom post.\nHow can change it ?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403655", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Redirect page without changing the url I have a page running a custom shortcode. When an element on the page is clicked I am pushing a new url into the browser (using history.pushstate) and displaying the content in the same window.\nIf this url is copied and pasted at a later date into the browser, I want to be able identify this and display the content. As the requested element is not actually a real page/post, I am having difficulty. I can use template_redirect hook to identify if it is the link I am interested in, and I can forward the page - but I don't want to forward, I want to keep the url but load a specific page.\nIs there a way of doing this?\n\nA: This can be achieved using a Virtual Post. See this link on how to do it. https://ashiqur.com/how-to-add-a-virtual-page-in-wordpress/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403657", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Should action callbacks start with a verb? class Singleton {\n    public function __construct() {\n        // Case #1\n        add_action( 'woocommerce_before_shop_loop_item', [ $this, 'open_product_wrapper' ], 10 );\n        add_action( 'woocommerce_shop_loop_item_title', [ $this, 'render_product_title' ], 10 );\n        \n        // Case #2\n        add_action( 'woocommerce_before_shop_loop_item', [ $this, 'product_wrapper_open' ], 10 );\n        add_action( 'woocommerce_shop_loop_item_title', [ $this, 'product_title' ], 10 );\n    }\n}\n\nAre there any conventions or should I strive for consistency?\nNOTE: In Laravel projects I always use verbs because each method is doing something.\n\nA: \nAre there any conventions or should I strive for consistency?\n\nNo, as long as your actions are readable, unique, and it's clear what they do, there is no rule to follow.\nIdeally the names you choose are consistent within the code you write. E.g. WooCommerce has chosen to use the woocommerce_ prefix, or when ACF uses acf\\. If you think verbs works for you then use verbs, just do it consistently and clearly.\nThe one thing I would say, is never have a fully dynamic name, e.g. passing a variable from a separate source assuming they're all unique, e.g. add_action( $form_name, '....\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403660", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Custom html/php/jquery map code in Wordpress/elementor? I have some code I used for a searchable map with hotspots (basically a directory search, like airbnb searching for a location). So I\u2019ve used this code for Joomla in order to have a search bar that populates a list as well as hotspots on a map. It searches against a database in order to get the store info and the lat/long for the map hotspots.\nHere\u2019s my issue: The whole thing is basically existing within a php controller file for the database calls and serving the data back, and then an html file that consists of the html, css and jquery (including an axios call to get data from php file). What is the best/easiest way to serve this into a Wordpress site?\nI\u2019m using a simple WP install and elementor for the page in question, is there a relatively simple way (even with using other plugins) that I can get this code into the site and served into an elementor page template?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403662", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress get id from json data with json_decode() I add on my wordpress a function to save a json file , when a post is saved on admin. Basically i get the title ( that will be a json string ) and convert it to JSON.\nFrom that JSON i need to extract the id , to use like a name of the file created. But when i try to get the id , i have an empty value.\n    add_action('save_post', function($ID, $post) {\n         // The $ID of post is different from ID that i have in post_title string\n         $encoded_post = wp_json_encode( $post->post_title );\n         $post_decode  = json_decode( $encoded_post, true );\n\n         // Get the id from decoded data, converted from string to json\n         $data = json_decode( $post->post_title );\n         // ID of json given\n         $ID = $data->id;\n\n\n        // Dir to save the file\n         $dir = plugin_dir_path( __DIR__ );\n\n         // Post name and ext\n         $file_path =  $ID .'.json';\n        //\"$post_name'.json'\";\n\n        file_put_contents($dir.$file_path, $post_decode);\n    }, 10, 2);\n\n\nA: json_encode takes an array/object and turns it into a JSON string.\njson_decode takes a JSON string and turns it into a PHP array/object/etc\nWith this in mind, we can see some critical mistakes are made in the code, caused by muddling up the two.\n\n*\n\n*You're taking a string of JSON and JSON encoding it, aka double JSON encoding it, which doesn't make sense. Think of it like doing this: json_encode( json_encode( ['ID' => 2] ) )\n\n*You're then immediatley decoding it, so $post_decode and $post->title are the same, it's like turning on the light switch then turning it off everytime you go past, it's a non-operation, nothing is achieved\n\n*Then, for some reason json_encode is called, but it's called on a nonexistant value. Remember, $post_decode is not an array/object, it's a JSON string that hasn't been decoded, what you're doing is the same as $foo = 'bar'; echo $foo->ID;. Expect this to generate huge amounts of PHP notices and warnings in your PHP error log.\n\nThis is all very confusing and unnecessary.\nInstead take your post title and decode it from JSON into an object:\n$data = json_decode( $post->post_title );\n\nThen use it:\n$ID = $data->id;\n\n\nA: add_action('save_post', function($ID, $post) {\n    // The $ID of post is different from ID that i have in post_title string\n\n   // In field post_title i have the json string, that i will convert to json\n    $parse_post = json_encode($post->post_title); \n\n    // Here is the error: Your are decoding $parse_post while parsed post has encoded $post->post_title.\n    $encoded_post = wp_json_encode( $post );\n    $post_decode  = json_decode( $encoded_post );\n    // Post Decode return this \n\n    // {\"id\":\"9566\",\"date\":\"2021-07-28T17:12:31\",\"title\":\"test post\" }\n\n    // Here is the issue, i need to get the id from json in $post_decode\n    $post_name = isset( $post_decode->ID ) ? $post_decode->ID : $post_decode->id;\n\n    // Dir to save the file\n    $dir = plugin_dir_path( __DIR__ );\n\n    // Here i need to add the id inside $parse_post json string\n    $file_path =  \"$post_name'.json'\";\n    \n    // Not show any result\n     print_r($file_path);\n\n    file_put_contents($dir.$file_path, $post_decode);\n}, 10, 2);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403666", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to register dynamic settings in WordPress Customizer? I have been experimenting with the Customizer JS API to create Panels, Sections, Settings and Controls in the Customizer. Till now, I have been using the PHP API but decided to try the JS API for the first time. I figured out how to create Panels, Sections and Controls. I got stuck at Settings.\nDoing some research, I found out that the setting has to be either defined in PHP using $wp_customize->add_setting or by using the customize_dynamic_setting_args filter. I need to know how to use the customize_dynamic_setting_args hook to add settings to the DB.\nI know the filter hook accepts two parameters,\n$setting_args -  The arguments of the setting\n$setting_id - The ID of the setting\nBut how to fetch these values?\nAny help would be greatly appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403668", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add ajax to plugin in admin area I create custom plugin that to add new admin page ( payments settings) this page show all payments methodes with toggel to active and show setting button to this method or deactive it like this https://ibb.co/DQMVSYy\nI have code to js file\n(function ($) {\n    $(document).on('change', '.wsd-plugin-controller-toggle', function () { //checkbox\n        let initiator = $(this),\n            data = {\n                'action_type': initiator.data('state'),\n                'plugin_slug': initiator.data('plugin-slug')\n            };\n        $.ajax({\n            url: plugins_controller.ajax_url,\n            type: \"POST\",\n            data: {\n                data,\n                action: 'myajaxfunction_check',\n                nonce: plugins_controller.ajax_nonce\n            },\n            beforeSend: function (xhr) {\n                xhr.setRequestHeader('X-WP-Nonce', plugins_controller.ajax_nonce);\n                initiator.closest('.wsd-toggler').find('.wsd-loading').toggleClass('visible');\n            },\n            success: function (response) {\n                console.log(response);\n                initiator.data('state', response.state);\n                if (initiator.data('reload')) {\n                    location.reload();\n                }\n                $(document).trigger('wsd-plugin-state-updated', [initiator, response]);\n                initiator.closest('.wsd-toggler').find('.wsd-loading').toggleClass('visible');\n            },\n            error: function (response) {\n                console.log('error', response);\n                initiator.prop('checked', false);\n                $(document).trigger('wsd-plugin-state-update-failed', [initiator, response]);\n                initiator.closest('.wsd-toggler').find('.wsd-loading').toggleClass('visible');\n            }\n        });\n    });\n})(jQuery);\n\nAnd in my html I have this\n    <td class=\"title\">\n                        My Fatoorah\n                    </td>\n                    <td class=\"status\">\n                        <div class=\"wsd-toggler\">\n                            <input id=\"toggler-csCeE5\" type=\"checkbox\" class=\"wsd-toggler-input  wsd-plugin-controller-toggle\" data-plugin-slug=\"myfatoorah-woocommerce/myfatoorah-woocommerce.php\" data-state=\"activate\">\n                            <label for=\"toggler-csCeE5\" class=\"check-trail  wsd-toggler-shape\">\n                                <span class=\"check-handler wsd-toggler-handler\"></span>\n                            </label>\n                            <img src=\"\\wordpress\\wp-content\\plugins\\plugins-controller\\spinner.svg\" class=\"wsd-loading\" alt=\"loading\">\n                        </div>\n                    </td>\n                    <td class=\"moderate\">\n                        <select class=\"wsd-payment-popup-select wsd-hidden\" onchange=\"location = this.value;\">\n                            <option selected=\"\" disabled=\"\" hidden=\"\">\u0625\u062f\u0627\u0631\u0629</option>\n                            <option value=\"/wordpress/wp-admin/admin.php?page=wc-settings&amp;tab=checkout&amp;section=myfatoorah_direct\">\n                                \u0627\u0644\u062f\u0641\u0639 \u0627\u0644\u0645\u0628\u0627\u0634\u0631\n                            </option>\n                            <option value=\"/wordpress/wp-admin/admin.php?page=wc-settings&amp;tab=checkout&amp;section=myfatoorah_v2\">\n                                \u0643\u0627\u0631\u062a\n                            </option>\n                        </select>\n                    </td>\n                </tr>\n\nAll things as css code is work But I don't know what I should ADD in my action function myajaxfunction_check at my plugin  that to update plugin state and active/ deactive should I use api to do that ? I add this code but not working well\nadd_action('admin_enqueue_scripts', 'load_payment_style');\n   function load_payment_style()\n    {\n     wp_enqueue_style('plugins_controller_style', plugins_url('style.css', __FILE__));\n     wp_enqueue_script('plugins_controller', plugins_url('plugins_controller.js', __FILE__));\n       wp_localize_script(\n       'plugins_controller',\n        'plugins_controller',\n             array(\n         'ajax_url' => admin_url('admin-ajax.php'),\n           'ajax_nonce' => wp_create_nonce('plugins_controller')\n          )\n       );\n  }\n\n     function myajaxfunction()\n    {\n         add_action('wp_ajax_nopriv_ccbs_ajax_function', 'myajaxfunction_check');\n           add_action('wp_ajax_ccbs_ajax_function', 'myajaxfunction_check');\n       }\n        add_action('admin_init', 'myajaxfunction');\n\n        function myajaxfunction_check()\n         {     global $state;\n  \n \nif( !empty($_POST['nonce']) && wp_verify_nonce( $_POST['nonce'], 'plugins_controller' )\n     ) {   \n      $response['code'] = \" sucsess \" . $_POST['nonce'] .$state.\"active\" ;\n      \n    } else {\n         $response['response'] = \"You didn't send the param\";\n            array(\n                    'active'=>$state,\n     );\n     }\n\n     header( \"Content-Type: application/json\" );\n     echo json_encode($response);\n  \n     // Don't forget to always exit in the ajax function.\n     exit();\n \n  }\n\nThank you .\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403670", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: theme directory fallback image outputs url and not the image I am adding a custom post thumbnail column to the user admin table in WordPress.\nI want to retrieve a fallback image from my theme image directory if no post thumbnail has been created. I don't want to wrap the php output in html img tags.\nSo I thought I could do echo get_template_directory_uri() .'/assets/images/geo.jpg'; however that is only displaying the url.\nWhat am I missing?\nCode:\n...\n\nfunction cpt_columns_content($column_id, $post_id) {\n    if ($column_id == 'last_modified') {\n        echo get_post_field('post_modified', $post_id);\n    } \n    else if ('post_thumbs') {\n        if (has_post_thumbnail()) {\n            // get the post featured thumbnail\n            the_post_thumbnail('xsm_thumbnail');\n        } \n        else {\n            // or else get from theme image directory\n            echo get_template_directory_uri() .'/assets/images/geo.jpg';\n        }\n    }\n}\nadd_action('manage_program_posts_custom_column', 'cpt_columns_content', 10, 2);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403675", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I want to add another search box on posts page in dashboard There is already a search box in wordpress dashboard for posts, products, pages etc. in their listing page.\nMy client use wordpress admin with their phone so he requested another search box on top of those pages with the same functionality.\nI can edit codes if I need to, but I don't know where to start.\nHave anybody needed that kind of behavior before? It seems easy but I don't know how to edit listing pages in wordpress dashboard.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403678", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How does the WP repository determine that two plugins are the same when counting active installs? I currently have a free WP plugin published on the official WP repo. I'm planning to release it on other platforms, but I want downloads from there (where you install the plugin by uploading a zip from your WP dashboard) to count towards the active installs in the official WP repo.\nI'm not sure how to tell the repo that those plugins are the same. I assume having the same name won't count?\nThanks\n\nA: Downloads and active installs are not the same thing:\n\n*\n\n*downloading from .org does not increase the active download stats, those are separate\n\n*it's the update check that's used to calculate this\n\nSo no steps are necessary on your part other than keeping the plugin name/slug the same. Otherwise there are no options available to you for influencing the statistics outside of this. If you ask them to incorporate stats from additional sources that you are providing they will say no.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403679", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: custom wordpress theme and yoast seo injecting text in body I have created a custom PHP Wordpress theme using HTML5Blank Template and Advanced Custom Fields, however, whenever the Yoast SEO plugin is activated it injects \"view article\" twice as text in the top of the page. The behaviour seems odd but it doesn't inject it into the HTML head but the body. Has anyone experienced this issue and have any fixes for it? I am forced to disable the plugin until I can patch this issue as it effects all my pages.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403681", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using file_get_contents within admin but keep logged in Quick question as I'm not having much luck finding an answer on Google.\nI'm running a file_get_contents in a plugin I'm building to get the HTML of another page within the admin. The HTML is showing but the problem is, it's loading the /wp-login.php page HTML and not the specified URL.\n$data = file_get_contents('wp-admin/options-general.php?page=another_page');\n$html_sourcecode_get = htmlentities($data);\necho $html_sourcecode_get;\n\nDoes anyone know how to keep the HTML grab as if I was still logged in? Do I need to use cURL with credentials?\nNote: I have tried the wp file system alternative and it returns a critical error.\nThanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403683", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Equation input with preview in classic editor I use WordPress as a headless CMS, and my frontend is made with React. There's no theme or live preview.\nI'm looking for a plugin to add/edit and preview equations (LaTeX) in the classic editor.\nThis is an example of what I want, but with CKEditor:\nhttps://jsfiddle.net/isaul32/3wjrkLdv/\n\nMost of the plugins I find are outdated, and some of them like KaTeX (which I'm planning to use its js library for frontend) only support live preview in gutenberg blocks.\nThe reason I'm looking for classic editor (TinyMCE) support is because I have multiple text editing fields in a post - made with ACF - and ACF only has WYSIWYG editor, which is the same as TinyMCE. As far as I know, they are not going to add block editor as a field like the classic editor.\nSo:\n\n*\n\n*Is there an updated, maintained plugin for this?\n\n*If not, is it possible to load the KaTeX js library inside the admin area and make it render the shortcodes? For example [katex]\\nabla[/katex] inside the \"text\" tab, renders as \u2207 in the \"Visual\" tab?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403685", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sort Posts by Sticky then by Latest date using the Latest Posts Block Using the Latest Posts Block,\nIs it possible to get the Sticky posts first and then the latest posts?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403690", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: New posts link to old posts (random) I\u2019ve recently noticed a strange problem with my posts. When creating a new post, and when the post autosaves before publishing, it will automatically get a wrong permalink format.\nSo instead of:\nMyweb.com/category/my-new-post\nFor some reason, and randomly, it will get a permalink like this:\nMyweb.com/category/355654 (which is the id of the post)\nUpon saving and publishing the post, the wrong permalink format remains.\nBut here is the strange part. If you open the link to read the article, it will show you an older post.\nI have checked to see if there is a connection somehow between the new and old post, but couldnt find anything.\nCan someone please explain what happens?\n\nA: 1. Flush your permalinks by going to \"Settings\" > \"Permalinks\" and click Save. (I realized you already did this, but others may not have)\n\n2. If running Apache, check that .htaccess matches this:\n\n# BEGIN WordPress\nRewriteEngine On\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /index.php [L]\n# END WordPress\n\n\n3. If Apache check the mod_security module.  Your can disable the mod_security module from the cPanel interface. If you are unable to locate the module or don't have access, request your web host to disable mod_security.  Clear cache and then try your permalinks again and see if that cleared the issue.  Once done, re-enable mod_security.\n\n4. Disable all plugins and switch to a standard WordPress theme (such as Twenty Twenty-Two).  Clear cache and check your permalinks.  If this resolved the issue, re-enable your theme and plugins 1-by-1 to check for possible causes.\n\n5. While it may be odd, the following does work occasionally:\nWithin your dashboard go to: \"Settings\" > \"Permalinks\". Then select \u201cCustom Structure\u201d.  Inside the input field, enter:\n/%category%/%postname%/\nClick \"Save\", clear your cache and check your permalinks.\n\n6. If Apache, you may not have mod_rewrite enabled.  If you have console access, you can enable it by entering:\nsudo a2enmod rewrite\nWhen done, don't forget to restart Apache. ;)\nservice apache2 restart\n\n7. Check your override rules.  Depending on your config, it will be located in one of these files: apache2.conf, http.conf, or 000-default.\nUnder Directory /var/www/ change Override None to Override All\n\nGood Luck!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403692", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Creating a query that get all posts but places meta items first I have a query that gets jobs based on a category. Some of these jobs are \"featured\" issue is the old system used a \"featured\" meta key, the new system uses \"job_featured\" meta key (both have 1 for true). I need place the the posts with a true meta value ahead of all posts all order by date so this:\npost\npost\nfeatured\npost\njob_featured\n\nwould output as:\nfeatured\njob_featured\npost\npost\npost\n\nI have this to build my query:\n      $jobs = array( \n        'post_type' => 'job', \n        'tax_query' => array( array (\n          'taxonomy' => 'jcategory',\n          'field' => 'slug',\n          'terms' => $category\n        )),\n        'order' => 'DSC',\n        'posts_per_page' => get_option('posts_per_page'),\n        'paged' => $paged,\n      );\n...\n      $jobs['meta_query'] = array(\n        'relation' => 'OR',\n        array(\n          'key' => 'job_featured',\n          'value' => 1\n        ),\n        array(\n          'key' => 'featured',\n          'value' => 1\n        ),\n        array(\n          'key' => 'job_featured',\n          'value' => 0,\n        ),\n        array(\n          'key' => 'featured',\n          'value' => 0,\n        )\n      );\n\n      $jobs['orderby'] = array(\n        'date' => 'DESC',\n        'job_featured' => 'DESC',\n        'featured' => 'DESC'\n      );\n$jobs = (object)$jobs;\n$jobSearch = new WP_Query($jobs);\n\nthe 'value' => 0 is to get all non-featured jobs.\nThis sorts by date no issue but the feature and job_featured posts are mixed into the results.\nAm I missing anything to get this to sort as expected (sort by date then by featured/job_featured)?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403693", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I am working with gutenberg blocks, specially a slider block. I wish to show the excerpt content from a custom api to the backend as well as frontend In my application, I am able to show the excerpt content to frontend using get_the_excerpt(). I have tried to make it visible to my backend using {.excerpt.rendered} but it did not work. Can someone make me understand, why I am unable to make it happen.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403694", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Media Library Folders + Custom Linux Server Hosting I'm coming to you because I have a big problem with my hosting and the functioning of the FileBird - WordPress Media Library Folders plugin. I created my hosting on a NAS, on a virtual machine with Apache.\nThis plugin doesn't work and after several tests, it's obviously due to my custom hosting. On other standard sites with public hosting, I have no problem with this plugin.\nI think FileBird - WordPress Media Library Folders (folder creation, storage, sorting) can't access the REST API (according to their guide). I need this plugin necessarily, I can't do without it, because I deal with more than 16,000 photos on this site, and I want it to be sorted by folder and by theme, etc.\nI tried similar plugins, they have the same problem, they load endlessly and do not work.\nCan you help me? Do you have an idea?\nThanks a lot,\nJulien\n\nA: I figure it out ! Thanks to the wonderful FileBird's team !\nThere is the answer :\nAdd to your function.php file this line of code :\nif (defined('NJFB_REST_URL')) {\n    add_filter('filebird_json_url', function(){\n        return site_url(\"index.php/wp-json/\" . NJFB_REST_URL);\n    });\n\nThank me later ! ;)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403698", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: User can't search himself on rest api I have a custom role and here is the capabilities;\nArray\n(\n    [read] => 1\n    [edit_posts] => 1\n    [delete_posts] => 1\n    [upload_files] => 1\n    [list_users] => 1\n)\n\nThe user is can get other users from REST API with /wp/v2/users/{id} but if i put user's own id it returns me error like this;\n{\n  \"code\":\"rest_user_cannot_view\",\n  \"message\":\"Sorry, you are not allowed to list users.\",\n  \"data\":{\n     \"status\": 401\n  }\n}\n\nThe weird part is, like i said, if i put other users id to endpoint it works as espected.\nHow can i fix it?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403703", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: In Multisite Setups, how to update mass sections of sub-sites I am looking for some guidance or direction when it comes to Multisite setups. Looking for any recommendation on a plugin, or idea of setup, where the master site could be setup to make edits to multiple (25+) subsites. These sections would be common areas with hours, contact information, or even service descriptions.\nThe one caveat would be that some of the subsites might need micromanagement, meaning they use the layout and most of the information, but hours could be different for this one site verse all the others. As such, the information would feed in everything but the Hours themselves, instead that would be controlled in the individual sub-site verse coming from the master-site.\nAny help or guidance towards any resources to accomplish this task would be appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403706", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenberg: How to check if a block is used in a paginated post? There is the render_callback of the register_block_type function. In this callback, I can use add_filter('render_block', __NAMESPACE__ . '\\\\filter_block', 10, 2);\nfilter_block iterates through all blocks in my post ... until the post is paginated, and the block is on page 1, but I want to check blocks on page 3 of the post.\nI found the function has_block but how to I combine this with the render_callback? The callback is only executed when the block is rendered. Is there a function for this I am missing? Like a callback used_in_post_callback or something like this?\n\nA: The solution is simple:\nhas_block( 'simpetoc/toc, $YOUR_POSTS_CONTENT_OR_POST_ID )\n\nhttps://developer.wordpress.org/reference/functions/has_block/\n\nhas_block( string $block_name, int|string|WP_Post|null $post = null )\n\nThere is no need to render the blocks to build a table of contents, nor should you do it that way.\nNote that your current approach breaks user defined HTML anchors and doesn't account for headings in nested blocks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403709", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Permission callback to check if user has application password So I have the following registered rest route:\nadd_action('rest_api_init', function () {\n    register_rest_route( 'instagram', '/posts/', [\n        'methods'  => 'GET',\n        'callback' => 'instagram_posts',\n        'permission_callback' => '__return_false'\n    ]);\n});\n\nWhich now gets this error when I run it in Postman:\n{\n    \"code\": \"rest_forbidden\",\n    \"message\": \"Sorry, you are not allowed to do that.\",\n    \"data\": {\n        \"status\": 401\n    }\n}\n\nIf I change 'permission_callback' => '__return_false' to 'permission_callback' => '__return_true' I get my array of objects via Postman.\n\nI have a user called Source which has a generated Application password as shown here:\n\nHow do I properly format my rest route to check for the user application authentication?\nI want to be able to provide the Application authenticated inside Postman so that I can properly get data back.\nAll help is appreciated!\n\nA: You're conflating roles/capabilities and application passwords. This problem has nothing to do with application passwords.\nApplication passwords are a way of authenticating who, that you are who you say you are. permission_callback isn't interested in that though, just because you are indeed verified as you, does not mean you have permission to do what you're trying to do.\nFor example, you could use an application password on a user with the subscriber role to create a post, but subscribers cannot create posts. It's like having a pass backstage, but it's not a VIP pass.\nSo __return_false is telling it that you are not allowed to use that endpoint. Not because you are no longer logged in, or because you used an application password, but because you do not have the ability in this API. By using __return_false, nobody has permission to use this regardless of their role or how they accessed the REST API endpoint.\nTo make this work, you need to instead pass a function that returns true when Source is the user, or when a user of that role/capability uses the API. Much like only users who can edit posts are able to edit posts with the API. __return_false says that nobody is able to use this.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403710", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add javascript file to a block pattern I'm just thinking to make a sticky header for the twenty twenty-two theme and I was imagining to make it as a block pattern. Is this in your opinion a good approach?\nIf this is the right way to do it, how can I enqueue the javascript file to the block pattern?\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403718", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I create an archive page as a  including metadata? I'm really struggling getting this seemingly simple thing to work. I have a list of \"vendors\" as a CPT. They have metadata like \"contact name\" and \"last invoice date\". I'd like to have the \"archive\" page for these vendors show a simple table:\n\n\n\n\nName\nContact name\nLast Invoice\n\n\n\n\nJoe's Plumbing\nJoe Anderson\nMarch 31, 2021\n\n\n\n\nI can not seem to figure out how to get metadata into this. I'm also struggling with getting Wordpress to stop inserting <h2>s, but at least I can style around that!\n<!-- wp:template-part {\"slug\":\"header\", \"tagName\":\"header\"} /-->\n\n<section class=\"wp-block-query inner-width content\">\n    <table>\n    <!-- wp:query {\"query\":{\"perPage\":1000,\"pages\":0,\"offset\":0,\"postType\":\"vendor\",\"categoryIds\":[],\"tagIds\":[],\"order\":\"asc\",\"orderBy\":\"title\",\"author\":\"\",\"search\":\"\",\"exclude\":[],\"sticky\":\"\",\"inherit\":true},\"tagName\":\"main\",\"align\":\"wide\",\"layout\":{\"inherit\":false}} -->\n        \n        <!-- wp:post-template {\"align\":\"wide\"} -->\n        <tr>\n            <td><!-- wp:post-title {\"isLink\":true} /--></td>\n            <td>Contact</td>\n            <td>Last Invoice Date</td>\n        </tr>\n        <!-- /wp:post-template -->\n    <!-- /wp:query -->\n    </table>\n</section>\n\n<!-- wp:template-part {\"slug\":\"footer\", \"tagName\":\"footer\"} /-\u2192\n\nHow can I make <td>Contact</td> the actual contact's name (meta data name contact)? I've seen other solutions using PHP, but when I do that on the HTML page it doesn't work. Maybe I followed the wrong guide?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403721", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: I can not display meta value in extras.php and template-tags.php I have page template that stores reservation input fields, I would like add link to that specific page using meta box but my meta box doesnt work in extras.php and meta-tags.php, I would like to know where do I do a mistake or what should I do to retrieve meta value anywhere in all pages?\nmy function is:\nfunction test_button() {\nglobal $post; $bsub; $button_link;\n$button_link = get_post_meta(get_the_ID(), '_but_subtitle', true);\necho '<a href=\"'.esc_url( get_page_link( $button_link ) ).'\">'.esc_html__( 'Reservation', 'text-domain' ).'</a>';\n\nand I'm calling function\nif ( function_exists( 'test_button' ) ) {\n                global $post; $bsub; $button_link\n                test_button();\n                }\n\nmy function displays only current page or post (anwhere where it is) url\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403727", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Import (CLI) returns Error Establishing a database connection I am trying to use the wp import cli in the terminal to import a large wxr file (200MB) from the old test server to new test server. I can login to wp-admin using the admin account and mysql cli mysql -u user -p so I know that my db information is correct. But when I use wp import command, returns db error Error Establishing a database connection. Is there any part that I am missing? I am checking other SO questions and other website articles but no luck so far.\nNote:\n\n*\n\n*Old server runs http and New Server runs https\n\n*Old and New Server has user and password\n\nRegarding note 2, I don't think it matters since I was able to import from test server to my local server without problems before.\nThe complete error message when I turn on debug is :\nPHP Warning:  mysqli_real_connect(): (HY000/2002): No such file or directory in /project-path/wp-includes/wp-db.php on line 1653\nWarning: mysqli_real_connect(): (HY000/2002): No such file or directory in /project-path/wp-includes/wp-db.php on line 1653\nError: Error establishing a database connection.\n\nWordpress 5.6\nUpdate: Found the solution with this SO.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403728", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add Relations of a CCT from JetEngine via Wordpress Rest API I am using JetEngine's Custom Content Types to share information from site A to site B. i have some simple meta fields (name, email) and set up Relations for another CCT i am using within Site A. When requesting the information of Site A to Site B, i can get all the information except the Relations. I need help figuring out how to add that to the API request. I had a similar issue before and used the following code snippet to add the meta fields that were not showing, but that was for a Custom Post Type and not a CCT and I am unsure on how to display the relations of a CCT via API.\nregister_rest_field( 'parish', 'meta', array(\n'get_callback' => function ( $data ) {\n    return get_post_meta( $data['id'], '', '' );\n}, ));\n\nAs said, this helped for all the meta fields but im assuming its something similar to show the relations, i just cant find a single thing online for this. Any help would be greatly appreciated! This is the last road block before we can complete the project.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403731", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I change the admin menu title and url title on WordPress I was hoping someone can help me on how to change the admin menu title and also the link title that goes with it. I want to change Projects admin menu title to Services admin menu. Also, change the link title as well.\nBelow is the image for your reference.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403732", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why does get_dirsize return the same size? The function below is intended to return the size of the base directory. Although additional files have been uploaded, it continues to display the same size. What am I missing?\nfunction get_space_used() {\n    $upload_dir = wp_upload_dir();\n    $space_used = number_format( get_dirsize( $upload_dir['basedir'] ) / ( 1024 * 1024 ), 1 );\n    return $space_used;\n}\n\n\nA: Under the hood, get_dirsize() uses recurse_dirsize() which uses a transient called dirsize_cache. Try clearing that transient and check again.\nTo do so, you can use one of the following methods:\n\n*\n\n*call delete_transient('dirsize_cache');\n\n*use WP CLI's wp transient delete\n\n*use a plugin\n\nLooking further through the source code, I think it should be possible to use recurse_dirsize() directly in your code and telling it not to cache like so:\n$upload_dir = wp_upload_dir();\n$size = recurse_dirsize($upload_dir['basedir'], null, null, []);\n\nBy passing an empty array [] as the fourth argument, it should circumvent the cache because the !isset($directory_cache) now returns a different result.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403733", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Serve specific \"template\" page at any URL that ends in its slug Still new to WordPress, so please go easy on me.\nGoal:\nPrevent users of a specific role from viewing other custom post types made by users of same role.\nIntended solution:\nModify the URL and redirect to a custom 403 page when the user ID doesn't match the post author. As such, if the person attempting to view example.com/%taxonomy%/%private-post-slug% would instead be redirected to example.com/%taxonomy%/403\nCurrent redirect code:\n\u200b<?php\n\nadd_action( 'template_redirect', 'private_posts_redirect');\n\nfunction private_posts_redirect() {\n    $user = wp_get_current_user();\n    $post = get_post();\n    $author = $post->post_author;\n    if( get_post_type() == 'custom-post-type'){\n        if(!$user->ID == $author || !$user->ID == 1){\n           $intendedtarget = $_SERVER['REQUEST_URI'];\n           $intendedtargetpath = parse_url( $intendedtarget, PHP_URL_PATH );\n           $intendedtargetslug = pathinfo( $intendedtargetpath, PATHINFO_BASENAME );\n           $redirectslug = '403';\n           $redirecturl = str_replace( $intendedtargetslug, $redirectslug, $intendedtarget);\n           wp_redirect($redirect_url);\n           exit;\n        }\n    }\n}\n\nCurrent issue:\nI've created a 403 page with '403' as the slug, I'm just not sure how to serve the content of that template page on any page that ends with that slug.\nTentative solution:\nadd_action('init' '403_page')\n\nfunction 403_page(){\n    if(stristr($_SERVER['REQUEST_URI'],'403')){\n        DO_SOMETHING\n    }\n}\n\nEdit: I know this only addresses the post author, I've already got the redirects for users that aren't of the role I'm looking to compartmentalize posts for. Additionally, I am using the  Advanced Post Queries plugin to only serve authors their posts, however that doesn't prevent them from viewing others posts by typing random numbers into the URL and getting to view sensitive RFQ, quote, and pricing info that's unique to that user.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403734", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Load CSS before Theme CSS I have a stylesheet I want to load first in the head before other plugins load css or theme css. For some reason priority is not working for me. Any idea how I can achieve this? I need to use functions as this stylesheet only loads on a specific page\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403736", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Error call_user_func_array() After Installing Plugin this error comes to you in WordPress after installing the plugin\n\nWarning: call_user_func_array() expects parameter 1 to be a valid callback, function 'my_function_admin_bar' not found or invalid function name in /home/worksam1/public_html/work-sample-order/wp-includes/class-wp-hook.php on line 307 class=\"rtl home blog\">\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403738", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Shortcode won't take into account custom post ID put in parameter I wrote a little custom shortcode and when I try to use it in a custom post it won't take into account the parameter I set up.\nWhat it's supposed to do\nThe shortcode is supposed to take a custom post ID into parameter and display a div that use the thumbnail of this post as a background if there's one, and then display the title of the post inside that DIV. Pretty simple stuff.\nWhat it does\nIn front the shortcode appears to work as intended but don't take ID parameter into account and use current post ID to execute the function instead. The weird thing is that when I put a default value \"4075\" for $ID in the array it works fine. It just won't take the parameter into account when I set it with [lire-aussi ID=\"4075\"]\nThe code\nfunction shortcode_lire_aussi( $atts ){\n        extract(\n          shortcode_atts( array(\n          'ID' => '',\n        ), $atts));\n    \n        \n          $title= get_the_title($ID);\n          $linkURL= get_permalink($ID);\n    \n          if(has_post_thumbnail($ID)){\n            $background = get_the_post_thumbnail_url( $ID );\n            $output= '\n            <div style = \"background-image : url('.$background.');\">\n              <p>\n                <a href=\"'.$linkURL.'\">'.$title.'</a>\n              </p>\n          </div>';\n          }\n          else{\n            $output= '\n          <div style = \"background-color : black;\">\n            <p>\n              <a href=\"'.$linkURL.'\">'.$title.'</a>\n            </p>\n          </div>';\n          }\n    \n    \n            return $output;\n        \n       \n     \n}\n    \nadd_shortcode('lire-aussi', 'shortcode_lire_aussi');\n\nI'm not really familiar with PHP and my knowledge of that language is very limited, I'm clearly missing something but can't figure what.\n\nA: Shortcode attributes should be all lowercase\nA Note on Security\nThere are 2 major security issues in your shortcode:\n\n*\n\n*extract is dangerous as it can overwrite variables, it would be much safer to use $ID = ! empty( $atts['ID'] ) ? $atts['ID'] : null; instead. You might see this in a lot of examples but this is because copy pasting is popular and people are unaware, not because it's ok. Never use extract() under any circumstances if you value security and safety.\n\n*There is no escaping on your variables, when you output values you should escape dynamic values, e.g. <a href=\"'.$linkURL.'\"> should be <a href=\"'.esc_url( $linkURL ).'\">. This guarantees that only a URL can go in the href part, even if something malicious is inserted that tries to break out.\n\n\nA: Looks like I solved the main issue ( the shortcode not fetching the right ID put as parameter) by renaming the variable inside the atts array. Apparantly it should always be in lower case: developer.wordpress.org/reference/functions/shortcode_atts\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403740", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I disable or hide the Layout block setting in the Group block Can somebody please explain how I can disable the Layout block setting in the Group Block? I have been spending countless hours trying to disable unnecessary interface elements for our client's sites but cannot seem to wrap my head around the methodology necessary to fully customize the admin experience like we used to pre-Gutenberg.\nI do not want to disable the width ability of our them, but I just don't want it for the group block. You can see what panel I'm referring to at https://wordpress.org/support/article/group-block/.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403742", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: How to stop permalink Custom Structure getting applied beyond Posts? I want a permalink structure like this...\n\n*\n\n*Posts: https://example.com/post/name-of-awesome-post/\n\n*Users: https://example.com/user/nicksmith/\nFor Posts, I know I can go to Permalink Settings: Common Settings and set a Custom Structure of /post/%postname%/.\nThe trouble is, whatever is in Common Settings / Custom Structure also gets applied as a prefix to the author URL. It becomes https://example.com/post/author/nicksmith/.\nIn other words, I can only cleanly rewrite author_base if I don't add a permalink prefix.\nI've also noticed the prefix getting applied to date-based archive links... https://example.com/post/2022/02/ - this is wrong.\nI feel WordPress should support rewriting more granularly.\n--\nTo vary the author profile URL structure, I know you can either use a plugin or do a wp_rewrite on author_base like...\nfunction change_author_base()\n{\n    global $wp_rewrite;\n    $wp_rewrite->author_base = 'user';\n}\nadd_action('init', 'change_author_base');\n\nHowever, the same problem as above is evident; the prefix gets added... the author URL becomes https://example.com/post/user/nicksmith/.\nCan I stop the Common Settings value messing with the author base and other things, or else recalibrate my learning on what's going on here?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403743", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WooCommerce Shop Orders by Date I need to get WooCommerce orders and filter it between dates but its not working.\nHere's my code:\n$start = '2022-03-00';\n$end = '2022-12-20';\n\n$args = array(\n    'post_type' => 'shop_order',\n    'posts_per_page' => -1,\n    'after'     => $start, \n    'before'    => $end,\n    'meta_query' => array(\n        array(\n            'key' => '_order_send_time',\n            'value' => array($start, $end),\n            'compare' => 'BETWEEN',\n            'type' => 'DATE'\n        ),\n        array(\n            'key' => '_fb_pickup_branch',\n            'value' => \"900\",\n            'compare' => 'like',\n        )\n    )\n);\n// query\n$events_query = new WP_query();\n$events_query->query($orderArgs);\n\n\nA: You should use wc_get_orders and make use of their built in date_before and date_after arguments.\n$orders = wc_get_orders(\n    'post_type' => 'shop_order',\n    'posts_per_page' => -1,\n    'date_before' => $before,\n    'date_after' => $after,\n);\nvar_dump($orders);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403744", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Allow REST API Endpoint to specific user and hide from public So I've been working on trying to figure this out, but I can't seem to get the right answer or even find docs online regarding this issue, so I'm reaching out to the community to see if I can get some assistance.\nSo I have the following RestRoutes class:\nclass RestRoutes\n{\n    private string $namespace;\n    private string $resource;\n\n    public function __construct()\n    {\n        $this->namespace = 'twitter/v1';\n        $this->resource = '/posts/';\n        $this->init();\n    }\n\n    public function init(): void\n    {\n        add_action('rest_api_init', [$this, 'register_rest_route']);\n    }\n\n    public function register_rest_route(): void\n    {\n        register_rest_route(\n            $this->namespace,\n            $this->resource,\n            [\n                'methods'  => 'GET',\n                'callback' => [$this, 'twitter_posts'],\n                'permission_callback' => '__return_true'\n            ]\n        );\n    }\n\n    public function twitter_posts(): WP_REST_Response|array\n    {\n        $data = get_transient('twitter_socialapi_data');\n        if (!empty($data)) {\n            return $data;\n        }\n        try {\n            $response = Twitter::init()->get_profile_tweets(50);\n            if (empty($response)) {\n                return [];\n            }\n            $tweets = [];\n            foreach ($response as $tweet) {\n                $tweets[] = [\n                    'id' => $tweet->get_id(),\n                    'text' => $tweet->get_body(),\n                    'link' => $tweet->get_tweet_link(),\n                    'profile_image_url' => $tweet->user()->get_image_url(),\n                    'profile_url' => $tweet->user()->get_url(),\n                    'name' => $tweet->user()->get_name(),\n                    'username' => $tweet->user()->get_username(),\n                    'created_at' => $tweet->get_created_at()->format('h:i A \u00b7 F d, Y')\n                ];\n            }\n            set_transient('twitter_socialapi_data', $tweets, 3 * HOUR_IN_SECONDS);\n        } catch(Exception $e) {\n            return [];\n        }\n\n        return $tweets;\n    }\n}\n\nWhich when I go to the following endpoint https://twitter.test.com.local/wp-json/twitter/v1/posts, I get data:\n[{\"id\":\"1491469724835889154\",\"text\":\"RT <a href=\\\"https:\\/\\/twitter.com\\/FOXSoccer\\\" title=\\\"FOXSoccer\\\" target=\\\"_blank\\\">@FOXSoccer<\\/a>: What a save from Al Hilal's Al-Mayouf !\\ud83e\\udde4 <a href=\\\"https:\\/\\/t.co\\/D7p4vwIn44\\\" target=\\\"_blank\\\"><\\/a><img class=\\\"tweet-photo\\\" src=\\\"https:\\/\\/pbs.twimg.com\\/media\\/FLLDiZnXEAY38Wu.jpg\\\" style=\\\"width: 100%; margin-top: 11px; border-radius: 12px\\\" \\/>\"}]\n\n\nAs it currently sits, ANYONE with the endpoint can make requests.\nHow does one make the endpoint private to just a specific user?\nI have a WordPress user called source and I've already added the application password, as shown below:\n\nDoes anyone know how to properly allow only the specific user to make the request? Use Basic Authentication within Postman, etc..\nThanks all!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403745", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Possible add color palette for a block's inner div instead of outer? I'm developing a block that has a layout where the color should be applied to an inner div, not the outer block container. Is that possible?\nIf I add color support, it will add it to the outer container, like this:\n\nBut I want the color added to an inner div to create this:\n\nI know I could override this with CSS, but I'm wondering if it's possible to add a color palette picker to an inner div.\nMy current setup in block.json looks like this:\n    \"supports\": {\n        \"color\": {\n            \"text\": true,\n            \"background\": true\n        }\n    },\n    \"attributes\": {\n        \"backgroundColor\": {\n      \"type\": \"string\",\n      \"default\": \"mist\"\n   },\n\nI want the user to be able to choose from the theme palette without it being on block container.\nMy new code, which works, but I'd rather have it add a class like 'has-x-background-color' instead of an inline style using the hex code. I think getColorObjectByColorValue is the answer, but I can't figure out how to use it.\nimport { __ } from \"@wordpress/i18n\";\nimport {\n    useBlockProps,\n    InspectorControls,\n    useSetting,\n    useInnerBlocksProps,\n} from \"@wordpress/block-editor\";\n\nimport { PanelBody, ColorPalette } from \"@wordpress/components\";\n\nexport default function Edit({ attributes, setAttributes }) {\n    const { bgColor } = attributes;\n\n    const innerBlocksProps = useInnerBlocksProps({\n        style: {\n            backgroundColor: bgColor,\n        },\n    });\n\n    return (\n        <>\n            <InspectorControls>\n                <PanelBody>\n                    <p>Background Color</p>\n                    <ColorPalette\n                        value={bgColor}\n                        colors={[...useSetting(\"color.palette\")]}\n                        onChange={(value) => setAttributes({ bgColor: value })}\n                    />\n                </PanelBody>\n            </InspectorControls>\n\n            <div {...useBlockProps()}>\n                <p>testing testing</p>\n                <div {...innerBlocksProps} />\n            </div>\n        </>\n    );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403746", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: Tracking Visitor LatLng with Wordpress using JS, PHP. How to put data which was extract using JS into DB Case: I tried to implement via js a geolocation tracker (not an IP Tracker). The code snippet is under Divi > Integration > Body Tag (Divi Page Builder). Afterwars i build via PhpMyAdmin a table which colums i need like visitor_id, visitor_lat, visitor_lng etc.\nQuestion: How do i put the data i get via my js snippet into my data base table gps_tracker?\nWhat i know: I know that i have to use some php to put some data into my db. I read about ajax, jquery and so on but got confused, which to choose.\nQuestion 2: Lets say i have the php code to put the gps location into my table, where to i write the php code, in the child theme functions.php or in a separate file where i upload later to my host?\nOne of many Goals: In the end i want to build a map, which visitor location shows up and my truck location. So i can calculate the distance in minutes. So the visitor would know i will be in 20 minutes in his place.\nTried to build something like this: https://code-boxx.com/gps-tracking-system-php-javascript/#sec-track\nBut like mentioned, do not really know where place the code. Maybe creating and uploading the files in WEBFTP?\nAlso it would be really nice, if someone can give advice how to start with php progamming regards wordpress, especially, retrieving data and putting data into DB.\nRegards,\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403748", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to use a shortcode or an application to dynamically embed content from one WordPress site to another? Looking to update the content only in one place and have updated to the other site(s). Thinking it can be done with shortcodes but not sure how to create it. I am using Elementor on both sites. Thank you!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403751", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Fastest way of counting posts of a custom post type in a specific taxonomy term? I know this kind of question is legion but I have read through all related topics and I can't find a satisfying solution.\nWhat I want to achieve is simple: on my taxonomy (author) term archive page I have a list of all terms within that taxonomy from which you can select to switch from one term to another.\nI want to display the number of posts only from the post type (several CPT are associated with author).\nSimply put I want it to look like this:\n<ul>\n  <li class=\"cat-item\"><a href=\"example.com/author/albert-camus\">Albert Camus</a> (233)</li>\n  <li class=\"cat-item\"><a href=\"example.com/author/jean-fontaine\">Jean de la Fontaine</a> (134)</li>\n  <li class=\"cat-item\"><a href=\"example.com/author/victor-hugo\">Victor Hugo</a> (82)</li>\n</ul>\n\nBut I have hundreds of authors and thousands of posts.\nWether I use get_posts or WP_query the page takes forever to load. I understand why. Because it makes hundreds of request to count the number of posts.\nMost of the topics on this subject in here use this kind of solution to do that :\n   $the_query = new WP_Query( array(\n      'post_type' => 'post',\n      'tax_query' => array(\n         array(\n           'taxonomy' => $taxonomy,\n           'field' => 'term_id',\n           'terms' => $term->term_id\n         )\n       )\n    ) );\n    $count = $the_query->found_posts;\n\nIf I do that within the loop to list all terms, it destroys my server.\nIs there a way to easily count the number of posts from a specific cpt inside a term that is more performance proof?\n\nA: Terms generally should have a count parameter that you can use. I'm not sure if this is accurate across multiple post types though.\n\nThis may not be the fastest solution but one option could be the additional parameters for WP_Query to both reduce the number of queries and the returned values. 10up has a good article on this in regards to WP_Query Performance. An example query could look like this:\n$the_query = new WP_Query( array(\n    'post_type'     => 'post',\n    'no_found_rows' => true,\n    'tax_query'     => array( array(\n       'taxonomy'   => $taxonomy,\n       'field'      => 'term_id',\n       'terms'      => $term->term_id\n    ) ),\n    'no_found_rows' => true,    // Don't calculate pagination\n    'fields'        => 'ids',\n) );\n\nYou could cache the results until the next time terms are added too using the added_term_relationship hook which you could take advantage of to speed up future requests.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403752", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Why does do_robots() Allow: /wp-admin/admin-ajax.php by default? This is happening with a fresh, new WordPress install. But all you need to do is look at the crazy do_robots() function, which outputs the following...\nUser-agent: *\nDisallow: /wp-admin/\nAllow: /wp-admin/admin-ajax.php\n\nSitemap: https://knowingart.com/wp-sitemap.xml\n\nSending robots to \"wp-admin\" (by default) makes no sense:\n\n*\n\n*Why would I send random robots into my admin directory?! The admin directory is for me, and me alone. Robots/crawlers should not be in my admin directory doing anything.\n\n*Why would I DOS attack myself by sending robots to an admin script?\n\n*If I was a bot developer, I might (wrongly) interpret this \"allow\" as negation of the disallow, because the allow comes after the disallow and it's the same directory. Why does robots.txt contradict itself here?\n\n*This weird (default) robots.txt seems to break DuckDuckGo. For example the top search result is my wp-admin directory?! It appears DuckDuckGo read my robots.txt, went into wp-admin because robots.txt told it to go there, and that is the wrong directory. Was DDG's crawler confused by the weird robots.txt file? Now I'm thinking DDG crawled my blog before any content was available, and just hasn't updated yet, that seems to be a more likely explanation.\n\nWhy does WordPress send robot crawlers to an admin directory that has no content?! It makes no sense to me, which is why I am here trying to figure it out. I can only imagine the author of this do_robots() code doesn't understand the purpose of robots.txt\n\nA: First: have a read-up on robots.txt, if you haven't. Another good reference is this one from Yoast.\nThe sample you posted:\nUser-agent: *\nDisallow: /wp-admin/\nAllow: /wp-admin/admin-ajax.php\n\nSitemap: https://knowingart.com/wp-sitemap.xml\n\n...tells all user-agents (ie, all crawlers) that they are not allowed to crawl anything in your wp-admin directory except /wp-admin/admin-ajax.php, which is required by WordPress for properly-functioning AJAX.\nIt's not telling robots to go to your /wp-admin/ directory; it's telling them they're unwelcome there (except for the AJAX requirement).\nAs for your question #4, I'm afraid I don't have an answer to that one.\n\nA: the truth is that probably nothing should be blocked in robots.txt by core (this is IIRC was joost's position abot the matter) as wordpress is an open platform and front end content and styling might and is generated in all kinds of directories which might not make much sense to you and me. Wordpress is not in the buisness of preventing site owners from installing badly written plugins.\nWhy do you have pages indexed by a search engine? Wordpress uses a kind of \"don't index\" headers for all admin pages so most likely you have some badly written code that prevents the header from bein sent. (this assumes that there is no bug in bing which is the SE which powers DDG).\nMaybe worth reminding that robots.txt is just an advisory file, it is up to the search engine to decide if and how to respect it. IIRC google will not respect it fully if there was a link to a page which supposed to be excluded by robots.txt\n\nA: There is a great reason why WordPress, despite being one of the most used frameworks, is also among the ones that has most errors and bad practices, just look at any log and count the hundreds of warnings it throws, and the reason is no other than poor development and lazy developers.\nNow to the point: you should always write your own robots.txt, you don't need google to index your wp-ajax, you probably aren't even using it, and in most cases it generates vulnerabilities, you should also disable access for guests or use a plugin to hide it or simply disable it completely, WP will work in 90% of cases and you will not expose your user list to the world. Also be careful with the autogenerated sitemap as it may display usernames making bruteforcing halfway easier\nAll you need is:\nUser-agent: *\nDisallow: /wp-admin/\n\nHere's an example of a sitemap showing usernames\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403753", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Putting custom html/js page into Elementor as it's own block I have a working custom html/javascript page that I created and then FTPd into my wordpress site as a custom template which I'm applying to a blank page. However, I have elementor pro and though I may want to add other elements on this page that could be edited by others in the future.\nI know there's an HTML option in elementor but it doesn't seem to work if I paste this into it.\nIs there a way to get this put into a block on my elementor page so that the rest of the page can be designed as usual in elementor?\n<div class=\"container\" style=\"width:80%; margin:0 auto; height:500px; border:1px solid black;margin-top:40px; border-radius:18px;\">\n  <div class=\"row\">\n    <div class=\"col-lg-6\">\n        <div style=\"padding-top:35px; margin-bottom:20px;\">\n          <input id=\"textSearch\" type=\"text\" name=\"locationSearch\" placeholder=\"search\" style=\"border-radius:18px; padding:4px; width: 100%;\" onKeyUp=\"searchStores(this.value)\" />\n        </div>\n      <div id=\"stores-list\" class=\"stores-list\">\n\n      </div>\n    </div>\n    <div class=\"col-lg-6\">\n      <div id=\"map\" style=\"margin-top:20px; border-radius:18px;\">\n        \n      </div>\n    </div>\n  </div>\n</div>\n\n\n<script src=\"https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap\" async defer></script>\n\n<script type=\"text/javascript\">\nvar map;\nvar markers = [];\n\nvar locationSelect;\nvar activeInfoWindow; \n\n\nlet stores = [{\n    \"recommendation\": {},\n    \"storeNumber\": \"5758-13907\",\n    \"id\": \"15051\",\n    \"name\": \"La Cienega & Gregory Way\",\n    \"phoneNumber\": \"310-659-9562\",\n    }, {\n    \"recommendation\": {},\n    \"storeNumber\": \"5577-1851\",\n    \"id\": \"14753\",\n    \"name\": \"Fairfax & Olympic\",\n    \"phoneNumber\": \"(323) 634-7845\",\n    }];\n\nfunction initMap() {\n    var losAngeles = { lat: 34.063380, lng: -118.358080 };\n    map = new google.maps.Map(document.getElementById('map'), {\n        center: losAngeles,\n        zoom: 11,\n        styles:[\n  {\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#f5f5f5\"\n      }\n    ]\n  },\n  {\n    \"elementType\": \"labels.icon\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#616161\"\n      }\n    ]\n  },\n  {\n    \"elementType\": \"labels.text.stroke\",\n    \"stylers\": [\n      {\n        \"color\": \"#f5f5f5\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"administrative.land_parcel\",\n    \"elementType\": \"labels\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"administrative.land_parcel\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#bdbdbd\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#eeeeee\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi\",\n    \"elementType\": \"labels.text\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#757575\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi.business\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi.park\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#e5e5e5\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi.park\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#9e9e9e\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#ffffff\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road\",\n    \"elementType\": \"labels.icon\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.arterial\",\n    \"elementType\": \"labels\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.arterial\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#757575\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.highway\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#dadada\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.highway\",\n    \"elementType\": \"labels\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.highway\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#616161\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.local\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.local\",\n    \"elementType\": \"labels\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.local\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#9e9e9e\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"transit\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"transit.line\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#e5e5e5\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"transit.station\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#eeeeee\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"water\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#c9c9c9\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"water\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#9e9e9e\"\n      }\n    ]\n  }\n]\n    });\n    \n    /*showStoreMarkers();*/\n    \n    \n\n};\n\nfunction clearLocations() {\n  infoWindow.close();\n  for (var i = 0; i < markers.length; i++) {\n    markers[i].setMap(null);\n  }\n  markers.length = 0;\n}\n\nfunction showStoreMarkers() {\n\n    stores.forEach(function(store, index) {\n        var latlng = new google.maps.LatLng(\n            store.coordinates.latitude,\n            store.coordinates.longitude\n        );\n        var name = store.name;\n        var address = store.addressLines[0];\n        createMarker(latlng, name, address);\n    });\n};\n\nfunction setOnClickListener() {\n    var storeELements = document.querySelectorAll('.store-container');\n    storeELements.forEach(function(element,index) {\n      element.addEventListener('click', function() {\n      new google.maps.event.trigger(markers[index], 'click');\n      });\n    });\n};\n\n\n\nfunction searchStores() {\n  var foundStores = [];\n  var value = document.getElementById('textSearch').value;\n  \n  console.log(value);\n  \n  if(value){\n    stores.forEach(function (store,index) {\n      var id = store.id;\n      console.log(id);\n      if(id == value){\n        foundStores.push(store);\n      };\n    });\n  }else{\n    foundStores = stores;\n  }\n\n  /*clearLocations();*/\n  displayStores(foundStores);\n  showStoreMarkers(foundStores);\n  setOnClickListener();\n};\n\n\nfunction createMarker(latlng, name, address) {\n    var infoWindow = new google.maps.InfoWindow();\n    var marker = new google.maps.Marker({\n        map: map,\n        position: latlng,\n        animation: google.maps.Animation.DROP,\n        icon:'https://api.geoapify.com/v1/icon/?type=material&color=%23c524ff&icon=public&noWhiteCircle&apiKey=443526b60ca64c558f1276983013c2d8',\n   // adding custom icons (Here I used a Flash logo marker)\n         draggarble: false,// If set to true you can drag the marker\n        clickable: true,\n        title: name,\n        zIndex: 1\n    });\n    \n    google.maps.event.addListener(marker, 'click', function () {\n        var iwHtml = \"<div style='width:auto; text-align: center;'>\" + name + \"</div>\";\n        infoWindow.close();\n         infoWindow.setOptions({\n         content: iwHtml\n         });\n         if (activeInfoWindow) { activeInfoWindow.close();}\n         infoWindow.open(map, marker);\n         activeInfoWindow = infoWindow;\n     });\n    markers.push(marker);\n    return marker;\n    };\n    \n    $('.map-trigger').on('click', function(event) {\n      event.preventDefault();\n      marker = markers[this.id];\n      var content = $(this).find('.content').html();\n      infoWindow.close();\n      infoWindow.setOptions({\n        pixelOffset: new google.maps.Size(0, -40)\n      });\n      infoWindow.setContent(\"<div style='width:auto; text-align: center;'>\" + name + \"</div>\");\n      infoWindow.open(map /*,  marker */ );\n    });\n    \n\n\nfunction displayStores(stores){\n  var storesHtml = '';\n  stores.forEach(function (store, index) {\n    var address = store.addressLines;\n    var name = store.name;\n    var id = store.id;\n    storesHtml += `\n        <div class=\"store-container\" style=\"margin-bottom:15px;\">\n          <div class=\"row\">\n            <div class=\"col-lg-6\">\n              <img src=\"https://via.placeholder.com/150\">\n            </div>\n            <div class=\"col-lg-6\">\n              <div style=\"display:flex;\">\n                <div>Popular</div>\n                <div>Premium</div>\n              </div>\n              <div class=\"name\">\n                <a class=\"map-trigger\" href=\"#\">${name}</a>\n                <p>${id}</p>\n              </div>\n              <div class=\"store-address\">\n                <span>${address[0]}</span>\n                <span>${address[1]}</span>\n              </div>\n              <div style=\"display:flex\">\n                <div class=\"stars\">*****</div>\n                <div class=\"price\">976K</div>\n              </div>\n            </div>\n          </div>\n        </div>\n    `\n  });\n  document.querySelector('.stores-list').innerHTML = storesHtml\n}\n</script>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403754", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom wp-query display post only today I have a problem. My query not display the post only today.\n$today = getdate();\n$query = new WP_Query( array(\n    'post_type'         => 'tips',\n    'posts_per_page'    => '9',\n    'order'             => 'DESC',\n    'tax_query' => array( array(\n        'taxonomy' => 'sport',\n        'field'    => 'slug',\n        'terms'    => 'football',           \n        'date_query' => array( array(\n            'year'  => $today['year'],\n            'month' => $today['mon'],\n            'day'   => $today['mday'],\n        ) ),\n    ) ),\n) );\n\nSome advice about it\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403755", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to save block attributes when the output doesn't change I have a block with some settings that affect the editor only. So not the output. The issue is that when I change these settings, the output doesn't change. Then Wordpress does not detect the change, and does not trigger the \"update\" button. Next time I open the post the changes to my block-level settings are gone, because they were not saved.\nCan I manually trigger the update button from my block?\ncode\nimport Edit from \"./components/edit/edit\"\nimport PreviewInEditor from \"./components/edit/editor-preview\";\nimport BlockSettings from \"./components/block-settings/BlockSettings\";\nimport { useBlockProps } from '@wordpress/block-editor';\n\nexport default function Editor( props ) {\n\n    function update_settings( settings ) {\n        props.setAttributes( { ...props.attributes, settings } );\n    }\n\n    if( props.isSelected || props.attributes.price_records.length === 0 ) {\n        return ( <div { ...useBlockProps() }>\n            <Edit {...props} /> \n            <BlockSettings settings={props.attributes.settings} onChange={update_settings} />\n        </div> );\n    } else {\n        return ( <div { ...useBlockProps() }>\n            <PreviewInEditor {...props} />\n            <BlockSettings settings={props.attributes.settings} onChange={update_settings} />\n        </div>);\n    }\n\n}\n\n\nA: Actually an assumption I made in the question was wrong; The update button doesn't only change when the output of the save function changes. It also changes when the attributes are changed.\nHowever I found a small bug, which you can't really see it in the provided code. In my BlockSettings component I was using useState to update the settings inside to the component. I would also emit the settings immidiately after assigning them.\nuseState is however an async function. So in fact I was emitting the old value. Since I emitted the old value the attributes were identical to the values before. Therefore not triggering an update.\nThe fix was quite easy. Using useEffect to react on the changed value did the trick for me.\nSo if the update button isn't triggering, doublecheck if you actually changed the attributes.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403757", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "4"}}
{"text": "Q: How to add content to a post tied to an Archive template specifically for a custom post type I'm on wordpress 5.9+ and creating CPT's has become relatively easy. But having a landing page for a CPT is new grounds for me.\n\n*\n\n*I have successfully created a custom post type called Career Finders\n\n*I have created an archive template for this CPT, named archive-career-finders.php\n\n*I can see that template being used from the browser when I go to my local URL my-site.com/career-finders\nBut how do we create either a page or post from WP-admin, that connects to this archive template, and \"is\" this landing page for the CPT?\nI want editors to be able to add content to this landing page through wp-admin.  This is where I am stuck...\nMy initial thought:\nOn this new archive template, do I use the WP-Query loop to get that \"1\" page or post that represents the content needed to be displayed here, and also have that page set to Private? Is that the way to go?\nMany thanks!\n\nA: If I'm understanding your question properly, you are looking for templates.  Copy your single.php or page.php from your theme and then rename it to single-career-finders.php.\nThis is the same thing you should have done for your archive page as well...  Take the archive.php file from your theme, copy it and rename to archive-career-finders.php.  It will have the appropriate query within it to pull your custom posts but you can alter the content as well.  You don't have to add a separate WP_Query here.\nNow edit this file and you'll have a custom presentation for your data separate from normal pages, posts, or other CPTs.\nThis page has a great explanation of how templates work within WordPress:\nhttps://developer.wordpress.org/themes/basics/template-hierarchy/\n\nA: After some thinking, I'm taking the following approach\n\n*\n\n*Under my CPT area in wp-admin/, create a public post that represents the content for my CPT landing page. This post is naturally located at my-site.com/career-finders/landing-content\n\n*From my child theme area, set code in place to hide this post from Archives pages, Search results, RSS feed, and Blog Roles. This given article inspired me on the process.\n\n*Within my archive-career-finders.php template, call the data from my /landing-content page with the help of setup_postdata($p);, inspired by this post\n\n*Now when a user goes to my-site.com/career-finders they will see landing page content for my CPT.\n\nThis seems to me as the easiest way to allow an wp-admin editor to add content to a post, that is tied to a custom Archive template, for a custom post type.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403759", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Can i fetch the list of pouplar posts of last 24 hours from Wordpress API? i am using wordpress api to display the posts on my flutter app where I am planning to display \"Popular Posts\" (Duration : Last 24 hours). How can I get the list of popular posts view in the last 24 hours time range? How can I achieve this Sort By \"Popular Posts\".\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403768", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: gutenberg widget outputting paragraph marks I have created a shortcode to output a wp_Query.  Nowhere in my query do I output any <p></p> paragraph marks.  However the widget puts this before my output and after.\nAt first I thought maybe it was something in my code, but I created this sample version as an example:\nfunction test_shortcode() {\n    $testout = '<div>hi there.</div>';\n    return $testout;\n}\nadd_shortcode ('show-test', 'test_shortcode');\n\nI then output the shortcode in my footer widget. I'm using wordpress 5.9 and the widgets are now gutenberg.  I've tried using the shortcode block and the custom-html block.\n[show-test]\nThis is what I expect for an output:\n<div>hi there.</div>\n\nBut this is what I receive:\n<p></p><div>hi there.</div><p></p>\n\nUPDATE:\nFor completion sake, this is the FULL widget output:\n<div class=\"footer-widget-2\">\n        <aside id=\"block-10\" class=\"widget inner-padding widget_block\"><p></p><div>Hi there.</div><p></p>\n    </aside>\n</div>\n\nI've tried changing themes this still happens.  Does anyone have any idea what is causing the extra paragraph marks before and after?  More importantly how to stop them?\n\nA: \nDoes anyone have any idea what is causing the extra paragraph marks before and after?\n\nThe Shortcode block performs wpautop() on the content (in the block) before the shortcode is parsed (see source on GitHub), i.e. wpautop( '[show-test]' ) in your case, which then returns <p>[show-test]</p> and then outputs <p><div>hi there.</div></p> after the shortcode is parsed.\nSo I believe that was the raw (or server-generated) code that you could find in the page source (Ctrl+U on Chrome Windows desktop), but because the nesting/markup is invalid (a div can not be in a p), then the browser automatically fixed the nesting which became this instead: <p></p><div>hi there.</div><p></p>, i.e. two empty paragraphs were added outside the div element.\nAnd with that said, you were likely viewing the DOM tree and not the raw HTML source, hence you didn't notice the actual HTML outputted via the Shortcode block.\nFor more information on DOM vs. page/HTML source, check these out:\n\n*\n\n*What is the difference between HTML and DOM? on Medium\n\n\n*What is the difference between source code and DOM? on Stack Overflow\n\n\nMore importantly how to stop them?\n\nThe Shortcode block doesn't have any setting that would stop/disable the auto-P-ing, and while it's possible to override the render_callback for the block, or code your own block/widget, there's actually a very easy option to prevent the issue from happening, which is \u2014 add your shortcode using the Custom HTML block instead of the Shortcode block. \n(If that is still giving you the same issue, then as I said in my comment, you can try clearing your site cache and disable caching for a while)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403769", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Need help for some PHP code I've already set all the fields in my theme settings but I want that carousel-items class repeats whenever I add slides to it, and [0] changes to [1],[2],...\n<div class=\"carousel-items\">\n                    <a href=\"<?php echo website_TDU; ?>/single.html\">\n                        <div class=\"carousel-main-image\">\n                            <img src=\"<?php echo $main_slider[2] ['main_slider_main_image']; ?>\" alt=\"\">\n                        </div>\n                        <div class=\"carousel-more-info\">\n                            <div class=\"game-name\"><?php echo $main_slider[2] ['main_slider_title']; ?></div>\n                            <div class=\"screenshots\">\n                                <div style=\"background-image: url('<?php echo $main_slider[2] ['main_slider_thumbnails1']; ?>');\"></div>\n                                <div style=\"background-image: url('<?php echo $main_slider[2] ['main_slider_thumbnails2']; ?>');\"></div>\n                                <div style=\"background-image: url('<?php echo $main_slider[2] ['main_slider_thumbnails3']; ?>');\"></div>\n                                <div style=\"background-image: url('<?php echo $main_slider[2] ['main_slider_thumbnails4']; ?>');\"></div>\n                            </div>\n                            <div class=\"carousel-region\">\n                                <h4><span class=\"badge bg-secondary\">10</span></h4>\n                                <h4><span class=\"badge bg-secondary\">20</span></h4>\n                            </div>\n                            <div class=\"carousel-product-price\">\n                                <div class=\"carousel-discount\">\n                                    <span><?php echo $main_slider[2] ['main_slider_percent']; ?></span>\n                                </div>\n                                <span class=\"carousel-last-price\">\n                                <?php echo $main_slider[2] ['main_slider_last_price']; ?>\n                                </span>\n                                <span class=\"carousel-special-price\">\n                                <?php echo $main_slider[2] ['main_slider_current_price']; ?>\n                                </span>\n                                <i class=\"fab fa-windows\"></i>\n                            </div>\n                        </div>\n                    </a>\n                </div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403770", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using Json Schema with wordpress codex I have a json schema code that I need to use it for all posts\n<script type=\"application/ld+json\">\n{\n  \"@context\": \"https://schema.org\",\n  \"@type\": \"Article\",\n  \"mainEntityOfPage\": {\n    \"@type\": \"WebPage\",\n    \"@id\": \"https://akhbarejadid.com/457881/\"\n  },\n  \"headline\": \"title\",\n  \"description\": \"this is a test description\",\n  \"image\": \"https://media.imna.ir/d/2021/07/15/4/1713968.jpg\",  \n  \"author\": {\n    \"@type\": \"Person\",\n    \"name\": \"Javad\"\n  },  \n  \"publisher\": {\n    \"@type\": \"Organization\",\n    \"name\": \"Akhbarejadid\",\n    \"logo\": {\n      \"@type\": \"ImageObject\",\n      \"url\": \"https://akhbarejadid.com/wp-content/uploads/2021/05/logoakhbarejadid.png\"\n    }\n  },\n  \"datePublished\": \"2022-03-01\",\n  \"dateModified\": \"2022-03-16\"\n}\n</script>\n\nCan I use wp codes like the_title(); or the_author(); or the_content(); for this json schema?\nFor example :\n\"headline\": \"<?php the_title(); ?>\",\n  \"description\": \"<?php the_excerpt(); ?>\",\n  \"image\": \"https://media.imna.ir/d/2021/07/15/4/1713968.jpg\",  \n  \"author\": {\n    \"@type\": \"Person\",\n    \"name\": \"<?php the_author(); ?>\"\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403771", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Default click \"I have read and agree to the website terms and conditions\" On WordPress checkout page, I want to make the \"I have read and agree to the website terms and conditions\" default clicked. Users can unclick the check icon. Is there any code available?\n\n\nA: Try this snippet in functions.php for your child theme\nadd_filter( 'woocommerce_terms_is_checked_default', '__return_true' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403772", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is it better to use a constant or apply_filter? I'm using WPML, which has several ways to access the current language.\nICL_LANGUAGE_CODE\nif( ICL_LANGUAGE_CODE === 'en' ){\n  // Do stuff\n}\n\napply_filter( 'wpml_current_language', null )' docs\n$lang = apply_filter( 'wpml_current_language', null );\nif( $lang === 'en' ){\n  // Do stuff\n}\n\n\nI can't find any documentation on the ICL_LANGUAGE_CODE.\nThe apply_filter has a documentation page, but in my opinion, the readability drops with this.\nAre there any obvious drawbacks using one or the other?\n\nUpdate\nI know that I mentioned WPML, but that was to give the question context. This is WordPress-specific and not 3rd party specific. The dynamic could be anywhere in WordPress, in any plugin and/or theme.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403775", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add a new category for posts I`m new with coding in Wordpress. \nI try to make a plugin with a widget.\nWhen I install the plugin I want it to make a new category for posts. \nI want the new category named \"GiveAway\".\nName:  GiveAway \nSlug:  GiveAway \nParent: None  \nWhen the plugin is finished, I should work like this:\nWhen you install the plugin a category called \"GiveAway\" for posts will be created.\nIf I make a new post and select the category \"GiveAway\", this post title and feature image will show in a widget at the font side.\nThen you can click at the image or title to enter the post.\nThis category should only be visible for administrators at the backend, not other users.\nOnly the administrator should be able to use / select it.\nI think this category should be hidden for the visitors at the font side in URL and category list.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403776", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can you hide a widget based on its content? I have a Plug-In for displaying events on my site. Unfortunately there is no option to hide it when there are no events, just a specific message saying \"There are no events\" or something like that.\nI tried to create a hook to prevent the widget from being displayed but I don't know where I can access it based on its content.\nThis is what I have to far:\n<?php\nadd_filter( 'widget_display_callback', 'widget_display', 50, 3 );\nfunction widget_display( $instance, $widget, $args ){\n    if ($widget->id_base == 'mec_mec_widget' ) {\n        return false;\n    }\n    return $instance;\n}\n?>\n\nAs you can see it targets the widget with its ID base so that it applies to all instances of this widget. Unfortunately the actual content is not in $widget, I just found the general settings there but no variable showing the number of events or anything like that. Any idea how I can access the content? I thought about preg_match() with a Regex finding the text that shows when there are no events but I wouldn't know how or where I can access this part. Maybe you have an idea, thanks in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403778", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress SQL LIKE request doesn't work for fields with special symbols In WordPress I make SQL-requests to the database but LIKE request doesn't work correctly.\nActial value of meta_value field in the database is such string:\na:1:{i:0;s:9:\"full-time\";}\n\nif I make this request all works fine:\n$query = $wpdb->prepare(\"SELECT meta_value FROM wp_postmeta WHERE meta_key = 'job_bm_job_type' AND meta_value LIKE '%a%' LIMIT 1\");\n\nBut if try to use other text in LIKE part I don't get any results\n$query = $wpdb->prepare(\"SELECT meta_value FROM wp_postmeta WHERE meta_key = 'job_bm_job_type' AND meta_value LIKE '%full%' LIMIT 1\");\n\nIdeally, LIKE request should search through data of all the string. But it seems like it doesn't search inside the content of square brackets { }\nWhat I miss here? How to search through any elements in this field?\n\nA: I found the answer.\nLike @Sally-CJ mentioned above, %f in the beginning was mistakenly seen as one of supported placeholders for wpdb::prepare() (the other two placeholders are %s and %d).\nSo you need to add escaping the quotes \\\". In my case it's \\\"full\\\". With escaping it works perfectly.\n$query = $wpdb->prepare(\"SELECT meta_value FROM wp_postmeta WHERE meta_key = 'job_bm_job_type' AND meta_value LIKE '%\\\"full\\\"%' LIMIT 1\");\n\nIf you search string starts from letter a, d, f \u2013 this finding could help you solve the problem.\n\nA: \nWhat I miss here? How to search through any elements in this field?\n\nYour SQL statements, or the LIKE '%a%' and LIKE '%full%', are good.\nBut the wpdb::prepare()'s documentation says, \"Literal percentage signs (%) in the query string must be written as %%\", hence you should actually use LIKE '%%a%%' and LIKE '%%full%%'.\nBut then the documentation also says that:\n\nPercentage wildcards (for example, to use in LIKE syntax) must be\npassed via a substitution argument containing the complete LIKE\nstring, these cannot be inserted directly in the query string. Also\nsee\nwpdb::esc_like().\n\nTherefore with wpdb::prepare(), you would want to do it like so which is based on the example in the esc_like()'s documentation:\nAdditionally, instead of hard-coding the table name (wp_postmeta), I used $wpdb->postmeta \u2014 it's a core property and is equivalent to {$wpdb->prefix}postmeta used in a double-quoted string \"like this\".\n$wild = '%';\n$find = 'full';\n$like = $wild . $wpdb->esc_like( $find ) . $wild; // build the complete LIKE string\n\n// I wrapped the statement for brevity.\n$query = $wpdb->prepare( \"\n    SELECT meta_value\n    FROM $wpdb->postmeta\n    WHERE meta_key = 'job_bm_job_type'\n        AND meta_value LIKE %s\n    LIMIT 1\n\", $like );\n\nWhy exactly %a% worked, but %full% did not work\n\n*\n\n*%full% starts with %f which is one of the supported placeholders for wpdb::prepare() (the other two placeholders are %s and %d).\nAnd because the prepare() method detected a placeholder in the query and yet you didn't specify the 2nd parameter for that method, then it returned an empty string and thus no query was made.\nBut yes, that %f was mistakenly seen as a placeholder, which is a reason why %% should be used for literal percentage signs in the query.\n\n\n*%a% worked because it does not start with a supported placeholder and thus the prepare() method treated the % as literal percentage signs. (But MySQL treated them as wildcards)\nSo in response to your answer, adding the \\\" worked because it changed the %f to %\\\"f (or just %\"f when passed to MySQL), which makes it no longer a placeholder.\nBut then I advise you to use the \"complete LIKE string\" approach as you could see in my example above.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403781", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why wordpress cookies name contains HASH As documented here, wordpress cookies name have HASH part. I wonder to know what is its use-case?\n\nA: Hash is used to encrypt the data saved in cookies, So, you don\u2019t have to worry about someone getting your username and password by reading the cookie data.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403783", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Wrong Number of Products When Hiding Subcategory Products From Showing In Parent Category I'm using following code to display only parent category products and remove the child category products displayed in the catalog:\nfunction exclude_product_cat_children($wp_query) {\nif ( isset ( $wp_query->query_vars['product_cat'] ) && $wp_query->is_main_query()) {\n    $wp_query->set('tax_query', array( \n                                    array (\n                                        'taxonomy' => 'product_cat',\n                                        'field' => 'slug',\n                                        'terms' => $wp_query->query_vars['product_cat'],\n                                        'include_children' => false\n                                    ) \n                                 )\n    );\n  }\n}  \nadd_filter('pre_get_posts', 'exclude_product_cat_children');\n\nIf you now select the parent category in the catalog, only the products from this category are displayed.\nThe code works as it should except for one small flaw:\nThe number of products per catalog page is no longer correct and varies from page to page depending on how many products of the subcategory were hidden.\nI could not find any further information about this problem although this code seems to be used more often.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403784", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I have redesigned a website and my blog page has different permalinks im a new website developer and i dont have much experience with this subject.\nI made a new website for a customer using wordpress ( also the previous uses wordpress)\nMy question is , in the old website the links are like this\nPage -> www.[mywebsite].com/page-name\nPortfolio -> www.[mywebsite].com/portfolio/portfolio-page\nblog-> www.[mywebsite].com/blog-page\n\nwhich was wrong because the blog pages are not made with posts but with wordpress pages thats why the blog page doesnt have a /category/ before its name.\nin the new website the blog posts are made with posts instead with the category\nMy issue is, that right now if i set the permalinks it shows like this\nPage -> www.[mywebsite].com/page-name\nPortfolio -> www.[mywebsite].com/portfolio/portfolio-page\nblog-> www.[mywebsite].com/**blog-category**/blog-page\n\nand if i make the permalinks as simple it shows like this\nPage -> www.[mywebsite].com/page-name\nPortfolio -> www.[mywebsite].com/portfolio-page\nblog-> www.[mywebsite].com/blog-page\n\nso my question is, is there any way that i make the permalinks of the blog to NOT show the category of the posts but show the category of the portfolio ?\nif this has been answered before im very sorry. Thanks for your time.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403785", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sticky posts limit query and pagination for a custom post type I would like to display 9 posts per page. But, when I have a sticky post, I would like it to be integrated in the 9 posts in the query. And, then, for the second page, I continue to have the next 9 posts...\nSo I did this:\n$sticky_count = count(get_option( 'sticky_posts' ));\n$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n$posts_per_page = 9;\nif(!is_paged()):\n   $posts_per_page = $posts_per_page - $sticky_count;\nendif;\n$params = ['post_type' => 'projects', 'order' => 'DESC', 'posts_per_page' => $posts_per_page, 'paged' => $paged];\n\n$my_query = new WP_Query( $params );?>\n<?php $c_array = $my_query->get_posts(); ?>\n     <?php foreach ($c_array as $project) : ?>\n           <div class=\"cell small-12 medium-6 large-4\">\n                <?php include locate_template('parts/one_project.php'); ?>\n           </div>\n    <?php endforeach; ?>\n\nWith this code, I have 9 posts on my first page, including the sticky post. I also have 9 posts on the other pages. However, one post is missing!\nLet's say I put the 14 in sticky. So on my first page I have: 14, 1, 2, 3 ... 8.\nOn the second page, it's the 10th post that appears. The ninth has disappeared... How to do ?\nThanks a lot for help\nEDIT ---\nI tried to do that but I still have the problem since the request is re-executed on each page...\n$sticky = count(get_option('sticky_posts'));\n$posts_per_page = 9;\n$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n$params = [\n    'post_type' => 'projects',\n    'order' => 'DESC',\n    'posts_per_page' => $posts_per_page,\n    'paged' => $paged,\n    'offset' => 9 - $sticky\n];\nif (!is_paged()):\n    $posts_per_page = 9 - $sticky;\n    $params = [\n        'post_type' => 'projects',\n        'order' => 'DESC',\n        'posts_per_page' => $posts_per_page,\n        'paged' => $paged,\n    ];\nendif;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403787", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom Gutenberg Block: Excluding an allowed block from InnerBlock's templateLock={'all'} The title pretty much says it all. I am working on a custom Gutenberg block that utilizes the InnerBlocks component and I have defined some allowed and default blocks. I also have templateLock set to all so the user cannot add, remove or move blocks around. However, this settings is affecting the core/buttons block and your ability to add a new button (since this block made up of individual core/button blocks).\nIs there any way around this? Is there a way to specifically exclude the core/buttons blocks from the templateLock setting?\nBelow you will find my edit function for the block.\nedit: function (props) {\n    const { className, clientId } = props;\n\n    /**\n     * Add Item\n     */\n    const onRemoveItem = () => {\n        setAttributes({ items: parseInt(`${items}`) - 1 })\n        removeBlock(clientId)\n    }\n\n    return (\n        <Fragment>\n            <div className='listicles-innerblocks' >\n                <InnerBlocks\n                    template={[\n                        ['core/cover'],\n                        ['custom/listdt'],\n                        ['core/buttons'],\n                        ['custom/listdd'],\n                    ]}\n                    allowedBlocks={[\n                        ['core/cover'],\n                        ['custom/listdt'],\n                        ['core/buttons'],\n                        ['custom/listdd']\n                    ]}\n                    templateLock={'all'}\n                />\n            </div>\n        </Fragment>\n    );\n},\n\n\nA: core/buttons is a container block, it's not the actual buttons. Instead, core/buttons contains core/button blocks. The same way that a core/columns block contians core/column blocks.\nYou need to add core/button to your allowed blocks list.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403789", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Use woocmmerce function on theme and override them i neet to override handle_bulk_actions() function of class WC_Admin_List_Table_Orders by theme functions.php or with custom plugin functions and need to clone set_status() function of class WC_Order also to make new function to do the same code by other variable\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403795", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Product custom taxonomy is not found when space in name I have created a custom taxonomy and added the below script for the search in the function.php. This works so far. But if the name of the taxonomy has a space, it will not be found.\nSo if the title of the taxonomy is e.g. dog, then it is found with \"dog\". But if the title is called dog food, it will not be found with \"dog food\".\nWhat can be the reason for this?\nadd_filter( 'posts_search', 'woocommerce_search_product_tag_extended', 999, 2 );\nfunction woocommerce_search_product_tag_extended( $search, $query ) {\n    global $wpdb, $wp;\n\n    $qvars = $wp->query_vars;\n\n    if ( is_admin() || empty($search) ||  ! ( isset($qvars['s'])\n    && isset($qvars['post_type']) && ! empty($qvars['s'])\n    && $qvars['post_type'] === 'product' ) ) {\n        return $search;\n    }\n    \n    // Here set your custom taxonomy\n    $taxonomy = 'CUSTOMTAXONOMY'; // WooCommerce product tag\n\n    // Get the product Ids\n    $ids = get_posts( array(\n        'posts_per_page'  => -1,\n        'post_type'       => 'product',\n        'post_status'     => 'publish',\n        'fields'          => 'ids',\n        'tax_query'       => array( array(\n            'taxonomy' => $taxonomy,\n            'field'    => 'name',\n            'terms'    => esc_attr($qvars['s']),\n        )),\n    ));\n\n    if ( count( $ids ) > 0 ) {\n        $search = str_replace( 'AND (((', \"AND ((({$wpdb->posts}.ID IN (\" . implode( ',', $ids ) . \")) OR (\", $search);\n    }\n    return $search;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403799", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Completely Disable Wordpress RSS Feeds There are loads of articles out there on how to completely disable Wordpress RSS feeds, my configuration (functions.php) is:\nfunction disable_feed() {\n  wp_die( 'You Died' , 200 );\n}\nadd_action('do_feed', 'disable_feed', 1);\nadd_action('do_feed_rdf', 'disable_feed', 1);\nadd_action('do_feed_rss', 'disable_feed', 1);\nadd_action('do_feed_rss2', 'disable_feed', 1);\nadd_action('do_feed_atom', 'disable_feed', 1);\nadd_action('do_feed_rss2_comments', 'disable_feed', 1);\nadd_action('do_feed_atom_comments', 'disable_feed', 1);\n\nBut instead of getting a nice-looking HTML page with the bordered content normally associated with the wp_die() function, when browsing to https://website/feed/ I'm getting this knarley page back:\n\nAnyone know what I'm doing wrong?\nDavid.\n\nA: Add following code to: functions.php\n function itsme_disable_feed() {\n     wp_die( __( 'No feed available, please visit the <a href=\"'. esc_url( home_url( '/' ) ) .'\">homepage</a>!' ) );\n    }\n\nadd_action('do_feed', 'itsme_disable_feed', 1);\nadd_action('do_feed_rdf', 'itsme_disable_feed', 1);\nadd_action('do_feed_rss', 'itsme_disable_feed', 1);\nadd_action('do_feed_rss2', 'itsme_disable_feed', 1);\nadd_action('do_feed_atom', 'itsme_disable_feed', 1);\nadd_action('do_feed_rss2_comments', 'itsme_disable_feed', 1);\nadd_action('do_feed_atom_comments', 'itsme_disable_feed', 1);\n\nremove_action( 'wp_head', 'feed_links_extra', 3 );\nremove_action( 'wp_head', 'feed_links', 2 );\n\n\nA: I just couldn't get this to work. I was expecting the wp_die() function to provide its message on a pretty HTML page, like this example: https://www.wpbeginner.com/wp-tutorials/how-to-disable-rss-feeds-in-wordpress/\n...but all I get is this nasty XML tree.\nI've changed my solution now to instead HTTP302 redirect the visitor to ./feed/ to the homepage. This is actually a better solution, I believe, because it means Wordpress is not run.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403800", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: On click load iframe I have this html\n<a href=\"#1647278006925-e8321147-313b\" data-vc-accordion=\"\" data-vc-container=\".vc_tta-container\"><span class=\"vc_tta-title-text\">LISTEN</span></a>\n\nthat is printed in my page and opens an accordion with an iframe in it.\nThe iframe:\n<iframe id=\"myiFrame\" class=\"stop-lazy\" data-src=\"https://some.iframe\" frameborder=\"0\" allowtransparency=\"true\" style=\"width: 100%;min-height: 150px;\"></iframe>\nI am trying to create a jquery code that will load the iframe only when the user click on the link.\nSo i have tried to set the below script in the footer.php:\n<script> $(\".vc_tta-title-text\").click(function(){ var iframe = $(\"#myiFrame\"); iframe.attr(\"src\", iframe.data(\"src\"));  }); </script> \nbut it is not working.\nAny help would be appreciated.\n(Note:It would be better to trigger the click event from the href=\"#1647278006925-e8321147-313b\" )\n*I can not edit the html.\n**I can edit, add or remove classes or ids in the iframe.\n\nA: Did you inspect your code for any errors?\nIf the error is \"Uncaught TypeError: $ is not a function\", then maybe you can add the code as below.\n<script>\njQuery(document).ready(function($) {\n    //your code starts here\n    <iframe id=\"myiFrame\" class=\"stop-lazy\" data-src=\"https://some.iframe\" frameborder=\"0\" allowtransparency=\"true\" style=\"width: 100%;min-height: 150px;\"></iframe>\n});\n</script>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403803", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Displaying validation message in options-general.php I have added a setting field in the general settings page. The field and the validation work, but the validation error message does not show.\n<?php\nadd_action( 'admin_init', 'initialize_extra_settings' );\nfunction initialize_extra_settings() {\n  register_setting( \n    'general', \n    'setting_app_store_app_url', \n    array (\n      'type' => 'string',\n      'sanitize_callback' => 'settings_url_field_validation'\n    ) \n  );\n  add_settings_field(\n    'app-store-app-url-field', // Field slug\n    'App Store app URL',\n    'app_store_app_url_field_cb',\n    'general', // In this settings page (slug)\n    'default', // In this section (slug)\n    array(\n      'label_for' => 'app-store-app-url-field',\n      'class' => 'custom-settings-row'\n    )\n  );\n}\n\nfunction app_store_app_url_field_cb( $args) {\n  $setting = get_option('setting_app_store_app_url'); \n  ?>\n    <input \n      id=\"<?php echo $args['label_for'];?>\" \n      name=\"setting_app_store_app_url\" \n      type=\"url\" \n      value=\"<?php echo isset( $setting ) ? esc_attr( $setting ) : ''; ?>\"  \n    />\n  <?php\n}\n\nfunction settings_url_field_validation( $value ) {\n  $urlRegExp = \"/https:\\/\\/([\\w_-]+(?:(?:\\.[\\w_-]+)+))([\\w.,@?^=%&:\\/~+#-]*[\\w@?^=%&\\/~+#-])/\";\n  if ( !preg_match($urlRegExp, $value) ) {\n    add_settings_error( 'setting_app_store_app_url', 'invalid_app_store_app_url', 'Must be a valid url', 'error' );\n    return null;\n  }\n  return $value;\n}\n\nadd_action( 'admin_notices', 'show_custom_settings_admin_notices' );\nfunction show_custom_settings_admin_notices() {\n  var_dump(get_settings_errors('setting_app_store_app_url'));\n  settings_errors('setting_app_store_app_url');\n}\n\nThe var_dump(get_settings_errors('setting_app_store_app_url')); returns an empty array.\n\nA: I was developing locally with Local, so I tested in the online version, where it worked. I then deactivated most of the plug-ins locally, and it started to work. I might have also stopped the site and run it again, I am not sure, but it might have helped? Anyway, after reactivating all the same plug-ins, it kept working, so I guess that some of the actions above have helped. Here it the complete working solution.\n<?php\n//... The content of functions.php until here\n\nadd_action( 'admin_init', 'initialize_extra_settings' );\nfunction initialize_extra_settings( ) {\n  register_setting( 'general', 'setting_app_store_app_url', array(\n     'type' => 'string',\n    'sanitize_callback' => function( $value ) {\n      return settings_url_field_validation( $value, 'setting_app_store_app_url', 'App store app url' );\n    } \n  ) );\n  register_setting( 'general', 'setting_android_app_url', array(\n     'type' => 'string',\n    'sanitize_callback' => function( $value ) {\n      return settings_url_field_validation( $value, 'setting_android_app_url', 'Android app url' );\n    } \n  ) );\n  // Register new fields in the sections\n  add_settings_field( 'app-store-app-url-field', // Field slug\n    'App Store app URL', 'app_store_app_url_field_cb', 'general', // In this settings page (slug)\n    'default', // In this section (slug)\n    array(\n     'label_for' => 'app-store-app-url-field',\n    'class' => 'custom-settings-row' \n  ) );\n  add_settings_field( 'android-app-url-field', // Field slug\n    'Android app URL', 'android_app_url_field_cb', 'general', // In this settings page (slug)\n    'default', // In this section (slug)\n    array(\n     'label_for' => 'android-app-url-field',\n    'class' => 'custom-settings-row' \n  ) );\n}\n\nfunction app_store_app_url_field_cb( $args ) {\n  $setting = get_option( 'setting_app_store_app_url' );\n?>\n   <input \n        id=\"<?php echo $args['label_for']; ?>\" \n        name=\"setting_app_store_app_url\" \n        type=\"url\" \n        value=\"<?php echo isset( $setting ) ? esc_attr( $setting ) : ''; ?>\"  \n    />\n    <?php\n}\n\nfunction android_app_url_field_cb( $args ) {\n  $setting = get_option( 'setting_android_app_url' ); // The name used in the register_setting call\n?>\n   <input \n        id=\"<?php echo $args['label_for']; ?>\" \n        name=\"setting_android_app_url\" \n        type=\"url\"\n        value=\"<?php echo isset( $setting ) ? esc_attr( $setting ) : ''; ?>\"  \n    />\n    <?php\n}\n\nfunction settings_url_field_validation( $value, $field, $name ) {\n  $urlRegExp = \"/https:\\/\\/([\\w_-]+(?:(?:\\.[\\w_-]+)+))([\\w.,@?^=%&:\\/~+#-]*[\\w@?^=%&\\/~+#-])/\";\n  if ( !preg_match( $urlRegExp, $value ) ) {\n    $value = get_option( $field ); // ignore the user's changes and use the old database value\n    add_settings_error( $field, $field, $name . ' must be a valid url', 'error' );\n    return $value;\n  }\n  return $value;\n}\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403806", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Ajax call on new site with jupiterx theme getting 400 response I have a new site up and running with JupiterX theme and I just added this code in my functions.php file in order to handle an ajax request:\nfunction sgtGetListings() {\n  echo 'FILE IS WORKING NOW';\n}\nadd_action('wp_ajax_sgtGetListings', 'sgtGetListings');\nadd_action('wp_ajax_nopriv_sgtGetListings', 'sgtGetListings');\n\nCode for the actual request (Update)\njQuery.ajax({\n    type: 'GET',\n    url: '<?php echo home_url(); ?>/wp-admin/admin-ajax.php'\n});\n\nKeep in mind the site is brand new, I just set it up. But everytime I call this from a custom page on my site I get the 400 bad request code back.\nWhat am I doing wrong here? Is there a different way I need to make an ajax call?\n\nA: You will need to use and pass a nonce when accessing admin-ajax\nEnqueue script with nonce:\n$params = array(\n  'ajaxurl' => admin_url('admin-ajax.php', $protocol),\n  'ajax_nonce' => wp_create_nonce('any_value_here'),\n);\nwp_localize_script( 'my_blog_script', 'ajax_object', $params );\n\najaxurl \u2013 This is the absolute address, taking into account http:// or https://, to your ajax processing script. This script is in the wp-admin folder, but can be used for front end ajax scripts as well.\najax_nonce \u2013 This is our nonce that we check in our ajax function. Notice how I used the string \u2018any_value_here\u2019 within the wp_create_nonce function\u2026 You can use any string, but be sure to remember what you use, because we will need to use the same string when we check the AJAX nonce.\nUse Ajax Object in AJax Call:\n$.ajax({\n  type : \"post\",\n  dataType : \"json\",\n  url : ajax_object.ajaxurl,\n  data : 'action=get_posts_commented&amp;email='+user_email+'&amp;security='+ajax_object.ajax_nonce,\n  success: function(response) {\n    // You can put any code here to run if the response is successful.\n\n    // This will allow you to see the response\n    console.log(response);\n  }\n});\n\nCheck nonce in php function:\nadd_action('wp_ajax_get_posts_commented', 'get_posts_commented');\nadd_action('wp_ajax_nopriv_get_posts_commented', 'get_posts_commented');\nfunction get_posts_commented(){\n  check_ajax_referer( 'any_value_here', 'security' );\n\n  $email = urldecode($_POST['email']);\n\n  global $wpdb;\n  $results = $wpdb->get_results($wpdb->prepare(\"\n    SELECT\n      comment_post_ID\n    FROM\n      {$wpdb->comments}\n    WHERE\n      comment_type = '' AND comment_approved = 1 AND comment_author_email = '%s'\";,\n    $email), ARRAY_A);\n\n  echo json_encode($results);\n\n  exit;\n}\n\nReference: https://eric.blog/2013/06/18/how-to-add-a-wordpress-ajax-nonce/\nAlso great tutorial: https://www.youtube.com/watch?v=DNCPX5uuUBk\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403809", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Problems with uploading pictures to WordPress When trying to upload pictures to WordPress I face big problems. Sometimes it does not work at all and sometimes I need to try several times. Some pictures I even never managed to upload.\nI tried uploading the pictures\n\n*\n\n*With different browsers (Firefox, Edge, Chrome)\n\n*With the WordPress-Uploader drag-and-drop or selecting the pictures and also with the Browser-Uploader. With the Uploader it just does not continue to the next picture and stays with 100%. With the Browser-Uploader after a while there\u2019s a error saying that the page could not be loaded.\n\n*Deactivating all my plug-ins and do the upper steps again\n\nI also tried to manually upload one picture to the database directly, accessing it from my hosts\u2019 website. It didn\u2019t show up in the Media-Overview.\nThe pictures are 500KB to 1.2MB, 1500x1000 pixel, 70 to 100dpi, jpg-format.\nThis is really annoying.\nDoes anyone know what could be wrong? Should I try a new Installation of WordPress? Might there be a problem with my host and should I contact them?\nI\u2019m using the newest version of WordPress (atm 5.9.2) and the Plug-ins.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403812", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Trigger jQuery to add events after AJAX-loading table in admin plugin I created a small Wordpress plugin which has some admin-panels. I am using the WP_List_Table class to display some data, but this HTML-table is ajax loaded. Because of the ajax-loading, jQuery doesn't add functionality to the table, in particular the toggle functionality in a mobile (responsive) view. The toggle button appears, but clicking it does not show the hidden columns.\nThis is the HTML that is added after the ajax-call:\n<table class=\"wp-list-table widefat fixed striped table-view-list \">\n<thead>\n<tr>\n    <th scope=\"col\" id=\"delete\" class=\"manage-column column-delete\"></th>\n    <th scope=\"col\" id=\"name\" class=\"manage-column column-name column-primary\">Name</th>\n    <th scope=\"col\" id=\"details\" class=\"manage-column column-spots\">Details</th></tr>\n</thead>\n\n<tbody id=\"the-list\">\n    <tr>\n        <td class=\"delete column-delete\" data-colname=\"\">\n            <a onclick=\"deleteItem(6)\">delete</a>\n        </td>\n        <td class=\"name column-name has-row-actions column-primary\" data-colname=\"Name\">\n            John\n            <button type=\"button\" class=\"toggle-row\"><span class=\"screen-reader-text\">Show details</span></button>\n        </td>\n        <td class=\"spots column-details\" data-colname=\"Details\">Here some details...</td>\n    </tr>\n</tbody>\n\n<tfoot>\n...\n</tfoot>\n\nThe table displays as it should, however the toggle button is not working, probably because the table was added after the page load.\nIs there a way to trigger the jQuery script after I reload the table?\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403813", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hide title field of selected post-types on edit pages My question is how to hide the title field on the edit page of a cpt that has a title field\nhere hide litteraly means do not display or do not show, or do not offer the possibility to be edited \"manually\".\nI thus want that my cpt have and support a title field, but prevent it to be edited from the edit page.\nNote that I do not want to hide the title for any post type, just some, and also for some user roles only, thus css won't nail it. I do not include in my question how to find the curent user role, nor the post type curently edited as these are different questions addressed elsewhere\nI do hope my question is documented enough, and let me know if any extra info may be of interest !\nThank's\n\nbackground about empty field\nwordpress wont accept to save an empty post out of the box, so hiding the title only could prevent creating the post, so we may need to use wp_insert_post_empty_content\nof to populate the title field before saving the post to the database with wp_insert_post_data\nhowever these two point are out of the scope of this question\n\nbackground of other research and solution\nThis might seems as an already addressed question Remove post title input from edit page, but it appears misleading and do not fit every use cases.\nto my understanding it is critical to distinguish two things :\n\n*\n\n*hide post-title field from post edit page in wp-admin (for a given post-type)\n\n*remove title as a field (for a given post-type)\n\nwith this in mind, the  question which ask how to remove the post-title input form the edit page may be misleading, because\n\n*\n\n*remove could be understand as hide as well as do not create/delete the title field,\n\n*the request is about the title input within the edit page, not about the property of the post type\n\nusefullness of the accepted answer from @JMau\nThis answer is perfect for the second situation, when someone want a post-type without title field\nLimit of the accepted answer from @Jmau\nit do not cover the case I'm putting forward in my question\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403816", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding Category Name in Slug in Custom Post Type I have created Custom Post Type without using plugin i.e. via Meta Box Post Type Generator.\nadd_action( 'init', 'your_car_register_post_type' );\nfunction your_car_register_post_type() {\n    $args = [\n        'label'  => esc_html__( 'Cars', 'text-domain' ),\n        'labels' => [\n            'menu_name'          => esc_html__( 'Cars', 'your-car' ),\n            'name_admin_bar'     => esc_html__( 'Car', 'your-car' ),\n            'add_new'            => esc_html__( 'Add Car', 'your-car' ),\n            'add_new_item'       => esc_html__( 'Add new Car', 'your-car' ),\n            'new_item'           => esc_html__( 'New Car', 'your-car' ),\n            'edit_item'          => esc_html__( 'Edit Car', 'your-car' ),\n            'view_item'          => esc_html__( 'View Car', 'your-car' ),\n            'update_item'        => esc_html__( 'View Car', 'your-car' ),\n            'all_items'          => esc_html__( 'All Cars', 'your-car' ),\n            'search_items'       => esc_html__( 'Search Cars', 'your-car' ),\n            'parent_item_colon'  => esc_html__( 'Parent Car', 'your-car' ),\n            'not_found'          => esc_html__( 'No Cars found', 'your-car' ),\n            'not_found_in_trash' => esc_html__( 'No Cars found in Trash', 'your-car' ),\n            'name'               => esc_html__( 'Cars', 'your-car' ),\n            'singular_name'      => esc_html__( 'Car', 'your-car' ),\n        ],\n        'public'              => true,\n        'exclude_from_search' => false,\n        'publicly_queryable'  => true,\n        'show_ui'             => true,\n        'show_in_nav_menus'   => true,\n        'show_in_admin_bar'   => true,\n        'show_in_rest'        => true,\n        'capability_type'     => 'post',\n        'hierarchical'        => true,\n        'has_archive'         => true,\n        'query_var'           => true,\n        'can_export'          => true,\n        'rewrite_no_front'    => false,\n        'show_in_menu'        => true,\n        'menu_position'       => 5,\n        'menu_icon'           => 'dashicons-admin-tools',\n        'supports' => [\n            'title',\n            'editor',\n            'author',\n            'thumbnail',\n            'custom-fields',\n            'comments',\n        ],\n        'taxonomies' => [\n            'category',\n        ],\n        'rewrite' => true\n    ];\n\n    register_post_type( 'car', $args );\n}\n\nI wanted to create something like this\nsitename.com/category-name/post-url/\nbut the default CPT is sitename.com/cpt-name/post-url/\nI manage to remove cpt URL so the new URL is\nsitename.com/post-url/\nI am using Code Snippets plugin.\nfunction wplis_remove_cpt_slug($args, $post_type) {\nif(in_array($post_type, array('car'))) {\n    $args['rewrite'] = array('slug' => '/');\n}\n\nreturn $args;\n}\nadd_filter('register_post_type_args', 'wplis_remove_cpt_slug', 10, 2);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403818", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to enable [archives] short code I want to use the [archives type=yearly] short code on a side bar widget so that people can click on links and see posts for the year.  But this is the result I'm getting:\n\nThis is what I'm doing in the Widgets Editor:\nAnd I added add_filter( 'widget_text', 'do_shortcode' ); to wp-content/themes/twentysixteen/functions.php.\nI also get a similar problem when pasting the [archives] into a page or post.  The website just renders it at [archives].\nIf I enter a shortcode like [gallery], I see a gallery.\nSo the problem is with the [archives] short code.\nWhat am I doing wrong?\n\n\nA: I don't know or understand why, but I pasted this into wp-content/themes/twentysixteen/functions.php and it worked:\nfunction wpse61674_archives_shortcode_cb( $atts ) {\n    return '<h2 class=\"widget-title\">Archives</h2><ul>'.wp_get_archives(array('format'=>'html','echo'=>false,'type'=>'yearly')).'</ul>';\n}\nadd_shortcode( 'archives', 'wpse61674_archives_shortcode_cb' );\n\nI found this code somewhere on the internet, but it wasn't part of the wordpress documentation on archives shortcode.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403819", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I change the wpstaging.com domain to new domain without damaging the website? I've created a website with Wordpress and the site is under a wpstaging.com domain at the moment. I have my main domain name and hosting with an external hosting company - nothing has be set up on that yet.\nI would like to find out how to go about changing the wpstaging.com domain name to the one I've got with the hosting company and moving the website over to the new domain name without damaging the current website.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403823", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to display \"Trash\" in my custom post type? what does it take to display the Recycle Bin in my own Custom Post Type?\nfunction my_custom_post_specialist() {\n    $labels = array(\n      'name'               => _x( 'Terapeuci', 'post type general name' ),\n      'singular_name'      => _x( 'Terapeuci', 'post type singular name' ),\n      'add_new'            => _x( 'Dodaj nowego specjalist\u0119', 'book' ),\n      'add_new_item'       => __( 'Dodaj nowego specjalist\u0119' ),\n      'edit_item'          => __( 'Edytuj specjalist\u0119' ),\n      'new_item'           => __( 'Nowy specjalista' ),\n      'all_items'          => __( 'Wszyscy specjali\u015bci' ),\n      'view_item'          => __( 'Poka\u017c specjalist\u0119' ),\n      'search_items'       => __( 'Szukaj specjalist\u00f3w' ),\n      'not_found'          => __( 'Nie znaleziono specjalisty' ),\n      'not_found_in_trash' => __( 'Brak specjalist\u00f3w w koszu' ), \n      'menu_name'          => 'Terapeuci'\n    );\n    $args = array(\n      'labels'        => $labels,\n      'description'   => 'Tutaj znajduj\u0105 si\u0119 wszyscy specjali\u015bci.',\n      'menu_position' => 4,\n      'supports'      => array( 'title', 'editor', 'thumbnail', 'excerpt', 'revisions' ),\n      'taxonomies'    => array('areas', 'professions'),\n      'has_archive'   => true,\n      'menu_icon'     => 'dashicons-groups',\n      'public' => false,  // it's not public, it shouldn't have it's own permalink, and so on\n      'publicly_queryable' => true,  // you should be able to query it\n      'show_ui' => true,  // you should be able to edit it in wp-admin\n      'show_in_nav_menus' => false,  // you shouldn't be able to add it to menus\n      'has_archive' => false,  // it shouldn't have archive page\n      'rewrite' => true,  // it shouldn't have rewrite rules\n    );\n    register_post_type( 'specialist', $args ); \n  }\n  add_action( 'init', 'my_custom_post_specialist' );\n\nIt only shows me Drafts, Publications etc, but no Recycle Bin.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403826", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Theme javascript/css 404 I have recently installed WordPress 5.9.2 on my VPS using Apache2 on Debian 11. I want to try some different themes (partially because I think the editor for the new Twenty Twenty-Two theme is clunky and lacks stuff). However I noticed that after changing themes, no styles were loaded leaving an ugly page.\nLooking into the developed console in Firefox, I saw that I was getting 404 errors when loading any resources. I also noticed that I got the same issue when using the default Twenty Twenty-Two theme, except that it at least looked correct. According to the Firefox developer console, I am getting 404's when trying to load various assets. Opening the url's manually confirmed that there is indeed a 404, and that pretty permalinks is working as I am getting a 404 page from WordPress, rather then from Apache.\nI confirmed that the files do indeed exist on disk, and that they have the correct permissions. What is causing this error?\nile premissions for themes Twenty Twenty-Two themes dir\nminecraftchest1@Docker:~$ ls /var/www/wordpress/wp-content/themes/twentytwentytwo/ -al\ntotal 216\ndrwxrwxrwx 6 www-data sudo   4096 Mar 11 00:39 .\ndrwxrwxrwx 7 www-data sudo   4096 Mar 17 14:17 ..\ndrwxrwxrwx 5 www-data sudo   4096 Mar 11 00:39 assets\n-rw-rw-rw- 1 www-data sudo   3632 Dec 20 16:50 functions.php\ndrwxrwxrwx 3 www-data sudo   4096 Mar 11 00:39 inc\n-rw-rw-rw- 1 www-data sudo    216 Nov  9 21:02 index.php\ndrwxrwxrwx 2 www-data sudo   4096 Mar 11 00:39 parts\n-rw-rw-rw- 1 www-data sudo   3538 Feb 21 21:15 readme.txt\n-rw-rw-rw- 1 www-data sudo 162290 Nov  9 21:02 screenshot.png\n-rw-rw-rw- 1 www-data sudo   5602 Feb 21 21:15 style.css\ndrwxrwxrwx 2 www-data sudo   4096 Mar 11 00:39 templates\n-rw-rw-rw- 1 www-data sudo   9157 Jan  3 20:26 theme.json\nminecraftchest1@Docker:~$ \n\nFile Permissions for Twenty-Nineteen themes dir\nminecraftchest1@Docker:~$ ls /var/www/wordpress/wp-content/themes/twentynineteen -al\ntotal 992\ndrwxrwxrwx  9 www-data www-data   4096 Mar 17 14:17 .\ndrwxrwxrwx  7 www-data sudo       4096 Mar 17 14:17 ..\n-rw-rw-rw-  1 www-data www-data    879 Mar 17 14:17 404.php\n-rw-rw-rw-  1 www-data www-data   1297 Mar 17 14:17 archive.php\ndrwxrwxrwx  2 www-data www-data   4096 Mar 17 14:17 classes\n-rw-rw-rw-  1 www-data www-data   4132 Mar 17 14:17 comments.php\ndrwxrwxrwx  2 www-data www-data   4096 Mar 17 14:17 fonts\n-rw-rw-rw-  1 www-data www-data   1679 Mar 17 14:17 footer.php\n-rw-rw-rw-  1 www-data www-data  11624 Mar 17 14:17 functions.php\n-rw-rw-rw-  1 www-data www-data   1937 Mar 17 14:17 header.php\n-rw-rw-rw-  1 www-data www-data   2984 Mar 17 14:17 image.php\ndrwxrwxrwx  2 www-data www-data   4096 Mar 17 14:17 images\ndrwxrwxrwx  2 www-data www-data   4096 Mar 17 14:17 inc\n-rw-rw-rw-  1 www-data www-data   1113 Mar 17 14:17 index.php\ndrwxrwxrwx  2 www-data www-data   4096 Mar 17 14:17 js\n-rw-rw-rw-  1 www-data www-data 116463 Mar 17 14:17 package-lock.json\n-rw-rw-rw-  1 www-data www-data   1527 Mar 17 14:17 package.json\n-rw-rw-rw-  1 www-data www-data    804 Mar 17 14:17 page.php\n-rw-rw-rw-  1 www-data www-data    232 Mar 17 14:17 postcss.config.js\n-rw-rw-rw-  1 www-data www-data   4111 Mar 17 14:17 print.css\n-rw-rw-rw-  1 www-data www-data   3517 Mar 17 14:17 print.scss\n-rw-rw-rw-  1 www-data www-data   4317 Mar 17 14:17 readme.txt\ndrwxrwxrwx 13 www-data www-data   4096 Mar 17 14:17 sass\n-rw-rw-rw-  1 www-data www-data 175535 Mar 17 14:17 screenshot.png\n-rw-rw-rw-  1 www-data www-data   1417 Mar 17 14:17 search.php\n-rw-rw-rw-  1 www-data www-data   1847 Mar 17 14:17 single.php\n-rw-rw-rw-  1 www-data www-data    164 Mar 17 14:17 style-editor-customizer.css\n-rw-rw-rw-  1 www-data www-data    162 Mar 17 14:17 style-editor-customizer.scss\n-rw-rw-rw-  1 www-data www-data  80824 Mar 17 14:17 style-editor.css\n-rw-rw-rw-  1 www-data www-data  19569 Mar 17 14:17 style-editor.scss\n-rw-rw-rw-  1 www-data www-data 232516 Mar 17 14:17 style-rtl.css\n-rw-rw-rw-  1 www-data www-data 232720 Mar 17 14:17 style.css\n-rw-rw-rw-  1 www-data www-data  15717 Mar 17 14:17 style.css.map\n-rw-rw-rw-  1 www-data www-data   3397 Mar 17 14:17 style.scss\ndrwxrwxrwx  6 www-data www-data   4096 Mar 17 14:17 template-parts\nminecraftchest1@Docker:~$ \n\nContent of wp-config.php\nminecraftchest1@Docker:~$ cat /var/www/wordpress/wp-config.php \n<?php\n\n/**\n * The base configuration for WordPress\n *\n * The wp-config.php creation script uses this file during the installation.\n * You don't have to use the web site, you can copy this file to \"wp-config.php\"\n * and fill in the values.\n *\n * This file contains the following configurations:\n *\n * * Database settings\n * * Secret keys\n * * Database table prefix\n * * ABSPATH\n *\n * @link https://wordpress.org/support/article/editing-wp-config-php/\n *\n * @package WordPress\n */\n\n// ** Database settings - You can get this info from your web host ** //\n/** The name of the database for WordPress */\ndefine( 'DB_NAME', 'wordpress' );\n\n/** Database username */\ndefine( 'DB_USER', 'wordpress' );\n\n/** Database password */\ndefine( 'DB_PASSWORD', '<!--Removed-->' );\n\n/** Database hostname */\ndefine( 'DB_HOST', 'localhost' );\n\n/** Database charset to use in creating database tables. */\ndefine( 'DB_CHARSET', 'utf8mb4' );\n\n/** The database collate type. Don't change this if in doubt. */\ndefine( 'DB_COLLATE', '' );\n\n// Locked out of site.\ndefine('WP_HOME',    'https://wp.arsrobotics.org' );\n\ndefine('WP_SITEURL', 'http://wp.arsrobotics.org' );\n\ndefine( 'WP_CONTENT_URL', 'https://wp.arsrobotics.org');\n\nif ($_SERVER['HTTP_X_FORWARDED_PROTO'] == 'https') $_SERVER['HTTPS']='on';\n\n\n/**#@+\n * Authentication unique keys and salts.\n *\n * Change these to different unique phrases! You can generate these using\n * the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}.\n *\n * You can change these at any point in time to invalidate all existing cookies.\n * This will force all users to have to log in again.\n *\n * @since 2.6.0\n */\ndefine( 'AUTH_KEY',         'HUYM] y6cfgYnA_,di@24ga#oxoVc.OwG_c FUpL`Yd8LDG./TKfA-6*0p<y3+rt' );\ndefine( 'SECURE_AUTH_KEY',  '3}|-PqLE26pl^[S$MW52C{mH:Lr=}+HiJju4R`xxP[*3=KM#Xkzn9]ruqOUQNf7T' );\ndefine( 'LOGGED_IN_KEY',    'g])CKZvHZ_:}#M61(iZqn.vndN-c`=;!o02_[K]%d~?6)K..I5e_-b3o_dLgk4kW' );\ndefine( 'NONCE_KEY',        '+mW[)=;=krG`M]kXR7)n){|F^RDo.JY^NxMZ<sk>BI%I2Ijp>sa/9<Nig^`-z&J,' );\ndefine( 'AUTH_SALT',        'KHDiavb$?H/:A>b6}I6/YrLM*PiK8j,kg4rAMW$pGz|B:c8:)o5bu)hBPyvla{xy' );\ndefine( 'SECURE_AUTH_SALT', 'nP@zIfto.@9-jPTuG:NmZs;f<p-%Y7RIYAOjzuK&xH7?`azD|r2ZQ2t8}J>f^[oG' );\ndefine( 'LOGGED_IN_SALT',   'u[`I&!CmM{ }?ZE%{!aFK1M-5L=X/@~zMwAG!n^UR7*)#ZoDM,TCjA}m2(kRbtq6' );\ndefine( 'NONCE_SALT',       ',x1W)t x0h)HpQDYW^NaE.%3MVT>zy%Gw0%J0&jS<1G JNJ~Ikc#dO=Aqn6>EV_=' );\n\n/**#@-*/\n\n/**\n * WordPress database table prefix.\n *\n * You can have multiple installations in one database if you give each\n * a unique prefix. Only numbers, letters, and underscores please!\n */\n$table_prefix = 'wp1_';\n\n/**\n * For developers: WordPress debugging mode.\n *\n * Change this to true to enable the display of notices during development.\n * It is strongly recommended that plugin and theme developers use WP_DEBUG\n * in their development environments.\n *\n * For information on other constants that can be used for debugging,\n * visit the documentation.\n *\n * @link https://wordpress.org/support/article/debugging-in-wordpress/\n */\ndefine( 'WP_DEBUG', false );\n\n/* Add any custom values between this line and the \"stop editing\" line. */\n\n\n\n/* That's all, stop editing! Happy publishing. */\n\n/** Absolute path to the WordPress directory. */\nif ( ! defined( 'ABSPATH' ) ) {\n        define( 'ABSPATH', __DIR__ . '/' );\n}\n\n/** Sets up WordPress vars and included files. */\nrequire_once ABSPATH . 'wp-settings.php';\nminecraftchest1@Docker:~$ \n\n\n\n\n\n\n\nA: Thanks to @jacob peattie for helping me to figure this out. The issue is that I had WP_CONTENT_URL set incorrectly. Removing it fixed the issue. I could have added /wp-content to the url and it would've solved the issue as well.\nTo explain why this caused in issue, I turned to the docs. This page explains that the WP_CONTENT_URL variable (which I understand is set to $WP_SITE_URL . '/wp-content') which the content_url function returns (after removing any extra trailing slashes). This function is used by both WordPress core as well as any extra plugins to the relative url to where 3rd party content (which includes themes and plugins, as well as uploaded media) is stored.\nBecause the stylesheets, javascript, fonts, etc were stored with the theme, the browser was unable to find them as it was told to look in the wrong spot. The correct use to change WP_CONTENT_URL would be is you serve the wp-content url from another domain( possibly through a CDN) that is seperate from the rest of your wordpress site.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403829", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Multisite - can I somehow merge the tables? First of all, I need to say I'm not a fan of WordPress at all and I have never fully understood it.\nBut I have inherited a multisite wordpress where anyone can register his own site. All in all, we have thousands of sites. Every site has 10 database tables. Every single mysql table has 3 files (MYD, MYI and sdi). It means meaybe 200 000 files in single directory, which is absolutely insane. Needless to say that working with this database is hell on earth. Many database UIs have problems to work with this amount of tables.\nMy questions:\n\n*\n\n*Is there any possibility how to get rid of this database havoc? Some plugin or anything to put all the wp_*_options into something like wp_universal_options?\n\n*Is WordPress Multisite even intended for this use case? How are you using it? For like 10 sites on one server?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403830", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Trigger email alert if file downloaded I've found this solution which triggers an email alert when an article is viewed, but wondered if a similar technique is possible for when a specific file is downloaded?\nfunction article_email_alert() {\nglobal $post;\nif( $post->ID == 1234) { \n        wp_mail( 'sam@example.net', 'Alert', 'The article was visited.' );\n    }\n} \nadd_action( 'wp', 'article_email_alert' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403832", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP plugins for building a database? I am a beginner at WP, I need some ideas on how to proceed with the following problem:\nI need to create a tool that will build a database for a client's WordPress site.\nThe database surrounds authors of old literary texts and the information related to them(name, bio, education, etc.). The data relating to each author is quite extensive.\nI need to store these data entries in a database on the website, these entries should be able to be queried and displayed for the user searching through the database.\nI have thought of using a form plugin for this, however, i am not sure if that i the right approach.\n\nA: WordPress natively stores content in a database. It sounds like you're wanting to store info in that database, and retrieve and present it - rather than actually create a separate database.\nIf that's the case, creating custom post types are likely the way to go. An author can be a custom post type, which would allow visitors to browse or search through authors. Their name would simply be the post title. You can add custom taxonomies where appropriate - for example, a genre taxonomy might make sense, so you can easily query all authors who write Science Fiction, for example. You can also add custom postmeta, such as education and bio, if you want to be able to search/filter through that information. If you go the custom taxonomy and/or postmeta route, you'll likely end up wanting to create a child theme, so that you can set up an Archive for the authors where visitors can sort and filter by different criteria.\nOr, you could keep it simpler, and just place each author's information inside the post_content itself. WP will natively search through post titles and post content when returning search results, and of course as visitors view each single author URL, they would be able to view all that data without any customization of the theme or content output.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403834", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Custom Post Type Dashboard Tab not displaying any posts I created a custom post:\n/*= Add Custom Post Type: Board Members\n/****************************************************/ \nadd_action( 'init', 'create_board_posttype' );\nfunction create_board_posttype() {\n  register_post_type( 'board',\n    array(\n      'labels' => array(\n        'name' => __( 'Board Members' ),\n        'singular_name' => __( 'Board Member' ),\n        'add_new_item' => __( 'Add New Board Member' ),\n        'edit_item' => __( 'Edit Board Member' ),\n        'new_item' => __( 'New Board Member' ),\n        'view_item' => __( 'View Board Member' ),\n        'search_items' => __( 'Search Board Members' ),\n        'not_found' => __( 'No Board Members Found' ),\n        'archives' => __( 'Board Members Archives' ),\n        'insert_into_item' => __( 'Insert into Board Member' ),\n      ),\n      'public' => true,\n      'supports' => array( 'title', 'editor', 'custom-fields', 'thumbnail', 'page-attributes' ),\n      'has_archive' => true,\n      'rewrite' => array('slug' => 'board'),\n    )\n  );\n}\n\nI then went and added 10 posts successfully and they are displaying on the frontend fine.\nFast forward 4 weeks and I went in to edit a post but I am seeing \"No board members found\".\nIt shows that there are 10 Board Members published by actually displays none in the list:\nAll (10) | Published (10)\n\nNo Board Members Found\n\nClearly WP knows there are board members (All (10)) but it wont show them... I don't know where to start?\nOk, I found the issue but I don't understand why.\nI have another custom_post_type: jobs\nOn the frontend I try to filter jobs within last x days.  When I remove this code, the Board Members re-appear:\nadd_action( 'pre_get_posts', 'custom_query_vars' );\nfunction custom_query_vars( $query ) {\n    \n    if ( $query->is_main_query() ) \n    {\n        if ( is_archive('job') ) \n        {\n            $days = get_field('job_expiry_days', 'option');\n            $query->set( 'date_query', array(\n                                'column'  => 'post_date',\n                                'after'   => '- '.$days.' days'\n            ) );\n        }\n    }\n    return $query;\n}\n\n\nA: pre_get_posts doesn't just run on the frontend, it runs on all post queries, and that includes RSS feeds, XMLRPC, AJAX, REST API, and WP Admin.\nYou need to check in your pre_get_posts filter and exit early so that it only applies to the places you want it to apply to.\ne.g.\nif ( is_admin() ) {\n    return;\n}\n\nAdditionally, this code is incorrect:\nif ( is_archive('job') ) \n\nThis checks if the main query is a job archive, but it should be checking if $query is a job archive, so it needs to be $query->is_archive( 'job' ).\nThis is also followed by another bug:\n$days = get_field('job_expiry_days', 'option');\n\nIf job_expiry_days is not set, then it will be a falsey value, resolving to 0, meaning only posts older than 0 days ago will be found, aka nothing.\n\nA: This may not answer the question, but note that is_archive() does not accept any parameters. If you want to check if the query is for an archive of a custom post type, use is_post_type_archive(), e.g. is_post_type_archive( 'job' ) if the post type is job.\nAnd for example, if the CPT archive was at example.com/jobs, then if ( is_post_type_archive( 'job' ) ) would return true only when viewing that /jobs page.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403838", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: html form: redirect page after form completes submit function and posts data My form looks like the following, it's inside functions.php\n<form style=\"text-align: center;\" action=\"https://website/checkout/\" method=\"POST\" onsubmit=\"return redirect_checkout()\">\n    <div style=\"position:relative; right: 107px\">Where should we send it to? (postcode)<span style=\"color: red\"> *</span></div>\n    <input type=\"text\" class=\"form-text\" size=\"70\" name=\"where\" id=\"where\" />\n    <input type=\"submit\" class=\"elementor-button elementor-size-sm\" id=\"searchsubmit\" name=\"searchsubmit\" value=\"PROCEED TO CHECKOUT\" />\n</div>\n</form>\n<script type=\"text/javascript\">\nfunction redirect_checkout(){\n        <?php\n        $user = wp_get_current_user();\n        $id = $user->ID;\n        update_user_meta( $id, \"shipping_postcode\", $_POST['where'] );\n        ?>\n        window.location.href = \"https://website.com/checkout\";\n        return true;\n    }\n</script>\n\nThe problem is that the function redirect_checkout doesn't seem to run if I call action->redirect in the form fields, and the form doesn't redirect if I rely on window.location.href in the function. How can I get the form to redirect only after it runs the php code inside redirect_checkout()?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403839", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display All Courses in Course Archive Page I am Developing Course Management Website.\nI have main post type Course, under Course I have different taxonomies like Institution, Location, Course Type and etc..\nThe problem is, if one Course selected to particular Institution that post displaying, but I need to display that particular Course again with different Institution, if I select different Institution.\nHow would I do that? This is my Course archive page code,\n<div class=\"container\">\n<div class=\"row\">\n<?php\n$argsCourse = array(\n'posts_per_page' => '-1',\n'post_type' => 'course', \n'orderby'=> 'menu_order', \n);\n?>\n<?php\n$mycourse_query = null;\n$mycourse_query = new WP_Query($argsCourse);            \nif( $mycourse_query->have_posts() ) {\nwhile ($mycourse_query->have_posts()) : $mycourse_query->the_post();\n$Maincoursetypes = get_the_terms( $post->ID, 'course-type' );\n$Maincourselocations = get_the_terms( $post->ID, 'location' );\n$Maincourseinstitutions = get_the_terms( $post->ID, 'institution' );\n?>\n<div class=\"col-md-4\">\n<div class=\"fv-locataion-type\">\n<div class=\"fv-locataion-item-img\">\n<a href=\"<?php the_permalink(); ?>\" aria-label=\"Blog Image\">\n<?php if ( has_post_thumbnail() ) {\nthe_post_thumbnail();\n} else { ?>\n<img src=\"<?php bloginfo('template_url'); ?>/assets/images/blog-placeholder.jpg\"\nalt=\"<?php the_title(); ?>\" />\n<?php } ?>\n</a>\n<?php if('yes' == get_field(\"featured\")) :?>\n<div class=\"fv-locataion-tag\">\n<?php echo \"POPULAR COURSE\"; ?>\n</div>\n<?php endif;?>\n</div>\n<div class=\"fv-ltag\"><?php the_title(); ?></div>\n<p class=\"sub-course\">Fashion Design &amp; Technology</p>\n\n<div class=\"fv-filter-icon-wrap\">\n <?php if($Maincourseinstitutions){?>  \n     <?php foreach ( $Maincourseinstitutions as $Maincourseinstitution)\n $image = get_field('institution_logo', $Maincourseinstitution);\n {?> \n<img src=\"<?php echo $image?>\" alt=\"\">\n<?php }\n}else{\necho \"<img src='https://develop.stanventures.com/fv/wp-content/uploads/2022/03/ina.png' height='100%' width='110' />\";}?>\n<p><?php echo $Maincourseinstitution-> name;?></p>\n</div>\n<ul class=\"c-list\">\n<li><i class=\"uil uil-check-square\"></i> Collaboration: <?php the_field(\"collaboration\");?></li>\n<li><i class=\"uil uil-clock\"></i> Duration: <?php the_field(\"course_duration\");?></li>\n\n<?php if($Maincourselocations){?>\n <?php foreach($Maincourselocations as $Maincourselocation) {?>  \n<li><i class=\"uil uil-map-marker\"></i> <?php echo $Maincourselocation->name;?></li>\n<?php } }\nelse{echo\"<p>Location not Specified</p>\";}\n?>\n</ul>\n<div class=\"fv-link-wrap\">\n<a href=\"<?php the_permalink(); ?>\" class=\"btn btn-primary fv-btn\">\n<span>View Courses</span></a>\n</div>\n</div>\n</div>\n<?php  endwhile;\n}wp_reset_query();  // Restore global post data stomped by the_post().\n?>\n</div>\n</div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403844", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Available widgets is not showing up? \nI have added theme support in functions.php file.\nadd_theme_support('widgets');\n\nAnd register the menu still no available default widget.\n\n\nclass Sidebars{\n    public function __construct(){\n        $this->setup_hooks();\n    }\n\n    protected function setup_hooks(){\n        add_action('widgets_init', [$this, 'register_sidebars']);\n    }\n\n    public function register_sidebars(){\n        register_sidebar( array(\n            'name'          => __( 'Main Sidebar', 'textdomain' ),\n            'id'            => 'sidebar-1',\n            'description'   => __( 'Widgets in this area will be shown on all posts and pages.', 'textdomain' ),\n            'before_widget' => '<li id=\"%1$s\" class=\"widget %2$s\">',\n            'after_widget'  => '</li>',\n            'before_title'  => '<h2 class=\"widgettitle\">',\n            'after_title'   => '</h2>',\n        ) );\n\n    }\n}\n\n$sidebar = new Sidebars();\n\nHere is my full code\nI am not an expert but there suppose to have an option of available widgets.\nWhat am I missing?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403846", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Taxonomy and Page Slug Same \n*\n\n*I set Taxonomy and Page slug same\n\n*On the Page, I call Taxonomy's all Categories, Page slug Works Correctly with the same taxonomy slug.\n\n*But When I Click on a single category from the page, it shows a 404 Error.\n\n*When I set the Taxonomy and page slug differently, the single category slug worked\nwell. But Page Slug goes hidden from URL and shows taxonomy-slug/cat for instance.\n\nTaxonomy Slug: abc.com/destination (Not Working)\nPage: abc.com/world-tour\ncategory: abc.com/destination/category-one\nI Required: abc.com/world-tour/category-one (for SEO-friendly)\nIf I set page slug also /destination then destination/category-one page not be worked.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403847", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp_insert_user() function password never match I am trying to use wp_insert_user() to add a user from the custom registration form.\nThe user gets added to the database with a hashed password, but when the user is logged out and tries to use another custom login form to log in the password never matches.\nHere is the code to add the user:\n$userdata = array(\n    'user_login' =>  $username,\n    'user_email' =>  $email,\n    'user_pass'  =>  $password,\n    'first_name' =>  $fname,\n    'last_name'  =>  $lname,\n    'show_admin_bar_front' => false\n);\n\nFor login:\n$info = array();\n$info['user_login'] = $username;\n$info['user_password'] = $values['password'];\n$info['remember'] = true;\n$user = get_user_by( 'email', $values['email'] );\nif(isset($values['email'])){\n    if ( $user && wp_check_password( $values['password'], $user->data->user_pass, $user->ID ) ) {\n        $exists = email_exists( $values['email'] );\n        if ( $exists ) {\n            $user_signon = wp_signon( $info, false );\n            if ( !is_wp_error($user_signon) ){\n                wp_set_current_user($user_signon->ID);\n                wp_set_auth_cookie($user_signon->ID);\n                wp_send_json(array(  // send JSON back\n                  'loggedin' => true,\n                  'message' => __('Login successful, redirecting...')\n                ));\n            }\n        } else {\n            wp_send_json(array(  // send JSON back\n              'loggedin' => false,\n              'message' => __('Email dont exist')\n            ));\n        }   \n    } else {\n        wp_send_json(array(  // send JSON back\n          'message' => __( 'Email or password didnt match', 'diasporarestart-gd' ),\n          'data'    => $values['password']\n        ));\n    }\n}\n\nP.S I confirm that my user exist. Wordpress just cant validate the password.\nRegards,\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403848", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is there a way to migrate my wordpress blog to another website that uses a different domain? I'm currently running a blog page for our company that utilizes Wordpress.\nThe blog was created after we finished working on our official company website, which utilizes a different domain.\nHere's the situation summed up:\n\n*\n\n*Blog created through Wordpress, using the domain name.blog\n\n*Company website created by developers (Google Cloud), using the domain named.do\nWe were hoping if there is a way to migrate our blog (name.blog) to our main company website (name.do) as a subdomain/subdirectory (e.g. name.do/blog).\nExtra notes:\n\n*\n\n*I didn't set up any third-party hosting services when creating this wordpress site. Till this day, I'm not aware of any hosting services that I'm using for the blog.\n\n*Our company website is hosted on Google Cloud, and is generally managed by our software developers\n\nAny comments or help would be greatly appreciated!\nThanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403849", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress page for one specific page on Google Cloud hosted website? I was wondering if it was possible to create a subpage within a Google Cloud hosted website, and install Wordpress on that subpage ONLY, so that I can manage this subpage on Wordpress without having to touch anything else.\nOur company website is hosted by Google Cloud, and was created by developers.\nWe want to start a blog, but since coding it from scratch takes a lot of work, we want to see if we can apply wordpress to just the blog page that is within the company website, so we can create and edit that subpage (or even better, subdomain/subdirectory) on Wordpress.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403851", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Fresh Install Errors (Woocommerce specifically now) I have switched to cPanel on 2 of my servers, and it's been a nightmare so far. I used a program called WordPress toolkit, and everything was basically on defaults, except for adding some good passwords, and install was smooth, and fast as butter.\nCentOS 7 and PHP version 7.4.x\nI install plugins, and most work, but when I get to activate Woocommerce, the site says critical error, and only Rm RF or Filezilla can be called in to remove the Woocommerce plugin.\nThis is a fresh, untouched installation, and I have no idea what I could be doing wrong (except using cPanel instead of Virtualmin)\nThanks if anyone knows how or why this can occur, or where I should check my logs with CentOS 7 / cPanel etc\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403854", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom image sizes showing in Classic Editor only when upladed directly to post I can't get custom image sizes to appear in Image details size selector unless the image is uploaded directly in the post. If you choose an image from the Media library only default image sizes are shown. I've regenerated the thumbnails and checked in the Uploads folder and the appropriate files exist.\nMy code for this is:\nadd_action( 'after_setup_theme', 'my_custom_image_sizes' );\n\nfunction my_custom_image_sizes() {\n  if ( function_exists( 'add_image_size' ) ) {\n    add_image_size( 'post30', 312, 9999 );\n    add_image_size( 'post50', 520, 9999 );\n  }\n}\n\nadd_filter( 'image_size_names_choose', 'wpb_custom_image_sizes' );\n\nfunction wpb_custom_image_sizes( $size_names ) {\n  return array_merge( $size_names, array(\n      'post30' => __('Posts 30%'),\n      'post50' => __('Posts 50%'),\n  ) );\n}\n\nWhat am I doing wrong?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403856", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add screen reader text to links inserted in the block editor? Background\nWhen user adds a link to a paragraph block (or some other richtext block where links can be added) and sets the Open in new window flag, the block editor produces the following markup.\n<p>\n  This is a text paragraph, which has <a href=\"#\" target=\"_blank\">an external link</a> in it.\n</p>\n\nTo my understanding WCAG 2.0 criterion recommends adding a warning text to links that have the target=\"_blank\" attribute. So the end result should be something like this,\n<p>\n  This is a text paragraph, which has <a href=\"#\" target=\"_blank\">an external link<span class=\"screen-reader-text show-on-hover\">(opens in new window)</span></a> in it.\n</p>\n\nPossible solutions\nI know that one can use blocks.getSaveElement filter to modify the block save output, but I'm afraid that I might have to duplicate and re-implement a lot of code, as noted here, if I mess with the HTML output of the default blocks.\nThen there's the wp.element.cloneElement method, but I don't quite understand how can I detect all the a[target=\"_blank\"] elements with it and append the screen reader text spans to the found links.\nUsing render_block or the_content PHP filters, to detect the links and append HTML to them, seems a bit wasteful to me as the same processing would be done over and over again on every page load instead of adding the screen reader text just once for each link. The same goes with frontend js solutions.\nI experimented with registerFormatType to add a span tag to a selected link and it somewhat worked. I noticed that, if only the link element is selected, the span would end up inside the a tag - which is what I wanted.\nBut if there was even one empty space, before or after, selected along the link, then the whole a tag would get wraped inside the span - not ideal considering that the not-so-techinal content editor should be able to this without errors.\nQuestion\nHow can I append a screen reader text span to a link in block editor, when the \"Open in new window\" flag is activated?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403858", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Using the  component outside the editor. select('core') is null I am using the WordPress components in the admin panel of my plugin and trying to make an image upload button. The button works fine and allows me to select an image, but when I select an image, I get a error in the console::\n\nAn error occurred while running 'mapSelect': Cannot read properties of\nnull (reading 'getMedia') The error may be correlated with this\nprevious error: TypeError: Cannot read properties of null (reading\n'getMedia')\n\nMy component:\nimport { useSelect } from '@wordpress/data';\nimport { MediaUpload } from '@wordpress/media-utils';\nimport { Button, ResponsiveWrapper } from '@wordpress/components';\n\nexport default ({ onSelect, id }: { onSelect: (id: number) => void; id?: number }) => {\n  const media = useSelect(\n    (select) => {\n      return id ? select('core').getMedia(id) : undefined;\n    },\n    [id]\n  );\n\n  const onSelectMedia = (selectedMedia) => {\n    onSelect(selectedMedia.id);\n  };\n\n  return (\n      <MediaUpload\n        onSelect={onSelectMedia}\n        allowedTypes={['image']}\n        value={id}\n        render={({ open }) => (\n          <Button onClick={open} variant=\"secondary\">\n            {!id && 'Select image'}\n            {media && (\n              <ResponsiveWrapper naturalWidth={media.media_details.width} naturalHeight={media.media_details.height}>\n                <img src={media.source_url} alt={media.alt} />\n              </ResponsiveWrapper>\n            )}\n          </Button>\n        )}\n      />\n  );\n};\n\nconsole.log(select('core')) in useSelect returns null.\nWhat can I do to make retrieving the image information work?\nSimilar code in the Gutenberg editor works...\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403859", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: get_query_var('paged') for WP_Comment_Query always return 1 when using paginate_comments_links() I'm having a problem getting 'paged' query_var for my comments section in CPT post.\nI'm using this code to query comments:\n// Comments per page\n$comments_per_page = get_option('comments_per_page');\n\n// Paged variable\n$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n\nvar_dump($paged); // This ALWAYS returns 1\n\n$args = array(\n    'status' => 'approve',\n    'post_id' => $post->ID,\n    'paged' => $paged,\n    'number' => $comments_per_page,\n);\n\n// The comment Query\n$comments_query = new WP_Comment_Query;\n$comments = $comments_query->query( $args );\n\nThen I call WordPress' core function to render pagination links\npaginate_comments_links();\n\nEverything seems to be working. When I change the paged argument inside the query manually to let's say 2, then the correct comments are fetched.\nI'm sure the problem is in this line of code, since it ALWAYS return 1:\n$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n\nThe URL looks like this when I click in the pagination http://wordpress.test/diary-post/testing-diary-5/comment-page-2/\nThe /comment-page-{x}) is added by the pagination.\nI've been already thinking of trying to extract the number from URL by parsing it, but that seems VERY WRONG. I'm pretty sure there is some part I'm blatantly missing\nAny help much appreciated.\n\nA: \nI'm sure the problem is in this line of code, since it ALWAYS return\n1:\n$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n\n\nYes, that's correct.\nAnd to retrieve the page number of the current comments page, where the URL contains the /comment-page-<number>, use get_query_var( 'cpage' ) and not get_query_var( 'paged' ), i.e. the query var name is cpage and not paged.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403860", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: extend HierarchicalTermSelector function with custom renderTerms I want to hook into the editor.PostTaxonomyType filter and instead of HierarchicalTermSelector call my extended version that will render SelectControl instead of checkboxes.\nI found an old StackExchange thread doing what I wanted to do, but at that times HierarchicalTermSelector was a class, not a function. Is it still possible to extend the function in React rewriting just a part of it? My knowledge of React is a bit limited, but I guess the only way to get out of it is to copy the whole function and change it?\nThanks a lot!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403862", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Sql formatting for post data within function I'm calling a function through ajax in my site, and within the function that's being hit I'm taking the data (in this case it's a search term) and putting it into LIKE statements in sql:\n$searchkeyword = '';\n$prefix_post = $wpdb->prefix. \"posts\";\n\nif($_POST['search'] != ''){\n    \n    //get search term from request\n    $search = $_POST['search'];\n    \n    //build sql condition\n    $searchkeyword = \" AND ((($prefix_post.post_title LIKE '%$search%') OR ($prefix_post.post_content LIKE '%$search%') ))\";\n\n    $mysql = $wpdb->prepare(\"SELECT * FROM TEST_TABLE WHERE USER = 123 $searchkeyword \");\n    print_r($mysql);\n    die;\n}\n\nI noticed it was hanging up when trying to get results so I added the print for the sql alone and noticed it was printing this for the AND conditions:\nAND (( ( wp_posts.post_title LIKE\n'{a19f0a6c3d866f7270be0f3954cbb2600270400c15f488e112449a8a131701f0}test{a19f0a6c3d866f7270be0f3954cbb2600270400c15f488e112449a8a131701f0}'\n)\n OR ( wp_posts.post_content LIKE\n'{a19f0a6c3d866f7270be0f3954cbb2600270400c15f488e112449a8a131701f0}test{a19f0a6c3d866f7270be0f3954cbb2600270400c15f488e112449a8a131701f0}'\n    )\n\nWhy isn't it just showing wp_posts.post_content LIKE 'test'?\nUpdate:\n            $search = $_POST['search'];\n            $wild = '%';\n            $like = $wild . $wpdb->esc_like( $search ) . $wild;\n            \n            $sql  = $wpdb->prepare( \"\n                SELECT $prefix_post.ID \n                FROM $prefix_post \n                WHERE (((($prefix_post.post_title LIKE %s) \n                    OR ($prefix_post.post_excerpt LIKE %s) \n                    OR ($prefix_post.post_content LIKE %s)))\n                \", $like );\n            \n            print_r($sql);die;\n\n\nA: It isn't showing wp_posts.post_content LIKE '%test%' because the wildcards (%) in the prepared statement are converted to placeholder escape strings (like the {a19f0a6c3d866f7270be0f3954cbb2600270400c15f488e112449a8a131701f0} in your post) when wpdb::prepare() calls wpdb::add_placeholder_escape() which \"Adds a placeholder escape string, to escape anything that resembles a printf() placeholder\", i.e. a placeholder like %s.\nBut those placeholder escape strings will be changed back to % when the statement is passed to MySQL, so there's no need to worry about those escape strings.\nAdditionally, make sure to use the correct prepare() syntax \u2014 there should be at least one placeholder and a substitution argument (for that placeholder) like so: $wpdb->prepare( \"SELECT * FROM foo WHERE bar = %s\", 'bar value' ).\nAlso, you should apply wpdb::esc_like() on the $search value to ensure % in the value are properly escaped.\nAnd you might also want to check out my recent answer here because (I thought) the question there seemed quite similar to your question..\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403865", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Block Theme: Customize meta viewport I am building a custom Block theme and I need to have this meta viewport in my <head> :\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\" />\nBut I couldn't find a hook to customize the default meta viewport outputted in the head :\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\nThe output is coming from this file wp-includes/block-template.php at line 106 :\n// Add viewport meta tag.\nadd_action( 'wp_head', '_block_template_viewport_meta_tag', 0 );\n\nI tried to remove the action with remove_action somewhere in my theme functions, but without success.\nIs this possible via PHP?\nIf not I guess I'll have to do it with Javascript (replace the DOM element).\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403871", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: What permalinks do I use in the redirection I had the default permalink, but then read somewhere, that I should change it to post name. I think the default was in date and month and was https://webyardcraft.com/2022/03/14/sample-post/ I changed it to post name, which is now https://webyardcraft.com/sample-post/\nBut now since I did that, I do not have any traffic, so I used the redirection plugin, and put source url as https://webyardcraft.com/2022/03/14/sample-post. And the target url as https://webyardcraft.com/sample-post/\nIs this correct. I also think that I changed one of the page urls some time ago, but can't remember what it was.\nI have lost all my traffic, since doing these changes.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403872", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to give users a fixed gallery of avatars to choose from? I have the exact same question as the gentleman who started this thread a year ago: https://wordpress.org/support/topic/possible-to-give-users-a-gallery-of-avatars-to-choose-from/ \u2014 that is, \u201cI\u2019m looking for a way to give users a limited number of avatars to choose from. More specifically,\n\u2013 I want to disable Gravatar\n\u2013 I do NOT want them to be able to upload an avatar\n\u2013 I do NOT want to have one single default avatar that everyone gets with no choice\n\u2013 I want to provide them with a set/gallery of fantasy character portraits from which they can pick their avatar\u201d\nI tried the plugin suggested by in the reply (the plugin called Simple Local Avatars) and I don\u2019t see how it enables the admin to create a set of local avatars to choose from. It seems to allow only two options: user selects an existing file in the media library (which includes everything I\u2019ve ever uploaded, rather than only 4 or 5 specific avatar images) OR display a default image.\nDoes anyone have any experience using this OR any other avatar plugin that could help me achieve the desired result? Or, alternatively, does someone have a function they could share? Thank you!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403874", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress: Highlight search result exact matches found this neat code to highlight search terms. My problem with the code is that it does not prioritize exact matches and it highlights words within other words.\nSo searching for \"in my hometown\" would also highlight \"the tool was invented years ago\".\nSo two questions:\n\n*\n\n*How do I make sure that it only finds exact matches?\n\n*How do I let the tool try to find and exact match first, and if not found try to find individual strings?\n\nThanks a lot!\nHere the code:\n# Highlight query in search results\n\nfunction generate_excerpt($text, $query, $length) {\n\n$words = explode(' ', $text);\n$total_words = count($words);\n\nif ($total_words > $length) {\n\n    $queryLow = array_map('strtolower', $query);\n    $wordsLow = array_map('strtolower', $words); \n\n    $posFound = False;\n    for ($i=0; $i <= $total_words; $i++) {\n\n        foreach ($queryLow as $queryItem) {\n            $searchquery = \"/\\b$queryItem\\b/\";\n            if (preg_match($searchquery, $wordsLow[$i])) {\n                $posFound = $i;\n                break;\n            }\n        }\n\n        if ($posFound) {\n            break;\n        }\n    }\n\n    if ($i > ($length+($length/2))) {\n        $i = $i - ($length/2);\n    } else {\n  $i = 0;\n}\n\n}\n\n$cutword = array_splice($words,$i,$length);\n$excerpt = implode(' ', $cutword);\n\n$keys = implode('|', $query);\n$excerpt = preg_replace('/(' . $keys .')/iu', '<strong class=\"tx-indexedsearch-redMarkup\">\\0</strong>', $excerpt);\n$excerptRet = '<p>';\nif ($i !== 0) {\n$excerptRet .= '... ';\n}\n$excerptRet .= $excerpt . ' ...</p>';\n\nreturn $excerptRet;\n\n}\n\nfunction search_excerpt_highlight() {\n\n# Length in word count\n$excerptLength = 50;\n\n$rawtext = wp_strip_all_tags( get_the_content() );\n$text = preg_replace('#\\[.*\\]#','',$rawtext);\n\n# Filter double quotes from query. They will\n# work on the results side but won't help with\n# text highlighting and displaying.\n$term = get_term_by( 'slug', get_query_var( 'term' ), get_query_var( 'taxonomy' ) );\n$term = get_queried_object();\n\n$query=get_search_query(false);\n$query=str_replace('\"','',$query);\n$query=esc_html($query);\n$query=preg_replace('#\\[.*\\]#','',$query);\n\n$query = explode(' ', $term->name );\n\necho generate_excerpt($text, $query, $excerptLength);\n\n}\n\nFound the code here: https://blog.project-insanity.org/2020/07/27/custom-excerpts-in-wordpress-search-highlighting-query-keywords/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403875", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom Meta box change size I a plugin that I have made (SNUP Widget) there is a strange error.\nWhen I use widescreen monitor this custom meta box I made looks ok.\nBut with I open browser on my PC with split screen that is not widescreen then the metabox size is showing up strange.See the screendump.\n\n\nHere is the code for the metabox:\n\nfunction snup_add_meta_box(){\n    add_meta_box (\n        'snup_id', //id\n        'Show Next Upcoming Post', //title\n        'snup_callback', //callback\n        'post', //screen\n        'normal', //context\n        'default', //priority\n\n    );\n}\nadd_action('add_meta_boxes', 'snup_add_meta_box');\n\n\nfunction snup_callback($post){ \n    wp_nonce_field('snup_meta_box', 'snup_meta_box_nonce');\n\n$snuptext = get_post_meta($post->ID, 'snuptext', true);\n$label1=__('Please type the teaser text here','snup-lang');\n$label2=__('Max 100 characters.', 'snup-lang');\n\n?>\n    <p>\n    <label><b><?php echo esc_html_e($label1);?></b></label><br>\n    <label><?php echo esc_html_e($label2);?></label><br>\n    <textarea style=\"resize:none\" name=\"snuptext\" rows=\"3\" cols=\"100%\" maxlength=\"100\"><?php echo esc_textarea($snuptext);?></textarea>\n    </p>\n\n\n\nA: \nall you need to do is cols=\"40\", any size you want.\nI am not sure if WordPress provides class for this but you can also use inline CSS style=\"width: 100%; box-sizing:border-box; -moz-box-sizing:border-box;\" or add this CSS to admin style.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403876", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sending a post request with JSON content type I'm trying to send a post request to a locally hosted app that generates critical CSS. Here is the code I'm using.\n$url = 'http://localhost:4000/';\n$urls->urls = 'https://www.domain.com';\n$data = wp_remote_post($url, array(\n    'headers'     => array('Content-Type' => 'application/json; charset=utf-8'),\n    'body'        => json_encode($urls),\n    'method'      => 'POST',\n    'data_format' => 'body',\n));\n\nIt returns this error: SyntaxError: Unexpected token u in JSON at position 0.\nHere is a working example in Postman. Any idea on why my code isn't working?\n\n\nA: Here is a working example:\n$body = [\n    'foo' => 'value1',\n    'bar' => 'value2'\n];\n\n$response = wp_remote_post('http://example.com', [\n    'data_format' => 'body',\n    'headers' => [\n        'Accept' => 'application/json',\n        'Content-Type' => 'application/json'\n    ],\n    'body' => json_encode($body),\n]);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403877", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Link to downloadable excel sheet on website leads to unfinished version of document I am trying to replace a link in one of my pages under \"course Doc URL\". When I do, though, it opens an unfinished version of the document. But, when I put the same link into Google, the link comes up perfectly fine. Not sure how to fix this.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403878", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to hide list from custom post type Is there any way to hide post list from custom post type that I have created. Your answer would be really help.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403880", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom post type and multi taxonomies + customize url I have a custom post types course and two taxonomies type and location\nsample:\nType\n\n*\n\n*Math\n\n*\n\n*Pure Math\n\n*Applied math\n\n*...\n\n\n\nLocation\n\n*\n\n*London\n\n*\n\n*Trafalgar\n\n*Leicester\n\n*...\n\n\n\nFor now I manage to show permalink like below:\nSingle course : domain.com/course/post-name \ntype : domain.com/course/type/math \nlocation : domain.com/course/location/london\n\nHere's some questions\n\n*\n\n*How to modify slug rewrite to show post type and taxonomies like this:\nSingle course : domain.com/course/post-name \ntype : domain.com/course/math/ \nlocation : domain.com/course/london/ \n\n\n*In some cases, I need to show combination of two taxonomies like this \nlocation and type: domain.com/course/london/math/ \nreturn page will show combination of London AND math\n\nis that possible ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403882", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to keep plugin (media-sync) running even the tab is closed? WP site is install with this plugin\nhttps://wordpress.org/plugins/media-sync/\nIt scans the upload directory for media files, then imports them into Media Libary.\nit works as expected when the tab is kept open. At the same time, I would like to turn off my computer right now.\nHow can we keep a plugin working when we close the tab in Wordpress?\nhere is the URL when the plugin is doing its job.\nhttps://example.com/wp-admin/upload.php?page=media-sync-page&scan_files=1\nThank you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403883", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: HTTP Error 406 always on site? Hello WordPress community,\nI am getting http 406 error in my website when ever I tried to change something in my site.\nit looks similar like this below line\nThis page isn\u2019t working\nIf the problem continues, contact the site owner.\nHTTP ERROR 406\n\nI tried this in htaccess but the result is same .\n<IfModule mod_security.c>\nSecFilterEngine Off\nSecFilterScanPOST Off\n</IfModule>\n\n# BEGIN WordPress\n# The directives (lines) between \"BEGIN WordPress\" and \"END WordPress\" are\n# dynamically generated, and should only be modified via WordPress filters.\n# Any changes to the directives between these markers will be overwritten.\n<IfModule mod_rewrite.c>\nRewriteEngine On\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /index.php [L]\n</IfModule>\n\n# END WordPress\n\nI have also disabled the mod security from the cpanel but the result is same.\nCan any one help me with this issue ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403884", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Code playground (like CodePen) inside WordPress? I've reached exhaustion in trying to find a solution to my problem. And the problem is that I want to display custom HTML/CSS snippets inside of my WordPress blog posts (e.g. be able to render them and let readers interact with them) without using an embed like CodePen or JSFiddle.\nLet's say I wanted to add an example of a grid container and then let users resize it directly inside the article itself.\nDoes anyone have any ideas or tips on how to achieve my desired result? I am honestly not opposed to paying for a premium plugin that does this if there is any. It's just that I want to avoid using embeds as much as possible.\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403886", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: The URL of images on my website changed after being set as featured image When I upload the image, it is https://www.mywebsite.com/wp-content/uploads/2022/03/image-name.jpg\nAfter I set it as a featured image, it is like:\nhttps://www.mywebsite.com/wp-content/uploads/elementor/thumbs/image-name-pbpc1q6exttjkxpm1we8ytyicduwun0uk12ffhoguk.jpg\nWhy it doesn't show its original URL? Anyone can help?\nThank you.\n\nA: Did you install some plugin to handle the image process? it's probably coming from there.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403887", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Taxonomy Order by Name I created this shortcode to display my custom taxonomy terms:\nadd_shortcode( 'taxonomy_lists', 'wptls_taxonomy_lists' );\n\nfunction wptls_taxonomy_lists( $atts ) {\n    $atts = shortcode_atts( array(\n        'name' => 'category',\n        'hide_empty' => false,\n        'exclude' => '',\n        'include' => '',\n        'order' => 'ASC',\n        'orderby' => 'name',\n        'search_bar' => 0,\n        'show_count' => false,\n        'count_type' => 'terms'     \n    ), $atts);\n\n\n    $terms = get_terms( array(\n        'taxonomy' => $atts['name'],\n        'hide_empty' => filter_var( $atts['hide_empty'], FILTER_VALIDATE_BOOLEAN),\n        'orderby' => $atts['orderby'],\n        'order' => $atts['order'],\n        'parent'   => 0\n    ) );\n\n    $html = '';\n    if( $atts['search_bar'] == 1 )\n        $html .= wptls_search_filter();\n\n    $html .= '<div class=\"taxonomy-lists\" id=\"';\n    \n    $the_page = sanitize_post( $GLOBALS['wp_the_query']->get_queried_object() );\n    $slug = $the_page->post_name;\n    $html .= $slug;\n    $html .= '\">';\n\n    if ( ! empty( $terms ) && ! is_wp_error( $terms ) ){\n        foreach ( $terms as $term ) {\n            \n            if( !empty( $atts['exclude'] ) ) {\n                $exclude = explode( ',',$atts['exclude'] );\n                if( in_array( $term->term_id, $exclude) ) {\n                    continue;\n                }\n            }\n            \n            if( !empty( $atts['include'] ) ) {\n                $include = explode( ',',$atts['include'] );\n                if( !in_array( $term->term_id, $include) ) {\n                    continue;\n                }\n            }\n            \n            $image = '';\n            if( function_exists('get_woocommerce_term_meta') ) {\n                $thumbnail_id = get_woocommerce_term_meta( $term->term_id, 'thumbnail_id', true );\n                $image = wp_get_attachment_url( $thumbnail_id );\n            }\n                \n            $html .= '<div class=\"taxonomy-lists-item\" data-taxname=\"'.strtolower( $term->name ).'\">';\n            $term_link = get_term_link( $term );\n            \n            if( wptls_has_child_terms( $atts['name'],$term->term_id,$atts['hide_empty'] ) == true )\n                $html .= '<div class=\"tax-arrow\">\u25ba</div>';\n            \n            $child_terms = get_terms( array(\n                'taxonomy' => $atts['name'],\n                'hide_empty' => filter_var( $atts['hide_empty'], FILTER_VALIDATE_BOOLEAN),\n                'orderby' => $atts['orderby'],\n                'order' => $atts['order'],\n                'parent'   => $term->term_id\n            ) );\n\n            $html .= '<div class=\"tax-details\">\n                <div class=\"tax-name\">                \n                    <div class=\"tax-image\">\n                        <img src=\"'.$image.'\" width=\"50\">\n                    </div>\n                    \n                    <div class=\"tax-title\">\n                        <a href=\"' . esc_url( $term_link ) . '\" title=\"'.$term->description.'\">' . $term->name . '</a>\n                    </div>';\n\n            if( $atts['count_type'] == 'post' && filter_var( $atts['show_count'], FILTER_VALIDATE_BOOLEAN) == true ) {\n                $html .= '<div class=\"tax-child-count\">('. get_posts_count( $term ) .')</div>';\n            }\n                    \n            if( $atts['count_type'] == 'terms' && ( is_array( $child_terms ) && count( $child_terms ) > 0 && filter_var( $atts['show_count'], FILTER_VALIDATE_BOOLEAN) == true ) ) {\n                $html .= '<div class=\"tax-child-count\">('. count( $child_terms ) .')</div>';\n                \n            }\n\n            $html .= '</div>';\n            $html .= '<div class=\"tax-desc\">' . $term->description . '</div>\n                </div>';            \n            \n            if( !empty( $child_terms ) && is_array( $child_terms ) ) {\n                foreach ( $child_terms as $child_term ) {\n                    \n                    $image = '';\n                    if( function_exists('get_woocommerce_term_meta') ) {\n                        $thumbnail_id = get_woocommerce_term_meta( $child_term->term_id, 'thumbnail_id', true );\n                        $image = wp_get_attachment_url( $thumbnail_id );\n                    }\n                    \n                    $html .= '<div class=\"tax-child-list-item\">';\n                    $child_term_link = get_term_link( $child_term );\n                    $html .= '<div class=\"tax-name\">\n                            <div class=\"tax-image\"><img src=\"'.$image.'\" width=\"50\"></div><div class=\"tax-title\"><a href=\"' . esc_url( $child_term_link ) . '\" title=\"'.$child_term->description.'\">' . $child_term->name . '</a></div>';\n                    \n                    \n                    if( $atts['count_type'] == 'post' && filter_var( $atts['show_count'], FILTER_VALIDATE_BOOLEAN) == true ) {\n                        $html .= '<div class=\"tax-child-count\">('. get_posts_count( $child_term ) .')</div>';                        \n                    }\n\n                    $html .= '</div>';\n\n                    $html .= '<div class=\"tax-desc\">' . $child_term->description . '</div>';\n                    $html .= '</div>';\n                }\n            }\n            \n            $html .= '</div>';\n        }\n    }\n    \n    $html .= '</div>';\n    return $html;\n}\n\nI tried to order terms by name, but it doesn't work.\nI checked with other post about same issue, but I can't find a solution.\nCan anyone help me?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403889", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Save / Show multi line text in metabox In a plugin I have made (Snup Widget) I have made a metabox.\nIn the sample here I have made two line with text.\nWhen I want to show the text in output in the widget it shows in one line, without break.\nIf I write the text in two lines, and save the post.\nThe text have move into one line when I load / open the post editor again.\nWhy ?\n\n/*\n * ---------------------------------- *\n * Add Custom Text Field \n * ---------------------------------- *\n */\n\nfunction snup_add_meta_box(){\n    add_meta_box (\n        'snup_id', //id\n        'Show Next Upcoming Post', //title\n        'snup_callback', //callback\n        'post', //screen\n        'normal', //context\n        'default', //priority\n\n    );\n}\nadd_action('add_meta_boxes', 'snup_add_meta_box');\n\n\nfunction snup_callback($post){ \n    wp_nonce_field('snup_meta_box', 'snup_meta_box_nonce');\n\n$snuptext = get_post_meta($post->ID, 'snuptext', true);\n$label1=__('Please type the teaser text here','snup-lang');\n$label2=__('Max 100 characters.', 'snup-lang');\n\n?>\n    <p>\n    <label><b><?php echo esc_html_e($label1);?></b></label><br>\n    <label><?php echo esc_html_e($label2);?></label><br>\n    <textarea style=\"resize:none\" name=\"snuptext\" rows=\"3\" cols=\"100%\" maxlength=\"100\"><?php echo esc_textarea($snuptext);?></textarea>\n    </p>\n    \n\n<?php }\n\n\n/*\n * ---------------------------------- *\n * Save Custom Text Field \n * ---------------------------------- *\n */\n\n\nfunction snup_save_meta($post_id) {\n\n// Check if out nonce is set.\n\n    if ( ! isset( $_POST['snup_meta_box_nonce'] ) ) {\n        return;\n    }\n\n// Verify that the nonce is valid.\n\n    if ( ! wp_verify_nonce( $_POST['snup_meta_box_nonce'], 'snup_meta_box' ) ) {\n        return;\n    }\n\n\n// Make sure that it(input) is set.\n    if ( ! isset( $_POST['snuptext'] ) ) {\n        return;\n    }\n\n    \n    //Sanitize user input.\n    $snuptext = sanitize_text_field( $_POST['snuptext'] );\n\n\n    //Update the meta field in the databse.\n    update_post_meta( $post_id, 'snuptext', $snuptext );\n}\n\nadd_action( 'save_post', 'snup_save_meta' );\n\n\n/*\n * ---------------------------------- *\n * Show the info in SNUP\n * ---------------------------------- *\n */\nfunction snupwidget_upcoming_posts() { \n\n    $output = '';\n\n    // The query to fetch future posts\n    $the_query = new WP_Query(array( \n        'post_status' => 'future',\n        'posts_per_page' => 1,\n        'orderby' => 'date',\n        'order' => 'ASC'\n    ));\n \n\n// The loop to display posts\nif ( $the_query->have_posts() ) {\n    $output .='<ul>';\n    while ( $the_query->have_posts()) : $the_query-> the_post();\n        $output .= ''. get_the_post_thumbnail() .' <div class=\"snup_title\"> '. get_the_title() .' </div><div class=\"snup_text\"> '. get_post_meta( get_the_id(), 'snuptext', true ). ' </div><div class=\"snup_published\"> '. __('Published', 'snup-lang') . '</div><div class=\"snup_time\"> '.  get_the_time('d.m.Y H:i') .') </div>';\n    endwhile;\n    $output .='</ul>';\n\n} else {\n    // Show this when no future posts are found\n    $output .= '<div class=\"snup_noplan\"> '. __('No planed posts yet.', 'snup-lang') . '</div>';\n}\n// Reset post data\nwp_reset_postdata();\n \n// Return output\n \nreturn $output; \n}\n\n\n\nA: \nWhy ?\n\nYou are using sanitize_text_field() in the metabox save function. According to the code referensece it,\n\n\n*\n\n*Checks for invalid UTF-8,\n\n*Converts single < characters to entities\n\n*Strips all tags\n\n*Removes line breaks, tabs, and extra whitespace\n\n*Strips octets\n\n\nWhen saving textarea you want to use sanitize_textarea_field() instead.\n\nThe function is like sanitize_text_field(), but preserves new lines\n(\\n) and other whitespace, which are legitimate input in textarea\nelements.\n\nUPDATE\nFor fixing the output, you could do something like this. The key part here is str_replace(), which is used to replace the different types of linebreaks with <br> tags. If you want to have p tags also, you could consider using wpautop() instead.\nPlease don't mind that I took the liberty to format the output handling a bit.\nif ( ! $the_query->posts ) {\n  return sprintf(\n    '<div class=\"snup_noplan\">%s</div>',\n    esc_html__('No planned posts yet.', 'snup-lang')\n  );\n}\n\n$items = array();\nforeach ($the_query->posts as $post) {\n\n  $snuptext = get_post_meta( $post->ID, 'snuptext', true );\n  if ( $snuptext && is_string( $snuptext ) ) {\n    // turn linebreaks to <br>\n    // @source https://www.php.net/manual/en/function.nl2br.php#73440\n    $snuptext = str_replace(array(\"\\r\\n\", \"\\r\", \"\\n\"), \"<br />\", $snuptext);\n  } else {\n    $snuptext = '';\n  }\n  \n  $items[] = sprintf(\n    '<li>\n      %s\n      <div class=\"snup_title\">%s</div>\n      <div class=\"snup_text\">%s</div>\n      <div class=\"snup_published\">%s</div>\n      <div class=\"snup_time\">%s</div>\n    </li>',\n    get_the_post_thumbnail($post),\n    esc_html( $post->post_title ),\n    esc_html( $snuptext ),\n    esc_html__('Published', 'snup-lang'),\n    get_the_time('d.m.Y H:i', $post)\n  );\n}\n\nreturn sprintf('<ul>%s</ul>', implode('', $items));\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403890", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Adding a custom meta field with default NULL value which is not selectable Good morning,\nI have a jobboard which makes use of the plugin Wordpress Job Manager. I\u2019ve created some custom meta fields for job listings. One of those fields is a select field, where the user can select one option from a list. These are the functions which I used to add these fields.\nadd_filter( 'submit_job_form_fields', 'frontend_add_stageniveau_field' );\nfunction frontend_add_stageniveau_field( $fields ) {\n  $fields['job']['job_stageniveau'] = array(\n    'label'       => __( 'Opleiding', 'job_manager' ),\n    'type'        => 'select',\n    'required'    => true,\n    'options' => array('MBO' => 'MBO', 'HBO' => 'HBO', 'Universiteit' => 'Universiteit', 'Anders' => 'Anders'),\n    'placeholder' => '',\n    'priority'    => 7\n  );\n  return $fields;\n\nadd_filter( 'job_manager_job_listing_data_fields', 'admin_add_stageniveau_field' );\nfunction admin_add_stageniveau_field( $fields ) {\n  $fields['_job_stageniveau'] = array(\n    'label'       => __( 'Opleiding', 'job_manager' ),\n    'type'        => 'select',\n    'options' => array('MBO' => 'MBO', 'HBO' => 'HBO', 'Universiteit' => 'Universiteit', 'Anders' => 'Anders'),\n    'placeholder' => '',\n    'description' => ''\n  );\n  return $fields;\n}\n\nAfter adding these functions the default value of the field \u2018job_stageniveau\u2019 is MBO, since this is the first value in the list. How can I make sure that the default value is NULL, but also make sure that it\u2019s not possible for the user to save the form if the value of \u2018job_stageniveau\u2019 is still set to NULL.\nThanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403891", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: why my urdu text is not aligned properly when written in wordpress blog post? I was trying to write a blog post in urdu but the text got disorganized in the front end and also sentences were disorganized giving no meaning. I have installed a plugin for urdu font thinking that it might help solve the issue but it only bettered the font style. Issue remains there. Any guidance?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403892", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to render a time-of-day string like '16:42' with a site's chosen time format? I have a need to display a time-of-day value in a site's chosen time format.\nFor example I have 16:42:18 and want to display it as 4:42 PM if the time_format option is g:i A, or 16:42:18 if the time_format is H:i:s.\nI need this to render data captured by HTML5's <input type=\"time\"> form field.\nHow to do this?\n\nA: The trick here is using wp_date() in a peculiar way, giving it the time of day in seconds (as if it were 1970-01-01 16:42:18), then asking for it to be formatted in UTC.\n$time = '16:42:18';\nif ( preg_match( '/^\\d\\d:\\d\\d:\\d\\d$/', $time ) ) {    //validate the $time\n  $ts =  intval( substr( $time, 0, 2 ) ) * 3600;\n  $ts += intval( substr( $time, 3, 2 ) ) * 60;\n  $ts += intval( substr( $time, 7, 2 ) );\n  if ( $ts >= 0 && $ts < 86400 ) {\n     $time = wp_date( get_option( 'time_format' ), $ts, 'UTC' );\n  }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403894", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to add numeric slug for child page in WordPress 5.9? I am trying to configure WordPress 5.9 to allow numeric slugs for child pages. Drawing from the 2015 answer to a similar question I took the up-to-date code of wp_unique_post_slug, removed || preg_match( \"@^($wp_rewrite->pagination_base)?\\d+$@\", $slug ) and then added it as the following hook to my theme's functions.php. But for some reason, I just get a critical error: \"Allowed memory size exhausted\". What can I do to allow numeric slugs for child pages?\nadd_filter( 'wp_unique_post_slug', function ( $slug, $post_ID, $post_status, $post_type, $post_parent ) {\n    if ( in_array( $post_status, array( 'draft', 'pending', 'auto-draft' ), true )\n        || ( 'inherit' === $post_status && 'revision' === $post_type ) || 'user_request' === $post_type\n    ) {\n        return $slug;\n    }\n\n    /**\n     * Filters the post slug before it is generated to be unique.\n     *\n     * Returning a non-null value will short-circuit the\n     * unique slug generation, returning the passed value instead.\n     *\n     * @since 5.1.0\n     *\n     * @param string|null $override_slug Short-circuit return value.\n     * @param string      $slug          The desired slug (post_name).\n     * @param int         $post_ID       Post ID.\n     * @param string      $post_status   The post status.\n     * @param string      $post_type     Post type.\n     * @param int         $post_parent   Post parent ID.\n     */\n    $override_slug = apply_filters( 'pre_wp_unique_post_slug', null, $slug, $post_ID, $post_status, $post_type, $post_parent );\n    if ( null !== $override_slug ) {\n        return $override_slug;\n    }\n\n    global $wpdb, $wp_rewrite;\n\n    $original_slug = $slug;\n\n    $feeds = $wp_rewrite->feeds;\n    if ( ! is_array( $feeds ) ) {\n        $feeds = array();\n    }\n\n    if ( 'attachment' === $post_type ) {\n        // Attachment slugs must be unique across all types.\n        $check_sql       = \"SELECT post_name FROM $wpdb->posts WHERE post_name = %s AND ID != %d LIMIT 1\";\n        $post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $slug, $post_ID ) );\n\n        /**\n         * Filters whether the post slug would make a bad attachment slug.\n         *\n         * @since 3.1.0\n         *\n         * @param bool   $bad_slug Whether the slug would be bad as an attachment slug.\n         * @param string $slug     The post slug.\n         */\n        $is_bad_attachment_slug = apply_filters( 'wp_unique_post_slug_is_bad_attachment_slug', false, $slug );\n\n        if ( $post_name_check\n            || in_array( $slug, $feeds, true ) || 'embed' === $slug\n            || $is_bad_attachment_slug\n        ) {\n            $suffix = 2;\n            do {\n                $alt_post_name   = _truncate_post_slug( $slug, 200 - ( strlen( $suffix ) + 1 ) ) . \"-$suffix\";\n                $post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $alt_post_name, $post_ID ) );\n                $suffix++;\n            } while ( $post_name_check );\n            $slug = $alt_post_name;\n        }\n    } elseif ( is_post_type_hierarchical( $post_type ) ) {\n        if ( 'nav_menu_item' === $post_type ) {\n            return $slug;\n        }\n\n        /*\n         * Page slugs must be unique within their own trees. Pages are in a separate\n         * namespace than posts so page slugs are allowed to overlap post slugs.\n         */\n        $check_sql       = \"SELECT post_name FROM $wpdb->posts WHERE post_name = %s AND post_type IN ( %s, 'attachment' ) AND ID != %d AND post_parent = %d LIMIT 1\";\n        $post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $slug, $post_type, $post_ID, $post_parent ) );\n\n        /**\n         * Filters whether the post slug would make a bad hierarchical post slug.\n         *\n         * @since 3.1.0\n         *\n         * @param bool   $bad_slug    Whether the post slug would be bad in a hierarchical post context.\n         * @param string $slug        The post slug.\n         * @param string $post_type   Post type.\n         * @param int    $post_parent Post parent ID.\n         */\n        $is_bad_hierarchical_slug = apply_filters( 'wp_unique_post_slug_is_bad_hierarchical_slug', false, $slug, $post_type, $post_parent );\n\n        if ( $post_name_check\n            || in_array( $slug, $feeds, true ) || 'embed' === $slug\n            || $is_bad_hierarchical_slug\n        ) {\n            $suffix = 2;\n            do {\n                $alt_post_name   = _truncate_post_slug( $slug, 200 - ( strlen( $suffix ) + 1 ) ) . \"-$suffix\";\n                $post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $alt_post_name, $post_type, $post_ID, $post_parent ) );\n                $suffix++;\n            } while ( $post_name_check );\n            $slug = $alt_post_name;\n        }\n    } else {\n        // Post slugs must be unique across all posts.\n        $check_sql       = \"SELECT post_name FROM $wpdb->posts WHERE post_name = %s AND post_type = %s AND ID != %d LIMIT 1\";\n        $post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $slug, $post_type, $post_ID ) );\n\n        $post = get_post( $post_ID );\n\n        // Prevent new post slugs that could result in URLs that conflict with date archives.\n        $conflicts_with_date_archive = false;\n        if ( 'post' === $post_type && ( ! $post || $post->post_name !== $slug ) && preg_match( '/^[0-9]+$/', $slug ) ) {\n            $slug_num = (int) $slug;\n\n            if ( $slug_num ) {\n                $permastructs   = array_values( array_filter( explode( '/', get_option( 'permalink_structure' ) ) ) );\n                $postname_index = array_search( '%postname%', $permastructs, true );\n\n                /*\n                * Potential date clashes are as follows:\n                *\n                * - Any integer in the first permastruct position could be a year.\n                * - An integer between 1 and 12 that follows 'year' conflicts with 'monthnum'.\n                * - An integer between 1 and 31 that follows 'monthnum' conflicts with 'day'.\n                */\n                if ( 0 === $postname_index ||\n                    ( $postname_index && '%year%' === $permastructs[ $postname_index - 1 ] && 13 > $slug_num ) ||\n                    ( $postname_index && '%monthnum%' === $permastructs[ $postname_index - 1 ] && 32 > $slug_num )\n                ) {\n                    $conflicts_with_date_archive = true;\n                }\n            }\n        }\n\n        /**\n         * Filters whether the post slug would be bad as a flat slug.\n         *\n         * @since 3.1.0\n         *\n         * @param bool   $bad_slug  Whether the post slug would be bad as a flat slug.\n         * @param string $slug      The post slug.\n         * @param string $post_type Post type.\n         */\n        $is_bad_flat_slug = apply_filters( 'wp_unique_post_slug_is_bad_flat_slug', false, $slug, $post_type );\n\n        if ( $post_name_check\n            || in_array( $slug, $feeds, true ) || 'embed' === $slug\n            || $conflicts_with_date_archive\n            || $is_bad_flat_slug\n        ) {\n            $suffix = 2;\n            do {\n                $alt_post_name   = _truncate_post_slug( $slug, 200 - ( strlen( $suffix ) + 1 ) ) . \"-$suffix\";\n                $post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $alt_post_name, $post_type, $post_ID ) );\n                $suffix++;\n            } while ( $post_name_check );\n            $slug = $alt_post_name;\n        }\n    }\n\n    /**\n     * Filters the unique post slug.\n     *\n     * @since 3.3.0\n     *\n     * @param string $slug          The post slug.\n     * @param int    $post_ID       Post ID.\n     * @param string $post_status   The post status.\n     * @param string $post_type     Post type.\n     * @param int    $post_parent   Post parent ID\n     * @param string $original_slug The original post slug.\n     */\n    return apply_filters( 'wp_unique_post_slug', $slug, $post_ID, $post_status, $post_type, $post_parent, $original_slug );\n}, 10, 6 );\n\n\nA: Updated Answer \u2014 @Quasimodo confirmed that they're only interested in posts of the page type and that the numeric slugs are four-digit years, e.g. 2019.\n\nWhat can I do to allow numeric slugs for child pages?\n\nI would use the pre_wp_unique_post_slug hook that runs prior to wp_unique_post_slug, which means we'll be filtering the slug before a unique one is generated (by WordPress), and thus our callback must be able to generate a unique slug if necessary.\nHere's an example, tried and tested working with WordPress v5.9.3:\nadd_filter( 'pre_wp_unique_post_slug', 'my_pre_wp_unique_post_slug', 10, 6 );\nfunction my_pre_wp_unique_post_slug( $override_slug, $slug, $post_ID, $post_status, $post_type, $post_parent ) {\n    $allowed_post_status = array( 'publish', 'private' ); // allows numerical slug only for these statuses\n\n    if ( preg_match( '/^\\d{4}$/', $slug ) && $post_parent &&\n        'page' === $post_type && in_array( $post_status, $allowed_post_status )\n    ) {\n        return my_unique_page_slug( $slug, $post_ID, $post_type );\n    }\n\n    return $override_slug;\n}\n\n// This function is based on the code in the wp_unique_post_slug() function, lines\n// 5023-5054 in WordPress v5.9.3, except that $check_sql doesn't include the `AND post_parent = %d`,\n// which means we only want unique slug for each Page (i.e. post of type 'page').\nfunction my_unique_page_slug( $slug, $post_ID, $post_type = 'page' ) {\n    global $wpdb;\n\n    $check_sql       = \"SELECT post_name FROM $wpdb->posts WHERE post_name = %s AND post_type IN ( %s, 'attachment' ) AND ID != %d LIMIT 1\";\n    $post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $slug, $post_type, $post_ID ) );\n\n    if ( $post_name_check ) {\n        $suffix = 2;\n        do {\n            $alt_post_name   = _truncate_post_slug( $slug, 200 - ( strlen( $suffix ) + 1 ) ) . \"-$suffix\";\n            $post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $alt_post_name, $post_type, $post_ID ) );\n            $suffix++;\n        } while ( $post_name_check );\n        $slug = $alt_post_name;\n    }\n\n    return $slug;\n}\n\nPS: Just so that you know, the wp_unique_post_slug  hook could be used, but your callback would need to return or work on the value of $original_slug (last parameter from the hook) instead of $slug (first parameter from the hook).\nSo the above example would now let us use a number as the slug for child Pages (post type page), however, we still need to ensure the URL/permalink works as expected \u2014 because by default, example.com/page-slug/<number> is treated as a paginated request and thus WordPress will attempt to load page 2, 3, etc. of the Page with the slug page-slug.\n\n*\n\n*The above also explains why WordPress by default disallows number as a (post) slug.\n\nSo step 2 for you would be this \u2014 add a custom rewrite rule which ensures the permalink example.com/parent-slug/<number> loads the Page with the slug <number> and is child of parent-slug (or whatever the correct/actual slug is):\nadd_action( 'init', 'my_add_page_rewrite_rules' );\nfunction my_add_page_rewrite_rules() {\n    add_rewrite_rule(\n        '^(.+/\\d{4})(?:/(\\d+))?/?$',\n        'index.php?pagename=$matches[1]&page=$matches[2]',\n        'top' );\n}\n\nOr you can instead use the page_rewrite_rules hook:\nadd_filter( 'page_rewrite_rules', 'my_page_rewrite_rules' );\nfunction my_page_rewrite_rules( $page_rewrite ) {\n    return array(\n        '^(.+/\\d{4})(?:/(\\d+))?/?$' => 'index.php?pagename=$matches[1]&page=$matches[2]',\n    ) + $page_rewrite;\n}\n\nAnd remember, there's a step 3 \u2014 flush the rewrite rules by simply visiting wp-admin \u2192 Settings \u2192 Permalinks.\n\nAs for this:\n\nBut for some reason, I just get a critical error: \"Allowed memory size exhausted\".\n\nThat's because, as @birgire said in his comment, \"you're creating an infinite loop by re-applying the wp_unique_post_slug filter in the end of your callback\".\nSo whenever wp_unique_post_slug() got called (e.g. by wp_insert_post()),\n\n*\n\n*apply_filters() (in wp_unique_post_slug()) called your closure/callback\n\n*Your callback called apply_filters()\n\n*apply_filters() (in your callback) called your callback\n\n*Steps 2 & 3 were repeated over and over again...\n\nAnd eventually, PHP threw a fatal/critical error because your code consumed way too much memory.. :/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403900", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Filter products on category AND tag I want to be able to filter products based on category AND tag, as well as sub category AND tag. From my research I heard that I must write some kind of rewrite rule in functions.php for this to be possible - is that correct?\nCategory Base: category //\nTag Base: tag\nhey.com/category/soccer/tag/adidas\nhey.com/category/soccer/without-laces/tag/adidas\n__\n\nI've noticed that this works:\nhey.com/category/soccer/without-laces/?tag=adidas\nBut not this....\nhey.com/category/soccer/without-laces/tag/adidas\n\nA: You can define taxonomy with post type.\nCreate and display separate categories and tags with taxonomy.\nExample code:\nadd_action( 'init', 'artists' );\nfunction artists() {\nregister_post_type( 'artists',\n    array(\n        'labels' => array(\n            'name' => __( 'artists' ),\n            'singular_name' => __( 'artist' )\n        ),\n        'public' => true,\n        'has_archive' => true,\n        'rewrite' => array( 'slug' => 'artists' ),\n        'menu_icon' => 'dashicons-slides',\n        'supports' => array('title','thumbnail','editor', 'comments'),\n        // 'taxonomies' => array('category'),\n        'exclude_from_search' => false,\n    )\n    \n);\n\nregister_taxonomy(\n      'artists_cat',\n      'artists',\n      array(\n        'label'        => __( 'category' ),\n        'public' => true,\n        'rewrite'      => true,\n        'hierarchical' => false,\n        'capabilities' => array( 'edit_terms' => 'manage_categories' )\n      )\n    );\n\nregister_taxonomy_for_object_type( 'artists_cat', 'artists' );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403901", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Cannot change Wordpress site title on a staged site I staged my site from domain \"A\" to domain \"B\" so I can do a theme upgrade. Then my plan was to push it live back to domain \"A\" (Doing backups of the original live \"A\" domain of course\nI used the softaclous staging tool built into my cPanel hosting hosting provider. When I created the staged site I stupidly used a different name. Now within wordpress I cannot change the site title in general settings or customizer.\nWhen I change the site name is automatically switches back and wont save\nI have yoast installed. Any ideas?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403903", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce only display child category when parent is checked (on add new product page) On Woocommerce's Products --> Add New page, when I'm choosing categories, is it possible to only display child categories when their parent is checked? I was thinking about using some CSS to see if a checkbox is checked, and then set display: none to display: block. I could not do it this way, because WooCommerce uses the same classnames everywhere...\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403904", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Ignoring  links from the_excerpt I am looking for a way to ignore any <a> links in the content WP displays in the the_excerpt - is there a way I can achieve this?\nThe excerpt is not actually used on the WP page itself, so the main content area of the page is displayed - but I want to make sure any <a> links are not included. Is that possible?\nSo, what I am looking for is that if the excerpt was this:\n\nHello, this is the content currently included in the_excerpt, with <a><span>a link</span></a> here and some more content here....\n\nThen the output of the_excerpt would remove the full <a> element and so the excerpt would become:\n\nHello, this is the content currently included in the_excerpt, with here and some more content here....\n\nTo display the content, I am using:\n<p><?php the_excerpt(); ?></p>\n\nUpdate - The excerpt field is actually empty on the pages that i am referencing in the loop, so it defaults to pull the content from the main body area of the page. I guess this makes a difference to the code that might need to be applied here?\nThe custom theme code to pull page content if the_excerpt is empty is:\nif ( has_excerpt() ) {\n        $the_excerpt = get_the_excerpt();\n        $the_excerpt = preg_replace( '/\\[[^\\]]+\\]/', '', $the_excerpt );  // strip shortcodes, keep shortcode content\n        return wp_trim_words( $the_excerpt, $limit );\n    } else {\n        $the_content = get_the_content();\n        $the_content = preg_replace( '/\\[[^\\]]+\\]/', '', $the_content );  // strip shortcodes, keep shortcode content\n        return wp_trim_words( $the_content, $limit );\n    }\n}\n\n\nA: To strip the <a>...</a> tags from the output from the_excerpt(), you could use the the_excerpt filter and a regular expression search-and-replace.\nUpdated: In response to a comment, I've updated the code\u2014the regex specifically\u2014to strip out <a>...</a> and <a><span>...</a></span> constructions.\nUpdated again:  In response to another comment, I've updated the code to use the get_the_excerpt filter, as that should catch both explicitly-set excerpts and excerpts generated from the post content.\nadd_filter( 'get_the_excerpt', 'wpse403907_strip_a_tags' );\n/**\n * Strips <a> tags from the excerpt.\n *\n * @param  string $excerpt The excerpt.\n * @return string          The filtered excerpt.\n */\nfunction wpse403907_strip_a_tags( $excerpt ) {\n    $regex   = array(\n        '|<a[^>]*>[^<]+</a>|',\n        '|<a[^>]*><span[^>]*>[^<]+</span></a>|'\n    );\n    $excerpt = preg_replace( $regex, '', $excerpt );\n    return $excerpt;\n}\n\nAdd the above code to your active theme's functions.php file.\nThe regular expression\nIf you're unclear on what the regular expression (the 1st preg_replace() parameter, |<a[^>]*>[^<]+</a>|) does, here's a quick breakdown:\n\n*\n\n*| is the delimiter (the standard is to use / but since there's a / in the string I'm searching for, I've used a different character)\n\n*<a[^>]* searches for any string starting with <a and ending with >, eg, <a href=\"example.com\" title=\"This is some text\">.\n\n*[^<]+ searches for one or more characters that isn't <, ie, the opening of </a>.\n\n*</a> matches the end of the a tag.\n\n*| is the end delimiter.\n\nNote that if you've got any excerpts with other HTML tags inside the <a>...</a>, eg, ...<a href=\"example.com\">this link has <strong>bold text</strong> in it</a>..., this regex will not work correctly.\nReferences\n\n*\n\n*the_excerpt filter\n\n*get_the_excerpt filter\n\n*preg_replace()\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403907", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Rest API Paginate until all posts are imported So I wanted to see if someone might be able to help me with this, so below I will explain what I've done:\n\n*\n\n*I am using wp_remote_get to grab the posts from another website with the arguments page and per_page.\n\n\n*Next, I am checking to see if the post has already been imported using $current_post_id = post_exists($post->title->rendered); and if it does, don't call the wp_insert_post function.\nHere is what I have working already:\nIf I call the function, it will check those 100 posts on page 1 and check the titles and only import posts that are not matching.\nWhat I'm trying to achieve:\n\n*\n\n*Let's say that I have 402 posts, how do I dynamically loop through all the pages and then when it gets to the last page, reset back to the page 1?\n\nHere is the code:\npublic function get_posts_via_rest_api(): void\n{\n    if (!is_admin()) {\n        require_once(ABSPATH . 'wp-admin/includes/post.php');\n    }\n    $response = wp_remote_get(\n        add_query_arg( [\n            'page' => 1,\n            'per_page' => 100\n        ],\n            'https://www.website-posts-live-at.com/wp-json/wp/v2/posts')\n    );\n    if (is_wp_error($response)) {\n        return;\n    }\n    if ($response['response']['code'] === 200) {\n        try {\n            $posts = json_decode(\n                $response['body'],\n                false,\n                512,\n                JSON_THROW_ON_ERROR\n            );\n            if (empty($posts)) {\n                return;\n            }\n        } catch (Exception) {\n            error_log(\n                print_r(json_last_error(), true)\n            );\n            return;\n        }\n        foreach ($posts as $post) {\n            $current_post_id = post_exists($post->title->rendered);\n            if ($current_post_id === 0) {\n                $my_post = [\n                    'post_type'     => 'post',\n                    'post_status'   => 'pending',\n                    'post_title'    => wp_strip_all_tags($post->title->rendered),\n                    'post_content'  => wp_strip_all_tags($post->content->rendered),\n                    'post_excerpt'  => wp_strip_all_tags($post->excerpt->rendered),\n                    'post_author'   => 1\n                ];\n                $post_id = wp_insert_post($my_post);\n                wp_set_object_terms($post_id, 'Global', 'category');\n                wp_set_object_terms($post_id, 'Global', 'post_tag');\n            }\n        }\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403909", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: In a local wordpress installation, when I install a plugin it only offers me installation via FTP In a local wordpress installation, when I install a plugin it only offers me installation via FTP, even if I load the plugin .zip file from my pc. Why does this happen?\nI use Ubuntu linux and apache 2 as web server. Thank you.\n\nA: Enter the following code in the wp-config.php file:\nadd_filter(\u2018filesystem_method\u2019, create_function(\u2018$a\u2019, \u2018return \u201cdirect\u201d;\u2019 ));\n\ndefine( \u2018FS_CHMOD_DIR\u2019, 0755 );\n\nThis code deletes WordPress FTP information.\n\nA: Add the following statement to wp-config.php above \" * WordPress database table prefix.\"\ndefine('FS_METHOD', 'direct');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403911", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Uncaught TypeError: Cannot read properties of undefined (reading 'message') I wrote authentication for the entry and membership of wordpress.\nThe code I wrote is ajax.\nnot work Validation and redirect.\nBut he gives the following error:\nUncaught TypeError: Cannot read properties of undefined (reading 'message')\nat Object.error (auth.js?ver=1:74:54)\nat c (jquery.min.js?ver=1:2:28294)\nat Object.fireWith [as rejectWith] (jquery.min.js?ver=1:2:29039)\nat l (jquery.min.js?ver=1:2:79825)\nat XMLHttpRequest.<anonymous> (jquery.min.js?ver=1:2:82254)\n\nCodes:\njQuery(document).ready(function($) {\n\n$('#loginForm').on('submit', function(event){\n\n    event.preventDefault();\n    let user_email = $('#userEmail').val();\n    let user_password = $('#userPassword').val();\n    let notify = $('.alert');\n    $.ajax({\n        url: 'wp-admin/admin-ajax.php',\n        type: 'post',\n        dataType: 'json',\n        data: {\n            action: 'wp_auth_login',\n            user_email: user_email,\n            user_password: user_password\n        },\n        success: function (response){\n\n            if(response.success)\n            {\n                notify.removeClass('alert-danger').addClass('alert-success');\n                notify.append('<p>' + response.message + '</p>')\n                notify.show(300);\n                setTimeout(function(){\n                    window.location.href = '/';\n                }, 2000);\n            }\n        },\n        error: function (error){\n            if(error){\n                let message = error.responseJSON.message;\n                notify.addClass('alert-danger');\n                notify.append('<p>' + message + '</p>');\n                notify.css('display', 'block');\n                notify.delay(2000).hide(300);\n            }\n        }\n    });\n});\n\n$('#registerForm').on('submit', function(event){\n\n    event.preventDefault();\n    let first_name = $('#user_first_name').val();\n    let last_name = $('#user_last_name').val();\n    let user_email = $('#user_email').val();\n    let user_password = $('#user_password').val();\n    let notify = $('.alert');\n    $.ajax({\n        url: 'wp-admin/admin-ajax.php',\n        type: 'post',\n        dataType: 'json',\n        data: {\n            action: 'wp_auth_register',\n            user_first_name: first_name,\n            user_last_name: last_name,\n            user_email: user_email,\n            user_password: user_password\n        },\n        success: function (response){\n            if(response.success)\n            {\n                notify.removeClass('alert-danger').addClass('alert-success');\n                notify.append('<p>' + response.message + '</p>')\n                notify.show(300);\n                setTimeout(function(){\n                    window.location.href = 'wp-admin/profile';\n                }, 2000);\n            }\n        },\n        error: function (error){\n            if(error){\n                let message = error.responseJSON.message;\n                notify.addClass('alert-danger');\n                notify.append('<p>' + message + '</p>');\n                notify.css('display', 'block');\n                notify.delay(2000).hide(300);\n            }\n        }\n    });\n});\n\n});\nCalls:\nfunction wp_auth_load_file()\n{\n   wp_register_script('auth_script',get_template_directory_uri() . '/js/auth.js', \n   array('jquery'), true );\n   wp_enqueue_script('auth_script');\n}\nadd_action('wp_enqueue_scripts', 'wp_auth_load_file');\n\n\nA: That's sure from the undefined variable message. I suggest to log these variable response.message, error.responseJSON.message.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403913", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using Class loader in Wordpress boilerplate I'm using the Wordpress boilerplate to develop a plugin. At some point, I wanted to make dynamic functions with some external parameters when using $this->loader->add_action() so I used an anonymous function... but it doesn't work. So I resolved to bypass the loader and use the Wordpress standard add_action() and it works! But I know it's not good practice. How to pass an anonymous function through the loader? I'd like to know if any of you have a idea of how to implement this with the loader.\nWhat I tried\n$this->loader->add_action(\"views_edit-{$post_type}\", $plugin_admin, function($views) use ($plugin_admin, $post_type) { \n                return $plugin_admin->some_function($views, $post_type); \n            });\n\nThe error I get\n Your PHP code changes were rolled back due to an error on line 959 of file wp-includes/plugin.php. Please fix and try saving again.\n\nUncaught Error: Object of class Closure could not be converted to string in wp-includes/plugin.php:959\nStack trace:\n#0 wp-includes/class-wp-hook.php(74): _wp_filter_build_unique_id()\n#1 wp-includes/plugin.php(121): WP_Hook->add_filter()\n#2 wp-includes/plugin.php(399): add_filter()\n#3 wp-content/plugins/myplugin/includes/class-myplugin-loader.php(124): add_action()\n#4 wp-content/plugins/myplugin/includes/class-myplugin.php(266): MyPlugin_Loader->run()\n#5 wp-content/plugins/myplugin/myplugin.php(76): MyPlugin->run()\n#6 wp-content/plugins/myplugin/myplugin.php(79): run_myplugin()\n#7 wp-settings.php(418): include_once('/home/...')\n#8 wp-config.php(106): require_once('/home/...')\n#9 wp-load.php(50): require_once('/home/...')\n#10 wp-admin/admin.php(34): require_once('/home/...')\n#11 wp-admin/plugin-editor.php(10): require_once('/home/...')\n#12 {main}\n  thrown\n\nWhat I used instead by bypassing the loader (it works)\nadd_action(\"views_edit-{$post_type}\", function($views) use ($plugin_admin, $post_type) {\n            return $plugin_admin->some_function($views, $post_type); \n        });\n\n\nA: Thanks Paul, you led me to the solution.\nWhat I did\nIn class-mypluging-admin.php, I added this:\n/**\n * Additional arguments for this plugin.\n *\n * @since    1.0.0\n * @access   private\n * @var      array $args The current arguments of this plugin.\n */\nprivate $args;\n\n/**\n * Initialize the class and set its properties.\n *\n * @since    1.0.0\n * @param      string    $plugin_name       The name of this plugin.\n * @param      string    $version    The version of this plugin.\n * @param      array     $args  The additional arguments of this plugin.\n */\npublic function __construct( $plugin_name, $version, $args = null ) {\n\n    $this->plugin_name = $plugin_name;\n    $this->version = $version;\n    $this->args = $args;\n\n}\n\nThen for the functions in class-mypluging-admin.php\nfunction some_function( $views ) {\n    \n    $post_type = $this->args['post_type'];\n\n...\n\n}\n\nIn class-mypluging.php, I do this:\nforeach($post_types as $post_type)\n{\n    $args = array(\n        'post_type' => $post_type,\n    );\n    \n    $plugin_admin = new MyPlugin_Admin( $this->get_plugin_name(), $this->get_version(), $args );    \n\n$this->loader->add_action(\"views_edit-{$post_type}\", $plugin_admin, 'some_function');   \n\n}\n\nAnd it works! Is that the correct way to do this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403917", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding shortcode of \"Random Content\" Plugin in the post after the title I want to add shortcode content into each post after the heading of the post. Below is the code that I put at the end of the function.php but this add the shortcode content at the end of the post, Kindly help me.\nfunction my_shortcode_to_a_post( $content ) {\n global $post;\n if( ! $post instanceof WP_Post ) return $content;\n\n  switch( $post->post_type ) {\n   case 'post':\n    return $content . '[random_content]';\n   default:\n    return $content;\n  }\n}\n\nadd_filter( 'the_content', 'my_shortcode_to_a_post' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403918", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Make the home page template my archive/category page template without code duplication Exploring WordPress and bumped into this issue: In my theme root page-templates/home.php  which is a common page template used in multiple pages. Now I want to include the same template (with some minor query parameters changed) in my archive/category page. I know I can just copy and paste the whole home.php template to a category.php. But It feels like there is a better way to do it.\n[my home page showing the latest article at the top, 3 popular articles (by view count) in right side and at the bottom all the recent articles]\nSo my question is how can use the same template as the home and other pages in the category pages without code duplication??\nThe only code difference between home and category template is at the top of the category.php\n$archive_category = get_queried_object();\n$popular_posts = new WP_Query(\n    array( \n        'cat' => $archive_category->cat_ID, /* home page doesn't have this parameter (only difference) */\n\n        'meta_key' => 'wpb_post_views_count',\n        'posts_per_page' => _POPULAR_POST_LIMIT,\n        'orderby' => array(\n            'meta_value_num' => 'DESC',\n            'date' => 'DESC'\n        )\n    )\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403919", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to assign page id with array in page_scheduled_event How to assign multiple unique page ids with the below code -\ni have tried 'ID' => array('ID1, ID2, ID3), but not worked.\nadd_action( 'page_scheduled_event', 'publishhome' );\nfunction publishhome() { \n    $time = current_time('mysql');\n    $arg = array(\n        'ID' => 16696, //here\n        'post_date'     => $time,\n        'post_date_gmt' => get_gmt_from_date( $time ),\n        'post_status' => 'publish'\n    );\n    wp_update_post( $arg );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403920", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: List all files from subpages My goal is to list all the pages names as well as the \"attached files\" of these pages on a separate overview page in wordpress.\nI have 100 pages with each between 0 and 4 attached PDF files (linked inside the content, but could be uploaded as attachement to the page also).\nThe overview page should then list all these pages like this:\n- page name 1\n-- pdf file 1-1\n-- pdf file 1-2\n[..]\n- page name 2\n-- pdf file 2-1\n-- pdf file 2-2\n[..]\n\nand so on.\nWhat is the best way to achieve this? Can I collect these linked pdfs with \"get_attached_file()\"? or doesn't this work with pages? I'd like to prevent having to maintain the overview list manually.\nBonus question: Is there also a way to collect all the external links on these pages as well?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403921", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I hide a Gutenberg block when paginating I've created a homepage, using Gutenberg blocks which paginates my posts beautifully.\nI have a text block for SEO purposes that I only want to show on the first page (the homepage) and want to hide on all other pages e.g. /page/2 ... /page/n\nIs it possible to hide a Gutenberg block when $paged > 1 ? Is there a mechanism to do this please?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403923", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Properly loop through and paginate page on each function call Alright, I need some help and I don't know if I'm doing it the correct way, but I wanted to see if the community can guide me in a better direction.\nHere is what's going on:\n\n*\n\n*I have a register_rest_route() that calls the function (Not included in this code).\n\n\n*I make a call to grab the endpoint headers where it contains the total pages $headers['headers']['x-wp-totalpages'] which is 80.\n\n\n*I then loop through all the pages and call wp_remote_get to grab 25 posts from each page.\n\n\n*Next, I look through each post of the 25 posts and create posts on the new website.\nSome details:\nI have 795 posts on the website that contains all the data, when I run the current function it loops through all 795 posts and actually imports them, so it semi works, but there are bugs.\n\nWhat I'm trying to achieve:\nDoes anyone know how I can format this function so that my wp_remote_get() $page param get incremented only when I hit the endpoint up until $headers['headers']['x-wp-totalpages'] and then reset back to $page=1 and not use a for loop that automatically loops through all 80 pages on a single request?\n\nSo I have the following function:\npublic function get_posts_via_rest_api(): void\n    {\n        // Pull in post_exists method for endpoints.\n        if (!is_admin()) {\n            require_once(ABSPATH . 'wp-admin/includes/post.php');\n        }\n\n        // Get the REST API Headers\n        $headers = wp_remote_head('https://website-im-getting-data-from.com/wp-json/wp/v2/posts');\n\n        // Start at page 1 and loop through all 80 pages from x-wp-totalpages\n        for ($i = 1; $i <= $headers['headers']['x-wp-totalpages']; $i++) {\n            $response = wp_remote_get(\n                add_query_arg( [\n                    'page' => $i,\n                    'per_page' => 25,\n                    'post_status' => 'publish',\n                ], 'https://website-im-getting-data-from.com/wp-json/wp/v2/posts')\n            );\n\n            // Successful response? Proceed.\n            if (wp_remote_retrieve_response_code($response) === 200) {\n                try {\n                    $posts = json_decode(\n                        wp_remote_retrieve_body($response),\n                        false,\n                        512,\n                        JSON_THROW_ON_ERROR\n                    );\n                } catch (Exception) {\n                    return;\n                }\n\n                // Loop through the 25 posts from the identified page\n                foreach ($posts as $post) {\n                    $current_post_id = post_exists($post->title->rendered);\n                    if ($current_post_id === 0) {\n                        $my_post = [\n                            'post_type'     => 'post',\n                            'post_status'   => 'pending',\n                            'post_title'    => wp_strip_all_tags($post->title->rendered),\n                            'post_content'  => wp_strip_all_tags($post->content->rendered),\n                            'post_excerpt'  => wp_strip_all_tags($post->excerpt->rendered),\n                            'post_author'   => 1,\n                            'post_date'     => $post->date,\n                        ];\n\n                        // Insert post.\n                        $post_id = wp_insert_post($my_post);\n                        wp_set_object_terms($post_id, 'Global', 'category');\n                        wp_set_object_terms($post_id, 'Global', 'post_tag');\n                        echo \"ID: \" . $post->id . \" - Title: \" . $post->title->rendered . \" has been imported.\\n\";\n                    }\n                }\n            }\n        }\n    }\n\n\nA: Instead of fetching the first page, then looping over the total pages count from a variable, instead store it as an option, and use a second value to specify next page.\nThis way, you retrieve the next page number, fetch it, process the posts, then update the total pages options using the newer header from that request, and add 1 to the next page option and save it. If next page is larger than total pages reset it to 1.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403928", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom WP rest api endpoint only working on non https? I'm googling like an hour for a possible solution while im trying to create my first custom wordpress rest api endpoint.\nIf i call the endpoint by postman it just works, but if i try with jquery, it doesn't.\nI noticed, that if i call it by the http version it works, but on https it just returns 404?\nHeres my endpoint registration:\nadd_action('rest_api_init', function () {\n  register_rest_route('the-namespace/v1', '/the-endpoint', [\n    'method' => WP_REST_Server::CREATABLE,\n    'callback' => 'theEndpoint',\n    'permission_callback' => function () {\n      return true;\n    }\n  ]);\n});\n\nfunction theEndpoint(WP_REST_Request $request)\n{\n  $data = [\n    'some' => 'data',\n  ];\n\n  $res = new WP_REST_Response($data);\n  $res->set_status(200);\n\n  return [$res];\n}\n\nAnd the corresponding js ajax code:\nvar data = {\n  unusedData: 'so far',\n};\njQuery.ajax({\n  method: 'POST',\n  url: '/wp-json/the-namespace/v1/the-endpoint',\n  data: data,\n  dataType: 'json',\n  contentType: 'applcation/json',\n  success: function(data, status) {\n    alert(\"Data: \" + data + \"\\nStatus: \" + status);\n  }\n})\n\nSure i googled and tried to compare what postman is doing differently, but maybe i'm overlooking something?\nThanks for your time!\nEDIT - more info:\n\n*\n\n*Permalinks have been flushed\n\n*Site (Wordpress Adress and Site Adress) is configured HTTPS\n\n*It's the full example code\n\n*I noticed, that i can actually register the same thing as get and it works. Only the post style registration doesnt work.\n\nEDIT - htaccess (not from me..)\nI just created a link to view the htaccess file, I don't know if it's too big for here, so i pasted it on pastebin - here.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403932", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Debug messages refer to /wp-includes/functions.php I'm having an issue where debug messages refer to lines of code in /wp-includes/functions.php instead of the lines in the child-theme or plugin actually causing the issue.\nThe lines referred to (most often) appear to simply be the logic that generates the error messages for deprecated code: /wp-includes/functions.php on line 5316\nIs this just the way that deprecated code errors work or have I stepped on my own foot with a setting somewhere non-obvious? I triggered an undefined function error as a test and it told me exactly where it was, as I would normally expect.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403934", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Quiz with complex output/result I\u2019m looking to build a quiz on my Wordpress site that outputs a custom 2 page report. The structure of this report will be dependant on the answers to the quiz (pre-written blocks that I need to show or hide depending on the answers). I\u2019ve looked at all the Quiz builder plugins, and they all work great for asking questions, but the results pages tend to be very limited. Looking to advise on the best approach to accomplish this. Thanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403935", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Edit Page did not get refresh after update \nI notice if I performed a filename change for an image under \"Edit Page\", the page does not get refreshed automatically. Is this normal?\nReplication Step\n\n*\n\n*Upload new image via \"Upload New Media\"\n\n*Select \"edit\" to go to \"Edit Media Page\"\n\n*Scroll down to the \"Filename\" field and replace the filename\n\n*Click \"Update\"\n\n*Loading icon keeps on running and nothing is changed on the page (Page not refresh)\n\nInformation gets updated when F5 (refresh) is pressed to manually trigger the refresh.\nThanks in advance \nBrian\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403936", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to execute add_action() function from custom plugin to Crontrol plugin or do_action()? I created a custom plugin and I need to schedule add_action using Crontrol Plugin, the Setup class is from different php class. But the schedule action cant read the Crontrol even if I execute do_action('schedule') inside functions.php it is not working.\nclass Scheduler {\n    \n    public $setup;\n\n    public function __construct()\n    {\n\n        add_action('scheduler', [$this, 'etf_scheduler_func']);\n    }\n\n    public function etf_scheduler_func() {\n        $this->setup = new Setup();\n        $this->setup->set_table();\n    }\n}\n\n\nA: I didn't call the class yet, this code is now working\nclass Scheduler {\n    \n    public $setup;\n    public static $instance;\n\n    public function __construct()\n    {\n        self::$instance =& $this;\n\n        add_action('scheduler', [$this, 'etf_scheduler_func']);\n    }\n\n    public function etf_scheduler_func() {\n        $this->setup = new Setup();\n        $this->setup->set_table();\n    }\n\n    public static function &get_instance()\n    {\n        if ( ! isset( self::$instance ) )\n            self::$instance = new self;\n\n        return self::$instance;\n    }\n} \n\nScheduler::get_instance();\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403937", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: The Settings API - What is the purpose of default value in register_setting? I'm trying to wrap my head around the Settings and Options APIs as I'm writing a simple plugin.\nOne thing that has really stomped me is the possibility to add a default value to an option when calling the register_setting() function. This does not work the way I expected and I don't get how it's supposed to work.\nHere is a simplified example:\n<?php\n/**\n * Plugin name: Options test\n */\n\ndefine( 'MY_PAGE', 'my_test_page' );\ndefine( 'MY_SECTION', 'my_test_section' );\ndefine( 'MY_OPTION', 'my_test_option' );\n\nadd_action( 'admin_menu', function () {\n    add_options_page( 'Options test', 'Options test', 'manage_options', MY_PAGE, function () {\n        echo '<div class=\"wrap\"><h1>Options test</h1>';\n        echo '<form action=\"options.php\" method=\"post\">';\n        settings_fields( MY_PAGE );\n        do_settings_sections( MY_PAGE );\n        submit_button();\n        echo '</form>';\n        echo '<p>The option value: <code>' . get_option( MY_OPTION ) . '</code></p>';\n        echo '</div>';\n    } );\n} );\n\nadd_action( 'admin_init', function () {\n    register_setting( MY_PAGE, MY_OPTION, [ 'default' => 'My default value' ] );\n    add_settings_section( MY_SECTION, '', null, MY_PAGE );\n    add_settings_field( MY_OPTION, 'The option', function () {\n        echo '<input name=\"' . MY_OPTION . '\" value=\"' . get_option( MY_OPTION ) . '\">';\n    }, MY_PAGE, MY_SECTION );\n} );\n\nadd_shortcode( 'my-test-option', function ( $atts, $content = '' ) {\n    return get_option( MY_OPTION );\n} );\n\nThis results in a setings page that looks like this:\n\nYou can see that the <input> has a default value and that the separate call to get_option() returns the default value - on this page. When accessing the option on the front end using the shortcode [my-test-option] it is blank. This is expected when I haven't visited the settings page, as nothing has been saved to the database. There is no 'my_test_option' in the wp_options database table.\nBut...\nEven when I press the  [Save Changes] button, the default value is NOT saved to the database. I've traced the code and found that in the update_option() function (/wp-includes/option.php) there is a test to check if the new value is the same as the old, and if so the new value isn't stored.\nSo in order to actually save the default value to the database using this custom settings page, I would have to change the value to something other than the default, save it, change it back to the default and save it again. Very unintuitive.\nI've already understood that I need to fix this by using register_activation_hook() in my plugin and add the default options to the database there. Then remove the default from the register_setting() calls.\nWhat I don't understand is how the default parameter to the register_setting() function is meant to be used. When and how is it useful? As it stands, it has only lead to confusion and wasted hours.\n\nA: Excerpt from the register_setting() documentation:\n\n'default'\n(mixed)  Default value when calling  get_option().\n\nSo the purpose of the default argument is to provide a default value which get_option() would return if the option does not exist (or has not yet been saved) in the database.\nAnd register_setting() sets the option's default value via filter_default_option() which is hooked on the default_option_<option name> filter: (see source on GitHub)\nif ( array_key_exists( 'default', $args ) ) {\n    add_filter( \"default_option_{$option_name}\", 'filter_default_option', 10, 3 );\n}\n\nTherefore, because update_option() uses $old_value = get_option( $option );, i.e. it uses get_option() which runs the above hook, then if the option hasn't yet been saved in the database, the old value would then be the default value and thus the option wouldn't be saved if the new and the default/old values are the same just like you can see in the example below:\n$option  = 'my_test_option';\n$default = 'My default value';\n\nregister_setting( 'my_test_page', $option, [\n    'default' => $default,\n] );\n\ndelete_option( $option ); // JUST FOR TESTING\n\n// So at this point, the option doesn't yet exist.\nvar_dump( get_option( $option ) );                   // string(16) \"My default value\"\n// this displays a custom value because the 2nd parameter ($default) is specified:\nvar_dump( get_option( $option, 'a custom value' ) ); // string(14) \"a custom value\"\n\n// Now let's save the option.\n$old_value = get_option( $option );  // this returns \"My default value\"\nvar_dump( $old_value === $default ); // bool(true)\n// bool(false), because $default is the same as $old_value\nvar_dump( update_option( $option, $default ) );\n// bool(true), because 'foo' is not the same as $old_value\nvar_dump( update_option( $option, 'foo' ) );\n\n// Retrieve the saved option.\n$old_value = get_option( $option );\nvar_dump( $old_value ); // string(3) \"foo\"\n\n// Update the option. (set the value to the default value)\nvar_dump( $old_value === $default ); // bool(false)\n// bool(true), because the old value is now 'foo'\nvar_dump( update_option( $option, $default ) );\n\nAs for this: (italic formatting added by me)\n\nWhen accessing the option on the front end using the shortcode\n[my-test-option] it is blank. This is expected when I haven't\nvisited the settings page, as nothing has been saved to the\ndatabase.\n\nYes, that's expected, and it's because you used the admin_init hook to register the setting on the admin side only (wp-admin).\nIf you used a hook which runs both on the admin and non-admin sides of the site, e.g. init, then you would've seen the default option value instead of the blank output.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403939", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Custom post type with rewrite slug as / has 404 issue in other post type. How to fix this issue I have a issue in custom post . When i add below statement and save the permalink, custom post url works well but urls of default post, page and other custom post shows 404 error:\n'rewrite' => array('slug' => '/', 'with_front' => false)\nNot sure how to fix this issue.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403940", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom loop ordering not working I have a custom loop to display the children of a parent page which works well - however, I cant get the ordering of the items to work as I want - I want them to appear in alphabetical order (A>Z). Can anyone help with some mods to the code below to get it to work as I want it?\n<?php\n$ids = array();\n$pages = get_pages(\"parent=\".$post->ID);\nif ($pages) {\n    foreach ($pages as $page) {\n        $ids[] = $page->ID;\n    }\n}\n$paged = (get_query_var(\"paged\")) ? get_query_var(\"paged\") : 1;\n$args = array(\n    \"paged\" => $paged,\n    \"post__in\" => $ids,\n    \"posts_per_page\" => 600,\n    \"post_type\" => \"page\",\n    \"sort_order\" => \"ASC\",\n    \"sort_column\" => \"post_name\"\n);\nquery_posts($args);\nif (have_posts()) : while (have_posts()) : the_post(); \n?>\n\n\nA:     \"sort_order\" => \"ASC\",\n    \"sort_column\" => \"post_name\"\n\nThese are not sorting parameters. Use order and orderby instead as specified in the official documentation:\nhttps://developer.wordpress.org/reference/classes/wp_query/#order-orderby-parameters\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403941", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Overwrite YoastSEO meta-tags with another page's I'm writing a custom Wordpress theme and for a specific page I need to overwrite its meta-tags (printed by YoastSEO) with the meta-tags of another page I already know the ID of. I cannot just change the original page meta-tags because the replacement changes based off a custom field in the page.\nI've tried this, but apparently wp_head() is unaffected by the_post()...\n    <head>\n    ...\n    <?php\n    if (...)\n    {\n        $meta_page = new WP_Query([ 'page_id' => $meta_page_id ]);\n        while ( $meta_page->have_posts() )\n        {\n            $meta_page->the_post();\n            wp_head();\n        }\n        wp_reset_postdata();\n    }\n    else wp_head() ?>\n    ...\n    </head>\n\nHope it's clear enough; first question here.\nThanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403945", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Insert ads between comments I want to insert ads between comments.\nfunction wpse_comments_ads_injection( $comment, $args, $depth ) {\n    \n static $count = 0;\n\nif ( $count == 2 ) {\n        echo \"AD 1\"; \n    }\n\nif ( $count == 5 ) {\n        echo \"AD 2\"; \n    }\n\n $count++;\n }\n\nadd_filter( 'wp_list_comments_args', function( $args ) {\n    if ( ! isset( $args['end-callback'] ) ) {\n        $args['end-callback'] = 'wpse_comments_ads_injection';\n    }\n    return $args;\n} );\n\nI wrote this code, but because of it the tag\n<!-- #comment-## -->\n</li>\n\nis deleted\nHow will it be right?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403947", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Block variation / Variation API scope \"transform\" I have a simple Block Variation for core/heading -\n    wp.blocks.registerBlockVariation(\n    'core/heading',\n    [{\n        name: 'my heading',\n        title: 'My Heading',\n        attributes: {\n            level: 3,\n            className: 'is-style-my-heading',\n        },\n        scope: [ 'inserter', 'transform' ],\n    }]\n);\n\nIt works in the inserter, but I can't make the variation visible in the transforms component for some reason. But maybe I don't sufficiently understand what the 'transform' in the scope attribute is supposed to do. I can transform the block variation to, say, a paragraph (not the core version of heading for some reason), but when I try to transform the paragraph the list of available transforms only gives the core/heading block, not the variation.\nSo if I'd like to transform a core/heading or a core/paragraph to my-heading (with specified level) then it seems all I can do now is copy the content, delete core block, insert the variation block and paste the content back in.\nIs this the only way? Am I doing something wrong?\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403952", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: SQL statement using placeholder is not returning results Having done this hundreds of times, I wrote a SELECT query like this:\n$visitors = $wpdb->get_results( \n            $wpdb->prepare( \n    'SELECT * FROM '.$wpdb->prefix.'visitors WHERE archive_this != %s',\n     \"checked\"\n    )\n);\n\nbut it returned empty. So, I cheated and wrote it without the placeholder:\n$visitors = $wpdb->get_results( \n    'SELECT * FROM '.$wpdb->prefix.'visitors WHERE archive_this != \"checked\"',\n);\n\nwhich worked fine. But, I'd like the placeholder as best practices.\nWhat am I missing?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403953", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: create timestamp links to jump to specific times on rumble videos I am trying to allow visitors to seek specific times on the embed rumble video inside the wordpress post by clicking to timestamp links. I can do it for youtube videos using Skip to Timestamp plugin or methods like this one however, I cannot make it work for embed rumble videos.\nI desperately need to make this work for a rumble video. Any help would be greatly appreciated.\nCheers.\n\nA: Setting the timestamps on a YouTube video works because YouTube allows it, this is not a functionality that Wordpress provides. For an rumble video you could use the Rumble Player API.\nIn the documentation there is the function \"API.setCurrentTime(time)\" and it should do the same as in your linked example.\n\nA: Although I appreciate user141080's attempt to give feedback on your question, he gave kind of a squirmy answer that did not address your concern.\nI believe the question was how to create a timestamp link for a Rumble video. It did not ask about 3rd party software.\nA hyperLink is a web browser function that takes an address as well as sometimes arguments to clarify a condition for a web server response, such as the video start time.\nBest Answer: You can add:  ?start=xx (or &start=xx for additional parameter) to the end of the link, where xx = the number of seconds into the video to begin.\nTo start video at 33:22, first convert to seconds.\nhttps://rumble.com/xxxMyVideo.html?start=2002 or\nhttps://rumble.com/xxxMyVideo.html?pub=33x55&start=2002\nThere may be an easier way to insert mins, but I thought it up on the fly and Rumble is using seconds for start time.\nEnjoy\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403956", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Does Wordpress ever need multiple databases? Is there ever a reason to run a Wordpress install that uses more than a single Database to run? Like for instance, could a Wordpress installation get so large or gain so many users that it needs another database? I'm asking because of a situation where I learned of a Wordpress install that claims to use two MySQL databases to run on and I'm uncertain as to why that would even be necessary.\n\nA: \ncould a Wordpress installation get so large or gain so many users that it needs another database?\n\nIf you mean sharding of a database to spread data across multiple servers for sheer quantity of data, then yes, but only for 3 or 4 websites in existence, aka WordPress.com.\nIf you think you need this for your site or a clients site, then the answer is no you do not. We're talking ultra high traffic multisites with tens of millions of active worldwide users, and tens of billions of page views per day.\nHow do normal multi-database server setups differ from what you described?\nNormal multi-DB servers don't split up data, they're just copies that load balance so that more requests can be served. Each copy contains the full database, usually with a single server acting as the source of truth that handles writes/updates/deletes and replicates those changes to the others.\nYou might see this in a dual load balancing configuration, though normally these are unnecessary as the operators are unaware of persistent object caches or frontend caches such as varnish.\nThis is also something an administrator or hosting company might upsell you on if you're a high traffic client who spends a lot. WordPress does not require it, but maybe it will get faster if you throw cash at the problem? ( Sometimes it does! Everything has to work in some situations right? )\nWhat Would It Take To Require Sharding of Data?\nFor a WordPress site to require multiple database servers in the way you describe, you would need HyperDB to shard data across servers, and you would need a multisite serving tens of millions of users and sites.\nA prime example of this is WordPress.com.\nNote that a lot of fortune 100 sites running WordPress at enterprise scale serving billions of page views per day do not use sharded databases such as those described in your question.\nSo unless you're planning to enter the world of ultra high scale WordPress Enterprise hosting and work at Automattic or a major WordPress hosting company, this is purely academic and not useful. Even then most roles in those companies do not need to know about this.\nDisclosure: I used to work at Automattic on their VIP Enterprise hosting division\n\nI'm asking because of a situation where I learned of a Wordpress install that claims to use two MySQL databases to run on and I'm uncertain as to why that would even be necessary.\n\nWhat's likely is that the site had poor performance, and the people running it decided to use a second database server to increase the number of requests it could handle. This is likely due to the use of poor queries, and using uncached functions in the site.\nInstalling Redis and a persistent redis object cache dropin, or memcached/mongodb equivalents, would have significantly improved performance without the need to add a second database server. Likewise avoiding NOT IN type queries, or filtering/searching for posts by their post meta values/fields would significantly improve performance and traffic scaling. Logged out traffic can also be cached via tools such as Varnish or equivalent full page caches that bypass PHP altogether.\nMost people are unaware that if they follow several basic common sense rules such as those then they can host high traffic sites on the cheapest of Digital Ocean plans. Sadly most people will also rely heavily on those things and consider such advice silly. Most plugins and themes rely heavily on post meta searches for example.\n\nA: @TomJNowell is right. In general in the database world, scaling up via server replication or scaling out via sharding are last resorts after improving table keys and query algorithms. It's really expensive to maintain multiple replicas or shards, both in server costs and people time.  You're frequently troubleshooting some problem or other, and frequently at night. Ask me how I know this when you have a few hours to spare.\nAdding better table keys and fixing some lookup algorithms is the first step to scaling up a site. The next step is adding a persistent object cache (such as redis). The third step is provisioning a bigger MariaDB / MySQL server machine with enough RAM for a big buffer pool.\nI have written a couple of free non-monetized GPL plugins to address the keying and lookup algorithm issues. The WordPress performance team is aware of this work; I hope they make my plugins obsolete sometime soon.\nFor rekeying, try using Index WP MySQL For Speed.\nYou mentioned sites with many users having poor performance. Try using Index WP Users For Speed to address that problem.\nThe database-query code in core WordPress is grossly inefficient at handling sites with tens of thousands (or more) of registered users.  It does queries like this (simplified) example, to find the first few \"editor\" users.\nSELECT CALC_FOUND_ROWS wp_users.ID\n  FROM wp_users\n  JOIN wp_usermeta ON wp_usermeta.user_id = wp_users.ID \n                  AND wp_usermeta.meta_key = 'wp_capabilities'\n WHERE wp_usermeta.meta_value LIKE '%\"editor\"%'\n ORDER BY wp_users.display_name\n LIMIT 20\n\nThis query contains the notorious MySQL performance killer meta_value LIKE '%something'. It's a performance killer because the leading % wildcard requires MariaDB / MySQL to examine the data for every user. In db jargon, it must do a full table scan on both wp_users and wp_usermeta. (See you after lunch.  :-)\nIt does queries like this every time you display the Users, Posts, or Pages panels in your dashboard.\nThe Index WP MySQL For Speed plugin addresses it by adding some easier-to-access rows to wp_usermeta. It changes that example query to\nSELECT wp_users.ID\n  FROM wp_users\n  JOIN wp_usermeta ON wp_usermeta.user_id = wp_users.ID \n                  AND wp_usermeta.meta_key = 'wp_iufsr:editor'\n ORDER BY wp_users.display_name\n LIMIT 20\n\nThat query exploits a key on wp_usermeta and finishes in a few milliseconds, even on sites with many users.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403957", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to set javascript options for select2 in PHP array of plugin I'm using two different jQuery plugins that I'm trying to get to work together. It should be possible since they come bundled together.\nThe first plugin is the Metabox.io plugin for creating metaboxes. One of the field types it has is a Select2 dropdown box.\nIn the documentation for the \"select_advanced\" field of Metabox (documented here: https://docs.metabox.io/fields/select-advanced/) it says that options can be passed to Select2 using the \"js_options\" parameter. If I pass a simple ajax option, such as method (post/get), it works as expected.\nI'm trying to implement one of the advanced ajax features of Select2 within Metabox. The documentation for it shows you can pass the \"data\" variable like this:\n$('#mySelect2').select2({\n  ajax: {\n    url: 'https://api.github.com/orgs/select2/repos',\n    data: function (params) {\n      var query = {\n        search: params.term,\n        type: 'public'\n      }\n      return query;\n    }\n  }\n});\n\nAll of these options can bo configured from within Metabox like this (js_options variable):\narray(\n    'name' => esc_html__( 'Assigned To', 'houzez' ),\n    'id' => 'sfma_task_assigned_to2',\n    'type' => 'select_advanced',\n    'options' => array('' => ''),\n    'js_options' => array (\n            'ajax' => array(\n                    'url' => '/wp-admin/admin-ajax.php?action=ajax_get_products',\n                    'dataType' => 'json',\n                    'type' => 'POST',\n                    'delay' => '250',\n            ),\n            'minimumInputLength' => 3,\n            'allowClear' => true,\n            'placeholder' => 'Choose product'\n    ),\n    'columns'   => 4,\n),\n\nThe problem is I'm not sure how to combine the two. Metabox requires options in a key => value pair array, but Select2 requires a function be passed in as the value of the \"data\" parameter that will return a value.\nHow do I format something like this:\ndata: function (params) {\n  var query = {\n    search: params.term,\n    type: 'public'\n  }\n  return query;\n}\n\nto work within an array that's usually:\n'data' => array(\n    'key1'=>'val1',\n    'key2'=>'val2',\n)\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403958", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get template name or category before publish I use wp_insert_post hook.\nI was trying to use get_page_template_slug, get_the_category, get_post_meta($post_id, '_wp_page_template', true)\nNo success at all for a template. And category return undefined.\nThanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403959", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I restore posts from 'trash' with their previous post_status? - Wordpress I have a Custom post type in wordpress in which when creating a new post 3 child subposts are created automatically. For example, I create the post and assign it some status 'Publish', 'pending', 'draft' or another:\nPost Company 1\n-Subpost 1 (it is created automatically)  \n-Subpost 2 (it is created automatically)  \n-Subpost 3 (it is created automatically)\n\nRemoving the parent (moves to 'trash' ) will also remove the subposts. But when you restore them, they should be in the state they were saved in before ('pending', 'draft', 'auto-draft' or something else).\nHow could I do that to restore the posts (parent and children) with their 'post-status' that they had defined before being moved to 'trash'?\nThis is my code that I am using to create the 3 child subposts automatically:\nfunction add_children_custom_post_type( $post_id ) {\nif ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE )\n    return;\n\nif ( !wp_is_post_revision( $post_id ) && 'companies' == get_post_type( $post_id ) && 'publish' == get_post_status( $post_id ) ) {\n    $show = get_post( $post_id );\n    if( 0 == $show->post_parent ){\n        $children =& get_children(\n            array(\n                'post_parent' => $post_id,\n                'post_type' => 'companies'\n            )\n        );\n        if( empty( $children ) ){\n            //Children pages\n            $titles = ['Subpost1', 'Subpost2', 'Subpost3'];\n            foreach ($titles as $key=>$title) {\n                $child = array(\n                    'post_type' => 'companies',\n                    'post_title' => $title,\n                    'post_content' => '',\n                    'post_status' => 'publish',\n                    'post_parent' => $post_id,\n                    'post_author' => get_post_field('post_author', $post_id),\n                    'menu_order' => $key\n                );\n                wp_insert_post( $child );\n            }\n        }\n     }\n  }\n}\nadd_action( 'save_post', 'add_children_custom_post_type' );\n\nAnd this is the one I use to move the child posts of a parent post when the parent is deleted:\n// Move to Trash\nfunction trash_post_children($post_id) {\n$parent_ID = $post_id;\n\n$args = array(\n    'post_type' => 'companies',\n    'post_parent' => $parent_ID,\n    'posts_per_page' => -1,\n    'post_status' => array('publish', 'pending', 'draft', 'auto-draft', 'future', 'private', 'inherit', 'trash')\n);\n  $children = get_posts($args);\n  if($children) {\n      foreach($children as $p){\n        wp_trash_post($p->ID, true);\n      }\n   }\n}\nadd_action('trashed_post', 'trash_post_children');\n\nAnd this other one is to restore the posts but they are always restored in 'draft' state:\n// RestorePost\nfunction restore_post_children($post_id) {\n   $parent_ID = $post_id;\n    $args = array(\n       'post_type' => 'companies',\n       'post_parent' => $parent_ID,\n       'posts_per_page' => -1,\n       'post_status' => 'trash'\n   );\n   $children = get_posts($args);\n   if($children) {\n    foreach($children as $p) {\n        wp_untrash_post($p->ID);\n    }\n  }\n}\nadd_action('untrash_post', 'restore_post_children');\n\n\nA: The reason it is a draft, and what you need to do to get what you wanted is spelt out in the source code for wp_untrash_post and in the documentation for wp_untrash_post_status:\nhttps://github.com/WordPress/WordPress/blob/bbf017e550b02f5d11e409b07e689d45c984054d/wp-includes/post.php#L3668-L3685\n    $new_status = ( 'attachment' === $post->post_type ) ? 'inherit' : 'draft';\n\n    /**\n     * Filters the status that a post gets assigned when it is restored from the trash (untrashed).\n     *\n     * By default posts that are restored will be assigned a status of 'draft'. Return the value of `$previous_status`\n     * in order to assign the status that the post had before it was trashed. The `wp_untrash_post_set_previous_status()`\n     * function is available for this.\n     *\n     * Prior to WordPress 5.6.0, restored posts were always assigned their original status.\n     *\n     * @since 5.6.0\n     *\n     * @param string $new_status      The new status of the post being restored.\n     * @param int    $post_id         The ID of the post being restored.\n     * @param string $previous_status The status of the post at the point where it was trashed.\n     */\n    $post_status = apply_filters( 'wp_untrash_post_status', $new_status, $post_id, $previous_status );\n\nhttps://developer.wordpress.org/reference/hooks/wp_untrash_post_status/\n\nBy default posts that are restored will be assigned a status of \u2018draft\u2019. Return the value of $previous_status in order to assign the status that the post had before it was trashed. The wp_untrash_post_set_previous_status() function is available for this.\nPrior to WordPress 5.6.0, restored posts were always assigned their original status.\n\nSo use that filter and add wp_untrash_post_set_previous_status to it which was built specifically for this problem:\nhttps://developer.wordpress.org/reference/functions/wp_untrash_post_set_previous_status/\nNotice its source code is super simple\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403961", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Multiple use wp_logout_url() on page cause 'header already sent' error after submit form I am using two wp_logout_url() echoes on page.\nThe first one is used in header.php custom theme file, second one is used in another page template file (page-[customslug].php).\nOn that page i have a form to edit user profile data.\nSending this form cause on result page \"headers already sent\" error.\nTo avoid this problem i must remove one from those two lines where i use <?php echo wp_logout_url(); ?>.\n<?php \n\nget_header();  <--- first wp_logout_url();\n\n/* page-[custom-slug].php content */ <--- second wp_logout_url();\n\nget_footer; \n\n?>\n\nWhy i can't use multiple logout links on one page?\nIMPORTANT:\nThis is how i retrieve the sended form data:\n<?php \n\nif ( isset($_POST['btnname']) ) : \n\n   // saving data stuff\n\nelse : \n\n   // page-[custom-slug].php content\n\nendif;\n\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403965", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using PHP Code Snippets to query a database, $dbconnection->get_results is outputting nothing I'm currently trying to run this php code snippet in a WordPress Page using a PHP code snippet extension.\n//Database connection script\n//Connecting to our master database\n global $wpdb;\n $hostname = \"host\";\n $username = \"user\";\n $password = \"pass\";\n $dbname = \"dbname\";\n\n //creating new database object\n $dbconnection = new $wpdb($username, $password, $dbname, $hostname );\n \n //Querying the database\n $dbconnection->show_errors( true );\n $dbQuery = $dbconnection ->get_results(\"SELECT * FROM Master\");\n $dbconnection->last_query;\n $dbconnection->print_error();\n var_dump($dbconnection->last_query);\n\nThe output on the page looks like this, the table headers are there because of html code. The goal is to eventually get the data properly formatted under them but for now I'm getting no results from the database. The database is a separate database from the automatically generated WordPress one created through PhPMyAdmin, so the only thing I can think of is that my new wpdb object might be wrong but I made sure to double/triple check the information. I've been stuck on this for hours because I'm getting no errors either through print_error. \n\nA: Either you have a typo or your syntax is incorrect for this line:\n$dbconnection = new $wpdb($username, $password, $dbname, $hostname );\nIt should be:\n$dbconnection = new wpdb($username, $password, $dbname, $hostname ); (no $ in referencing the wpdb class)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403969", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Keeping and updating ACF and ACF Pro at the same time I am not sure how far this is relevant on this platform. Actually I am in a situation where I have both ACF (Deactivated) and ACF Pro (Activated) installed at the same time in a single WordPress site.\nThe Pro version is running the latest (v 5.12). But the Non-pro version is falling behind a few (minor) updates. Current version is 5.11 to be exact.\nI am a bit confused about updating the ACF (non pro) version because it is deactivated and ideally should not create any problem. But at the same time, keeping an old plugin, whether it is activated or not, is not recommended. And, at the same time hesitating to remove it completely for any unwanted impact!\nIs this safe to update / remove the plugin? What should be the correct way to test for any impact that might happen if I remove the non-pro version?\n\nA: As the free is deactivated, the code inside is not used. You can delete it.\nACF Pro is embedding ACF free functions so no worries.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403970", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: onclick not working since move from HTML to WP I built a new site using Divi in WP.  The previous HTML site had used an onclick event and also included the following script immediately following the opening  tag.  The digital marketing team informed me that after the move to WP, they no longer were receiving any data.  I am trying to figure out where I have gone wrong as I am newer to WP.  Any suggestions?\nthe onclick itself:\n <a onclick=\"goog_report_conversion ('javascript:document.searchform.submit();')\"\nhref=\"javascript:document.searchform.submit();\"  class=\"btn_reserve\">Reserve Now!</a>\n\nthe JS:\n<!-- Google Code for Reserve Now -->\n<script type=\"text/javascript\">\n  /* <![CDATA[ */\n  goog_snippet_vars = function() {\n    var w = window;\n    w.google_conversion_id = 973012345;\n    w.google_conversion_label = \"iNr5DMy-uHsQbyT-zwM\";\n    w.google_remarketing_only = false;\n  }\n  // DO NOT CHANGE THE CODE BELOW.\n  goog_report_conversion = function(url) {\n    goog_snippet_vars();\n    window.google_conversion_format = \"3\";\n    var opt = new Object();\n    opt.onload_callback = function() {\n    if (typeof(url) != 'undefined') {\n      window.location = url;\n    }\n  }\n  var conv_handler = window['google_trackConversion'];\n  if (typeof(conv_handler) == 'function') {\n    conv_handler(opt);\n  }\n}\n/* ]]&gt; */\n</script> \n<script type=\"text/javascript\"\n  src=\"//www.googleadservices.com/pagead/conversion_async.js\">\n</script>\n\n\nA: I would try separating the html from the javascript. i.e. not using \"onclick\" in html but instead using addEventListener.\n<a href=\"javascript:document.searchform.submit();\"  class=\"btn_reserve\">Reserve Now!</a>\n\n<script>\n    document.querySelector('.btn_reserve').addEventListener(\"click\", function(e) {\n\n        // it seems like this line won't return a URL and will instead submit the form. \n        // I would double check it.\n        var url = document.searchform.submit(); \n\n        goog_report_conversion(url);\n    });\n</script>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403974", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Send email button in custom post type backend I've added a button in the backend of my custom post type editor.\nI want to send an email using wp_mail() when admin user click a button.\nI've added this custom form and button to a meta box. See screenshot.\nThe problem is that when clicking this button Wordpress redirects to the default backend posts list page (https://mysite.test/wp-admin/edit.php).\nI am making use of the do_action( \"admin_post_{$action}\" ) hook.\nWhen I inspect the page I see Wordpress has removed the  tags.\nAny help will be greatly appreciated.\nHere is my code:\n<?php\n    $quote_add_meta_nonce = wp_create_nonce('send_quote_email_form_nonce');\n\n    add_action('admin_post_quote_email_pdf', 'quote_email_pdf');\n\n    function quote_email_pdf()\n    {\n        if (isset($_POST['send_quote_email_meta_nonce']) && wp_verify_nonce($_POST['send_quote_email_meta_nonce'], 'send_quote_email_form_nonce')) {\n            $emailMessage = '<h1>It works</h1>';\n            echo $emailMessage;\n        } else {\n            echo 'Something went wrong';\n        }\n    }\n?>\n\n<form action=\"<?php echo esc_url(admin_url('admin-post.php')); ?>\" method=\"POST\">\n    <input type=\"hidden\" name=\"action\" value=\"quote_email_pdf\">\n    <input type=\"hidden\" name=\"send_quote_email_meta_nonce\" value=\"<?php echo $quote_add_meta_nonce ?>\" />\n    <input type=\"submit\" value=\"Email quote to customer\" class=\"button\">\n</form>\n\n\nA: Solved this using AJAX. Here is my updated code:\n<?php\nadd_action('wp_ajax_quote_email_pdf', 'quote_email_pdf');\n\nfunction quote_email_pdf()\n{\n    wp_mail( $to, $subject, $message, $headers, $attachments );\n\n    die();\n}\n?>\n<button class=\"button\" id=\"downloadQuote\">Send email</button>\n\n<script>\njQuery(document).ready(function($){\n  const fullName = $('#quoteFullName').text();\n  const emailAddress = $('#quoteEmail a').text();\n\n  $('#downloadQuote').click(function(e){\n    e.preventDefault();\n    $.ajax({\n      url: sf_admin_ajax.sf_admin_ajax_url,\n      type: 'POST',\n      data: {\n          action: 'quote_email_pdf',\n          emailAddress: emailAddress,\n          fullName: fullName\n      },\n      beforeSend: function() {\n          $('.preloader-window').addClass('active')\n      },\n      success: function(data, textStatus, XMLHttpRequest) {\n          $('.preloader-window').removeClass('active')\n          console.log(data);\n      },\n      error: function ( MLHttpRequest, textStatus, errorThrown ) {\n          $('.preloader-window').removeClass('active')\n          console.log(errorThrown);\n      }\n    })\n\n  })\n});\n</script>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403976", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Question about link two types of data in wordpress I have a problem and I'd a like a suggestion to solve it. I have two data(Architects and Projects) where both need to link each other, architects must have their own page as well as an archive page. projects must have a page must have an architect\nhow do I solve this problem? I already thought about make archtects as taxonomy but it wouldn't work because I need an archive and a single page for archtects which will list all projects for this architect.\nlook at the examples below:\n\n\n\n\nA: I hope you have already created custom post types for Architects and Projects. In order to make a relation between them you may follow any of the methods below:\na.) Using ACF:\n\n*\n\n*https://www.advancedcustomfields.com/resources/bidirectional-relationships/\nb.) Using Toolset:\n\n*\n\n*https://toolset.com/2018/07/how-to-create-post-relationships-between-your-custom-post-types-and-how-to-display-them/\nc.) Using Posts to Posts plugin (Use it at your own risk as the plugin hasn't been tested with the latest 3 major releases of WordPress)\n\n*\n\n*https://wordpress.org/plugins/posts-to-posts/\nd.) Using metabox code by user @vmassuchetto\nHow do I create a relationship between two custom post types?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403977", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Updating failed. The response is not a valid JSON response. specific to my browser when I include javascript in my html I was able to insert custom html into my gutenberg wordpress editor (hosted by bluehost) and test my code by preview with no problems. I made calls to google maps and fetch() to get a list of locations to plot on the map as markers. 2 days later, I was no longer able to save any javascript changes to my post. I tried deleting the post and starting a new post. I deleted my javascript code to insert something simple like this\n<p\u00a0id=\"demo\"></p>\n<script>\ndocument.getElementById(\"demo\").innerHTML\u00a0=\u00a05\u00a0+\u00a06;\n</script>\n\nIt didn't matter how simple the script was, I got the error message: \"Updating failed. The response is not a valid JSON response.\"\nI suspect this is a problem specific to my account/browswer/network settings because the tech support folks at bluehost did not encounter this problem when they tried to save the above script to my post. I also tried to hire someone on upwork to help me and he did not counter this problem when he got into my wordpress. I tried switching from chrome to safari and also encountered this problem.\nI suspect I tripped a setting while I was running this multiple times to test. Sorry I don't know of a better test environment.\nhere's my original code snippet:\n<div id=\"gmap\" style=\"width:100%;height:400px;\"></div>\n\n<script src=\"https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js\"></script>\n<script \nvar mymap;\nvar markers = [];\n\nfunction initMap() {\n    var centerpoint = { lat: 38.5, lng: -98 }; //centered around Kansas\n    mymap = new google.maps.Map(document.getElementById('gmap'), {\n        zoom: 4,\n        center: centerpoint\n    });\n}\n/** fetching a cvs file on the server side with a list of locations */\nfetch(\"https://<MYWEBSITE>.com/wp-content/uploads/2022/03/stores.csv\")\n  .then(\n    function(response) {\n      if (response.status !== 200) {\n        console.log('Looks like there was a problem. Status Code: ' +\n          response.status);\n        return;\n      }  \n\n      // Examine the text in the response\n      response.text().then(function(data) {\n        count = 0;\n        console.log(\"fetch called successfully\");\n        initMap();\n        processCSV(data);\n      });\n    }\n  )\n  .catch(function(err) {\n    console.log('Fetch Error :-S', err);\n  });\n\nfunction processCSV(allData){\n      const rows = allData.split('\\n');\n      var storename, storephone, storeaddress, storelat, storelng;\n  \n      for(let i=0; i<rows.length; i++){\n        var line = rows[i];\n        storename = line.split(\",\")[1];\n        storephone = line.split(\",\")[3];\n        storeaddress = String(line.split(\",\")[2]);\n        storeaddress = replaceAll(storeaddress, \"^\", \",\");\n        storelat = line.split(\",\")[4];\n        storelng = line.split(\",\")[5];\n        createMarker(storename, storephone, storeaddress, storelat, storelng);\n      }\n      createCluster();\n}\nfunction replaceAll(string, search, replace) {\n  return string.split(search).join(replace);\n}\nfunction createCluster(){\n    var mcluster =new markerClusterer.MarkerClusterer({\n    map: mymap,\n    markers: markers\n  });\n   \n }\nfunction createMarker(name, phone, address, latstr, lngstr) {\n var contentString = \"<b>\" + name + \"</b><br><br><i>\" + phone + \"</i><br><br>\" + address;\n var latLng = { lat: Number(latstr) , lng: Number(lngstr)};\n\n var infowindow = new google.maps.InfoWindow({\n    content: contentString,\n  });\n var marker = new google.maps.Marker({\n     position: latLng,\n     map: mymap,\n     title: name\n });\nmarkers.push(marker);\nconsole.log(\"added marker to map\" + name);\n  marker.addListener(\"click\", () => {\n    infowindow.open({\n      anchor: marker,\n      map: mymap,\n      shouldFocus: false,\n    });\n  });    \n}\n</script>\n<script src=\"https://maps.googleapis.com/maps/api/js?key=PRIVATEKEY&amp;callback=initMap\"></script>\n\n\n*\n\n*I have done the permalink resave\n\n*bluehost has regenerated the htAccess file\n\n*turned off all my plugins except elementor\n\n*checked for mixed content, my site is all https\n\n*checked site health rest api issues.\n\n*switched to classic editor (then found out classic editor doesn't support javascript inserts\n\nI'm out of ideas and I don't know why someone else, different computer, ip, browser, and maybe account can save javascript but not me.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403978", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Function the_posts_pagination() not compatible with WP_Query arguments I trying to make a list with posts from specific category. It's supposed to work as the loop in category.php file. Unfortunately i have problem with pagination links which are completely not compatible with my WP_Query arguments. No matter what i do, the_posts_pagination() function always return links to two pages only.\nIn tested category i have 12 posts, four of them are sticked posts so final from my query i should get 8 posts because i am using also a post__not_in argument with $stickies = get_option( 'sticky_posts' ) as value. And it happens, the WP_Query returns eight posts. But the big problem starts when it comes to work of the_posts_pagination() function.\nAfter set post_per_page argument into 2 it should return four pagination links (two posts on each page). Unfortunately the pagination function everytime returns only two links. Page 1 and 2.\nThose links works fine only when i set the post_per_page argument into number which not causing pagination divided to more than two links. So on post_per_page with 4,5,6 or 7 value all is good but even when i set the 8 value, when pagination should have only one link, it returns two links!\nHere is my code from category.php file:\n<?php get_header(); \n\n$category = get_queried_object();   \n$stickies = get_option( 'sticky_posts' );   \n            \n?>\n\n<main>\n    <div>\n    <?php\n    \n    $paged = ( get_query_var( 'paged' ) ) ? get_query_var( 'paged' ) : 1;\n    $args = array(\n        'post_type'             => 'post',\n        'cat'                   => $category->cat_ID, \n        'post__not_in'          => $stickies,\n        'posts_per_page'        => 2,\n        'paged'                 => $paged\n    );\n    $the_query = new WP_Query($args); \n\n    if ( $the_query->have_posts() ) :\n\n        /* Start the Loop */\n        while ( $the_query->have_posts() ) : $the_query->the_post(); ?>\n        \n            <article>\n                <div>\n                    <a href=\"<?php the_permalink(); ?>\">\n                        <?php the_post_thumbnail(); ?>\n                    </a>\n                </div>\n                <div>\n                    <?php the_title( '<h4><a href=\"' . esc_url( get_permalink() ) . '\" itemprop=\"url\" rel=\"bookmark\">', '</a></h4>' ); ?>\n                    <div><p><?php echo bs_get_excerpt(22); ?></p></div>\n                    <div><?php the_time( 'j F, H:i' );?></div>\n                </div>\n            </article>\n        <?php endwhile; ?>\n    \n            <div class=\"pagination\">\n\n                <?php \n                    \n                    $args = array( \n                        'mid_size'                  => 2,\n                        'prev_next'                 => false,\n                        'screen_reader_text'        => __(' ', 'themename'),\n                    );\n                    the_posts_pagination($args); \n                    \n                ?>\n\n            </div>  <?php \n    \n        wp_reset_postdata();\n        \n    else :\n        echo 'no posts from sybmitted query';\n    endif;\n            \n    ?>              \n    </div>\n</main>\n\n<?php get_footer(); ?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403982", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Filter users in a search I have made a custom search in users in wordpress and I added it to the landing page by using a shortcode. I want to filter them according their roles, it means I want to exclude all Admin users.\nHow can I do that?\nThis is my code:\n    if (isset($_POST['member'])) {\n\n        foreach (get_users() as $user) {\n            $name_lower = strtolower($user->display_name);\n            $name = $user->display_name;\n            if (strpos($name_lower, strtolower($_POST['member'])) == false) {\n                $resultat = $name;\n            }\n        }\n    }\n    return $resultat;\n}\nadd_shortcode('resultat', 'recherche_resultat');\n\n\nA: Check the arguments for get_users()\nhttps://developer.wordpress.org/reference/functions/get_users/\nWhat you should do is\n$users = get_users( array( 'role__not_in' => array( 'administrator' ) ) )\nThen\nforeach ( $users as $user ) ...\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403985", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: remove_action('save_post') in function that was triggered by save post not working The goal\nUpdate post title and slug on successful insertion into post table without re-triggering the save_post hook.\nCurrent behavior\nThe function as it is, still triggers the save_post hook, even though I'm removing the action before wp_update_posts is invoked. When this code exists by itself, the code runs perfectly, however I have another piece of code that is triggered by the save_post hook, but only continues when the post is updated. When that function exists, the save_post hook that is fired by wp_update_post triggers an infinite loop.\nCode in question\nfunction set_post_number($ID,$post,$update){\n    if($update == false){\n        $managedposts = array(/*array of multiple CPT's*/);\n        if(in_array($post->post_type,$managedposts)){\n            $option = str_replace('-','_',substr($post->post_type,0,-1)).'_counter';\n            $postnumber = get_option($option);\n            if($post->post_type == 'specific_cpt'){\n                $title = 'CPT #: '.strval($postnumber);\n            }elseif(/*further post type checks*/){\n            }else{\n                die;\n            }\n            $postupdates = array(\n                'ID' => $ID,\n                'post_title' => $title,\n                'post_name' => str_replace(array(' ','#',':'),'',$title),\n            );\n            remove_action('save_post', 'set_post_number',10);\n            wp_update_post($postupdates);\n            add_action('save_post', 'set_post_number',10,3);\n            $postnumber++;\n            update_option($option,$postnumber);\n        }\n    }\n}\n\nadd_action('save_post','set_post_number',10,3);\n\nAttempted Solutions\nI've tried using wp_insert_post_data, which doesn't trigger the other function, however, when I invoke the other function, wp_insert_post_data fires, and goes into an infinite loop, changing the post title and name, as well as incrementing the option value that's being called, so the post that was CPT #: 100001 becomes CPT #: some arbitrary number much larger than 100001.\nQuestion\nAm I invoking remove_action properly in the correct location? If so, what can I do to figure out why the save_post hook is still triggering?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403987", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP Remote Request not returning all of content via request EDIT: I think I discovered the issue, the endpoint is truncating the content response, does anyone know how to send over all of the data without it being truncated?\n\nSo I stumbled across some inconsistencies when requesting posts from one of our websites and not being able to pull in ALL of the content for a specific post.\nExplanation:\n\n*\n\n*Let's say that we have our REST API endpoint from the website where the posts live: https://test.com/wp-json/wp/v2/posts.\n\n\n*When I decode and get the response, I only get partial items included inside the response, such as this:\nWebsite hosts this in Text Gutenberg blocks:\nBanking on a Lifestyle: three ways to communicate the shift\n\nIn recent years, banks have begun accompanying us into areas of our lives previously uncharted by the financial services sector. Going for a coffee with a friend? Make sure you get cashback rewards with your bank. Hooked on a new TV series? Get some free months of streaming with your bank. Booking a holiday? Get cheaper prices if you book with your bank.\n\nFinTechs in particular are enabling people to bank based on their lifestyles. Challengers have clocked on to the fact that university students, for example, don\u2019t want good quality pension plans yet\u2026they want 50% off pizza. They\u2019ve adopted a customer-centric model that allows different people to make more of their money at different stages of their lives.\n\nLifestyle banking is making waves in the industry: legacy banks now realise they need to get a move on and learn from this approach, while FinTechs need to up their game in the face of rising competition.\n\nSo how should banks and FinTechs alike communicate this lifestyle-led approach? Particularly when we\u2019ve seen some real bloopers in this area recently\u2026\n\nWhat I get over the REST API:\n    [\"content\"]=>\n    object(stdClass)#941 (2) {\n      [\"rendered\"]=>\n      string(731) \"<div class=\"container\">\n<div class=\"row\">\n<div class=\"col-md-10 col-lg-9 offset-lg-1\">\n<p>Banking on a Lifestyle: three ways to communicate the shift In recent years, banks have begun accompanying us into areas of our lives previously uncharted by the financial services sector. Going for a coffee with a friend? Make sure you get cashback rewards with your bank. Hooked on a new TV series? Get some [\u2026]</p>\n</p></div>\n</p></div>\n</p></div>\n\"\n      [\"protected\"]=>\n      bool(false)\n    }\n\n\n*\n\n*Does anyone know what causes partial data to come back only?\n\n*Is it an issue because the website is using gutenberg blocks, which is the new editor?\n\nI'd like to retrieve the FULL content of the post, this includes any paragraphs, all images inside the post, etc..\n\nI have the following snippet:\n$response = wp_remote_request(add_query_arg( [\n    'page' => 1,\n    'per_page' => 3,\n    'post_status' => 'publish',\n], 'https://test.com/wp-json/wp/v2/posts'));\ntry {\n    $posts = json_decode(\n        wp_remote_retrieve_body($response),\n        false,\n        512,\n        JSON_THROW_ON_ERROR\n    );\n    if (empty($posts)) {\n        return;\n    }\n} catch (Exception) {\n    return;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403988", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Where should custom post types be registered in a plugin? They should be registered on the init-hook ideally (according to the documentation: Registering custom post types.\nHowever, I'm trying to use this boilerplate here: WordPress Plugin Boilerplate, since it seems to have a good thought and layout.\nBut I'm not sure where in that plugin, to add the registering of new post types?\nThere is a function: load_dependencies here - but is a custom post type a dependency? Hmm...\n\nUpdate\nI can see that if I do this:\n$this->loader->add_action( 'init', $this, 'temp' );\n\nand add that here: includes/class-plugin-name.php -> load_dependencies\nAnd add a function on line 128 like this:\n    public function temp(){\n        echo '<pre>';\n        print_r('Yo!');\n        echo '</pre>';\n    }\n\nThen it works.\nHowever... I still don't see the proper place to add this code, in order to follow the plugin standards.\n\nA: \nHowever... I still don't see the proper place to add this code, in order to follow the plugin standards.\n\nThere is no proper place, and there's no canonical correct answer here, only subjective opinions. The plugin standards do no give an answer for your question.\nThis boilerplate is just one starting point of many available, and there are lots and lots of options for what you should do, with tradeoffs of their own, or just personal preferences.\nThe boilerplates folder structure implies a file in the includes folder would do the trick, but you could put it in a subfolder, or an existing file, or a new file, it could be a function, a class, or you could have a separate folder alongside includes called php that has it in there, there's no right or wrong answer.\nPlugin standards say this about the structure of a plugin:\n\n*\n\n*It must be a PHP file with a comment at the top containing Plugin Name:\n\n*That comment can contain other items as well, but it must contain the plugins name, and it must be within the first XX bytes of the file\n\n*That file can be in the plugins folder, or, in a subfolder\n\n*That file will be loaded if activated before the theme/query, but after WordPress itself\n\nAnd that's it. Your plugin can be structured in any way you want. It can be a function and hook in a standalone file, or it could be a Symfony application with a custom entry point and hundreds of classes and folders. Neither is more correct than the other.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403991", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add new options to my WordPress plugin I'm the author of a small and simple WordPress plugin based on WodPress Plugin Boilerplate using WordPress Plugin Boilerplate Generator.\nMy plugins is Language Switcher for Transposh: it just allows to get a nicer language switcher if you're using Transposh Language Filter plugin (currently cut off by WordPress repo).\nIn the last version I have added a couple of options but I have realized that during the update the activation hook is not called so the new options aren't written to the database with the obvious consequence that my users get warning messages in the dashboard.\nWhat is the correct way to manage this situation?\nThank you in advance for any suggestion :)\n\nA: If you're storing a set of options, or a single option with a schema, you should do the following:\n\n*\n\n*keep a version number stored in the database, ideally as a separate value, though if you are using a single option with an array inside it, you could store it there\n\n*keep a version number in your plugin as a defined value in a file\n\n*on init or admin_init, compare the value in your plugin against the value in the database\n\n*\n\n*if they differ, run an upgrade function\n\n\n\nThis way your plugins data gets updated, even if no update/activation/deactivation occurs. Your existing method would fail if an old backup was restored, or a plugin was manually updated via FTP. This is what plugins such as GravityForms do, and they take advantage of this system to implement multiple functions to upgrade from 2 -> 3 -> 4 etc\nYou can also use the PHP function version_compare to use version comparisons:\nhttps://www.php.net/manual/en/function.version-compare.php\n$version = ... get version from database;\nif ( ! $version ) {\n    // fresh install!\n    do_first_time_install_of_marcos_plugin();\n} else if ( version_compare( MARCOS_PLUGIN_VERSION, $version, '>') ) {\n    // the plugin version is higher than what's in the DB!\n    do_marcos_plugin_upgrade();\n}\n\n\nA: I have finally found an answer in this very clear article at Sitepoint: WordPress Plugin Updates the Right Way. It is surprising I didn't get this result before, but evidently my search terms was not accurate enough.\nThe solution is to create a function to call when the plugin is loaded: in this function we have to check the current plugin version (which in WP Plugin Boilerplate is stored in a constant in the main plugin file) and the version number stored in the options (we must store and update the plugin version within your plugin's options). If the 2 versions are different we call our activation hook and voil\u00e0, les jeux sont fait!\nSo in WP Plugin Boilerplate I solved the issue this way:\nin the file includes/class-plugin-name.php I have added the follwing code in the define_admin_hooks() function:\n$this->loader->add_action('plugins_loaded', $plugin_admin, 'check_my_plugin_version');\n\nThen in the admin/class-my-plugin-name-admin.php file I have added this simple function:\nprivate function check_my_plugin_version()\n{\n    $options = get_option('my_plugin_options');\n    $installed_version = str_replace('.', '', $options['version']);\n    // MY_PLUGIN_VERSION is defined in the main plugin file\n    $current_version = str_replace('.', '', MY_PLUGIN_VERSION);\n    if ($installed_version !== $current_version){\n        require_once plugin_dir_path( __FILE__ ) . '../includes/class-my-plugin-name-activator.php';\n        My_plugin_name_Activator::activate();\n    }\n}\n\nNow the options in the database are updated everytime a new version of the plugin is installed, regardless of how the plugin was updated (automatically, manually using WordPress dashboard or manually using SFTP).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/403992", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to display relations via wordpress Rest API I have a CPT with relations i made and i need the relations to be sent via API Request. i edited it already so i can now see all meta fields in the API request but i cant get the relations to show. Any help would be greatly appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404001", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to make transition slider load before home page I created a transition slider using these instructions on this web site:\nhttps://www.greengeeks.com/tutorials/transition-slider-wordpress/\nNow I want to take the slider I created and use that as the the first thing seen on my web site before the home page loads on my website. In the slider settings, I enabled the Autoplay delay between transitions settings to 3000ms. How do I do that? Is this something I can set in the dashboard settings for my home page? I would appreciate any input on a possible solution.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404002", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Migrate the posts of a category to another blog as a custom taxonomy I'm running a multisite WordPress, and I need to so the following migration between 2 blogs:\n\n*\n\n*All the posts of a sub-category X that has the parent category programs from the blog A.\n\n*To the blog B under a sub-taxonomy X that has a parent custom taxonomy programs.\n\n*Blog A doesn't have the taxonomy programs, it only has it as a parent category.\n\n*Blog B has the taxonomy programs already created, but doesn't have it as a category.\n\n*And I need to migrate all the posts' related data and fields.\n\nI tried to use some export/import plugins, but none helped. I always was stuck at the point of the taxonomy types switch, and the similarity between the slug of the origin category in blog A and the target taxonomy in blog B.\nAny idea how to do it, please? And what are the steps or plugins that I have to use?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404003", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add media button always inserts media on the next wp_editor instance when created dynamically This is a really weird issue. I am trying to store data from a form in a plugin settings page and allow users to add html code with wp_editor. The users can dynamically add as many fields as they want to the form (and wp_editor fields, respectively). The problem is that when the user tries to add the media on a particular wp_editor, the media is added on the next wp_editor field instead. For example, if you have 2 wp_editor fields on the page and try to add image on the first one, it gets added on the second one.\nThis code adds the wp_editor within the form:\n<?php for ( $step = 1; $step <= $steps; $step++ ) : ?>\n    <tbody class=\"step\">\n        <tr valign=\"top\">\n            <th scope=\"row\"><label for=\"<?php echo esc_attr( 'stg_tour[description_' . $step . ']' ); ?>\"><?php esc_html_e( 'Step Description', 'simple-tour-guide' ); ?></label></th>\n            <?php\n            $content  = isset( $tour_options[ 'description_' . $step ] ) ? $tour_options[ 'description_' . $step ] : '';\n            $settings = array(\n                'textarea_name' => esc_attr( 'stg_tour[description_' . $step . ']' ),\n                'editor_class'  => 'form-field',\n                'wpautop'       => false,\n                'textarea_rows' => 5,\n            );\n            <td><?php wp_editor( wp_kses_post( $content ), $step, $settings ); ?></td>\n        </tr>\n    </tbody>\n<?php endfor; ?>\n\nThe following js function can add another set of fields, including another wp_editor\nfunction addNewStep() {\n    //get all steps\n    const steps = document.getElementsByClassName('step');\n    const lastStep = steps[steps.length - 1];\n\n    // get last step input fields\n    const lastStepFields = lastStep.getElementsByClassName('form-field');\n\n    // remove wp editor from last step to be able to copy it\n    if (typeof wp.editor != \"undefined\"){\n        wp.editor.remove(lastStepFields[1].id);\n    }\n\n    //new table body wrapper\n    const tbody_element = document.createElement('tbody');\n    tbody_element.className = 'step';\n\n    //create the new step\n    let newStep = lastStep.cloneNode(true);\n    table.appendChild(newStep);\n\n    table.insertBefore(newStep, lastStep)\n\n    // loop through last step fields and provide unique ids\n    for (let i = 0, n = lastStepFields.length; i < n; i++) {\n        const field = lastStepFields[i];\n\n        // set the id and name attribute\n        if (i == 0) {\n            //some logic\n        }\n        else if (i == 1) {\n            field.name = \"stg_tour[description_\" + counter + ']';\n            field.value = '';\n            field.id = +field.id + 1;\n\n            //reapply the wp editor\n            if (typeof wp.editor != \"undefined\"){\n                wp.editor.initialize(field.id - 1, {\n                    tinymce: {\n                        wpautop: false,\n                        plugins: 'charmap colorpicker compat3x directionality fullscreen hr image lists media paste tabfocus textcolor wordpress wpautoresize wpdialogs wpeditimage wpemoji wpgallery wplink wptextpattern wpview',\n                        toolbar1: 'bold italic underline strikethrough | bullist numlist | blockquote hr wp_more | alignleft aligncenter alignright | link unlink | fullscreen | wp_adv',\n                        toolbar2: 'formatselect alignjustify forecolor | pastetext removeformat charmap | outdent indent | undo redo | wp_help',\n                        textarea_rows : 5\n                    },\n                    quicktags: true,\n                    mediaButtons: true,\n\n                });\n                \n                wp.editor.initialize(field.id, {\n                    tinymce: {\n                        wpautop: false,\n                        plugins: 'charmap colorpicker compat3x directionality fullscreen hr image lists media paste tabfocus textcolor wordpress wpautoresize wpdialogs wpeditimage wpemoji wpgallery wplink wptextpattern wpview',\n                        toolbar1: 'bold italic underline strikethrough | bullist numlist | blockquote hr wp_more | alignleft aligncenter alignright | link unlink | fullscreen | wp_adv',\n                        toolbar2: 'formatselect alignjustify forecolor | pastetext removeformat charmap | outdent indent | undo redo | wp_help',\n                        textarea_rows : 5\n                    },\n                    quicktags: true,\n                    mediaButtons: true,\n                });\n            }\n        }\n    }\n}\n\nPlease note everything else is working correctly and data is stored. However, the image is not being inserted on the correct place and this is driving me crazy. If there is only one wp_editor, the image never gets inserted and is missing from html. No errors in console. Please help.\n\nA: Apparently the problem was that the id did not start with a letter and this caused all kinds of problems. Adding an incrementing number after the string fixed the issue:\n<td><?php wp_editor( wp_kses_post( $content ), 'id' .$step, $settings ); ?></td>\n\nThe credits for the answer should go to @Sally CJ. Thank you!!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404005", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to link to current post in WordPress? I'd need to get a permalink for this post (current post) in WordPress. Easy to do in PHP but I'd need to use it in the article itself so no PHP? I'd need a button that links to the current article. While this may sound silly, there's a reason for it but too hard to explain. :D How to proceed? Thanks a lot!\n\nA: This is exactly the type of scenario shortcodes are intended for. Simply add the following to your theme's functions file to create the shortcode:\nadd_shortcode( 'this_permalink', 'this_permalink' );\n\nfunction this_permalink($atts, $content){\n   return '<a href=\"'. get_the_permalink() .'\">Link to this article</a>';\n}\n\n.. and use this in your post to render the link:\n[this_permalink]\n\nI cannot think though, why you would want to link to a current article, but I guess you have your reasons :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404007", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: wp_kses_post escaping doesn't appear to work as described? https://developer.wordpress.org/plugins/security/securing-output/ describes wp_kses_post as:\n\nAlternative version of wp_kses() that automatically allows all HTML\nthat is permitted in post content.\n\nBut, that's not correct. As far as I can tell, absolutely any HTML is accepted into post content, whereas wp_kses_post excludes many tags: script, style, iframe, meta, etc.\nSo, is this description wrong or is my understanding wrong?\nThemes and plugins require escaping, so if you really want to allow all the same HTML that the post editor allows on a custom textarea, what's the true method?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404008", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Redirect 301 register page I have a custom register form page, and I want to create a 301 redirect to force people to use this form (and not the original URL of WordPress)\nI try to do a redirect 301 like this in my .htaccess, but it doesn't work.\nRedirect 301 /wp-login.php?action=register https://monsite.com/register/\n\nWhat's wrong here?\n\nA: I would advice you to not use the htaccess for this, but to use a WordPress hook instead.\nCheck out https://developer.wordpress.org/reference/hooks/login_url/\n\nA: I would suggest you follow @DeltaG's advice in their answer. However, to answer your specific question...\n\nRedirect 301 /wp-login.php?action=register https://example.com/register/\n\n\nThis will never match because the Redirect (mod_alias) directive matches against the URL-path only, not the query string.\nTo perform this redirect in .htaccess you would need to do something like the following using mod_rewrite at the top of the .htaccess file, before the existing WordPress code block (ie. before the # BEGIN WordPress comment marker):\nRewriteCond %{QUERY_STRING} ^action=register$\nRewriteRule ^wp-login\\.php$ https://example.com/register/ [R=301,QSD,L]\n\nThe QSD flag is necessary to remove the original query string from the request.\n\nA: Like @DeltaG said, filtering the login_url is a better option than using a .htaccess redirect. If you absolutely need to use .htaccess, follow @MrWhite answer.\nHere is an approach using default WordPress hooks..\nfunction wpse404009_redirect_to_custom_registration_page() {\n\n    global $pagenow;\n    \n    if ( $pagenow == 'wp-login.php' && ! empty( $_REQUEST['action'] ) && $_REQUEST['action'] === 'register' ) {\n        //We are on the registration page, redirect now.\n        wp_redirect( get_permalink(999), 301 ); ; //Change 999 to the ID of your registration page\n        exit;\n    }\n}\nadd_action( 'login_init', 'wpse404009_redirect_to_custom_registration_page' );\n\nIf you want to filter the login_url.\nfunction wpse404009_custom_login_page( $login_url, $redirect, $force_reauth ) {\n    \n    //Get the custom login page URL.\n    $login_url = get_permalink(999); //Change 999 to the ID of your login page\n    \n    if ( !empty($redirect)) {\n        $login_url = add_query_arg( 'redirect_to', urlencode( $redirect ), $login_url );\n    }\n    return $login_url;\n}\nadd_filter( 'login_url', 'wpse404009_custom_login_page', 10, 3 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404009", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Elementor\\Scheme_Typography' not found I just update my elementor plugin and suddenly my site goes down its display this error.\ncode line error shows: 224.\n$element->add_group_control(\n            Group_Control_Typography::get_type(),\n            [\n                'name' => 'eael_tooltip_section_typography',\n                'selector' => '.tippy-popper[data-tippy-popper-id=\"{{ID}}\"] .tippy-tooltip',\n                 'scheme' => Scheme_Typography::TYPOGRAPHY_3,\n                'separator' => 'after',\n                'condition' => [\n                    'eael_tooltip_section_enable!' => '',\n                ],\n            ]\n        );\n\n\nA: Scheme_Typography is deprecated. Use \\Elementor\\Core\\Schemes\\Typography instead\nhttps://forum.elementor.com/development-24/deprecated-elementor-scheme-typography-solved-sure-9919\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404010", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Use get_cat_ID to retreive multiple category IDs I am trying to use the names of categories stored in user meta (ie users' preferences) to control an on-page query\u2019s parameters.\n$topicsofinterest = get_user_meta(get_current_user_id(),'topics_of_interest',true);\n\n// returns\n\narray(3) { [0]=> string(8) \"Business\" [1]=> string(27) \"DIY, crafts and houskeeping\" [2]=> string(5) \"Music\" }\n\nThis needs to be converted in '8','9','10' so it can be used in category__in\nI know I need to use the get_cat_id function to lookup the category ID and I have successfully done this using individual category names, eg\nget_cat_ID (\u2018Business')\n\n//returns correct category ID as int\n\nHowever, when I try a foreach loop\nforeach($topicsofinterest as $topicofinterest){\n        get_cat_ID($topicsofinterests);\n    }\n\n$topicofinterest returns string(5) \"Music\"\nHow do I get a clean list of category IDs, ie '8','9','10'??\n\nA: $category_in = array();\nforeach($topicsofinterest as $topicofinterest){\n\n    //Chaneg 'category' to the taxonomy name.\n    $term = get_term_by( 'name', $topicofinterest, 'category');\n    \n    $category_in[] = $term->term_id;\n}\n\nJust curious, why don't you store the category ID instead of category name in user meta?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404014", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Rest API code to get ID of current user not working: get_current_user_id() gives 0 Background\nI am trying to write Rest API code to get the ID of the user who triggers the function in question. I found a fantastic answer to this exact question, that was very kindly provided by user leymaxx: https://wordpress.stackexchange.com/a/329992/220571\nProblem and Theories of Cause\nHowever, when I test this code (by sending a Get request to my endpoint, using Postman), it always returns 0 when I call get_current_user_id(). I cannot figure out why it is doing this, but I have three theories:\n\n*\n\n*I may have implemented this wrong. That is, although the answer provided code, it did not explain exactly where it should be placed. I also needed to add some boilerplate such as declaring a plugin. I think I have worked this out, but I could be mistaken.\n\n*The Rest API may have changed since the answer was posted. The question was from 2 years ago, so possibly there has been some subtle syntactical change due to an update.\n\n*The API may not be able to detect that I am logged in. My website is in maintenance mode, so perhaps this prevents the API from detecting that I am logged in. I logged in by clicking \"Visit Site\" from my WordPress Dashboard, and confirmed this worked by viewing the My Account page from within my site.\n\nQuestion\nIf anyone has any ideas of where I have gone wrong, please would you let me know? If so I would very much appreciate it, and I believe that having a fully detailed answer would also help other developers who encounter this common requirement.\nThe details of my overall approach, and the complete code that I used are given below.\nOverall Approach\nThe steps I took were as follows:\n\n*\n\n*I created a new folder in the following location within my file management system: public_html/wp-content/plugins/example-plugin.\n\n*In this folder I created two files: example-plugin.php and example-script.js.\n\n*The code contained in these two files is shown below, and is basically identical to the above mentioned answer.\n\nCode Used\nThe contents of example-plugin.php are as follows:\n<?php\n/**\n* Plugin Name: Example Plugin\n* Plugin URI: https://www.example.com/\n* Description: Example Description.\n* Version: 1.0\n* Author: John Smith\n* Author URI: https://www.example.com/\n**/\nclass MyPlugin {\n\n  public function __construct() {\n\n    add_action('wp_enqueue_scripts', [$this, 'scripts']);\n    add_action('rest_api_init', [$this, 'rest']);\n  }\n\n  function scripts() {\n\n    // Add JS.\n    wp_enqueue_script('my-plugin', 'http://www.example.com/wp-content/plugins/example-plugin/example-script.js', ['jquery'], NULL, TRUE);\n    // Pass nonce to JS.\n    wp_localize_script('my-plugin', 'MyPluginSettings', [\n      'nonce' => wp_create_nonce('wp_rest'),\n    ]);\n  }\n\n  function rest() {\n\n    // Register route.\n    register_rest_route('my-plugin/v1', '/uid', [\n      'methods'  => WP_REST_Server::READABLE,\n      'callback' => [$this, 'rest_callback'],\n    ]);\n  }\n\n  function rest_callback($data) {\n\n    // Get current user ID.\n    $data = [\n      'uid' => get_current_user_id(),\n    ];\n\n    $response = new WP_REST_Response($data, 200);\n    // Set headers.\n    $response->set_headers(['Cache-Control' => 'must-revalidate, no-cache, no-store, private']);\n\n    return $response;\n  }\n\n}\n\nnew MyPlugin();\n\nThe contents of example-script.js are as follows:\n(function($) {\n\n  $(document).ready(function() {\n\n    var settings = MyPluginSettings;\n\n    $.ajax({\n      url: '/wp-json/my-plugin/v1/uid',\n      method: 'GET',\n      beforeSend: function(xhr) {\n        xhr.setRequestHeader('X-WP-Nonce', settings.nonce);\n      }\n    }).done(function(response) {\n\n      // Will return your UID.\n      console.log(response);\n    });\n\n  });\n\n})(jQuery);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404018", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Pull data from MySQL and add it to terms I need to do something above my knowledge base. Here's what I need to do:\nPulling data from a specific column, copy it to wp_terms table, make the relationship with the appropriate taxonomy and repeat this process automatically every week.\nIt is important that when repeating the process, only data that are not existing in wp_terms table should be copied. More clearly:\nI have a table named wp_coins with thousands of cryptocurrencies:\n\n\n\n\nid\ncoin_id\nname\nsymbol\nprice\n\n\n\n\n1\nbitcoin\nBitcoin\nBTC\n\n\n\n2\nethereum\nEthereum\nETH\n\n\n\n3\ntether\nTether\nUSDT\n\n\n\n\n\nI created a custom taxonomy named 'coins' and I need to copy under it all data in 'symbol' column from wp_coins. Since new cryptocurrencies are added automatically to wp_coins, I need to check every week if we have new listing and if so, add it to wp_terms. I guess all the process should create the relationship with my custom taxonomy too.\nI already know there is a few way to do it with plugins (export data with xls , filter it manually and import it etc) but checking manually new listings, filtering, etc will take a lot of time. So, if there is any MySQL or $wpdb way to do it, any help on this would be great. Thank you for your time!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404023", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: `offset` WP_Query argument dont work via `pre_get_posts` I have some weird problem because pre_get_posts filter completely ignoring offset argument.\nHere is function from functions.php file:\nfunction custom_category_query (WP_Query $the_query) {\n    if ( !is_admin() && $the_query->is_main_query() && !is_category() ) {\n        return $the_query;\n    } \n    elseif (!is_admin() && $the_query->is_main_query() && is_category() ) {             \n\n        $ppp = 6;\n        $stickies = get_option( 'sticky_posts' );\n        $the_query->set( 'offset', '5' );\n        $the_query->set( 'posts_per_page', $ppp );\n        $the_query->set( 'post__not_in', $stickies );\n        return $the_query;\n        \n    } else return $the_query;\n}\nadd_action('pre_get_posts', 'custom_category_query', 1);\n\n\nHere are my arguments from category.php file:\n$category = get_queried_object();   \n$stickies = get_option( 'sticky_posts' );\n$paged = ( get_query_var( 'paged' ) ) ? get_query_var( 'paged' ) : 1;\n\n$args = array(\n    'post_type'             => 'post',\n    'posts_per_page'        => 6,\n    'post__not_in'          => $stickies,\n    'cat'                   => $category->term_id, \n    'paged'                 => $paged\n);\n\n$the_query = new WP_Query($args); \n\nFunction: Every $the_query->set works fine except the offset one. Posts are loaded with suggested post_per_page && post__not_in arguments, but query completely ignore offset argument what cause the_posts_pagination function do not return the right result.\nCategory file: What is more annoying, in category.php adding offset to the query arguments cause that every pagination page returns posts from first page.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404027", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get other posts sharing the same meta values I want to get all posts having the same meta values.\nMy Post A has 2 meta values: ID 182 and ID 183\nI want to have all post having meta 182 or 183, excepting the current one of course.\nI have tried:\n$metaSearch = [\n    'relation' => 'OR'\n];\n\n// tags are the tags (meta tag_initiative) of current post\nif ($tags) {\n    foreach ($tags as $tag) {\n        $metaSearch [] = [\n            'key' => 'tag_iniative',\n            'value' => $tag->term_id,\n            'compare' => '=',\n        ];\n    }\n}\n// array(2) { [\"relation\"]=> string(2) \"OR\" [0]=> array(3) { [\"key\"]=> string(12) \"tag_iniative\" [\"value\"]=> int(182) [\"compare\"]=> string(1) \"=\" } }\nvar_dump($metaSearch);\n\n$initiativesOther = get_posts([\n    'orderby' => 'publish_date',\n    'order' => 'DESC',\n    'post_type' => 'initiative',\n    'posts_per_page' => 4,\n    'exclude' => [get_the_ID()],\n    'meta_query' => $metaSearch,\n]);\n\nThis won't bring me any post, but:\n$initiativesOther = get_posts([\n    'orderby' => 'publish_date',\n    'order' => 'DESC',\n    'post_type' => 'initiative',\n    'posts_per_page' => 4,\n    'exclude' => [get_the_ID()],\n    'meta_query' => [\n        'key' => 'tag_iniative',\n        'value' => 182,\n        'compare' => '=',\n    ],\n]);\n\nWill work and shows me an other post. How can I do that ?\n\nA: you can set the meta like this\n'meta_query' => [\n    'key' => 'tag_iniative',\n    'value' => [182,183],\n    'compare' => 'IN',\n]\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404029", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Getting more info about the taxonomy? select *\n            from wp_term_taxonomy\n            join wp_term_relationships relation on relation.term_taxonomy_id = wp_term_taxonomy.term_id\n            group by wp_term_taxonomy.term_id\n\nI am using this query, but it doesn't tell me what the taxonomy is for, the only useful information is the taxonomy, which is a string, but the description is empty, so I am just given some numbers, is there a way to check the name in anyway?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404030", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Animation Adjustments I have a problem with my WordPress animations. https://cyals.com is the website Currently developing. I Use Elementor Page Builder to build my page. a man and a woman load with animations one by one on my page. I Used \"Slide in Left\" and \"Slide in Right\" animations as Entrance Animation in Motion Effects in Elementor. The woman load from the edge of the page. but I want to load it only inside the column. I don't Know How to do it. Please Help me.\n\nA: Adding the following CSS property to the column will hide the woman until she is inside the column. But there will probably be a delay while she animates in the hidden area.\noverflow-x: hidden;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404031", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Different background colors for posts with Wordpress I have a question. Right now I displayed my posts in the next way: Title and under it a short description of that post(everything centered and the post is looking like a card). My client wants each post to have a background color and a text color, but set by him, something like on this site: https://the.loeuvre.co/. Do you have any ideas of how can I make this? Yes, I can give a random class to each post and created those classes with background and color but I don't know if it will appear something new and it will be too many classes with a lot of combinations. Thank you!\n\nA: If the site uses the Block Editor, support is already built in. Add a Group block first, and set its background color. You can then add blocks inside the Group block and set their text colors.\nYou can define a specific palette for your theme so there are set colors, or you can let WordPress set default color palettes. It also supports custom colors so you can use a color picker to define whatever combinations you want.\nIt would be wise to educate the client on accessibility as it relates to color contrast. It may also be helpful to educate the client on the ways having defined, predictable color and UI schemes is helpful to visitors who navigate through multiple pages on the site - changing colors frequently may create a jarring or difficult-to-read experience.\n\nA: Thank you for your response but I forgot to add the code:\n<div class=\"latest-posts\">\n    <?php\n        $args = array(\n            'post_type' => 'post',\n            'posts_per_page' => 5,\n            'orderby' => 'date',\n            'order' => 'DESC',\n            'post_status' => 'publish',\n            'paged' => 1,\n        );\n        $my_posts = get_posts($args);\n        if(!empty($my_posts)){\n            foreach($my_posts as $post){ ?>\n                <div class=\"article\">\n                    <div class=\"article-text\">\n                        <div class=\"title\">\n                            <?php echo get_the_title($post); ?>\n                        </div>\n                        <div class=\"short-article-content\">\n                            <?php echo the_excerpt(); ?>\n                        </div>\n                    </div>\n                </div>\n            <?php }\n        }\n    ?>\n   \n</div>\n<button class=\"load-more-homepage-articles-btn btn\">Load more articles</button>\n\nThis is my code in articles.php(template that I use it on article page). I want to add that background color and color to the article class. Yes, The site will use Block Editor. It's not a problem about colors. He know about how to use/choose hex and rgba\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404033", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to show multi line output from metabox In a plugin I have made (Snup Widget) I have made a metabox.\nIn the sample here I have made two line with text. When I want to show the text in output in the widget it shows in one line, without break.\nIf I write the text in two lines, and save the post.\nThe text is still in two lines when I load / open the post editor again.\nThe problem is that they show up in one line in the output, not in two line as in editor.\n\nI have now edited some of the code, but the problem is still that the text show up in one long line in the output.\n\nThe file is here:\nhttps://github.com/bjovaar/SNUP/tree/main/new-output\n/*\n * ---------------------------------- *\n * Show the info in SNUP\n * ---------------------------------- *\n */\nfunction snupwidget_upcoming_posts() { \n\n    $output = '';\n\n    // The query to fetch future posts\n    $the_query = new WP_Query(array( \n        'post_status' => 'future',\n        'posts_per_page' => 1,\n        'orderby' => 'date',\n        'order' => 'ASC'\n    ));\n \n\n// The loop to display posts\nif ( ! $the_query->posts ) {\n  return sprintf(\n    '<div class=\"snup_noplan\">%s</div>',\n    esc_html__('No planned posts yet.', 'snup-lang')\n  );\n}\n\n$items = array();\nforeach ($the_query->posts as $post) {\n\n  $snuptext = get_post_meta( $post->ID, 'snuptext', true );\n  if ( $snuptext && is_string( $snuptext ) ) {\n    // turn linebreaks to <br>\n    // @source https://www.php.net/manual/en/function.nl2br.php#73440\n    $snuptext = str_replace(array(\"\\r\\n\", \"\\r\", \"\\n\"), \"<br />\", $snuptext);\n  } else {\n    $snuptext = '';\n  }\n  \n  $items[] = sprintf(\n    '<li>\n      %s\n      <div class=\"snup_title\">%s</div>\n      <div class=\"snup_text\">%s</div>\n      <div class=\"snup_published\">%s</div>\n      <div class=\"snup_time\">%s</div>\n    </li>',\n    get_the_post_thumbnail($post),\n    esc_html( $post->post_title ),\n    esc_html( $snuptext ),\n    esc_html__('Published', 'snup-lang'),\n    get_the_time('d.m.Y H:i', $post)\n  );\n}\n\nreturn sprintf('<ul>%s</ul>', implode('', $items));\n}\n \n\n\n\n// Add shortcode\nadd_shortcode('snup-widget', 'snupwidget_upcoming_posts'); \n// Enable shortcode execution inside text widgets\nadd_filter('widget_text', 'do_shortcode');\n\n\n?>\n\n\nA: I had a new look now at the sprintf() part of the example I shared in my answer to your previous question. The thing that might contribute to the rendering problem is the esc_html( $snuptext ) line as it is basically disabling the <br> tags that are added with the str_replace() earlier. (I'm so used to using esc_html that I'm almost blind to it.)\nSo the sprintf would look like this,\n$items[] = sprintf(\n    '<li>\n      %s\n      <div class=\"snup_title\">%s</div>\n      <div class=\"snup_text\">%s</div>\n      <div class=\"snup_published\">%s</div>\n      <div class=\"snup_time\">%s</div>\n    </li>',\n    get_the_post_thumbnail($post),\n    esc_html( $post->post_title ),\n    $snuptext,\n    esc_html__('Published', 'snup-lang'),\n    get_the_time('d.m.Y H:i', $post)\n  );\n\nI tested this locally in my sandbox WP and it seemed to work.\nIf you don't want to allow other html in the widget excerpt text, then you could do something like this when doing the str_replace.\n$snuptext = str_replace(array(\"\\r\\n\", \"\\r\", \"\\n\"), \"<br />\", strip_tags($snuptext));\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404037", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disable featured image From the description of the plugin \"Hide Featured Image\":\n\nThere are instances when one wants to show featured image on single\npost and hide it on another post. This plugin will allow you to show\nor hide featured image from single post page.\n\nIndeed there are such instances, including with custom post types, but unfortunately the solution from the plugin, shown below, is a css solution that just hides the featured image instead of programmatically \"dequeuing\" or disabling it:\nfunction sh_featured_image() {\n    \n    if( is_single() || is_page() ){\n\n      $hide = false;\n      $sh_hide_all = get_option('sh_hide_all_image');/* Hide all post or image */\n      $hide_image =  get_post_meta( get_the_ID(), '_hide_featured', true );/* Hide single post */\n      \n\n      $hide = ( is_page() && isset( $sh_hide_all['page_image'] ) && $sh_hide_all['page_image'] && $hide_image != 2 ) ? true : $hide ; \n      $hide = ( is_singular( 'post' ) && isset( $sh_hide_all['post_image'] ) && $sh_hide_all['post_image'] && $hide_image != 2 ) ? true : $hide ; \n      $hide = ( isset( $hide_image ) && $hide_image && $hide_image != 2 )? true : $hide;/* Hide single post */\n      \n      if( $hide ){ ?>\n          <style>\n          .has-post-thumbnail img.wp-post-image, \n          .attachment-twentyseventeen-featured-image.wp-post-image { display: none !important; }          \n          </style><?php\n      }\n    }\n}\n\nSource.\nObviously, the css selector .attachment-twentyseventeen-featured-image.wp-post-image only pertains to the Twenty Seventeen theme, whereas the css selector .has-post-thumbnail img.wp-post-image is more generic.\nIn my concrete use case, the featured image should not be shown on individual custom post type pages, but it should be shown on category pages listing all the items of the custom post type.\nIs it possible to programmatically disable or \"dequeue\" the featured image on certain pages/posts rather than simply hiding it with css without editing any of the theme templates (or creating a new one)?\n\nA: It is definitely possible.  We may need more info though.  Do you know how to use page templates?  Copy your single.php (or your page.php) from your theme and name it single-your-cpt-slug.php.  (Replace 'your-cpt-slug' with your actual cpt slug).  Within this file remove the call to the featured image.   This is a pretty generic answer without knowing more about your setup or what your code looks like.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404039", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: List only parent attributes on woocommerce admin atrributes page I would like to add option on attributes page screen options, to filter out only parent attributes.\nThe main struggle is that I can't even alter the query... I tried actions: parse_query, pre_get_posts but it looks like these are not suitable for taxonomy query.\npublic function prepare_items() - doesn't have any hook to add more arguments...\nPlease point me to the right direction.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404040", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Resting a site for a couple of years I have an old website. I plan on not publishing it for a couple of years. I\u2019ll need it in the future, but I don\u2019t need it now. Therefore, I don\u2019t need to pay for the hosting.  I\u2019m a complete beginner. Can you let me know how I can save the content somewhere and switch off the hosting, but keep my content safely? Thanks very much.\n\nA: You can use a myriad of plugins out there, or do it manually.\nPlugin:\nAlmost never used one, from the looks of it, this should do the job: https://wordpress.org/plugins/all-in-one-wp-migration/ - you can also search for other plugins that \"migrate\".\nMake sure that the exported *.zip (or other format) file contains the database, the code and other resources like uploads. Best would be to use this dump to re-install locally.\nManually:\nIn order to replicate a wordpress website you would need the following:\n\n*\n\n*Database\n\n*Code\n\n*Other resources like uploads\n\nThe code+resources is stores on the hosting, probably FTP, SFTP. You probably have also a local copy of the code, but not nessesary the resources, so try to just download it all. If you have Staging and Production, make sure to backup each separately.\nThe database is probably hosted by your hosting service, but stored on a separate server, if you have access to cPanel you can search for phpmyadmin. This is a graphic interface to work with your database. There you can export the database in *.sql form.\nIf you cannot find a way to export the database, ask your hosting provider. If you have Staging and Production, ask them for DB dump of both.\nNote:\nThe database contains direct link to the hosting domain. Use tools like search-replace, wp cli search-replace or interconnectit\n\nA: Relying on a plugin to take the backup would be a bad idea. You'll never know if that plugin will be there in 2 years. Go for a manual backup.\n\n*\n\n*Take the MySQL database backup from phpMyAdmin. Every cPanel has option to access it from there.\n\n\n*Take the files backup from FTP (Or you can compress the whole installation folder from File Manager in cPanel).\nYou are done.\nA quick note. A lot will change in 2 years so do WordPress. When you reinstall/restore everything after 2 years, you will be prompted to update WordPress and Plugins. I'd recommend updating WordPress first, that too manually step by step for major releases.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404042", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Merge 2 custom post type posts and taxonomy terms and sort ascending We have a most recent block where we query a taxonomy for a custom post type and posts from two custom post types. This we do using this code\nFull Code\n<?php\n/**\n * Highlights block\n *\n**/\n// Create id attribute allowing for custom \"anchor\" value.\n$id = 'highlights-' . $block['id'];\nif( !empty($block['anchor']) ) {\n    $id = $block['anchor'];\n}\n\n// Create class attribute allowing for custom \"className\" and \"align\" values.\n$className = 'block-highlights ';\nif( !empty($block['className']) ) {\n    $className .= ' ' . $block['className'];\n}\nif( !empty($block['align']) ) {\n    $className .= ' align' . $block['align'];\n}\n\n$taxonomy = 'molecules_of_the_month';\n$parent_args = [\n    'taxonomy'      => $taxonomy,\n    'parent'        => 0,\n    'hide_empty'    => false,\n    'number'        => 1,\n    'fields'        => 'ids',\n];\n//get the first parent year\n$parent_terms = get_terms( $parent_args );\n//print_r($parent_terms);\n\n$child_args = [\n    'taxonomy'      => $taxonomy,\n    'parent'        => $parent_terms[0],\n    'hide_empty'    => false,\n    'number'        => 1,\n    'fields'        => 'ids',\n];\n//get the children\n$child_terms = get_terms( $child_args );\n//print_r($child_terms);\n\n\n//setup the queries getting only ids\n$query1 = new WP_Query(array('fields' => 'ids', 'post_type' => 'molecule', 'posts_per_page' => 2 ));\n$query2 = new WP_Query(array('fields' => 'ids', 'post_type' => 'resource', 'posts_per_page' => 2));\n$query3 = new WP_Query(array('fields' => 'ids', 'posts_per_page' => 3 ));\n\n\n//now you got post IDs in $query->posts\n$merged_ids = array_merge($query1->posts, $query2->posts, $query3->posts);\n\n//new query, using post__in parameter\n$highlights = new WP_Query(array('post__in' => $merged_ids, 'post_type' => array('post', 'molecule', 'resource') ));\n\n?>\n\n<div id=\"<?php echo esc_attr($id); ?>\" class=\"<?php echo esc_attr($className); ?>\">\n<?php if($highlights): ?>\n<div class=\"slider mobile-slider splide\" data-splide='{ \"type\" : \"loop\", \"perPage\": \"3\", \"arrows\": 0, \"breakpoints\": { \"99999\": { \"destroy\": 1 }, \"767\": { \"perPage\": \"1\" } } }'>\n      <div class=\"splide__track\">\n<ul class=\"post-grid splide__list\">\n    <?php\n    //output MOTM\n    if($child_terms):\n    foreach ( $child_terms as $child_term ) {\n        //get term object\n        $term = get_term_by( 'id', $child_term, $taxonomy ); \n        //print_r($term);\n    ?>\n    <li class=\"post-grid-post splide__slide\">\n        <a href=\"<?php echo get_term_link($term); ?>\">\n            <?php \n            //get featured image\n            $featured_image = get_field('tax_featured_image', $term);\n            if( $featured_image ) {               \n            ?>\n            <figure class=\"post-featured-image\">\n                <?php  echo wp_get_attachment_image( $featured_image, 'full' ); ?>\n            </figure>\n            <?php\n            }\n            ?>\n            <ul class=\"cat-pill-list\">\n                <li class=\"cat-pill\" style=\"background: #38E8AD;\">\n                    Molecules of the Month\n                </li>\n            </ul>\n            <h2 class=\"post-grid-title\"><?php echo $term->name; ?></h2>\n    <?php\n        $description = get_term_meta( $child_term, 'intro_text', true );\n        \n        if($description){\n        ?>\n        <p> <?php echo wp_trim_words($description, 19); ?></p>\n        <?php\n        }else{\n                echo wp_trim_words(term_description($term), 19 ); \n        }\n    ?>\n            <p class=\"reading-time\"><?php echo dh_display_read_time(); ?></p>\n        </a>\n    </li>\n    <?php\n    }\n    endif;\n    ?>\n<?php while( $highlights->have_posts() ) : $highlights->the_post(); ?>\n<!-- Post Content goes here -->\n    <li class=\"post-grid-post splide__slide\">\n        \n        <a href=\"<?php the_permalink(); ?>\">\n            <figure class=\"post-featured-image\"><?php the_post_thumbnail(); ?></figure>\n            <?php\n           $post_id = get_the_ID();\n            if ( get_post_type( $post_id ) == 'resource' ) {\n                $cats = get_the_terms( $post_id, 'resource_category');\n                if($cats):\n        ?>\n        <ul class=\"cat-pill-list\">\n        <?php\n                foreach ( $cats as $cat):\n                    \n                    $category_color = get_field('category_color', $cat);\n                    $cat_text_color = get_field('cat_text_color', $cat);\n        ?>\n            <li class=\"cat-pill <?php echo $cat_text_color; ?>\" style=\"background: <?php echo $category_color; ?>;\">\n                <?php echo $cat->name; ?>\n            </li>\n        <?php\n                endforeach;\n        ?>\n        </ul>\n        <?php\n                endif;\n            }elseif( get_post_type( $post_id ) == 'molecule' ){\n        ?>\n            <ul class=\"cat-pill-list\">\n                <li class=\"cat-pill\" style=\"background: #38E8AD;\">\n                    Molecules of the Month\n                </li>\n            </ul>\n        <?php        \n            }else{\n        ?>\n            <ul class=\"cat-pill-list\">\n                <li class=\"cat-pill light\" style=\"background: #EB546B\">\n                    Article\n                </li>\n            </ul>\n        <?php        \n            }\n        ?>\n            <h2 class=\"post-grid-title\"><?php the_title(); ?></h2>\n            <?php echo dh_excerpt(); ?>\n            <p class=\"reading-time\"><?php echo dh_display_read_time(); ?></p>\n        </a>\n    </li>\n\n<?php endwhile; wp_reset_postdata();?>\n</ul>\n      </div>\n</div>\n<?php endif; ?>\n</div>\n\nBut we want to mix $hightlights and filter the taxonomy, two custom post types by most recent, not do these three separately in their own content boxes by date.\nWe could add an ACF date picker field so we can sort taxonomies by a chosen date\n'meta_key' => 'month_date', // name of custom field\n'orderby' => 'meta_value_num',\n'order' => 'ASC',\n\nbut that is only the start.\nClarifications\nChild terms are the months which are parents of years. Each child term has a number of custom post type posts (molecules).\n$highlights should show a most recent block with a mix of articles (posts), resources (custom post type posts) and child terms or molecules of the month and all in chronological order. A most recent block basically showing the latest resource articles, general articles and child therms and two of each. Currently we always get child terms first and then the content posts. And we want them to truly be mixed and loading in ascending order.\nQuestion\nHow can we do this? How do you use this merged array and then query the latest two of each and mix them all up and sort ascending (latest first)?\nExample\nAscending Order:\n\n*\n\n*molecule 31/03/2022 (cpt)\n\n*molecule of the month March 2022 (child term of year 2022)\n\n*resource 28/03/2022 (cpt)\n\n*resource 27/03/2022 (cpt)\n\n*article 26/03/2022 (post)\n\n*molecule of the month February 2022 (child term of year 2022)\n\n*article 20/03/2022 (post)\n\n\nA: There's way too much information in this, so much so that it's difficult to understand your question.  First, I'd like to state my understanding of what I think you are asking.\nYou have a hierarchical taxonomy molecules_of_the_month and 3 post types the build-in post, a CPT molecule, and a CPT resource. What I think you want is an array containing one WP_Term object followed by several WP_Post objects: the taxonomy object is the most recent category (i.e. parent=2022, child=April); those post objects would contain the two most recent molecules, 2 most recent resources, and 3 most recent posts; and those post objects would be sorted by date. The items of the array are then displayed in blocks.\nWith that understanding, I'd like to demonstrate the answer by using code:\n/**\n *  First, let's compile an array of the things we want to display.  The\n *  posts are the easy part, so let's do those first.\n */\n$mort = array();\n// Go thru the post types and the number of them we want.  Can change these numbers to get more/less of each post type.\nforeach(array(\n    'post'      => 3,\n    'molecule'  => 3,\n    'resource'  => 3,\n) as $post_type => $numberposts) {\n    // Get the `n` most recent posts of each type.\n    foreach(get_posts(array(\n        // By default, returns published posts descend sorted by date.\n        'numberposts'   => $numberposts,\n        'post_type'     => $post_type,\n    )) as $p) {\n        // Save date as key so we can easily sort later.\n        $mort[date('Y-m-d', get_post_datetime($p, 'date', 'gmt')->getTimestamp()).'-0'] = $p;\n    }\n}\n\n/**\n *  Time to query taxonomies.  We have to look at the name of the term because the\n *  user might assign \"January\" and \"1981\" to a \"molecule\" post dated 15 October 2021\n *  with the intention it be a molecule of the month in Jan '81.\n */\nforeach($mort as $p) {\n    // Grab the post's molecules_of_the_month terms\n    $terms = get_the_terms($p, 'molecules_of_the_month');\n    // Check is required as might be FALSE or WP_Error.\n    if(is_array($terms)) {\n        // Look at all the terms (could be empty if a 'resource' or\n        // 'post' in which case this foreach-block will not execute).\n        foreach($terms as $term) {\n            if(!empty($term->parent)) {\n            // We found a month MOTM term.  The post might have a publish date in\n            // a different month, so it is necessary to generate a key for sorting\n            // from the term itself.\n            $date_str = '1 '. $term->name .' '. get_term($term->parent, $term->taxonomy)->name;\n            $date_str = date('Y-m-t', strtotime($date_str));\n            $mort[$date_str.'-1'] = $term;\n            }\n        }\n    }\n}\n\n/**\n *  All done adding stuff to the array.  It's now time to sort this big pile\n *  of goop.  As we saved each object in a key having a specially formatted\n *  date, all we need to do is sort by that key.  We want the most recently\n *  dated object to be at index=0, so we key sort decending.\n *\n *  A word on our date keys:  they are in YYYY-MM-DD format.  Also, notice\n *  the -0 and -1 appended to the end of the date (0 for posts, 1 for terms)?\n *  That's so taxonomies are sorted closer to index=0 than posts.  (Rather have\n *  posts be given priority:  change -0 suffix to -1 on line 21; change\n *  -1 suffix to -0 on line 43; and change the \"Y-m-t\" to \"Y-m-01\" on line 43.\n */\nkrsort($mort);\n\n/**\n *  Now that we have our array of data, its time to display.  For\n *  simplicity, let's create two functions for HTML output:  one to\n *  output a term; and another to output a post.\n */\nif(!function_exists('mort_output_term_block')) { // Protection\nfunction mort_output_term_block($term) {\n    ?><a href=\"<?php echo get_term_link($term); ?>\"><?php \n        //get featured image\n        $featured_image = get_field('tax_featured_image', $term);\n        if($featured_image) {\n            ?><figure class=\"post-featured-image\">\n                <?php echo wp_get_attachment_image($featured_image, 'full'); ?>\n            </figure><?php\n        }\n        ?><ul class=\"cat-pill-list\">\n            <li class=\"cat-pill\" style=\"background: #38E8AD;\">\n                <?php _e('Molecules of the Month') ?>\n            </li>\n        </ul>\n        <h2 class=\"post-grid-title\"><?php echo $term->name; ?></h2>\n        <?php\n        $description = get_term_meta( $term, 'intro_text', true );\n        if($description) {\n            ?><p><?php echo wp_trim_words($description, 19); ?></p><?php\n        } else {\n            echo wp_trim_words(term_description($term), 19);\n        }\n        ?><p class=\"reading-time\"><?php echo dh_display_read_time(); ?></p>\n    </a><?php\n}}\nif(!function_exists('mort_output_post_block')) { // Protection\nfunction mort_output_post_block($_post) {\n    // Set the global post so we don't have to pass it to all of the\n    // template functions.  Also, remember the old global post so we can\n    // restored it when we're done with the output of this block.\n    global $post;\n    $post_saved = $post;\n    $post = $_post;\n    ?><a href=\"<?php the_permalink(); ?>\">\n        <figure class=\"post-featured-image\">\n            <?php the_post_thumbnail(); ?>\n        </figure><?php\n        switch(get_post_type($post)) {\n            case 'resource':\n                $cats = get_the_terms($post, 'resource_category');\n                if($cats) {\n                    ?><ul class=\"cat-pill-list\"><?php\n                    foreach($cats as $cat) {\n                        $text_color = get_field('cat_text_color', $cat);\n                        $cat_color = get_field('category_color', $cat);\n                        ?><li class=\"cat-pill <?php echo $text_color; ?>\" style=\"background: <?php echo $cat_color; ?>;\">\n                            <?php echo $cat->name; ?>\n                        </li><?php\n                    }\n                    ?></ul><?php\n                }\n                break;\n            case 'molecule':\n                ?><ul class=\"cat-pill-list\">\n                    <li class=\"cat-pill\" style=\"background: #38E8AD;\">\n                        <?php _e('Molecules of the Month'); ?>\n                    </li>\n                </ul><?php\n                break;\n            default:\n                ?><ul class=\"cat-pill-list\">\n                    <li class=\"cat-pill light\" style=\"background: #EB546B\">\n                        <?php _e('Article'); ?>\n                    </li>\n                </ul><?php        \n        }\n        ?><h2 class=\"post-grid-title\"><?php the_title(); ?></h2>\n        <?php echo dh_excerpt(); ?>\n        <p class=\"reading-time\"><?php echo dh_display_read_time(); ?></p>\n    </a><?php\n    // Restore the global post\n    $post = $post_saved;\n}}\n\n/**\n *  Now that we're all setup, it's finally time for the big show!  Let's\n *  display the blocks!\n */\n// Create id attribute allowing for custom \"anchor\" value.\n$id = 'highlights-' . $block['id'];\nif( !empty($block['anchor']) ) {\n    $id = $block['anchor'];\n}\n// Create class attribute allowing for custom \"className\" and \"align\" values.\n$className = 'block-highlights ';\nif( !empty($block['className']) ) {\n    $className .= ' ' . $block['className'];\n}\nif( !empty($block['align']) ) {\n    $className .= ' align' . $block['align'];\n}\n?><div id=\"<?php echo esc_attr($id); ?>\" class=\"<?php echo esc_attr($className); ?>\"><?php\nif($mort) {\n    ?><div class=\"slider mobile-slider splide\" data-splide='{ \"type\" : \"loop\", \"perPage\": \"3\", \"arrows\": 0, \"breakpoints\": { \"99999\": { \"destroy\": 1 }, \"767\": { \"perPage\": \"1\" } } }'>\n        <div class=\"splide__track\">\n            <ul class=\"post-grid splide__list\">\n            <?php\n            foreach($mort as $display_me) {\n                ?><li class=\"post-grid-post splide__slide\"><?php\n                // Each object is displayed depending on what it is.\n                switch(get_class($display_me)) {\n                    // It's a term!\n                    case 'WP_Term':\n                        mort_output_term_block($display_me);\n                        break;\n                    // It's a post!\n                    case 'WP_Post':\n                    default:\n                        mort_output_post_block($display_me);\n                }\n                ?></li><?php\n            }\n            ?></ul>\n        </div>\n    </div><?php\n}\n?></div>\n\nThe only lingering question in my mind is how your child taxonomy is sorted by month.  I just used the arguments you provided.  But on the surface, without the use of any filters, it seems as though the child taxonomy won't be sorted as expected.  Instead, if the name of the month as saved as the taxonomy name, the get_terms() of the child taxonomy will return the first element in the array [ \"April\", \"August\", \"December\", \"February\", \"January\", \"July\", \"June\", \"March\", \"May\", \"November\", \"October\", \"September\" ], which, in this case, is always \"April\".  If you're having a problem like this, I can solve it if you provide more information about how the taxonomy of children is structured (i.e.: what is saved as name and slug; is there any sort of term metadata that identifies the month as a number; etc) and on what it is applied (in example, the molecules_of_the_month taxonomy is only applied to molecule CPTs, and you want the WP_Term object to be displayed of the most recent molecule post).  I have an idea on what to do, but am unable to propose an answer without more info.\nUPDATE (3/31)  Thank you so much to @rhand for introducing me to the chat function and teaching me a bit about GitHub so I can fork some code.  The code was updated there to reflect the discussions we had in chat where we resolved issues.  After completion, the code was copied in its entirety above.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404043", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to divide Subcategories into pages of parent category wordpress suppose I have sturucture like this:\nJustin Bieber > Albums > Justice\nwhen I visit on https://example.com/category/justin-bieber/albums/\nIt is showing all albums of Justin Bieber category. but the problem is that\nIf I have 1 Million albums(subcategories) of specific artists(parent category) then I will display that Million albums(subcategories) in one page that is what I dont want.\nI want to divide that albums into multiple pages but dont know how to do that?\n\nA: This is called pagination.  If you search StackExchange, you will find a bunch of questions and answers about it, like this one which seems to be for what you are looking.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404044", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WooCommerce Lost Password reset goes to 404 When trying to reset password with WooCommerce lost-password it 404's.\n(ex. domain.com/lost-password/?reset-link-sent=true)\nI see that this issue has recently been reported but I was wanting to see if there is a solution or hotfix in WordPress StackExachange.\nI think this is a good work around.\nhttps://wordpress.stackexchange.com/a/240886\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404046", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Use a filter for wp_robots to block CPT/feed/ We have a CPT (with base slug templates) that somehow included in every single post's head a link to /templates/post/feed/.\nI've removed this link to the feed from the head, but want to block robots from the feed also.\nFrom this answer, I can adapt code like:\nadd_filter( 'wp_robots', function( $robots ) {\n  if ( is_singular( 'templates' ) ) {\n    $robots['noindex']  = true;\n    $robots['nofollow'] = true;\n  }\n\n  return $robots;\n} );\n\nbut don't know how to include is_feed() into this code.\nWould I use something like if ( is_singular( 'templates' ) && is_feed( 'templates' ) ) ?\nHelp appreciated.\nEDIT\nAlternatively, I could somehow add the following to robots.txt:\nUser-agent: *\nDisallow: /templates/*/feed\n\nbut do not know the function/hook to do this. We're using Yoast SEO.\nHelp appreciated.\n\nA: Yoast SEO has a robots.txt editor that worked well.\n\nThis solved our problem.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404050", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP Editor does not Initialize Correctly When Form Elements are Removed from the DOM I am using js code to add and remove form elements and to initialize the wp_editor on the dynamically added textareas with js. The wp editor is initializing correctly when I am only adding elements with the \"add\" button. However, when I click \"remove\", the last wp editor does not fully initialize (top toolbar is missing). I recorded a short video of the problem: WP Editor Not initializing Correctly.\nHere is the code I am using to add and remove the elements:\nfunction addNewStep() {\n    //get all steps\n    const steps = document.getElementsByClassName('step');\n    const lastStep = steps[steps.length - 1];\n\n    // get last step input fields\n    const lastStepFields = lastStep.getElementsByClassName('form-field');\n    const lastTextArea = lastStepFields[1];\n\n    // remove wp editor from last textarea to be able to copy it\n    if (typeof wp.editor != \"undefined\" && isShowWpEditor) {\n        wp.editor.remove(lastTextArea.id);\n    }\n\n    //new table body wrapper\n    const tbody_element = document.createElement('tbody');\n    tbody_element.className = 'step';\n\n    //create the new step\n    let newStep = lastStep.cloneNode(true);\n    table.appendChild(newStep);\n\n    table.insertBefore(newStep, lastStep)\n\n    // loop through last step fields to increment ids\n    for (let i = 0, n = lastStepFields.length; i < n; i++) {\n        const field = lastStepFields[i];\n        // set the id and name attribute\n        if (i == 0) {\n            // some logic\n        } else if (i == 1) {\n            //reinitialize the wp editor that we removed before\n            if (typeof wp.editor != \"undefined\" && isShowWpEditor) {\n                wp.editor.initialize(field.id, {\n                    tinymce: {\n                        plugins: 'paste,lists,link,media,wordpress,wpeditimage,wpgallery,wpdialogs,wplink,textcolor,colorpicker',\n                        toolbar1: 'bold italic underline strikethrough | blockquote bullist numlist | alignleft aligncenter alignright alignjustify',\n                        toolbar2: 'formatselect forecolor link unlink',\n                        textarea_rows: 5\n                    },\n                    quicktags: true,\n                    mediaButtons: true,\n\n                });\n\n                // increment textarea id\n                newId = +(field.id.replace('id_', '')) + 1;\n                field.id = 'id_' + newId;\n                // create a new instance of the wp editor on the new textarea that we have just created dynamically\n                wp.editor.initialize(field.id, {\n                    tinymce: {\n                        plugins: 'paste,lists,link,media,wordpress,wpeditimage,wpgallery,wpdialogs,wplink,textcolor,colorpicker',\n                        toolbar1: 'bold italic underline strikethrough | blockquote bullist numlist | alignleft aligncenter alignright alignjustify',\n                        toolbar2: 'formatselect forecolor link unlink',\n                        textarea_rows: 5\n                    },\n                    quicktags: true,\n                    mediaButtons: true,\n\n                });\n            }\n\n        }\n    }\n\n}\n\nfunction removeStep() {\n    const steps = document.getElementsByClassName('step');\n    const lastStep = steps[steps.length - 1];\n    lastStep.remove();\n}\n\njQuery('#stg_steps').click(function(e) {\n    e.preventDefault();\n    addNewStep();\n    counter++;\n});\n\njQuery('#stg_remove_steps').click(function(e) {\n    removeStep();\n    counter--;\n})\n\nEverything is working, apart from the buggy wp editor initialization (toolbar is completely missing) when you have clicked the remove button beforehand.\n\nA: I finally figured out what the issue was. Apparently, when you remove the textarea element from the DOM, you also need to remove the wp editor that has been attached to it. (if you decide to re-add the textarea to the DOM later) I found out that even though the textarea is successfully removed, its id is still stored in the tinyMCEPreInit object and this causes problems with the dynamic wp editor initialization. Removing the wp editor with its corresponding textarea id fixed the issue for me:\nfunction removeStep() {\n    const steps = document.getElementsByClassName('step');\n    const lastStep = steps[steps.length - 1];\n    const lastTextArea = lastStep.getElementsByClassName('form-field')[1];\n    lastStep.remove();\n    if (typeof wp.editor != \"undefined\") {\n        wp.editor.remove(lastTextArea.id);\n    }\n    counter--;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404053", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Product page attributes dropdown show price Hi to all i have this code\nadd_filter( 'woocommerce_variation_option_name', 'display_price_in_variation_option_names' ); \n\nfunction display_price_in_variation_option_names( $term_name ) {\n\nglobal $wpdb, $product;\n\nif ( is_product() && $product instanceof WC_Product && $product->is_type( 'variable' ) ) {\n\n        foreach ( $product->get_available_variations() as $variation ) {\n            \n            foreach ( $variation['attributes'] as $variation_attribute_name => $variation_attribute_value ) {\n                $result = $wpdb->get_col( \"SELECT slug FROM {$wpdb->prefix}terms WHERE slug = '$variation_attribute_value'\" );\n                $taxonomy = str_replace( 'attribute_', '', $variation_attribute_name );\n                $term     = get_term_by( 'slug', $variation_attribute_value, $taxonomy );\n                if ( $term_name == $variation_attribute_value ) {\n                    $product_price = wc_price( $variation['display_price'] );\n                    $product_price = strip_tags( $product_price );\n                    return $term_name . ' - (' . $product_price . ')';\n                } else if( is_object($term) && $term->name == $term_name ) {\n                    $product_price = wc_price( $variation['display_price'] );\n                    $product_price = strip_tags( $product_price );\n                    return $term_name . ' - (' . $product_price . ')';\n                }\n            }\n\n        }\n\n    }\n    return $term_name; \n}\n\nThis code shows price in attributes dropdowns in product page with one attribute is work as i want.\nIf i have two attributes dropdown in the first dropdown pass the attribute price as i want.\nThat i want to achive is to the second dropdown not to show the price. Is there any way to do this with this code?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404054", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to sort posts without featured images in the WordPress Dashboard? thanks Is there any option to sort posts by without featured images in WordPress dashboard?\n(function code)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404056", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Ordering by meta value not working I have set WP_Query to order by a meta value but it isn't ordering correctly for some reason. entry_key is a year but is stored as text eg: 2022\n$term = get_queried_object();\n$args = array(\n    'post_type' => 'my_post_type',\n    'posts_per_page' => -1,\n    'order_by' => 'meta_value',\n    'meta_key' => 'entry_year',\n    'order' => 'DESC',\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'mica',\n            'field' => 'ID',\n            'terms' => $term->term_id\n        )\n    )\n);\n\n\nA: EDIT:\nDid you try adding 'meta_type' => 'NUMERIC' to your arguments?\nYou didn't specify what the current behaviour is. Why is it not ordering correctly? How is it ordering now and how do you want the ordering to be?\nBy the looks of your code, could you try the following:\nChange\n'orderby' => 'meta_value',\n\nIn to\n'orderby' => 'meta_value_num',\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404058", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Load specific page when a custom URL is hit I'm building a plugin which will basically build a knowledge base dynamically, by retrieving categories, articles, etc. from an external API where all documentation is being kept.\nI've added a few custom rewrite rules, which capture the following:\n\n*\n\n*When /kb is hit,\n\n*When /kb/category-name is hit (category-name can of course be anything)\n\n*When /kb/category-name/article-name is hit (again, article-name can be anything)\n\nWhat I want to achieve is the following:\n\n*\n\n*To avoid having to load custom templates, I simply want to add a shortcode (e.g. [kb_list_categories], [kb_list_articles] and [kb_article]) on a page, and then load that page when one of the rewrite rules matches.\n\nSo, I'd like to end up with a few pages:\n\n*\n\n*A knowledge-base page, containing the shorticode [kb_list_categories],\n\n*A category page, containing the shortcode [kb_list_articles],\n\n*A article page, containing the shortcode [kb_article].\n\nThe shortcode will be responsible for retrieving and displaying the content, based on the query vars retrieved from the URL.\nI know how to create shortcodes, and everything. And I will eventually create a configuration page, so a user can define which pages are supposed to be used.\nMy question is strictly: How do I make WordPress load a certain page (NOT a page template), when one of the rewrite rules matches?\nI found WooCommerce does the same with e.g. their checkout and account pages, and I've been digging through its code, but wasn't able to find anything useful, except for the use of add_rewrite_endpoint() instead of add_rewrite_rule().\nHere's the revelant code of what I have so far:\nclass Kb\n{\n    const ARTICLE_REWRITE_RULE  = 'kb/(.+)/(.+)/?';\n    const CATEGORY_REWRITE_RULE = 'kb/(.+)/?';\n\n    /**\n     * Set Fields.\n     * \n     * @return void \n     */\n    public function __construct()\n    {\n        $this->init();\n    }\n\n    /**\n     * Start Plugin\n     * \n     * @return void \n     */\n    private function init()\n    {\n        add_action('init', [$this, 'maybe_flush_rules'], 9);\n        add_filter('init', [$this, 'add_rewrite_rules']);\n        add_filter('query_vars', [$this, 'insert_query_vars']);\n        add_filter('template_include', [$this, 'include_template']);\n    }\n\n    /**\n     * Decide whether we should display our templates.\n     * \n     * @param mixed $template \n     * \n     * @return mixed \n     */\n    public function include_template($template)\n    {\n        $category = get_query_var('docs_category');\n        $article  = get_query_var('docs_article');\n\n        /**\n         * Here I'm loading templates, but that's what I want to get rid off.\n         */\n        if ($category && !$article) {\n            return KB_PLUGIN_DIR . 'templates/category.php';\n        }\n\n        if ($category && $article) {\n            return KB_PLUGIN_DIR . 'templates/article.php';\n        }\n\n        return $template;\n    }\n\n    public function add_rewrite_rules()\n    {\n        add_rewrite_rule(self::ARTICLE_REWRITE_RULE, 'index.php?docs_category=$matches[1]&docs_article=$matches[2]', 'top');\n        add_rewrite_rule(self::CATEGORY_REWRITE_RULE, 'index.php?docs_category=$matches[1]', 'top');\n    }\n\n    public function insert_query_vars($vars)\n    {\n        array_push($vars, 'docs_category', 'docs_article');\n\n        return $vars;\n    }\n\n    /**\n     * Flush rewrite rules if this rule hasn't been set (yet)\n     */\n    public function maybe_flush_rules()\n    {\n        $rules = get_option('rewrite_rules');\n\n        if (!isset($rules[self::ARTICLE_REWRITE_RULE]) || !isset($rules[self::CATEGORY_REWRITE_RULE])) {\n            global $wp_rewrite;\n\n            $wp_rewrite->flush_rules();\n        }\n    }\n}\n\n\nA: Wow. The answer was ridiculously easy. All you need to specify in the rewrite rule is the pagename attribute.\nSo,\nadd_rewrite_rule('kb/(.+)/(.+)/?', 'index.php?pagename=docs-article&docs_category=$matches[1]&docs_article=$matches[2]', 'top');\nLoads a page with the slug docs-article.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404060", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress REST API - get custom taxonomy category posts I want to use Wordpress REST API to get the posts that are inside a custom taxonomy created by the theme.\nThe taxonomy is called \"my_portfolio\" but if I use this I have this response:\n\n{\"code\":\"rest_no_route\",\"message\":\"Nessun percorso fornisce una\ncorrispondenza tra l'URL ed il metodo\nrichiesto.\",\"data\":{\"status\":404}}\n\nInstead if I use \"my_portfolio_category\" I have 4 categories that are called: \"photo\", \"video\", \"design\", \"web\".\nI want to retrieve the posts inside the category \"photos\" but the only thing I managed to get is the category info.\nThe API I used is the one down below where 921 is the ID of the category \"photo\", using the slug doesn't work.\nhttps://www.mywebsite.com/wp-json/wp/v2/my_portfolio_category/921\nIs there a way to get the posts?\n\nA: You need to first register rest route for your custom taxonomy i.e. my_portfolio\nadd_filter( 'register_taxonomy_args', 'my_portfolio_taxonomy', 10, 2 );\n \nfunction my_portfolio_taxonomy( $args, $taxonomy_name ) {\n \n    if ( 'my_portfolio' === $taxonomy_name ) {\n        $args['show_in_rest'] = true;\n \n        // Optionally customize the rest_base or rest_controller_class\n        $args['rest_base']             = 'my-portfolio';\n        $args['rest_controller_class'] = 'WP_REST_Terms_Controller';\n    }\n \n    return $args;\n}\n\nAfter that you can access url like : http://yourdomain.in/wp-json/wp/v2/posts?my-portfolio=28\nPlease note 28 is custom taxonomy id. you need to add id of photos in that case\n\nA: You need to have 'show_in_rest' => true as an argument when you register your taxonomy with register_taxonomy. Then you'll get a route by WordPress. No need to create your own route.\nThe route will be: .../wp/v2/my_portfolio\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404064", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Filter content for get_the_content() I Need to filter content for posts. If the user is not logged in, then the post content should display \"please log in....\". If he is logged in, then he can see the post content.\nI wrote the filter:\nadd_filter('the_content', 'check_user_logedin',10);\n\nfunction check_user_logedin($content){\nglobal $post; \nif (  $post->post_type == 'do_pobrania'  && has_term( 'zabezpieczony','rodzaj_plikow'  ) && !is_user_logged_in()  ) {\n   return  $content ='My text';\n    \n}else{\n    \n    return $content;\n}\n}\n\nAnd here comes my problem, because the plugin I use uses get_the_content() and my filter doesn't work on it. It still displays all content for each user.\nIs it possible to filter content for get_the_content()? Maybe there is another way to solve this issue?\n\nA: tl;dr. There's probably a good way for you to do this in the specific case you describe, although WordPress does not allow for good, general filtering of the return value from get_the_content().\nYou cannot do this directly, but ...\nThere currently (as of WordPress 5.9.2, checked on 24 March 2022) isn't a convenient, direct and reliable filter hook for filtering the entire output of get_the_content() just as such. the_content() runs its output through a final filter before outputting it, but get_the_content() does not run its output through a final filter before returning it; sorry.\nYou can review the source code for get_the_content() at the WordPress Code Reference site to confirm; you are looking for instances of the function apply_filters( ... ) which might be applied on the return-value variable $output. In the current version of WordPress, there aren't any, although there are instances of apply_filters( ... ) being used to filter components of the output (for example the \"Read More...\" link element near the end of the function.\nStill, in your specific case, you might be able to highjack the Password-Protected Post functionality to do what you want to do ...\nHOWEVER, there is a potential solution for this, if you are willing to potentially interfere with the normal functionality of Password-Protected Posts in your installation of WordPress. (That is, posts where an editor has set a password for readers to access the content of that one particular post. If you're not using this feature and not likely to do so in the future, then this solution may work for you. If you are using that feature, or may do so in the future, the solution you adopt might need to become significantly more complex to avoid unwanted side-effects.\nHere's what you need to do:\n\n*\n\n*Set up a filter on the hook post_password_required which will return true if the user is not logged in, and false if the user is logged in. For example, you could put this code in functions.php or another appropriate location:\nadd_filter( 'post_password_required', function ( $required, $post ) {\n    $required = ( ! is_user_logged_in() );\n    return $required;\n}, 2, 10);\n\nFor your original example, you need a bit more complex behavior than this -- in particular, you apparently only want this to happen with posts within a hard-coded Custom Post Type and assigned to a particular hard-coded Term. In that case, you can use a more complex boolean expression in the assignment to $required:\nadd_filter( 'post_password_required', function ( $required, $post ) {\n    $required = ( $post->post_type == 'do_pobrania' && has_term( 'zabezpieczony','rodzaj_plikow', $post ) && ! is_user_logged_in() );\n    return $required;\n}, 2, 10);\n\n\n\n*Set up a hook on the filter the_password_form which returns the HTML that you want to display when the user is excluded from seeing the content. For example, here's how to display a paragraph including a link to log in to WordPress, and then redirect back to the page you were viewing before:\nadd_filter( 'the_password_form', function ( $output, $post ) {\n    $login_url = wp_login_url( home_url( $_SERVER['REQUEST_URI'] ) );\n    $output = sprintf('<p>Please <a href=\"%s\">log in</a> ...</p>', esc_url( $login_url ) );\n    return $output;\n }, 2, 10);\n\nThis procedure removes the input form that is normally used to collect the post password for password-protected posts; so, again, if you use that functionality, this solution will break it unless you do something significantly more complicated here.\nOnce these two filters are added, any template or function that uses get_the_content() to retrieve post content will be blocked when users aren't logged in (or whenever the conditions you set in the first filter function, whatever those may be, are met). Note that this solution will, in general, cause login-gated posts to be treated the way that password-protected posts are treated -- for example, they will not have excerpts displayed, their content will not appear in RSS/Atom feeds, etc. etc. Given what you are trying to do here, it seems likely that these side-effects may be acceptable; but if not, then be careful.\nSome Technical Notes on Why This Works\nThe relevant part of get_the_content() is on lines 313-316 of wp-includes/post-template.php:\nfunction get_the_content( $more_link_text = null, $strip_teaser = false, $post = null ) {\n\n/* [...] */\n\n    // If post password required and it doesn't match the cookie.\n    if ( post_password_required( $_post ) ) {\n        return get_the_password_form( $_post );\n    }\n \n/* [...] */\n\n}\n\nSo IF post_password_required() returns true, THEN get_the_content() will just return the value returned by get_the_password_form() in place of the post content. These functions can both be filtered using simple filter hooks:\nfunction post_password_required( $post = null ) {\n \n    /**\n     * Filters whether a post requires the user to supply a password.\n     *\n     * @since 4.7.0\n     *\n     * @param bool    $required Whether the user needs to supply a password. True if password has not been\n     *                          provided or is incorrect, false if password has been supplied or is not required.\n     * @param WP_Post $post     Post object.\n     */\n    return apply_filters( 'post_password_required', $required, $post );\n}\n\nfunction get_the_password_form( $post = 0 ) {\n    $post   = get_post( $post );\n    $label  = 'pwbox-' . ( empty( $post->ID ) ? rand() : $post->ID );\n    $output = '<form action=\"' . esc_url( site_url( 'wp-login.php?action=postpass', 'login_post' ) ) . '\" class=\"post-password-form\" method=\"post\">\n    <p>' . __( 'This content is password protected. To view it please enter your password below:' ) . '</p>\n    <p><label for=\"' . $label . '\">' . __( 'Password:' ) . ' <input name=\"post_password\" id=\"' . $label . '\" type=\"password\" size=\"20\" /></label> <input type=\"submit\" name=\"Submit\" value=\"' . esc_attr_x( 'Enter', 'post password form' ) . '\" /></p></form>\n    ';\n \n    /**\n     * Filters the HTML output for the protected post password form.\n     *\n     * If modifying the password field, please note that the core database schema\n     * limits the password field to 20 characters regardless of the value of the\n     * size attribute in the form input.\n     *\n     * @since 2.7.0\n     * @since 5.8.0 Added the `$post` parameter.\n     *\n     * @param string  $output The password form HTML output.\n     * @param WP_Post $post   Post object.\n     */\n    return apply_filters( 'the_password_form', $output, $post );\n}\n\nYou can take advantage of these filter hooks (1) to require WordPress to block the post content in any context that respects Password-Protected Post security; and (2) to deliver arbitrary HTML (in this case a simple login link) in place of the post content in any context that displays an input field to get the post password. Hope this helps!\n\nA: Per the user-contributed comment by Hay on the get_the_content() docs page:\n\nNote that get_the_content doesn\u2019t return the same thing as what the_content displays. For that you need to do this:\n$content = apply_filters( 'the_content', get_the_content() );\necho $content;\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404065", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Prevent WordPress from automatically installing a new theme each year Is there a setting for new disabling new yearly themes?  Each year my WordPress installation automatically installs a new theme which I then delete.  For example, this year the theme Twenty Twenty-Two was installed.\nI already have a theme I like and I'm never going to want to use the newest theme of the year.  I'm hoping there is some way to prevent WordPress from automatically installing these new themes in the future.\nA few years ago somebody asked How to delete default themes? I already know how to delete the themes and they never got an answer about how to prevent them from being installed to begin with. There is also the question Should I delete the default themes? which is related, but doesn't actually answer my question.\n\nA: Looking through some resources, I found this track ticket which discusses the same topic. It seems the following will stop it, add it to your wp-config.php:\ndefine('CORE_UPGRADE_SKIP_NEW_BUNDLED', true);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404066", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "14"}}
{"text": "Q: Get a list of custom post type (property) when clicked on custom taxonomy 1 (rent or sale) from custom taxonomy 2 (city) page I have 3 different custom post type (property) and taxonomies (city and type).\nI can retrieve\n\n*\n\n*all properties from each city from taxonomy-city.php\n\n*all properties from each type (sale or rent) from taxonomy-type.php\n\n*all properties from custom post type page from page-property.php\n\nNow what I want is to retrive\n\n*\n\n*related properties to both id 1 type (custom taxonomy) and id 1 city (custom taxonomy) when click on rent (type taxonomy) link from london (city taxonomy) page.\n\nPlease guide me how I can achieve this, guys.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404068", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to apply padding to TinyMCE editor? I am using the following in functions.php...\nfunction wpdocs_theme_add_editor_styles() {\n    add_editor_style( array(\n        'https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css',\n        'assets/css/editor.css'\n    ) );\n}\nadd_action( 'admin_init', 'wpdocs_theme_add_editor_styles' );\n\n... to apply the Bootstrap CSS to my WordPress post editor.\nBootstrap comes in nicely. But this now results in the removal of any padding from the post editor.\n\nFile editor.css contains padding: 40px !important; in turn applied to a range of CSS classes... the padding is not getting applied...\n.mce-panel,\n.mce-edit-area,\n.mce-container,\n.mce-panel,\n.mce-stack-layout-item,\n.wp-editor-container .wp-editor-area,\n.wp-editor-container,\n.wp-editor-area {\n  padding: 40px !important;\n}\n\nI cannot figure out which is the pertinent class / why the padding is not getting applied. In dev tools, the editor.css file is getting inserted, but the style rule is now showing as processed on the right-hand side.\nHow can I ensure some padding?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404071", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I fix wp-admin error when exporting reusable blocks? I am having trouble with the export to json feature of the reusable blocks shown below.\nI am getting the following console errors after pressing the export to json link:\n\n*\n\n*Access to fetch at 'https://public-api.wordpress.com/wp/v2/types/wp_block?_locale=user' from origin 'https://mytestsiteXXXXX.wordpress.com' has been blocked by CORS policy: Request header field x-wp-nonce is not allowed by Access-Control-Allow-Headers in preflight response.\n\n*GET https://public-api.wordpress.com/wp/v2/types/wp_block?_locale=user net::ERR_FAILED\n\n*Uncaught (in promise) {code: 'fetch_error', message: 'You are probably offline.'}\n\nIt has been a while since I have used WP.com, so I am relearning some things and just wondering if I have done something wrong or forgotton a really basic step. I am using a test site free site provided by wp.com, I have looked for answers but I have not found anything useful yet.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404074", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why is my pagination /page/2 taking me to index.php? Why does my pagination take me to sites front page instead of page 2. The url seems to be correct mydomain.com/category/categroyname/page/2 but it doesnt display posts for 2 page. I tried to reset my page permalinks but it still does the same thing. Right now I have category.php in my file structure, I tried to add page.php but it still takes me to front page.\n<?php\n\n$paged = (get_query_var('paged')) ? get_query_var('paged') : 1; \n\n$args = array(\n    'post_type' => 'myposttype',\n    'posts_per_page' => 1,\n    'paged' => $paged,\n    'tax_query' => array(\n        array (\n            'taxonomy' => 'category',\n            'field' => 'slug',\n            'terms' => 'myterm',\n        )\n    ),\n);\n    \n    $my_query = new WP_Query( $args ); ?>\n\n<ul>\n\n    <?php\n\n    if( $my_query->have_posts() ) :\n       \n        while ($my_query->have_posts()) : $my_query->the_post(); \n        \n        ?>\n            \n            <li>\n           \n            <a href=\"<?php the_permalink() ?>\" rel=\"bookmark\" title=\"Permanent Link to <?php the_title_attribute(); ?>\">\n      \n                <?= get_the_post_thumbnail($post_item['ID'], 'full'); ?>\n           \n           \n                <h4><?php the_title(); ?></h4>\n                <span class=\"title-description\"><?= wp_trim_words( get_the_content(), 25, '..'); ?></span>\n\n    </a>\n        </li>\n      \n            <?php\n        endwhile; endif;\n\n    wp_reset_query();\n?>\n\n<?php\n$total_pages = $my_query->max_num_pages;\n\nif ($total_pages > 1){\n\n    $current_page = max(1, get_query_var('paged'));\n\n    echo paginate_links(array(\n        'base' => get_pagenum_link(1) . '%_%',\n        'format' => '/page/%#%',\n        'current' => $current_page,\n        'total' => $total_pages,\n        'prev_text'    => __('\u00ab prev'),\n        'next_text'    => __('next \u00bb'),\n    ));\n}\n\n?>\n<?php wp_reset_postdata();?>\n\nWhen I change page number in WP_query array for example 'paged' => 2, or 'paged' => 3, then the posts change on the page. For some reason the site doesn't understand what to show on /page/2.\nThis is my file structure. Am I missing something?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404076", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add product image to Woocommerce downloads page I have a site that allows customers to download digital files.\nI'd like to add the product / feature image on the '...my-account/downloads/' page where there are currently four columns for Product Name, Downloads Remaining, Expires, Download button.\nAny suggestions for where to edit this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404079", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress managing dates that change in text regularly I have been searching for a way to better manage dates on a WordPress website.  I work at a college whose website is on WordPress.  One issue we continuously run into is out of dates for reoccurring events.  For instance, there is the start and end of registration, start and end of semester, any given holiday, this list goes on and on. Each of those dates change at some interval.  My programmer brain thinks there must be away to set a reference to a particular reoccurring dates in page text, hypothetically it might look something like this.\nThe first day of semester: <?=START_OF_CURRENT_SEMESTER_SHORT/?>.\nThe semester began on <?=START_OF_CURRENT_SEMESTER_LONG/?>.\n\nand those values would be set somewhere which might look like this:\n$START_OF_SEMESTER_SHORT='07/24/2021'\n$START_OF_SEMESTER_LONG = 'August 24, 2021'\n\nOutput would be displayed like this\nThe first day of semester: 07/24/2021.\nThe semester began on August 24, 2021.\n\nIs there built-in way to accomplish something in line with my hypothetical example? Are there other plugins that might help with this type of concern?\n\nA: You could, hypothetically, use placeholders in the content of a page (or a post), and then use the the_content filter to update the placeholders on the fly.\nFor example, the content of your page would be something like this:\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\nFirst date of semester: ##START_OF_SEMESTER_LONG##\nFirst date of semester (short): ##START_OF_SEMESTER_SHORT##\nUt enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\n\nThen you would filter it like this when the page is loaded.\n// I'm assuming $start_of_semester is a Unix timestamp,\n// stored as an option, or post_meta, or anywhere you want.\nadd_filter( 'the_content', 'wpse404081_set_dates' );\n/**\n * Sets the appropriate dates in the page content.\n *\n * @param  string $content The page content.\n * @return string          The filtered page content.\n */   \nfunction wpse404081_set_dates( $content ) {\n    $start_of_semester = get_option( 'start_of_semester' ); // for example.\n    $content = str_replace(\n        array( '##START_OF_SEMESTER_LONG##', '##START_OF_SEMESTER_SHORT##' ),\n        array( date( 'F j, Y', $start_of_semester ), date( 'm/d/Y', $start_of_semester ),\n        $content\n    );\n    return $content;\n}\n\nFor information on how to set up the 'Start of Semester' option (aka \"setting\"), check out WordPress' Settings API.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404081", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using some Loop or repeatable fucntion in AJAX and PHP to reduce repeatability I am having a code, in which textbox border color changes, if values exist in wordpress database table. Briefly, if match1 textbox value exist in table:xrd_references, column:ref_code, then the match1 textbox border color green, otherwise red. But I am having many textbox like match1, match2, match3, match4 and match5.\nNow I don't want to repeat whole code for all the match textbox, instead if any solution can be suggested. Please take a look at my code.\n<?php\nglobal $wpdb; \nif(isset($_POST[\"match1\"])) {\n  $query = $wpdb->get_var(\"SELECT COUNT(*) FROM xrd_references WHERE ref_code='\" . $_POST[\"match1\"] . \"'\");\n    ob_clean();\n  if($query>0) {\n    echo \"<style>#match1{border: 3px solid green;}</style>\"; \n  }else{\n    echo \"<style>#match1{border: 3px solid red;}</style>\"; \n  }\n    exit;\n}\n?> \n\n<input type=\"text\" name=\"match1\" id=\"match1\"/><br>\n<input type=\"text\" name=\"match2\" id=\"match2\"/><br>\n<input type=\"text\" name=\"match3\" id=\"match3\"/><br>\n<input type=\"text\" name=\"match4\" id=\"match4\"/><br>\n<input type=\"text\" name=\"match5\" id=\"match5\"/><br>\n                \n<script src=\"https://code.jquery.com/jquery-3.6.0.min.js\"></script>\n<script>\n$(document).ready(function(){\n  $('#match1').on('input', function() {\n    jQuery.ajax({\n    data:'match1='+$(this).val(),\n    type: \"POST\",\n    success:function(data){\n \u00a0 \u00a0 \u00a0 \u00a0$(\"#match1\").html(data);\n    },\n    error:function (){}\n    });\n});});\n</script>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404084", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom payment method after payment user is logged out on thank you page I am using a custom payment method called euplatesc for donations.\nThe form:\n$postid = get_user_meta(get_current_user_id(), '_donar_post_id', true);\n    $dataAll = array(\n        //'amount'      => number_format(get_post_meta($postid, '_letter_price', true)),\n        'amount'      => number_format(1),\n        'curr'        => 'RON',\n        'invoice_id'  => '',\n        'order_desc'  => 'full payment',\n        'merch_id'    => $providedbypaymentgeteway,                                                \n        'timestamp'   => gmdate(\"YmdHis\"),                                     \n        'nonce'       => md5(microtime() . mt_rand()),       \n    );\n    \n    \n    \n    $dataAll['fp_hash'] = strtoupper(euplatesc_mac($dataAll,$key));\n    $dataAll['ExtraData[silenturl]'] = get_site_url();\n    $dataAll['ExtraData[successurl]'] = get_site_url().'/thank-you';\n    $dataAll['ExtraData[failedurl]'] = get_site_url().'/payment-error';\n    $dataAll['ExtraData[backtosite]']= get_site_url();\n    //$dataAll = array_merge($dataAll,$main);\n    $dataAll['fname'] = get_post_meta($postid, '_fname', true);\n    $dataAll['lname'] = get_post_meta($postid, '_lname', true);\n    $dataAll['email'] = get_post_meta($postid, '_email', true);\n    $dataAll['ExtraData[version]'] = 'donate';\n    $main = \"https://secure.euplatesc.ro\";\n\n    $ret.= '<form id=\"pay_full_amount_form\" ACTION=\"'.$main.'\" METHOD=\"POST\" name=\"gateway\" target=\"_self\">';\n    $ret.= '<input type=\"hidden\" name=\"fullamount\" VALUE=\"1\" />';\n    foreach($dataAll as $key=>$value){\n        $ret.= '<input type=\"hidden\" name=\"'.$key.'\" VALUE=\"'.$value.'\" />';\n    }\n    $ret .= '<input type=\"submit\" value=\"'.__( 'Full ammount', 'gd-povestea-mea' ).'\" name=\"wp-submit\"/>';\n    $ret.= '</form>';\n    \n    return $ret;\n\nThe payment works but after payment redirect on the thank you page the user is logged out.\nThe response field:\n$key = '1234567890';\n    \n$data =  array (\n    'amount'     => addslashes(trim(@$_POST['amount'])),\n    'curr'       => addslashes(trim(@$_POST['curr'])), \n    'invoice_id' => addslashes(trim(@$_POST['invoice_id'])),\n    'ep_id'      => addslashes(trim(@$_POST['ep_id'])), \n    'merch_id'   => addslashes(trim(@$_POST['merch_id'])), \n    'action'     => addslashes(trim(@$_POST['action'])), \n    'message'    => addslashes(trim(@$_POST['message'])),\n    'approval'   => addslashes(trim(@$_POST['approval'])),\n    'timestamp'  => addslashes(trim(@$_POST['timestamp'])),\n    'nonce'      => addslashes(trim(@$_POST['nonce'])),\n);\n\n$data['fp_hash'] = strtoupper(euplatesc_mac($data, $key));\n$fp_hash=addslashes(trim(@$_POST['fp_hash']));\n\nif($data['fp_hash']===$fp_hash){\n    if($data['action']==\"0\") {\n        //Complete\n    }else {\n        //Failed\n    }\n}else{\n    //Invalid\n}\n\necho \"OK\";//IMPORTANT to print OK\n\nData is captured in the database but I need to show the user details that I cant cause the user is signed out.\nThanks in advance.\n\nA: You can use cookies, if payment is successful generate unique key and set it in user browser (as cookie) and store same key in db. Then on thank you page you can show results based on that key.\nThis tutorial might help you if you didn't use cookies before.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404085", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is it safe to upload JSON files to upload folder? I'm using wp_upload_bits to upload JSON files to my WP's upload folder. I get the error \"Sorry, this file type is not permitted for security reasons\"\nIs it safe to upload JSON file anyway?\n\nA: JSON files are really data files: they are not a security threat per se, it's simply that WordPress doesn't include them in its whitelist.\nIt really depends on who can upload the data and what you do with the data. After all, an Excel file with macros can be a security risk, and yet WordPress allows the following:\n'xla|xls|xlt|xlw' => 'application/vnd.ms-excel',\n'xlsx'            => 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n'xlsm'            => 'application/vnd.ms-excel.sheet.macroEnabled.12',\n'xlsb'            => 'application/vnd.ms-excel.sheet.binary.macroEnabled.12',\n'xltx'            => 'application/vnd.openxmlformats-officedocument.spreadsheetml.template',\n'xltm'            => 'application/vnd.ms-excel.template.macroEnabled.12',\n'xlam'            => 'application/vnd.ms-excel.addin.macroEnabled.12',\n\nNow that we've established that what is considered \"safe\" depends on perspectives, it's undeniable that whitelisting is more secure than blacklisting, but sometimes false positives may occur (there are sooo many file types, after all).\nHere is the full list of allowed file types by default:\n/**\n     * Filters the list of mime types and file extensions.\n     *\n     * This filter should be used to add, not remove, mime types. To remove\n     * mime types, use the {@see 'upload_mimes'} filter.\n     *\n     * @since 3.5.0\n     *\n     * @param string[] $wp_get_mime_types Mime types keyed by the file extension regex\n     *                                 corresponding to those types.\n     */\n    apply_filters(\n        'mime_types',\n        array(\n            // Image formats.\n            'jpg|jpeg|jpe'                 => 'image/jpeg',\n            'gif'                          => 'image/gif',\n            'png'                          => 'image/png',\n            'bmp'                          => 'image/bmp',\n            'tiff|tif'                     => 'image/tiff',\n            'webp'                         => 'image/webp',\n            'ico'                          => 'image/x-icon',\n            'heic'                         => 'image/heic',\n            // Video formats.\n            'asf|asx'                      => 'video/x-ms-asf',\n            'wmv'                          => 'video/x-ms-wmv',\n            'wmx'                          => 'video/x-ms-wmx',\n            'wm'                           => 'video/x-ms-wm',\n            'avi'                          => 'video/avi',\n            'divx'                         => 'video/divx',\n            'flv'                          => 'video/x-flv',\n            'mov|qt'                       => 'video/quicktime',\n            'mpeg|mpg|mpe'                 => 'video/mpeg',\n            'mp4|m4v'                      => 'video/mp4',\n            'ogv'                          => 'video/ogg',\n            'webm'                         => 'video/webm',\n            'mkv'                          => 'video/x-matroska',\n            '3gp|3gpp'                     => 'video/3gpp',  // Can also be audio.\n            '3g2|3gp2'                     => 'video/3gpp2', // Can also be audio.\n            // Text formats.\n            'txt|asc|c|cc|h|srt'           => 'text/plain',\n            'csv'                          => 'text/csv',\n            'tsv'                          => 'text/tab-separated-values',\n            'ics'                          => 'text/calendar',\n            'rtx'                          => 'text/richtext',\n            'css'                          => 'text/css',\n            'htm|html'                     => 'text/html',\n            'vtt'                          => 'text/vtt',\n            'dfxp'                         => 'application/ttaf+xml',\n            // Audio formats.\n            'mp3|m4a|m4b'                  => 'audio/mpeg',\n            'aac'                          => 'audio/aac',\n            'ra|ram'                       => 'audio/x-realaudio',\n            'wav'                          => 'audio/wav',\n            'ogg|oga'                      => 'audio/ogg',\n            'flac'                         => 'audio/flac',\n            'mid|midi'                     => 'audio/midi',\n            'wma'                          => 'audio/x-ms-wma',\n            'wax'                          => 'audio/x-ms-wax',\n            'mka'                          => 'audio/x-matroska',\n            // Misc application formats.\n            'rtf'                          => 'application/rtf',\n            'js'                           => 'application/javascript',\n            'pdf'                          => 'application/pdf',\n            'swf'                          => 'application/x-shockwave-flash',\n            'class'                        => 'application/java',\n            'tar'                          => 'application/x-tar',\n            'zip'                          => 'application/zip',\n            'gz|gzip'                      => 'application/x-gzip',\n            'rar'                          => 'application/rar',\n            '7z'                           => 'application/x-7z-compressed',\n            'exe'                          => 'application/x-msdownload',\n            'psd'                          => 'application/octet-stream',\n            'xcf'                          => 'application/octet-stream',\n            // MS Office formats.\n            'doc'                          => 'application/msword',\n            'pot|pps|ppt'                  => 'application/vnd.ms-powerpoint',\n            'wri'                          => 'application/vnd.ms-write',\n            'xla|xls|xlt|xlw'              => 'application/vnd.ms-excel',\n            'mdb'                          => 'application/vnd.ms-access',\n            'mpp'                          => 'application/vnd.ms-project',\n            'docx'                         => 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n            'docm'                         => 'application/vnd.ms-word.document.macroEnabled.12',\n            'dotx'                         => 'application/vnd.openxmlformats-officedocument.wordprocessingml.template',\n            'dotm'                         => 'application/vnd.ms-word.template.macroEnabled.12',\n            'xlsx'                         => 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n            'xlsm'                         => 'application/vnd.ms-excel.sheet.macroEnabled.12',\n            'xlsb'                         => 'application/vnd.ms-excel.sheet.binary.macroEnabled.12',\n            'xltx'                         => 'application/vnd.openxmlformats-officedocument.spreadsheetml.template',\n            'xltm'                         => 'application/vnd.ms-excel.template.macroEnabled.12',\n            'xlam'                         => 'application/vnd.ms-excel.addin.macroEnabled.12',\n            'pptx'                         => 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n            'pptm'                         => 'application/vnd.ms-powerpoint.presentation.macroEnabled.12',\n            'ppsx'                         => 'application/vnd.openxmlformats-officedocument.presentationml.slideshow',\n            'ppsm'                         => 'application/vnd.ms-powerpoint.slideshow.macroEnabled.12',\n            'potx'                         => 'application/vnd.openxmlformats-officedocument.presentationml.template',\n            'potm'                         => 'application/vnd.ms-powerpoint.template.macroEnabled.12',\n            'ppam'                         => 'application/vnd.ms-powerpoint.addin.macroEnabled.12',\n            'sldx'                         => 'application/vnd.openxmlformats-officedocument.presentationml.slide',\n            'sldm'                         => 'application/vnd.ms-powerpoint.slide.macroEnabled.12',\n            'onetoc|onetoc2|onetmp|onepkg' => 'application/onenote',\n            'oxps'                         => 'application/oxps',\n            'xps'                          => 'application/vnd.ms-xpsdocument',\n            // OpenOffice formats.\n            'odt'                          => 'application/vnd.oasis.opendocument.text',\n            'odp'                          => 'application/vnd.oasis.opendocument.presentation',\n            'ods'                          => 'application/vnd.oasis.opendocument.spreadsheet',\n            'odg'                          => 'application/vnd.oasis.opendocument.graphics',\n            'odc'                          => 'application/vnd.oasis.opendocument.chart',\n            'odb'                          => 'application/vnd.oasis.opendocument.database',\n            'odf'                          => 'application/vnd.oasis.opendocument.formula',\n            // WordPerfect formats.\n            'wp|wpd'                       => 'application/wordperfect',\n            // iWork formats.\n            'key'                          => 'application/vnd.apple.keynote',\n            'numbers'                      => 'application/vnd.apple.numbers',\n            'pages'                        => 'application/vnd.apple.pages',\n        )\n    );\n\nThis is where the mime_types filter comes into play ; you can place the following in your theme's functions.php or in a custom plugin:\n\nadd_filter('mime_types', 'add_json_mime_type', 10, 1);\nfunction add_json_mime_type($mime_types) {\n  $mime_types['json'] = 'application/json';\n  \n  return $mime_types;\n}\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404086", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gravity Form Repeater File/Media Upload Not Working Gravity form repeater currently not support file/media upload as mentioned in doc. I am wondering is there anyone who fixed that issue or any solution that can help me?\nI am getting following error:\n\n\nA: I think this plugin allows file uploads within a repeater field:\nhttps://gravitywiz.com/documentation/gravity-forms-nested-forms/\n(see this question) https://stackoverflow.com/a/63651671/1844720\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404088", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Ninja Forms \u2013 change redirect URL based on API response? How can we change the redirect_url for a redirect action based on the response from an API?\nI have created a custom action (extending NF_Abstracts_Action )  that runs during submission with late timing and calls an external API.\nBased on that response I want to change the page being redirected to.  I cam get the actions with NinjaForms()->form(2)->get_actions(), but changing the redirect_url of the redirect action in that array doesn\u2019t alter the current flow.\nAlternatively how can I send a querystring containing data from the API to the redirected page?\nAlso tried an alternate approach, of redirecting inside a WP Hook action\nfunction ninja_test_action($form_data) {\n    error_log('inside wp hook action - about to redirect');\n    wp_redirect('https://wp.test');\n}\nadd_action('ninja_test_action', 'ninja_test_action',10,1);\n\nThis fails with a console error: TypeError: Cannot read properties of undefined (reading 'nonce')\nThis testing is being performed on a fresh and clean install of WordPress 5.9 using a clean Underscores theme and only the Ninja Forms plugin installed.\n\nA: So, the way I've ended up doing this is as follows. It's probably not the optimal way but I can't find a way to change the submission data during the submission workflow (the redirect action always seems to read the original entered data). Basically, the key hook is ninja_forms_run_action_settings where you can filter $action_settings which contains the redirect url.\nIn my Action class:\nclass CustomProcessing extends NF_Abstracts_Action {\n\nprivate string $_redirect_url;\n\n   public function __construct()\n    {\n\n        parent::__construct();\n        $this->_nicename = 'Custom Process';\n\n\n        add_filter( 'ninja_forms_run_action_settings', [ $this, 'changeRedirectURL' ], 10, 4 );\n    }\n\n\n    public function process( $action_id, $form_id, $data ) {\n\n    // code to call API endpoint\n\n    // set redirect url on response from API\n    if ( 201 === $response[ 'response' ][ 'code' ] ) {\n        $this->_redirect_url = $body_url;\n    }\n\n    return $data\n\n}\n\n\n    public function changeRedirectURL( $action_settings, $form_id, $action_id, $form_settings )\n    {\n\n        if ( '<redirect action name>' === $action_settings[ \"label\" ] ) {\n            $action_settings[ 'redirect_url' ] = $this->_redirect_url;\n        }\n\n        return $action_settings;\n    }\n\n\n}\n\n\nA: I recommend deleting the redirect action for the form, then in your code for the custom action that is run at the time of form submission to interact with the API, you can use wp_redirect() to redirect the user to the expected page.\nAlso, you can add any necessary parameters to the redirect URL passed to wp_redirect().\nCheck out the WP code reference on wp_redirect().\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404089", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenberg output URL to post from attribute with post ID In my pages, I have a number of custom blocks that allow you to select a page. In the save function, I save the pages URL.\n    registerBlockType(\"djave/blockwithlink\", {\n        attributes: {\n            page: {\n                // { id: 1, url: \"http://site.dev/page-url\", title: \"Page title\"}\n                type: \"object\",\n                default: {},\n            },\n        },\n        edit,\n        save({attributes}){\n          return (<div>\n            <a href={attributes.link.url}>{attributes.link.title}</a>\n          </div>)\n        }\n    });\n\nThis is great, when I save the block I get:\n<div>\n  <a href=\"http://site.dev/page-url\">Page title</a>\n</div>\n\nBut if the page is edited to http://site.dev/new-page-url, saved block has the out dated URL.\nIs there a way to put a permalink to an ID into a save() function?\nThe other option I have is that I return null from the save function and instead create the template as PHP and use something like I'm used to from PHP templating like  get_permalink($attributes['link']['id']).\nHowever:\n\n*\n\n*have lots of blocks that follow the same pattern which would need to be extracted to PHP.\n\n*I'm really enjoying using the save function, and don't like the idea of half of my blocks being JavaScript saved and half being PHP rendered, it seems wrong.\n\nThis feels like it must be a \"solved\" problem. Is there a Gutenberg way of doing this?\n\nA: I think the issue you will run into here is that markup from the save function is created at post edit. The attributes like that link.url you reference will be correct at time of save - which is where the JS runs - but not necessarily at render if the post attributes have been changed.\nThe only way I can think of to change this at block render without PHP render would be to store your ID as a data-attribute against the anchor. Something like:\n<a href=\"#\" data-post-id=\"234\" data-rest-route=\"posts\">Link Content</a>\nWhere data-post-id is obviously the post ID and data-rest-route is the rest route or the parameter from the rest_base when you set up the posts with register_post_type() This you can parse from the initial post query return (the bit where you get the slug in your un-posted code to add to the .link.url on the block)\nYou can then run a secondary JS script on page load that leverages the REST API to get the correct slug at time of render.\nYour URL path will be something like\n/wp-json/wp/v2/{post_type}/{ID} or to match the above example /wp-json/wp/v2/posts/234\nThen take the slug from the JSON object on page load to inject into the link href.\nIt's a bit of a workaround... And I wouldn't use this in public plugin code, as you have no idea how or if the rest API has been allowed or modified on custom post types for other setups.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404091", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: require_once not working in plugin wordpress I'm creating a plugin and I have to add some custom controls through the plugin. Here is the code for the custom control defined in featured-types.php -\n function itlst_featured_types_customize_register( $wp_customize ) {\n\n//Featured Property Types\n$wp_customize->add_section(\n    'itlst_feat_types', array(\n        'title'     =>  __('Feautured Types', 'it-listings'),\n        'panel' =>  'itlst_property'\n    )\n);\n\n$wp_customize->add_setting(\n    'itlst_feat_prop', array(\n        'default'           =>  '',\n        'sanitize_callback' =>  'itlst_sanitize_type'\n    )\n);\n\n$wp_customize->add_control(\n    new itlst_WP_Customize_Property_Control(\n        $wp_customize, 'itlst_feat_prop', array(\n            'label'     =>  __('Property Type', 'text-domain'),\n            'section'   =>  'itlst_feat_types',\n            'settings'  =>  'itlst_feat_prop'\n        )\n    )\n);\n\n}\n add_action('customize_register', 'itlst_featured_types_customize_register');\n\nThe class itlst_WP_Customize_Property_Control is defined in custom-controls.php -\nif ( class_exists('WP_Customize_Control') ) {\n\n class itlst_WP_Customize_Property_Control extends WP_Customize_Control {\n\n    /**\n     * Render the control's content.\n     */\n    public function render_content() {\n        $dropdown = wp_dropdown_categories(\n            array(\n                'name'              => '_customize-dropdown-categories-' . $this->id,\n                'echo'              => 0,\n                'show_option_none'  => __( '&mdash; Select &mdash;', 'it-listings' ),\n                'taxonomy'          => 'property-type',\n                'option_none_value' => '0',\n                'selected'          => $this->value(),\n            )\n        );\n\n        $dropdown = str_replace( '<select', '<select ' . $this->get_link(), $dropdown );\n\n        printf(\n            '<label class=\"customize-control-select\"><span class=\"customize-control-title\">%s</span> %s</label>',\n            esc_html($this->label),\n            $dropdown\n        );\n    }\n  }\n}\n\nBoth these files are included in the main plugin file. Here is the code -\nrequire_once(ITL_PATH . 'listings-cpt/customizer/custom-controls.php');\nrequire_once(ITL_PATH . 'listings-cpt/customizer/featured-types.php');\n\nBut it gives the \"class not found\" error. Take a look at the screenshot below -\n\nIf I comment out the code for custom control, website loads smoothly.\nI have used the same code in WordPress Themes multiple times and it worked smoothly everytime. It's causing issues in the plugin.\nAny idea what's going on? I searched through internet but was not able to figure out the exact issue?\nMy best guess is that the 'customize_register' action hook is being called earlier than the class.\n\nA: The issue was resolved. I had to hook the custom classes to the customize_register action hook. Something like this -\nfunction itlst_extend_customize_control() {    \nif ( class_exists('WP_Customize_Control') ) {\n\nclass itlst_WP_Customize_Property_Control extends WP_Customize_Control {\n\n/**\n * Render the control's content.\n */\npublic function render_content() {\n    $dropdown = wp_dropdown_categories(\n        array(\n            'name'              => '_customize-dropdown-categories-' . $this->id,\n            'echo'              => 0,\n            'show_option_none'  => __( '&mdash; Select &mdash;', 'it-listings' ),\n            'taxonomy'          => 'property-type',\n            'option_none_value' => '0',\n            'selected'          => $this->value(),\n        )\n    );\n\n    $dropdown = str_replace( '<select', '<select ' . $this->get_link(), $dropdown );\n\n    printf(\n        '<label class=\"customize-control-select\"><span class=\"customize-control-title\">%s</span> %s</label>',\n        esc_html($this->label),\n        $dropdown\n    );\n}\n}\n}\nadd_action('customize_register', 'itlst_extend_customize_control');\n\nThis is peculiar as in themes, nothing of this sort has to be done. Seems like classes are included after the customize_register hook in plugins.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404094", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: White Screen in Home Page Initially I installed WordPress in my Linux Mint OS. It was working properly. Later I added another Database to the site. I changed siteurl and home value at wp-options table. I changed Database settings in wp-config.php file. There is no .htaccess file in my WordPress directory.\nI am getting White Home page.\nI am trying to debug using define( 'WP_DEBUG', true ); and define( 'WP_DEBUG_LOG', true );. I am not getting any error message also.\nHow can I solve the issue ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404095", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gallery functionality in custom theme I'm new to creating my own theme and I barely scratched the surface of this topic so far. But my end goal would be to create a \"gallery like\" functionality.\nMaybe there are some functions or prebuild things in WP that could help me out here before I do all of this from scratch.\nSome terms what I can google for or look in the documentation would help me out a lot. Because when I search for stuff on google I only find some basic things like finished themes, plugins etc. but no development info (besides the docs).\nAs I said, I would like to have some sort of gallery where the user in the backend has a button to add an image (in the best case) a pop up (or other page) will open where the user enters some information (image from media uploader, image name, tags etc.).\nThe tricky part for me is that I want to have X amount of images possible. So when one is added the \"add image\" button is still there and the user can add as much as he wants.\nSo I don't define that only (for example) 10 images are possible in 10 hardcoded fields.\nIf that pop up thingy is too complicated/ not existing in WP (in an easy way) it would be enough to have new fields generated automatically. So the user has a button \"Add Image\" -> On click three fields appear -> The user fills the fields -> \"Add Image\" button again -> Another three fields are generated and the user can also fill them.\nIf you need more information, please let me know.\nI'm glad for any help!\nOn reddit somebody suggested the use of Advanced Custom Fields.\nBut I would like to have a solution without the use of third party plugins, especially paid ones.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404096", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: 'manage_users_custom_column' is a filter, but 'manage_posts_custom_column' is an action. Why? I've been implementing some custom columns in admin tables for a Wordpress project, and I was caught out by the differences between manage_users_custom_column and manage_posts_custom_column (or manage_{$post->post_type}_posts_custom_column). The users hook is a filter, and therefore has to return the value of the custom column. But the posts hook (or the custom post type hook) is an action, and therefore the value of the custom column has to be echoed instead of returned.\nI've scratched my head a bit but can't see why they should be different? Both users and posts are built-in post types, both admin tables can have extra columns added using manage_users_columns or manage_posts_columns, both of which are filters. Why does manage_users_custom_column use a filter but manage_posts_custom_column use an action?\nhttps://developer.wordpress.org/reference/hooks/manage_users_custom_column/\nhttps://developer.wordpress.org/reference/hooks/manage_posts_custom_column/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404097", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Asynchronous multiple requests 401 Unauthorized I'm writing a Wordpress Plugin that sends requests via WooCommerce API. I need to send multiple GET requests to the API and instead of using a for loop and sending each request one after another, I was looking for a multiple request alternative and came across this class. A single request call via WooCommerce API basically looks like this (i.e. to list all products):\n$headers = array( 'Content-Type' => 'application/json' );\n// We may use HTTP Basic Auth for Authentication over HTTPS. \n$options = array(\n   'auth' => array( 'ck000', 'cs000' ),\n)\n$response = Requests::request('https://mysite.xy/wp-json/wc/v3/products', $headers, null, $options);\n\nThis sends an authorized request (via the $options array with a consumer key and consumer secret to access the shop site) and retrieves a list with all products available.\nLooking at Requests::request_multiple, the method takes in an array of requests and options, with the following description of the parameter $options:\n\nIf the $options parameter is specified, individual requests will inherit options from it.\n\nNow let's say I want to send 3 requests for different products (AAA, BBB and CCC):\n// This is how you should create individual requests for request_multiple method\n$req1 = array( 'url' => 'https://mysite.xy/wp-json/wc/v3/product/AAA' );\n$req2 = array( 'url' => 'https://mysite.xy/wp-json/wc/v3/product/BBB' );\n$req3 = array( 'url' => 'https://mysite.xy/wp-json/wc/v3/product/CCC' );\n// Create requests array\n$requests = array( $req1, $req2, $req3 );\n// Send multiple requests\n$responses = Requests::request_multiple( $requests, $options );\n\nEach response in $responses has status code 401 (Unauthorized Access), although each request should inherit the same authentication from the $options array.\nIs this something I should open an issue about on GitHub or is there something that I'm not fully getting?\n\nA: Apparently, this already is a known issue on GitHub. Still open and not patched from May 16, 2016.\nBased on the suggestion from the comments, creating a new Hooks instance and registering the hook curl.before_multi_add with a callback that sets the cURL authentication options should solve the [401] Unauthorized Access problem.\nuse WpOrg\\Requests\\Hooks;\n\n$hooks = new Hooks();\n$hooks->register( 'curl.before_multi_add', function( &$curl_subhandle ) {\n        // curl_setopt can fail => Still [401] then, so take care of that\n        curl_setopt( $curl_subhandle, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);\n        curl_setopt( $curl_subhandle, CURLOPT_USERPWD, YOUR_CK . \":\" . YOUR_CS );\n    });\n\nAfterwards, set the following in the $options array:\n$options []= 'hooks' => $hooks;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404099", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom archive page for custom taxonomy and pagination issue so this is something I am trying to figure out for quite some time about my custom archive page for a custom taxonomy 'workplace'. There is many workplaces, and what i want is to display the products ( custom post type ) associated with the workplace by their categories, and also there descendents ( line 232 is an example of this. ) So for The 6 sections of categories, it finds each product category associated with each product and does not display the main category as it is already a tab ( it would be like a duplicate ).\nthe code finds unique categories and then only displays them within their relevant sections.\nall of this is working fine, until I tried to implement ajax load more.\nthe problem i am having, is that the page loop is initializing with the original product quantity/count, whereas I need it to only take account of the category count for each section, for pagination purposes for the categories. see, the product number is more than the category count since some products are from the same category.\nI think what i need to do is count the categories outside of the page loop, ( or woocommerce loop) and then implement the page loop based on the findings. Should I somehow access the page queried object ( the workplace ) and find the information before the loop? I just can't seem to figure it out.\nIf anyone can throw some light on this it would be great.\n<?php\n/**\n * The Template for displaying product archives, including the main shop page which is a post type archive\n *\n * This template can be overridden by copying it to yourtheme/woocommerce/archive-product.php.\n *\n * HOWEVER, on occasion WooCommerce will need to update template files and you\n * (the theme developer) will need to copy the new files to your theme to\n * maintain compatibility. We try to do this as little as possible, but it does\n * happen. When this occurs the version of the template file will be bumped and\n * the readme will list any important changes.\n *\n * @see https://docs.woocommerce.com/document/template-structure/\n * @package WooCommerce\\Templates\n * @version 3.4.0\n */\n/**\n * THIS TEMPLATE IS FOR DISPLAYING WORKPLACES\n * IT FINDS PRODUCT CATEGORIES FROM EACH SECTION AND SHOWS THEM IF THEY ARE RELEVANT FOR THE WORKPLACE.\n * \n */\ndefined('ABSPATH') || exit;\n\nget_header('shop');\n\n/**\n * Hook: woocommerce_before_main_content.\n *\n * @hooked woocommerce_output_content_wrapper - 10 (outputs opening divs for the content)\n * @hooked woocommerce_breadcrumb - 20\n * @hooked WC_Structured_Data::generate_website_data() - 30\n */\ndo_action('woocommerce_before_main_content');\n\n?>\n<header class=\"woocommerce-products-header background_diamond\">\n    \n    <style type=\"text/css\">\n    .major_cat_archive.custom_banner_style::before {\n        <?php $term = get_queried_object();\n// vars\n$image = get_field('banner_image', $term);\n\nif ($image)\n{\n\n?>background-image: url(<?php echo $image['url']; ?>);\n            <?php\n}\n\nelseif (!$image)\n{\n?>background-image: url(<?php woocommerce_category_image();\n}\n\n?>);\n    }\n    </style>\n    <?php if (apply_filters('woocommerce_show_page_title', true)): ?>\n    <div class=\"major_cat_archive custom_banner_style example_layout_left\">\n\n        <h1 class=\"woocommerce-products-header__title page-title example_layout\" data-aos=\"fade-right\"\n            data-aos-offset=\"-200\" data-aos-delay=\"10\" data-aos-duration=\"1000\" data-aos-easing=\"ease\"\n            data-aos-mirror=\"true\" data-aos-once=\"false\" data-aos-anchor-placement=\"top-center\">\n            <?php woocommerce_page_title(); ?></h1>\n    </div>\n    <?php\nendif; ?>\n    <?php\n/**\n * Hook: woocommerce_archive_description.\n *\n * @hooked woocommerce_taxonomy_archive_description - 10\n * @hooked woocommerce_product_archive_description - 10\n */\ndo_action('woocommerce_archive_description');\n?>\n</header>\n<div class=\"holder \" data-aos=\"fade-up\" data-aos-offset=\"-200\" data-aos-delay=\"10\" data-aos-duration=\"1000\"\n    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"false\" data-aos-anchor-placement=\"top-center\">\n    <div class=\"sub_holder row content\">\n        <div class=\"col-12\">\n            <div class=\"intro_sec\">\n                <div class=\"sub_holder row\">\n                    <div class=\"col-lg-6 f-col\">\n                        <div class=\"first_col\">\n                            <h2>Our Value Promise</h2>\n                            <div class=\"custom_content\">\n                                <?php $term = get_queried_object();\n$custom_content = get_field('custom_content', $term);\necho $custom_content; ?>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"col-lg-6\">\n\n<?php\n                    $image = get_field('workplace_thumb', $term);\n\nif ($image)\n{\n?>\n                        <div class=\"second_col\" style=\"background-image: url(<?php echo $image['url']; ?>);\">\n\n                        <?php\n}\n\nelseif (!$image)\n{?>\n                        <div class=\"second_col\" style=\"background-image: url(<?php woocommerce_category_image();\n}\n\n?>);\">\n                            <div class=\"gradient_overlay\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php\nif (woocommerce_product_loop())\n{\n\n    /**\n     * Hook: woocommerce_before_shop_loop.\n     *\n     * @hooked woocommerce_output_all_notices - 10\n     * @hooked woocommerce_result_count - 20\n     * @hooked woocommerce_catalog_ordering - 30\n     */\n?>\n<div class=\"container notices\">\n    <div class=\"row_notices\">\n        <?php /*notices output in separate div */\n?>\n        <div class=\"xoo-wsc-cart-trigger\">Trigger Side Cart</div>\n        <?php\n    do_action('woocommerce_before_shop_loop'); ?>\n    </div>\n</div>\n</div>\n</div>\n</div>\n\n\n<div class=\"container cat_view\">\n    <div class=\"row\"><?php\n    woocommerce_product_loop_start();\n\n    if (wc_get_loop_prop('total'))\n    {\n\n        while (have_posts())\n        {\n\n            the_post();\n            $product_cats = wp_get_post_terms(get_the_ID() , 'product_cat');\n            global $post;\n            //Get the current workplace slug\n            foreach ($product_cats as $collection)\n            {\n                \n                $category_slugs[] = $collection->slug;          \n\n            }          \n        \n\n            /**\n             * Hook: woocommerce_shop_loop.\n             */\n            do_action('woocommerce_shop_loop');\n\n           //   wc_get_template_part( 'content', 'product' );\n\n        }\n\n    }\n    \n\n    /*at this point, all relevant category slugs have been gathered and then sorted to remove duplicates.*/\n?>\n       \n         <?php $category_slugs = array_unique($category_slugs);\n  //  print_r($category_slugs); \n  \n     \n\n        \n/**\n * INITIALISE EMPTY ARRAYS FOR PROCESSING.\n * ADD TO ARRAY IF SLUG AT $check IS A SIBLING OF RELEVANT CATEGORY.\n * IT ALSO WILL CHECK WITH || OR IF IT IS == TO RELEVANT CATEGORY.\n * THIS IS IN THE EVENT A PRODUCT IS ASSIGNED TO THE PARENT CATEGORY.\n * EACH ARRAY IS PLACED WITHIN IT'S RELEVANT TAB.\n * AN 'OTHER' TAB WILL ONLY APPEAR IF A CATEGORY IS ABSTRACT TO THE RELEVANT CATEGORIES.\n * THIS USES workplace_construct_categories(); & prod_cat_is_ancestor_of(); FUNCTIONS IN FUNCTIONS.PHP.\n */\n\n /*Initialise each relevant array */\n    $array_of_window_cleaning = [];\n    $array_of_hygiene_products = [];\n    $array_of_catering_supplies = [];\n    $array_of_hygiene_equipment = [];\n    $array_of_workwear = [];\n    $abstract_categories = [];\nif( $category_slugs ){\n    foreach ($category_slugs as $check)\n    {\n        $value = get_term_by('slug', $check, 'product_cat');\n        $workwear_safety = get_term_by('slug', 'workwear-safety', 'product_cat');\n        $hygiene_products = get_term_by('slug', 'hygiene-products', 'product_cat');\n        $hygiene_equipment = get_term_by('slug', 'hygiene-equipment', 'product_cat');\n        $catering_supplies = get_term_by('slug', 'catering-supplies', 'product_cat');\n        $window_cleaning = get_term_by('slug', 'window-cleaning', 'product_cat');\n\n        if (prod_cat_is_ancestor_of($workwear_safety, $value) || ($value->slug == $workwear_safety->slug))\n        {\n            if ($value->slug != $workwear_safety->slug)\n                $array_of_workwear[] = $value->slug;\n        }\n    \n        elseif (prod_cat_is_ancestor_of($hygiene_products, $value) || ($value->slug == $hygiene_products->slug))\n        {\n            \n            if ($value->slug != $hygiene_products->slug)\n                $array_of_hygiene_products[] = $value->slug;\n                \n        }\n    \n        elseif (prod_cat_is_ancestor_of($hygiene_equipment, $value) || ($value->slug == $hygiene_equipment->slug))\n        {\n            if ($value->slug != $hygiene_equipment->slug)\n                $array_of_hygiene_equipment[] = $value->slug;\n        }\n    \n        elseif (prod_cat_is_ancestor_of($catering_supplies, $value) || ($value->slug == $catering_supplies->slug))\n        {\n            if ($value->slug != $catering_supplies->slug)\n                $array_of_catering_supplies[] = $value->slug;\n        }\n    \n        elseif (prod_cat_is_ancestor_of($window_cleaning, $value) || ($value->slug == $window_cleaning->slug))\n        {\n            if ($value->slug != $window_cleaning->slug)\n                $array_of_window_cleaning[] = $value->slug;\n        }\n    \n        else\n        {\n            global $post;\n            $terms = get_the_terms( $post->ID, 'product_cat' );      \n            foreach ($terms  as $term  ) {\n                $product_cat_id = $term->term_id;\n                $product_cat_name = $term->slug;\n                break;\n            }\n    \n         \n            if($value->slug != $product_cat_name)\n                $abstract_categories[] = $value->slug;\n            \n        }\n    }\n    } \n?>\n\n\n\n\n    </div>\n</div>\n</div>\n</div>\n</div>\n<pre><?php\n//print_r( $array_of_hygiene_products );\n?></pre>\n<!-- Display section of categories -->\n\n<div class=\"container\" data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"10\" data-aos-duration=\"1000\"\n    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"false\" data-aos-anchor-placement=\"top-center\">\n    <div class=\"row\">\n        <h2 class=\"main_headings cat_titles\"><?php woocommerce_page_title(); ?>: Relevant Categories </h2>\n    </div>\n</div> <?php\n?>\n\n<div class=\"container-fluid\">\n    <div class=\"row\">\n        <div class=\"col-12\">\n            <ul class=\"nav nav-tabs justify-content-center\">\n                <li class=\"active\" data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"10\"\n                    data-aos-duration=\"1000\" data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a class=\"active\" href=\"#tab1\" data-bs-toggle=\"tab\">Workwear\n                        & Safety</a></li>\n                <li data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"300\" data-aos-duration=\"1000\"\n                    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a href=\"#tab2\" data-bs-toggle=\"tab\">Hygiene Products</a>\n                </li>\n                <li data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"600\" data-aos-duration=\"1000\"\n                    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a href=\"#tab3\" data-bs-toggle=\"tab\">Hygiene Equipment</a>\n                </li>\n                <li data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"900\" data-aos-duration=\"1000\"\n                    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a href=\"#tab4\" data-bs-toggle=\"tab\">Catering Supplies</a>\n                </li>\n                <li data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"1200\" data-aos-duration=\"1000\"\n                    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a href=\"#tab5\" data-bs-toggle=\"tab\">Window Cleaning</a></li>\n                <?php\n    if (!empty($abstract_categories))\n    {\n?>\n                <li class=\"tab6_zindex\" data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"1200\" data-aos-duration=\"1000\"\n                    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a href=\"#tab6\" data-bs-toggle=\"tab\">More</a></li>\n                <?php\n    } ?>\n            </ul>\n        </div>\n    </div>\n</div>\n<div class=\"tab-content container\">\n    <div class=\"tab-pane active\" id=\"tab1\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseOne\">\n\n                        Workwear & Safety\n                    </a>\n                </h4> \n            </div>\n            <div id=\"collapseOne\" class=\"panel-collapse collapse in\">\n                <div class=\"panel-body\">\n                    <?php $term = get_queried_object();\n    $safteyworkwear = get_field('workwear-safety', $term);\n    echo $safteyworkwear;\n\n    //$newarray = [];\n    if (!empty($array_of_workwear))\n    {\n       \n        echo '<div class=\" woocommerce columns-5\"><ul class=\"products columns-5\">';\n        foreach ($array_of_workwear as $check)\n        {\n            $value = get_term_by('slug', $check, 'product_cat');\n            workplace_construct_categories($value);\n        }\n\n    }\n    if (!empty($array_of_workwear)) echo '</ul></div>';\n\n?>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"tab-pane\" id=\"tab2\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseTwo\">\n                        Hygiene Products\n                    </a>\n                </h4>\n            </div>\n            <div id=\"collapseTwo\" class=\"panel-collapse collapse\">\n                <div class=\"panel-body\">\n                    <?php $hyg_products = get_field('hygiene_products', $term);\n    echo $hyg_products;\n\n    if (!empty($array_of_hygiene_products))\n    {\n       $array_of_hygiene_products = array_unique( $array_of_hygiene_products);\n             \n        echo '<div class=\" woocommerce columns-5\"><ul class=\"custom_load products columns-5\">';\n   \n        foreach ($array_of_hygiene_products as $check)\n        {\n            $value = get_term_by('slug', $check, 'product_cat');           \n            workplace_construct_categories($value);\n           //wc_get_template_part( 'content', 'product_cat' );\n        }\n\n    }\n    if (!empty($array_of_hygiene_products)) echo '</ul></div>';\n?>\n\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"tab-pane\" id=\"tab3\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseThree\">\n                        Hygiene Equipment\n                    </a>\n                </h4>\n            </div>\n            <div id=\"collapseThree\" class=\"panel-collapse collapse\">\n                <div class=\"panel-body\">\n                    <?php $hyg_equip = get_field('hygiene_equipment', $term);\n    echo $hyg_equip;\n\n    if (!empty($array_of_hygiene_equipment))\n    {\n        echo '<div class=\"woocommerce columns-5\"><ul class=\"products columns-5\">';\n        foreach ($array_of_hygiene_equipment as $check)\n        {\n            $value = get_term_by('slug', $check, 'product_cat');\n            workplace_construct_categories($value);\n        }\n\n    }\n    if (!empty($array_of_hygiene_equipment)) echo '</ul></div>'; ?>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"tab-pane\" id=\"tab4\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseFour\">\n                        Catering Supplies\n                    </a>\n                </h4>\n            </div>\n            <div id=\"collapseFour\" class=\"panel-collapse collapse\">\n                <div class=\"panel-body\">\n                    <?php /*do_action( 'woocommerce_after_shop_loop' ); */ ?>\n                    <?php $catering = get_field('catering_supplies', $term);\n    echo $catering;\n\n    if (!empty($array_of_catering_supplies))\n    {\n        echo '<div class=\" woocommerce columns-5\"><ul class=\"products columns-5\">';\n        foreach ($array_of_catering_supplies as $check)\n        {\n            $value = get_term_by('slug', $check, 'product_cat');\n            workplace_construct_categories($value);\n        }\n\n    }\n    if (!empty($array_of_catering_supplies)) echo '</ul></div>';\n?>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"tab-pane\" id=\"tab5\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseFive\">\n                        Window Cleaning\n                    </a>\n                </h4>\n            </div>\n            <div id=\"collapseFive\" class=\"panel-collapse collapse\">\n                <div class=\"panel-body\">\n                    <?php /*do_action( 'woocommerce_after_shop_loop' ); */ ?>\n                    <?php $win_cleaning = get_field('window_cleaning', $term);\n    echo $win_cleaning;\n    if (!empty($array_of_window_cleaning))\n    {\n        echo '<div class=\" woocommerce columns-5\"><ul class=\"products columns-5\">';\n        foreach ($array_of_window_cleaning as $check)\n        {\n            $value = get_term_by('slug', $check, 'product_cat');\n            workplace_construct_categories($value);\n        }\n\n    }\n    if (!empty($array_of_window_cleaning)) echo '</ul></div>';\n?>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!--tab 5 close -->\n\n    <?php\n    if (!empty($abstract_categories))\n    {\n?>\n    <div class=\"tab-pane\" id=\"tab6\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseSix\">\n                        More\n                    </a>\n                </h4>\n            </div>\n            <div id=\"collapseSix\" class=\"panel-collapse collapse\">\n                <div class=\"panel-body\">\n                    <?php /*do_action( 'woocommerce_after_shop_loop' ); */ ?>\n                    <?php\n                   \n        echo '<div class=\" woocommerce columns-5\"><ul class=\"products columns-5\">';\n        foreach ($abstract_categories as $check)\n        {\n            $value = get_term_by('slug', $check, 'product_cat');\n            workplace_construct_categories($value);\n        }\n\n        echo '</ul></div>';\n?>\n                </div><!-- close -->\n            </div><!-- close -->\n        </div><!-- close -->\n\n     \n    </div><!-- more div close -->\n\n\n    \n</div><!-- close -->\n\n\n\n\n\n\n\n</div><!-- close -->\n<?php\n    }\n    else\n    {\n        echo '</div>';\n    } ?>\n\n<!--end of display section -->\n<?php\necho '<pre>';\n    print_r( $array_of_hygiene_products);\n    echo '</pre>';?>\n\n<?php\n    woocommerce_product_loop_end();\n    /**\n     * Hook: woocommerce_after_shop_loop.\n     *\n     * @hooked woocommerce_pagination - 10\n     */\n    do_action('woocommerce_after_shop_loop');\n}\nelse\n{\n    /**\n     * Hook: woocommerce_no_products_found.\n     *\n     * @hooked wc_no_products_found - 10\n     */\n    do_action('woocommerce_no_products_found');\n}\n/**\n * Hook: woocommerce_after_main_content.\n *\n * @hooked woocommerce_output_content_wrapper_end - 10 (outputs closing divs for the content)\n */\ndo_action('woocommerce_after_main_content');\n/**\n * Hook: woocommerce_sidebar.\n *\n * @hooked woocommerce_get_sidebar - 10\n */\ndo_action('woocommerce_sidebar');\nget_footer('shop');\n\n\nMy function you will see within the separate tabs to construct categories:\n/*For use on WORKPLACE TAX PAGE*/\nfunction workplace_construct_categories($value){\n\n    global $wp_query;\n    $wp_slug = $wp_query->query_vars['workplaces'];   \n    $cat_slug = $value->slug;                        \n    $cat_name = $value->name;\n    echo '<li class=\"product-category product brand_cats\"><div class=\"banner-box\"><div class=\"banner-box__image\"> \n    <a href=\"' . esc_url ( get_bloginfo( 'url' ) ) . '/'. 'product-category'. '/' . esc_html($cat_slug) . '?workplaces=' . esc_html($wp_slug) . '\"';\n    echo the_subcategory_thumbnail( $value);          \n    echo '</a></div><div class=\"banner-box__info\"><a href=\"' . get_bloginfo( 'url' ) . '/'. 'product-category'. \n    '/' . esc_html($cat_slug) . '?workplaces=' . esc_html($wp_slug) . '/' . '\">' . '<h2 itemprop=\"name\" class=\"woocommerce-loop-category__title\"><span>' . \n    esc_html($cat_name) . '</a></span></h2></li>'; \n}\n\n\nA: I solved my problem with:\nhttps://stackoverflow.com/questions/61622017/get-woocommerce-product-categories-that-contain-a-specific-product-brand/61624358#61624358\nturns out wp_query wasn't the right choice for my requirements.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404102", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to make every image title equal to alt text(wordpress/woocommerce)? I need onhover-titles for all images - in products, in product category, etc. In wp media library all images have their alt text, I need to show it as a title of each image. Is there a hook to do it? I try to do it by jQuery\nadd_action('wp_footer', 'product_alt_title');\nfunction product_alt_title(){\nglobal $post;\n $image_id = get_post_thumbnail_id();\n $image_alt = get_post_meta($image_id, '_wp_attachment_image_alt', TRUE);                        \n?>\n    <script>\n         var image_alt =  <?php echo $image_alt ?>; \n         jQuery(document).ready(function($){\n            jQuery('img').attr('title','image_alt ');\n        });\n    </script>\n<?php }\n\nBut console doesn't see my var value, it shows like var image_alt = ;\nIt's a shop, not an article, so I exactly need the code decision. What is the right way?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404105", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom ordering fails after AJAX post filter With the invaluable help of a fellow developer (nicknamed SallyCJ), I have managed to order custom type posts by the last 'word' of their titles (integers ranging from 358 to above 1000). I have applied the below filter\nfunction orderby_post_title_int( $orderby ){\n    return \"SUBSTRING( wp_posts.post_title, 9 ) + 0 ASC\";\n} \n\nand it works like a charm. Please note titles have a fixed 8-character string (TM.74.G.) coming before the integer that provides the order, hence the \"SUBSTRING( wp_posts.post_title, 9 ) + 0 ASC\";\nYet, after AJAX filtering the custom posts by categories and subcategories, posts are listed up to TM.74.G.999, skipping all following posts ranging from TM.74.G.1000 to TM.74.G.1033.\n    $(document).ready(function() {\n        $(document).on('submit','[data-js-form=filter]',function(e){\n            e.preventDefault();\n            var tabClass = $(this).parent().parent().parent().parent().attr('class').split(' ')[0];\n            //alert(tabClass);\n            var data = $(this).serialize(); \n            // console.log(data);\n    \n        $('.' + tabClass + ' ' +'.js-filter').toggleClass('hasloader');\n        $.ajax({\n            url: wpAjax.ajaxUrl,\n            //data: { action: 'filter', category: category },\n            data: data,\n            type: 'post',\n            success: function(result) {\n                console.log(data);\n                //alert('ok');\n                 $('.' + tabClass + ' ' +'.js-filter').toggleClass('hasloader');\n                 $('.' + tabClass + ' ' +'.js-filter').html(result);\n                //alert('ok');\n                // console.log(data);\n            },\n            error: function(result) {\n                console.warn(result);\n                \n                 $('.' + tabClass + ' ' +'.js-filter').toggleClass('hasloader');\n            }\n        })\n    })\n    })\n})(jQuery);\n\nphp callback:\n<?php add_action('wp_ajax_myfilter', 'misha_filter_function'); // wp_ajax_{ACTION HERE} \nadd_action('wp_ajax_nopriv_myfilter', 'misha_filter_function');\n\nfunction misha_filter_function(){\n    add_filter('posts_orderby', 'orderby_post_title_int' );\n    $args = array(\n        'post_type'         =>  'intaglioligneo',\n        'posts_per_page'    =>  -1\n        \n    );\n if( isset( $_POST['freesearch'] ) ) {\n    $args['s'] = $_POST['freesearch'];\n }\n    // for taxonomies / categories\n    if( isset( $_POST['categoryfilter'] ) )\n        $args['tax_query'] = array(\n            array(\n                'taxonomy' => 'category',\n                'field' => 'id',\n                'terms' => $_POST['categoryfilter']\n            )\n        );\n        elseif( !isset( $_POST['categoryfilter'] ) )\n        $args = array(\n            'post_type'         =>  'intaglioligneo',\n            'posts_per_page'    =>  -1\n            \n        );\n    $query = new WP_Query( $args );\n    \n    if( $query->have_posts() ) :\n        while( $query->have_posts() ): $query->the_post();\n             \n            include(locate_template('template-variables.php')); \n            include(locate_template('template-card.php'));\n        endwhile;\n        wp_reset_postdata();\n    else :\n        echo '<h3>Nessuna scheda trovata</h3>.<p class=\"has-drop-cap is-style-hero2\"> Non ci sono schede che rispondano ai criteri di ricerca impostati dall\\'utente; si prega di riprovare calibrando diversamente i filtri di categoria e/o sottocategoria, oppure di controllare il testo inserito nel campo \\'Ricerca Libera\\'.</p>';\n    endif;\n    \n    die();\n}\n\nPlease note that if I remove the custom ordering all posts are filtered and rendered correctly.\nAny hint?\nThanks in advance for you help,\nAlessio\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404109", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do you order posts by type then term_id and then by date? I am a php newbie and struggling to try and figure this one out. I have page where I am returning all the newsroom posts. The posts have a newsroom type that further divides them into Awards, Press Releases, In the News. I want to display the posts in groups so that all of the Press Releases show up first, then the awards and finally In the News. Within each group I want to further sort by date (newest first). Currently, I have this in my functions.php file to set up the query.\nadd_action( 'elementor/query/newsroom_order', function( $query ) {\n    $query->set( 'post_type', 'newsroom' );\n    $query->set( 'posts_per_page', '12'); // unable to override number on actual page\n});\n\nI'm using FacetWP as well. I've tried to do an orderby but it doesn't allow me to set the actual order.\nThese are the values:\n\n*\n\n*Taxonomy = newsroom_type\n\n*post_type = newsroom\n\n*slug OR term_id for:\n\n*\n\n*awards, 1822\n\n*press_releases, 1812\n\n*in_the_news, 1814\n\n\n\nI'm hoping someone can tell me a good way to accomplish this.\n\nA: You can use the orderby parameter and pass it an array of what you want to order by in the order you want it ordered by:\nhttps://developer.wordpress.org/reference/classes/wp_query/#order-orderby-parameters\nThis solves the problem of ordering by post type, and by date, but ordering by term slug or term ID is not something WP_Query can do. It may make sense to you as your posts only appear in a single newsroom_type but nothing prevents an item being both an award and a press release at the same time in the database, so sorting by terms doesn't make sense, especially since terms have no inherent order that can be used.\nThe closest is alphabetic, but that complicates sorting further, e.g. if a post has term A and G, does it come after or before a post with the term B? What if B is a child term of G? Sorting by terms is a massive can of worms that has never been tackled or solved. You can't sort by terms with WP_Query. You can group/search/filter for posts by terms though.\nThe best way to do this is to instead do 3 separate queries.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404110", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: How to stop DOMDocument destroying embeds? I am making use of PHP's DOMDocument to carry out two DOM operations on the post content, by filtering the_content:\n\n*\n\n*Wrap a certain element pattern in a div.\n\n*Add a class to a particular element.\n\nThe trouble is, it seems like DOMDocument is destroying embedded WordPress content like tweets. As seen in this example, the embedded tweet is not rendered as an <iframe> as it should be, it is just rendered using <p>.\nIs there a way to stop DOMDocument from doing this?\nMy code is below.\n/*\nWrap element in another element.\nContributed by @XzKto, https://stackoverflow.com/a/8428323/1375163\n*/\nfunction wrap_element($dom, $wrapped_element, $new_element) {\n    // Initialise the new wrapper\n    $wrapper = $dom->createElement($new_element);\n    //Clone our created element\n    $wrapper_clone = $wrapper->cloneNode();\n    //Replace image with this wrapper div\n    $wrapped_element->parentNode->replaceChild($wrapper_clone,$wrapped_element);\n    //Append the element to wrapper div\n    $wrapper_clone->appendChild($wrapped_element);\n}\n\n/*\nBlockquote\n*/\nadd_filter( 'the_content', 'bootstrap_blockquote' );\nfunction bootstrap_blockquote( $content ) {\n    // Load DOM of post content\n    $dom = new DOMDocument();\n    $dom->loadHTML($content, LIBXML_HTML_NOIMPLIED | LIBXML_HTML_NODEFDTD);\n\n    foreach($dom->getElementsByTagName('blockquote') as $blockquote){\n        // Add blockquote class\n        // Class addition contributed by @Gillu13, https://stackoverflow.com/a/63088684/1375163\n        $class_to_add = 'blockquote';\n        $blockquote->setAttribute('class', $class_to_add);\n        // Wrap blockquote in <figure>\n        wrap_element($dom, $blockquote, 'figure');\n    }\n\n    $content = utf8_decode($dom->saveHTML($dom->documentElement)); // formatting correction contributed by @Greeso, https://stackoverflow.com/a/20675396/1375163\n    return $content;\n}\n\n..\n/*\nOriginal contributed by @jack,\nhttps://stackoverflow.com/a/10683463/1375163\n*/\nadd_filter( 'the_content', 'segment_post' );\nfunction segment_post( $content ) {\n\n    $d = new DOMDocument;\n    libxml_use_internal_errors(true);\n    $d->loadHTML($content);\n    libxml_clear_errors();\n\n    $segments = array(); $card = null;\n\n    foreach ($d->getElementsByTagName('h3') as $h3) {\n        // first collect all nodes\n        $card_nodes = array($h3);\n        // iterate until another h3 or no more siblings\n        for ($next = $h3->nextSibling; $next && $next->nodeName != 'h3'; $next = $next->nextSibling) {\n            $card_nodes[] = $next;\n        }\n\n        // create the wrapper node\n        $card = $d->createElement('div');\n        $card->setAttribute('class', 'card p-4 mb-3');\n\n        // replace the h3 with the new card\n        $h3->parentNode->replaceChild($card, $h3);\n        // and move all nodes into the newly created card\n        foreach ($card_nodes as $node) {\n            $card->appendChild($node);\n        }\n        // keep title of the original h3\n        $segments[] = $h3->nodeValue;\n    }\n\n    //  make sure we have segments (card is the last inserted card in the dom)\n    /*\n    if ($segments && $card) {\n        $ul = $d->createElement('ul');\n        foreach ($segments as $title) {\n            $li = $d->createElement('li');\n\n            $a = $d->createElement('a', $title);\n            $a->setAttribute('href', '#');\n\n            $li->appendChild($a);\n            $ul->appendChild($li);\n        }\n\n        // add as sibling of last card added\n        $card->parentNode->appendChild($ul);\n    }\n    */\n\n    // TODO: examine https://stackoverflow.com/questions/10703057/wrap-all-html-tags-between-h3-tag-sets-with-domdocument-in-php\n\n    $content = utf8_decode($d->saveHTML($d->documentElement)); // formatting correction contributed by @Greeso, https://stackoverflow.com/a/20675396/1375163    \n    return $content;\n}\n\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404118", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I set a post slug automatically based on taxonomy? I have a hierarchical CPT event with taxonomy event_category. One of those categories is \"Recap\". When a user saves a post (could be draft, publish, or edit existing), if the event_category is Recap and the post has a parent, I want to set the slug to \"recap\" automatically.\nThe problem is, when wp_insert_post() fires (and all the hooks within it, like wp_insert_post_data and save_post, the taxonomy has not yet been updated, and the data sent to wp_insert_post() does not contain the taxonomy information. There is code in wp_insert_post() to handle taxonomy data if passed, ($postarr['tax_input']), but frustratingly WordPress does not use it. Instead, it seems to process the taxonomy separately. At the time wp_insert_post() runs, the taxonomy data will be equal to what it was the previous update (or empty if a new post).\nI can hook into set_object_terms, but that does not trigger during a post update when the taxonomy hasn't changed, so it misses the scenario when an existing Recap is updated as a child of another Event.\nIs there maybe a hook that fires when the update request comes in, and/or one when everything is finished?\n\nA: I tried hooking in to rest_post_dispatch, and that seems to work for edits in the block editor. Only problem here is that the slug does not update in the editor, so the URL is wrong if the author clicks the link to view it after saving. A separate hook is needed to cover quick edit and bulk edit. Current working code:\n/**\n * Default event recap slug\n * If has parent and is in category Recap, set slug to \"recap\".\n * Can't use `wp_insert_post_data` because taxonomy data isn't included, frustratingly.\n */\n// Catch changes in block editor\nadd_filter( 'rest_post_dispatch', 'recap_slug_rest', 10, 3 );\nfunction recap_slug_rest( $result, $server, $request ) {\n    if ( 'PUT' == $request->get_method() ) {\n        $post_id = $request->get_param( 'id' );\n        $post = get_post( $post_id );\n        if ( 'event' == $post->post_type && $post->post_parent ) {\n            $terms = get_the_terms( $post_id, 'event_category' );\n            foreach ( $terms as $term ) {\n                if ( in_array( $term->slug, [ 'recap', 'recaps' ] ) ) {\n                    wp_update_post( [ 'ID' => $post_id, 'post_name' => 'recap' ] );\n                    break;\n                }\n            }\n        }\n    }\n    return $result;\n}\n// Catch quick/bulk edit\nadd_action( 'save_post_event', 'default_recap_slug_save_post', 10, 3 );\nfunction default_recap_slug_save_post( $post_ID, $post, $update ) {\n    if ( defined( 'REST_REQUEST' ) ) return;\n    if ( $post->post_parent ) {\n        $terms = get_the_terms( $post, 'event_category' );\n        foreach ( $terms as $term ) {\n            if ( in_array( $term->slug, [ 'recap', 'recaps' ] ) ) {\n                remove_action( 'save_post_event', 'default_recap_slug_save_post' );\n                wp_update_post( [ 'ID' => $post->ID, 'post_name' => 'recap' ] );\n                add_action( 'save_post_event', 'default_recap_slug_save_post', 10, 3 );\n                break;\n            }\n        }\n    }\n}\n\n\nA: \nIs there maybe a hook that fires when the update request comes in,\nand/or one when everything is finished?\n\nYes, there is. It's an action hook named wp_after_insert_post:\n\ndo_action( 'wp_after_insert_post', int $post_id, WP_Post $post, bool $update,  null|WP_Post $post_before )\nFires once a post, its terms and meta data has been saved.\n\nSee the documentation and also New action wp_after_insert_post in WordPress 5.6. \u2013 Make WordPress Core.\nSo in response to your current answer, you could use just wp_after_insert_post instead of having to use rest_post_dispatch and save_post, and your code would work with both the classic editor and the block/Gutenberg editor.\nCode I used for testing:\nadd_action( 'wp_after_insert_post', 'my_wp_after_insert_post' );\nfunction my_wp_after_insert_post( $post_id ) {\n    // In my actual code, I checked if the current (admin) page is edit.php, and\n    // if so, I do nothing. I also run other checks, e.g. whether WordPress is\n    // auto-saving the post, or is doing cron.\n\n    // We call get post to retrieve the post's fresh data.\n    $post = get_post( $post_id );\n\n    // Do nothing if the post is invalid or the slug is already \"recap\", or if\n    // the post doesn't have a parent or isn't in the \"Recap\" categories.\n    if ( ! $post || 'recap' === $post->post_name ||\n        $post->post_parent < 1 || 'event' !== $post->post_type ||\n        ! has_term( [ 'recap', 'recaps' ], 'event_category', $post_id )\n    ) {\n        return;\n    }\n\n    // Unhook this function to avoid infinite loop.\n    remove_action( 'wp_after_insert_post', __FUNCTION__ );\n\n    wp_update_post( array( 'ID' => $post_id, 'post_name' => 'recap' ) );\n\n    // Re-hook this function.\n    add_action( 'wp_after_insert_post', __FUNCTION__ );\n}\n\n\nAnd as for this (in your answer):\n\nOnly problem here is that the slug does not update in the editor, so the URL is wrong if the author clicks the link to view it after saving.\n\nYes, and from what I found out via the core source, the REST API controller class (for Posts, Pages and CPTs) is unfortunately not using the programmatically-updated post slug, so as a workaround, you can use the rest_prepare_<post type> hook like so \u2014 to modify the response data, to ensure the post slug is the latest one:\nadd_filter( 'rest_prepare_event', 'my_rest_prepare_event', 10, 2 );\nfunction my_rest_prepare_event( $response, $post ) {\n    $data = $response->get_data();\n\n    // In the REST API response, post_name is slug.\n    $data['slug'] = get_post_field( 'post_name', $post->ID );\n\n    $response->set_data( $data );\n\n    return $response;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404120", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Scroll code block instead of wrapping text I'm including some code in a blog post and the length of some lines causes text to wrap, which I don't want.\nI'd like to have the sort of thing which can be found here on stackexchange, where a scroll bar is added for long code to prevent line breaks.\ntttttttttttttthhhhhhhhhhhhhiiiiiiiissssssssssssssssss iiiiiiiiiiiiiiiiiissssssssssssssssss vvvvvveeeeeeeerrrrrrrryyyyyyyyy llllllllooooooonnnnnnnnnnnnnggggggggggg\n\nAfter some research I've tried adding this custom CSS class:\n.scroll {\n  white-space: pre;\n  overflow-x: scroll;\n}\n\nBut this has had no effect on the code block. What should I do?\n\nA: Are you using blocks?\nTry to add a code block, give it an additional class scroll - and adjust your css like:\n.scroll code {\n  white-space: pre;\n  overflow-x: scroll;\n}\n\nShould work then.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404128", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress - When visiting a `single post/ single.php` my category menu item link becomes active I'm new to WordPress. So, I'm not really sure if it's normal behavior or not but this is bothering me. So, I've my main navigation menu consists of Home | category_1 | Category_2 | Category_3 ...\nThe issue is that whenever I click on a post link it loads as expected but the category under which the post is created also becomes active which I don't want. For example, if I click on a post from category_1 it loads with the single.php template, and my navigation menu(top navbar) becomes Home | **category_1(active)** | Category_2 | category_3....\nSo my questions are is it a normal behavior in WordPress? And how can I load the single post without making the catgroy link active??\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404131", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: PHP inside echo HTML I am a little bit confused about the following code:\ni need to add span class=\"<?= $styles['core']; ?>\"\n<?php \nif( ! defined( 'CP_VC_ACTIVE' ) ) {\necho '<li><span class=\"core\">'.esc_html__('Required','cpo').'</span><a target=\"_blank\" href=\"'. esc_url( admin_url( 'themes.php?page=tgmpa-install-plugins' ) ) . '\"> '. esc_html__('hi iam here', 'cpo') . '</a></li>'; \n}\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404135", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Axis guidelines over an image I'm trying to implement this in WordPress: https://stackoverflow.com/questions/11461913/making-axis-guide-lines-over-an-image-that-follow-the-mouse-pointer\nI created this script in my theme folder (/js/guidelines.js):\njQuery('#imageholder img').on('mousemove', null, [jQuery('#horizontal'), jQuery('#vertical')],function(e){\n    e.data[1].css('left', e.offsetX==undefined?e.originalEvent.layerX:e.offsetX);\n    e.data[0].css('top', e.offsetY==undefined?e.originalEvent.layerY:e.offsetY);\n});\njQuery('#imageholder').on('mouseenter', null, [jQuery('#horizontal'), jQuery('#vertical')], function(e){\n    e.data[0].show();\n    e.data[1].show();\n}).on('mouseleave', null, [jQuery('#horizontal'), jQuery('#vertical')], function(e){\n        e.data[0].hide();\n        e.data[1].hide();\n});\n\nAdded this to functions.php:\nadd_action( 'wp_enqueue_scripts', 'add_guidelines' );\nfunction add_guidelines() {\n    wp_enqueue_script(\n        'guidelines', // name your script so that you can attach other scripts and de-register, etc.\n        get_template_directory_uri() . '/js/guidelines.js', // this is the location of your script file\n        array('jquery') // this array lists the scripts upon which your script depends\n    );\n}\n\nAnd added the CSS to additional CSS in the theme customizer:\n#imageholder div{ background-color:black;position:absolute; }\n#imageholder{;position:relative;display:inline-block;overflow:hidden; }\n#horizontal{width:100%;height:1px;}\n#vertical{width:1px;height:100%;}\n\nBut when I try to implement these guidelines on a graph:\n<div id=\"imageholder\">\n    <div id=\"horizontal\"></div>\n    <div id=\"vertical\"></div>\n    <img src=\"https://www.elesa.com/siteassets/low/ELESA/DWG/TechData_web/AV_ACC_DIAGRAM_EN.jpg\">\n</div>\n\n... the guidelines are not dynamic and stay at the top left corner:\n\nMaybe someone can help me with this problem.\nI don't know what's wrong here.\n\nA: I just had to wrap document ready function around:\njQuery(document).ready(function( $ ) {\n\n    $('#imageholder img').on('mousemove', null, [jQuery('#horizontal'), jQuery('#vertical')],function(e){\n        e.data[1].css('left', e.offsetX==undefined?e.originalEvent.layerX:e.offsetX);\n        e.data[0].css('top', e.offsetY==undefined?e.originalEvent.layerY:e.offsetY);\n    });\n    $('#imageholder').on('mouseenter', null, [jQuery('#horizontal'), jQuery('#vertical')], function(e){\n        e.data[0].show();\n        e.data[1].show();\n    }).on('mouseleave', null, [jQuery('#horizontal'), jQuery('#vertical')], function(e){\n            e.data[0].hide();\n            e.data[1].hide();\n    });\n\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404136", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Offload Media Library to other domain on a different server How is it possible to change the media storage of Wordpress to a subdomain on a different server. The main domain example.com running on a server pointing to IP 192.168.0.1 and I've created a subdomain subdomain.example.com running on a different server pointing to IP 192.168.1.1 which in return has 2 different home directory URL\nexample.com /home/example\nsubdomain.example.com /home/example2\nI'm clarifying those points because upload_path and upload_url_path works great when the domain and subdomain runs on the same server however here the case is different. Is there a plugin that can authenticate the FTP credentials and manage to resolve this changing the storage to external URL as if it's Cloud Storage from Gooogle or AWS?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404137", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: search custom table in wp database with searchform I need a search template for my custom table in my wordpress.\nIt should be one searchform and this searchform should search all\nentries using the \"LIKE\" option.\nThe table in my wordpress db has 5 columns, \"id,date,name,from,txt\".\nIf I type \"alexandera\" in the search form, for example, the form should\nsearch all entries and give the results in a table like\nwith 20 results per site\n| id | date | name | from | txt |\n|----|------|------|------|-----|\n| 1 | 2021-01-01 | Alexander | Bank | Mail of Bank ... |\n| 30 | 2021-05-01 | Alexander | Bank | Mail of Bank ...|\netc\nor if I type Bank, it should return\n| id | date | name | from | txt |\n|----|------|------|------|-----|\n| 1 | 2021-01-01 | Alexander | Bank | Mail of Bank |\n| 30 | 2021-05-01 | Alexander | Bank | Mail of Bank |\netc\nThanks\n\nA: You should use a wpdb object in PHP. Its usage is explained in manual.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404138", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: block variations registration in PHP Currently, both register_block_style and register_block_type exist in PHP as alternative to the same functions in javascript registerBlockStyle and registerBlockType. However, it seems that register_block_variation does not exist. Is there possibility to register core block variation from PHP?\n\nA: I found a workaround. Following snippet registers variant of post-excerpt block which will have only three lines of text. It does so by intercepting metadata from block.json and injecting new.\n<?php\nfunction extended_query_excerpt_block_args($args) {\n    $args['render_callback'] = 'render_block_core_post_excerpt';\n    $args['attributes']['variantType'] = [\n        'type' => 'string'\n    ];\n    $args['variations'] = [\n        [\n            'name' => 'three-lines-excerpt',\n            'title' => 'Three lines excerpt',\n            'attributes' => [\n                'variantType' => 'three-lines-excerpt'\n            ],\n        ]\n    ];\n    return $args;\n}\n\nfunction register_variation($args, $block_type) {\n    switch ($block_type) {\n        case 'core/post-excerpt':\n            $args = extended_query_excerpt_block_args($args);\n            break;\n    }\n    return $args;\n}\n\nadd_filter( 'register_block_type_args', 'register_variation', 10, 2 );\n\n\nA: As of January 2023, it seems that this function remains unavailable in PHP. The only issue where I find any mention to it in Gutenberg repo is this one:\nhttps://github.com/WordPress/gutenberg/issues/24994\nI've opened an issue requesting it, let's see if they can handle it :)\nhttps://github.com/WordPress/gutenberg/issues/47170\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404141", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: Autopopulate a value I created an options page where users can enter their Google Captcha key and secret.  Using update_option I am able to add these values to Elementor's settings.\nI'm trying to do the same with JetForm but it seems to need these values actually added to the settings page.  If I overwrite them with update_option the captcha option doesn't even appear on the form source code.\nIs there a way to have my option's page settings actually appear in the fields for JetForm instead of just the database?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404143", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add custom taxonomy using JS in post editor Very Excited - First Post to SE!\nI am creating a wordpress app that uses Javascript to call some JSON data and brings it back into the editor. All of that is working great.  I can console the data and see it.\nThe only thing I cannot tackle is:\nI have a custom taxonomy named genre that I need to populate with 3 new (or possibly existing) terms from the JSON data.\nI know that wp requires an array to put in the data and that works and I can see it.\ngenArr = [item[0],item[1],item[2]] for ex.\nI dont have any idea how to make the call to functions.php from the javascript file that has the data where I would call the wp_insert_term (or whatever the wordpress insert taxonomy code is)\nI have spent the better part of a week trying to figure this out, and I think I need to do this - but like I said I just cannot find the solution.\nJS file is working in post editor - I have a button there with onClick() event.\nIn theme functions.php - have a function there called postGenre() that takes the JSON data and add the appropriate terms to the genre taxonomy.\nI am lost on how to link the onClick() to the function in functions.php\nI REALLY appreciate the help.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404145", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Permalink with hierarchy of Custom Post Types We have a site where we have the following structure:\nwww.example.com/volume-number/book-title/chapter-title\nWe do this hierarchy by creating the Chapter pages as child of a Book page, which in turn is child of a Volume page.\nNow we are moving to using Custom Post Types with the CPT UI plugin.\nUpon creating a Chapter CPT, the URL displays as follows:\nwww.example.com/chapter/chapter-title\nIs there a recommended way to recreate that same hierarchy above when using CPTs?\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404146", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Changing the wordpress default search url to something like - ...example.com/search?query=keyword So I was trying to customize the WordPress default search URL and I found several solutions describing how to add a custom slug to the WordPress search URL and turn them into something like ...example.com/search/keyword. I tried the following solution:\nfunction theme_change_search_url() {\n    if ( is_search() && ! empty( $_GET['s'] ) ) {\n        wp_redirect( home_url( \"/search/\" ) . urlencode( get_query_var( 's' ) ) );\n        exit();\n    }\n}\nadd_action( 'template_redirect', 'theme_change_search_url' );\n\nIt worked. But I want it to be something like ...example.com/search?query=keyword. I've updated the function:\nfunction theme_change_search_url() {\n        if ( is_search() && ! empty( $_GET['s'] ) ) {\n            wp_redirect( home_url( \"/search?query=\" ) . urlencode( get_query_var( 's' ) ) );\n            exit();\n        }\n    }\n\nBut it sends me to the 404 Not Found page. So how do I achieve the custom search URL?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404147", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Override htacces rule only for specific directory I have a WordPress site with ithemes security installed plugin. I want to disable this rule:\nRewriteCond %{HTTP_USER_AGENT} \"^$\" [NC,OR]\n\nonly for this wp-content/uploads/xmls directory.\nRelevant (summarised) section of .htaccess file:\n# Begin HackRepair.com Blacklist\nRewriteEngine on\n# Abuse Agent Blocking\nRewriteCond %{HTTP_USER_AGENT} ^[Ww]eb[Bb]andit [NC,OR]\nRewriteCond %{HTTP_USER_AGENT} ^$ [NC,OR]\nRewriteCond %{HTTP_USER_AGENT} ^Acunetix [NC,OR]\n:\n: etc.\n:\nRewriteCond %{HTTP_USER_AGENT} YisouSpider [NC,OR]\nRewriteCond %{HTTP_USER_AGENT} zermelo [NC,OR]\nRewriteCond %{HTTP_USER_AGENT} ZyBorg\nRewriteRule ^.* - [F,L]\n# Abuse bot blocking rule end\n\n\nA: To effectively disable that condition for that one URL-path, you will need to add another rule immediately before the rule in question. ie. before the # Abuse Agent Blocking comment.\nFor example:\n# Allow an empty User-Agent for requests that start \"/wp-content/uploads/xmls\"\nRewriteCond %{HTTP_USER_AGENT} ^$\nRewriteRule ^wp-content/uploads/xmls - [S=1]\n\n# Abuse Agent Blocking\nRewriteCond %{HTTP_USER_AGENT} ^[Ww]eb[Bb]andit [NC,OR]\nRewriteCond %{HTTP_USER_AGENT} ^$ [NC,OR]\nRewriteCond %{HTTP_USER_AGENT} ^Acunetix [NC,OR]\n: etc.\n\nThe first rule skips the following rule if the requested URL-path starts /wp-content/uploads/xmls and the User-Agent header is empty. So, it effectively bypasses the rule that would otherwise block it.\nThis does assume that the request maps to a physical file in that directory. ie. Not a request that would otherwise be rewritten to the WordPress front-controller (index.php).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404148", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to get all customers cart from woocommerce API? I'm new to Woocommerce, I want to get all active carts for all users from API, so I can send them an email that your cart is waiting and ready for payment. I search the web and Woocommerce API documents and didn't find anything useful.\nIs there any way to get all carts from all users or I must install the plugin for that?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404149", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I enter on the Thank you page in woocommerce the discount code I assigned to the product category? I would like to show a discount code for each order from the same product category to the user on the \"Thank You\" page.\nif($order->get_total() >= 100000) {\n  echo //Discount code \n}\n\n\nA: You can find the code for the Thank You page here.  May I suggest the woocommerce_thankyou hook?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404150", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenberg allow use of block, but hide it from the block picker I am using a block for a page template like so:\nfunction register_work_template() {\n    $post_type_object = get_post_type_object( 'work' );\n    $post_type_object->template = array(\n        array( 'djave/worktemplate', array(\n            'placeholder' => 'Add Description...',\n        ) ),\n    );\n    $post_type_object->template_lock = 'all';\n}\nadd_action( 'init', 'register_work_template' );\n\nI know how to register or unregister the djave/worktemplate block, but how can I allow its use in this page template, but hide it from the block picker so it can't be used in again in other InnerBlocks or pages?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404151", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: is_page_template() written in jquery/javascript With php there is a wordpress function is_page_template()\nIs there a similar function written in jquery/javascript?\nTo use with the wp.customize api and jquery/javascript.\n\nA: Well, yes, in WordPress, different templates have a different body class name. If you inspect the body classes on a specific page in WordPress, there should be a body class page. You can detect the template by checking if the class exists like so:\njQuery(document).ready(function($){\n    if ( $('body').hasClass('page')) {\n        // add your logic here\n    }\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404152", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Weird urls after moving site from local env to a server I've noticed after moving website to a server post slugs started looking something like 78a6a04c0d498postname78a6a04c0d498.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404160", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to store and return json in a (custom) post meta field I have a custom post type which stores 2 meta fields. The first meta field is string data. No problem. The second is JSON data stored in field let's call it 'video'. For example I want to store in this field something like this: {key: data}. The Rest API should understand that this is JSON and return meta: {_string_field: \"string\", video: {key: data}}. In fact it returns: meta: {_string_field: \"string\", _video: '{key: data}'}. Notice the '. It treats it as a string.\nOK. So I understand I need to register the meta field as an Object type. (Object means JSON). AND I need to provide a schema for my JSON. This is explained here under Object Meta Type.\nSo I follow the instructions and end up with something like this (in register_post_meta):\n'show_in_rest' => array(\n            'schema' => array(\n                'type'       => 'object',\n                'properties' => array(\n                    'key' => array(\n                        'type' => 'string',\n                    ),\n                  \n                ),\n            ),\n        ),\n        'single' => true,\n        'type' => 'object',\n\nHowever - what happens now is the Rest API returns: meta: {_string_field: 'abc', _video: null}\nWhere null is I want my JSON! What am I doing wrong? What should I be looking for?\nUpdate:\nOne thing which is interesting about the documentation  is it says this:\nFor instance, the following code sample registers a post meta field called \u201crelease\u201d that accepts the given JSON data.\n{\n  \"meta\": {\n    \"release\": {\n      \"version\": \"5.2\",\n      \"artist\": \"Jaco\"\n    }\n  }\n}\n\nThis would imply that the whole data posted from the field should be like the above including 'meta' and the name of the field, 'video' in my case. I have tried this. Still null. Also tried just sending back my actual data without repeating the \"meta\" and fieldname wrappers. Still null.\nIt looks like a documentation error - i.e. the feature may exist but it doesn't work as documented.\nUpdate 2\nAfter a lot of digging I found where the problem lies.\nIn /wp-includes/rest-api.php there is some code which validates (I think) the data which is being prepared for REST output. I find this function: rest_validate_value_from_schema() which calls rest_validate_object_value_from_schema() which calls rest_is_object() with the value and checks that the return is an array - in rest_is_object() we have this:\nif ( $maybe_object instanceof JsonSerializable ) {\n    $maybe_object = $maybe_object->jsonSerialize();\n}\n\nThe code correctly detects that my custom meta field is of type Object and it tries to validate it. The value tested is the one I enter for the custom field value e.g. \"{\"test\":\"data\"}\" however after the above code  $maybe_object is still a string \"{\"test\":\"data\"}\". rest_validate_object_value_from_schema() needs it to be an array and so determines that it is invalid. It looks like either (most likely) the value is unexpected or the above code is incorrect.\n(I'm not sure about the instanceof - isn't JsonSerializable an interace which should be implemented to return an array? But I am not really an advanced PHP developer so I need advice on this point).\nI am not 100% convinced that Object types are in fact fully supported  but most likely I am missing something.\nFor now going to use a string field and convert to JSON on the client.\n\nA: I'm not exactly sure what are you really trying to do, but anyway, I hope these help?\n\n*\n\n*If you send the meta value as an object, e.g. video: {\"foo\":\"bla blah\",\"bar\":1234} in JS, then note that WordPress will serialize the value (or convert the object to a serialized string) before it's saved to the database.\nSee update_metadata() which is used by the REST API when updating a meta.\n\n\n*So if you set the type to object, then you should send the meta value as an object (or that will evaluate as an object in WordPress/PHP), but as for how, it depends on how you're making the REST API request, but basically, make sure the request body uses the proper format and the request also needs to set the proper Content-Type header.\nE.g. Using the native fetch() function in JS:\nfetch( 'https://example.com/wp-json/wp/v2/posts', {\n    method: 'POST',\n    headers: {\n        // be sure to send/use the correct Content-Type\n        'Content-Type': 'application/json',\n\n        // and (cookie) nonce\n        'X-WP-Nonce': 'YOUR_NONCE_HERE'\n    },\n    body: JSON.stringify( { // send a JSON-encoded request body\n        title: '\\'video\\' meta test',\n        content: 'test via JS fetch()',\n        meta: {\n            video: { // pass an object\n                foo: 'bla blah',\n                bar: 1234\n            }\n        } // end meta\n    } ) // end body\n} ) // wrapped\n    .then( res => res.json() )\n    .then( data => console.log( data.id, data.meta ) );\n\nOr using cURL command line and an application password:\ncurl -X POST https://example.com/wp-json/wp/v2/posts --user \"YOUR_USERNAME:YOUR_APPLICATION_PASSWORD\" -H \"Content-Type: application/json\" -d \"{\\\"title\\\":\\\"'video' meta test\\\",\\\"content\\\":\\\"test via curl\\\",\\\"meta\\\":{\\\"video\\\":{\\\"foo\\\":\\\"bla blah\\\",\\\"bar\\\":1234}}}\"\n\n\n*If you actually wanted the meta value be saved as a JSON-encoded string, i.e. in the database, the value would look like {\"foo\":\"bla blah\",\"bar\":1234} (instead of a serialized string), then you should set the type to string and send the meta value as a string, e.g. (note the single quotes, i.e. ') video: '{\"foo\":\"bla blah\",\"bar\":1234}' in JS.\nBut if you want the meta value be represented as an object in the REST API response (body), then you can use the prepare_callback argument (see WP_REST_Meta_Fields::prepare_value()) to convert the JSON string to an object, like so:\nregister_post_meta(\n    'post',  // post type\n    'video', // meta key\n    array(\n        'single'       => true,\n        'show_in_rest' => array(\n            'type'             => 'string',\n            'prepare_callback' => function ( $value ) {\n                return is_object( $value ) ? $value : json_decode( $value );\n            },\n        ),\n    )\n);\n\nJust remember that you would need to, e.g. from a PHP template, manually convert the value to an object after fetching the value using get_post_meta() (or get_metadata()). E.g.\n$post_id = 123;\n$value   = get_post_meta( $post_id, 'video', true ); // true = gets a single value\n$video   = is_object( $value ) ? $value : json_decode( $value );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404161", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to makes changes on the shop/category/tag pages but not on the product pages in woocommerce? I've recently added a plugin to have product filters (BeRocket) on my wordpress/woocommerce website. To display those filters on the page I made a widget and added it in my woocommerce.php page.\nIt's pretty much working as intended so far but it also displays the filters on the product pages since they're also generated from woocommerce.php..\nIs there a way around that ? I just want those filters on the shop/category/tag pages, can I affect them directly without affecting the product pages ?\nAny help appreciated. Best regards.\n\nA: You need to use conditional tags of WooCommerce.\nPlease have a look.  In your case you can use this\nif(!is_product()){\n    //BeRocket Code\n}\n\n\nA: they have shortcodes that you place in the relevant archive templates that you want them to appear in.\nthis would need to be done in your child theme\nget_shortcode('[ berocket_shortcode ]');\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404162", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: My menu doesn't fit in the default screen in the mobile version I've build this website:\nhttps://study-help.lu/wp/fr/page-dacceuil/\nWhen I load it on my phone the menu just appears on the outside of the screen on the right.\nI know a bit of CSS but I don't know the difference where to modify CSS for desktop and mobile.\nI've used the Elementor builder.\nAny advice on how to fix this?\nThank you,\nPatrick\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404164", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add a message when post category is empty (the category have no published posts)? I'm using Wordpress 5.9.2 with Gutenberg and Twenty twenty two child theme.\nNow when there are no published posts in a category, no messages are displayed.\nBut i want to show messages for \"empty\" categories (without published posts), and if possible the different messages for different categories. For example, i have 3 categories, with term_id 2, 3, and 7.\nWhat can i do to see such messages?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404165", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: co-authors plugin - inline listing I'm trying to set up co-authors plugin in order to show articles authors\nfunction inl_users() {\nif ( function_exists( 'get_coauthors' ) ) {\n  $coauthors = get_coauthors();\n  //array_shift($coauthors);\n  foreach ( $coauthors as $coauthor ) {\n    $autArray[] = '<a href=' . get_author_posts_url( $coauthor->ID ) . '>' . $coauthor->display_name . '</a>';\n    echo implode(\", \", $autArray);\n  }\n}\n\nThe first author is shown twice in the first element, like this:\nfor $autArray = (John Smith, Joe Blogs); it returns John SmithJohn Smith, Joe Blogs\nfull rendered html is like this:\n<a href=\"https://example.com/author/john-smith/\">John Smith</a><a href=\"https://example.com/author/john-smith/\">John Smith</a>, <a href=\"https://example.com/author/joe-blogs/\">Joe Blogs</a>\n\nas you can see I've tried to use array_shift() because I thought they were two distinct elements, but they are not\nany suggestions?\nthanks in advance\n\nA: solved using for loop instead of foreach:\nfunction inl_users() {\nif ( function_exists( 'get_coauthors' ) ) {\n  $coauthors = get_coauthors();\n  for ($i = 0; $i < count($coauthors); $i++){\n      $autArray[] = '<a href=' . get_author_posts_url( $coauthors[$i]->ID ) . '>' . $coauthors[$i]->display_name . '</a>';\n  }\n  echo implode(\", \", $autArray);\n}\n\ndoes anoyone know why?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404167", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Contact Form 7 is not redirecting the \"Thank-You\" page with the removal of CSS and JS of plugins I was working on on-site speed optimization. I removed the css and js files of the Contact Form 7 plugin. Through the following code in function.php\nfunction rjs_lwp_contactform_css_js() {\n        global $post;\n        if( is_a( $post, 'WP_Post' ) && has_shortcode( $post->post_content, 'contact-form-7') ) {\n            wp_enqueue_script('contact-form-7');\n             wp_enqueue_style('contact-form-7');\n    \n        }else{\n            wp_dequeue_script( 'contact-form-7' );\n            wp_dequeue_style( 'contact-form-7' );\n        }\n    }\n    add_action( 'wp_enqueue_scripts', 'rjs_lwp_contactform_css_js');\n\nAs a result, I can't access the Thank you page. Mail goes correctly, but is not redirected to the \"thank you page\". Showing Error after root domain: abc.com/#wpcf7-f139-o1 etc. How it is possible if I removed both files and the page also redirect.\nI set Redirect Code in the Form\n<script>\ndocument.addEventListener( 'wpcf7mailsent', function( event ) {\n    location = '/thank-you/';\n}, false );\n</script>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404173", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to make ajax load posts from the current category? I have a function which loads in posts by click, however on category pages /category/**** when using that button it should only load posts for the same category.\nI can't seem to get it to work and not sure what im doing wrong.\ni've understood i need to pass the current category to load more buttons. Ive done that by adding:\ndata-category=\"<?php echo $category[0]->cat_ID; ?>\"\n\nto the button.\nMy Function is as follows:\nfunction more_posts()\n{\n\n    $offset = (int) $_POST['offset'];\n    $data = new WP_Query([\n        'post_status' => 'publish',\n        'post_type' => 'post',\n        'posts_per_page' => 6, // 10 by default\n        'offset' => $offset, // 10 by default\n        'cat' =>  array($_POST['cat_id']),\n    ]);\n    \n    $posts = $data->posts;\n\n    ob_start();\n    foreach ($posts as $entry) :\n        $image       = wp_get_attachment_image_src(get_post_thumbnail_id($entry->ID), 'medium');\n        $categories  = get_the_category($entry->ID);\n        $blurb_title = get_field('blog_title_blurb', $entry->ID);\n    \n\n?>\nand the ajax js is:\nbindLoadMore() {\n    $(\".js-load-more-posts\").on(\"click\", function (e) {\n      let button = $(this);\n      let offset = button.attr(\"data-offset\");\n      button.addClass(\"hidden\");\n      $(\".loading\").removeClass(\"hidden\");\n      $.ajax({\n        method: \"POST\",\n        url: woocommerce_params.ajax_url,\n        data: { action: \"more_posts\", offset: offset },\n        success: function (response) {\n          $(\".loading\").addClass(\"hidden\");\n          button.removeClass(\"hidden\");\n          $(\".blog-entries\").append(response.data.html);\n          button.attr(\"data-offset\", parseInt(offset) + response.data.posts);\n          if (response.data.posts === 0) {\n            $(\".load-more-posts-container .button\").attr(\"disabled\", 'disabled');\n          }\n        }\n      });\n    }\n\ncant make it work, any push in the right direction?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404175", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WooCommerce - new order email hook I'd like to sent new order email to another email address. But that email address isn't constant. It is depends of product - I am keeping it in post meta (customers can buy only one item per order).\nIs there a hook where would I can programmatically send this e-mail to another e-mail address than only this addresses in WooCommerce configuration?\n\nA: A list of all the WooCommerce hooks can be found here.  The way I understand it, e-mail sending is handled by way of the WC_Email class by way of the ->send() method.  According to the code, it looks like the woocommerce_mail_callback_params hook might be for what you are looking.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404180", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Use callback function in AJAX pure javascript I've been looking for a while, but nothing answers my question.\nHow can I turn this code in jQuery into pure javascript?\nI need it to work for the load more that loads other posts on my WordPress site.\njQuery.noConflict($);\n/* Funzioni AJAX */\njQuery(document).ready(function($) {\n    //Esegue la funzione quando avviene il click\n    $(\"#loadMore\").on('click', function(e) {\n        e.preventDefault();\n        //Init\n        var that = $(this);\n        var page = $(this).data('page');\n        var newPage = page + 1;\n        var ajaxurl = that.data('url');\n        //Chiamata AJAX\n        $.ajax({\n            url: ajaxurl,\n            type: 'post',\n            data: {\n                page: page,\n                action: 'ajax_script_load_more'\n\n            },\n            error: function(response) {\n                console.log(response);\n            },\n            success: function(response) {\n                //Controllo\n                if (response == 0) {\n                    $('#ajax-content').append('<div class=\"text-center\"><h3>Non sono presenti altri articoli!</h3></div>');\n                    $('#loadMore').hide();\n                } else {\n                    that.data('page', newPage);\n                    $('#ajax-content').append(response);\n                }\n            }\n        });\n    });\n});\n\nUPDATE:\nI got as far as the following, but it still doesn't work. How do I pass the action that is a function into my functions.php file?\n   document.querySelector('#loadMore').addEventListener(\"click\",function(e){\n    e.preventDefault();\n    var btn_load_more = document.querySelector('#loadMore');\n    console.log('bene!');\n\n    var page = btn_load_more.getAttribute('data-page');\n    var ajaxurl = btn_load_more.getAttribute('data-url');\n    \n    var newPage = page + 1;\n    \n    console.log(page);\n    console.log(ajaxurl);\n    \n    var http = new XMLHttpRequest();\n    var params = 'page='+page+'&action=ajax_script_load_more';\n    http.open('POST', 'wp_ajax_ajax_script_load_more', true);\n    http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n    http.onreadystatechange = function(response) {\n        if(http.readyState == 4 && http.status == 200) {\n            that.data('page', newPage); \n            document.querySelector('#ajax-content').appendChild(response);\n        }\n    }\n    http.send(params);\n    \n});\n\nThank you.\n\nA: I solved it with fetch, pure javascript. I followed this article to do it, hope it will be useful for many:\nhttps://templateartist.com/2020/05/26/javascript-fetch-api-to-load-wordpress-posts/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404181", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to test custom links within a multisite while in development stage I'm working on a wordpress multisite, I am working off a development/testing server before launching the sites. Here is an example of how URLs are set up.\nMain site url: 'main'\nsibling site url: 'main/sibling-site'\nIf I have a custom link in a menu on the sibling site, like '/page/#section', when clicked it ports me back to the main sites /page/#section not the sibling sites /page/#section. Is there an alternative way I should be establishing these links so that I can test them properly while in this development stage?\nUltimately when these sites go live the '/sibling-site' part of the url won't be there, so I can't add that to the custom links because then they will break once the site does go live.\nThank you for the help!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404183", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Editor is shown at full width The title field and all editor is full width. I don't know where to start looking. Any clue is welcome.\nAll plugins deactivated.\n\n\nA: As theme handbook said, I have to define the containers in the theme.json\n{\n    \"version\": 2,\n    \"settings\": {\n        \"layout\": {\n            \"contentSize\": \"840px\",\n            \"wideSize\": \"1100px\"\n        }\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404187", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: custom taxonomy pagination 404 error I know this question has been asked a lot, and I have been searching for solutions and trying what I found but I am still having issues. When I click on page 2 I get the 404 error\nFor example, I have set Settings->Reading-> Blog pages show at most (set to 12)\nand on my taxonomy-mytax.php page\n$term = 'is_tax' ? get_queried_object() : null;\n$paged = $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n$args = array(\n    'post_type' => 'mycpt',\n    'posts_per_page' => 12,\n    'paged' => $paged,\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'mytax',\n            'field' => 'ID',\n            'terms' => $term->term_id\n        )\n    )\n);\n$query = new WP_Query($args);\n\n <?php while ( $query->have_posts() ): $query->the_post();\n         /////////\n ?>\n<?php endwhile; ?>\n<?php wp_reset_postdata(); ?>\n\n<?php\n     echo paginate_links(array(\n     'current' => $paged,\n     'total' => $query->max_num_pages\n)); ?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404190", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Give active class to current page on a while loop WP query for custom post types listing I have a single-programs.php page and at the top of this single page I need to list all the entries from the custom post type \"programs\". Is there a way to give \"active\" class to this list for the current page (current single post type\" ?\nHere is my code:\n<?php\n        $args = array(\n            'numberposts'   => -1,\n            'post_type'     => 'programs',\n            'order'         => 'ASC'\n        );\n\n        $the_query = new WP_Query( $args );\n\n        ?>\n        <?php if( $the_query->have_posts() ): ?>\n        <ul>\n            <?php while( $the_query->have_posts() ) : $the_query->the_post(); ?>\n                <li>\n                    <span class=\"background\"></span>\n                    <h3 class=\"title\"><?php the_title(); ?></h3>\n                    <a href=\"<?php the_permalink(); ?>\"></a>\n                </li>\n            <?php endwhile; ?>\n        </ul>\n        <?php endif; ?>\n\n        <?php wp_reset_query();  // Restore global post data stomped by the_post(). ?>\n\nThis code is generating a list with my 4 items related to \"programs\", however I need to include a class \"active\" to the current single page.\n\nA: Assuming you want to add the class to the li element.\n<li<?php echo get_queried_object_id() == get_the_ID() ? ' class=\"active\"' : '';?>>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404191", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Best action hook for placing ical requests I would like to offer an iCal or webCal request on one of my pages. Which hook would be best to intercept the request that comes via URL?\nAt the moment I use the following hook for this:\nadd_action ( 'init', 'webcal_events');\nfunction webcal_events ()\n{\n    \n    if ($_SERVER['SCRIPT_URL'] == '/events/webcal')\n    {\n    header('Content-type: text/calendar; charset=utf-8');\n    header('Content-Disposition: inline; filename=\"events.ics\"');\n      ... do ICS stuff\n    exit(); \n\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404192", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How and where are the provisioning script set up in Wordpress? How and where are the provisioning script set up in Wordpress? I need to dockerize an application, the issue is after putting the wp_content folder, I noticed the database wasn't provisioned yet (meaning the tables weren't created and the tables weren't populated), so I am thinking there might be some shell script, native scripts and provisioning scripts that didn't run and I am trying to find where they are. Is there a native provisioning system set up already? If so where is it located and how does it work?\n\nA: \nIs there a native provisioning system set up already?\n\nNo.\n\nI am thinking there might be some shell script, native scripts and provisioning scripts that didn't run\n\nThere are none, you have to create those yourself.\n\nI noticed the database wasn't provisioned yet (meaning the tables weren't created and the tables weren't populated)\n\nWordPress won't install itself, you have to configure and install it yourself, either manually or via a script/provisioner/tool.\n\nthe closest you'll find to what you're looking for is:\n\n*\n\n*opening the installer page in the browser by following the classic install instructions https://wordpress.org/support/article/how-to-install-wordpress/#basic-instructions\n\n*or performing those instructions in a script of your own creation via WP CLI commands ( your script will need to download and install WP CLI ) https://wp-cli.org/\nThere are no system packages or official scripts to do what you are trying to do.\nAlso note that the official WordPress docker containers are only official in the sense that Docker themselves created them, the WordPress project was not involved in their creation. The closest WordPress itself has ever gotten is NPM dev tools that use docker for quickly setting up Gutenberg dev environments. These were only intended for local use.\nHaving said that, lots of people use containerised WordPress hosts, sometimes at great scale, but the way they do this varies and there is no right or wrong answer, and certainly no officially sanctioned golden path. E.g do you have a database container and a monolithic WordPress container? Or separate PHP worker containers and an Nginx container etc? A dedicated gateway? Standardised PHP/Nginx/MariaDB containers and a bootup script to install WP in a mounted folder with database details? There are lots of options, many I haven't mentioned, with their own tradeoffs to make.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404195", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Multi-layered WP_Query I'm trying to avoid creating additional custom field for one of the posts, and was wondering if there is a way to query WP DB to retrieve the necessary data.\nI have 3 types of posts: Events, Programs and Locations. On the event post type, there is a custom field for program it is related to. On the program post type, there is a custom field for location.\nI'm looking for a query, that can add to the single-location.php document, which will retrieve all the events in that location, without the need to create an additional custom field.\nMy logic was: get me all the events and filter all the events, where the related program, has a related location, which is the title of this post.\nWould it be possible?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404197", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Calling add_action on a filter hook? I'm working with Ultimate Member plugin and while attempting to work through a modification I accidentally used add_action on a filter hook (not an action hook) and it still worked - as in the call back ran??\nIs this a feature of Wordpress I was not aware of?\nI don't see any documentation about this.\nbelow is the code I ran. N.B no return either.\nHere is a link to the UM docs about this filter hook um_set_user_role\nI did a global search on all files in the Ultimate Member plugin and it is definitely not called with do_action anywhere.. so how did this work?\n\nadd_action( 'um_set_user_role', 'add_user_specific_role', 99, 3 );\nfunction add_user_specific_role( $role, $user_id, $user ) {\n\n    error_log( '============= UM NEW ROLE =================' );\n    error_log($role);\n    error_log( '============= UM USER ALL ROLES =================' );\n    error_log(print_r($user->roles, true));\n\n}\n\n\nA: add_action() and add_filter() are essentially the same thing, hooks, and they both call the same functions under the hood. If you look you'll see WP_Hook::do_action() basically just calls WP_Hook::apply_filters().\nAn action is essentially just a filter that doesn't return a value. If your callback function was supposed to modify the value of $role then that part wouldn't work, because add_action() won't pass the value through, but the callback will still run, as you've seen.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404198", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woo-commerce Update price as a Bulk from My offline software export I have a WordPress + woo commerce online shop.\nIn addition I have a local offline desktop software for my inventory products and pricing.\nI define a common code between my shop and my local desktop software for each product to relate products in my offline desktop software and my online shop.\nMy requirement is that two times each day I export an Excel file including product, price, availability, and common code from my offline desktop software and import into my online shop to update the available number of each product and price.\nis there any easy method or way to doing this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404201", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: can't load .po file in functions.php I get this warning\n\nNotice: Undefined variable: pofiles in\n/var/www/html/wp-content/themes/themename/functions.php on line 237\nWarning: Invalid argument supplied for foreach() in\n/var/www/html/wp-content/themes/themename/functions.php on line 237\n\nwhen I am trying to load po file with function, like this\nforeach ($pofiles as $pofile) {\n    $domain = baseName($pofile, 'http://localhost:8100/var/www/html/wp-content/languages/ponamefile.po');\n    $lang = baseName(dirName(dirName($pofile)));\n    /*\n    # build .mo file for gettext\n    #\n    echo \"Building $lang $domain.mo ...\\n\";\n    $mofile = preg_replace('/\\.po$/', '.mo', $pofile);\n    passThru( 'msgfmt -o '. qsa($mofile) .' '. qsa($pofile), $err );\n    if ($err !== 0) {\n        echo \"  Failed.\";\n        if ($err === 127) echo \" (msgfmt not found. gettext not installed?)\";\n        echo \"\\n\";\n    }\n    */\n    # build .php file for php\n    #\n    echo \"Building {$lang} {$domain}.php ...\\n\";\n    $phpout = _po_to_php($pofile);\n    if (!is_array($phpout)) {\n        $phpout = array();\n    }\n    $phpout = '<' . \"?php\\n\" . \"// AUTO-GENERATED FILE. TO MAKE CHANGES EDIT\\n\" . \"// \" . $domain . \".po AND REBUILD\\n\\n\" . $copyright . \"\\n\\n\" . '$g_gs_LANG[\\'' . $lang . '\\'][\\'' . $domain . '\\'] = ' . var_export($phpout, true) . \";\\n\\n\" . '?' . '>';\n    $phpfile = preg_replace('/\\\\.po$/', '.php', $pofile);\n    $f = fOpen($phpfile, 'wb');\n    fWrite($f, $phpout, strLen($phpout));\n    fClose($f);\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404202", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: users post count I'm trying to set up users archive pages;\nI notice that, if a user exists and is the owner of a custom post, it doesn't have an archive page;\nso I looked inside user.php in order to include custom posts in the function count_user_posts,\nthe original function was\nfunction count_user_posts( $userid, $post_type = 'post', $public_only = false ) {}\n\nand I changed it to\nfunction count_user_posts( $userid, $post_type = array('post','blog','lettura','intervista'), $public_only = false )\n\nthis didn't work, so I'm wondering where is the function that assigns archive pages to users\nthanks in advance\n\nA: The count_user_posts accepts array as the $post_type arguments. You don't need to include the $post_type = part.\n$user_posts = count_user_posts( $userid, array('post','blog','lettura','intervista') );\n\nThe $user_posts variable will hold the number of posts for the $userid.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404207", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Updating failed. The response is not a valid JSON response. Gutenberg + Woocommerce Products my site uses Timber/Twig to render pages/blocks and I have a page with a custom Gutenberg block that just shows a list of WooCommerce Products.\nWhen I save the page in the backend, I get Updating failed. The response is not a valid JSON response. But the changes to the page a still saved. It's just the error that shows.\nLooking at the Ajax call when saving the page to /wp-json/wp/v2/pages/xxx I get a response.\nError thrown:Call to a member function get_cart() on null\nI've narrowed the issue down to a custom twig function I created.\n$twig->addFunction( new Timber\\Twig_Function( 'get_product', function($id){\n        $wc_product = wc_get_product($id);\n        $_product['product'] = $wc_product;\n        $_product['fields'] = get_fields($id);\n        $_product['price'] = wc_get_price_including_tax($wc_product);\n  \n        return $_product;\n      } ) );\n\nThis particular line is what is causing the error\n$_product['price'] = wc_get_price_including_tax($wc_product);\n\nWhen I comment out that line in the function, the page saves with no errors.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404208", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp-query and wp_get_post_terms on custom taxonomy archive page hi so I am just wondering how I can increment the pagination of a page based upon the terms found with wp_get_post_terms() rather than the post count for the page.\nthis is the process i have:\ncustom taxonomy archive page by default presents posts ( products ) associated with that taxonomy\ni alter the loop with wp query to find categories & subcategories for each post.\nI then present the categories instead of the posts. I also try to remove duplicate categories.\nthe problem i am encountering is the pagination of the page is treating each set of terms found as one post.\ni would prefer if i was somehow able to amend the pagination so that it treats the terms found as one 'post' rather than how it is behaving now.\ncan anyone help?\nis my query wrong to start with? I just cannot find a way to only find related product categories for a custom taxonomy.\n//$currentPage = get_query_var('paged');\n $params2 = array(\n    'posts_per_page' => 1,\n    'post_type' => 'product_cat',\n    'field'    => 'slug',\n    'order'             => 'DESC',\n    'terms'     =>'product_cat',\n  //  'paged'     => $currentPage,\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'workplaces',\n            'field'    => 'slug',\n            'terms'    => $term, \n        ),\n    ),\n);\n\n$query2 = new WP_Query($params2);\n\n\n    {\n\n        while ($query2->have_posts())\n        {\n\n            $query2->the_post();\n           \n            $product_cats =  wp_get_post_terms(get_the_ID() , 'product_cat');\n            global $post;\n            //Get the current workplace slug\n            foreach ($product_cats as $collection)            {\n                \n                $category_slugs[] = $collection->slug;           \n\n            }       \n        }\n        \n    }\n\n    \n    wp_reset_query() ; \n<?php $category_slugs = array_unique($category_slugs); ?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404211", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Reject all malicious URL requests functions.php this might not be the right place as it's a question about a function snippet that relates also to the server and log files.\nI have been trying to block access to my site from bad query attempts which show up on my server logs attempting to access pages that don't exist. I found a snippet online with claims that it may stop these kinds of requests, but with very little explanation as to what it exactly does.\nSo can anyone advise me as to what this snippet would do and if it should be placed (as is) into the function.php or if it should have a function before hand:\nglobal $user_ID;\n  if($user_ID) {\n      if(!current_user_can('administrator')) {\n          if (strlen($_SERVER['REQUEST_URI']) > 255 ||\n              stripos($_SERVER['REQUEST_URI'], \"eval(\") ||\n              stripos($_SERVER['REQUEST_URI'], \"CONCAT\") ||\n              stripos($_SERVER['REQUEST_URI'], \"UNION+SELECT\") ||\n              stripos($_SERVER['REQUEST_URI'], \"base64\")) {\n                  @header(\"HTTP/1.1 414 Request-URI Too Long\");\n                  @header(\"Status: 414 Request-URI Too Long\");\n                  @header(\"Connection: Close\");\n                  @exit;\n          }\n      }\n  }\n\n\nA: All publicly visible sites on the internet get hit with ridiculous URL requests fairly often. These come from script kiddies (low-rent cybercriminals, the kind of children who think they're l33t or something) trying to get your site to misbehave and give them access using (mostly) old tricks that exploit long-fixed bugs. Some of the tricks they try are decades old.\nTrying to stay ahead of these ridiculous URLs on your own site isn't worth your trouble: you'll just be playing whack-a-mole. There's already lots of stuff in WordPress, php, and web servers (like Apache and litespeed) to repel these attempted invasions. You're much better off doing these things:\n\n*\n\n*Regularly updating WordPress, your themes, and your plugins to the latest versions. These updates often fix security issues and plug new holes, and often (not always) before the kiddies figure out how to exploit them.\n\n\n*Making it really hard to guess your administrative username / password combinations.  Use a hard to guess username rather than admin. And use a hard to guess password.\n\n\n*Installing a security plugin to slow down the kiddies.\n\n\n*Not keeping data on about visitors to your site unless you have good reasons. Sites with less data are less interesting to kiddies.\nThat being said, pretty much all WordPress add-on code, like yours, must be registered as a Hook : an Action or a Filter so WordPress knows when to run it and what to do with the result. Often a big challenge when writing code to add in to WordPress is figuring out which hook to use.  Did the code snippet in your question mention which hook should invoke it?\nThe first hook on an ordinary WordPress page is do_parse_request. If you return false from this filter WordPress goes on to completely ignore the incoming web request.\nSo you might try\n\nadd_filter('do_parse_request', my_parse_request_filter, 10, 3 );\nfunction my_parse_request_filter ($continue, $wp, $extra_query_vars) {\n  if ( something is wrong with $_SERVER['REQUEST_URI'] ) {\n    $wp->query_vars['error'] = 414;\n    $return false;\n  }\n  return $continue;\n}\n\nbut any administrator or other logged-in user isn't yet known in that filter.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404212", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to alter taxes amounts when updating an order I'm developing a plugin based on WooCommerce to allow ordering gift boxes. Each box is a WooCommerce product composed by multiple \"alternative products\" (that are made from a custom post type).\nFor some reasons (a box can have multiple taxe rates, etc) I need to override taxes amounts when ordering. I succeeded this step by basicaly doing this following :\nadd_action( 'woocommerce_calculate_totals', 'custom_calc_total', 999, 1 );\nfunction custom_calc_total( $cart ) {\n    //here I calculate amounts of differents taxes depending of what my gift boxes contain)\n    \n    //and here I override tax amount of the cart with my values\n    $cart->set_cart_contents_taxes(\n        array(\n            1 => $total_tax20, //french tax 20%\n            5 => $total_tax5, //french tax 5.5%\n            //=> ids 1 and 5 depend of my website\n        )\n    );\n}\n\nThe customer can finalise its order and if the merchant goes backend to the order panel, we can see the right amounts for taxes (I mean the custom calculated ones).\n\n( A : my boxes and the custom taxes amounts stored in products metas in case of ; B : the right amounts when the order is not updates yet)\nBut if the merchant update the order, to change the status from \"pending\" to \"complete\" for example, I think WooCommerce recalculates and updates some of the values (totals, taxes, etc). So as my woocommerce product \"Gift box\" is a kind of \"fake product\" whose values \u200b\u200b(price, weight, taxes, etc) are overwritten during the buying process depending of what the box contains, when WooCommerce recalculates the results are wrong.\n\n(after the order update, the amount of tax is wrong. Here there is only shipping tax because the Box is a Woocoomerce product with a flate rate)\nSo, how (which hook and which function) to allow my plugin overriding taxes amounts when an order is updated as I do it during the buying process ?\nI have found the hook woocommerce_order_after_calculate_totals , and others like here https://stackoverflow.com/questions/56701407/woocommerce-add-order-admin-hook-for-recalculate-button\nand I have found some useful functions as $order->get_total_tax(), $order->get_cart_tax(), $order->get_tax_totals(), $order->get_taxes(), $order->set_cart_tax()\nso I tried something like this :\nadd_action( 'woocommerce_order_after_calculate_totals', 'woocommerce_order_after_calculate_totals_test', 999,2);\nfunction woocommerce_order_after_calculate_totals_test ($and_taxes, $order){\n    $order->set_cart_tax( 1000 );//change the total value of taxes and not \n    $order->save();\n}\n\nbut I miss something and I cannot manage doing what I want.\nI have also seen stuff like this if it can help, but I did not try yet. Maybe it's a track to explore ? :\napply_filters( 'woocommerce_order_get_tax_totals', $tax_totals, $this );\n\nand\n$order->update_meta_data( '_' . $key, $value ); ?\n\nSo if you have an idea it would be awesome.\nThank you\n\nA: Well, I succeeded in filtering the output of the totals :\nadd_filter( 'woocommerce_order_get_tax_totals', 'filter_function_name_1942', 10, 2 );\nfunction filter_function_name_1942( $tax_totals, $order ){\n    \n    foreach( $tax_totals as $single_tax_key => $single_tax_value ){\n        if( $single_tax_value->rate_id == 1){\n            $tax_totals[$single_tax_key]->amount = 1000;\n            $tax_totals[$single_tax_key]->formatted_amount = wc_price('1000');\n        }\n    }\n    \n    return $tax_totals;\n}\n\nIt's just an example with hardcoded values, but it works.\nThe problem I see now is that with this way the value displayed is right but the value recorded in the database is still wrong (I suppose).\nI'm right ?\nIs it necessary to save the good value in the database too ? if the value is used by an other plugin for example.\nIf yes, an idea about how to do it ? I can't find a method to save the custom value\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404214", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Guide to migrating a Wordpress development site to a running live site I have been looking for guidance on this for a while. This question is the nearest I have come to my case:\nHow can I make updates to a site, on a development copy, but then move updates back without overriding live site's evolving database?\nI don't have enough points to contribute to that, so I have started this question. I am not an expert, but I am quite experienced with WordPress.\nThe basic question is really simple. I have a live site and wanted to give it a complete overhaul. I migrated it to a development site with the same provider and started working on it. In the meantime, the other site is live, gets new posts, comments, etc. The new site is completely different to the old one, but I obviously want to keep blog posts. Finally, I forgot to change the database prefix on the development site to match the live site. Don't know if that is an issue or not.\nI suppose the only thing that needs to be kept is the blog history. It is a fairly simple site based mainly on static pages plus the blog with no e-commerce, no external contributors, etc. Is the best way to do this to import the blogs from the live site to the development site and then import the entire site back to the live site? If so, do I back up everything first, delete the existing site and then import the development site, or does the import end up with only the new tables etc?\nHope that makes sense and I am in the right place.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404215", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add wysiwyg editor in customize screen using customize_register Welcome\nI am developing a theme and I need to add wysiwyg editor to the customize screen using the \u201ccustomize_register()\u201d , I searched a lot here and on other sites about how to add it, and although there are many answers, it did not work for me\nSo please help me to find a solution to do this\nThank you in advance\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404216", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: custom filtering admin columns i'm trying to add custom filters to a CPT job-offer, for example, i'm starting by locations. the filters works fine except when i try to filter by all locations. \nthis is my code\nfunction add_custom_filter_tablenav($post_type){\n   \n   global $wpdb;\n   \n   /** Ensure this is the correct Post Type*/\n   if($post_type !== 'job-offer')\n       return;\n   \n   /** Grab the results from the DB */\n   $query = $wpdb->prepare('\n       SELECT DISTINCT pm.meta_value FROM %1$s pm\n       LEFT JOIN %2$s p ON p.ID = pm.post_id\n       WHERE pm.meta_key = \"%3$s\" \n       AND p.post_status = \"%4$s\" \n       AND p.post_type = \"%5$s\"\n       ORDER BY \"%6$s\"',\n       $wpdb->postmeta,\n       $wpdb->posts,\n       'location', // Your meta key - change as required\n       'publish',          // Post status - change as required\n       $post_type,\n       'location'\n   );\n   $results = $wpdb->get_col($query);\n   \n   /** Ensure there are options to show */\n   if(empty($results))\n       return;\n\n   // get selected option if there is one selected\n   if (isset( $_GET['location'] ) && $_GET['location'] != '') {\n       $selectedName = $_GET['location'];\n   } else {\n       $selectedName = -1;\n   }\n   \n   /** Grab all of the options that should be shown */\n   $options[] = sprintf('<option value=\"-1\">%1$s</option>', __('All Locations', 'textdomain'));\n   foreach($results as $result) :\n       if ($result == $selectedName) {\n           $options[] = sprintf('<option value=\"%1$s\" selected>%2$s</option>', esc_attr($result), $result);\n       } else {\n           $options[] = sprintf('<option value=\"%1$s\">%2$s</option>', esc_attr($result), $result);\n       }\n   endforeach;\n\n   /** Output the dropdown menu */\n   echo '<select class=\"\" id=\"location\" name=\"location\">';\n   echo join(\"\\n\", $options);\n   echo '</select>';\n\n}\nadd_filter( 'parse_query', 'prefix_parse_filter' );\nfunction  prefix_parse_filter($query) {\n  global $pagenow;\n  $current_page = isset( $_GET['post_type'] ) ? $_GET['post_type'] : '';\n  \n  if ( is_admin() && \n    'job-offer' == $current_page &&\n    'edit.php' == $pagenow && \n     isset( $_GET['location'] ) && \n     $_GET['location'] != '' ) {\n  \n   $location                  = $_GET['location'];\n   $query->query_vars['meta_key']     = 'location';\n   $query->query_vars['meta_value']   = $location;\n   $query->query_vars['meta_compare'] = '=';\n }\n}\n\n\nA: I ended up changing the value when all Locations is selected.Now it's working perfectly.\n$options[] = sprintf('<option value=\"\">%1$s</option>', __('All Locations', 'textdomain'));``` \n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404217", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Scrape key check failed. Please try again I am not able to save the function.php file. I am getting one error\n\nScrape key check failed. Please try again.\n\nI have disabled all the plugins even removed all the codes from the function.php file and tried to save but still got the same error.\nI am able to save the CSS and other files but not function.php\nI am using the latest WordPress. Any idea what is the issue?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404218", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Cannot add custom field to \"orderby\" parameter in Rest API My goal is to order a list of stars based on their distance from Earth, so I have created a \"distance\" field. The \u201cdistance\u201d field is a meta field I\u2019ve added. Looking at the WP API endpoints, I see that it isn\u2019t one of the args under my custom post type endpoint, so I\u2019ve been looking for examples of code that does exactly that. I\u2019ve examined this gist, this blog post by Tim Ross, this post from Shishir Raven, and this StackOverflow question. So far, none of these solutions have worked, and in some places even appear contradictory to me (for example, that gist puts down \u201cmeta_value_num\u201d into the $params['orderby']['enum'] value through the collection params filter hook, but Tim Ross and others put down the meta_key instead.) I really don\u2019t know what to think or do here.\nMy understanding is that the \"rest_api_init\" hook is the one I would use to add this parameter to the REST API, but none of the techniques I have used do so. You can see below that \"distance\" (nor \"meta_value\" or \"meta_value_num\") appear in the orderby enum array. My API readout looks like this:\n/wp/v2/stars:\n   namespace: \"wp/v2\"\n   endpoints:\n     0:\n       args:\n         orderby: \n           description: \"Sort collection by post attribute.\"\n           type: \"string\"\n           default: \"date\"\n           enum:\n             0: \"author\"\n             1: \"date\"\n             2: \"id\"\n             3: \"include\"\n             4: \"modified\"\n             5: \"parent\"\n             6: \"relevance\"\n             7: \"slug\"\n             8: \"include_slugs\"\n             9: \"title\"\n           required: false\n\nAdding screenshot just for clarity:\n\nI'm rather stumped at this point. This is the code I've been using inside my plugin file to add the data to REST. I'm probably doing more than necessary, as I've been trying to comment out one thing and then the other to see what works, but nothing does.\n// Adding custom fields to rest\n\nadd_action( 'rest_api_init', 'astrog_star_register_fields');\nfunction astrog_star_register_fields(){\n   foreach (['spect', 'distance', 'astrog_lumos', 'astrog_hue'] as $field) {\n       register_rest_field('astrog_star',\n       $field,\n       [\n           'get_callback' => 'astrog_star_get_field',\n           'update_callback' => null,\n           'schema' => null,\n       ]);\n   }\n}\n\nadd_action('rest_api_init', 'astrog_star_orderby');\nfunction astrog_star_orderby(){\n\n     add_filter(\"rest_endpoints\", function($routes){\n        $route = $routes['/wp/v2/stars'];\n        $route['endpoints'][0]['args']['orderby']['enum'][] = 'meta_value';\n        $route['endpoints'][0]['args']['meta_key'] = [\n            'description' => 'The meta key to query',\n            'type' => 'float',\n            'enum' => ['distance'],\n            'validate_callback' => 'rest_validate_request_arg',\n        ];\n        return $routes;\n    }, 10,1);\n\n    add_filter(\"rest_stars_collection_params\", function( $params ){\n        $params['orderby']['enum'][] = \"distance\";\n        return $params;\n    },10,1);\n\n    add_filter(\"rest_stars_query\", function($args, $request){\n        $orderkey = $request->get_param('orderby');\n        if( isset($orderkey) && 'distance' === $orderkey ) {\n            $args['meta_key'] = $orderkey;\n            $args['orderby']['enum'] = 'meta_value';\n        }\n        return $args;\n    },10,2);\n}\n\n/*\n * Get the value of the meta fields\n * @param array $object Details of current post.\n * @param string $field_name Name of field.\n * @param WP_REST_Request $request Current request\n *\n * @return mixed\n*/\n\nfunction astrog_star_get_field($object, $field_name, $request){\n    return get_post_meta($object['id'], $field_name, true);\n}\n\nfunction astrog_add_meta_vars ($current_vars) {\n    $current_vars = array_merge($current_vars, array('meta_key', 'meta_value', 'meta_value_num'));\n    return $current_vars;\n}\n\nadd_filter('query_vars', 'astrog_add_meta_vars');\n\nAt this point I'm utterly stumped. I'm obviously missing something but I'm not sure what it is. The only thing I can think of right now is that perhaps it's a misnamed field; I originally created the field as \"distance\" and intend on later prefixing it with \"astrog_\" (as my plugin and project is called \"Astrographer\") for best practices; perhaps somewhere in there I did change it to \"astrog_distance\", but as far as I can tell I have not. Have I missed a REST API update that changes how to do this?\nI am using Wordpress 5.9.2, and my repository can be found here. I'm grateful for any assistance I can get.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404221", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: get value from get_post_meta then reuse it in another get_post_meta I am writing the following code, which I have updated since the original question so as to give the entire picture. I am a newbie, and the reason why I am not using the get_posts() function in combination with an add_filter() is simply because I couldn't get it to work so I simply went back to my comfort zone and wrote a select statement. Hopefully my novice-ness doesn't get me any downvotes :-)\n    $search_term = $request->get('search');\n            \n    $terms = $wpdb->get_results(\n        $wpdb->prepare(\"\n            SELECT * \n            FROM {$wpdb->posts} \n            WHERE {$wpdb->posts}.post_type = 'rz_listing' \n            AND {$wpdb->posts}.post_status = 'publish' \n            AND {$wpdb->posts}.post_title LIKE '%%\" . stripslashes( $wpdb->esc_like($search_term) ) . \"%%'\n            LIMIT $limit\n        \") \n    );\n    \n    if( ! is_wp_error( $terms ) ) {\n\n        if( ! empty( $terms ) ) {\n\n            foreach( $terms as $term ) {\n                        \n                $rz_row = $term;\n                \n                // grab the icon Luke\n                $placeicon = get_post_meta( $term->ID, 'rz_listing_type', true );\n                $icon = get_post_meta( $placeicon, 'rz_icon', true );\n\n            }\n        }\n    }\n\n\nAs you can see, I run the first query to get the meta_value that is used as the post_id for the subsequent query. This appears to be a very inefficient way to make two database calls, is there another way of doing it?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404222", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to run wp_remote_get() inside of a loop for multiple page API response? I am using wp_remote_get() to grab some JSON from an API call. Everything is working great except that the API I am using has a limit of 100 results per response and there are just over 300 results that I need to loop over. You can get additional pages by adding &page=2, &page=3, etc. to the API URL. How would I go about refactoring this code in order to check each page of results and append the results of each page to an array?\n$page = '1';\n$url = 'https://example.com/products&page=' . $page;\n$results = array();\n$request = wp_remote_get($url, $args);\nif (!is_wp_error($request)) {\n    $data = wp_remote_retrieve_body($request);\n    $body = json_decode($data);\n\n    foreach ($data as $datapoint) {\n        array_push($results, $datapoint);\n    }\n\n    ++ $page;\n    // Run additional wp_remote_get on next page\n}\n\n\nA: If I'm reading the docs right, wp_remote_get() will return a WP_Error on failure, but not necessarily on a 404/400/403 (etc) status code from your remote server. (Though that will depend in part on what your remote server sends back if there's an invalid request.)\nYou can check the status code using wp_remote_retrieve_response_code().\nI'd use something like this:\n$page = 1;\n$results = array();\n$url = 'https://example.com/products&page=' . $page;\n$keep_going = true;\nwhile ( $keep_going ) {\n    $request = wp_remote_get( $url, $args ); // This assumes you've set $args previously\n    if ( is_wp_error( $request ) ) {\n        // Error out.\n        $keep_going = false;\n    }\n    if ( $keep_going ) {\n        $status = wp_remote_retrieve_response_code();\n        if ( 200 != $status ) {\n            // Not a valid response.\n            $keep_going = false;\n        }\n    }\n    if ( $keep_going ) {\n        $data = wp_remote_retrieve_body($request);\n        $body = json_decode($data);\n\n        foreach ($data as $datapoint) {\n            array_push($results, $datapoint);\n        }\n\n        ++ $page;\n        // URL for the next pass through the while() loop\n        $url = 'https://example.com/products&page=' . $page;\n    }\n}\n\nThis code is untested and probably inelegant, but it should provide a decent starting point for you. If you're unclear on while() loops, check the PHP docs.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404224", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get related taxonomies based on a category with mysql query? I have a lot of custom taxonomies for my WordPress site. What I want to do is to Get Related Custom Taxonomies based on a Category.\nSample Structure: (Material, OS and Features are Custom Taxonomies.)\n\n\n\n\nPost\nCategory\n(CT)Material\n(CT)OS\n(CT)Features\n\n\n\n\nP1\nA\n\niOS\nOLED\n\n\nP2\nB\nMetal\n\nGPS\n\n\nP3\nC\nGlass\nAnroid\nGPS\n\n\n\n\nSo what I want:\n\n*\n\n*For Category A: its related taxonomies is OS and Features.\n\n*For Category B: its related taxonomies is Material and Features.\n\n*For Category C: its related taxonomies is OS, Material and Features.\n\nI'm not very familiar with complex mysql query, Any help is greatly appreciated, Thanks.\nUpdated: 2022-04-01\nI've been able to achieve it by modifying another SQL I got here earlier. My English is not very good, maybe these codes can help everyone to understand my needs. My concern at the moment is whether there is a more efficient and performant way to do this.\nfunction get_related_taxonomies($base_term_id, $base_taxonomy, $post_type = 'post') {\n    global $wpdb;\n\n    $key = $base_taxonomy . ':' . $base_term_id;\n\n    if ($taxonomies = wp_cache_get($key, 'related_taxonomies')) {\n        return $taxonomies;\n    }\n\n    $results = $wpdb->get_results($wpdb->prepare(\n        \"SELECT related_tax.taxonomy\n        FROM {$wpdb->prefix}terms related\n        INNER JOIN {$wpdb->prefix}term_taxonomy related_tax ON (related_tax.term_id = related.term_id)\n        INNER JOIN {$wpdb->prefix}term_relationships related_rel ON (related_tax.term_taxonomy_id = related_rel.term_taxonomy_id)\n        INNER JOIN {$wpdb->prefix}posts posts ON (related_rel.object_id = posts.ID)\n        INNER JOIN {$wpdb->prefix}term_relationships base_rel ON (posts.ID = base_rel.object_id)\n        INNER JOIN {$wpdb->prefix}term_taxonomy base_tax ON (base_rel.term_taxonomy_id = base_tax.term_taxonomy_id)\n        INNER JOIN {$wpdb->prefix}terms base ON (base.term_id = base_tax.term_id)\n    WHERE\n        base_tax.taxonomy = '%s'\n        AND posts.post_type = '%s'\n        AND posts.post_status = 'publish'\n        AND base.term_id = %d\n    GROUP BY related_tax.taxonomy\",\n        $base_taxonomy,\n        $post_type,\n        $base_term_id\n    ));\n\n    $taxonomies = array();\n    foreach ($results as $result) {\n        if ($result->taxonomy !== $base_taxonomy) {\n            $taxonomies[] = get_taxonomy($result->taxonomy);\n        }\n    }\n\n    wp_cache_set($key, $taxonomies, 'related_taxonomies');\n\n    return $taxonomies;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404227", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Are custom tables in the database overwritten when WordPress is updated to new versions? I'm relatively new to customising WordPress and I am unsure what happens to custom tables that are manually added to the database when WordPress is updated to a new version. Are custom tables deleted when updating WordPress? Is the data in custom tables overwritten? I have been asked to import data from a database external to WordPress and display that data on the front end. Many thanks in advance.\n\nA: During a WP 'core' update that happens to modify the database, I believe that there is no 'overwrite' of tables or removing tables in the database.\nIf you add a new table to the database, that table will 'survive' the next WP core upgrade.\nYou'll only lose data if you reinstall from scratch, and specify another WP table name. But there would be few reasons to do that.\nA plugin or theme will make some changes to the tables. A plugin might have options that are stored in a table. And their upgrade might add/modify one of their own tables, but not the WP-based ones.\nUpdates are good to do, IMHO. I check for core/themes/plugin updates daily, and install daily when needed.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404228", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Disable Remember Me in Login Form I need to disable the 'Remember Me' prompt in login screens.\nBased on answers here https://wordpress.stackexchange.com/a/306746/29416 (including my own answer from 2018 with code that I had working then) about disabling the \"Remember Me\" prompt on the WP login form (wp-login.php), I should be able to do this:\n    add_filter('login_form_defaults', 'my_disable_remember_me');\n    function my_disable_remember_me($args) {\n        $args['remember']       = \"\";\n        return $args;\n    }\n\nThis is based on looking at wp-login.php (around line 604) where the 'remember' arguments shows the 'Remember Me' prompt. If the value is empty, or false, the HTML starting in line 605 will not be displayed. This is the code in wp-login.php that outputs the \"Remember Me' text and checkbox (line 604).\n  ( $args['remember'] ?\n        sprintf(\n            '<p class=\"login-remember\"><label><input name=\"rememberme\" type=\"checkbox\" id=\"%1$s\" value=\"forever\"%2$s /> %3$s</label></p>',\n            esc_attr( $args['id_remember'] ),\n            ( $args['value_remember'] ? ' checked=\"checked\"' : '' ),\n            esc_html( $args['label_remember'] )\n        ) : ''\n    ) .\n\nSo using that filter 'login_form_defaults' should remove the prompt. But it doesn't. I have tried the other filters (login_form_top, login_form_middle, login_form_footer) to use the same my_disable_remember_me function, to no avail.\nSo I am confused as to why the login_form_defaults doesn't remove the \"Remember Me\" checkbox and text.\n\nA: The login_form_defaults hook does work, but wp-login.php does not use wp_login_form() which runs the login_form_defaults hook, and instead the \"Remember Me\" checkbox is echoed like this, hence it's basically unremovable via PHP or there's no filter to disable (or an argument to bypass) the echo, or empty/modify the markup.\nSo that means, if wp_login_form() was used, then your code would have worked.\nBut on the wp-login.php page, you can disable the \"Remember Me\" via either CSS or JS, or both:\n\n*\n\n*Use CSS to visually hide the checkbox, e.g. using the login_head hook:\nadd_action( 'login_head', function () {\n    echo '<style>.forgetmenot { display: none !important }</style>';\n} );\n\n\n\n*Use JS to completely remove the element, e.g. using the login_footer hook:\nadd_action( 'login_footer', function () {\n    ?>\n        <script>\n            try {\n                document.querySelector( '.forgetmenot' ).remove();\n            } catch ( err ) {}\n        </script>\n    <?php\n} );\n\nOr just create a custom login page and send users to that page instead when they attempt to login.\nThat way, you can manually call wp_login_form() and just disable the \"Remember Me\" as you wish.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404229", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Responsive Images from S3 has no srcset My Production server has blurry images. Turns out, the image rendered has missing srcset. Upon searching, I checked that the images uploaded was not on the server where I host my wordpress but was uploaded to S3. I think the reason why it was uploaded to S3 is because of the plugin Media Cloud where it will automatically upload the images to S3 instead. I would like to know how to tell wordpress that it needs to fetch srcset from S3 source rather than wordpress uploads folder.\n\n*\n\n*Also, this is only on my production server, not in my local and development.\n\n\n*Another thing is not all images are uploaded to S3. Old images are still available from the wordpress uploads folder.\nFor 1, I know I need to add the condition to check env but that's it.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404230", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Meta Box WP_Query array for showing items with a certain relationship in oxygen I am using a repeater to show posts that have a certain relationship. The advanced query in the relationship is post_type = \"custom post type1\" and then I add another parameter that is post_in = ... I then go into the meta box field and select my relationship \"custom post type1 to\"\nIt then displays all posts in the \"custom post type1\" that have a direct relationship with the current post (a post within \"custom post type2\"). Works great until I need to use a bunch of repeaters on a single post.\nI decided I would just go ahead and work on my own WP_Query to be able to set up pagination for each one instead of using a repeater. I also am looking at possible using piotnet grid for this as it has a custom query option that allows you to insert a wp_query array.\nMy problem is while I know how to do the array i don't know how to insert the relationship check.\narray(\"post_type\" => \"custom post type1\", \"post_in\" => \"???\");\n\nAny help would be grateful as I have tried googling but can't seem to find anything (it is late for me so might be why I haven't found anything sorry if its painfully obvious as to what to do).\n\nA: Alright so after waking up and actually thinking (lol) it was quite simple and I was way overthinking it.\nIn piotnet grid you can query a custom wp_query. I added this to the box\narray(relationship => [\n        //the meta box relationship id\n        'id' => 'relationship-between-cpt1&cpt2',\n        'from' => get_the_ID(),\n    ])\n\nin the preview window on piotnet grid it will look broke but once you put it into a post it works just fine.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404233", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What is @Action in Wordpress? I have found this code snippet on a plugin.\n/** * @Action(name=\"workforce_content_loop_before\", priority=10) */\n\npublic static function show_breadcrumb() {\n        echo do_shortcode( '[workforce_breadcrumb]' );\n    }\n\nThis comment code is use to add an action instead of add_action function (here show_beradcrumb action). But how this is working inside comment. I am asking here because I didn't find any documentation in wordpress.\n\n\nA: This is called php annotations. Many of them are built-in via a standard called phpdoc (like @var), and they are used by the interpreter or the static tools (also by humans for a more structured comment).\nThere is another usecase for these annotations, and it's to run some code - probably using reflections (which usually is last resort, since it's slower), here is an example from a different system which I'm using: https://www.doctrine-project.org/projects/doctrine-annotations/en/1.13/custom.html\nFor example in old versions of TYPO3 you could use @inject this way.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404234", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Drop Down options aren't saving in my wordpress plugin options page So, I'm developing a plugin. I have an options page with tabs, and so far so good. The text and text area settings are working OK, but the drop down options aren't saving. For reasons I don't know. Here's the code:\nhttps://codeshare.io/9OZMmB\nThe HTML renders as follows:\n<select name='dropdown_settings[select_field_0]'>\n    <option value='1' <?php selected( $options['select_field_0'], 1 ); ?>>INFO</option>\n    <option value='2' <?php selected( $options['select_field_0'], 2 ); ?>>SDAMZUMBE</option>\n    <option value='3' <?php selected( $options['select_field_0'], 3 ); ?>>CHANGARAWE</option>\n</select>\n\nWhat could I be doing wrong. (The options appear as desired, but when I click the \"Submit\" button it renders the first element by default).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404241", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do you get sticky posts to work with categories? How do you get sticky posts to work with categories?\nI have tried:\n$query->set( 'ignore_sticky_posts', 0 );\n\nbut this just results in an out of memory error.\nI have tried restricting posts on the blog page by category, but sticky posts are shown regardless of which category they are in.\nWhy is this basic functionality so hard to achieve?\nIs the only option to write two separate custom queries?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404243", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Replace the_content with ACF Flexible Content via function function replace_the_content($content) {\n    global $post;\n\n    // ACF post summary\n    if (get_field('post_summary')) :\n      $post_summary = '<h4> ' . get_field('post_summary') . '</h4>';\n    endif;    \n\n    // ACF \"More information\"\n    if( have_rows('more_information') ):\n      while( have_rows('more_information') ): the_row(); \n\n        $more_info = '\n            <div>\n              <div>'.get_sub_field('column_1') .'</div>\n              <div>'.get_sub_field('column_2') .'</div>\n            </div>\n        ';\n      endwhile;\n    endif;\n\n    // To replace the_content\n    $the_post = '\n\n        <div>\n          '.$post_summary.'\n        </div>\n        \n        <div>\n          '.$more_info.'\n        </div>\n    ';\n\n    return $the_post;\n\n    }\n    \n    return $content;\n}\n\nadd_filter('the_content', 'replace_the_content');\n\nThis works, but now I want to get an ACF Flexible Content field in there, like so:\n  if( have_rows('content_blocks') ):\n    while ( have_rows('content_blocks') ) : the_row();\n\n      if( get_row_layout() == 'text' ):\n          $text = get_sub_field('text');\n      elseif( get_row_layout() == 'image' ): \n          $file = get_sub_field('image');\n      endif;\n\n    endwhile;\n  endif;   \n\nI can't do this:\n$acf_flex = '\n  if( have_rows('content_blocks') ):\n    while ( have_rows('content_blocks') ) : the_row();\n\n      ...\n\n    endwhile;\n  endif;  \n'\n\n $the_post = '\n\n  <div>\n    '.$post_summary.'\n  </div>\n\n  <div>\n    '.$acf_flex.'\n  </div>\n\n';\n\nHow might I get those fields inside the $the_post variable?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404245", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom Wordpress Plugin will install new and not update I've just created my first custom Wordpress plugin. Now I want to push a new version:\nRecreation Steps:\n\n*\n\n*Install v1.1.0\n\n*Activate v1.1.0\n\n*See that is doing stuff -> YEAH\n\n*Create new Zip with v1.1.2 and inside set \"Version: 1.1.2\"\n\n*Go to Wordpress -> Add New and pick that zip\n\n*Wordpress will install new plugin and not ask to overwrite...\n\nCan someone explain to me what I'm doing wrong?\nKind Regards, Ben\n\nA: A plugin is treated as the same as another plugin if it has the same directory name. That's it. If your zip file contains the plugin files then the zip filename will be used as the directory name. If your zip has a directory in it, containing the plugin files, then that will be used as the plugin directory.\nSo the solution is to structure your zips like this:\nmy-plugin-1.0.0.zip\n    \u221f my-plugin/\n        \u221f my-plugin.php\n\nmy-plugin-1.1.0.zip\n    \u221f my-plugin/\n        \u221f my-plugin.php\n\nThis way the directory will always be my-plugin/ and those two zips will be treated as the same plugin.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404249", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sortable custom product taxonomy terms via drag and drop How to add the ability to drag and drop sort the terms of a custom product taxonomy as it does for WooCoommerce product categories?\nAttempted to use 'tax_position' => true, but no effect.\nfunction wscat_custom_taxonomy_Item()  {\n$labels = array(\n'name'                       => 'Wholesale Categories',\n'singular_name'              => 'Wholesale Category',\n'menu_name'                  => 'Wholesale Categories',\n'all_items'                  => 'All Wholesale Categories',\n'parent_item'                => 'Parent Wholesale Category',\n'parent_item_colon'          => 'Parent Wholesale Category:',\n'new_item_name'              => 'New Wholesale Category',\n'add_new_item'               => 'Add Wholesale Category',\n'edit_item'                  => 'Edit Wholesale Category',\n'update_item'                => 'Update Wholesale Category',\n'separate_items_with_commas' => 'Separate Wholesale Categories with commas',\n'search_items'               => 'Search Wholesale Categories',\n'add_or_remove_items'        => 'Add or remove Wholesale Categories',\n'choose_from_most_used'      => 'Choose from the most used Wholesale Categories',\n);\n$args = array(\n'labels'                     => $labels,\n'hierarchical'               => true,\n'public'                     => true,\n'show_ui'                    => true,\n'show_admin_column'          => true,\n'show_in_nav_menus'          => true,\n'show_tagcloud'              => true,\n'tax_position' => true, //No Effect\n\n);\nregister_taxonomy( 'product_ws_cat', 'product', $args );\n}\nadd_action( 'init', 'wscat_custom_taxonomy_item', 0 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404251", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ACF: Grid based on field value I have a \u201ccompany pages\u201d field group and a template that displays all of the companies in a grid. One of the fields in the \u201ccompany pages\u201d group is INDUSTRY.\nI now want to to be able to sort that \u201cALL COMPANIES\" page so it shows only the companies in a particular INDUSTRY.\nI\u2019d prefer using a dropdown on the \u201cALL COMPANIES\" page itself to select the industry. Changing the dropdown would reload the page based on the selected industry. But another possibility is an \"INDUSTRY\" dropdown in the header menu.\nI'm hoping that there is a way to do this by adding a parameter to the ALL COMPANIES url. As in \"mysite.com/allcompanies/?industry=auto.\" Possible?\nBTW, I posted to ACF's forum but p[osts are not being read there for some reason.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404252", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom editor color palette colors are not appearing in the editor Below is the function to add my custom colors, the 'disable-custom-colors' is working properly, but the custom colors that I'm trying to add are not appearing in the editor. I have also tried clearing my cache and the issue persists.\nfunction add_custom_gutenberg_color_palette() {\n    add_theme_support( 'disable-custom-colors' );\n\n    add_theme_support(\n        'editor-color-palette',\n        array(\n            array(\n                'name'  => esc_html__('Red', 'twentytwentyone-child'),\n                'slug'  => 'red',\n                'color' => '#E4D1D1',\n            ),\n            array(\n                'name'  => esc_html__('Orange', 'twentytwentyone-child'),\n                'slug'  => 'orange',\n                'color' => '#E4DAD1',\n            )\n        )\n    );\n}\nadd_action( 'after_setup_theme', 'add_custom_gutenberg_color_palette' );\n\nThank you for the help!\n\nA: I noticed that you're using a child theme of Twenty Twenty-One, which also registers custom editor color palette using the same hook and priority (i.e. 10), so try using 11 or greater as the action's priority:\nadd_action( 'after_setup_theme', 'add_custom_gutenberg_color_palette', 11 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404257", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Import images remotly run through timeout error Actually I delevop a plugin that uses several curl requests to get data from an external server. I've got the following code running and is working fine. The post and meta gets in But if I running the import_images() function for insert each post and multiple image I run into 504 Gateway Timeout and the images duplicates all images. My current PHP VERSION: 7.4, PHP Memory Limit: 512 MB\n/**\n * Get all vehicles.\n *\n * @return array\n */\npublic function request_get_vehicles() {\n    $data = http_build_query(\n        array(\n            'api_key'             => $this->api_key,\n            'get'                 => self::GET_LISTE,\n            'max_autos_pro_seite' => self::MAX_AUTOS_PRO_SEITE,\n        )\n    );\n\n    $curl = curl_init();\n\n    curl_setopt( $curl, CURLOPT_URL, $this->api_url() );\n    curl_setopt( $curl, CURLOPT_POST, true );\n    curl_setopt( $curl, CURLOPT_POSTFIELDS, $data );\n    curl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );\n\n    $buffer = curl_exec( $curl );\n    curl_close( $curl );\n\n    $data = json_decode( $buffer, true );\n\n    return $data;\n}\n\n/**\n * Undocumented function\n *\n * @param int $id Vehicle ID.\n * @return array Return image urls.\n */\npublic function request_get_details( $id ) {\n    $data = http_build_query(\n        array(\n            'api_key'             => $this->api_key,\n            'get'                 => self::GET_DETAIL,\n            'fahrzeug_id'         => $id,\n            'max_autos_pro_seite' => self::MAX_AUTOS_PRO_SEITE,\n        )\n    );\n\n    $curl = curl_init();\n\n    curl_setopt( $curl, CURLOPT_URL, $this->api_url() );\n    curl_setopt( $curl, CURLOPT_POST, true );\n    curl_setopt( $curl, CURLOPT_POSTFIELDS, $data );\n    curl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );\n\n    $buffer = curl_exec( $curl );\n    curl_close( $curl );\n\n    $data = json_decode( $buffer, true );\n\n    return $data;\n}\n\n/**\n * Save vehicles and images in database.\n *\n * @return int The post ID on success.\n */\npublic function wpmc_save() {\n    global $wpdb;\n\n    $vehicles = $this->request_get_vehicles();\n\n    if ( empty( $vehicles ) ) {\n        return false;\n    }\n\n    foreach ( $vehicles['autos_liste'] as $vehicle_id => $value ) {\n        $args = array(\n            'post_type'    => 'fahrzeuge',\n            'post_title'   => $value['marke'] . ' ' . $value['modell'] . ' ' . $value['kopfzeile'],\n            'post_status'  => 'publish',\n            'post_content' => ! empty( $value['bemerkung_b2b'] ) ? $value['bemerkung_b2b'] : $value['bemerkung_b2c'],\n        );\n\n        $meta_args = array(\n            'meta_key'   => 'fahrzeug_id',\n            'meta_value' => $value['fahrzeug_id'],\n        );\n\n        $posts = $wpdb->get_results(\n            $wpdb->prepare(\n                \"SELECT * FROM {$wpdb->postmeta}\n                WHERE meta_key = 'fahrzeug_id' AND  meta_value = %d\n                LIMIT 1\",\n                $value['fahrzeug_id']\n            )\n        );\n\n        if ( empty( $posts ) ) {\n            $post_id = wp_insert_post( $args );\n        }\n\n        // Set meta data.\n        $post_meta = $this->set_metadata( $value );\n\n        if ( ! empty( $post_id ) ) {\n            // Set meta data.\n            foreach ( $post_meta as $meta_key => $meta_value ) {\n                // Get the current meta value.\n                $current_value = get_post_meta( $post_id, $meta_key, true );\n\n                if ( $meta_value && '' === $current_value ) {\n                    add_post_meta( $post_id, $meta_key, $meta_value );\n                } elseif ( $meta_value && $meta_value !== $current_value ) {\n                    update_post_meta( $post_id, $meta_key, $meta_value );\n                } elseif ( '' === $meta_value && $current_value ) {\n                    delete_post_meta( $post_id, $meta_key, $current_value );\n                }\n            }\n        }\n\n        $images = $this->request_get_details( $value['fahrzeug_id'] );\n\n        foreach ( $images['bilder'] as $key => $value ) {\n            $this->import_images( $value['url'], $post_id );\n        }\n    }\n}\n\n/**\n * Load images to the post.\n *\n * @param  array $url  The URL of the image to download.\n * @param  int   $post_id The post ID the media is to be associated with.\n * @return int   Image ID on success.\n */\nprivate function import_images( $url, $post_id ) {\n    // Include required files.\n    require_once ABSPATH . '/wp-admin/includes/file.php';\n    require_once ABSPATH . '/wp-admin/includes/media.php';\n    require_once ABSPATH . '/wp-admin/includes/image.php';\n\n    $tmp = download_url( $url );\n\n    // Set variables for storage, fix file filename for query strings.\n    preg_match( '/[^\\\\?]+\\\\.(jpe?g|jpe|gif|png)\\\\b/i', $url, $matches );\n\n    $file_array['name']     = sanitize_file_name( basename( $matches[0] ) );\n    $file_array['tmp_name'] = $tmp;\n\n    if ( is_wp_error( $tmp ) ) {\n        @unlink( $file_array['tmp_name'] );\n        return false;\n    }\n\n    // Saves it as an attachment.\n    $attachment_id = media_handle_sideload( $file_array, $post_id, null );\n\n    if ( is_wp_error( $attachment_id ) ) {\n        @unlink( $file_array['tmp_name'] );\n        return false;\n    }\n\n    return $attachment_id;\n}\n\nWhen importing, a total of 8 different image sizes are created. Is it possible to prevent this?\n\nTo test my function I actually hook into 'wp' to call the function! I hope someone can help me to fix and speed up the import error.\nThanks in advance!\n\nA: Is there anybody can help Figuren me out to seperate the two task and get this running? The Problem is that I need each vehicle id to get the details and query the associated images URLS.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404258", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Filter Media by attached page or blog post in Library I am trying to create a filter using restrict_manage_posts that will filter all media according the page or post type that have been attached to. Actually i need to create a filter that refers to the Uploaded to column. I have been trying many variations with no luck.\nfunction media_add_uploaded_to_dropdown()\n{\n    $scr = get_current_screen();\n    if ( $scr->base !== 'upload' ) return;\n\n    $attached_page = filter_input(INPUT_GET, 'attached_page', FILTER_SANITIZE_STRING );\n    $selected = (int)$attached_page > 0 ? $attached_page : '-1';\n    $args = array(\n        'show_option_none'   => 'All Pages',\n        'name'               => 'attached_page',\n        'selected'           => $selected\n    );\n    wp_dropdown_users( $args );\n}\nadd_action('restrict_manage_posts', 'media_add_uploaded_to_dropdown');\n\nAny help would be appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404263", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add multiple checkboxes as single field to Custom Shipping Method Settings Page This is my first WP plugin. And I have been able to get it working perfectly with the settings page and also showing the shipping method on the checkout page. On a requested feature I need to have another field in my settings page that will have multiple checkboxes to allow users to service types they prefer on their site. This is an example of what I am trying to achieve:\n\nThe shot above was taken on from the Woocommerce product settings page. Hence I had to look at the code from WC's files. I found the snippet below but I can't get it to work on my settings page:\n                 array(\n                    'title'           => __( 'Enable reviews', 'woocommerce' ),\n                    'desc'            => __( 'Enable product reviews', 'woocommerce' ),\n                    'id'              => 'woocommerce_enable_reviews',\n                    'default'         => 'yes',\n                    'type'            => 'checkbox',\n                    'checkboxgroup'   => 'start',\n                    'show_if_checked' => 'option',\n                ),\n\n                array(\n                    'desc'            => __( 'Show \"verified owner\" label on customer reviews', 'woocommerce' ),\n                    'id'              => 'woocommerce_review_rating_verification_label',\n                    'default'         => 'yes',\n                    'type'            => 'checkbox',\n                    'checkboxgroup'   => '',\n                    'show_if_checked' => 'yes',\n                    'autoload'        => false,\n                ),\n\n                array(\n                    'desc'            => __( 'Reviews can only be left by \"verified owners\"', 'woocommerce' ),\n                    'id'              => 'woocommerce_review_rating_verification_required',\n                    'default'         => 'no',\n                    'type'            => 'checkbox',\n                    'checkboxgroup'   => 'end',\n                    'show_if_checked' => 'yes',\n                    'autoload'        => false,\n                ),\n\nAll the fields I have currently displayed on my settings page was done in this manner:\n$this->form_fields = array(\n  'is_enabled' => array(\n    'title' => __('Enable', 'plugin_id'),\n    'type' => 'checkbox',\n    'description' => __('Enable this shipping.','plugin_id'),\n    'default' => 'no'\n  ),\n  'api_key' => array(\n    'title' => __('API Key', 'plugin_id'),\n    'type' => 'text',\n    'description' => __('Obtain API key from Lastmal DIP','plugin_id'),\n    'default' => null\n  ),\n  ...\n)\n\nHow can I add the multiple checkboxes to my fields and save them along with the other settings I have?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404264", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Easiest way to create an user across several websites I need to create an user with Editor access on several websites and instead of using the admin panel, I was wondering if I could do it on the db side. If so, what queries do I need to use? I am thinking it would be much faster.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404265", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Allow html comments with kses How do I allow HTML comments (<!-- HTML Comment -->) when outptutting with wp_kses_post?\nMy current allow function is as follows:\nfunction custom_wpkses_post_tags( $tags, $context ) {\n\n    $allowed_atts = array(\n        'align'      => true,\n        'class'      => true,\n        'type'       => true,\n        'id'         => true,\n        'dir'        => true,\n        'lang'       => true,\n        'style'      => true,\n        'xml:lang'   => true,\n        'src'        => true,\n        'alt'        => true,\n        'href'       => true,\n        'rel'        => true,\n        'rev'        => true,\n        'target'     => true,\n        'novalidate' => true,\n        'type'       => true,\n        'value'      => true,\n        'name'       => true,\n        'tabindex'   => true,\n        'action'     => true,\n        'method'     => true,\n        'for'        => true,\n        'width'      => true,\n        'height'     => true,\n        'data'       => true,\n        'data-*'     => true,\n        'title'      => true,\n        'for'        => true\n    );\n\n    if ( 'post' === $context ) {\n        $tags['form']     = $allowed_atts;\n        $tags['label']    = $allowed_atts;\n        $tags['select']   = $allowed_atts;\n        $tags['option']   = $allowed_atts;\n        $tags['input']    = $allowed_atts;\n        $tags['textarea'] = $allowed_atts;\n        $tags['iframe']   = $allowed_atts;\n        $tags['script']   = $allowed_atts;\n        $tags['style']    = $allowed_atts;\n        $tags['strong']   = $allowed_atts;\n        $tags['small']    = $allowed_atts;\n        $tags['table']    = $allowed_atts;\n        $tags['span']     = $allowed_atts;\n        $tags['abbr']     = $allowed_atts;\n        $tags['code']     = $allowed_atts;\n        $tags['pre']      = $allowed_atts;\n        $tags['div']      = $allowed_atts;\n        $tags['img']      = $allowed_atts;\n        $tags['h1']       = $allowed_atts;\n        $tags['h2']       = $allowed_atts;\n        $tags['h3']       = $allowed_atts;\n        $tags['h4']       = $allowed_atts;\n        $tags['h5']       = $allowed_atts;\n        $tags['h6']       = $allowed_atts;\n        $tags['ol']       = $allowed_atts;\n        $tags['ul']       = $allowed_atts;\n        $tags['li']       = $allowed_atts;\n        $tags['em']       = $allowed_atts;\n        $tags['hr']       = $allowed_atts;\n        $tags['br']       = $allowed_atts;\n        $tags['tr']       = $allowed_atts;\n        $tags['td']       = $allowed_atts;\n        $tags['p']        = $allowed_atts;\n        $tags['a']        = $allowed_atts;\n        $tags['b']        = $allowed_atts;\n        $tags['i']        = $allowed_atts;\n    }\n\n    return $tags;\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404266", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How do you make homepage redirect to it's slashed version? I'm running a clean WordPress 5.9.2 local setup. My permalink structure is this:\n/%postname%/\nWhen I visit http://example.com/sample-page, I get redirected to http://example.com/sample-page/, just as I would expect. Yet, http://example.com does not redirect to http://example.com/, but the opposite happens.\nHow do I achive the redirect to the slashed home url?\n\nA: What you are asking for is impossible, and if SEO consultants are asking for this then they do not know what they're talking about. WordPress is not redirecting you to a non-slashed homepage, the change happens before your browser even starts the request.\nTo understand why, take a look at one of the most basic HTTP requests possible:, a GET request to retrieve the root of example.com:\nGET / HTTP/1.1\nHost: example.com\n\nThis requests the root of a domain, but there is no way to remove the / here. If I delete it then I will be sending an invalid request to HTTP/1.1 with no protocol version afterwards.\nLikewise, if you try to inspect the HTTP network traffic, you will see no redirects from example.com/ to example.com because they are the same address. I don't mean that they are equivalent, or that they lead to the same place, but that they are 100% identical. The display of the / is purely the browser being helpful, which is why visiting example.com/ in the browser will show example.com in the address bar. Being able to put a trailing slash on a root of a domain is a happy accident of how the URL spec works, and one that browsers remove to simplify the URL.\nWhat you are asking for is impossible, and is not how HTTP works.\nAs a further test, you can prove this yourself:\ncurl -s -L -D - https://example.com -o /dev/null -w '%{url_effective}'\n\nRun this, then run it again with a trailing /, and the output is identical. There is no redirect, and WordPress is not involved, this is much lower at the foundation of HTTP.\nIf you're still in doubt, try to find an example of a site that has a trailing slash in modern Chrome.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404267", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom validation on publish/ update in Block Editor I'm building a plugin for the block editor that sets up custom fields, some of which are required, and some have some more advanced validation requirements.\nI have been looking into the most appropriate place to action this.\nMy preferred UX would be to return a native WP validation message after attempted submit, such as \"Your Custom Field must be filled in.\"\nGutenberg uses this REST endpoint on attempted save:\n/wp-json/wp/v2/pages/{ID} (POST)\n\nAnd I know, when creating custom endpoints, we can use:\nvalidate_callback' => function($param, $request, $key) {\n      return is_numeric( $param );\n    }\n\nwhen registering a new endpoint.\nSource: https://developer.wordpress.org/rest-api/extending-the-rest-api/adding-custom-endpoints/\nI do not appear to be able to add custom validation rules to the core WP endpoints however. Is this possible? Or is there a preferred best practiced for validating the save of posts within the Block Editor?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404268", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get_query_var('paged') return 0 in custom category page I want to make a pagination for my category page (category is related to custom post type)\nBut I can't get current page because it returns 0.\n$term = get_queried_object();\n$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\necho get_query_var('paged'); // Output is 0 (Error Here)\n\n$args = array(\n    \"post_type\" => \"readings\",\n    \"posts_per_page\" => 2,\n    \"cat\" => $term->term_id,\n    \"paged\" => $paged\n);\n\n$posts = new WP_Query($args);\n\nand in functions.php\nfunction pagination(){\n    global $wp_query;\n    $all_pages = $wp_query->posts->max_num_pages;\n\n    $current_page = max(1, $wp_query->posts->query_vars[\"paged\"]);\n\n\n    if($all_pages > 1){\n        return paginate_links(array(\n            \"base\" => get_pagenum_link() . \"%_%\",\n            \"format\" => \"/page/%#%\",\n            \"current\" => $current_page,\n            \"total\" => $all_pages,\n            \"prev_text\" => '<i class=\"fa-solid fa-angle-left\"></i>',\n            \"next_text\" => '<i class=\"fa-solid fa-angle-right\"></i>',\n        ));\n    }\n\n}\n\n\nA: All of your code can be eliminated by using a pre_get_posts filter:\nfunction marco_custom_category_filter( $query ) {\n    // only run this on the main query on category archives\n    if ( is_admin() || ! $query->is_main_query() || ! $query->is_category() ) {\n        return;\n    }\n    $query->set( 'posts_per_page', 2 );\n    $query->set( 'posts_type', 'readings' );\n}\nadd_action( 'pre_get_posts', 'marco_custom_category_filter' );\n\nWith this the main query will be customized, and you will no longer need a second replacement custom query that slows down your page and breaks pagination. A standard normal post loop and normal pagination will now work, e.g.\n<?php\nget_header();\n\nif ( have_posts()\n    while ( have_posts() ) {\n        the_post();\n        the_title();\n    }\n    the_posts_pagination();\n}\nget_footer();\n\nTo customize a category archive, customize the query, do not create a new second query with WP_Query\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404270", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: is there's a way to get the next page content generated by page break block with ajax call? I'm using wordpress page break block to devide the post content, and i want to add a feature to lead the content in next separated page via ajax\n\nI already tried this code\nglobal $post, $page, $paged;\n\n// Display the post\n$ppp_pagination = new WP_Query([\n    'p' => 277,\n    'paged' => 2\n]);\n\n// Query post\nif ($ppp_pagination->have_posts()) {\n    while ($ppp_pagination->have_posts()) {\n        $ppp_pagination->the_post();\n        the_content();\n        \n    }\n    wp_reset_postdata();\n}\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404275", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Fatal error: Uncaught Error: Call to undefined function wp() in /home/nr4dxonhypyy/public_html/wp-blog-header.php:16 \nFatal error: Uncaught Error: Call to undefined function wp() in /home/nr4dxonhypyy/public_html/wp-blog-header.php:16 Stack trace: #0 /home/nr4dxonhypyy/public_html/index.php(17): require() #1 {main} thrown in /home/nr4dxonhypyy/public_html/wp-blog-header.php on line 16\n\nI reinstalled WordPress, (upload the new copy on the site, and I made sure it's up to date) - equivalent to a manual update.\nAfter that website works well and I quickly make sure and update all the plugin and theme\nBut suddenly I see approx 30 minutes the website have same error again\nI try this process again and again but Got the same error\nCan anyone help me to figure it out\nAfter that its started to work fine, so this problem is now fixed.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404277", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Featured Image Cetegory Not Shown In WordPress I am trying to create a post for a new WordPress website, and want to show a thumbnail in my blog for the post. However, the \"Featured Image\" tab is not there. I have seen the solution to add this code: add_theme_support( 'post-thumbnails' ); to my theme file, except it is already there, and there still is no featured image tab.\n\nA: It's possible you've turned off that panel. You can check by clicking on the \"three dots\" menu (top right of the post editing screen) and selecting Preferences at the end of the menu. On the pop-up that appears, select Panels and ensure that the Feature Images slider is active.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404278", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Learndash change user role after completing the course I am moving a site from a LearnPress LMS to the LearnDash LMS, and I need to move over a custom function that changes the user role when the user completes the course (there is only one course right now).  The user flow is the following:  New user registers -> they are assigned a pre-subscriber role (this code is working, see below).  Once the user completes the course, their user role changes from pre-subscriber to subscriber.\nfunction cst_pre_creator_role() {\nif ( get_option( 'pre_creator_role_version' ) < 1 ) {\n    add_role( 'pre_subscriber', 'Pre Creator', array( 'read' => true, 'level_0' => true ) );\n    update_option( 'pre_creator_role_version', 1 );\n}}\n\nadd_action( 'user_register', 'cst_change_role', 10, 2 );\nfunction cst_change_role($user_id, $userdata){\n$user = new WP_User( $user_id );\n    $user->set_role( 'pre_subscriber' );\n}\n\nThe problem I am running into is how to link the Learndash function or functions to return the completion status as true or similar.  I am looking at learndash_course_completed / learndash_course_status.\nBelow is the code that was working with LearnPress.\nadd_action('wp_head', function(){\n\n    if(is_user_logged_in()){\n            $user = wp_get_current_user();\n            if ( in_array( 'pre_subscriber', (array) $user->roles ) ) {\n                    $profile = LP_Profile::instance( $user->ID );\n                    $Lpuser    = $profile->get_user();\n                    $course_id      = 8217;\n                    $course         = learn_press_get_course( $course_id );\n                    $course_data    = $Lpuser->get_course_data( $course_id );\n                    $course_results = $course_data->get_results( '' );\n                    $status         = $course_results['status'];\n                    $grade          = $course_data->get_graduation();\n                    if($grade == \"passed\"){\n                            // Remove role\n                            $user->remove_role( 'pre_subscriber' );\n                            // Add role\n                            $user->add_role( 'subscriber' );\n                    }\n            }\n    }\n});\n\nAny help with translating this LearnPress function into a LearnDash function would be greatly appreciated.\n\nA: Got it fixed.  Here is the code:\nadd_action('wp_head', function(){\n\nif(is_user_logged_in()){\n    $user = wp_get_current_user();\n    if ( in_array( 'pre_subscriber', (array) $user->roles ) ) {\n$passed = learndash_user_quiz_has_completed($user->ID, 8731, 8388);\n        if($passed){\n            // Remove role\n            $user->remove_role( 'pre_subscriber' );\n            // Add role\n            $user->add_role( 'subscriber' );\n        }\n    }\n}}\n      );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404282", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to use pre_get_posts on archive page custom post type I'm trying to use pre_get_posts to modify my post display request. The posts I want to display are custom post types. I am in a custom page template.\nI have this is my functions.php\nfunction tax_and_offset_homepage( $query ) {\n    if ( !is_admin() && $query->is_post_type_archive( array( 'project' ) )  ) {\n\n        $query->set( 'post_type', 'project' ) ;\n        if (null!==(get_option('sticky_posts'))){\n            $count_sticky = count(get_option('sticky_posts'));\n        }\n        $ppp = get_option( 'posts_per_page' );\n        $offset = $count_sticky;\n        if ( !$query->is_paged() ) {\n            $query->set( 'posts_per_page', $ppp - $offset );\n        } else {\n            $offset = ( ( $query->query_vars['paged']-1 ) * $ppp ) - $offset;\n            $query->set( 'posts_per_page', $ppp );\n            $query->set( 'offset', $offset );\n        }\n\n    }\n}\nadd_action('pre_get_posts','tax_and_offset_homepage');\n\nfunction homepage_offset_pagination( $found_posts, $query ) {\n\n    if (null!==(get_option('sticky_posts'))){\n        $count_sticky = count(get_option('sticky_posts'));\n    }\n    $offset = $count_sticky;\n\n    if( $query->is_post_type_archive( array( 'project' ) ) ) {\n            $found_posts = $found_posts + $offset;\n    }\n    return $found_posts;\n}\nadd_filter( 'found_posts', 'homepage_offset_pagination', 10, 2 );\n\nAnd in my custom template page :\n $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n$params = ['post_type' => 'project', 'order' => 'DESC', 'posts_per_page' => 9, 'paged' => $paged];\n$my_query = new WP_Query( $params );\nforeach ($children_array as $project) : ?>\n<div>\n  <?php echo get_the_title($project); ?>\n</div>\n<?php endforeach; ?>\n\nProblem : the code in functions.php has NO EFFECT. how can I act on my request with the pre_get_posts?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404286", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Create multiple pages with tables from json file I have this problem on Wordpress.\nI have a json file with a structure like this\n{ \n   \"obj\": [ \n      \"obj1\": {\n         \"field1\": \"..\",\n         \"field2\": [\n            {\n                \"field\": \"\"\n            }\n         ] \n      }, \n      \"obj2\": {\n       \"field1\": \"..\",\n         \"field2\": [\n            {\n                \"field\": \"\"\n            }\n         ] \n     }, \n      ... \n   ]\n} \n\nNow I need to create a page for each obj in the json by using Wordpress Rest API. I know I can do it, but the problem is that in each page I need to put a table populated with some field of each obj. I can create a page, but I don't know how to put table in that page.\nSomeone can help me?\nThanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404287", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show shipping class on product admin page I'm developing a site for a client, and they want to be able to see the shipping classes assigned to all products on the Product Index page within WP-Admin.\nIt would be idea to add it as a column so that they can see at-a-glance.\nCan anyone help please?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404290", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add more user roles to a PHP logout redirect function I have this function I found which redirects a user to an URL based on their user role. I have pretty much no knowledge of PHP so I need some help to add another user to it so I can see how it works for adding more later if I need to.\nIn the current function there's only one role; administrator which gets redirected to /login. I'd like to repeat that part, but for a different user to a different URL.\nfunction redirect_after_logout( $user_id ) {\n\n    $current_user   = get_user_by( 'id', $user_id );\n    $role_name      = $current_user->roles[0];\n\n    if($role_name == 'administrator'){\n        $redirect_url = site_url('/login/');\n        wp_safe_redirect( $redirect_url );\n        exit;\n    } \n\n}\nadd_action( 'wp_logout', 'redirect_after_logout'  );\n\nThank you in advance!\n\nA: All you have to do is copy the part in the code that checks which role the user has and redirect somewhere else, like this:\nfunction redirect_after_logout( $user_id ) {\n    $current_user = get_user_by( 'id', $user_id );\n    $role_name    = $current_user->roles[0];\n    \n    if( $role_name == 'administrator' ) {\n        wp_safe_redirect( site_url( '/login/' ) );\n        exit;\n    }\n    \n    if( $role_name == 'ANOTHER_ROLE' ) {\n        wp_safe_redirect( 'URL_WHERE_EVER_YOU_WANT_TO_REDIRECT' );\n        exit;\n    }\n}\nadd_action( 'wp_logout', 'redirect_after_logout' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404291", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Simulating timeout is not working I am trying to simulate a timeout response when using wp_remote_get() for better debugging. This is the code I'm using:\nset_time_limit( -0 );\nini_set('max_execution_time', 0);\n$args = array(\n    'headers' => array(\n        'Content-Type'    => 'application/json',\n        'timeout'         => 15,\n    ),\n);\n$request_response = wp_remote_get( $this->token_url . '&sleep=10', $args );\n\nThis is the response (WP_Error):\ncURL error 28: Operation timed out after 5000 milliseconds with 0 bytes received\n\n\n*\n\n*It doesn't matter if I change the value of set_time_limit\n\n*It doesn't matter if I change the value of max_execution_time\n\n*It doesn't matter if I change the value of timeout (to 50 for example)\n\nI still receive the cURL error after 5 seconds. Any idea why this is happening and how to solve it?\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404292", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: gravityforms chart Is there any easy way to implement some charts for the gravityforms submitted data (and being able to filter it) without having to spend 500$ on a premium plugin/addon?\nI would like to create a page showing the current logged user his submissions data displayed with charts.\nAny suggestion on how to achieve this?\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404295", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Filter custom posts based on the user role of author I am using CPT plugin to create new custom post type, and along with I am using elementor and jet smart filters to display list of posts in the frontend and filter them.\nI am trying to filter out custom posts in the frontend based on the user role of the author.\nBut haven't figured out a way to achieve this.\nThe Idea is, I have a subscription website, where users have to pay for a yearly subscription create and submit posts. once the subscription is over and the user does not renew it then user role must change and the post shall not be visible in the frontend. And once he renews the post should be visible.\nI have figured a way to change user role on subscription expiration (its with a plugin) but don't know how to query posts based on user role.\nKindly suggest a method.\nThere are similar questions but they are way too old to be referred to.\nThanks in advance for the support.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404298", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Using pre_get_posts, how to target the REST API, only? The title says it all: Is it possible to set a condition in pre_get_posts that only applies to queries that are targeted at the REST API?\nSo at https://example.com/wp-json/wp/v2/\n\nA: Yes.\nSo long as the code you're running happens after parse_request - which pre_get_posts does. (See https://codex.wordpress.org/Plugin_API/Action_Reference#Actions_Run_During_a_Typical_Request)\nThen you will have a nice constant to use: REST_REQUEST\nSomething like\nif( defined( 'REST_REQUEST' ) && REST_REQUEST ) {\n    // ...do RESTy things\n}\n\nwill do the trick.\nSee /wp-includes/rest-api.php\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404299", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: i moved wp-config.php outside of public html and this broke my website I moved it back and the website started working again.\nI tried moving wp-config to secure my wordpress site\nhere is what i did:\n\n*\n\n*created another file config.php\n\n*downloaded wp-config and copied all the code in it to config.php\n\n*cleaned all the code in wp-config.php and wrote this:\n\n<?php\ninclude('domains/mydomain.com/conf/config.php');\n\ni wrote my real domain name instead of mydomain.com\n\n\n*uploaded config.php to /domains/mydomain.com/conf\n\n\n*uploaded wp-config.php to /domains/mydomain.com/public_html\nbefore moving wp-config.php, i modified .htaccess to forbid public access to wp-config.php\nwhat did i do wrong while moving wp-config.php ? i also tried uploading config.php without conf folder, to /domains/mydomain.com/ but the result is the same.\nis .htaccess method enough or i still need to move wp-config.php outside of the public folder?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404304", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Exclude some categories from listing on the current post this should be simple, but it seems it is not. I simply want to not list some of the current post's categories, just exclude them from the list of categories the current post belongs to\nI use this for listing the current post's categories (but I am open to using whatever would work):\n<?php the_category( ', ' ); ?>\n\nand I tried this code on functions.php\n    function my_category_filter($cats){\n   //exclude these from displaying\n   $exclude = array(4,);\n   $Catds = array();\n   foreach ($cats as$cat){\n      if (!in_array($cat,$exclude)){$Catsa[] = $cat;}\n   }\n   return $Catsa;\n}\n\nadd_filter('the_category','my_category_filter');\n\nbut no category will show if I use it. Maybe you can guide me into solving this?\nthanks!\n\nA: The problem here is you're not using the proper hook because the_category is actually for modifying the HTML of the category list, and the 1st parameter for the hook is actually a string and not an array.\nSo the hook that you should have used is the_category_list where the 1st parameter is an array of terms/categories, but note that each item is an object (a WP_Term instance) and not a category ID.\nAnd with your current code, you just need to make 2 changes:\n\n*\n\n*Change the add_filter() to using the_category_list instead:\nadd_filter('the_category_list','my_category_filter');\n\n\n\n*In your foreach, change the if to using $cat->term_id instead:\nif (!in_array($cat->term_id,$exclude))\n\nSo now your code should work correctly, but it also would work on any \"current post\", e.g. the one in the current loop, so you might need to add a condition to your function so that it only applies to specific posts.\nOr you could actually manually generate the categories list/HTML, e.g. using get_the_category():\n// ID's of the categories you want to be excluded.\n$exclude = array( 4 );\n\n// The categories list.\n$cat_list = array();\n\nforeach ( get_the_category() as $cat ) {\n    if ( ! in_array( $cat->term_id, $exclude ) ) {\n        $cat_list[] = '<a href=\"' . esc_url( get_category_link( $cat->term_id ) ) .\n            '\">' . $cat->name . '</a>';\n    }\n}\n\n// Display a simple comma-separated list of links.\necho implode( ', ', $cat_list );\n\nThen in your template, use the above code instead of the the_category(). That way, you can avoid messing with the categories list for other \"current post\".\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404308", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can we create a WordPress read-only virtual field derived from three other fields? Our app has three different dates representing three key dates for a Project (one of our PODS CPTs). One of the common calculations we make is deriving an overall \"Status\" of the project from those three dates (based on the emptiness of one or two of those dates). We want to avoid the clunky solution of making a forth non-date field in which we repeat which status the project is right now, which would require extra work from content editors and have considerable risk of falling out of sync with the true dates. Is there any way we could crystalize this \"Status\" calculation into a read-only field that we could reference with code or with our FacetWP plugin?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404309", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Any way to change/add to the theme name dynamically? I'm currently working on a site with coworkers and our way, since we have only one staging, is to have 4 times the theme. The master branch in git, and we got each our version of the theme with the bit we are working on.\nThing is, in our theme switcher (we are using PWD Theme Switcher) we got 4 themes with exactly the same name. And changing the name in styles.css would screw up the git.\nSo is there a way to change or append something to the theme name in the functions.php? Something like adding the folder name to the theme name would be great, because even if its in git, it will change dynamically depending on which theme its referring to.\n\nA: If it's a matter of just needing to add an identifier to the theme you can add the folder name into the description of the style.css so you can see it when selecting themes from the wordpress dashboard. Either that or create different version numbers.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404312", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is it possible to add a preview to custom developed Widget? I've developed a couple custom Widgets using the Widget API, but have not been successful in figuring out how to give them a preview in Widget areas under Appearance->Widgets. When the widget isn't selected, there's just white space.\nIs it possible to give the Widget a preview?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404313", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Set document title through shortcode plugin I have a plugin a web hosting company made for us, and I need the \"current challenge\" page to show the challenges name as the document page title. Currently it just displays the page name \"Current Challenges\" that contains the shortcode to show the challenge.\nThe challenge system only had a show challenge list function, which I just limited to 1. But now that I am trying to add the title I made a new function to just show latest added challenge that is published. Why isn't this working though?\nfunction display_latest_challenge($args){\n    global $post;\n    $challenge_default_args = shortcode_atts(array(\n    ),$args);\n    $challenge_args = array(\n            'posts_per_page'   => 1,\n            'orderby'          => 'date',\n            'order'            => 'DESC',\n            'post_type'        => 'scwd_challenge',\n            'post_status'      => 'publish'\n        );\n    $challenge_string = \"\";\n    $challenges = get_posts( $challenge_args ); \n    \n    ob_start();\n    foreach ( $challenges as $post ) {\n        \n        add_filter('pre_get_document_title','challenge_page_title');\n    \n        ?>\n        <div class=\"chalList\">\n            <?php setup_postdata($post); $img = get_stylesheet_directory_uri().'/assets/images/placeholder.png';?>\n                <div class=\"chalSingle\">\n                    <?php include get_template_directory() .\"/template-parts/scwd-challenge/challenge-title.php\"; ?>\n                    <?php include get_template_directory() .\"/template-parts/scwd-challenge/challenge-info.php\"; ?>\n                    <?php include get_template_directory() .\"/template-parts/scwd-challenge/challenge-winner.php\"; ?>\n                    <?php include get_template_directory() .\"/template-parts/scwd-challenge/challenge-sponsor.php\"; ?>\n                    <?php include get_template_directory() .\"/template-parts/scwd-challenge/challenge-prize.php\"; ?>\n                    <?php include get_template_directory() .\"/template-parts/scwd-challenge/challenge-contestant.php\"; ?>\n                </div>\n        </div>\n        <?php \n        \n    }\n\n    $challenge_string = ob_get_clean();\n    wp_reset_postdata();\n\n    return $challenge_string;\n}\n\nadd_shortcode(\"show_latest_challenge\",'display_latest_challenge');\n\nfunction challenge_page_title($data){\n    global $post;\n    return $post->post_title;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404315", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Displaying a List of Changes / Updates on the Website Publicly I was wondering if there was some way to display / track down the recent changes for the pages (and possibly posts).\nI mean, showing \"admin updated \"x\" page Jan. 15, 2022 3pm\". Something like my old site. This is the current site.\nMaybe I'm asking too much but I also would like to reflect what was exactly updated as well.\nI must clarify that I don't want this to be only seen internally, I want it to be shown for the public.\nI asked somewhere else and a guy replied and he gave me this code:\nadd_filter('the_content', 'append_revision_info_to_the_content', -1);\nfunction append_revision_info_to_the_content( $content ) {\nif( ( is_single() || is_page() ) && is_main_query() && in_the_loop() ) {\n    $revisions = wp_get_post_revisions(get_the_ID());\n\n    $content .= wp_kses_post(\"<section class='revisions'>\");\n        // loop through all revisions for current post/page\n    foreach($revisions as $revision) {\n            // for each revision...\n        // ...let's store revision author\n        $revision_author = get_user_by('id', $revision->post_author);\n        // ...and add author and revision date/time with some html structure to the post/page content\n        $content .= wp_kses_post(\"<div class='revision'>Revision by <span>\" . $revision_author->user_login . \"</span> edited at <span>\" . $revision->post_modified . \"</span></div>\");\n    }\n\n    $content .= wp_kses_post(\"</section>\");\n\n    return $content;\n    }\n}\n\nUnfortunately, the code didn't work and add that the communication fell off when the guy stopped replying to my messages. I still have no idea why it's not working.\nBest regards.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404316", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to trigger a Gutenberg image gallery lightbox @ our Gutenberg-produced blog post, there is a Gutenberg gallery at the bottom of the post.\n<figure class=\"wp-block-gallery has-nested-images columns-default is-cropped\">\n  <figure class=\"wp-block-image size-large\"><a href=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-1.jpg\"><img loading=\"lazy\" width=\"1024\" height=\"683\" data-id=\"20575\" src=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-1-1024x683.jpg\" alt=\"\" class=\"wp-image-20575\"></a></figure>\n  <figure class=\"wp-block-image size-large\"><a href=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-6.jpg\"><img loading=\"lazy\" width=\"1024\" height=\"683\" data-id=\"20577\" src=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-6-1024x683.jpg\" alt=\"\" class=\"wp-image-20577\"></a></figure>\n  <figure class=\"wp-block-image size-large\"><a href=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-10.jpg\"><img loading=\"lazy\" width=\"1024\" height=\"683\" data-id=\"20579\" src=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-10-1024x683.jpg\" alt=\"\" class=\"wp-image-20579\"></a></figure>\n  <figure class=\"wp-block-image size-large\"><a href=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-11.jpg\"><img loading=\"lazy\" width=\"1024\" height=\"683\" data-id=\"20574\" src=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-11-1024x683.jpg\" alt=\"\" class=\"wp-image-20574\"></a></figure>\n  <figure class=\"wp-block-image size-large\"><a href=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-16.jpg\"><img loading=\"lazy\" width=\"1024\" height=\"683\" data-id=\"20578\" src=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-16-1024x683.jpg\" alt=\"\" class=\"wp-image-20578\"></a></figure>\n  <figure class=\"wp-block-image size-large\"><a href=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-17.jpg\"><img loading=\"lazy\" width=\"1024\" height=\"683\" data-id=\"20573\" src=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-17-1024x683.jpg\" alt=\"\" class=\"wp-image-20573\"></a></figure>\n  <figure class=\"wp-block-image size-large\"><a href=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-18.jpg\"><img loading=\"lazy\" width=\"1024\" height=\"683\" data-id=\"20576\" src=\"https://mandoemedia.com/wp-content/uploads/2022/04/Mandoe-Ribs-Burgers-18-1024x683.jpg\" alt=\"\" class=\"wp-image-20576\"></a></figure>\n</figure>\n\nIf I were to add a button to the top of the post, how would I make that button click to trigger the gallery lightbox to open, please?\nHelp appreciated.\n\nA: In this case I think it would be easiest to simply ignore any Gutenberg-specific implementation and set up the button's click event to click() the first linked image in the gallery listing.\nThe following searches the page for \"gallery buttons\" and the first linked image in a gallery block, then sets up the buttons to execute a click event on the first linked image when clicked.\nconst initPostGalleryButtons = () => {\n  const btns = document.querySelectorAll( '.fl-module-fl-post-content .gallery-btn' )\n  const first_gallery_link = document.querySelector( '.fl-module-fl-post-content .wp-block-gallery .wp-block-image>a' )\n\n  if( ! btns.length || ! first_gallery_link )\n    return\n\n  const openGallery = () => first_gallery_link.click()\n\n  for ( const btn of btns )\n    btn.addEventListener( 'click', openGallery )\n}\n\ndocument.addEventListener( 'DOMContentLoaded', initPostGalleryButtons )\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404319", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Does wordpress templates always in files or in database? I have theme and in header.php and I found this templates (see attached screenshot).\nBut there is no content directory in template directory. Even I searched for those files (header-private.php and header-public.php) but can't found. Then how those templates loading?\n\n\nA: \nBut there is no content directory in template directory.\n\nActually, with the following:\n\n*\n\n*get_template_part( 'templates/content', 'header-private' );\n\n*get_template_part( 'templates/content', 'header-public' );\nWordPress will search in the templates folder for content-header-private.php or content-header-public.php, and if found, it is loaded. Else, WordPress will attempt to load the content.php file instead.\nSo WordPress (or get_template_part()) will not search in a folder named content, and instead, the \"content\" part in templates/content means, \"search for PHP files where the name begins with content- in the templates folder, and if none found, please load content.php if it exists\".\nOther examples that might help:\n// loads content.php\nget_template_part( 'content' );\n\n// loads templates/content.php\nget_template_part( 'templates/content' );\n\n// loads templates/content-foo-bar.php OR templates/content.php\nget_template_part( 'templates/content', 'foo-bar' );\n\n// loads templates/content/foo-bar.php OR templates/content/foo.php\n// i.e. the function will now search in the \"content\" (sub-)folder\nget_template_part( 'templates/content/foo', 'bar' );\n\nCheck out the get_template_part() documentation for more details about (using) the function.\n\nEven I searched for those files (header-private.php and\nheader-public.php) but can't found.\n\nIf the templates folder does not have these files: content-header-private.php, content-header-public.php and content.php, then they might be in the parent theme if you are using a child theme, so try searching in the parent theme's templates folder.\nAnd it's because get_template_part() will first search in the child and then parent theme, so the template that's loaded could be the one in the parent theme.\nTechnically though, it's actually locate_template() which searches and loads the template, so you might also want to check the function's documentation.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404321", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce AJAX filters option loading spiner - problem on mobile device I've got quite weird problem. I built product filtering options, sometimes the server is slower so I wanted to add a loading spinner while you wait for the results. I only managed 50% because it works on desktop browsers and, unfortunately, nothing shows on mobile. Anyone have an idea why this can happen?\n    $('.auto_submit_item').change(function(){\n        var filter = $('#filter');\n        jQuery('#m-spinner').addClass('is-active');\n        $.ajax({\n            url:filter.attr('action'),\n            data:filter.serialize(), // form data\n            type:filter.attr('method'), // POST\n            beforeSend:function(xhr){\n                // jQuery('#m-spinner').addClass('is-active'); //option2\n            },\n            success:function(data){\n                // jQuery('#m-spinner').removeClass('is-active'); //option2\n                $('#response').html(data);\n            }\n        }, function( response ) {\n\n            jQuery('#m-spinner').removeClass(\"is-active\"); \n       });\n        return false;\n    });\n\nI tried both options, one which is visible right now, and second one which is in comments. Both options work on desktop but dont work on mobile android and/or iOS.\nAny idea how to fix it?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404330", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: JOIN filter doesn't work in WP_Query in wp-ajax calls In order to get list of objects I make new \\WP_Query request to the database using posts_join filter (JOIN with other custom table).\nIt works fine with direct loading of PHP page. But the same code doesn't work when I put it in wp-ajax call (in this case post_join is ignored and moreover $query_args are becoming ignored  as well. When I remove the code, at least $query_args applies).\nMy code:\nadd_filter( 'posts_join', 'add_other_table', 10, 2 );\nadd_filter('posts_where', 'my_where', 10, 2);\n$query = new \\WP_Query( $query_args );\nremove_filter('posts_join', 'add_other_table', 10, 2);\nremove_filter('posts_where', 'my_where', 10, 2);\nfunction add_other_table( $join, $query ) {\n    $join .= \" LEFT JOIN bookmarks as b on b.pid = wp_posts.id \";\n    return $join;\n}\nfunction my_where( $where, $query ) {\n    $where .= \" AND b.enabled=1\";\n    return $where;\n}\n\nWhat I miss? Is there some specific things because of ajax-calls?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404331", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: finding and using post type fields in Wordpress Sorry if this question is repeated, i asked on stackoverflow before but then i found out this place and got a message to wait before posting again, maybe it was just a bug. I am working on a premade child theme that has a premade custom post type. I want to display some values from a few instances of this post type, like title, image, etc, however, i dont know where to find these values in order to use them in my functions.php in the wordpress dashboard. I ve been searching for them in the file manager on cpanel but its chaotic there with so many files. The theme i m using should be following a standarized structure though, so do you have any ideas where such custom post type fields are stored? Otherwise, is there any other shortcut to finding these? Like with some plugin, like Advanced Custom Fields, and if yes, how?\nAlso, after i have pinpointed these fields, how can i use them in my functions.php in wordpress to, lets say, display them for example, for starters? Thanks in advance, i m also a newbie to all this so try to keep it simple.\n\nA: Hi If I understand correctly you are looking to get the data associated with a custom post type that was generated in your WordPress environment created by the theme.\nThis can be tricky to understand if you are not familiar with WordPress.\nTypically to get any kind of data with any type of post type you can use the get_posts() function (see Wordpress docs) provided by WordPress. This typically looks like this:\n$args =  array(\"post_type\" => 'custom-post-type-name', \"numberposts\"=> '-1');\n$post_query = get_posts($args);\n\nWhat this does is retrieve all the posts with that post type and returns them in an array of WP_Post objects. (See WP_POST Docs)\nWhat you can then do is iterate through that array and access the various items you may wish to use that are associated with that custom post type (assuming there are custom properties). Since custom post types are typically an extension of WP_POST you will have access to all the available properties of the WP_POST object.\nWhat that looks like in code:\nforeach($post_query as $post){\n  //The title of the post\n  echo $post->post_title;\n  // The content of the post\n  echo $post->post_content;\n\n  // If you custom post type has a custom property\n  echo $post->custom_property_name;\n  \n}\n\nThis is a very basic overview of custom post types and how to access them and I would recommend looking more into them by reading more material on them.\nAs for the code above you can simply put it into your functions.php and it should work. If you are in a development environment you could do the following to take a look at what your custom post type looks like in your functions.php file:\nadd_action('wp_body_open', function(){\n  $args =  array(\"post_type\" => 'custom-post-type-name', \"numberposts\"=> '-1');\n  $post_query = get_posts($args);\n  foreach($post_query as $post){\n    var_dump($post);\n    return;\n  }\n});\n\nAs far as managing custom post types goes here are some helpful articles from websites I use on the regular to get help with WordPress related projects:\nWP Beginner\nKinsta Resource\nSmashing Resource\nBest of luck!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404333", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Obfuscate links (for SEO purpose) Link obfuscation is a more and more common topic in order to improve SEO by masking the non-important links to provide more weight to others.\nI'm looking for an efficient way to obfuscate links in Wordpress, directly in the source code obviously, for example by adding a special class to my links.\nIt must turn the <a> element into something else like a <span>, with no more visible href attribute nor any actual URL, so that robots cannot see any link.\nIt must be done before rendering the source code, not overridden in JavaScript.\nExample :\n<a href=\"https://example.com\">Hello</a>\nturns into :\n<span data-o=\"CRYPTEDLINK\">Hello</span>\nthen some JS allows click on the element to redirect to the original link.\n\nA: I ended up making my own system that allows me to obfuscate any link easily.\nAdd the following code to your child theme's functions.php file, then just add the class \"obfuscate\" to any  element to obfuscate its link by replacing it with a  element with no readable link.\nAlso be sure to edit styles above, or delet them and style the \"akn-obf-link\" class in your own CSS file, so that it looks like a link to the visitor.\n/*************************************************************************************\\\n|* Links obuscation - add class \"obfuscate\" to any <a> element to obfuscate its link *|\n\\*************************************************************************************/\n\n// Add this code to your child theme's functions.php file, then just add the class \"obfuscate\" to any <a> element to obfuscate its link by replacing it with a <span> element with no readable link.\n// The obfuscated elements inherits the original <a> element's classes, along with a \"akn-obf-link\" class, so you might need to add CSS to style the \"akn-obf-link\" class so that it looks like a link to the visitor, maybe at least to add a cursor:pointer.\n// On right click, the obfuscated link will be wrapped with a proper <a> element with the \"akn-deobf-link\" for a brief moment, so that a proper context menu appears, you can remove that behaviour by setting the \"deobfucate_on_right_click\" option to false in the code bellow.\n\n// Edit 2022-04-05 - modified regex to allow for html elements and new lines into the <a> element, modified callback so the obfuscated element inherits the original link's classes, modified JS to add mousewheel click and right click options.\n\nadd_action('wp_loaded', 'buffer_start');\nfunction buffer_start() {\n    ob_start('akn_ofbuscate_buffer');\n}\nadd_action('shutdown', 'buffer_end');\nfunction buffer_end() {\n    ob_end_flush();\n}\nfunction akn_ofbuscate_buffer($buffer) {\n    $result = preg_replace_callback('#<a[^>]+(href=(\\\"|\\')([^\\\"\\']*)(\\'|\\\")[^>]+class=(\\\"|\\')[^\\'\\\"]*obfuscate[^\\'\\\"]*(\\\"|\\')|class=(\\\"|\\')[^\\'\\\"]*obfuscate[^\\'\\\"]*(\\\"|\\')[^>]+href=(\\\"|\\')([^\\\"\\']*)(\\'|\\\"))[^>]*>(.+(?!<a))<\\/a>#imUs', function($matches) {\n        preg_match('#<a[^>]+class=[\\\"|\\\\\\']([^\\\\\\'\\\"]+)[\\\"|\\\\\\']#imUs',$matches[0],$matches_classes);\n        $classes = trim(preg_replace('/\\s+/',' ',str_replace('obfuscate','',$matches_classes[1])));\n        return '<span class=\"akn-obf-link'.($classes?' '.$classes:'').'\" data-o=\"'.base64_encode($matches[3]?:$matches[10]).'\" data-b=\"'.((strpos(strtolower($matches[0]),'_blank')!==false)?'1':'0').'\">'.$matches[12].'</span>';\n    }, $buffer);\n    return $result;\n}\nadd_action('wp_footer', 'akn_ofbuscate_footer_js');\nfunction akn_ofbuscate_footer_js() {\n    ?>\n        <script>\n            jQuery(document).ready(function($) {\n                // options you can change\n                var deobfuscate_on_right_click = true;\n                // function to open link on click\n                function akn_ofbuscate_clicked($el,force_blank) {\n                    if (typeof(force_blank)=='undefined')\n                        var force_blank = false;\n                    var link = atob($el.data('o'));\n                    var _blank = $el.data('b');\n                    if (_blank || force_blank)\n                        window.open(link);\n                    else\n                        location.href = link;\n                }\n                // trigger link opening on click\n                $(document).on('click','.akn-obf-link',function() {\n                    var $el = $(this);\n                    if (!$el.closest('.akn-deobf-link').length)\n                        akn_ofbuscate_clicked($el);\n                });\n                // trigger link openin in new tab on mousewheel click\n                $(document).on('mousedown','.akn-obf-link',function(e) {\n                    if (e.which==2) {\n                        var $el = $(this);\n                        if (!$el.closest('.akn-deobf-link').length) {\n                            akn_ofbuscate_clicked($el,true);\n                            return true;\n                        }\n                    }\n                });\n                // deobfuscate link on right click so the context menu is a legit menu with link options\n                $(document).on('contextmenu','.akn-obf-link',function(e) {\n                    if (deobfuscate_on_right_click) {\n                        var $el = $(this);\n                        if (!$el.closest('.akn-deobf-link').length) {\n                            e.stopPropagation();\n                            var link = atob($el.data('o'));\n                            var _blank = $el.data('b');\n                            $el.wrap('<a class=\"akn-deobf-link\" href=\"'+link+'\"'+(_blank?' target=\"_BLANK\"':'')+'></a>').parent().trigger('contextmenu');\n                            setTimeout(function() {\n                                $el.unwrap();\n                            },10);\n                        }\n                    }\n                });\n            });\n        </script>\n    <?php\n}\n\nI'm also sharing the code on this Pastebin: https://pastebin.com/cXEBSVFn\nConsider checking the link just in case I updated the code on it and forgot to update it here\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404336", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Page with custom template make get request to a custom route - Pseudo code I created a page with a specific template and when the page load I would like it to make a get request to a custom route.\nSo far I am using JS and axios to make the request onload but I was wondering if there is an only PHP solution, kind of a new WP_QUERY but instead of args I just pass it the URL of my route ('/wp-json/custom/v1/custom/?term=myterm'.\nThank you for your help\n\nA: I am assuming you are trying to retrieve data from that route and display that to the end user?\nInstead of using the rest API to retrieve that information, you could put the callback function directly into your template file and then use the php $_GET variable (php docs) to pass the search term into your function.\nI think it would look like something like this:\n function output_data_from_search_term(){\n  $url_param = $_GET['myterm'];\n  if(empty($url_param)){\n    echo \"Search term missing, please try again.\";\n  }\n  //Do whatever query you are doing in your custom rest api endpoint callback. \n  //Here is an example of getting the custom post types with that term and displaying the titles.\n  $search_query = urldecode($url_param);\n  $query_results = get_posts( array(\"post_type\" => \"custom-post-type\", \"s\" => $search_query));\n  foreach($query_results as $result){\n    echo $result->post_title;\n  }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404340", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display WooCommerce product category on shop page (on every product) I want to display the category of every product on the shop page. Ideally under the image.\nCan anyone help, please?\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404343", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: update post meta value with other post meta value I'm a beginner in wordpress / php trying to learn. I want to use the update_post_meta function to populate one meta value (X) with another meta value (Y) everytime Y is changed. I did research and found a code that does this but it only updates the last published post. Can you help me how to modify the code so it works on every post?\n    $args = array(\n    'post_type' => 'listing',\n    'post_status' => 'publish',\n    'posts_per_page' => 1,\n    'meta_key' => 'y'\n);\n$dbResult = new WP_Query($args);\nglobal $post;\nif ($dbResult->have_posts()) {\n   $dbResult->the_post();\n\n   $value = get_post_meta($post->ID,'y',true);\n}\n\nupdate_post_meta( $post->ID, 'x', $value) ; ?>\n\n\nA: @Jawequo-\nYou need to know how WordPress works in order to understand the answer to your question.  There are a ton of functions, and they all call each other to do their job.  As the best way to learn about coding is to read code, I'll provide links in walking you thru how post meta is made, updated, and deleted.  In my doing this, you'll be able to better find answers to your questions in the future.\nLet's say you create a post using wp_insert_post().  If you trace this function, you'll see the meta data for the post is inserted on line 4511 of the code by way of the update_post_meta() function, which, in turn, calls update_metadata() to do all the heavy lifting.  If the metadata does not exist (which it doesn't at this point as we're creating a brand new post), add_metadata() will be called on line 250 of the code to insert it into the database.  Ok, cool, now we know how a post and its metadata is created.\nLater on, let's say you update that same post using wp_update_post().  If you trace this function, you'll see that wp_insert_post() is called on line 4788 of the code.  As we've already traced this function, we know how a post and its metadata is updated (and inserted if it doesn't exist).  Ok, cool, now we know how a post and its metadata are updated.\nAt some point in time, you get tired of the post, so you delete it using wp_delete_post().  If you trace this function, you'll see that the metadata gets deleted by way of delete_metadata_by_mid() on line 3446 of the code.  Ok, cool, now we know how a post and its metadata are deleted.\nLet's now say that you want to just screw around with the metadata of an existing post.  You can add meta data by way of add_post_meta().  If you trace this function, you'll see that add_metadata() is called to do all the heavy lifting.  To update existing metadata, you call update_post_meta(), which we already traced above.  To delete metadata from a post, we call delete_post_meta(), which invokes delete_metadata() to do its heavy lifting.  If you take a good look at delete_post_meta(), you'll see that it is just about identical to delete_metadata_by_id() in terms of the order of the hooks and method by which the metadata is deleted.  Ok, cool, now we know how to manipulate individual meta of a post without having to update the entire post itself.\nIt was important to explain all of this because you must have a working understanding of how post meta is updated.  And, if you traced the code along with me, you'll have seen those huge blocks of comments above the apply_filters() and do_action() functions.  Those are called hooks, and the way WordPress notifies us that if we want to do something, that notification is our chance.\nSo, if you want to updates a piece of metadata when WordPress manipulates metadata, we can use one of the hooks described in add_metadata(), update_metadata(), or delete_metadata() (which are identical to those in delete_metadata_by_id()).  So, let's start with adding metadata after metadata is added using the added_{$meta_type}_meta hook hook.  If you trace down from wp_update_post() (or one of the other related functions above) you'll see that $meta_type = \"post\", so the hook we'll use is add_post_meta:\nadd_action('added_post_meta', 'mort_metadata_changed', 10, 4);\n\nAs you are writing code for WordPress, I must assume that you already know about hooks.  In case you don't here's a nice little tutorial about them.  The hooks for after metadata is updated or deleted from a post are nearly identical to the added hook:  updated_{$meta_type}_meta (update_post_meta) and deleted_{$meta_type}_meta (delete_post_meta).  So, the hooks we want to use are nearly identical as well.\nadd_action('updated_post_meta', 'mort_metadata_changed', 10, 4);\nadd_action('deleted_post_meta', 'mort_metadata_changed', 10, 3);\n\nNotice that deleting only needs the first three parameters to be sent to the mort_metadata_changed function.  This is because the fourth parameter (the new meta value) is empty as the metadata would have been deleted.  Let's now create a function for these hooks to call.\nfunction mort_metadata_changed($meta_id, $object_id, $meta_key, $meta_value=NULL) {\n    // WordPress just did something with metadata.  Now, its our turn to do\n    // something before WordPress continues on its merry way!\n}\n\nNotice the final parameter, $meta_value, has a default of NULL.   By checking this, we will be able to tell if the function was called via the delete_post_meta hook or not.  Importantly, however, take notice that we have interjected ourselves into the inner-workings of WordPress:  every time a post's metadata is updated, the mort_metadata_changed() function will execute.\nWith the information you have obtained by reading the notes above each hook in the code, you now know what each variable contains at the time it is passed to mort_metadata_changed().  Just in case you're lost, try this on for size:\n/**\n *  This will be called every time post metadata changes.\n *\n *  @param  int[]   $tmp         The meta IDs, which we won't use.\n *  @param  int     $post_id     The ID of the post whose metadata was changed.\n *  @param  string  $meta_key    The name of the meta data changed.\n *  @param  string  $meta_value  New value of the metadata.  `delete_post_meta`\n *                                only passes the first three parameters, so\n *                                the `NULL` default value can be checked to\n *                                determine if the change is a deletion of the\n *                                post's metadata.\n */\nfunction mort_metadata_changed($tmp, $post_id, $meta_key, $meta_value=NULL) {\n    // Did the post meta we're looking for change?\n    if(get_post_type($post_id) !== 'listing'\n    || get_post_status($post_id) !== 'publish'\n    || $meta_key !== 'y'\n    ) {\n        // Nope. Something other than `y` of a published listing changed.\n        return;\n    }\n    // Validation was passed.  Time to do the mimic.\n    if(is_null($meta_value)) {\n        // Metadata deleted.\n        delete_post_meta($post_id, 'x');\n    } else {\n        // Metadata added/updated.\n        update_post_meta($post_id, 'x', $meta_value);\n    }\n}\n\nAs for where to put this code, I again assume you know how to get your code to run.\nBut if you don't, here's a nice tutorial on the subject.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404344", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Function to Load Admin CSS for Super Admin on Multisite I Run a multisite and have a function for normal admins working fine, however when adapting the code below for super admins it just does not work, the echo CSS style works perfectly, but register and enqueue scripts just dont work. I have the plugin file and css file in the root plugin file folder that includes CSS. But for some reason its not working. Any help is greatly appreciated.\nfunction load_custom_wp_superadmin_style_author() {\n    \n    if ( is_super_admin($user_id) ) {\n\n    echo '<style>#wpadminbar{background:#fff!important;}</style>';\n    wp_register_style( 'custom_wp_superadmin_css', plugins_url('superadminstyle.css', __FILE__) );\n    wp_enqueue_style( 'custom_wp_superadmin_css' );\n\n        }else{\n\n  echo '';\n             }\n}\n\nadd_action( 'admin_enqueue_scripts', 'load_custom_wp_superadmin_style_author' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404348", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: When running WordPress Cron manually, it shows WP-Cron spawning is disabled. What is WP-Cron spawning? I use Ubuntu 20.04 LEMP stack VPS. In this server, I run 13 WordPress sites. Every 10 minutes I have set up to run each site cron job with a 20 seconds interval. So every site does not execute cron jobs exact same time.\nI edited crontab using the following command.\ncrontab -u www-data -e \n\nWhen I go to the WordPress cron event plugin page, it shows The DISABLE_WP_CRON constant is set to true. WP-Cron spawning is disabled.\nWhat is WP-Cron spawning? and can I enable it while using  define('DISABLE_WP_CRON', true);\nmy crontab script sample.\nwhile ! wget -q -O - https://example.com/wp-cron.php?doing_wp_cron >/dev/null 2>&1 ; do sleep 2 ; done ; echo ok\n\n\n\nA: \nWhat is WP-Cron spawning?\n\nFirst off, let's see what WP-Cron is and how it works:\n\n*\n\n*WP-Cron is how WordPress handles scheduling time-based tasks in WordPress, e.g. checking for core updates and publishing scheduled post.\n\n\n*WP-Cron works by checking, on every page load, a list of scheduled tasks to see what needs to be run.\n\n\n*Any tasks due to run will be called during that page load.\nAnd at this point, a cron spawning might happen, whereby WP-Cron would send a request to run cron through HTTP request that does not halt page loading. And note that the request is sent to wp-cron.php, e.g. https://example.com/wp-cron.php.\nSo WP-Cron spawning is basically an automatic cron call that happens on page load. See _wp_cron() and spawn_cron().\nTherefore, if you manually run WordPress cron, then you should disable the automatic cron call since it will contribute to extra resource usage on your server. See Hooking WP-Cron Into the System Task Scheduler.\nAnd thus, there should be no need to worry regarding the message that says WP-Cron spawning is disabled \u2014 it is probably merely a notice/reminder, or that the plugin might simply be trying to make a test cron request, but then did not proceed when it noticed WP-Cron spawning is disabled.\nNonetheless, if the spawning is disabled, then ensure that WordPress cron is still being executed properly, e.g. via the cron daemon in Linux and MacOS systems.\n\ncan I enable it while using define('DISABLE_WP_CRON', true);\n\nWP-Cron spawning is enabled by default, but it can be disabled/enabled via the DISABLE_WP_CRON constant:\n\n*\n\n*Disables cron spawning \u2014 define('DISABLE_WP_CRON', true);\n\n*Enables cron spawning \u2014 define('DISABLE_WP_CRON', false);\nHowever, if you have access to the system's task scheduler (to make a web request to the wp-cron.php file), then you should just disable WP-Cron spawning.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404350", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: URL redirection I want to config a button so when the user click it a new tab will open and the old tab should be redirect to another URL. How can I make this happen?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404351", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sync user meta data to a second database I need to sync data from the wp_users and usermeta databases to a second table upon registration. I have accomplished the wp_user part successfuly by placing the following code in my functions file:\nfunction add_to_YjT_bookly_customers($user_id) {\n    global $wpdb;\n    $user_info = get_userdata($user_id );\n    $wpdb->insert( 'YjT_bookly_customers', array('full_name' => $user_info->user_login,'wp_user_id' => $user_info->ID,'email' =>$user_info->user_email,'first_name' => $user_info->first_name), array('%s', '%s', '%s', '%s') ); \n}\nadd_action( 'user_register', 'add_to_YjT_bookly_customers');```\n\nBut I also want to sync data from the usermeta db, specifically the first_name and last_name. You can see from the code above that the target db is Yjt_bookly_customers and that I tried (hoped) that the first_name would also sync. And while the user_login, id, and pw sync'ed, the first_name did not. I guess the metadata is not covered by the $user_id variable or I am simply not accessing it correctly. So my question is what code would I need to add to also sync the first_name, last_name fields from the usermeta table to successfully sync those as well at registration submission.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404352", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Can I customize any WordPress parent block-based theme template files by child theme like a parent classic theme? Usually, I can replace the template files and PHP codes of any parent classic theme with child themes. Since block-based theme templates rely on HTML, how can I replace parent block-based theme files and code with child themes?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404353", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: Can I get one wp_query to double order like this? I am trying to achieve the following:\n\n*\n\n*get a collection of posts that have meta_1 set to true\n\n*at top of the list place posts that have meta_2 set to true, ordered by title\n\n*end the list with the posts that have meta_2 set to false (or rest of the posts), also ordered by title.\n\nCan this be done in one query? I'm thinking it's a pretty common occurrence with directory sites that show the promoted listings on top.\nCode I did so far, of course doesn't order as intended:\n        $query = new WP_Query (array (\n            'meta_query' = array(\n                'relation' => 'OR',\n                array (\n                    'relation' => 'AND',\n                    array(\n                        'key'     => 'active_listing',\n                        'value'   => '1',\n                        'compare' => '='\n                    ),\n                    array(\n                        'key'     => 'promoted',\n                        'value'   => '1',\n                        'compare' => '='\n                    )\n                ),\n                array (\n                    'relation' => 'AND',\n                    array(\n                        'key'     => 'active_listing',\n                        'value'   => '1',\n                        'compare' => '='\n                    ),\n                    array(\n                        'key'     => 'promoted',\n                        'value'   => '0',\n                        'compare' => '='\n                    )\n                )\n            ),\n            'orderby' => 'title';\n            'order' => 'ASC';\n        )\n\nNote: I'm using this in a function attached to the pre_get_posts hook to output to an Oxygen Builder repeater.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404354", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Applying css in functions.php does anyone know how i can style the content i echo out in functions.php with the style.css, just how i would if it was html instead of php? Or whichever other way i can style it, as long as it works. For simplicities shake, lets take this hook:\nfunction the_function(){\necho 'Hello world';\n}\nadd_action( 'get_sidebar', 'the_function' );\nHow do i add background colors, move it around the space, and all that, as if its html code? Btw, i m using a child theme if it matters, thanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404356", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I make Gutenberg block layout switchable without lost of current content? I\u2019m relativ new to WordPress and Gutenberg development. Now I have a requirement where I want feature where I can switch from three different layouts. I built a Gutenberg plugin where I can switch between three templates. To switch my current block layout I use the function resetBlocks.\nActually it\u2019s fit the requirement, but the problem that occurs is, that when an editor start to write some content and switch to a different layout, all the current content is lost.\nHow can I change the current block arrangement without losing the content?`\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404358", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to list best seller products in woocommerce I want to show best seller products\u2019 title and sale price in a list under related categories.\nSomething like this;\nBest seller cell phones\n\n*\n\n*iphone 13 pro max \u2013 1299 USD\n\n*Samsung galaxys s22 \u2013 999 USD\n3..\n\nWhat could be easiest and efficient way to reach this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404359", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I set the Stewart Search Template to return only published posts in the result I recently took a WP.com online webinar and the moderator referred me here to ask my question.  I am trying to redesign my site using FSE.  I am using the \"Stewart\" theme.\nI have added a search block to my page to provide for word searches \u2013 the intent is that a word search will return a display of all published posts including the search term. The problem is that the results being returned also include draft posts. I have checked on my wife\u2019s tablet (she has no account so is not logged in to anything) to verify that this is the case for anyone coming to my site. If you do the search, [https://test.redesign.primepassages.com/?s=beer] you will see some post titles with no featured image. These are unpublished draft posts.\nI am using the standard WordPress Search Block (no plugin involved). The Query Loop I am using is set by the standard Stewart Search Template \u2013 I cannot find any settings where I would filter the results to display only published posts.\nThe Stewart Index and Archive templates work fine \u2013 they filter for published posts as expected.\nI need help with how to set the Stewart Search Template to return only published posts in the result.\nhttps://test.redesign.primepassages.com/?s=beer\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404360", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How was this menu system created? Can anyone give me a clue how this menu system was created?\nhttps://40thdems.org/\nThis is a WordPress site using the Divi theme.  Thanks in advance for any pointers!\n\nA: You can create that flip effect by setting the dropdown animation to Flip in your WordPress Dashboard > Divi > Theme Customizer > Header & Navigation > Primary Menu Bar\nAll the way at the bottom is DROPDOWN MENU ANIMATION\nSet that to \"Flip\"\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404370", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: Custom Taxonomy and Categories I am getting up a site in Wordpress to show tours in countries.\nI have setup countries as categories and subcategory\u2019s.\nEurope/Italy/Rome\nAsia/China/Shanghai\nI have also setup tours as a custom taxonomy.\nFood Tours\nwalking Tours\nGuide Tours\nI can create a tour and link it to food tour and Rome and this works fine.\nThe problem is when a user searches food tours, they see tours for Rome and Shanghai.\nIs there a way to filter these searches? Or somehow link the category and taxonomy.\nWould appreciate some help before I go to far.\nThanks Richard\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404371", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp.media libary pdf type What would be library type to show only pdf documents in uploader?\nwp.media({\n   library: {\n        type: 'pdf'\n    },\n});\n\nI tried 'pdf' and 'application/pdf' but its not working, it shows all media.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404374", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Improve performance of slow query I'm using this query to obtain all the products buyed by user and works but query monitor says me that is a slow query (above 0,5 sec), there is a way to fix this?\nHere the db query:\n$result = $wpdb->get_col( \"\n            SELECT im.meta_value FROM {$wpdb->posts} AS p\n            INNER JOIN {$wpdb->postmeta} AS pm ON p.ID = pm.post_id\n            INNER JOIN {$wpdb->prefix}woocommerce_order_items AS i ON p.ID = i.order_id\n            INNER JOIN {$wpdb->prefix}woocommerce_order_itemmeta AS im ON i.order_item_id = im.order_item_id\n            WHERE p.post_status IN ( 'wc-\" . implode( \"','wc-\", $statuses ) . \"' )\n            AND pm.meta_key IN ( '_billing_email', '_customer_user' )\n            AND im.meta_key IN ( '_product_id', '_variation_id' )\n            AND im.meta_value != 0\n            AND pm.meta_value IN ( '\" . implode( \"','\", $customer_data ) . \"' )\n        \" );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404375", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Image not aligning with text I have recently switched to using the Block Editor.\nI am having a problem with the alignment of an image with the top of the text in the first paragraph block.\nThis is how it appears in the block editor:\nhttps://www.dropbox.com/s/8ptg988u9gi23oj/Image1.jpg?dl=0\nThis is how it appears in preview:\nhttps://www.dropbox.com/s/2ehv3rhfgad6ej9/Image2.jpg?dl=0\nYou can see that the top of the image is not aligned with the first line of text as it is in the editor.\nI did not have this problem with the Classic Editor.\nAny suggestions?\nThanks,\nMartin.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404376", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Page that lists publications by classifying them by taxonomy I need a little help writing code. I have an \"artists\" CPT I have an archive-artists.php page with the code below, but I would need to add a \"year\" taxonomy. And that my artist list is divided into several sections, with my title taxonomies.\n2021 in title and the list of artists 2021 below\n2020 in title and the list of artists 2020 below\netc...\nAnd I don't know how to add that, it's kind of a loop within a loop.\nThank you\n<?php $loopfuture = new WP_Query( array( \n    'post_type' => 'artists',\n     'order' => 'DSC'\n) ); ?> \n    \n    <div id=\"flexartists\">\n        <?php while ( $loopfuture->have_posts() ) : $loopfuture->the_post(); ?>\n            <div class=\"artistflex\">\n                <a href=\"<?php the_permalink() ?>\"><?php the_post_thumbnail('event-image size'); ?></a>\n                <h3><?php the_title( '' );?></h3>\n\n                    <div class=\"projetartist\"><?php the_field( 'le_projet' );?></div>\n                <a href=\"<?php the_permalink() ?>\" class=\"moreagenda\">Read more</a>\n            </div>\n        <?php endwhile; wp_reset_query(); ?>\n    </div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404377", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Make a php array load faster I successfully edited the checkout page of the WooCommerce city field in order to be a dropdown field with a lot of cities in it( around 13k values). The problem is that, on mobile and some low-end devices, this field isn't performing well. How I can make this array load faster? Is a DB call worth it in this situation? Is there any way to stop the dropdown and make the field only searchable? Is it worth splitting the array or loading from a text file?\nThe code I made:\n<?php\n\n// Add custom checkout select fields\nadd_filter('woocommerce_checkout_fields', 'add_custom_checkout_select_fields');\nfunction add_custom_checkout_select_fields($fields)\n{\n    $arr = array(); // very big array arround 13k values\n    \n\n    // Define HERE in the array, your desired cities\n    $cities = $arr;\n\n    // Format in the right way the options array of cities\n    $options = array(\n        '' => __('Choose City', 'woocommerce') . '&hellip;'\n    );\n    foreach ($cities as $city)\n    {\n        $options[$city] = $city;\n    }\n\n    // Adding 2 custom select fields\n    $fields['billing']['billing_city2'] = $fields['shipping']['shipping_city2'] = array(\n        'type' => 'select',\n        'required' => true,\n        'options' => $options,\n        'autocomplete' => 'address-level2',\n        'input_class' => array(\n            'wc-enhanced-select',\n        )\n    );\n\n    // Copying data from WooCommerce city fields\n    $fields['billing']['billing_city2']['class'] = array_merge($fields['billing']['billing_city']['class'], array(\n        'hidden'\n    ));\n    $fields['shipping']['shipping_city2']['class'] = array_merge($fields['shipping']['shipping_city']['class'], array(\n        'hidden'\n    ));\n    $fields['billing']['billing_city2']['label'] = $fields['billing']['billing_city']['label'];\n    $fields['shipping']['shipping_city2']['label'] = $fields['shipping']['shipping_city']['label'];\n    $fields['billing']['billing_city2']['priority'] = $fields['billing']['billing_city']['priority'] + 5;\n    $fields['shipping']['shipping_city2']['priority'] = $fields['shipping']['shipping_city']['priority'] + 5;\n\n    wc_enqueue_js(\"\n    jQuery( ':input.wc-enhanced-select' ).filter( ':not(.enhanced)' ).each( function() {\n        var select2_args = { minimumResultsForSearch: 1 };\n        jQuery( this ).select2( select2_args ).addClass( 'enhanced' );\n    });\");\n\n    return $fields;\n}\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404381", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Are major WordPress updates mandatory for security? I have created a web site, I want to activate minor updates (for security) on it and disable major updates (to avoid problems with themes or plugin or my functions.php which could become incompatible with the major new release).\nIs it safe to do so?\nWill update against system vulnerabilities be done on the old major version by WordPress team, even if there is a new major version?\nThanks\n\nA: Yes and no, it depends.\nWhen a security issue is fixed, it's usually backported, so officially the answer is no, you don't have to update to the latest major release.\nHowever Backporting only goes back so far though, and you'll eventually be left in the dark given enough time. This would take many years currently, but there have been a lot of discussions suggesting the current back-porting policy is too generous and creates too high a burden.\nYou also run into other problems, as plugins and themes may not be able to update themselves, and PHP updates from your host may not work well with older versions of WordPress. E.g. PHP 8.0 is best used with the latest versions of WordPress to avoid issues.\nIdeally keep within 2 or so major versions of the current release, and always apply minor updates. This brings you in line with many enterprise WordPress hosts, and gives a little room for testing.\nRemember, WordPress updates should not break your site. If a theme or plugin breaks due to an update that's usually a warning sign that the plugin/theme is of poor quality. You can also look up the field guide posts in advance for new WordPress releases for breaking changes, so none of this should be a surprise. You should also be testing releases before applying them.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404383", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Target a page with query I have those 2 pages that are created from a plugin (see the plugin https://zombify.px-lab.com/frontend-page/, just login and choose a post type, check the url):\n\n*\n\n*https://www.domain.com/post-create-page/?type=story\n\n*https://www.domain.com/post-create-page/?type=trivia\nThe plugin is making use of custom post type.\nI have been trying to target them\nif (is_page ('post-create-page') && ... )\n\nwith get_query_var by trying to pass the $qvars to add_filter( 'query_vars' but I am not sure how to do that.\nCould some one help me how i could target those 2 pages?\nThank you\n\nA: I have checked at the source code and found $_GET as a solution to target them.\n$type = isset($_GET[\"type\"]) ? $_GET[\"type\"] : 'story';\n\n\nif( is_page('post-create-page') && $type=='story' ) { ....} elseif ( is_page('post-create-page') && $type=='openlist' ) {.....}\n\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404384", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to enable custom fields in the Gutenberg post editor Apparently (from this website);\n\nTo view your custom fields using native WP functionality, click the\nsettings button (three dots) and then go to options, where you can\nenable the Custom Fields box.\n\nThis is what I see:\n\nHow do I enable custom fields in the Gutenberg editor the way they used to be present in the classic editor?\nHelp appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404387", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I want to replicate a wordpress website over multiple servers I've noticed a bit of a spike in web traffic as of late and I want to balance the load across multiple servers. The website is running the latest version of Wordpress. Can I setup a second website with the same database login details and have it access the same information? (As long as I have the same setup i.e. plugins, themes, etc)?\n\nA: Yes, you can have 2, tens, even hundreds of individual servers running WordPress with the same codebase connected to the same database server. But there are lots of non-WordPress steps you need to take to get it working, and it may not solve your problem.\n\n*\n\n*You would need to figure out a load balancing solution, which would not involve WordPress\n\n*This does nothing if the performance bottleneck is the database, that would require database replication which is a separate topic\n\n*A robust page caching solution, or software such as varnish would be more performant for a much lower cost\n\nJust adding more servers is not a silver bullet solution, and can lead to odd issues ( e.g. cron job race conditions, that usually crop up when syndicating or pulling in posts only to find there are duplicate posts created ). This is assuming it helps at all, you should measure your performance and scaling bottlenecks and identify where the cost is and what the bottlenecks are on the server side.\nKeep in mind that you can serve tens of thousands of page views on the cheapest Digital Ocean droplet ( ~$5pm ) if it's set up right, persistent object caching, full-page caches for logged out requests, and a well built site that doesn't lean heavily on post meta searches and NOT IN queries.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404388", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to create archive page to add in menu I have a menu like this below\n\nBut I can't find the page. Is this a wordpress page or template located somewhere?\nAnd how can I create archive page?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404396", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Larger preview thumbnails in Media Library Is there a way to force the Media Library to use bigger preview thumbnails in grid and list views?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404397", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Override tax_query with pre_get_posts to include other term_ids on a single category I'm trying to include more than one term_id(multiple checkboxes filter) on a single category page.\nI managed to recollect enough to build a tax_query with pre_get_posts, but now it seems, I have two tax_queries, one is in WP_Query->query_vars and the other is just in WP_Query(that one is of WP_Tax_Query type):\nobject(WP_Query)#1968 (50) {\n  [\"query\"]=>\n  array(1) {\n    [\"product_cat\"]=>\n    string(77) \"parent-category-slug/slug-of-the-category\"\n  }\n  [\"query_vars\"]=>\n  array(59) {\n    [\"product_cat\"]=>\n    string(56) \"slug-of-the-category\"\n    [\"error\"]=>\n    string(0) \"\"\n    [\"m\"]=>\n    string(0) \"\"\n    [\"p\"]=>\n    int(0)\n    [\"post_parent\"]=>\n    string(0) \"\"\n    [\"subpost\"]=>\n    string(0) \"\"\n    [\"subpost_id\"]=>\n    string(0) \"\"\n    [\"attachment\"]=>\n    string(0) \"\"\n    [\"attachment_id\"]=>\n    int(0)\n    [\"name\"]=>\n    string(0) \"\"\n    [\"pagename\"]=>\n    string(0) \"\"\n    [\"page_id\"]=>\n    int(0)\n    [\"second\"]=>\n    string(0) \"\"\n    [\"minute\"]=>\n    string(0) \"\"\n    [\"hour\"]=>\n    string(0) \"\"\n    [\"day\"]=>\n    int(0)\n    [\"monthnum\"]=>\n    int(0)\n    [\"year\"]=>\n    int(0)\n    [\"w\"]=>\n    int(0)\n    [\"category_name\"]=>\n    string(0) \"\"\n    [\"tag\"]=>\n    string(0) \"\"\n    [\"cat\"]=>\n    string(0) \"\"\n    [\"tag_id\"]=>\n    string(0) \"\"\n    [\"author\"]=>\n    string(0) \"\"\n    [\"author_name\"]=>\n    string(0) \"\"\n    [\"feed\"]=>\n    string(0) \"\"\n    [\"tb\"]=>\n    string(0) \"\"\n    [\"paged\"]=>\n    int(0)\n    [\"meta_key\"]=>\n    string(0) \"\"\n    [\"meta_value\"]=>\n    string(0) \"\"\n    [\"preview\"]=>\n    string(0) \"\"\n    [\"s\"]=>\n    string(0) \"\"\n    [\"sentence\"]=>\n    string(0) \"\"\n    [\"title\"]=>\n    string(0) \"\"\n    [\"fields\"]=>\n    string(0) \"\"\n    [\"menu_order\"]=>\n    string(0) \"\"\n    [\"embed\"]=>\n    string(0) \"\"\n    [\"category__in\"]=>\n    array(0) {\n    }\n    [\"category__not_in\"]=>\n    array(0) {\n    }\n    [\"category__and\"]=>\n    array(0) {\n    }\n    [\"post__in\"]=>\n    array(0) {\n    }\n    [\"post__not_in\"]=>\n    array(0) {\n    }\n    [\"post_name__in\"]=>\n    array(0) {\n    }\n    [\"tag__in\"]=>\n    array(0) {\n    }\n    [\"tag__not_in\"]=>\n    array(0) {\n    }\n    [\"tag__and\"]=>\n    array(0) {\n    }\n    [\"tag_slug__in\"]=>\n    array(0) {\n    }\n    [\"tag_slug__and\"]=>\n    array(0) {\n    }\n    [\"post_parent__in\"]=>\n    array(0) {\n    }\n    [\"post_parent__not_in\"]=>\n    array(0) {\n    }\n    [\"author__in\"]=>\n    array(0) {\n    }\n    [\"author__not_in\"]=>\n    array(0) {\n    }\n    [\"orderby\"]=>\n    string(16) \"menu_order title\"\n    [\"order\"]=>\n    string(3) \"ASC\"\n    [\"meta_query\"]=>\n    array(0) {\n    }\n    [\"tax_query\"]=>\n    array(1) {\n      [0]=>\n      array(4) {\n        [\"taxonomy\"]=>\n        string(11) \"product_cat\"\n        [\"field\"]=>\n        string(7) \"term_id\"\n        [\"terms\"]=>\n        array(2) {\n          [0]=>\n          int(47)\n          [1]=>\n          int(834)\n        }\n        [\"operator\"]=>\n        string(2) \"IN\"\n      }\n    }\n    [\"wc_query\"]=>\n    string(13) \"product_query\"\n    [\"posts_per_page\"]=>\n    int(12)\n    [\"post_type\"]=>\n    string(7) \"product\"\n  }\n  [\"tax_query\"]=>\n  object(WP_Tax_Query)#4683 (6) {\n    [\"queries\"]=>\n    array(1) {\n      [0]=>\n      array(5) {\n        [\"taxonomy\"]=>\n        string(11) \"product_cat\"\n        [\"terms\"]=>\n        array(1) {\n          [0]=>\n          string(56) \"slug-of-the-category\"\n        }\n        [\"field\"]=>\n        string(4) \"slug\"\n        [\"operator\"]=>\n        string(2) \"IN\"\n        [\"include_children\"]=>\n        bool(true)\n      }\n    }\n    [\"relation\"]=>\n    string(3) \"AND\"\n    [\"table_aliases\":protected]=>\n    array(0) {\n    }\n    [\"queried_terms\"]=>\n    array(1) {\n      [\"product_cat\"]=>\n      array(2) {\n        [\"terms\"]=>\n        array(1) {\n          [0]=>\n          string(56) \"slug-of-the-category\"\n        }\n        [\"field\"]=>\n        string(4) \"slug\"\n      }\n    }\n    [\"primary_table\"]=>\n    NULL\n    [\"primary_id_column\"]=>\n    NULL\n  }\n  [\"meta_query\"]=>\n  bool(false)\n  [\"date_query\"]=>\n  bool(false)\n  [\"queried_object\"]=>\n  object(WP_Term)#4649 (10) {\n    [\"term_id\"]=>\n    int(1059)\n    [\"name\"]=>\n    string(59) \"Name of the category\"\n    [\"slug\"]=>\n    string(56) \"slug-of-the-category\"\n    [\"term_group\"]=>\n    int(0)\n    [\"term_taxonomy_id\"]=>\n    int(1059)\n    [\"taxonomy\"]=>\n    string(11) \"product_cat\"\n    [\"description\"]=>\n    string(0) \"\"\n    [\"parent\"]=>\n    int(416)\n    [\"count\"]=>\n    int(0)\n    [\"filter\"]=>\n    string(3) \"raw\"\n  }\n  [\"queried_object_id\"]=>\n  int(1059)\n  [\"post_count\"]=>\n  int(0)\n  [\"current_post\"]=>\n  int(-1)\n  [\"in_the_loop\"]=>\n  bool(false)\n  [\"comment_count\"]=>\n  int(0)\n  [\"current_comment\"]=>\n  int(-1)\n  [\"found_posts\"]=>\n  int(0)\n  [\"max_num_pages\"]=>\n  int(0)\n  [\"max_num_comment_pages\"]=>\n  int(0)\n  [\"is_single\"]=>\n  bool(false)\n  [\"is_preview\"]=>\n  bool(false)\n  [\"is_page\"]=>\n  bool(false)\n  [\"is_archive\"]=>\n  bool(true)\n  [\"is_date\"]=>\n  bool(false)\n  [\"is_year\"]=>\n  bool(false)\n  [\"is_month\"]=>\n  bool(false)\n  [\"is_day\"]=>\n  bool(false)\n  [\"is_time\"]=>\n  bool(false)\n  [\"is_author\"]=>\n  bool(false)\n  [\"is_category\"]=>\n  bool(false)\n  [\"is_tag\"]=>\n  bool(false)\n  [\"is_tax\"]=>\n  bool(true)\n  [\"is_search\"]=>\n  bool(false)\n  [\"is_feed\"]=>\n  bool(false)\n  [\"is_comment_feed\"]=>\n  bool(false)\n  [\"is_trackback\"]=>\n  bool(false)\n  [\"is_home\"]=>\n  bool(false)\n  [\"is_privacy_policy\"]=>\n  bool(false)\n  [\"is_404\"]=>\n  bool(false)\n  [\"is_embed\"]=>\n  bool(false)\n  [\"is_paged\"]=>\n  bool(false)\n  [\"is_admin\"]=>\n  bool(false)\n  [\"is_attachment\"]=>\n  bool(false)\n  [\"is_singular\"]=>\n  bool(false)\n  [\"is_robots\"]=>\n  bool(false)\n  [\"is_favicon\"]=>\n  bool(false)\n  [\"is_posts_page\"]=>\n  bool(false)\n  [\"is_post_type_archive\"]=>\n  bool(false)\n  [\"query_vars_hash\":\"WP_Query\":private]=>\n  string(32) \"0cab94343472426f19caa925968f6373\"\n  [\"query_vars_changed\":\"WP_Query\":private]=>\n  bool(false)\n  [\"thumbnails_cached\"]=>\n  bool(false)\n  [\"stopwords\":\"WP_Query\":private]=>\n  NULL\n  [\"compat_fields\":\"WP_Query\":private]=>\n  array(2) {\n    [0]=>\n    string(15) \"query_vars_hash\"\n    [1]=>\n    string(18) \"query_vars_changed\"\n  }\n  [\"compat_methods\":\"WP_Query\":private]=>\n  array(2) {\n    [0]=>\n    string(16) \"init_query_flags\"\n    [1]=>\n    string(15) \"parse_tax_query\"\n  }\n}\n\nThis is the POC filter:\nfunction a3_include_filtered_ctgs($query)\n{\n    if (!isset($_GET['filterCtg'])) return;\n\n    if ($query->is_main_query() && !is_admin()) {\n        var_dump($query->get('tax_query'));\n\n        $taxquery = //$query->get('tax_query');\n            array(\n                array(\n                    'taxonomy' => 'product_cat',\n                    'field' => 'term_id',\n                    'terms' => array_map(function ($id) {\n                        return (int) $id;\n                    }, explode(\",\", $_GET['filterCtg'])),\n                    'operator' => 'IN'\n                )\n            );\n\n        if ($query->get('suppress_filters')) {\n            $query->set('suppress_filters', false);\n        }\n\n        $query->set('tax_query', $taxquery);        \n\n        var_dump($query);\n    }\n}\n\nif (A3_DEBUG === true) {\n    add_action('pre_get_posts', 'a3_include_filtered_ctgs');\n}\n\n\nA: \nbut now it seems, I have two tax_queries, one is in\nWP_Query->query_vars and the other is just in WP_Query\n\nThat is normal.\n\n*\n\n*WP_Query::$query_vars is an array of query vars merged with the default ones for WP_Query.\nSo if you do $query = new WP_Query( array( 'post_status' => 'publish' ) ) (or $query = new WP_Query( 'post_status=publish' )) and then later do $query->set( 'tax_query', array( ... ) ), then $query->query_vars would contain both post_status and tax_query, as well as other vars like posts_per_page, post_type, etc.\n\n\n*WP_Query::$tax_query is an instance of the WP_Tax_Query class and is used by WP_Query for generating the SQL's JOIN and WHERE clauses for the taxonomy query (tax_query) in the $query_vars array.\n\nA: @Sally CJ, thanks for the clearup. However in the end I removed product_cat query variable using $query->set('product_cat', null);\nIt seems to have done the trick, but I'll have to properly test it.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404399", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress database html table with pagination I know how to display the WordPress database table with Foreach loop, but I want to add pagination to the output HTML table so that it should show only the first 100 results then I can use pagination options for further output (if I can use something like $xrd_match = $wpdb->get_results ( \"SELECT * FROM xrd_data_match LIMIT $next, 10\" );).\n<?php\nglobal $wpdb;\n$xrd_match = $wpdb->get_results ( \"SELECT * FROM xrd_data_match\" );\nforeach ( $xrd_match as $print )   {\n?>\n<tr>\n<td><?php echo $print->order_id;?></td>\n<td><?php echo $print->match1;?></td>\n</tr>\n<?php }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404400", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: CPT permalinks Rewrite Someone please can help me to change my Cpt permalink.\ni'm using JEtengine cpt, does the permalink structure can be changed\nfrom www.example.com/request/post_title to www.example.com/request/post_id ?\nin permalink wp settings, changing settings does not affect JetEngine CustomPostType...\nsomeone have snippet or code for functions.php to improve this changes?\n\nA: Don't have any experience with JetEngine CPT, but you can try:\nadd_filter('post_type_link', 'wpse404402_post_type_link', 10, 2);\n\nfunction wpse404402_post_type_link( $link, $post = 0 ){\n    return home_url( 'cpt-type/' . $post->ID );\n}\n\nDon't forget to flush permalinks after that.\nAlso - maybe JetEngine CPT also uses this filter, try to see maybe changing the priority on that add_filter would help. You can also search in the code of the plugin if it uses this filter.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404402", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Checkbox show / hide output result How can i fix a show / hide function in my plugin.\nThe checkbox called \"snup_check\" at line 257 should be standard unchecked.\nIf the checkbox is unchecked nothing should happens.\nIf the checkbox is checked this post is not gonna show up in the SNUP widget in the frontsite.\nMy question is:\n\n*\n\n*How can I save a checkbox ?\n\n*How can I show / hide the output from the widget ?\n\nThe code for the project is here:\nhttps://github.com/bjovaar/SNUP\n\n\n\n\nA: For saving the checkbox, one easy way to check, if the checkbox was checked is to use empty() function. The checkbox key and value exists in $_POST only, if it was checked when the form was submitted.\nFor example,\nfunction snup_save_meta($post_id) {\n\n  // nonce check etc.\n\n  // save text\n  $snupText = $_POST['snuptext'] ?? '';\n  update_post_meta(\n    $post_id, \n    'snuptext', \n    $snupText ? sanitize_textarea_field( $snupText ) : ''\n  );\n\n  // save checkbox\n  $snupCheckChecked = ! empty( $_POST['snup_check'] ); \n  update_post_meta(\n    $post_id, \n    'snup_check', \n    $snupCheckChecked ? '1' : ''\n  );\n  \n}\n\nThen on your posts loop check, if the post has the meta value set or not.\n// Option 1\nfunction snupwidget_upcoming_posts() { \n\n  // code...\n\n  foreach ( $the_query->posts as $post ) {\n\n    // Skip, if not checked\n    if ( empty( get_post_meta( $post->ID, 'snup_check', true ) ) ) {\n      continue;\n    }\n\n    // code...\n\n  }\n\n}\n\nAnother option is to modify your query to only include posts that should be displayed in the first place by using a meta query.\n// Option 2\nfunction snupwidget_upcoming_posts() { \n\n  $output = '';\n\n  // The query to fetch future posts\n  // Limit query to posts with defined meta value\n  // Not tested, but should probably work like this..\n  $the_query = new WP_Query(array( \n      // params..\n      'meta_query' => array(\n        'key' => 'snup_check',\n        'value' => '1',\n        'type' => 'numeric',\n      ),\n  ));\n\n  // code...\n\n}\n\nBut using post meta this way might cause performance issues in the long run. A better option would be to use a (private) utility taxonomy to group posts, that should be displayed by the widget.\nTom J Nowell has written couple of great articles about this, if you're interested in learning more.\n\n*\n\n*Post Meta Abuse\n\n*Utility Taxonomies\nUPDATE\nYou can use checked() on the checkbox input to mark it checked based on the saved post meta.\n<?php\n$snupCheck = get_post_meta( $post->ID, 'snup_check', true );\n?>\n<input type=\"checbox\" name=\"snup_check\" value=\"1\" <?php checked( $snupCheck, 1, true ); ?>>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404410", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Query ACF relationship field - Comparator IN - Value array I have two custom post type with a relationship custom field to linked them.\nI try to do a query based on this custom field using the comparator IN and some IDs in an array, but so far with no success.\nHere is my code:\n$myArgs[] = array(\n  'key' => 'custom_field',\n  'compare' => 'IN',\n  'value' => array('100126','100135')   \n); \n      \n$myQuery = new WP_QUERY(array(\n  'post_type' => 'my_custom_post_type',\n  'posts_per_page' => -1,\n  'meta_query' => $myArgs\n));\n\nI have tested with a different operator just to be sure and it works:\n$myArgs[] = array(\n  'key' => 'custom_field',\n  'compare' => 'LIKE',\n  'value' => '100126'   \n);\n\nI could probably loop and create arguments with each ID but I am sure this is not the best way and I would like to understand what's going on.\nI think it is related to the fact that the data are serialized (ie: a:3:{i:0;s:6:\"100126\";i:1;s:6:\"100140\";i:2;s:6:\"100144\";}\n) but I don't know what to do next.\nThank your for your help\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404412", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ABSPATH not defined? this issue needs a bit of backstory and I'm not sure on how to fix this.\nI had a server running Apache and PHP 5.4, I moved to a vps using NGINX and PHP 7.4. Right now I'm getting errors saying ABSPATH is not defined (the directory has changed).\nThese are the errors:\n[04-Apr-2022 14:38:47 Europe/Berlin] PHP Warning: require(ABSPATHWPINC/option.php): failed to open stream: No such file or directory in /home/cloudpanel/htdocs/dev.pctoppers.nl/wp-includes/functions.php on line 8\n[04-Apr-2022 14:38:47 Europe/Berlin] PHP Fatal error: require(): Failed opening required 'ABSPATHWPINC/option.php' (include_path='.:/usr/share/php') in /home/cloudpanel/htdocs/dev.pctoppers.nl/wp-includes/functions.php on line 8\n[04-Apr-2022 15:01:31 Europe/Berlin] PHP Warning: Use of undefined constant ABSPATH - assumed 'ABSPATH' (this will throw an Error in a future version of PHP) in /home/cloudpanel/htdocs/dev.pctoppers.nl/wp-settings.php on line 33\n[04-Apr-2022 15:01:31 Europe/Berlin] PHP Warning: require(ABSPATHwp-includes/version.php): failed to open stream: No such file or directory in /home/cloudpanel/htdocs/dev.pctoppers.nl/wp-settings.php on line 33\n[04-Apr-2022 15:01:31 Europe/Berlin] PHP Fatal error: require(): Failed opening required 'ABSPATHwp-includes/version.php' (include_path='.:/usr/share/php') in /home/cloudpanel/htdocs/dev.pctoppers.nl/wp-settings.php on line 33\nThis is the WP-CONFIG ABSPATH:\n/* That's all, stop editing! Happy publishing. */\n\n/** Absolute path to the WordPress directory. */\nif ( ! defined( 'ABSPATH' ) ) {\n    define( 'ABSPATH', __DIR__ . '/' );\n}\n\n/** Sets up WordPress vars and included files. */\nrequire_once ABSPATH . 'wp-settings.php';\n\nIf you guys have any clue on how to go about fixing this please let me know because I have no clue where to start. If you need any more information let me know!\nThanks in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404413", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Invert porfolio item order Hello i'would like to invert the display order of my portfolio.\nThere is no settings for that, i use ot portfolio plugin.\nCan i use css or js to do such a thing ?\nWha would you do ?\n<div class=\"projects-grid projects-load-ajax overlay_s1 wow fadeInUp animated\" data-wow-delay=\".3s\" style=\"position: relative; height: 1384.76px; visibility: visible; animation-delay: 0.3s; animation-name: fadeInUp;\">\n        <div class=\"project-item-sizer col-md-4\"></div>\n                     \n        <!-- gallery item -->\n        <div class=\"project-item category-3  col-md-4\" style=\"position: absolute; left: 0px; top: 0px;\">\n            <div class=\"projects-box\">\n                <div class=\"projects-thumbnail\">\n                    <img width=\"467\" height=\"350\" src=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Martigues-1.jpg\" class=\"attachment-600x350 size-600x350 wp-post-image\" alt=\"\" srcset=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Martigues-1.jpg 756w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Martigues-1-300x225.jpg 300w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Martigues-1-600x449.jpg 600w\" sizes=\"(max-width: 467px) 100vw, 467px\" title=\"Habitat Martigues\">                   </div>                          \n                <a href=\"https://www.deficom-evenements.fr/portfolio/salonhabitatmartigues2022/\">\n                    <span class=\"project-overlay\">\n                        <span class=\"project-name id-color\">Salon de l\u2019Habitat de <br>Martigues<br> 4, 5 et 6 novembre 2022</span>  \n                    </span>\n                </a>    \n            </div>\n        </div>\n        <!-- close gallery item -->\n                    \n        <!-- gallery item -->\n        <div class=\"project-item category-3  col-md-4\" style=\"position: absolute; left: 360px; top: 0px;\">\n            <div class=\"projects-box\">\n                <div class=\"projects-thumbnail\">\n                    <img width=\"467\" height=\"350\" src=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Avignon-1.jpg\" class=\"attachment-600x350 size-600x350 wp-post-image\" alt=\"\" loading=\"lazy\" srcset=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Avignon-1.jpg 756w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Avignon-1-300x225.jpg 300w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Avignon-1-600x449.jpg 600w\" sizes=\"(max-width: 467px) 100vw, 467px\" title=\"Habitat Avignon\">                  </div>                          \n                <a href=\"https://www.deficom-evenements.fr/portfolio/salonhabitatavignon2022/\">\n                    <span class=\"project-overlay\">\n                        <span class=\"project-name id-color\">Salon de l\u2019Habitat <br>d\u2019 Avignon<br> 7, 8 et 9 octobre 2022</span> \n                    </span>\n                </a>    \n            </div>\n        </div>\n        <!-- close gallery item -->\n                    \n        <!-- gallery item -->\n        <div class=\"project-item category-5  col-md-4\" style=\"position: absolute; left: 0px; top: 276.953px;\">\n            <div class=\"projects-box\">\n                <div class=\"projects-thumbnail\">\n                    <img width=\"467\" height=\"350\" src=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Fougeres.jpg\" class=\"attachment-600x350 size-600x350 wp-post-image\" alt=\"\" loading=\"lazy\" srcset=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Fougeres.jpg 756w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Fougeres-300x225.jpg 300w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Fougeres-600x449.jpg 600w\" sizes=\"(max-width: 467px) 100vw, 467px\" title=\"Habitat Foug\u00e8res\">                 </div>                          \n                <a href=\"https://www.deficom-evenements.fr/portfolio/foireexpofougeres2022/\">\n                    <span class=\"project-overlay\">\n                        <span class=\"project-name id-color\">Foire expo de <br>Foug\u00e8res<br> 30 septembre, 1er et 2 octobre 2022</span>   \n                    </span>\n                </a>    \n            </div>\n        </div>\n        <!-- close gallery item -->\n                    \n        <!-- gallery item -->\n        <div class=\"project-item category-3  col-md-4\" style=\"position: absolute; left: 360px; top: 276.953px;\">\n            <div class=\"projects-box\">\n                <div class=\"projects-thumbnail\">\n                    <img width=\"467\" height=\"350\" src=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Lorient-1.jpg\" class=\"attachment-600x350 size-600x350 wp-post-image\" alt=\"\" loading=\"lazy\" srcset=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Lorient-1.jpg 756w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Lorient-1-300x225.jpg 300w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Lorient-1-600x449.jpg 600w\" sizes=\"(max-width: 467px) 100vw, 467px\" title=\"Habitat Lorient\">                  </div>                          \n                <a href=\"https://www.deficom-evenements.fr/portfolio/salonhabitatlorient2022/\">\n                    <span class=\"project-overlay\">\n                        <span class=\"project-name id-color\">Salon de l\u2019Habitat de <br>Lorient<br> 11, 12 et 13 novembre 2022</span> \n                    </span>\n                </a>    \n            </div>\n        </div>\n        <!-- close gallery item -->\n                    \n        <!-- gallery item -->\n        <div class=\"project-item category-4  col-md-4\" style=\"position: absolute; left: 0px; top: 553.906px;\">\n            <div class=\"projects-box\">\n                <div class=\"projects-thumbnail\">\n                    <img width=\"467\" height=\"350\" src=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Quimper-1.jpg\" class=\"attachment-600x350 size-600x350 wp-post-image\" alt=\"\" loading=\"lazy\" srcset=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Quimper-1.jpg 756w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Quimper-1-300x225.jpg 300w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Quimper-1-600x449.jpg 600w\" sizes=\"(max-width: 467px) 100vw, 467px\" title=\"Vins Quimper\">                 </div>                          \n                <a href=\"https://www.deficom-evenements.fr/portfolio/salonvinsetgastronomiequimper2022/\">\n                    <span class=\"project-overlay\">\n                        <span class=\"project-name id-color\">Salon des Vins et de la Gastronomie de <br>Quimper<br>19, 20 et 21 novembre 2022</span> \n                    </span>\n                </a>    \n            </div>\n        </div>\n        <!-- close gallery item -->\n                    \n        <!-- gallery item -->\n        <div class=\"project-item category-4  col-md-4\" style=\"position: absolute; left: 360px; top: 553.906px;\">\n            <div class=\"projects-box\">\n                <div class=\"projects-thumbnail\">\n                    <img width=\"467\" height=\"350\" src=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Lorient-4.jpg\" class=\"attachment-600x350 size-600x350 wp-post-image\" alt=\"\" loading=\"lazy\" srcset=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Lorient-4.jpg 756w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Lorient-4-300x225.jpg 300w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Lorient-4-600x449.jpg 600w\" sizes=\"(max-width: 467px) 100vw, 467px\" title=\"Vins Lorient\">                 </div>                          \n                <a href=\"https://www.deficom-evenements.fr/portfolio/salon-des-vins-et-de-la-gastronomie-de-lorient11-12-13-novembre-2022/\">\n                    <span class=\"project-overlay\">\n                        <span class=\"project-name id-color\">Salon des Vins et de la Gastronomie de <br>Lorient<br>11, 12, 13 novembre 2022</span>   \n                    </span>\n                </a>    \n            </div>\n        </div>\n        <!-- close gallery item -->\n                    \n        <!-- gallery item -->\n        <div class=\"project-item category-4  col-md-4\" style=\"position: absolute; left: 0px; top: 830.859px;\">\n            <div class=\"projects-box\">\n                <div class=\"projects-thumbnail\">\n                    <img width=\"467\" height=\"350\" src=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Morlaix-2.jpg\" class=\"attachment-600x350 size-600x350 wp-post-image\" alt=\"\" loading=\"lazy\" srcset=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Morlaix-2.jpg 756w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Morlaix-2-300x225.jpg 300w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Vins-Morlaix-2-600x449.jpg 600w\" sizes=\"(max-width: 467px) 100vw, 467px\" title=\"Vins Morlaix\">                 </div>                          \n                <a href=\"https://www.deficom-evenements.fr/portfolio/salonvinsetgastronomiemorlaix2022/\">\n                    <span class=\"project-overlay\">\n                        <span class=\"project-name id-color\">Salon des Vins et de la Gastronomie de <br>Morlaix<br>29, 30, 31 octobre et 1er novembre 2022</span>    \n                    </span>\n                </a>    \n            </div>\n        </div>\n        <!-- close gallery item -->\n                    \n        <!-- gallery item -->\n        <div class=\"project-item category-3  col-md-4\" style=\"position: absolute; left: 360px; top: 830.859px;\">\n            <div class=\"projects-box\">\n                <div class=\"projects-thumbnail\">\n                    <img width=\"467\" height=\"350\" src=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Morlaix-1.jpg\" class=\"attachment-600x350 size-600x350 wp-post-image\" alt=\"\" loading=\"lazy\" srcset=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Morlaix-1.jpg 756w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Morlaix-1-300x225.jpg 300w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Morlaix-1-600x449.jpg 600w\" sizes=\"(max-width: 467px) 100vw, 467px\" title=\"Habitat Morlaix\">                  </div>                          \n                <a href=\"https://www.deficom-evenements.fr/portfolio/salonhabitatimmobiliermorlaix2022/\">\n                    <span class=\"project-overlay\">\n                        <span class=\"project-name id-color\">Salon de l\u2019Habitat et de l\u2019Immobilier de <br>Morlaix<br>29, 30, 31 octobre et 1er novembre 2022</span>  \n                    </span>\n                </a>    \n            </div>\n        </div>\n        <!-- close gallery item -->\n                    \n        <!-- gallery item -->\n        <div class=\"project-item category-3  col-md-4\" style=\"position: absolute; left: 0px; top: 1107.81px;\">\n            <div class=\"projects-box\">\n                <div class=\"projects-thumbnail\">\n                    <img width=\"467\" height=\"350\" src=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Vitre.jpg\" class=\"attachment-600x350 size-600x350 wp-post-image\" alt=\"\" loading=\"lazy\" srcset=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Vitre.jpg 756w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Vitre-300x225.jpg 300w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Vitre-600x449.jpg 600w\" sizes=\"(max-width: 467px) 100vw, 467px\" title=\"Habitat Vitr\u00e9\">                    </div>                          \n                <a href=\"https://www.deficom-evenements.fr/portfolio/salon-de-lhabitat-et-de-limmobilier-de-vitre-7-8-et-9-octobre-2022/\">\n                    <span class=\"project-overlay\">\n                        <span class=\"project-name id-color\">Salon de l\u2019Habitat et de l\u2019Immobilier de <br>Vitr\u00e9<br> 7, 8 et 9 octobre 2022</span>    \n                    </span>\n                </a>    \n            </div>\n        </div>\n        <!-- close gallery item -->\n                    \n        <!-- gallery item -->\n        <div class=\"project-item category-3  col-md-4\" style=\"position: absolute; left: 360px; top: 1107.81px;\">\n            <div class=\"projects-box\">\n                <div class=\"projects-thumbnail\">\n                    <img width=\"467\" height=\"350\" src=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Vannes-1.jpg\" class=\"attachment-600x350 size-600x350 wp-post-image\" alt=\"\" loading=\"lazy\" srcset=\"https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Vannes-1.jpg 756w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Vannes-1-300x225.jpg 300w, https://www.deficom-evenements.fr/wp-content/uploads/2022/03/Habitat-Vannes-1-600x449.jpg 600w\" sizes=\"(max-width: 467px) 100vw, 467px\" title=\"Habitat Vannes\">                   </div>                          \n                <a href=\"https://www.deficom-evenements.fr/portfolio/salonhabitatimmobiliervannes2022-2/\">\n                    <span class=\"project-overlay\">\n                        <span class=\"project-name id-color\">Salon de l\u2019Habitat et de l\u2019Immobilier de <br>Vannes<br> 19, 20 et 21 novembre 2022</span>   \n                    </span>\n                </a>    \n            </div>\n        </div>\n        <!-- close gallery item -->\n            </div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404415", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Restrict access to custom post type based on its taxonomy terms I'm just beginning to understand the roles and capabilities in Wordpress and I'm not sure that I can do what I would like.\nI have a custom post type, \"cats\", that has specific taxonomies such as \"status\", \"age\", \"breed\"...\nAnd I have a custom role, \"gallerist\".\nI would like the gallerists to be able to create, edit, delete and manage only the \"cats\" posts that have a specific taxonomy term assigned to them. For example the gallerists would be able to edit the cats posts where \"age\" is \"kitten\" but not the cats where \"age\" is \"adult\".\nIs it possible?\n\nA: You should be able to check the conditions and add capabilities like this:\nif(wp_get_current_user('gallerist') AND \n  'cats' == get_post_type() AND \n  has_term( 'status', 'age' )) {  \n\n$gallerist_role = get_role( 'gallerist' );\n\n// Adding a new capability to role\n$gallerist_role->add_cap( 'custom_capability' );\n}\n\nI am sorry I can not test it but I think it is a start\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404416", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Updated to PHP 8.0 and Wordpress site not working I opted out of extended PHP support from my hosting provider and unfortunately did not check to see if my Wordpress build would be compatible with PHP 8.0 (stupid, I know...I rushed because I didn't want to get charged again and now I'm paying for my hastiness).\nI am receiving the following error when loading my domain (http://reallybadreverb.com):\nArgumentCountError thrown\nToo few arguments to function WP_Widget::__construct(), 0 passed in /homepages/3/d208897801/htdocs/clickandbuilds/ReallyBadReverb/wp-includes/class-wp-widget-factory.php on line 61 and at least 2 expected\nHere is what is located in line 61 of the referenced file:\n\n$this->widgets[ $widget ] = new $widget();\n\nAny tips on what to change in the code so I don't have to rebuild my site from scratch would be most appreciated.  Thank you.\n\nA: You cannot change something in the referenced file, since it's part of the core. Ok, technically you can, but you really really shouldn't.\nEven the latest wordpress is not yet production-ready to be compatible with PHP 8 - https://make.wordpress.org/core/2020/11/23/wordpress-and-php-8-0/\nHowever, wordpress 5.6+ is beta-compatible, so your best course of action is to upgrade wordpress. If this is not solved, then you either have to downgrade the server to PHP 7.4, or wait until wordpress releases a fully compatible version (hoping that in the next few weeks/months with the release of wordpress 6).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404420", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: WooCommerce Product Table Conditional styling I have a WooCommerce table and i want when someone adds to cart an item the entire row of that item in the table to change color. I am using a plugin for the WooCommerce table! How can i achieve that?\nThank you!\n\nA: you will need to use jQuery unless your plugin has options to change certain elements on add-to-cart\nsomething along the lines of this:\n$(\"#co\").click(function(){\n   $(this).css({\"backgroundColor\" : \"blue\"});\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404421", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Reset Password Limit not working I have used Ultimate Member plugin to limit Reset Password for given user email. But it's not blocking after the given attempts. Please help me out.\nThis is my configuration page\n\nEven after giving email address in Forgot password for more than 2 times, it's still showing something like this\n\nPlease suggest me the correct way achieving this. Am I doing something wrong with the configuration.\nAlso I want to know, for how much time the user will be blocked from doing this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404423", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Deleting records with AJAX, deleting records as I search I have made a live search engine with ajax which can search for records form the database table, and now I want to include delete functionality in the output results. For this purpose, I have made one <a> with href and write my PHP code inside that. But problem is that while I am search with the textbox, it is giving me output results but it is also deleting all the search results as I type. So things I am search for, it is automatically deleting those even without click on <a> button. Please take a look at my code.\n<script src=\"https://code.jquery.com/jquery-3.6.0.min.js\"></script> \n\n<?php\nglobal $wpdb; \nif(isset($_POST[\"match1\"]) and !empty($_POST['match1'])) { \n$xrd_match = $wpdb->get_results (\"SELECT * FROM xrd_references WHERE ref_code LIKE '%\" . $_POST[\"match1\"] . \"%'\"); \n?><table border=\"1\">\n<tr>\n<th>Ref Code</th>\n<th>Formula</th>\n</tr> <?php\nforeach ( $xrd_match as $print )   { ?>\n<tr>\n<td><?php echo $print->ref_code;?></td>\n<td><?php echo $print->formula;?></td>\n<td><a href='<?php $wpdb->query(\"DELETE FROM xrd_references WHERE ref_code='$print->ref_code' \"); ?>'>Delete This</a></td>\n</tr>\n<?php } exit;   \n}\n?>\n    \n<input id='match1' name='match1'><div id='test1'></div>\n\n<script>\n$(document).ready(function(){ \n$('#match1').on('input', function() { \n    jQuery.ajax({ \n        data:'match1='+$(this).val(), type: \"POST\", success:function(data){ \n            $(\"#test1\").html(data);\n        }\n    })\n})\n});\n</script>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404430", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Connect Wordpress and react front-end Some people say to build React as front-end it is neccesary to use wordpress as headless CRM, but I wonder what is the difference between such a solution and using gutenberg to create subpage templates? This solution seems simpler because I don't have to use REST API or GraphQL to transfer data, I also save on hosting. I'm just curious about the difference in quality.\nhttps://developer.wordpress.org/block-editor/reference-guides/block-api/block-templates/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404431", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: add_comment_meta not working properly I have a scenario where I need to retrieve a custom field ('current_module') from a comment author's user profile and add it to a custom field ('author_current_module') associated with any comment they submit. When I include the following code in my theme's functions.php, nothing is saved to the comment's custom field (I've verified by writing out the variables up until $comment_author_module_id to my log, and everything is working properly).\nNOTE: I've set up the custom fields (for both users and comments) using the PODs plugin. This allows me to create a relationship between my user custom field and a custom taxonomy I use throughout the site. As a result, when I retrieve 'current_module' from the user, an array is returned. That's why I'm referencing 'term_taxononmy_id' for the value that is passed to the comment custom field, 'author_current_module'. Again, I've verified this is working up until this point by writing values to my log. I know that $current_author_module_id does indeed contain the term id number that I need to make the rest of my code work. The only thing that seems to be failing is the final add_comment_meta function.\nadd_filter ('comment_post', 'comment_add_module', 10, 1);\n\n  function comment_add_module($comment_id){\n    $comment_data = get_comment($comment_id);\n    $comment_author_id = $comment_data->user_id;\n    $comment_author_module = get_user_meta($comment_author_id, 'current_module', true);\n    $comment_author_module_id = $comment_author_module['term_taxonomy_id'];\n    add_comment_meta($comment_id, 'author_current_module', $comment_author_module_id, true);\n  }\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404432", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Manual Admin Orders search for billing_company For the past 4 weeks I've been searching for a snippet to search for the company name (billing_company) in WooCommerce manual admin orders. I eventually came across this snippet for my functions.php which works wonders\nadd_filter( \"woocommerce_customer_search_customers\", function ( $filter, $term, $limit, $type ) {\n    if ( $type == 'meta_query' ) {\n          $filter['meta_query'][] = array( 'key' => 'billing_company', 'value' => $term, 'compare' => 'LIKE' );\n    }\n    return $filter;\n}, 10, 4 );\n\nThe only issue I have now is that in the manual order creation and when I type in the billing company name it still shows the firstname/lastname of that user. How can I change it to the company name to be displayed?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404433", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add custom border across footer widget area I would like to post a custom image (bar) as a border across the widget footer area. Is this possible?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404434", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Bootstrap and jQuery error: $ is not defined I'm trying to use the Bootstrap collapse component and just can't get it to work. I believe the HTML is proper, but whenever I click on the element that should trigger the collapse, I get an Uncaught ReferenceError: $ is not defined error in the console, pointing to the custom.js file which contains the $('.collapse').collapse() function. I assumed that I'm just enqueueing the scripts in the wrong order, but everything seems okay to me:\nfunction my_scripts() {\n    wp_enqueue_script( 'bootstrap-jquery','https://code.jquery.com/jquery-3.6.0.min.js', '', '1.0.0', true );\n    wp_enqueue_script( 'bootstrap-js' , 'https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js', array('bootstrap-jquery'), '1.0.0', true );\n    wp_enqueue_script( 'my-js', get_template_directory_uri() . '/js/custom.js' );\n\n    wp_enqueue_style( 'bootstrap-css', 'https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css', '', '1.0.0', 'all' );\n    wp_enqueue_style( 'my-css', get_stylesheet_uri(), array(), _S_VERSION );\n    wp_enqueue_style( 'google-fonts', 'https://fonts.googleapis.com/css2?family=Roboto:wght@400;700', false );\n\n}\nadd_action( 'wp_enqueue_scripts', 'my_scripts' );\n\nAm I missing something important, as I really can't figure it out. :/\nThank you!\n\nA: WordPress uses jQuery (and others) in noConflict mode, meaning that $ isn't automatically available. To use $ in your jQuery script, wrap your code in this:\njQuery( document ).ready( function( $ ) {\n    // $() will work as an alias for jQuery() inside of this function\n    // [ your code goes here ]\n} );\n\nReference: the User Contributed Note from 'bcworkz' on the manual page for wp_enqueue_script()\nAlso note: you shouldn't try to load a new jQuery (which is what your bootstrap-jquery seems to be doing, if I'm reading this right). Instead, add jquery to the dependencies:\nfunction my_scripts() {\n    wp_enqueue_script( 'bootstrap-js' , 'https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js', array('jquery'), '1.0.0', true );\n    wp_enqueue_script( 'my-js', get_template_directory_uri() . '/js/custom.js' );\n\n    wp_enqueue_style( 'bootstrap-css', 'https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css', '', '1.0.0', 'all' );\n    wp_enqueue_style( 'my-css', get_stylesheet_uri(), array(), _S_VERSION );\n    wp_enqueue_style( 'google-fonts', 'https://fonts.googleapis.com/css2?family=Roboto:wght@400;700', false );\n\n}\nadd_action( 'wp_enqueue_scripts', 'my_scripts' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404435", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why is a wp function used in current PHP namespace's callback not resolved to global scope? Imagine the following script:\n<?php\nnamespace MySpace;\n\nclass MyClass {\n\n  public static function execute() {\n    // Do something\n    post_exists(1,'','','my_post_type');\n  } \n\n}\n?>\n\nI'm now calling this function at the top of the page template, before any HTML. The problem I get is that wp resolves the post_exists function to the namespace instead of falling back to the global scope, where wp functions are usually recognized in such cases.\nSo I actually get a PHP error saying Call to undefined function MySpace\\post_exists(), why is that so? Is, at that moment, before the document head, the wp core not initiated, or something similar? Never experienced this bug so far...\n\nA: From your comment:\n\nApparently the function can indeed not be used on the frontend in wp\n(see\nhere),\ncan anyone confirm this?\n\nI can confirm that the post_exists() function can be used on the front-end, but you need to manually load the file that defines the function, which is wp-admin/includes/post.php \u2014 see the \"File: <path>\" part in the \"Source\" section of the post_exists() documentation.\nAnd the file has to be manually loaded because WordPress doesn't load it on the non-admin side of the site, or that the function is only loaded automatically in the wp-admin area.\n\nSo I actually get a PHP error saying Call to undefined function MySpace\\post_exists(), why is that so?\n\nI don't know for sure why, but logically thinking, it's because the calling function (MyClass::execute()) is in the MySpace namespace. So if it wasn't in a namespace, then the message would have not used \"MySpace\\\", i.e. Call to undefined function post_exists().\n\nThe problem I get is that wp resolves the post_exists function to\nthe namespace instead of falling\nback\nto the global scope\n\nNo, I don't think WordPress would not do that \"resolves\" thing, and what happened is likely this:\n\n*\n\n*PHP looked for a function named post_exists from the current namespace: MySpace\\post_exists().\n\n*PHP tried to find and call the global function post_exists().\n\n*Neither found, and so PHP threw the (fatal) error in question.\n\nSee the (7th) rule here which says, \"For unqualified names, if no import rule applies and the name refers to a function or constant and the code is outside the global namespace, the name is resolved at runtime\".\nAdditional Notes\n\n*\n\n*The 1st parameter for post_exists() is the post title, but it seemed that you've passed an ID (1) instead. And if so, then you could just use get_post() to check whether the post exists.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404438", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Orderby meta_key/meta_value not displaying anything, am I overlooking anything? I have an issue with my orderby using get_posts(). I want to order in alphabetical order a list by city name using a custom meta field, but it comes back empty. However when I orderby title, the list is displayed with no issues.\nI activated WP_DEBUG and no errors or notices were found.\nI checked the query in hopes that I was using the wrong meta_key, but everything looks as it should be. Am I missing anything?\nSELECT wp_posts.* FROM wp_posts INNER JOIN wp_postmeta ON ( wp_posts.ID = wp_postmeta.post_id ) WHERE 1=1 AND ( wp_postmeta.meta_key = 'ville' ) AND ((wp_posts.post_type = 'ecole' AND (wp_posts.post_status = 'publish' OR wp_posts.post_status = 'private'))) GROUP BY wp_posts.ID ORDER BY wp_postmeta.meta_value DESC \"\n$posts = get_posts( array(\n     'post_type' => 'ecole',\n     'posts_per_page' => -1,\n     'meta_key' => 'ville',\n     'orderby' => 'meta_value',\n     'order' => 'ASC'\n) );\n\n\nif ( $posts ) {\n     foreach ( $posts as $post ):\n\n     List goes here\n\n<?php\nendforeach;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404439", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce product tab is not showing probably i have this issue when i try to add attribute to any of my product\nthe tab is not showing correctly at all, see image below\n\ni tried to clear cache, changing browsers (i mainly using Firefox but tried chrome and edge), ieven tried a different computer but with no luck.\nalso tried to delete woocommerce and install it again\nim only using elementor and crocoblock jetplugins.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404441", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Template for custom post type when taxonomy is in the URL I have custom post type called books. This has a category taxonomy, called book_types. So, for example:\nBooks -> Fiction -> Da Vinci Code\n\n*\n\n*Custom Post Type: Books\n\n*Custom Taxonomy: Book Types (fiction, non fiction, etc)\n\n*Single entry: Da Vinci Code\n\nI have the permalinks structure to be:\n/books/fiction#da-vinci-code \n\nAll the books are listed in their taxonomy category page as shown above. Da Vinci Code is just one part of the page for Fiction... as seen from the #da-vinci-code hashed value in the URL.\nThis means the taxonomy template is the important one. So I have a template:\ntemplate-book_types.php \n\nBut this doesn't work. WP gives a 404. What am I missing? My code to create the CPT and Taxonomy is below. (And yes, I have flushed the Permalinks many times.)\n/**\n * Post Type: Books.\n */\n\n$labels = [\n    \"name\" => __( \"Books\", \"custom-post-type-ui\" ),\n    \"singular_name\" => __( \"Book\", \"custom-post-type-ui\" ),\n];\n\n$args = [\n    \"label\" => __( \"Books\", \"custom-post-type-ui\" ),\n    \"labels\" => $labels,\n    \"public\" => true,\n    \"publicly_queryable\" => true,\n    \"show_ui\" => true,\n    \"show_in_rest\" => true,\n    \"rest_base\" => \"\",\n    \"rest_controller_class\" => \"WP_REST_Posts_Controller\",\n    \"has_archive\" => true,\n    \"show_in_menu\" => true,\n    \"show_in_nav_menus\" => true,\n    \"delete_with_user\" => false,\n    \"exclude_from_search\" => false,\n    \"capability_type\" => \"post\",\n    \"map_meta_cap\" => true,\n    \"hierarchical\" => false,\n    \"can_export\" => true,\n    \"rewrite\" => [ \"slug\" => \"books\", \"with_front\" => true ],\n    \"query_var\" => true,\n    \"menu_position\" => 5,\n    \"menu_icon\" => \"dashicons-schedule\",\n    \"supports\" => [ \"title\", \"editor\" ],\n    \"taxonomies\" => [ \"book_types\" ],\n    \"show_in_graphql\" => false,\n];\n\nregister_post_type( \"books\", $args );\n\n\n\n\n\n\n/**\n * Taxonomy: Book Types.\n */\n\n$labels = [\n    \"name\" => __( \"Book Types\", \"custom-post-type-ui\" ),\n    \"singular_name\" => __( \"Book Type\", \"custom-post-type-ui\" ),\n];\n\n\n$args = [\n    \"label\" => __( \"Book Types\", \"custom-post-type-ui\" ),\n    \"labels\" => $labels,\n    \"public\" => true,\n    \"publicly_queryable\" => true,\n    \"hierarchical\" => true,\n    \"show_ui\" => true,\n    \"show_in_menu\" => true,\n    \"show_in_nav_menus\" => true,\n    \"query_var\" => true,\n    \"rewrite\" => [ 'slug' => 'book_types', 'with_front' => true, ],\n    \"show_admin_column\" => true,\n    \"show_in_rest\" => true,\n    \"show_tagcloud\" => false,\n    \"rest_base\" => \"book_types\",\n    \"rest_controller_class\" => \"WP_REST_Terms_Controller\",\n    \"show_in_quick_edit\" => false,\n    \"sort\" => false,\n    \"show_in_graphql\" => false,\n];\nregister_taxonomy( \"book_types\", [ \"books\" ], $args );\n\n\nA: Your taxonomy's rewrite base is actually book_types (see the \"rewrite\" => [ 'slug' => 'book_types', 'with_front' => true, ] in your code), so the taxonomy archive pages are accessible at the /book_types/<term slug> path.. and not /books/<term slug>. So it's normal if /books/fiction shows a 404 error page, unless of course if there's a post with the slug fiction.\nSecondly, note that 'with_front' => true means if your Custom Structure setting on the Permalink Settings admin page uses a prefix like /blog/ (with or without the leading/first slash), then your taxonomy's terms would also have that prefix in the permalink, e.g. https://example.com/blog/book_types/fiction/.\nAnd the same also applies to post types where the with_front is set to true. So for example, https://example.com/blog/books/da-vinci-code/ would be the permalink for the \"Da Vinci Code\" post.\nSo as for the 404 error in question, try loading /book_types/fiction#da-vinci-code instead and check if you're seeing the correct taxonomy archive.\nAlso, you should know that the template name for a taxonomy archive should actually be in this form: taxonomy-<taxonomy>.php \u2014 or taxonomy-<taxonomy>-<term>.php for a specific term in a taxonomy, so you should rename your template from template-book_types.php to taxonomy-book_types.php so that WordPress loads it correctly on the taxonomy archive.\nSee https://developer.wordpress.org/themes/template-files-section/taxonomy-templates/ for more details.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404442", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding additional text under the price via product page Hey guys I am wanting to just add this additional text underneath the price (circled in red)\nI am using Xstore child theme via woocommerce/WP and have no idea how to go about adding this in or which option would be easiest?\n\n\nA: this may not be what you want, but i would make the product a variable product, and have the per pack available for purchase, if that's what you want. otherwise if it will be dynamic and a different price for all products, you may need to do some custom coding for it. or possibly place it in the short description and use hooks\nto change the position of the short description\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404443", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp_clear_object_cache() is deprecated. What should I use instead? Today I noticed that \\WP_CLI\\Utils\\wp_clear_object_cache() has been marked as deprecated in WP-CLI 1.5.0. The release notes don't mention anything about it. What should be used, instead? Do I still need to take care of flushing the cache myself or is it handled automatically now, like mentioned here?\n\nA: The function wp_cache_flush() should help you but is not the same one.\nThe function runs on the global $wp_object_cache and set a new empty array, different to the WP CLI deprecated function wp_clear_object_cache for different keys of the global var.\nfunction wp_clear_object_cache() {\n    global $wpdb, $wp_object_cache;\n\n    $wpdb->queries = [];\n\n    if ( ! is_object( $wp_object_cache ) ) {\n        return;\n    }\n\n    // The following are Memcached (Redux) plugin specific (see https://core.trac.wordpress.org/ticket/31463).\n    if ( isset( $wp_object_cache->group_ops ) ) {\n        $wp_object_cache->group_ops = [];\n    }\n    if ( isset( $wp_object_cache->stats ) ) {\n        $wp_object_cache->stats = [];\n    }\n    if ( isset( $wp_object_cache->memcache_debug ) ) {\n        $wp_object_cache->memcache_debug = [];\n    }\n    // Used by `WP_Object_Cache` also.\n    if ( isset( $wp_object_cache->cache ) ) {\n        $wp_object_cache->cache = [];\n    }\n}\n\nNote: The deprecated flag should be wrong, and the maintenance team will change them in a future version. That is information after a small talk with the team.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404447", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display WordPress search results based on the selected Sub-Category I'm trying to create a search using dropdowns in WordPress.\nI've got two dropdowns, 1 - Parent Category and 1 - Sub-category.\nThe Sub-category will show automatically based on the selected Parent category.\nMy goal is to have the 2 dropdowns with a submit button and have it act as a search and only displaying the selected sub-category's posts on the results page.\nI've got this far using research but I'm completely lost and struggling as you can see.\nBelow is my functions.php code:\n// FUNCTIONS.PHP\n\n// Drop-down Ajax call\n\nadd_action('wp_ajax_my_special_action', 'my_action_callback');\nadd_action('wp_ajax_nopriv_my_special_action', 'my_action_callback');\nfunction my_action_callback() {\n    if(isset($_POST['main_catid'])) {\n        $categories = get_categories('child_of='.$_POST['main_catid'].'&hide_empty=0');\n        foreach ($categories as $cat) {\n            $option .= '<option value=\"'.$cat->term_id.'\">';\n            $option .= $cat->cat_name;\n            $option .= ' ('.$cat->category_count.')';\n            $option .= '</option>';\n        }\n        echo '<option value=\"-1\" selected=\"selected\">Search...</option>'.$option;\n        die();\n    } // end if\n}\n\n\n\n// Define search for sub-category\nfunction search_filter( $query ) {\n    // only modify your custom search query.\n    if ( $query->is_search &&  $_post['my_search'] == \"c_search\") {\n        $args = array(\n                'relation' => 'AND',\n            array(\n                'taxonomy' => 'category',\n                'field' => 'id',\n                'terms' => array( $_post['main_cat']),\n                'operator' => 'IN'\n            ),\n            array(\n                'taxonomy' => 'category',\n                'field' => 'id',\n                'terms' => array( $_post['sub_cat']),\n                'operator' => 'IN'\n            )\n        );\n        $query->set( 'tax_query', $args);\n    }\n    return $query;\n}\n\n// The hook needed to search_filter\nadd_filter( 'the_search_query','search_filter');\n\nThis is the HTML & JS code used for the form and Ajax call for the sub-categories:\n<div id=\"content\">\n<form method=\"get\" id=\"searchform\" action=\"<?php bloginfo('url'); ?>/\">\n  <div>\n    <input type=\"text\" value=\"<?php the_search_query(); ?>\" name=\"s\" id=\"s\" />\n    <?php\nwp_dropdown_categories('show_count=0&selected=-1&hierarchical=1&depth=1&hide_empty=0&exclude=1&show_option_none=Main Categories&name=main_cat');\n?>\n    <select name=\"sub_cat\" id=\"sub_cat\" enabled=\"disabled\"></select>\n    <input type=\"hidden\" id=\"my_search\" name=\"my_search\" value=\"c_search\" />\n    <input type=\"submit\" id=\"searchsubmit\" value=\"search\" />\n  </div>\n</form>\n\n\n<script type=\"text/javascript\">\n    jQuery(function() {\n      jQuery('#main_cat').change(function() {\n        var $mainCat = jQuery('#main_cat').val();\n\n        // call ajax\n        jQuery(\"#sub_cat\").empty();\n        jQuery.ajax({\n          url: \"wp-admin/admin-ajax.php\",\n          type: 'POST',\n          data: 'action=my_special_action&main_catid=' + $mainCat,\n\n          success: function(results) {\n            //  alert(results);\n            jQuery(\"#sub_cat\").removeAttr(\"disabled\");\n            jQuery(\"#sub_cat\").append(results);\n          }\n        });\n      });\n    });\n</script>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404448", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: conditional filter I'm trying to set up a filter that shows upcoming events (if any) or shows past events;\nfunction events_function($date_args){\n    $date_args = array(\n        'post_type' => 'evento',\n        'meta_key' => 'data',\n        'posts_per_page' => -1,\n        'orderby' => 'meta_value_num',\n        'order' => 'ASC',\n        'meta_query'=> array(\n            'key' => 'data',\n            'compare' => '>=',\n            'value' => date(\"Ymd\"),\n            'type' => 'DATE'\n            )\n        );\n    if ($date_args->found_posts > 0){\n        return $date_args;\n    } else {\n        $date_args = array(\n            'post_type' => 'evento',\n            'meta_key' => 'data',\n            'posts_per_page' => -1,\n            'orderby' => 'meta_value_num',\n            'order' => 'ASC',\n            'meta_query'=> array(\n                'key' => 'data',\n                'compare' => '<',\n                'value' => date(\"Ymd\"),\n                'type' => 'DATE'\n            )\n        );\n        return $date_args;\n        }\n}\nadd_filter('events', 'events_function');\n\nunfortunately, it is showing past events only, as if $date_args->found_posts is always 0\nany suggestions?\nthanks in advance\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404452", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: (Mobile) Hamburger menu disappeared from a page (only one) the hamburger menu is working correctly except for this page, where it's not present. It worked before, now it has disappeared.\nWhat can I do?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404453", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce order proceed hooks I am using woocommerce_checkout_order_processed hook to run a function. I am getting order-related information and saving it to the custom table because I need it somewhere else. This function is quite long and has around 400 lines of code.\nThe problem is that sometimes it stops at random places. I saved logs to check why the function is breaking but had no luck because there is no pattern. New relic also did not help me with this. Is there anyone who has faced the problem or can help me?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404454", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: is there a way of getting term children that only shows those from two taxonomies hi so I am trying to list the terms ( product categories ) but only those that exist in another custom taxonomy, say 'workplaces'.\nI have the below code that does this, but without taking into account the custom taxonomy archive object ID. I can't seem to figure it out if anyone has any insight it would be very helpful.\nthank you\n/**\n * gets term children, but not specific to custom taxonomy\n */\n\n$term_id = 595;\n$taxonomy_name = 'product_cat';\n$termchildren = get_term_children( $term_id, $taxonomy_name );\n \necho '<ul>';\nforeach ( $termchildren as $child ) {\n    $term = get_term_by( 'id', $child, $taxonomy_name );\n    echo '<li><a href=\"' . get_term_link( $child, $taxonomy_name ) . '\">' . $term->name . '</a></li>';\n}\necho '</ul>';\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404455", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce Shortcode which displays a table with product data I searched for the internet but didnt find anything which works to my use case. I want to have a shortcode which displays a table of products. In each row I want the product to have the following data:\n\n*\n\n*Product image\n\n*product title\n\n*a custom field (lets call it \"custom\")\n\n*a list ofcurrent stock of my variations\n\n*link to product detail page\n\nIn Html it would look like the following:\n|image| Product 1 | custom field value | men 10 woman 6 | view\n\n|image| Product 2 | custom field value | men 8 woman 12 | view\n\n...\nCan anybode help me out and provide some code?\nThanks in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404458", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Need help making a short code work I will try to explain my question as good as possible. but since english is not my main language I hope you will understand.\nIm trying to fill a carrousel with a custom post type. if got everything working except a read more button. which will take you to the single-post.\nNow I'm trying to add it through a short code that I can add to the place where I load the metadata (this is from the backend of WordPress and not via a php file on the server..)\nThe only problem with my current setup is that I have to fill in the id every time I make a post like: [permalink id=131] I would like to have a short code that also gets the id from the db. so that my short code will only be [permalink]. So I can add it once to the loop.\nAtm I'm using the following code in my functions.php:\nfunction my_permalink_shortcode( $atts ) {\n\n    $id = intval($atts['id']);\n    if ($id <= 0) { return; }\n    \n    // Check that $id has a URL.\n    $url = get_permalink($id);\n    if ($url == '') { return; }\n    \n    // Get link option and title.\n    $link = ($atts['link'] == '1') ? true : false;\n    $title = (trim($atts['title']) == '') ? get_the_title($id) : $atts['title'];\n    \n    // Determine if we create a link.\n    if ($link) {\n        return '<a href=\"'.$url.'\">'.$title.'</a>'; \n    } else {\n        return $url;\n    }\n} \nadd_shortcode('permalink', 'my_permalink_shortcode');\n\nThanks for reading.\nKind regards.\nMark\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404460", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Activation flow of a plugin in a multisite environment I'm learning plugin development and I came across this issue where I need to activate my custom plugin and from my research on this topic there are three possible scenarios:\n\n*\n\n*Network admin activates the plugin for the whole network\n\n*Network admin or site admin activate the plugin for a specific site\n\n*Regular single site installation activation flow\nWhen I activate the plugin as a network admin the plugin is activated only for the site with $blog_id = 1.\nother sites mark the activate state as activated but the plugins' settings tab isn't showing in settings.\nHow and where can I start debugging this issue?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404463", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Not able to select width of blocks inside of cover block I am using a blank theme with the theme.json for gutenberg blocks. When I create a cover block and select any block inside of my cover block it doesn't give me the option the select the width properties. So for all of my content inside of my cover block it is always inside of my regular content width.\nI have already enable the wide content width with the\n   \"layout\": {\n        \"contentSize\": \"800px\",\n        \"wideSize\": \"1000px\"\n    },\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404464", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Counting number of posts in multiple (sub)categories using shortcode I'm making a new cycling team website and on the home page i have 3 different type of stats: \"Win, Podium and top-10\"\nNow i want the number of the stat go up if i post something with for instance the category: \"Podium\" But i want it to go 2 up if i select the categories: \"1-podium / 2-podium\" ETC\nSo in short, i want the count number go up if i post something while selecting one or more categories. If i select one category, the number needs to go up by 1, if i add 2 it needs to go up by 2 etc.\nI'm relative new to Wordpress so i don't know where to make the code and how to make the shortcode to the code.\nCan someone please help me?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404467", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ACF Select Field can't return Array I want to get the list of selected items. The field is made with ACF, and I query the data with wp-graphql. I also have the wp-graphql ACF addon installed. However, when multiple items are selected, it throws an error.\nThis is my field:\n\n\nI created a sample post and selected \"green\" and \"blue\". This is what happens:\nWorks correctly when I choose \"value\" as Return Format:\n\nWorks correctly when I choose \"label\" as Return Format:\n\nThrows error when I choose \"Array (Both) as Return Format:\n\n{\n  \"errors\": [\n    {\n      \"message\": \"Internal server error\",\n      \"extensions\": {\n        \"category\": \"internal\"\n      },\n      \"locations\": [\n        {\n          \"line\": 6,\n          \"column\": 9\n        }\n      ],\n      \"path\": [\n        \"posts\",\n        \"nodes\",\n        0,\n        \"colors\",\n        \"colors\",\n        0\n      ]\n    },\n    {\n      \"message\": \"Internal server error\",\n      \"extensions\": {\n        \"category\": \"internal\"\n      },\n      \"locations\": [\n        {\n          \"line\": 6,\n          \"column\": 9\n        }\n      ],\n      \"path\": [\n        \"posts\",\n        \"nodes\",\n        0,\n        \"colors\",\n        \"colors\",\n        1\n      ]\n    }\n  ],\n  \"data\": {\n    \"posts\": {\n      \"nodes\": [\n        {\n          \"title\": \"Test\",\n          \"colors\": {\n            \"colors\": [\n              null,\n              null\n            ]\n          }\n        }\n      ]\n    }\n  },\n  \"extensions\": {\n    \"debug\": [\n      {\n        \"type\": \"DEBUG_LOGS_INACTIVE\",\n        \"message\": \"GraphQL Debug logging is not active. To see debug logs, GRAPHQL_DEBUG must be enabled.\"\n      }\n    ]\n  }\n}\n\nAnd this is the error explanation when I turn on the Debug mode:\n{\n  \"errors\": [\n    {\n      \"debugMessage\": \"Expected a value of type \\\"String\\\" but received: {\\\"value\\\":\\\"g1\\\",\\\"label\\\":\\\"Green\\\"}\",\n      \"message\": \"Internal server error\",\n      \"extensions\": {\n        \"category\": \"internal\"\n      },\n      \"locations\": [\n        {\n          \"line\": 6,\n          \"column\": 9\n        }\n      ],\n      \"path\": [\n        \"posts\",\n        \"nodes\",\n        0,\n        \"colors\",\n        \"colors\",\n        0\n      ]\n    },\n    {\n      \"debugMessage\": \"Expected a value of type \\\"String\\\" but received: {\\\"value\\\":\\\"b1\\\",\\\"label\\\":\\\"Blue\\\"}\",\n      \"message\": \"Internal server error\",\n      \"extensions\": {\n        \"category\": \"internal\"\n      },\n      \"locations\": [\n        {\n          \"line\": 6,\n          \"column\": 9\n        }\n      ],\n      \"path\": [\n        \"posts\",\n        \"nodes\",\n        0,\n        \"colors\",\n        \"colors\",\n        1\n      ]\n    }\n  ],\n  \"data\": {\n    \"posts\": {\n      \"nodes\": [\n        {\n          \"title\": \"Test\",\n          \"colors\": {\n            \"colors\": [\n              null,\n              null\n            ]\n          }\n        }\n      ]\n    }\n  },\n  \"extensions\": {\n    \"debug\": []\n  }\n}\n\nHow can I fix this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404473", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Track Block Pattern Insertion Within the Block Editor Our team is looking for a way to track when block patterns are inserted into the WordPress block editor. We would also like to record the name of the block pattern that's being inserted. This tracking will help us better understand which patterns provide the most value to our clients, and where we might need to make changes.\nThe method we need to hook into is insertBlocks() (https://developer.wordpress.org/block-editor/reference-guides/data/data-core-block-editor/#insertblocks) since the meta parameter passes the name of the block pattern during insertion.\nThe pull request at https://github.com/WordPress/gutenberg/pull/25165 shows the WordPress team built in a way to do this, but they didn't provide direction on \"how\".\nI'm no expert with React and Redux, so any help on how best to do this would be great. Even a little bump in the right direction would be awesome. Thanks a ton for your help.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404476", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to get the $meta_type given the $object_id I'm trying to copy meta data from a term to an object when that term is assigned to the object by way of wp_set_object_terms().  When I hook into set_object_terms, I am able to obtain the desired $meta_key and $meta_value (as well as the desired $object_id, which is passed via the hook).  The problem lies when I go to copy the term meta to the object.  This can only be done by way of update_metadata($meta_type, $object_id, $meta_key, $meta_value) because I do not know the $meta_type (specifically, I cannot use update_post_meta(), update_comment_meta(), update_user_meta(), etc).\nGiven the $object_id (and a WP_Term object), how does one go about determining the $meta_type to be passed to update_metadata()?  Specifically, I am looking to calculate a string value equal to post, comment, term, user, or any other string that identifies an object type with an associated meta table.\n\nA: \nGiven the $object_id (and a WP_Term object), how does one go about\ndetermining the $meta_type to be passed to update_metadata()?\n\nUnfortunately, that is not possible because each object has its own table and therefore the same ID (1, 2, 3, etc.) could refer to a post, comment, term, etc.\nSo that's why we have different functions which query different tables based on the object ID (that we pass to the function) and type (that is in the function name), e.g. get_post() for retrieving a post object and get_comment() for retrieving a comment object.\n\nThis can only be done by way of update_metadata($meta_type, $object_id, $meta_key, $meta_value) because I do not know the\n$meta_type (specifically, I cannot use update_post_meta(),\nupdate_comment_meta(), update_user_meta(), etc).\n\nI don't know, either. But looking at the WordPress database structure (and diagram like this), I think $object_id should always be a post ID, therefore $meta_type would then be post. And here's why:\n\n*\n\n*Of all the core object types in WordPress, only posts that would have terms-taxonomy relationships (i.e. users for example, do not have taxonomies).\n\n\n*wp_set_object_terms() inserts term-taxonomy relationship into the wp_term_relationships table which (does not have an object_type field, and) has two primary keys \u2014 object_id and term_taxonomy_id. So that means, the object IDs there should belong to the same object type.\nPS: I copied the diagram/image above from here where at the time of writing (this answer), that article was last updated in August 2021. There's also an official one on the (yes, outdated) Codex website..\nSo in summary, I don't know how, but I might use if ( get_post( $object_id ) ) { copy the term meta to the post meta table }..\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404477", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hooks for Start/End of Batch Plugin Updates in wordpress We're trying to get a hook to run before wordpress updates and after wordpress updates.\nWe'd like this hook to run whether it's\na)through the admin panel in these two cases:\n1 - single plugin update that is ran,\n2 - or a batch plugin update, by checking multiple checkboxes, and clicking the actions menu and clicking on update.\nb) through wp cli.\nWe've tried:\nupgrader_package_options\nupgrader_pre_install\nupgrader_process_complete\nupgrader_post_install\n\nBut the results have been that they run N x 2 number of times.  Meaning if you check off 3 plugins to be updates, they will fire off 3 x 2 = 6 times.  3 for the pre hook and 3 for the post hook.\nWe've also looked at this popular article but it would only work for when plugins are updated through the admin panel.\nWe're essentially looking for a way to process a pre command and post command no matter how the update occurs.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404481", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is posible to redirect a few URL? i'm making this website using wordpress as headless and using gatsby in the front-end, i pass the information using the api\nI have the wordpress in a URL example ap-backend.com and the front-end in other URL which is the \"main url\" of my page for example ap.com\nFor avoid people try to see and check the back end i made the follow function to redirect to my main url\nfunction redirect_website() {\n        \n        if ( ! is_admin() ) {\n            wp_redirect( $main_website, 301 );\n            exit;\n        }\n    }\n\nwhere the $main_website has the main URL and if someone try to check ap-backend.com this redirect to ap.com\nRight now i want to create a newsletter using the rss feed and as you can imagine if i use the ap-backend.com/feed/rss i see is the main url, so my question is, can i have the redirection to all url except the url of the feed? (ap-backend.com/feed/rss) or can i redirect to have that info or ap.com/feed/rss i see that i can do it in the .httaccess but this is a validate opcion?\nThanks for the help guys!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404482", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Double Slash After Media Path (uploads//) After performing an SEO Audit on my client\u2019s website I found out that several images have a double slash in their URLs. This seems to be happening just to media files, and the double slash is appearing this way: \u201c/uploads//\u201d.\nHere\u2019s an example:\n\u2013 https://akmicorp.com/wp-content/uploads//2018/10/heavy-duty-truck-mountain-1024\u00d7682.jpeg\nHow can I fix this?\nNotes:\n\n*\n\n*I have checked the wp-config.php file and the htaccess file and there is no define( lines related\n\n\n*I have checked the WordPress Media Settings and the Full URL path to files option is properly configured (https://akmicorp.com/wp-content/uploads)\nWarm Regards,\nLeandro\n\nA: if you are familiar with WP-CLI ( Wordpress command-line interface ) you can very easily search and replace the wrong uploads// url with uploads/.\nyou will need to install the wp-cli.phar file in the root of your directory.\nthere are many tutorials online that explain how to install it for your relevant system. It is very straight forward if you have used other command line tools before\nWordpress.org explains the search-replace.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404483", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Grabbing Image name From Product Image Gallery When a user clicks the add-to-cart button I need the order to capture the image from the product-image-gallery that the user last clicked and NOT the default product image. Is this possible?\nThanks in Advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404485", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Detect a screen option change In WordPress code, how can I detect a screen option change? Ie, in the below image I want to hook when one of the column screen options changes. Is there a specific hook for this?\n\n\n\nMy usecase:\nI need to add a screen option to the 'All Posts' page. If the user has unchecked my screen option then the All Posts table should not display posts that have a certain category. I have pretty much all my code for this usecase working (see below) apart from being able to hook/detect when 'My Custom Screen Option' is changed (ticked on or off). If I can do that I can then update the users meta with this decision.\nfunction add_custom_columns( $columns ) {\n    $columns['display_xyz'] = __( 'XYZ Posts' );\n    return $columns;\n}\nadd_filter( 'manage_posts_columns', 'add_custom_columns' );\n\nfunction set_sortable_columns( $columns ) {\n    $columns['display_xyz'] = 'display_xyz';\n    return $columns;\n}\nadd_filter( 'manage_edit-post_sortable_columns', 'set_sortable_columns' );\n\nfunction sort_all_posts( $query ) {\n    global $current_screen;\n\n    // If on 'All Posts' page.\n    if ( isset( $current_screen ) && is_admin() && $current_screen->id === 'edit-post' && $query->query_vars['post_type'] === 'post' ) {\n        $show_xyz_posts = get_user_meta( get_current_user_id(), 'display_xyz' );\n\n        if ( ! $show_xyz_posts ) {\n            // Edit $query to not retrieve posts that have a specific category 'xyz'\n        }\n    }\n}\nadd_filter( 'parse_query', 'sort_all_posts' );\n\n// How to detect change of my custom screen option so I can hook the below option??\nfunction on_change_screen_option($option, $value) {\n\n    if ( $option === 'display_xyz' ) {\n        update_user_meta( get_current_user_id(), 'display_xyz', $value );\n    }\n}\nadd_action( '???', 'on_change_screen_option' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404486", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get child product categories from parent product category for CUSTOM TAXONOMY archive page Can anyone help me as LoizTheAztec pretty much covered most of what I need here with his very helpful answers. What I need to do is alter this further, and rather than it being on a Product Cat Archive page, I need it to do the same thing on a custom taxonomy page ( a hierarchical custom taxonomy ), and to only show product categories ( terms ) for that custom taxonomy if the product cats ( terms ) are in the custom taxonomy. So it would be a query using two taxonomies.\nI have achieved what I need another way, with the help of this question, that uses wpdb ( efficient ) but thereafter, I use get_term_by quite a few times to search through the array of results. ( inefficient ).\nI don't think it is possible, and I am not too familiar with how I could achieve it using wpdb for each section. I think it is a type of recursion, and I am not entirely sure how to achieve this as mysql is a relational database. I have tried the WITH command with mysql that throws an error so I don't think recursion is possible in wordpress, unless you want to use a bunch of inefficent foreach loops.\nThis is the layout of the page with tabs for each product category that I want to show, Each product category shows the CHILD product categories ( it's descendants ) for the particular custom taxonomy object :\nCustom Taxonomy Archive Page\n\n<?php\n/**\n * The Template for displaying product archives, including the main shop page which is a post type archive\n *\n * This template can be overridden by copying it to yourtheme/woocommerce/archive-product.php.\n *\n * HOWEVER, on occasion WooCommerce will need to update template files and you\n * (the theme developer) will need to copy the new files to your theme to\n * maintain compatibility. We try to do this as little as possible, but it does\n * happen. When this occurs the version of the template file will be bumped and\n * the readme will list any important changes.\n *\n * @see https://docs.woocommerce.com/document/template-structure/\n * @package WooCommerce\\Templates\n * @version 3.4.0\n */\n/**\n * THIS TEMPLATE IS FOR DISPLAYING WORKPLACES\n * IT FINDS PRODUCT CATEGORIES FROM EACH SECTION AND SHOWS THEM IF THEY ARE RELEVANT FOR THE WORKPLACE.\n * \n */\ndefined('ABSPATH') || exit;\n\nget_header('shop');\n\n/**\n * Hook: woocommerce_before_main_content.\n *\n * @hooked woocommerce_output_content_wrapper - 10 (outputs opening divs for the content)\n * @hooked woocommerce_breadcrumb - 20\n * @hooked WC_Structured_Data::generate_website_data() - 30\n */\ndo_action('woocommerce_before_main_content');\n\n?>\n<header class=\"woocommerce-products-header background_diamond\">\n    <script>\n    var $gg = jQuery.noConflict();\n    $gg(document).ready(function() {\n\n        $gg(\".custom_content\").shorten();\n    });\n\n    \n    </script>\n    <style type=\"text/css\">\n    .major_cat_archive.custom_banner_style::before {\n        <?php $term = get_queried_object();\n\n        \n// vars\n$image = get_field('banner_image', $term);\n\nif ($image)\n{\n\n?>background-image: url(<?php echo $image['url']; ?>);\n            <?php\n}\n\nelseif (!$image)\n{\n?>background-image: url(<?php woocommerce_category_image();\n}\n\n?>);\n    }\n    </style>\n    <?php if (apply_filters('woocommerce_show_page_title', true)): ?>\n        \n    <div class=\"major_cat_archive custom_banner_style example_layout_left\">\n\n        <h1 class=\"woocommerce-products-header__title page-title example_layout\" data-aos=\"fade-right\"\n            data-aos-offset=\"-200\" data-aos-delay=\"10\" data-aos-duration=\"1000\" data-aos-easing=\"ease\"\n            data-aos-mirror=\"true\" data-aos-once=\"false\" data-aos-anchor-placement=\"top-center\">\n            <?php woocommerce_page_title(); ?></h1>\n    </div>\n    <?php\nendif; ?>\n    <?php\n/**\n * Hook: woocommerce_archive_description.\n *\n * @hooked woocommerce_taxonomy_archive_description - 10\n * @hooked woocommerce_product_archive_description - 10\n */\ndo_action('woocommerce_archive_description');\n\n//echo '<pre>';\n      //  var_dump( $term );\n      //  echo '</pre>';\n?>\n</header>\n<div class=\"holder \" data-aos=\"fade-up\" data-aos-offset=\"-200\" data-aos-delay=\"10\" data-aos-duration=\"1000\"\n    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"false\" data-aos-anchor-placement=\"top-center\">\n    <div class=\"sub_holder row content\">\n        <div class=\"col-12\">\n            <div class=\"intro_sec\">\n                <div class=\"sub_holder row\">\n                    <div class=\"col-lg-6 f-col\">\n                        <div class=\"first_col\">\n                            <h2>Our Value Promise</h2>\n                            <div class=\"custom_content\">\n                                <?php $term = get_queried_object();\n$custom_content = get_field('custom_content', $term);\necho $custom_content; ?>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"col-lg-6\">\n\n<?php\n                    $image = get_field('workplace_thumb', $term);\n\nif ($image)\n{\n?>\n                        <div class=\"second_col\" style=\"background-image: url(<?php echo $image['url']; ?>);\">\n\n                        <?php\n}\n\nelseif (!$image)\n{?>\n                        <div class=\"second_col\" style=\"background-image: url(<?php woocommerce_category_image();\n}\n\n?>);\">\n                            <div class=\"gradient_overlay\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n\n<div class=\"container notices\">\n    <div class=\"row_notices\">\n        <?php /*notices output in separate div */\n?>\n        <div class=\"xoo-wsc-cart-trigger\">Trigger Side Cart</div>\n        <?php\n    do_action('woocommerce_before_shop_loop'); ?>\n    </div>\n</div>\n</div>\n</div>\n</div>\n\n\n<div class=\"container cat_view\">\n    <div class=\"row\"><?php\n\n\n   $workplace_term_slug = $term->slug; // A term slug is required (not the term id or term name)\n\n   \n\n\n$workplace_term_slug = $term->slug; // A term slug is required (not the term id or term name)\n\n $results = get_product_categories_from_a_product_workplace( $workplace_term_slug );\n\n\n   if( ! empty($results) ) {\n   \n       $term_names = []; // Initializing an empty array variable\n   \n       // Loop through each product category terms:\n       foreach ( $results as $result ) {\n           $term_id   = $result->term_id; // Term id\n           $term_name = $result->slug; // Term slug\n           $term_slug = $result->name; // Term name\n           $taxonomy  = 'product_cat'; \n   \n           $term_link = get_term_link( get_term( $result->term_id, $taxonomy ), $taxonomy );\n   \n           // Example: Set the linked formatted term name in an array\n           $term_names[] = '<a class=\"'.$result->slug.'\" href=\"'.$term_link.'\">'.$result->name.'</a>';\n           $cats1[] = $result->slug;\n         //  $cats1 = array_unique( $cats1 );\n       }   \n       $term_names = array_unique( $term_names );\n       echo count( $term_names );\n\n       \n   \n       // Display the linked formatted terms names\n       //echo '<div class=\"workplace-categories '.$workplace_term_slug.'\">'.implode(' ', $term_names).'</div>';\n       echo '<pre> Every PRODUCT CAT term in this TAXONOMY object ';\n       print_r( $cats1 );\n       echo '</pre>';\n   }\n\n\n   \n\n    /*at this point, all relevant category slugs have been gathered and then sorted to remove duplicates.*/\n\n \n        \n/**\n * INITIALISE EMPTY ARRAYS FOR PROCESSING.\n * ADD TO ARRAY IF SLUG AT $check IS A SIBLING OF RELEVANT CATEGORY.\n * IT ALSO WILL CHECK WITH || OR IF IT IS == TO RELEVANT CATEGORY.\n * THIS IS IN THE EVENT A PRODUCT IS ASSIGNED TO THE PARENT CATEGORY.\n * EACH ARRAY IS PLACED WITHIN IT'S RELEVANT TAB.\n * AN 'OTHER' TAB WILL ONLY APPEAR IF A CATEGORY IS ABSTRACT TO THE RELEVANT CATEGORIES.\n * THIS USES workplace_construct_categories(); & prod_cat_is_ancestor_of(); FUNCTIONS IN FUNCTIONS.PHP.\n */\n\n /*Initialise each relevant array */\n    $array_of_window_cleaning = [];\n    $array_of_hygiene_products = [];\n    $array_of_catering_supplies = [];\n    $array_of_hygiene_equipment = [];\n    $array_of_workwear = [];\n    $abstract_categories = [];\n    \nif( $cats1 ){\n    foreach ($cats1 as $check)\n    {\n        $value = get_term_by('slug', $check, 'product_cat');\n        $workwear_safety = get_term_by('slug', 'workwear-safety', 'product_cat');\n        $hygiene_products = get_term_by('slug', 'hygiene-products', 'product_cat');\n        $hygiene_equipment = get_term_by('slug', 'hygiene-equipment', 'product_cat');\n        $catering_supplies = get_term_by('slug', 'catering-supplies', 'product_cat');\n        $window_cleaning = get_term_by('slug', 'window-cleaning', 'product_cat');\n\n        if (prod_cat_is_ancestor_of($workwear_safety, $value) || ($value->slug == $workwear_safety->slug))\n        {\n            if ($value->slug != $workwear_safety->slug)\n                $array_of_workwear[] = $value->slug;\n        }\n    \n        elseif (prod_cat_is_ancestor_of($hygiene_products, $value) || ($value->slug == $hygiene_products->slug))\n        {\n            \n            if ($value->slug != $hygiene_products->slug)\n                $array_of_hygiene_products[] = $value->slug;\n                \n        }\n    \n        elseif (prod_cat_is_ancestor_of($hygiene_equipment, $value) || ($value->slug == $hygiene_equipment->slug))\n        {\n            if ($value->slug != $hygiene_equipment->slug)\n                $array_of_hygiene_equipment[] = $value->slug;\n        }\n    \n        elseif (prod_cat_is_ancestor_of($catering_supplies, $value) || ($value->slug == $catering_supplies->slug))\n        {\n            if ($value->slug != $catering_supplies->slug)\n                $array_of_catering_supplies[] = $value->slug;\n        }\n    \n        elseif (prod_cat_is_ancestor_of($window_cleaning, $value) || ($value->slug == $window_cleaning->slug))\n        {\n            if ($value->slug != $window_cleaning->slug)\n                $array_of_window_cleaning[] = $value->slug;\n        }\n    \n        else\n        {   \n                $abstract_categories[] = $value->slug;\n            \n        }\n    }\n    } \n\n?>\n\n\n\n\n    </div>\n</div>\n</div>\n</div>\n</div>\n<pre><?php\n//print_r( $array_of_hygiene_products );\n?></pre>\n<!-- Display section of categories -->\n\n<div class=\"container\" data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"10\" data-aos-duration=\"1000\"\n    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"false\" data-aos-anchor-placement=\"top-center\">\n    <div class=\"row\">\n        <h2 class=\"main_headings cat_titles\"><?php woocommerce_page_title(); ?>: Relevant Categories </h2>\n    </div>\n</div> <?php\n?>\n\n<div class=\"container-fluid\">\n    <div class=\"row\">\n        <div class=\"col-12\">\n            <ul class=\"nav nav-tabs justify-content-center\">\n                <li class=\"active\" data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"10\"\n                    data-aos-duration=\"1000\" data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a class=\"active\" href=\"#tab1\" data-bs-toggle=\"tab\">Workwear\n                        & Safety</a></li>\n                <li data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"300\" data-aos-duration=\"1000\"\n                    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a href=\"#tab2\" data-bs-toggle=\"tab\">Hygiene Products</a>\n                </li>\n                <li data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"600\" data-aos-duration=\"1000\"\n                    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a href=\"#tab3\" data-bs-toggle=\"tab\">Hygiene Equipment</a>\n                </li>\n                <li data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"900\" data-aos-duration=\"1000\"\n                    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a href=\"#tab4\" data-bs-toggle=\"tab\">Catering Supplies</a>\n                </li>\n                <li data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"1200\" data-aos-duration=\"1000\"\n                    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a href=\"#tab5\" data-bs-toggle=\"tab\">Window Cleaning</a></li>\n                <?php\n    if (!empty($abstract_categories))\n    {\n?>\n                <li class=\"tab6_zindex\" data-aos=\"fade-up\" data-aos-offset=\"-300\" data-aos-delay=\"1200\" data-aos-duration=\"1000\"\n                    data-aos-easing=\"ease\" data-aos-mirror=\"true\" data-aos-once=\"true\"\n                    data-aos-anchor-placement=\"top-center\"><a href=\"#tab6\" data-bs-toggle=\"tab\">More</a></li>\n                <?php\n    } ?>\n            </ul>\n        </div>\n    </div>\n</div>\n<div class=\"tab-content container\">\n    <div class=\"tab-pane active\" id=\"tab1\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseOne\">\n\n                        Workwear & Safety\n                    </a>\n                </h4> \n            </div>\n            <div id=\"collapseOne\" class=\"panel-collapse collapse in\">\n                <div class=\"panel-body\">\n                    <?php $term = get_queried_object();\n    $safteyworkwear = get_field('workwear-safety', $term);\n    echo $safteyworkwear;\n\n    //$newarray = [];\n    sort_categories( $array_of_workwear ); \n\n?>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"tab-pane\" id=\"tab2\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseTwo\">\n                        Hygiene Products\n                    </a>\n                </h4>\n            </div>\n            <div id=\"collapseTwo\" class=\"panel-collapse collapse\">\n                <div class=\"panel-body\">\n                    <?php $hyg_products = get_field('hygiene_products', $term);\n    echo $hyg_products; \n  \n    sort_categories( $array_of_hygiene_products );\n?>\n\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"tab-pane\" id=\"tab3\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseThree\">\n                        Hygiene Equipment\n                    </a>\n                </h4>\n            </div>\n            <div id=\"collapseThree\" class=\"panel-collapse collapse\">\n                <div class=\"panel-body\">\n                    <?php $hyg_equip = get_field('hygiene_equipment', $term);\n    echo $hyg_equip;\n\n   sort_categories( $array_of_hygiene_equipment ); ?>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"tab-pane\" id=\"tab4\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseFour\">\n                        Catering Supplies\n                    </a>\n                </h4>\n            </div>\n            <div id=\"collapseFour\" class=\"panel-collapse collapse\">\n                <div class=\"panel-body\">\n                    <?php /*do_action( 'woocommerce_after_shop_loop' ); */ ?>\n                    <?php $catering = get_field('catering_supplies', $term);\n    echo $catering;\n\n    sort_categories( $array_of_catering_supplies ); \n?>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"tab-pane\" id=\"tab5\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseFive\">\n                        Window Cleaning\n                    </a>\n                </h4>\n            </div>\n            <div id=\"collapseFive\" class=\"panel-collapse collapse\">\n                <div class=\"panel-body\">\n                    <?php /*do_action( 'woocommerce_after_shop_loop' ); */ ?>\n                    <?php $win_cleaning = get_field('window_cleaning', $term);\n    echo $win_cleaning;\n    sort_categories( $array_of_window_cleaning ); \n?>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!--tab 5 close -->\n\n    <?php\n    if (!empty($abstract_categories))\n    {\n?>\n    <div class=\"tab-pane\" id=\"tab6\">\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\">\n                <h4 class=\"panel-title\">\n                    <a data-bs-toggle=\"collapse\" data-bs-parent=\".tab-pane\" href=\"#collapseSix\">\n                        More\n                    </a>\n                </h4>\n            </div>\n            <div id=\"collapseSix\" class=\"panel-collapse collapse\">\n                <div class=\"panel-body\">\n                    <?php /*do_action( 'woocommerce_after_shop_loop' ); */ ?>\n                    <?php\n                   \n                   sort_categories( $abstract_categories ); \n?>\n                </div><!-- close -->\n            </div><!-- close -->\n        </div><!-- close -->\n\n     \n    </div><!-- more div close -->\n\n\n    \n</div><!-- close -->\n\n\n\n\n\n\n\n</div><!-- close -->\n<?php\n    }\n    else\n    {\n        echo '</div>';\n    } ?>\n\n<!--end of display section -->\n<?php\necho '<pre>';\n  //  print_r( $array_of_hygiene_products);\n    echo '</pre>';?>\n\n<?php\n   // woocommerce_product_loop_end();\n    /**\n     * Hook: woocommerce_after_shop_loop.\n     *\n     * @hooked woocommerce_pagination - 10 removed\n     */\n    //do_action('woocommerce_after_shop_loop');\n\n\n    \nif (woocommerce_product_loop())\n{\n\n    /**\n     * Hook: woocommerce_before_shop_loop.\n     *\n     * @hooked woocommerce_output_all_notices - 10\n     * @hooked woocommerce_result_count - 20\n     * @hooked woocommerce_catalog_ordering - 30\n     */\n\n}\nelse\n{\n    /**\n     * Hook: woocommerce_no_products_found.\n     *\n     * @hooked wc_no_products_found - 10\n     */\n    do_action('woocommerce_no_products_found');\n}\n/**\n * Hook: woocommerce_after_main_content.\n *\n * @hooked woocommerce_output_content_wrapper_end - 10 (outputs closing divs for the content)\n */\ndo_action('woocommerce_after_main_content');\n/**\n * Hook: woocommerce_sidebar.\n *\n * @hooked woocommerce_get_sidebar - 10\n */\ndo_action('woocommerce_sidebar');\nget_footer('shop');\n\n\nmy function to sort the categories.\nI was trying to paginate the sections ( haven't achieved this yet which is why I am trying to change my code and my reason for this question )\n\nfunction sort_categories($cat_slugs){\n    /**func att */\n    if (!empty($cat_slugs))\n        {\n            global $wp_query;\n\n           $cat_slugs = array_unique( $cat_slugs);\n           $term_count = count( $cat_slugs );\n           $per_page = 20;\n           $max_num_pages = ceil( $term_count / $per_page );\n           \n          // var_dump( $max_num_pages );\n           $page  = get_query_var('page');\n           $paged = get_query_var('paged');\n           $current_page = ($paged ? $paged : ($page ? $page : 1));\n        $offset = (($current_page - 1) * $per_page);\n    \n        $ids = [];\n        foreach($cat_slugs as $each){\n            $testterm = get_term_by('slug', $each, 'product_cat');\n            $id = $testterm->term_id;\n            $ids[] = $id;\n    \n        }\n     \n       // print_r( $ids);\n        $terms3 = \n            array(\n                'orderby'    => 'id',\n                'order'      => 'ASC',\n              //  'posts_per_page' => 5,\n                'hide_empty' => true,\n                'include'    => $ids,\n                'taxonomy'   => 'product_cat',\n                'number' => $per_page,\n                'offset' => $offset,\n                'max_num_pages' => $max_num_pages,\n            \n        );\n    \n        $terms5 = get_terms('product_cat', $terms3);\n        \n      \n     \n            echo '<div class=\" woocommerce columns-5\"><ul id=\"custom_load\" class=\" products columns-5\">';\n       \n            foreach ($terms5 as $check)\n            {\n                $check = $check->slug;\n                $value = get_term_by('slug', $check, 'product_cat');           \n                workplace_construct_categories($value);\n               //wc_get_template_part( 'content', 'product_cat' );\n            }\n    \n        }\n        if (!empty($terms5)){ echo '</ul>'; echo ''; echo next_posts_link('Next page', $max_num_pages ); \n}\n\n/**\n * https://stackoverflow.com/questions/61622017/get-woocommerce-product-categories-that-contain-a-specific-product-brand/61624358#61624358\n */\n\n    function get_product_categories_from_a_product_workplace( $workplace_term_slug, $taxonomy = 'workplaces' ) {\n        global $wpdb;\n    \n        return $wpdb->get_results( \"\n            SELECT DISTINCT t1.*\n            FROM    {$wpdb->prefix}terms t1\n            INNER JOIN {$wpdb->prefix}term_taxonomy tt1\n                ON  t1.term_id = tt1.term_id \n            INNER JOIN {$wpdb->prefix}term_relationships tr1\n                ON  tt1.term_taxonomy_id = tr1.term_taxonomy_id\n            INNER JOIN {$wpdb->prefix}term_relationships tr2\n                ON  tr1.object_id = tr2.object_id\n            INNER JOIN {$wpdb->prefix}term_taxonomy tt2\n                ON  tr2.term_taxonomy_id = tt2.term_taxonomy_id         \n            INNER JOIN {$wpdb->prefix}terms t2\n                ON  tt2.term_id = t2.term_id\n            WHERE tt1.taxonomy = 'product_cat'\n            AND tt2.taxonomy = '$taxonomy'\n            AND  t2.slug = '$workplace_term_slug' \n             \n            \n            \n                 \n        \", OBJECT );\n    }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404488", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress sidebar content moving to bottom of page Ever since my previous website update (developer no longer with me), I am having an issue with Wordpress widgets on my sidebar moving to below the content, rather than remaining on the sidebar on https://morpheustrading.com/blog/.\nThe issue seems to be that ALL widgets are moving to the bottom of the page if the text content is too wide in any individual widget.\nFor example, a narrow HTML block of code remains on the sidebar, but all widgets move to the bottom if I try to use a widget such as \"Most Popular Posts\" or \"Related Posts\" because the text in these widgets is apparently too long.\nRather than wrapping the text, the whole widget moves to the bottom.\nI have spent hours Googling and trying different solutions to adjust the width of the sidebar, but still have not managed to resolve the issue.\nMaybe I only need to set the text to wrap, rather than adjust the sidebar width. Not sure, as my coding experience is limited.\nMy Wordpress site is using a custom theme built on underscores.me.\nWould greatly appreciate any assistance.\nThank you.\n\nA: did you try this css property:\nword-wrap: break-word;\nThere is a few others:\noverflow-wrap: normal;\noverflow-wrap: break-word;\noverflow-wrap: anywhere;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404489", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress cascading dropdown selection search based on Parent Page & Child Page How would I create a cascading dropdown select search where the first dropdown would host selected Parent Pages and the second to display the Child Pages of the selected Parent. When submit button is clicked it would just redirect to the selected child page.\nCould anyone please help me on how to get this done, I've done the research and haven't gotten anywhere apart from only displaying all pages in 1 dropdown using the code below:\n<select name=\"easyreg_redirect_page\"> \n<option value=\"\"><?php echo esc_attr( __( 'Select page' ) ); ?></option> \n<?php \n    $pages = get_pages(); \n    foreach ( $pages as $page ) {\n        $option = '<option value=\"' . $page->ID . '\">';\n        $option .= $page->post_title;\n        $option .= '</option>';\n        echo $option;\n    }\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404494", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get all template files used for rendering a single post/page? So, I need to debug an issue and I would like to see all template files that were used to render this specific page. I mean specific \"sub\" template files (not the main .php file), like sub woocommerce template files.\nFor the main template file this works:\nadd_action( 'wp_footer', function() {\n    global $template;\n    print_r( $template );\n});\n\nI get the main (last) template file used (eg. single.php).\nBut I would really like to see all templates embedded with eg. wc_get_template / get_template_part. I just don't have an idea how to achieve that.\nDoes someone have an idea on how to do this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404496", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add filters to my site? I've just started to use Wordpress for a few days to build a website. How can I add customizable filters to my site?\nI'm using a free version, if this requires a payment? Which ones should I choose (I notice that there are some different upgrade plans as well as different WooCommerce pricing plans.\nThank you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404498", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What's wrong in my PHP code? I'm using Wordpress Astra Theme and I can't insert data into my SQL         <form method=\"post\" action=\"functions.php\">\n            <div class=\"form-group\">\n                <input id=\"customer\" name=\"Customer Name\" type=\"text\" placeholder=\"Customer name\" class=\"form-control input-sm\" required=\"\">\n            </div>\n            <div class=\"form-group\">\n                <input id=\"business\" name=\"Business Name\" type=\"text\" placeholder=\"Business name\" class=\"form-control input-sm\" required=\"\"></br>\n            </div>\n            <div class=\"form-group\">\n                <input id=\"machines\" name=\"Machines\" type=\"text\" placeholder=\"Enter Machines\" class=\"form-control input-sm\" required=\"\">\n            </div>\n            <div class=\"form-group\">\n                <input id=\"price\" name=\"Price\" type=\"text\" placeholder=\"Price\" class=\"form-control input-sm\" required=\"\">\n            </div>\n            <div class=\"form-group\">\n                <input id=\"phone\" name=\"Phone\" type=\"text\" placeholder=\"Phone\" class=\"form-control input-sm\" required=\"\">\n            </div>\n            <div class=\"form-group\">\n                <input id=\"date\" name=\"Date\" type=\"text\" placeholder=\"Date\" class=\"form-control input-sm\" required=\"\">\n            </div>\n            <div class=\"form-group\">\n                <input id=\"address\" name=\"Address\" type=\"text\" placeholder=\"Address\" class=\"form-control input-sm\" required=\"\">\n            </div>\n            <div class=\"row justify-content-center\">\n                <div class=\"col-xs-8 col-sm-8 col-md-8\">\n                    <input type=\"submit\" value=\"Submit\" class=\"btn btn-info btn-block\" name=\"submitbbtn\">\n                </div>\n            </div>\n        </form>\n\n\n            if(isset($_POST[\"submitbbtn\"])){\n                echo 'One customer added';\n                $host=\"localhost:3306\";\n                $username=\"fartuna_wp947\";\n                $password=\"\";\n                $databasename=\"fartuna_wp947\";\n                //connect db\n                $connect=mysql_connect($host, $username,$password);\n                $db=mysql_select_db($databasename);\n                \n                global $wpdb;\n                $DB = $wpdb->prefix.\"books\";\n                $wpdb->insert(\n                    $DB,\n                    [\n                        'customer'  => 'customer',\n                        'business'  => 'business',\n                        'machines'  => 'machines',\n                        'price'     => 'price',\n                        'phone'     => 'phone',\n                        'date'      => 'date',\n                        'address'   => 'address'\n                    ]\n                    );\n            }\n\n\nA: First, you don't need connection info when using the global $wpdb.  It's already connected.\nSecond, if your insert is failing, then the first thing to check would be your data format. If you don't specify a format, then it is handled as a string.  See the docs for WPDB::insert:\n\nAn array of formats to be mapped to each of the value in $data. If string, that format will be used for all of the values in $data. A format is one of '%d', '%f', '%s' (integer, float, string). If omitted, all values in $data will be treated as strings unless otherwise specified in wpdb::$field_types.\n\nSo if your table specifies a specific format required for the column, it may fail if your insert data format doesn't match the requirement.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404499", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress - Ultimate Auction for WooCommerce I use the plugin Ultimate Auction for WooCommerce and I would like to display information about the latest auctions on the first page.\nI have some information provided by the plugin developer but my knowledge is not so advanced that I can display this information on the site:\n\nThe bid history data comes from the \u201cwoo_ua_auction_log\u201d database\ntable. We have added the code for the bid history table in the below\nfile.\nGo to Ultimate Auction for WooCommerce -> templates -> woocommerce ->\nsingle-product -> tabs -> uwa-bids-history.php\nWe have also developed the below functions which help you to display\nthe latest(current) bid value and bidder name. It includes in the\nclass-uwa-product.php file of the auction plugin.\n$current_bidder = $product->get_woo_ua_auction_current_bider();\n$current_bid = $product->get_woo_ua_auction_current_bid();\nBelow is the meta_key in which the current bid information is stored\nin the database.\nwoo_ua_auction_current_bid woo_ua_auction_current_bider\n\nIf anyone can help me, I remain grateful.\nThank You\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404500", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to read and write session data? My website requires users to complete their profile before they can place an order. So far, I have been able to redirect a user to his profile editing page if his profile is incompleted when he tries to place an order.\nadd_action('woocommerce_before_checkout_form',function(){\n  if (is_user_logged_in()){\n    $user = wp_get_current_user();\n    if ( bpprocn_has_incomplete_profile($user->id) ) { // check user's profile completed or not\n      if (wp_redirect(bp_core_get_user_domain( $user->id ) . bp_get_profile_slug() . '/edit/group/2')) exit;\n    }\n  }\n});\n\nNow I am trying to figure out how to redirect the user back to his cart page once he completes his profile.\nI've found Wordpress's profile_update action that could be used. The problem is, by using this action only, anyone updating their profile will be redirected, which is unwanted. I need to distinguish users who simply want to edit their profile from those users who try to place an order and get redirected to their profile editing page.\nDoes Wordpress provide anything in regards of this? The approach I can think of is mark a user as \"try to place an order and get redirected\" when he is redirected to profile editing page due to incompleted profile. I think to do this I need to access the session data. But my knowledge in this aspect is close to zero. Can anyone share some light or point me to a right direction? Thanks!\n\nA: Assuming you are using WooCommerce (but equivalent to the WC()->cart->is_empty() check can be found for all major well-designed e-commerce plugins):\nadd_action('woocommerce_before_checkout_form',function(){\n  if (is_user_logged_in()){\n    $user = wp_get_current_user();\n    if ( bpprocn_has_incomplete_profile($user->id) ) { // check user's profile completed or not\n      if ( ! WC()->cart->is_empty() ) {\n        if (wp_redirect(bp_core_get_user_domain( $user->id ) . bp_get_profile_slug() . '/edit/group/2')) exit;\n      }\n    }\n  }\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404502", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How WP does Mortgage affordability calculation I'm trying to replicate the functionality of how this site: https://www.propertyguru.com.sg/mortgage/affordability-calculator/results\nI need to understand the logic behind its calculation so i can build this in JS and incorporate into Wordpress.\nI've been able to figure out how it allocates the downpayment but not the purchase price of the house.Can someone please help me understand how it calculates the estimated property value?.\n\nA: They've created an algorithm to determine what amount the user can afford based on the user's previous answers. You need that algorithm/equation.\nWordPress has nothing to do with how the price is determined...\nThis is not a question for this forum. It's a question that you should ask a realtor or a mortgage professional, I'm not sure it's information that's going to be easy to find though, as it's part of the reason why people pay realtors and mortgage professionals to do what they do.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404505", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress website - Mobile menu behavior help hoping you could help. So, Im using xtheme, and wordpress. And I have code to make my mobile menu a fixed top menu, so its always visible. I also have JavaScript to make it retract upon clicking a menu item so the menu doesn't cover the screen.\ncss to make it fixed:\n@media (max-width: 979px) {\n  .x-navbar-fixed-top {\n    position: fixed!important;\n  }\n}\n\nJavascript:\njQuery(document).ready(function($){\n    $('.x-navbar .mobile .x-nav >').on('click touchend', function(e) {\n        document.getElementsByClassName(\"x-btn-navbar\")[0].click()\n    });\n});\n\nThis works to a point, however, if you go to this page: https://foresthillcentre.com/mental-health-services/\nAnd try the menu on all of the submenu items (setup to scroll to section on same page) The menu retracts before you can click on anything, and you have to re-click the hamburger to bring up the submenus. You will see what I mean on use...\nAny suggestions to fix this?\nThank you.\n\nA: The CSS isn't the culprit here, there is an issue with your jQuery logic. Based on the provided jQuery it looks like you're binding click events based on class names.\nI would suggest binding the click event that triggers the initial navigation dropdown to the hamburger icon's ID rather than class. And then binding a separate click event that triggers the drop downs.\nIt also appears that both the navigation and the submenu dropdowns share the same attribute: data-x-toggleable=\"x-nav-wrap-mobile\" this may be the cause of the issue.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404507", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: \"My Sites\" incorrectly showing all network sites for all logged in users I've searched this board for a similar question and answer, and I haven't seen anyone ask about this.\nRecently, after some updates, the functionality of the \"My Site\" item on the WordPress nav has changed.\nWe run multisite with users having different permissions for different sites on the network. Most content managers only have editing or admin privileges on one or two of the sites on the network, and have otherwise not been added as users to the sites they do not manage content for.\nUp until recently, when a logged in user clicked on or hovered over \"My Sites\" it would only show the sites that that user was editor or admin for. However, after some recent updates, including updating our SAML ADFS SSO log-in plugin (miniorange), ALL content managers (editors and admins) see ALL sites on the network under MySites, and when I go to the USERS section in the dashboard each subsite, I see that anyone who was only added to a few sites on the network as editor or admin, is now listed in users as a subscriber on all other sites on the network.\nThis is not a huge problem, but an inconvenience for most of our content managers, used to quickly and easily bouncing between the one or two sites they edited/admined from the MySites menu, now having to wade through the list of every site on our network. We do have VPs breathing down our necks to find a fix, but I'm at a loss.\nMy first instinct is that something about the update in MiniOrangeSAML is registering users as subscribers to every site on the network when they log in, but I'm having a tough time communicating with their support, and wanted to rule out any other possibilities in the mean time as I wait for them to respond, in order to expedite this. I'm hoping someone else has experienced this same problem in the past, and knows an easy fix, but I'm not overly optimistic.\nThe screenshot is of course of MYSITE for me, a superadmin, on the network dashboard, however, this is the same list all of my content managers have reported getting, even if they're only admin on one site.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404508", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom Role read_private_posts Not Working I've created a custom role via add_role, it's in my activation hook and is being removed on deactivation, thus I'm deactivating and reactivating my plugin to see the role permission changes. I can see that the changes are appearing (I've used the User Roles and Capabilities plugin to check) but I still can't view private page and posts when logged in.\nadd_role( 'clerk', 'Clerk', [ 'read' => true, 'read_private_pages' => true, 'read_private_posts' => true ] );\nI've even tried adding some other permissions and see straight away that the user is able to do the things so am sure that I'm adding permissions in the correct way.\nSo why can my Clerk user still not see private posts and pages? What am I missing, do they need some other permission in order for it to work?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404509", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding content to Page settings rather than Block settings I have a Gutenberg editor. Some content of the page is global, and not relevant to an individual block. I'd like to add content to the page settings:\n\nI can see how you can add a plugin that creates a secondary sidebar using registerPlugin, however is there a way to hook into and add settings to the Page settings sidebar?\n\nA: Ahh \u2014\u00a0I found it. It is called the PluginDocumentSettingPanel and can be imported from @wordpress/edit-post.\nimport { registerPlugin } from '@wordpress/plugins';\nimport { PluginDocumentSettingPanel } from '@wordpress/edit-post';\n \nconst PluginDocumentSettingPanelDemo = () => (\n    <PluginDocumentSettingPanel\n        name=\"custom-panel\"\n        title=\"Custom Panel\"\n        className=\"custom-panel\"\n    >\n        Custom Panel Contents\n    </PluginDocumentSettingPanel>\n);\n \nregisterPlugin( 'plugin-document-setting-panel-demo', {\n    render: PluginDocumentSettingPanelDemo,\n    icon: 'palmtree',\n} );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404511", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Duplicator Pro plugin with Docker on local? I have the Duplicator Pro plugin. In the past it was fairly easy to use. I have a wordpress site on a server, I'm trying to bring it down/migrate it down into a local sandbox. I have my local wordpress instance setup with Docker. Spinning it up initially with Docker was very easy and was tired of the clunky MAMP/WAMP tools. However migrating the site down while using Docker locally has been a challenge. With the Duplicator pro plugin the /installer.php script isn't read at all.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404515", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Last-Modified header is removed from server response! i attached this code to all these hooks (init, template_redirect, wp_footer) to add the Last-Modified header to the server response, i also add some other header for testing.\nresults: the TEST-TEST header was returend to the response BUT not the Last-Modified.\ni thought it was a conflict with some plugin, that for some reason is unsetting this header.\nSo i moved this code to the footer.php and index.php in the project root. but the result is same.\ncan anyone explain to me why this is happening?\nThank you\ntry {\n    if (get_the_ID()) {\n        $LastModified_unix = strtotime(get_the_modified_date('Y-m-d H:i:s')); // \u0441 \u0440\u0443\u0441\u0441\u043a\u043e\u0433\u043e \u043d\u0430 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439\n        $LastModified = gmdate(\"D, d M Y H:i:s \\G\\M\\T\", $LastModified_unix);\n\n        $IfModifiedSince = false;\n        if (isset($_ENV['HTTP_IF_MODIFIED_SINCE']))\n            $IfModifiedSince = strtotime(substr($_ENV['HTTP_IF_MODIFIED_SINCE'], 5));\n        if (isset($_SERVER['HTTP_IF_MODIFIED_SINCE']))\n            $IfModifiedSince = strtotime(substr($_SERVER['HTTP_IF_MODIFIED_SINCE'], 5));\n        if ($IfModifiedSince && $IfModifiedSince >= $LastModified_unix) {\n            header($_SERVER['SERVER_PROTOCOL'] . ' 304 Not Modified');\n            exit;\n        }\n        header('Last-Modified: ' . $LastModified);\n        header('TEST-TEST: ' . $LastModified);\n\n    }\n} catch (Exception $exception) {\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404517", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Passing values through url for checkbox fields with same name to get? \nLook to this images\nFor example chose \"Ajna\" then select \"Residential and Hotel Apartment\"\nafter click Search Properties => I need to show items that have these categories\n<ul id=\"actionslist\" class=\"dropdown-menu filter_menu\" role=\"menu\" aria-labelledby=\"adv_actions\">\n    <li role=\"presentation\" data-value=\"all\">Project Types</li>\n    <?php \n    // Get Projects\n    $tab_terms_types      =   array();\n    $terms_types          =   get_terms( 'property_action_category', array(\n                        'hide_empty' => false,\n                    ) );\n    \n    foreach( $terms_types as $single_term_type ){\n        $args_types = array(\n            'post_type'         =>  'estate_property',\n            'author'        =>   -1,    \n            'posts_per_page'    =>  -1,\n            'post_status'       => 'publish',\n            'meta_key'          => 'prop_featured',\n            'orderby'           => 'meta_value',\n            'order'             => 'DESC',\n            'tax_query' => array(\n                array(\n                    'taxonomy' => 'property_action_category',\n                    'field'    => 'term_id',\n                    'terms'    => $single_term_type->term_id,\n                ),\n            ),\n            'fields' => 'ids'\n        );\n        $all_posts_types = get_posts( $args_types );\n        if( count( $all_posts_types ) > 0 )\n    $tab_terms_types[ $single_term_type->term_id ] = array( 'name' => $single_term_type->name, 'slug' => $single_term_type->slug, 'count' => count( $all_posts ) );\n\n    }\n        \n    foreach($tab_terms_types as $term){\n            ?>\n    <div>\n        <input type=\"checkbox\" id=\"<?php echo $term['slug']; ?>\" class=\"types-input\"\n            name=\"filter_search_action[]\" value=\"<?php echo $term['slug']; ?>\"\n            data-value=\"<?php echo $term['slug']; ?>\">\n        <label for=\"<?php echo $term['slug']; ?>\"><?php echo $term['name']; ?></label>\n    </div>\n\n    <? } ?>\n </ul>\n\njQuery Ajax\nconst typesArray = [];\n$(\".types-input\").click(function(event){\n    if($(this).prop(\"checked\") == true){\n\n        typesArray.push(jQuery(event.target).attr('data-value'));\n        console.log(typesArray);\n    }\n})\n$(\".types-input\").change(function(){\n    const ajaxurl = ajaxcalls_vars.admin_url + 'admin-ajax.php';\n    const nonce = jQuery('#wpestate_tab_stats').val();\n    \n    $.ajax({\n        method: \"GET\",\n        url: ajaxurl,\n        data: {\n            'action': 'wpestate_load_types',\n            'type_slug': typesArray,\n            'security': nonce\n        },\n        success: function(data){\n            $(\".res-type\").html(data);\n            console.log(data);\n            console.log(typesArray);\n        }\n    })\n})\n\nfunctions.php\nadd_action( 'wp_ajax_wpestate_load_types', 'wpestate_load_types' );\nadd_action( 'wp_ajax_nopriv_wpestate_load_types', 'wpestate_load_types' );\n\nfunction wpestate_load_types(){\n    global $wpdb;\n    $typesVal = $_GET[\"type_slug\"];\n\n    foreach($typesVal as $k => $v){\n        add_query_arg( $k, $v);\n    }\n\n    wp_die();\n}\n\n\nA: This really needs more context in what apple and banana are referring to and what you're trying to accomplish and how you've already tried to accomplish it...\nYou could do a custom query and set the parameters in terms based on whatever was selected in the multiple choice. This is assuming that A. fruit is a CPT and that B. \"apple\" and \"banana\" are custom taxonomies of \"type\" associated with the fruit CPT.\n$args = array(\n    'post_type' => 'fruit',\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'type',\n            'field'    => 'slug',\n            'terms'    => array( 'apple', 'banana' )\n        )\n    )\n);\n$query = new WP_Query( $args );\n\nNew queries can cause issues with pagination if that's a concern so use with caution.\nYou may also want to consider checking out the pre_get_posts filter, here is an article/question-answer thread that helped me get a form with custom options that queries a CPT and it's taxonomy set up: Wordpress custom search form with pre_get_posts not work\n(just noticed the ajax part)\nYou can also make requests through the wp api and get back multiple categories from a post type like so:\n/wp-json/wp/v2/posttype?category=3,4\n\nReplace posttype with your post type name and category with the taxonomy name you are trying to access, finally replace 3,4 with whatever the ID's of the category are. So your query might look something like below, assuming fruit is the name of the post type and 5 is the ID of apple and 9 is the ID of banana ( for example )\n/wp-json/wp/v2/fruit?category=5,9\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404518", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress : how to allow a user to post a module that leads any visitor to a product page ? (front end) My current WP configuration\nTheme used : DIVI Extensions in place : Almost none  Name of the host : Infomaniak Site address : not yet created\nProblem(s) encountered :\nHello,\nFirst of all, thank you to all those who will take the time to read this post and to give me their help. I'm currently starting a website that I'm very interested in and there is one feature in particular that I don't really know how to implement.\nI will try to be as clear as possible so that it is easy to understand.\nI want to allow some people who visit my site to be able to create an account on it. So far, nothing special, I simply want these people with their account to be able to generate, modify and delete a block or module (I use DIVI) from a form in their \"account\" space, which would go on the home page of the site (only from the front end so without accessing wordpress admin). This block would display the information contained in the form as well as, for example, the profile image of the user who filled in the form. Furthermore I would like this block, when clicked on, to lead users of the site, whether they have an account or not, to a \"product presentation\" page whose information depends once again on the information filled in the form. And finally, I would like a user to be able to purchase the product from this page and, at the end of the purchase, download a document whose content would also depend on the fields from the initial form. Of course, if the user deletes the block, the \"product presentation\" page would also have to be deleted to avoid overloading the site unnecessarily. And if the block is modified, the information on the \"product presentation\" page should also be modified, as well as the downloadable document at the end.\nI know that this may seem a bit complicated but I have thought about it and I would really like to do it. I've already made a site with Wordpress but  it was a very simple site with no user space where I just posted articles that you could read.\nI already tried to look at some plugins on the right and left, I saw that WP forms for example allowed a user with an account to post I've already tried to look at some plugins on the left, I saw that WP forms for example allowed a user with an account to post a \"blog post\" on the site but what I want to do is a little different I want the user to be able to create a kind of block or module containing some information filled in beforehand by a form and which would be in fact a link to a \"product presentation\" page generated automatically.\nI hope I have not been too long and that I have been clear. I am aware that this question is probably aimed at an audience already experienced with Wordpress. Thank you in advance for your answers.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404519", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change letters for day name When I use this code the name of the day been writed with a small letter.\nget_the_time(strtotime($DateValue)), \nget_the_time('l d.m.Y H:i', $post)\n\nI want the name of the day looking like this:   Monday, Sunday, Thursday etc.\nNow it look like this  monday, sunday\nWhat do I do wrong ?\n\nA: In the comments, @vancoder points out that it appears day names are not capitalized in Norwegian. If you require that they be capitalized, you could do something like this:\nucfirst( get_the_date( 'l', $post ) ) . \nget_the_date( ' d.m.Y', $post ) . \nget_the_time( ' H:i', $post );\n\n...using PHP's ucfirst() to force the first character to be uppercased.\n(I've also split the date and time to use get_the_date() and get_the_time(), since it seemed semantically cleaner to me that way.)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404521", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WooCommerce Meta I have 4 fields names date_1, date_2, date_3, date_4 which are not always displayed to the customer on checkout (Plugin: Custom Field Editor). One of these 4 meta-fields exists and the other 3 don't even exist. Until the customer confirms the order, i don't know which will be filled in and which will be empty.\nI would like to afterwards take the date filled in, and put it in a new meta field: date-final\nHow can i hook to the confirm order button press (after validation please, only if the payment gets accepted and the order gets automatically transferred to \"In Progress\").\nAnd then read the value out of the 4 fields and put it in a newly created field?\nThanks an best Regards\nSorry, i'm still starting with developing myself and therefor have some difficulties.\nBest Regards\nFlorin\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404522", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Query multiple taxonomies with pre get posts I am trying to query a custom post type based on what a user inputs into a form, I am having trouble querying multiple taxonomies in pre_get_posts filter, I can't seem to find a way to set the query more than one taxonomy\nfunction custom_search( $query ) {\nif ( is_archive('experts') && $query->is_main_query() && !is_admin() ) {\n\n    $keyword = get_query_var( 'keyword', FALSE );\n    $industry_select = strtolower(str_replace(' ', '-', get_query_var( 'industry_select', FALSE ) ));\n    $speciality_select = strtolower(str_replace(' ', '-', get_query_var( 'speciality', FALSE ) ));\n  \n    // Keywords query\n    $keyword ? $keyword : $keyword = null;\n\n    $query->set('s', $keyword);\n    \n    // Taxonomies query\n\n    $tax_query_array = array('relation' => 'OR');\n    $speciality_select ? array_push($tax_query_array, array('taxonomy' => 'experts_specialities', 'field' => 'slug', 'terms' => $speciality_select) ) : null ;\n    $query->set( 'tax_query', $tax_query_array);\n\n    $tax_query_array = array('relation' => 'OR');\n    $industry_select ? array_push($tax_query_array, array('taxonomy' => 'experts_industries', 'field' => 'slug', 'terms' => $industry_select) ) : null ;\n    $query->set( 'tax_query', $tax_query_array);\n}}\nadd_action( 'pre_get_posts', 'custom_search' );\n\nIn the past I have written queries that look like the following that successfully look in two taxonomies (eventually I need to have 3 taxonomies though)\n$featured_args = array(\n    'post_type'  => 'experts',\n    'hide_empty' => false ,\n    'paged'      => $paged,\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'experts_industries',\n            'field' => 'slug',\n            'terms' => $broad_match_ind\n        ),\n        array(\n            'taxonomy' => 'experts_specialities',\n            'field' => 'slug',\n            'terms' => $broad_match_spec\n        )\n    )\n);\n\nI'm trying to use pre_get_posts because I ultimately want the results of this query on an archive page and don't want to create a second query with a set of args ( as I am currently doing as evidenced by my second code example above )\nThanks in advance.\n\nA: \nI can't seem to find a way to set the query more than one taxonomy\n\nYou already found it, but the problem is, you should have not done this:\n$tax_query_array = array('relation' => 'OR');\n$speciality_select ? array_push($tax_query_array, ...) : null ;\n$query->set( 'tax_query', $tax_query_array);\n\n$tax_query_array = array('relation' => 'OR');\n$industry_select ? array_push($tax_query_array, ...) : null ;\n$query->set( 'tax_query', $tax_query_array);\n\n.. because the 2nd $query->set() call overrides the entire tax_query array that's set via the 1st $query->set() call.\nAnd to fix the issue, just remove the 1st $query->set() call and the 2nd $tax_query_array = array('relation' => 'OR');, i.e. lines 3 and 5 above.\nAlso, keep in mind that is_archive() does not accept any parameters. So if you wanted to check if the query is for a specific post type archive, use is_post_type_archive() instead, i.e. is_post_type_archive( 'experts' ).\nAnd.. I don't think the $keyword ? $keyword : $keyword = null; is necessary, so I'd just remove that and simply do $query->set('s', $keyword);.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404524", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Tax Query on product_cat using NOT IN as operator does not exclude that category Using the following code, I expect $items to not include products with the product category \"stones.\" However, that is not the result. It doesn't seem to be excluding that category at all. Syntax looks right - are there other reasons why WordPress wouldn't respect this \"NOT IN\" statement?\n$tax_query = array(\n    array(\n        'taxonomy'         => 'product_cat',\n        'terms'            => array('stones'),\n        'field'            => 'slug',\n        'operator'         => 'NOT IN',\n    ),\n);\n$args = array(\n            'post_type' => 'product',\n            'posts_per_page' => -1,\n            'tax_query' => $tax_query\n        );\n$items = new WP_Query( $args );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404525", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add registration date and last login date to user list page To assist with managing a WordPress install with a large number of users, is there a simple way to include the date the user registered and they date they last logged in as additional columns on the user list page? Can these columns be sortable?\n\nA: The registration date is kept in the wp_users table, so that's easy to get.\nThe last login date is a little trickier. Most plugins which implement a last login date column create a custom meta field to store it (in wp_usermeta), update it every time the user logs in, and retrieve it for display on the user list screen. However, WordPress already stores login dates (and related session information) in a meta field called session_tokens, so if you don't need last login date to be sortable, you can extract the last login date from this array rather than storing it separately.\n// add two columns to the user list page\nadd_filter( 'manage_users_columns', 'my_manage_users_columns' );\nfunction my_manage_users_columns( $columns ) {\n    $columns['registration_date'] = 'Registered';\n    $columns['last_login_date'] = 'Last Logged In';\n    return $columns;\n}\n\n// provide data for the two added columns\nadd_filter( 'manage_users_custom_column', 'my_manage_users_custom_column', 10, 3 );\nfunction my_manage_users_custom_column( $row_output, $column_id_attr, $user ) {\n    $date_format = 'Y/m/d \\a\\t g:i a';\n    $d1 = 0;\n    switch ( $column_id_attr ) {\n        case 'registration_date':\n            $d1 = strtotime(get_userdata($user)->user_registered);\n            break;\n        case 'last_login_date':\n            $session_tokens = get_user_meta( $user, 'session_tokens', true );\n            if (!empty($session_tokens)) {\n                $d1 = max(array_column(array_values($session_tokens),'login'));\n            }\n            break;\n        default:\n    }\n    if ($d1 > 0) {\n        $d2 = new DateTime(\"@$d1\");\n        return $d2->setTimezone(wp_timezone())->format($date_format);\n    }\n    return $row_output;\n}\n\n// make the registration date column sortable\nadd_filter( 'manage_users_sortable_columns', 'my_manage_users_sortable_columns' );\nfunction my_manage_users_sortable_columns( $columns ) {\n    return wp_parse_args( array( 'registration_date' => 'registered' ), $columns );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404526", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Unset all main menu items except those with $menu_object->title == 'x' Instead of listing all the menu items to remove. How to remove all main menu items except those with specific title?\nREMOVE ALL MENU ITEMS EXCEPT $menu_object->title == '#request-mockup#'\nif ( ($menu_object->title == 'About') || ($menu_object->title == 'Locations') )  { unset($sorted_menu_objects[$key]);\nadd_filter('wp_nav_menu_objects', 'ad_filter_menu', 10, 2);\nglobal $post, $product;\nfunction ad_filter_menu($sorted_menu_objects, $args) {\n   if ( is_page( array( 'wholesale', 'request-mockup' ) ) || has_term( 'wholesale', 'product_cat' ) ) {\n       if ($args->theme_location != 'avia')  \n       return $sorted_menu_objects;\n         foreach ($sorted_menu_objects as $key => $menu_object) {\n\n         // INSTEAD OF LISTING THE MENU ITEMS TO REMOVE\n         // REMOVE ALL MENU ITEMS EXCEPT $menu_object->title == '#request-mockup#'\n           if ( ($menu_object->title == 'About') || ($menu_object->title == 'Locations') )  {\n           unset($sorted_menu_objects[$key]);\n           break;\n    }\n} \n}\n\nelse {\n  if ($args->theme_location != 'avia')  \n    return $sorted_menu_objects;\nforeach ($sorted_menu_objects as $key => $menu_object) {\n    if ($menu_object->title == '#request-mockup#') {\n        unset($sorted_menu_objects[$key]);\n        break;\n    }\n}\n}\nreturn $sorted_menu_objects;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404528", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom post archive page not opening 404 page I have custom post type like this\nregister_post_type( 'workforce_archive',\n        array(\n            'labels' => array(\n                'name' => __( 'Workforce Archives' ),\n                'singular_name' => __( 'Workforce Archive' )\n            ),\n            'public' => true,\n            'has_archive' => true,\n            'rewrite' => array('slug' => 'workforce_archive'),\n            'show_in_rest' => true,\n            'show_in_menu' => false,\n            'supports' => [ 'title', 'editor', 'author' ]\n        )\n    );\n\nAnd also have a file archive-workforce_archives.php but still I am getting 404 page when visit this URL \"http://taliestrategies.local/workforce_archives\".\nAny help is appreciated.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404532", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Cascading dropdown select search based on Parent Page & Child Page How would I create a cascading dropdown select search where the first dropdown would host selected Parent Pages and the second to display the Child Pages of the selected Parent. When submit button is clicked it would just redirect to the selected child page.\nCould anyone please help me on how to get this done, I've done the research and haven't gotten anywhere apart from only displaying all specific Parent pages that's needed in 1 dropdown using the code below:\n<li id=\"pages\">\n    <h2><?php _e('pages:'); ?></h2>\n    <form action=\"<?php bloginfo('url'); ?>\" method=\"get\">\n        <?php wp_dropdown_pages( array(\n          'include' => array( 119, 467, 857, 1027, 404 ), // Array of page IDs to include.\n        ) ); ?>\n    <input type=\"submit\" name=\"submit\" value=\"view\" />\n    </form>\n</li>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404533", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Populate dropdown with Child Pages based on Parent Page chosen I'm trying to populate the Child Page dropdown with that of the selected Parent Page - If a specific Parent page is chosen it should fill the second dropdown with all Child pages listed under that parent.\nOnce the submit button is clicked, it would then direct users to the selected child page.\nIn the first dropdown, I've pulled the necessary Parent pages based on their page ids. I'm stuck from here. What do I do to achieve getting the secondary dropdown 100% working?\n<div id=\"pages\">\n    <h2><?php _e('pages:'); ?></h2>\n    <form action=\"<?php bloginfo('url'); ?>\" method=\"get\">\n\n        <!-- Parent Page dropdown -->\n        <?php wp_dropdown_pages( array(\n          'include' => array( 119, 467, 857, 1027, 404 ), // Array of Parent Page IDs to include.\n        ) ); ?>\n\n        <!-- Child Page dropdown -->\n        <?php wp_dropdown_pages( array(\n          'include' => array( ), // Array based on selected Parent Page.\n        ) ); ?>\n\n    <input type=\"submit\" name=\"submit\" value=\"view\" />\n    </form>\n</div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404535", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Translation for frontend In my plugin I have many strings to translate for the backend and only a few for the frontend. For the visitors of the website it is nicer to read the words in the language of the site. Is there a more elegant way to mark for the translators which words appear in the frontend or backend than _x:\n_x(\"string to translate\", \"In Frontend\", \"text-domain\")\nThank you very much.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404537", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Save all the post tags inside a custom field I'm having some trouble to add_post_meta using the code below with all the post tags inside a custom field.\nThe code works to echo all the tags, but not for saving them because it only saves the first tag of the post.\n$all_post_tags = get_the_tags();\n   \n    $count=0; $comma_sep = ', ';\n\nif ($all_post_tags) {\nforeach($all_post_tags as $tag) {\n$get_all_tags = $tag->name . $comma_sep;\n\nadd_post_meta($post->ID, 'all_tags', $get_all_tags, true);  \n\n    }\n}  \n\nWhat's wrong with this code?\n\nA: To start, why do you want to have your tag data in tags and also in a custom field? Seems to me like there is no reason for this, but maybe I'm missing something.\nTo answer your question about the code you have.. inside your foreach you overwrite the value each time in the loop. Instead of overwriting, you should add new tags to your predefined variable. Try this:\n$all_post_tags = get_the_tags();\n$count = 0;\n$comma_sep = ', ';\n\nif ( $all_post_tags && !empty($all_post_tags) ) {\n\n    $get_all_tags = '';\n\n    foreach ( $all_post_tags as $tag ) {\n        $get_all_tags .= $tag->name . $comma_sep;\n    }\n\n    add_post_meta($post->ID, 'all_tags', $get_all_tags, true);\n\n} \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404539", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can't add user- wrong message \"this user name is invalid because it uses illegal characters\" I am working on a webpage for a client and we have encounter a weird issue. When I use the clients login and add users to the website It works perfectly.\nBut when the client uses the same logins they get the wrong message \"this user name is invalid because it uses illegal characters. Please enter a valid username\".\nWhat could go wrong here? Is there a setting on the clients computer?\nI would appreciate any help.\n\nA: You haven't specified the username so it is possible there are illegal characters in the name. I would check that first.\nTo give a possible solution, please check this answer as it seems to be the same question: https://wordpress.stackexchange.com/a/189172/168537\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404544", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Home page url rewriting Wordpress 0\nI want to do a URL rewrite in the WordPress home page\nI want to change my URL http://mysite.loc/?pays=senegal to look like http://mysite.loc/senegal.\nThe problem is that I am on the WordPress home page, so it will be confused with the URL of another page like http://transfert.loc/page-example.\nI have already tried several optins but am completely blocked.\nHere is my code example:\npublic function rewrite_urls(){\n    \n     add_rewrite_tag( '%pays%','([^&]+)' );\n     \n     add_rewrite_rule(\n        '([^/]+)',\n        'index.php?pays=$matches[1]',\n        'top'\n    );\n}\n\nCan someone help me please!\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404545", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get access to variable from previous pageview, excluding ajax-calls I want to generate a random string, and get it passed to the next pageview.\nI currently have the following code:\n  add_action('init', 'set_global_pixelcapival');\n  function set_global_pixelcapival() {\n\n      global $pixelcapival;\n      $pixelcapival = pixelcapival();\n\n      global $prev_pixelcapival;\n      $prev_pixelcapival = '';\n\n      if(isset($_COOKIE['pixelcapival'])) {\n         $prev_pixelcapival = $_COOKIE['pixelcapival'];\n      }\n\n      setcookie('pixelcapival', $pixelcapival, time() + 1200, '/');\n }\n\nI can now get access to $pixelcapival from the previous pageview by\nglobal $prev_pixelcapival\n\nBut if any ajax-calls are being made in between, i guess the ajax-call triggers the init-action, and i don\u00b4t get the value i want.\n(The ajax-call is in this case made by a plugin, when clicking a submit-button)\nIs there any easy way to prevent this? A hook that isn\u00b4t triggered by ajax calls?\n\nA: I found out you could identify ajax requests by the following if-statement\nif (defined('DOING_AJAX') && DOING_AJAX) \n\nSo problem solved using\nadd_action('init', 'set_global_pixelcapival');\nfunction set_global_pixelcapival() {\n  if (defined('DOING_AJAX') && DOING_AJAX) { \n    \n  } else {\n    global $pixelcapival;\n    $pixelcapival = pixelcapival();\n\n    global $prev_pixelcapival;\n    $prev_pixelcapival = '';\n\n    if(isset($_COOKIE['pixelcapival'])) {\n        $prev_pixelcapival = $_COOKIE['pixelcapival'];\n    }\n    setcookie('pixelcapival', $pixelcapival, time() + 1200, '/');\n  }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404546", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Best approach to make all tags searchable by the wordpress search function I have over 2000 tags on one of my sites and I like them to be searchable by the wordpress search function.\nThe problem is if I use a plugin, the time it takes to search them all is enormous.\nI think on a possible solution that would be to add them (post tags) all inside a custom field and use a plugin to make it search on that custom field on all posts.\nBut as I'm not a great expert in wordpress I would like to have a more endorsed opinion.\nWhat do you think?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404547", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Redirect WordPress domain.com/?anyword to 404 Page? Recently I Found some error on WordPress sites that when someone enter a question mark after the root domain and type any word, url shows the Home Page of instance:\nFor instance, Root Domain is abc.com abc.com/?anyword should be reached on the 404 not found page which shows the home page.\nI need help with this Issue:\nhttps://www.iadm.edu.pk/?anyword should be redirected to the 404 not found page.\n\nA: It is, in most cases, a logical thing to show the homepage even when there are querystrings available. Never the less, I'm assuming you have a reason for this. You could try code below to redirect your visitors to your 404 page:\nif ( isset($_GET) ) {\n    global $wp_query;\n    $wp_query->set_404();\n    status_header( 404 );\n    get_template_part( 404 );\n    exit();\n}\n\nKeep in mind that some other functionality might break because of this. You may want to add some additional conditionals.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404552", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Access generated thumbnails Is it possible to allow my editors to access the generated media thumbnails within the media library?\nSo for example, when a user selects an image, they should be able to also select the thumbnail size that should be used:\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404555", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Block patterns: Any way to reset the pattern to whatever is in the code? We've been working with block patterns.\nSo we built the blocks, for instance, with Divs as the structure. But the client comes back 'for accessibility, we need the structure to be UL/LI.\nSo we modify our code, but some blocks are already added in the site, and it doesn't look like they are updating.\nIs there a way to force WP ro regenerate blocks by keeping the content, but changing the structure around it?\n\nA: It would heavily depend on your block layout and how you format your block data & inner blocks.\nWhen using the deprecation, you just need to think of it like making an acceptable format to recognise your old markup, with a migrate function if you need to help the conversion along.\nAdd all your old attributes and if you need to do anything more complicated (like parsing and converting inner blocks, or adding attributes etc... then use the migrate function.\nconst { registerBlockType } = wp.blocks;\n\nregisterBlockType('gutenberg/block-with-deprecated-version', {\n    // ... other block properties go here\n\n    attributes: {\n        content: {\n            type: 'string',\n            default: 'some random value',\n        },\n    },\n\n    save(props) {\n        return <ul>{{{ -- new block save stuff -- }}}</ul>;\n    },\n\n    deprecated: [\n        { // Essentially a copy of your old attributes and save function goes here\n            attributes: { // These will be the 'old' attributes - \n                content: {\n                    type: 'string',\n                    default: 'some random value',\n                },\n            },\n\n            save( props ) {\n                return <div>{{{-- OLD block save stuff -- }}}</div>; \n            },\n        },\n    ],\n});\n\nThere are some examples shown on the Codex\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404556", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to fetch woocommerce highest price and lowest price in custom template page? $max_query = new WP_Query( array( 'post_type' => 'product', 'post_status' => 'publish', 'orderby'=>'meta_value_num', 'order'=>'DESC','meta_key'=>'_price','posts_per_page'=>1) );\nif(have_posts()){\nwhile ($max_query->have_posts()){\n$max_query->the_post();\n$maxp = get_post_meta( get_the_ID(), '_price', true );\n}\nI am using this and its worked perfectly but how to retrieve max or min price woocommerce without using wp query? actually I am using it for price range slider(dynamically).\n\nA: This should do the job.\n$products = get_posts(array(\n    'post_type' => 'product',\n    'post_status' => 'publish',\n    'orderby' => 'meta_value_num',\n    'meta_key'=> '_price',\n    'posts_per_page' => -1,\n));\n\n$highest = $products[array_key_first($products)];\n$lowest = $products[array_key_last($products)];\n\n$highest_price = get_post_meta( $highest->ID, '_price', true );\n$lowest_price = get_post_meta( $lowest->ID, '_price', true );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404557", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress wp_remote_post vs wp_remote_request I'm somehow new to Wordpress and its API and while writing an simple Rest Service to an remote Server i have been asked to use the native wp_remote_X functions.\nRight now i have some trouble to distinguish between them both:\nwp_remote_post() \n\nwp_remote_request().\n\nDoes it make any difference which one to use or is the wp_remote_request an alias to missing wp_remote_delete() and wp_remote_update() ?\n\nA: You should be able to use both wp_remote_request() and wp_remote_post() for a 'POST' request, as they are just wrappers for the same WP_Http::request method that supports the methods:\n'GET', 'POST', 'HEAD', 'PUT', \n'DELETE', 'TRACE', 'OPTIONS', 'PATCH'.\n\nand the default one is 'GET'.\nThe difference is that wp_remote_post() function has the 'POST' method explicitly set via WP_Http::post that's also a wrapper for WP_Http::request.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404560", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: WordPress REST API not working on localhost I have a WordPress site running WordPress 5.9.3 that is using a React-based theme, which uses the REST API (v1), to retrieve content and menus from the standard WordPress CMS back-end.\nHowever, when trying to install it locally, I can't get the API to work and retrieve the needed data.\nI'm using a Docker environment based off this repo: https://github.com/kassambara/wordpress-docker-compose\nSince the theme uses React and the REST API to get the site content, trying to view the site gets stuck on the loading screen.\nThese are the console errors:\nGET http://localhost:3000/wp-json/{REDACTED_API_NAME}/v1/site net::ERR_CONNECTION_REFUSED\nGET http://localhost:3000/wp-json/{REDACTED_API_NAME}/v1/menus?location=main-menu net::ERR_CONNECTION_REFUSED\nGET http://localhost:3000/wp-json/{REDACTED_API_NAME}/v1/menus?location=footer-menu net::ERR_CONNECTION_REFUSED\n\nAnd here is a stack trace of the first one, for reference if it helps:\n(anonymous) @   VM382:1\nfetchSiteInformation    @   bundle.ea81906\u2026.js:2499\nfetchInitialContent @   bundle.ea81906\u2026.js:2535\n(anonymous) @   bundle.ea81906\u2026.js:5653\n(anonymous) @   bundle.ea81906\u2026.js:13750\n(anonymous) @   bundle.ea81906\u2026.js:12811\ncomponentWillMount  @   bundle.ea81906\u2026.js:18846\nNg  @   bundle.ea81906\u2026.js:12158\nfi  @   bundle.ea81906\u2026.js:12197\nRj  @   bundle.ea81906\u2026.js:12284\nQj  @   bundle.ea81906\u2026.js:12267\nKj  @   bundle.ea81906\u2026.js:12267\nyj  @   bundle.ea81906\u2026.js:12260\nIg  @   bundle.ea81906\u2026.js:12251\nbk  @   bundle.ea81906\u2026.js:12302\n(anonymous) @   bundle.ea81906\u2026.js:12305\nNj  @   bundle.ea81906\u2026.js:12261\nik  @   bundle.ea81906\u2026.js:12305\nexports.render  @   bundle.ea81906\u2026.js:12311\n(anonymous) @   bundle.ea81906\u2026.js:11350\n__webpack_require__ @   bundle.ea81906\u2026.js:20\n(anonymous) @   bundle.ea81906\u2026.js:63\n(anonymous) @   bundle.ea81906\u2026.js:66\n\nwebpack itself compiles with warnings.\nThe webpack-dev-server is running off port 8081, and phpmyadmin is running off 8080.\nI tried to switch the webpack server to use port 3000 instead (to match what the API is calling), but that didn't help.\nI can log into WP admin and am having no issues on that side. All content and plugins are present.\nThis is not an issue on production or UAT environments, nor is it occurring with others on their own local machine.\nI'm running Mac Monterey with the Apple M1 chip.\n\nA: Just had this same problem and checked other threads and this really worked:\nin the AdminPanal => Settings -> Permalinks -> change from 'default' to 'Post name' then Save Permalinks and reload your api url and it should be working now.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404561", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Featured Image and Tags problem I am very new to PHP and am having an issue with an amazing advanced Wordpress tutorial which showed how to use ACF and functions.php to scrape and import the data directly into my Animal Shelter theme. The api is scraped and a majority of the data is imported however the featured image is causing issues, as are the tags.\nThe way the animals images are retrieved is with a set url with the animal ID at the end and I wish to simply place the relevant image for the relevant animal in each record.\nHere is my code:\n$animals[] = $results;\n\nforeach( $animals[0] as $animal ){\n\n    $animal_slug = sanitize_title($animal->ANIMALNAME . '-'. $animal->ID);\n\n    **$animalID_REF = get_field('ID');\n    function filter_post_thumbnail( $html ){\n        if ('' == $html){\n            return'<img src=\"https://eur02b.sheltermanager.com/service?account=bp****&method=animal_image&animalid=<?=$animalID_REF;?>\" />';\n        }\n        //Else, return the post thumbnail\n        return $html;\n    }\n    add_filter( 'post_thumbnail_html','filter_post_thumbnail' );**\n\n    $animal_title = sanitize_title($animal->ANIMALNAME);\n\n    **$animal_tag = sanitize_title($animal->PETFINDERSPECIES);**\n\n    $existing_animal = get_page_by_path($animal_slug, 'OBJECT', 'project');\n\n    if( $existing_animal === null){\n\n    $inserted_animal = wp_insert_post([\n        'post_name' => $animal_slug,\n        'post_title' => $animal_title,\n        **'pj-tags' => $animal_tag,**\n        'post_type' => 'project',\n        'post_status' => 'publish'\n    ]);\n\n    if( is_wp_error( $inserted_animal) ){\n        echo $inserted_animal->get_error_message();\n    }\n    \n    $fillable = [\n\n        'field_62308905b1063' =>'ANIMALNAME',\n        'field_6230967891d2d' =>'PETFINDERSPECIES',            \n        'field_62308905b4b0d' =>'ID',\n        'field_62308905b857f' =>'BREEDNAME',\n        'field_623096f191d2e' =>'SEXNAME',\n        'field_624956d21e12a'=>'ANIMALAGE',\n        'field_6230970a91d2f' =>'AGEGROUP',\n        'field_6230972591d30' =>'ISGOODWITHCHILDRENNAME',\n        'field_6230973191d31' =>'ISGOODWITHCATSNAME',\n        'field_6230973e91d32' =>'ISGOODWITHDOGSNAME',\n        'field_6230974b91d33' =>'ISHOUSETRAINEDNAME',\n        'field_6230975a91d34' =>'ISNOTAVAILABLEFORADOPTIONNAME',         \n        'field_62309281825e3' =>'LASTCHANGEDDATE',\n        'field_6239ff0adeea3'=>'ANIMALCOMMENTS',\n        'field_6246dbde5e610'=>'WEBSITEIMAGECOUNT',\n        'field_62496a5963458'=>'SPECIESNAME',\n        'field_6249c945648fc'=>'HASACTIVERESERVENAME',\n        'field_6249c964648fd'=>'HASTRIALADOPTIONNAME'\n    ];\n\n    foreach( $fillable as $key => $name){\n        update_field( $key, $animal->$name, $inserted_animal );\n    }\n}else {\n\n   $existing_animal_id = $existing_animal->ID;\n   $existing_animal_timestamp = get_field('LASTCHANGEDDATE', $existing_animal_id);\n\n   if( $animal->LASTCHANGEDDATE >= $existing_animal_timestamp){\n        //update our post meta\n   }\n\n}\n\nAs you can see I tried using get_FIELD ID from ACF to reference the animal and add its ID to the end of the URL but as you may be able to tell I was way off from ever managing to display the animals from their external URL in WP. Incidentally I do have a plugin called FIFU to reference external urls but again unsure how I would incorporate this in this instance.\nMy second failure comes in the form of tags and my theme uses pj-tags for it\u00b4s tags. Again I tried populating these from the ACF fields, in this case PETFINDERSPECIES.\nCan anyone steer me in the right direction please?\n\nA: For adding the ID at the end of the URL being generated in yout filter_post_thumbnail function you would use concatenation to append the variable to the end of the URL in the return statement.\nreturn'<img src=\"https://eur02b.sheltermanager.com/service?account=bp****&method=animal_image&animalid=\"' . $animalID_REF . '\"/>';\n\nAlso you'll need to upload the image to the media library and then set it as a featured image or create a ACF field and add it to that field somehow. The filter post_thumbnail_html isn't going to set the posts featured image for you. You can read more about the post_thumbnail_html in the docs here: https://developer.wordpress.org/reference/hooks/post_thumbnail_html/\nThere is a answer/question thread that touches on that topic here: How do I set a featured image (thumbnail) by image URL when using wp_insert_post()?\nRegarding the tags, pj_tags is not a parameter of wp_insert_post the parameter for inserting tags through wp_insert_post would be tags_input\nYou can read more about that function on the WP docs: https://developer.wordpress.org/reference/functions/wp_insert_post/\nCheck out the docs to better understand what the filters and functions you're using are doing and what is available to you within them.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404566", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP_Query for woocommerce products with a pattern as a post_title I am trying to make a wp query for woocommerce products. This will be implemented for a search bar, so the consumer can search for a desired product.\nMy first go was this:\n$args = array(\n   'post_type' => 'product',\n   'post_status' => 'publish',\n   'posts_per_page' => -1,\n    's' =>  $searchField,\n);\n    \n$loop = new WP_Query($args);\n\nUnfortunately, this returns every product related with the search field, even if its only referred in product description and not in post_title\nMy goal is to search only in post_title but 's' parameter returns everything related to it.\nMy second go, was to something like this:\n$args = array(\n   'post_type' => 'product',\n   'post_status' => 'publish',\n   'posts_per_page' => -1,\n   'name' =>  $searchField,\n);\n\nWell, this, does search in post_title but you have to right the exact post_title to bring up results.\nI tried modifying like this:\n'name' => `%${searchField}%`\n\nBut it didn't work.\nAlso tried this 'post_title' => `%${searchField}%` but this returns ALL products.\nDoes anyone know any other specific argument that I can achieve this? Or any other way at all?\nThank you all for reading this!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404570", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom css - Wordpress Multisite I'm using Worpdress 5.9.3 version.\nWhen I try to make changes to the additional css on my Wordpress Multisite, I get an error message saying: \"Something seems to be wrong. Wait two seconds then please try again.\"\nI'm the super-admin of the multisite website. I also installed the Multisite Custom CSS plugin but it didn't fixed the issue.\nI found the custom css style sheet in the database (in wp_posts)but I'm scared to edit it...\nI read it could come from the \"WP_optimizer\" plugin but I don't have it, I only have \"SiteGround Optimizer\".\nWhat are my other options? or what are the risks to edit directly the css from the database?\nThank you for your help\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404572", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I add a field for featured image on backend of a custom Taxonomy? I came accross this problem when trying to create a new wordpress Theme,\nI want to add a custom term field for featured images on the backend of a custom taxonomy,\nI have followed this tutorial and managed to add the field, but this is just a plain text field.\nIs there any source of code or any suggestions on how could I \"code\" myself a featured image field?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404574", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP Multisite - Additional subdomain on the site for API purposes We have WP multisite network with WooCoomerce shops. All the network is served through Cloudflare CDN.\nOur ERP is accessing WooCommerce API of each website in the WP network. Since there so many, calls we are getting 503 from Cloudflare. It's not a server problem. It's a problem of too many requests to Cloudflare.\nSo what I would like to have is a separated subdomain (example: api.domain.com) for each domain in the network. That subdomain will not be proxied thru Cloudflare.\nHow to do I do that? How can I add an additional subdomain to a site on WP multisite network?\n\nA: I have resovled it myself.\nI have enabled sunrise in wp-config. Then add a script to sunrise.php to override HTTP_HOST.\nI made it dynamic since we have many websites. When you visit api.domainxy.com it automatically shows you domainxy.com.\n<?php\n$re = '/(?:api\\.)(.*)/m';\n$str = $_SERVER['HTTP_HOST'];\n\n\npreg_match_all($re, $str, $matches, PREG_SET_ORDER, 0);\n\nif ($matches && $matches[0][1] != \"\") {\n  $_SERVER['HTTP_HOST'] = $matches[0][1];\n}\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404575", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress database setup Windows 2016 IIS We've been assigned by new company owner to get Wordpress running on a Windows 2016 server using IIS but we have NO experience using any of the elements, so we're dependent on instructions and help.\nWe began with a clean install of Windows 2016, then installed Wordpress prerequisites: PHP 8.0, VS 2019, Python 3.10, MySQL 8.0. Microsoft guidance which is 6 years out of date says to use Web Platform Installer to install Wordpress. It failed after trying to install older versions of every prerequisite that was already installed. So now apparently we have to install Wordpress manually.\nFollowing https://zaven.co/blog/install-wordpress-iis/ we installed Wordpress, and it opens to the setup screens which seems correct. But it is failing on the database setup screen. In MySQL Workbench, we created new empty model called 'wordpress' in the local database. Then we added a new user 'dba_wp', and granted all roles to it: owner, table.modify, routine.execute, table.insert, then saved the model. We didn't add table.readonly because that sounds like a limitation. Then we tried to establish the db connection to set up Wordpress using the following settings.\n- database name: wordpress\n- username: dba_wp\n- password: *****\n- database host: localhost\n- table prefix: wp_\nIt keeps failing with the generic \"Error establishing a database connection\".\nWe didn't get creative about a single step of this process, and it seems like it must be a fundamental issue since we haven't even completed setup, so what could be wrong?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404576", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP Query ordering on a meta field for posts with a date in the future not ordering by datetime I have a WP Query:\n$args = array(\n'post_type' => 'post',\n'post_status' => 'publish',\n'posts_per_page' => 5, \n'category__in' => $postCategories,\n'meta_query' => array(\n    array(\n        'key' => 'ordering_date',\n        'value' => date(\"Y-m-d H:i:s\"),\n        'compare' => '>=',\n        'type' => 'DATETIME',\n    ),\n),\n'order'     => 'ASC',\n'orderby'  => 'meta_value',\n'meta_key' => 'ordering_date',\n'meta_type' => 'DATETIME',\n\n);\n\n$query = new WP_Query($args);\n\nBased on the query I would expect:\n\n*\n\n*Post 1: with ordering_date of 2022-04-07 00:00:00\n\n*Post 2: with ordering_date of 2022-04-11 00:00:00\n\n*Post 3: with ordering_date of 2022-05-02 00:00:00\n\n*Post 4: with ordering_date of 2022-05-24 00:00:00\n\n*Post 5: with ordering_date of 2022-07-11 00:00:00\n\nBut instead, the order is:\n\n*\n\n*Post 3\n\n*Post 8\n\n*Post 9\n\n*Post 2\n\n*Post 4\n\nWhat is wrong with my query that is its not ordering the posts based on the ordering_date meta field?\nTIA\n\nA: The docs are a little vague in this area, but it should be possible to define your ordering value more succinctly:\n   $args = array(\n    'post_type' => 'post',\n    'post_status' => 'publish',\n    'posts_per_page' => 5, \n    'category__in' => $postCategories,\n    'meta_query' => array(\n        array(\n            'key' => 'ordering_date',\n            'value' => date(\"Y-m-d H:i:s\"),\n            'compare' => '>=',\n            'type' => 'DATETIME',\n        ),\n    ),\n    'order'     => 'ASC',\n    'orderby'  => 'meta_value_datetime',\n    'meta_key' => 'ordering_date',\n    );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404578", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Warning at top of website & top menu gone This warning  has appeared at the top of our website, and our top menu bar has disappeared:\nWarning: call_user_func_array) expects parameter! +~ be\na valid callback, function\n'smartwp_remove_wp_block_library_css' not found or\ninvalid function name in\n/home/customer/www/stpetersmedford.org/public_r\nincludes/class-wp-hook.php on line 307\nI don\u2019t know how to decipher this message nor how to fix the problem. Are the two things related (disappearance of top menu, this warning)?\nThank you for any help.\n\nA: This function, call_user_func_array() is called by add_filter() (or add_action()) that was not declared properly. Scan the code for something like:\nadd_filter('something', 'smartwp_remove_wp_block_library_css')\nto find the culprit. If you do find it and it wasn't something you added/changed, you will have to troubleshoot to determine why this function was not declared/found.\nThe top menu is still there - you can see it very faintly at the very top of the page as you mouse over the area just above the warning message.\nOne last thing - it looks like you have display_errors enabled, which is not good practice for a public facing website.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404579", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Access web server in local LAN using domain name instead of IP I'm new to wordpress\nI recently built a web server on my local machine, I managed to make it accessible to all users in my LAN via IP address. Is there a way to use domain name instead of IP address?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404581", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to set a 'page' as parent of a custom post type? For various reasons, I would like to use a 'page' in preference to an archive page for one of our custom post types and have this be reflected in the permalink structure. I am struggling to find out exactly how to do this.\nWhat needs to be achieved is a permalink structure that, when viewing a custom post, show as: mysite.com/[page-name]/[custom-post-type-single]\nI'd be extremely grateful for any help that can be offered.\nNB I have tried the Post Type Parents plugin but it does not work for me.\nThis tutorial is close but it requires you to set the parent page id for each post individually. My posts will all have exactly the same parent page.\nI have ACF Pro, if this can be harnessed to do the job.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404585", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Remove List Bullets How can I remove this dot ? \nNot critical, but enoying.\nIt something about List Bullets, but I can`t find out how to remove it.\n \nSe code below:\n     $items[] = sprintf(\n    '<li>\n      %s\n      <div class=\"snup_custom_title\">%s</div>\n      <div class=\"snup_text\">%s</div>\n      <div class=\"snup_published\">%s</div>\n      <div class=\"snup_day\">%s</div> \n      <div class=\"snup_time\">%s</div>\n    </li>',\n    get_the_post_thumbnail($post),\n    esc_html( $post->snup_custom_title ),\n    esc_html( $snuptext ),\n    esc_html__('Published:', 'snup-lang'),\n    get_the_time(strtotime($DateValue), 'snup-lang'), \n    get_the_time('l d.m.Y H:i', $post),\n  );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404586", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Include current post into loop I have a related posts loop ( in every single post page ) based on post title. source : https://wpza.net/get-related-posts-based-on-the-posts-content-in-wordpress/\nBut I also need to include current post into this loop 'post__in' => $similar, . Please can anyone help me how can I do this\nfunction custom_related_posts() {\n     $current_id = get_the_ID();\n      $current_content = get_the_title( $current_id );\n     $similar = array();\n     $scores = array();\n     $percentage = 0;\n     $output = '';\n\n     function compare_content( $current_content, $comparison_content ) {\n          $current_content = trim( strtolower( $current_content ) );\n          $comparison_content = trim( strtolower( $comparison_content ) );\n          similar_text( $current_content, $comparison_content, $percentage );\n          $formated_percents = number_format( $percentage );\n          return $formated_percents; \n     }\n\n     $args = array(\n          'post_type' => 'product',\n          'posts_per_page' => -1\n     );\n     $loop = new wp_query( $args );\n     while( $loop->have_posts() ) {\n          $loop->the_post();\n           $score = compare_content( $current_content, get_the_title() );\n          if ( $score > 90 && get_the_ID() != $current_id ) {\n               array_push( $similar, get_the_ID() );\n               array_push( $scores, $score );\n          }\n     }\n     wp_reset_query();\n\n     array_multisort( $scores, SORT_NUMERIC, SORT_DESC, $similar );\n\n     if ( ! empty( $similar ) ) {\n          $args = array(\n               'post_type' => 'product',\n               'posts_per_page' => 100,\n               'post__in' => $similar,\n               'orderby' => 'meta_value_num',\n'order' => 'asc',\n'meta_key' => '_price'\n          );\n          $loop = new wp_query( $args );\n          $i = -1;\n          while ( $loop->have_posts() ) {\n               $loop->the_post();\n               $i++;\n               echo do_shortcode('[wbcr_snippet id=\"22379\"]') ; echo  '<div class=\"ai\">'. $scores[$i] .'% oxsar mehsul</div>'; \n          }\n          wp_reset_query();\n     }\n     return $output;\n}\n\n\nA: I'm not sure why you'd want a post you're already looking at to be in the similar... but off topic I guess.\nYou ask it not to include the $current_id in this line here\nif ( $score > 90 && get_the_ID() != $current_id ) {\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404589", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Thumbnails generated from PDF in the \"Media\" section - how to show them in theme template? I have an ACF custom field for \"File\". It allows users to upload PDF files of some reports.\nIn the Media section in WP Admin, I can see that the PDF we upload auto-generates the thumbnails.\nOn the frontend, in my theme for the website, when I try to see the files array from the custom field, there's nothing related to the file that contains its thumbnail. Is there some way I can access the thumbnail for the PDF?\nI know I can generate this myself using imagick or GD, but I'd like to leverage what WP has already done.\n\nA: To get the attachment's icon, you can use wp_get_attachment_image().\nFor example, let's say I've uploaded a Word doc and it's got the ID 1234:\n // Parameter 3 - 'true' - tells WP to treat this as an icon.\n $img_tag = wp_get_attachment_image( 1234, 'thumbnail', true );\n // $img_tag contains:\n //   <img width=\"48\" height=\"64\"\n //        src=\"http://example.com/wp-includes/images/media/document.png\"\n //        class=\"attachment-thumbnail size-thumbnail\"\n //        alt=\"\" loading=\"lazy\"\n //   />\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404598", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Display alert on successful user Sign Up I think wordpress used to automatically redirect to a page with a message telling a newly registered user to check their email box to activate their account.\nFor some reason, when a new person registers now, they are automatically redirected to the home page with no alert or message. I've been trying to get wordpress to display an alert to the user after clicking \"Sign Up\" with:\nadd_action('user_register','check_your_email');\n\nfunction check_your_email(){\n    echo \"<script>\n    alert('There are no fields to generate a report');\n    </script>\";\n}\n\nBut the function above seems to have no effect at all. How can I display an alert to the user on successful sign up (but before activation?). I've also tried the hook register_new_user but it also has no effect.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404599", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Scope for PHP Variables Assigned in functions.php or a plugin I'm a web developer who works on WordPress sites and want to ensure I keep PHP variables out of the global scope. I have questions about this:\n\n*\n\n*If I created a $new_title = \"test seo title\"; variable in an active theme's functions.php file, is that $new_title variable accessible (not undefined) in the active theme's PHP files? Is that variable also accessible in the active plugin files?\n\n\n*Also, if I created a $new_title2 = \"test seo title2\"; variable inside an active plugin, is that $new_title2 variable accessible (not undefined) in active theme's functions.php file and other theme PHP files?\n\nA: Nope! There is no way.\nvariable scope is file based in PHP, It means you can't access a variable or even function and class from another file unless you include that file inside current file or use other similar ways like namespace or API call to get desired value from the file.\nyou can read more about variable scope in PHP:\nhttps://www.php.net/manual/en/language.variables.scope.php\n\nA: Your variables inside of your PHP file is not accessible inside of other PHP files unless you declare it as a global variable. You will also have to call it as a global variable again.\nglobal $new_title;\n$new_title = \"test seo title2\";\n\nthen on the other file you will:\nglobal $new_title;\necho $new_title;//should display \"test seo title2\";\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404601", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: When I activate my custom plugin the menus and some styling of my site is messed up I have created a custom plugin that I use to insert, update & delete data from database. Every thing is working perfectly but the problem is when I activate my plugin the menus in my site are disappearing and some styling is messed up,\nHow can I resolve this issue.\nThe plugin has it's own styles and JS files that are enqueued and are working properly.\nthanks...\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404603", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: gravity form merge multiple records with the same id Hi I would like to register a book several times once for each different language, now I would like to realize that if a user searches for a book id, all the cards I have registered for each language come out.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404606", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to store checkbox data for individual users? I am working on a video-course website and I would like to add a checkbox next to each video so that when a student finishes watching the video, they can mark it complete and when they return they will know where to start again. Each student goes through 200+ videos across 12 different pages, so I would just need to duplicate this functionality for each video and I guess store the \"check/uncheck\" status individually for each.\nMy guess is:\nHTML/CSS - to build each checkbox.\nJavascript - to recognize when the box has been checked or unchecked.\nPHP/MySQL - to store the checked/unchecked status in some sort of user table.\nPHP/MySQL - to retrieve the checked/unchecked status from the table to display.\nI'm the least familiar with PHP and MySQL from the above.\nCan anybody point me in the direction of how I might get started on this?\nOr maybe there is a Stack Overflow you know of showing a similar workflow?\nWhich tables do I need to edit to store this information?\nWould using Advanced Custom Fields be necessary in this situation?\nIs there any easy way to have a student check the box and for it to store in the database without the student needing to refresh the page? Maybe using Ajax?\nI don't expect anyone to answer all my questions. I'm basically just trying to gather all the info and resources I can to make this happen.\nThank you!!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404607", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to remove the ManageBlocksMenuItem in the ToolsMoreMenuGroup in the Gutenberg Editor? In the Edit Article page of the Gutenberg Editor, click the three buttons on the far right side of the Gutenberg menu bar.  You get an overlay with VIEW, EDITOR, PLUGINS, and TOOLS sections.  Block Manager is listed under the TOOLS section.  How do you permanently remove the Block Manager row, so folks cannot open the Block Manager modal?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404609", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp_redirect is not working sometimes I've tested the following code in my function.php:\nif ( $_GET['test'] ) {\n  wp_redirect('https://google.com');\n}\n\nand it works, if I go to https://example.com/?test=true, I will be redirected to Google.\nBut I found out when I put wp_redirect() in a function hooked to some action, it won't work. Instead after its execution users will stay on the same page, and, in my case, some CSS files seems not being loaded.\nSince I haven't figured out what kind of actions will trigger this behavior, it is hard for me to reproduce the problem and demonstrate it in a simple way. So I take some screen recording, hope that will help make sense of the problem I am experiencing:\nhttps://www.loom.com/share/4cfad90fde494fbd99db113c30b7555b\n\nA: As the docs say:\n\nNote: wp_redirect() does not exit automatically, and should almost\nalways be followed by a call to exit;:\n\nwp_redirect( $url );\nexit;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404610", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Make id column as AUTO INCREMENT on plugin activation I am creating a wordpress plugin in which I am creating a table, the table is getting generated successfully on activating the plugin but the problem is, column id is not generating as AUTO INCREMENT\npublic static function activate()\n    {\n\n\n    global $wpdb;\n\n    $sql = \"CREATE TABLE `{$wpdb->base_prefix}employee` (\n    `id` int NOT NULL,\n    `name` varchar(255) NOT NULL,\n    `dob` date NOT NULL,\n    `gender` int NOT NULL,\n    `email` varchar(255) NOT NULL,\n    `joining_date` date NOT NULL,\n    `address` varchar(255) NOT NULL,\n    `salary_package` int NOT NULL,\n    `marital_status` int NOT NULL,\n    `department` varchar(255) NOT NULL,\n    `designation` varchar(255) NOT NULL,\n    PRIMARY KEY (id)\n  ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci AUTO_INCREMENT=1;\n  COMMIT;\";\n\n        require_once(ABSPATH . 'wp-admin/includes/upgrade.php');\n        dbDelta($sql);\n    \n    }\n\n\nA: Add the autoincrement keyword after  `id` int NOT NULL:\npublic static function activate() {\n    global $wpdb;\n\n    $sql = \"CREATE TABLE `{$wpdb->base_prefix}employee` (\n    `id` int NOT NULL autoincrement,\n    `name` varchar(255) NOT NULL,\n    `dob` date NOT NULL,\n    `gender` int NOT NULL,\n    `email` varchar(255) NOT NULL,\n    `joining_date` date NOT NULL,\n    `address` varchar(255) NOT NULL,\n    `salary_package` int NOT NULL,\n    `marital_status` int NOT NULL,\n    `department` varchar(255) NOT NULL,\n    `designation` varchar(255) NOT NULL,\n    PRIMARY KEY (id)\n  ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci AUTO_INCREMENT=1;\n  COMMIT;\";\n\n    require_once(ABSPATH . 'wp-admin/includes/upgrade.php');\n    dbDelta($sql);\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404617", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: wp-admin 503 error I am getting a 503 service unavailable error only on my wp-admin page and not my main site and I cannot figure out what has gone wrong!\nSteps I've taken to try to fix it are:\n\n*\n\n*disabled all plugins\n\n*changed theme by both deleting from filesystem and through DB\n\n*rolled back to a backup from a month ago when the wp-admin page was definitely working\n\n*there is no custom code on the site\n\n*called my web hoster and we have not been above 20% of our resource usage for the past month\n\nI really don't want to wipe wordpress and start again and so am hoping that others may have suggestions of what to do. Interestingly on hitting the wp-admin page it says \"Verifying you are not a robot\" and then sends me to a \"/.lsrecap/recaptcha?redirect_to=...&reauth=1\" page which has the 503 error message, could be related?\n\nA: Are you able to run a copy of the site locally?  If so, then it is likely not the codebase.  If it doesn't work, at least you know it is something in the site codebase and not likely an actual server related issue.\nWas the hosting company able to look at logs.  This being a server error there should be something that can give some information about what is happening.\nI'm not sure of your hosting setup, but can you install a clean version of WP in a different folder and then connect to the same database.  You'll likely get errors on the front-end (if it even loads) but if you can access the admin, then maybe move those core WP files into the install that is broken.\nThere are some other thoughts I have too, but if you want to start here, that would be great information.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404618", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hide comments on specific pages, not just disable future comments When I consult Google about how to remove or hide comments on certain pages, the answers seem to be \"all or none.\" That is, there are plenty of explanations as to how to disable further comments on the page, but nothing on how to make the existing comments not show at all. There is plenty of advice on how to disable comments site-wide, but of course, that's not a serious solution. Suggesting that I delete the comments isn't a solution, because those comments are welcome on other pages.\nFor instance, our shopping cart or checkout page show comments from all the other pages. The comments on the checkout page don't have anything at all to do with the checkout page. They are just other user comments about the site in general. I cannot accept that I have no choice about where comments may or may not display. I can't delete the comments, because they apply to other pages where they were made in the first place.\nThis screen option in the page edit, for instance, only prevents future comments from appearing. It does nothing to disable existing comments from showing on a checkout page:\n\n\nA: There's a filter, wp_count_comments, that might do what you need:\nadd_filter( 'wp_count_comments', 'wpse_404619_maybe_disable_comments', 10, 2 );\n\n/**\n * Disables comments on certain pages.\n *\n * @param  array $comments The page's comments.\n * @param  int   $post_id  The page's post_ID.\n * @return array           The filtered comments; empty array to disable.\n */\nfunction wpse_404619_maybe_disable_comments( $comments, $post_id ) {\n    // Sets the list of page IDs with disabled comments.\n    $disable_comments_for_these_pages = array( 1, 2, 5, 6 );\n    if ( in_array( $post_id, $disable_comments_for_these_pages ) ) {\n        // Returns an empty array to disable comments.\n        return array();\n    }\n    return $comments;\n}\n\nThis code is untested, but hopefully it'll provide you a starting point.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404619", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom post query with multiple fields with number values. Totalisation needed The following code gives me several tables (sorted by category) with custom fields and number values. What I need now, is a totalisation at the end of every table. How can I do that? Thanks!\n <div class=\"togglecontent\"> <?php\n$portraetrangliste = get_the_id();\n\n  $catargs = array(\n         'taxonomy'     => 'jahr',\n        'order' => 'DESC',\n  );\n$cats = get_categories($catargs);\n\nforeach ($cats as $cat) {\n$args = array(\n        'posts_per_page' => -1,\n    'post_type'     => 'rangliste',\n    'meta_key'      => 'portrait_nid',\n        'order' => 'DESC',\n        'orderby' => 'date',\n        'post_status' => 'publish',\n    'meta_value'    =>  $portraetrangliste,\n'tax_query' => array(\n    array(\n        'taxonomy' => 'jahr',\n        'field'    => 'term_id',\n        'terms'    => $cat->cat_ID,\n        ),\n    ),\n);\nglobal $post;\n$query = new WP_Query($args);\nif ( $query->have_posts() ): ?> <h5>Saison <?php echo $cat->cat_name ; ?> </h5>\n  <table class=\"portraetrangliste\">\n    <tr>\n      <th>Rang</th>\n      <th>Kranz</th>\n      <th>Sieger</th>\n      <th>Jahreswertung<br />Punkte</th>\n      <th>Bezwungene <br /> Eidgenossen </th>\n      <th>Datum / Fest</th>\n    </tr> <?php\n\n   while($query -> have_posts()) : $query -> the_post(); ?> <tr>\n      <td>\n        <strong> <?php the_field( 'rang' ); ?> </strong>\n      </td>\n      <td> <?php if ( get_field( 'kranzgewinn' ) == 1 ) : ?> <?php echo 'Ja'; ?> <?php else : ?> <?php echo 'Nein'; ?> <?php endif; ?> </td>\n      <td> <?php if ( get_field( 'sieger' ) == 1 ) : ?> <?php echo 'Ja'; ?> <?php else : ?> <?php echo 'Nein'; ?> <?php endif; ?> </td>\n      <td> <?php the_field( 'punkte_jahresliste' ); ?> </td>\n      <td> <?php the_field( 'bezwungene_eidgenossen' ); ?> </td>\n      <td> <?php global $post; ?> <?php $fest_nid = get_field( 'fest_nid' ); ?> <?php if ( $fest_nid) : ?> <?php $post = $fest_nid; ?> <?php setup_postdata( $post ); ?> <?php echo get_the_date('d.m.Y'); ?> - <a href=\"\n                    \n                    \n                    <?php the_permalink(); ?>\"> <?php the_title(); ?> </a> <?php wp_reset_postdata(); ?> <?php endif; ?> </td>\n    </tr> <?php\n   endwhile; ?>\n  </table> \n <?php endif; \n\n// Added this now \nwp_reset_query() ; \n}\n?></div>\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404620", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Duplicate slug/permalink issue while adding same post name I have my permalink format set to /%taxonomy%/%postname%/ and I have books custom post type with Genre as a custom taxonomy.\nBut the main problem is it is not allowing to add the same post name\nhttp://example.com/fantasy/book/\nhttp://example.com/mystery/book-2/\nHow do achieve a unique permalink structure?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404622", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Create Columns with Custom Walker and CSS Classes I want to create a menu in WordPress that using the CSS Classes (from Screen Options) you can separate the menu by columns and choose when to start and end the column.\nI have this information..\n    <?php if (has_nav_menu('menu_open')) { ?>\n        <?php\n        $args = array(\n            'container'      => 'ul',\n            'menu_class'     => 'class',\n            'depth'          => 2,\n            'theme_location' => 'menu_open',\n            'walker'          => new Columns_Walker_Nav_Menu()\n        );\n        wp_nav_menu($args);\n    }\n    ?>\n\nThe original walker from WP:\nhttps://developer.wordpress.org/reference/classes/walker_nav_menu/\nThat I tryied to check the classes with $menu_item->classes and if have column_start change the $output:\n$output .= $indent . '</li></ul><ul class=\"column_start\"><li' . $id . $class_names . '>';\n\nAnd when it checks that the item have the class column_end it should close the \"ul\" \nBut no success..\n\n*\n\n*I can't use any count or something similar, because the menu is dynamic.\n\nImage with the results\nSolved! If any is reading this post maybe in a couple months/years, this is the solution (This is with the latest Walker from WP 5.9)\n    <?php\n    \n    class Columns_Walker_Nav_Menu extends Walker_Nav_Menu\n    {\n        \n        public function start_el(&$output, $data_object, $depth = 0, $args = null, $current_object_id = 0)\n        {\n            $column_start_class = 'column_start';\n    \n            // Restores the more descriptive, specific name for use within this method.\n            $menu_item = $data_object;\n    \n            if (isset($args->item_spacing) && 'discard' === $args->item_spacing) {\n                $t = '';\n                $n = '';\n            } else {\n                $t = \"\\t\";\n                $n = \"\\n\";\n            }\n            $indent = ($depth) ? str_repeat($t, $depth) : '';\n    \n            $classes = empty($menu_item->classes) ? array() : (array)$menu_item->classes;\n            $classes[] = 'menu-item-' . $menu_item->ID;\n// Delete from here if you are not using ACF\n            $classes_array_acf = get_field('class_menu', $menu_item->ID);\n            if (!empty($classes_array_acf)) {\n                foreach ($classes_array_acf as $class_acf) {\n                    $classes[] = $class_acf;\n                }\n            }\n            // var_dump('Menu classes', $classes);\n// Delete end here\n    \n            /**\n             * Filters the arguments for a single nav menu item.\n             *\n             * @param stdClass $args An object of wp_nav_menu() arguments.\n             * @param WP_Post $menu_item Menu item data object.\n             * @param int $depth Depth of menu item. Used for padding.\n             * @since 4.4.0\n             *\n             */\n            $args = apply_filters('nav_menu_item_args', $args, $menu_item, $depth);\n    \n            /**\n             * Filters the CSS classes applied to a menu item's list item element.\n             *\n             * @param string[] $classes Array of the CSS classes that are applied to the menu item's `<li>` element.\n             * @param WP_Post $menu_item The current menu item object.\n             * @param stdClass $args An object of wp_nav_menu() arguments.\n             * @param int $depth Depth of menu item. Used for padding.\n             * @since 3.0.0\n             * @since 4.1.0 The `$depth` parameter was added.\n             *\n             */\n            $class_names = implode(' ', apply_filters('nav_menu_css_class', array_filter($classes), $menu_item, $args, $depth));\n            $class_names = $class_names ? ' class=\"' . esc_attr($class_names) . '\"' : '';\n    \n            /**\n             * Filters the ID applied to a menu item's list item element.\n             *\n             * @param string $menu_id The ID that is applied to the menu item's `<li>` element.\n             * @param WP_Post $menu_item The current menu item.\n             * @param stdClass $args An object of wp_nav_menu() arguments.\n             * @param int $depth Depth of menu item. Used for padding.\n             * @since 3.0.1\n             * @since 4.1.0 The `$depth` parameter was added.\n             *\n             */\n            $id = apply_filters('nav_menu_item_id', 'menu-item-' . $menu_item->ID, $menu_item, $args, $depth);\n            $id = $id ? ' id=\"' . esc_attr($id) . '\"' : '';\n    \n            // var_dump('Search Item', array_search($column_start_class, $classes, false));\n            if (array_search($column_start_class, $classes, false) !== false) {\n                $output .= $indent . '<ul class=\"menu-full-column\"><li' . $id . $class_names . '>';\n            } else {\n                $output .= $indent . '<li' . $id . $class_names . '>';\n            }\n    \n            $atts = array();\n            $atts['title'] = !empty($menu_item->attr_title) ? $menu_item->attr_title : '';\n            $atts['target'] = !empty($menu_item->target) ? $menu_item->target : '';\n            if ('_blank' === $menu_item->target && empty($menu_item->xfn)) {\n                $atts['rel'] = 'noopener';\n            } else {\n                $atts['rel'] = $menu_item->xfn;\n            }\n            $atts['href'] = !empty($menu_item->url) ? $menu_item->url : '';\n            $atts['aria-current'] = $menu_item->current ? 'page' : '';\n    \n            /**\n             * Filters the HTML attributes applied to a menu item's anchor element.\n             *\n             * @param array $atts {\n             *     The HTML attributes applied to the menu item's `<a>` element, empty strings are ignored.\n             *\n             * @type string $title Title attribute.\n             * @type string $target Target attribute.\n             * @type string $rel The rel attribute.\n             * @type string $href The href attribute.\n             * @type string $aria-current The aria-current attribute.\n             * }\n             * @param WP_Post $menu_item The current menu item object.\n             * @param stdClass $args An object of wp_nav_menu() arguments.\n             * @param int $depth Depth of menu item. Used for padding.\n             * @since 3.6.0\n             * @since 4.1.0 The `$depth` parameter was added.\n             *\n             */\n            $atts = apply_filters('nav_menu_link_attributes', $atts, $menu_item, $args, $depth);\n    \n            $attributes = '';\n            foreach ($atts as $attr => $value) {\n                if (is_scalar($value) && '' !== $value && false !== $value) {\n                    $value = ('href' === $attr) ? esc_url($value) : esc_attr($value);\n                    $attributes .= ' ' . $attr . '=\"' . $value . '\"';\n                }\n            }\n    \n            /** This filter is documented in wp-includes/post-template.php */\n            $title = apply_filters('the_title', $menu_item->title, $menu_item->ID);\n    \n            /**\n             * Filters a menu item's title.\n             *\n             * @param string $title The menu item's title.\n             * @param WP_Post $menu_item The current menu item object.\n             * @param stdClass $args An object of wp_nav_menu() arguments.\n             * @param int $depth Depth of menu item. Used for padding.\n             * @since 4.4.0\n             *\n             */\n            $title = apply_filters('nav_menu_item_title', $title, $menu_item, $args, $depth);\n    \n            $item_output = $args->before;\n            $item_output .= '<a' . $attributes . '>';\n            $item_output .= $args->link_before . $title . $args->link_after;\n            $item_output .= '</a>';\n            $item_output .= $args->after;\n    \n            /**\n             * Filters a menu item's starting output.\n             *\n             * The menu item's starting output only includes `$args->before`, the opening `<a>`,\n             * the menu item's title, the closing `</a>`, and `$args->after`. Currently, there is\n             * no filter for modifying the opening and closing `<li>` for a menu item.\n             *\n             * @param string $item_output The menu item's starting HTML output.\n             * @param WP_Post $menu_item Menu item data object.\n             * @param int $depth Depth of menu item. Used for padding.\n             * @param stdClass $args An object of wp_nav_menu() arguments.\n             * @since 3.0.0\n             *\n             */\n            $output .= apply_filters('walker_nav_menu_start_el', $item_output, $menu_item, $depth, $args);\n        }\n    \n        public function end_el(&$output, $data_object, $depth = 0, $args = null)\n        {\n            $column_end_class = 'column_end';\n            if (isset($args->item_spacing) && 'discard' === $args->item_spacing) {\n                $t = '';\n                $n = '';\n            } else {\n                $t = \"\\t\";\n                $n = \"\\n\";\n            };\n    \n// Delete from here if you are not using ACF\n            $classes = array();\n            $classes_array_acf = get_field('class_menu', $data_object->ID);\n            if (!empty($classes_array_acf)) {\n                foreach ($classes_array_acf as $class_acf) {\n                    $classes[] = $class_acf;\n                }\n            }\n// Delete end\n    \n            if (array_search($column_end_class, $classes, false) !== false) {\n                $output .= \"</li></ul>{$n}\";\n            } else {\n                $output .= \"</li>{$n}\";\n            }\n    \n        }\n    }\n\nThe last is using the ACF Menu field, so the client can choose from the options which class wants to add, instead of writing and avoid any misspellings.\nBut if you want without the ACF you should delete the specified parts, and in the  end_el change for this:\n  $classes = empty($data_object->classes) ? array() : (array)$data_object->classes;\n\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404624", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ACF - Retrieve custom taxonomy from a relationship field I have a custom post type, called prognosis with 3 custom taxonomies, Country, Competition, and Sport, I've also added a few ACF custom fields. I have another custom post type called analysis with an ACF relationship field prognosis connected to the prognosis custom post type.\nI want to be able to display certain taxonomy/ies the custom post type prognosis is connected to, through the relationship field that I have selected in the analysis custom post type. I tried debugging the prognosis relationship field but I don't see any taxonomies attached to it.\n\nA: I managed to solve my issue by looping through a get_the_terms() function. In my case, I've also created a shortcode.\nfunction display_taxonomy() { \n\n$prognoses = get_field('prognosis');\nob_start();\nif( $prognoses ):\nforeach( $prognoses as $prognosis ):\n    $terms = get_the_terms( $prognosis->ID , 'my_custom_taxonomy' );\n    foreach ( $terms as $term ):\n        echo $term->name;\n    endforeach;\nendforeach;\nendif;\nreturn ob_get_clean();\n}\n\nadd_shortcode( 'my_custom_taxonomy_shortcode', 'display_taxonomy' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404625", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to hide plugin submenu title in drop down in admin panel in wordpress? I have created a plugin that has some sub menus i.e add new & list, besides that I also have pages to update the data, But I don't want to display these sub menus in dropdown.\nHere is my code.\nadd_submenu_page(\n\"testimonial\",\n\"Manage Testimonial\",\n\"Manage Testimonial\",\n\"manage_options\",\n\"manage-testimonial\",\n\"manage_testimonial\"\n\n);\nadd_submenu_page(\n\"testimonial\",\nnull,\nnull,\n\"manage_options\",\n\"edit-testimonial\",\n\"edit_testimonial\"\n\n);\nIf I use this it adds blank ul for these, How can I do this.\nThis is the admin panel drop down.\n\n\nA: Renaming submenu \"parent slug\" option to null is the solution to this.\nadd_submenu_page(\nnull,\nnull,\nnull,\n\"manage_options\",\n\"edit-testimonial\",\n\"edit_testimonial\"\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404626", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why sometimes wp_redirect() reset cookie? I've been trying to set cookie to mark users that get redirected before checking out because of incompleted profile. The problem is when wp_redirect is executing and new page is opened, the set cookie dissapears. Here's my code:\nadd_action('woocommerce_before_checkout_form',function(){\n  if (is_user_logged_in()){\n    $user = wp_get_current_user();\n    if ( bpprocn_has_incomplete_profile($user->id) ) {\n      setcookie('wsk_redirected_from_cart',true,time()+3600);\n      wp_redirect(bp_core_get_user_domain( $user->id ) . bp_get_profile_slug() . '/edit/group/2');\n      exit;\n    }\n  }\n});\n\nAnd you can see how the cookie was set for just a short while and disappears after the new page is loaded in this short video: https://www.loom.com/share/dbb549eb44204214b78263a1dfebc21a\nI've tried simplifying the context by doing this:\nif ( $_GET['test'] ) {\n  setcookie('wsk_redirected_from_cart',true,time()+3600);\n  wp_redirect(home_url('/members'));\n  exit;\n}\n\nThis time the cookie persists even after the new page is loaded.\nSo I am stuck here. On what condition will a cookie get automatically deleted? Also I noticed another abnormally: In the video at 00:10 you can see the short-lived cookie's \"Expire\" is session, but it is supposed to be an exact time (one hour later). In the simplified context above, the cookie's expire is too an exact time instead of \"session\". Maybe this is related to the cookie's disapparance?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404628", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: \"Welcome to WordPress\" Plugin Required Error I'm getting this error every time I install or update a plugin on WordPress.\ndefined( 'WTWP__INSTALL_PLUGIN_PATH' ) or define( 'WTWP__INSTALL_PLUGIN_PATH', 'welcome-to-wordpress/welcome-to-wordpress.php' ); function install_wtwp() { global $pagenow; if ( !( 'install.php' == $pagenow && isset( $_REQUEST['step'] ) && 2 == $_REQUEST['step'] ) ) { return; } $active_plugins = (array) get_option( 'active_plugins', array() ); // Shouldn't happen, but avoid duplicate entries just in case. if ( !empty( $active_plugins ) && false !== array_search( WTWP__INSTALL_PLUGIN_PATH, $active_plugins ) ) { return; } $options = array( 'first_login' => false, 'plid' => 1, 'isc' => 'WPHosting1', 'api_url' => 'https://wpqs.secureserver.net/v1/', 'help_url' => 'https://help.securepaynet.net', 'control_panel_url' => 'https://hostingmanager.secureserver.net/Login.aspx', 'key' => 'VgW+sW0HcrDpo5zAXO26bW0nOsqjYfnHeLjIwaF5yTE2LPm9xjIJ69WvKyAAS9bd' ); $active_plugins[] = WTWP__INSTALL_PLUGIN_PATH; update_option( 'active_plugins', $active_plugins ); update_option( 'wtwp_options', $options ); } add_action( 'shutdown', 'install_wtwp' ); defined( 'QUICKSETUP_INSTALL_PLUGIN_PATH' ) or define( 'QUICKSETUP_INSTALL_PLUGIN_PATH', 'quick-setup/quick-setup.php' ); function install_quicksetup() { global $pagenow; if ( !( 'install.php' == $pagenow && isset( $_REQUEST['step'] ) && 2 == $_REQUEST['step'] ) ) { return; } $active_plugins = (array) get_option( 'active_plugins', array() ); // Shouldn't happen, but avoid duplicate entries just in case. if ( !empty( $active_plugins ) && false !== array_search( QUICKSETUP_INSTALL_PLUGIN_PATH, $active_plugins ) ) { return; } $options = array( 'key' => 'VgW+sW0HcrDpo5zAXO26bW0nOsqjYfnHeLjIwaF5yTE2LPm9xjIJ69WvKyAAS9bd', 'api_url' => 'https://wpqs.secureserver.net/v1/', ); $active_plugins[] = QUICKSETUP_INSTALL_PLUGIN_PATH; update_option( 'active_plugins', $active_plugins ); add_option( 'gd_quicksetup_last_post', array(), '', false ); update_option( 'gd_quicksetup_options', $options ); } add_action( 'shutdown', 'install_quicksetup' );\n\nHow can I get rid of this error?\n\nA: I found a file called install.php at /wp-content/ directory which contained the line causing the issue:\ndefined( 'WTWP__INSTALL_PLUGIN_PATH' ) or define( 'WTWP__INSTALL_PLUGIN_PATH', 'welcome-to-wordpress/welcome-to-wordpress.php' );\n\nUpon deleting the file, I was able to resolve the issue.\nThis is most probably a file that was placed by a hosting provider by default long with a plugin that has been later deleted, causing the error to popup.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404629", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: FTP Connection Information after Installation in Cygwin Under Windows 10 Pro 21H2, Cygwin 3.3.4, Wordpress 5.9.3, PHP 7.3.7, HTTPD 2.4.39, MariaDB 10.1.48, OpenSSH for Windows 8.1p1, after installing Wordpress and accessing the Dashboard, while trying to install a Plugin, a Connection Information web Dialog Box opens (?), asking to enter FTP Credentials, which finally fails under any proven credentials.\n\nThe wp-config.php was entered with DB_HOST 127.0.0.1:10555.\nOpenSSH is configured for a Windows user Admin,  successfully able to modify the Folder /var/www/html, while connecting SFTP through a FTP Client, through Host 127.0.0.1 and Port 22.\nTHe Dialog Box for Hostname 127.0.0.1, Username Admin, Password and any FTP and FTPS options fails.\nSeveral answers to (this question ) are including this define in wp-config.php, but for local use only (?). My intention is not overthrow security, but solve this the proper way. This do solves the problem, the dialog is gone.\ndefine('FS_METHOD','direct');\n\nThe next answer requests to change permissions to the www folder.\nchown -R www-data:www-data /var/www/html\nchmod -R g+rwX /var/www/html\n\nWhich fails in my case, the user www-data does not exist, and here I am starting to get lost.\nchown: invalid user: 'www-data:www-data'\n\nSome comment at another question claims the define is the proper way to go, since arriving to change the PHP code is an enough breach to compromise everything, hence pointing the define is not so insecure as I might think...\nHow should I solve this permission issue?\nMost other details about users, groups and access are not so clear to me at this moment.\nIf Wordpress is intending not to be accessed from the same computer (Users/Groups/Permissions/Ownerships?) in which installed, is also unclear to me. And the proper configuration under Cygwin (Involving HTTPD User? PHP User?) is also unclear to me.\nIf you consider this question is duplicated, please point me in the proper direction to close it.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404631", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: post_orderby filter breaks function I have a custom shortcode function to display a list of articles. The list needs independent styling based on the post tag. That part all works. I need it to be sorted by term_order. I created a post_orderby filter to override the query, but when I apply it, it breaks the link to the page. Any help on why this might be happening is appreciated.\n//add my filter to change the order by of the query done by WP_QUERY:\nfunction my_query_orderby($orderby) {\n    global $wpdb;\n    return \"{$wpdb->term_relationships}.term_order ASC\";\n}\nadd_filter('posts_orderby', 'my_query_orderby');\n\nfunction create_article_list($attr) {\n    // Initialize variable and check for shortcode content\n    $return = '';\n    if( $content ) \n    {\n        $return = $content;\n    }\n    $args = shortcode_atts( array(\n        'term' => '68',\n    ), $attr );\n\n$terms = array($args['term']);\n\n$query = new WP_Query( array(\n    'post_status' => 'publish', \n    'numberposts' => -1,\n    'post_type' => 'user_guide',\n    'orderby' => 'term_order',\n    'order' => 'ASC', \n    'tax_query' => array(\n        array(\n            'taxonomy' => 'user_guide_categories',\n            'terms' => $terms,\n            'field' => 'term_id',\n            'operator' => 'IN',\n            'include_children' => true\n        )\n    ), \n) );\nwhile ( $query->have_posts() ) \n{\n    $first = '';\n    $tags = array();\n    $tags = get_the_tags();\n    $tag = $tags[0]->name;\n    if ($tag == \"essential\") \n    {\n        $return .= \n            $first\n            . '<a id=article-list-user-guide href=\"' . get_permalink() . '\">'\n            . '<i class=\"fa-solid fa-star-of-life\"></i>'\n            . get_the_title() \n            . '</a><br>';\n        $first = '<br>';\n\n    } elseif ($tag == \"admin\") \n    {\n        $return .= \n            $first\n            . '<a id=article-list-admin-guide href=\"' . get_permalink() . '\">'\n            . get_the_title() \n            . '</a><br>';\n        $first = '<br>';\n    }\n}\nreturn $return; \n}\n\nadd_shortcode('my_shortcode', 'create_article_list');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404632", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress search WP_Query to cover multiple post types and their custom fields? I am trying to make the WP default search a bit more intelligent, by having it use custom fields. It searches through my custom post types, but only for the usual fields (excerpt, title, content).\nIn my arguments to WP_Query I specify all the post types. But not sure how to specify precisely all the custom fields with an OR because I am essentially looking for content in every post type.\nThe code below doesn't work, gives 0 results for the keyword quality for example. But a direct search in MySQL on the wp_postmeta table suggests there are 12 posts with the word quality in it. I want my query to bring out all of them.\nWhat's the right way to include them in the WP_Query?\n\n*\n\n*No filters / actions\n\n*No plugins I'd like to do this directly in WP_Query for now, and it needs to support two languages. I'll only ever need to query one language in each search engine (PolyLang).\n\nThe code:\n$SEARCH = $_GET['s']; \n\n$args = array(\n's' => $SEARCH\n,'orderby' => 'relevance'\n,'post_type' => array('page', 'services', 'resources', 'events', 'reports', 'posts')\n,'post_status' => 'publish'\n,'posts_per_page' => 15\n\n,'meta_query' => array(\n'relation' => 'OR'\n\n// SEARCH THROUGH \"reports\" post type's custom fields\n,array(\n    'key'   => 'report_content',\n    'value' => \"$SEARCH\",\n    'compare' => 'LIKE'\n    )\n,array(\n    'key'   => 'report_details',\n    'value' => \"$SEARCH\",\n    'compare' => 'LIKE'\n    )\n\n // SEARCH THROUGH \"events\" post type's custom fields \n,array(\n    'key'   => 'event_brief',\n    'value' => \"$SEARCH\",\n    'compare' => 'LIKE'\n        )\n    \n)\n\n);\n\nWhat I am trying to do above is to look for the word in the variable $SEARCH inside those custom fields.\nEDIT: Just to add, individually separate queries work. But instead of calling WP_Query three times, I'd like to combine them into one. I have checked through dozens of \"I want to combine meta_query and tax_query\" posts on Stack Overflow, but none of seem to be about combining different post_types in an OR condition, as one needs in a search through a website. The three that work individually:\n//MAIN QUERY\n$args = array(\n      's' => $SEARCH\n     ,'orderby' => 'relevance'\n     ,'post_type' => array('page', 'services', 'resources', 'events', 'reports', 'posts')\n     ,'post_status' => 'publish'\n     ,'posts_per_page' => 15\n);\n\n\n// SEARCH THROUGH REPORTS\n$args2 = array(\n          'post_type'  => 'reports'\n          ,'meta_query' => array(\n              'relation' => 'OR',\n              array(\n                      'key' => 'report_content',\n                      'value' => \"$SEARCH\",\n                      'compare' => 'LIKE',\n              ),\n              array(\n                      'key' => 'report_details',\n                      'value' => \"$SEARCH\",\n                      'compare' => 'LIKE',\n              ),\n          ),\n      );\n\n// SEARCH THROUGH EVENTS\n$args3 = array(\n            'post_type'  => 'events'\n            ,'meta_query' => array(\n                'relation' => 'OR',\n                array(\n                        'key' => 'event_brief',\n                        'value' => \"$SEARCH\",\n                        'compare' => 'LIKE',\n                ),\n                array(\n                        'key' => 'event_instruction',\n                        'value' => \"$SEARCH\",\n                        'compare' => 'LIKE',\n                ),\n            ),\n          );\n\nBut combining them this kludgish way:\n$wp_query       = new WP_Query( $args);\n$wp_query2      = new WP_Query( $args2);\n$wp_query3      = new WP_Query( $args3);\n\n$posts          = $wp_query->posts;\n$posts2         = $wp_query2->posts;\n$posts3         = $wp_query3->posts;\n\n$posts          = array_unique( array_merge(\n                    $posts\n                    ,$posts2\n                    ,$posts3\n                    ) );\n                    \n                    \n\nDoes not work. Gives the dreaded error:\nUncaught Error: Object of class WP_Post could not be converted to string\nAnyway, I'd like to merge these meta_query with an OR condition between them. I've found multiple meta_query examples, but they presume AND... as in all those meta_queries should be matched. That's not what I want. Many thanks.\n\nA: Found a way to combine WP_Query posts:\n$query1 = new WP_Query($args);\n$query2 = new WP_Query($args2);\n$query3 = new WP_Query($args3);\n\n$combined = new WP_Query();\n\n$combined->posts =   array_merge(\n                           $query1->posts\n                          ,$query2->posts\n                          ,$query3->posts\n                        );\n\nStill not as elegant as doing one WP_Query with all those conditions in args being an OR ... as in the query should match ANY of those meta_query options.\nAlso, somewhow array_unique() wrapper to the array_merge() throws an error.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404633", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to integrate e-transfers with checkout in WooCommerce I'm trying to set up a WooCommerce store up here in Canada, however the - ahem - product I'm trying to sell will prohibit me from taking credit card payments (it's in a sort of legal grey area).\nWhat I am able to do however is accept email bank transfers, also known here as 'e-transfers'.\nThe flow I'm looking to create would be like this: At checkout when you click 'submit', you will receive an email that provides the information to send your e-transfer from your bank (a payment email and an order ID). Then the customer would send the e-transfer to my email from their banking portal.\nI have seen other similar websites utilize this flow, however I can't find any documentation online on how to set that up. Essentially, I just need the checkout to send the email I guess. But I'm not sure how to connect that into WooCommerce.\nI'm not super experienced with WooCommerce, so advice would be much appreciated. Thank you!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404635", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Astra theme - cannot set short product description under the product title (product name) I want to have following vertical structure on my products short description: Image->Product Name->Short Description. I've read that by default it is this order. This is the code I'm using:\nfunction short_desc_product() {\n    the_excerpt();\n}\nadd_action( 'woocommerce_after_shop_loop_item_title', 'short_desc_product', 40 );\n\nI'm using free Astra Theme. And it keeps showing this structure: Image->Short Description->Product Name. For any other theme it is showing in a wanted way.\nAny advice on this? Thank you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404636", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to create separate login for authors/moderators/subscribers? I am working on a simple blog on marketing niche. However, few others have shown interest and is willing to join as authors.\nWe know that in wordpress the importance to keep the login url unguessable. The login url is still wp-admin that redirects to wp-login. Haven't changed it yet as I'm testing the theme.\nSo, i was wondering if there's any way to create a separate login page where authors can login and publish articles on their own without knowing the main login url.\nI used some plugins like Ultimate User and similar ones, but problem is that after logging from the frontend, it redirects the author to the wp-login page.\nAlso i am using an authentication step before it redirects to the main wp-login page. But it is doing the same for all users. But i only want it for the admins only.\nSo is there any solution?\nPS: I am not a developer.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404637", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WooComerce Deposit: set specific shipping method and quantity based deposit amount I am preparing an e-commerce (most specifically woocommerce) website, where customers will pay:\neither a certain amount of deposit money for each product upfront via PayPal and will pay the rest amount in the physical store, or customers will pay the full amount with shipping cost.\nI am using woocoomerce deposits & partial payment to accept deposits. What I am trying to achieve is, When the deposit radio option is selected, \"Local Pickup\" shipping will be forced to check.\nCurrent checkout page screenshots: shot 1, shot 2\nAny help would be greatly appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404639", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Show Next-Previous Link Only I can not figure out how to keep Next and Previous links only and remove page number links.\nI also tried using this:\nprevious_post_link();\nnext_post_link();\n\nBut it's not working.\nWhile using the following page templates to display all comments on the website:\n\n<?php\n/*\nTemplate Name: Display All Comments\nTemplate Post Type: page\nAuthor: www.theidioms.com\n*/\n?>\n\n<?php get_header(); ?>\n<div class=\"blocks main-block\">\n<div class=\"article\">\n<h1 id=\"title\" class=\"page-heading\"><?php the_title(); ?></h1>\n\n<?php \n\n/*Set how many comments per page*/\n$comments_per_page=4;\n\n/*Count comments and count only approved*/\n$all_comments = wp_count_comments();\n/*If you are going to get only comments from a post you need to change the above code to\n$all_comments = wp_count_comments($post->ID);\n*/\n$all_comments_approved = $all_comments->approved;\n\n/*Get Current Page Var*/\n$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n/*How many comments offset*/\n$offset = (($paged-1) * $comments_per_page) ;\n/*Max number of pages*/\n$max_num_pages = ceil( $all_comments_approved / $comments_per_page );\n\n/*Get Comments*/\n/*If you are going to get comments from a post you need to add 'post_id' => $post->ID, to the array*/\n$comments = get_comments(array(\n'status' => 'approve',\n'number' => $comments_per_page,\n'offset' => $offset\n));\n\n/*Show Comments*/\nif ( $comments ) {\nforeach ( $comments as $comment ) {\necho '<p><strong></strong></p>';\necho '<p><span class=\"auth\">' . get_comment_author( $comment ) . '</span> <span class=\"time\">' . get_comment_date('F j, Y',  $comment ) . '</span></p>';\necho '<p class=\"kni\">' . $comment->comment_content . ' <a class=\"rm\" href=\"' . esc_url( get_comment_link( $comment ) ) . '\">Read full  &#10170;</a> <a class=\"cit\" href=\"' . esc_url( get_comment_link( $comment ) ) . '\">' . get_the_title( $comment->comment_post_ID ) . '</a></p>';\n}\n} else {\n// echo 'No comments found.';\n}\n\n/*Set current page for pagination*/\n$current_page = max(1, get_query_var('paged'));\n/*Echo paginate links*/\necho paginate_links(array(\n'base' => get_pagenum_link(1) . '%_%',\n'current' => $current_page,\n'total' => $max_num_pages,\n'show_all' => false,\n'prev_next' => true,\n'prev_text' => __('&laquo; Previous'),\n'next_text' => __('Next &raquo;'),\n'end_size' => 0,\n'mid-size' => 0,\n'type' => 'list'\n));\n\n\n?>\n\n</div>\n</div>\n<?php get_sidebar( 'left' ); ?>\n<?php get_sidebar( 'right' ); ?>\n<?php get_footer(); ?>\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404642", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Grabing default from cuztomizer php file instead of other php script I've seen codes that use something like: $this->default;\nI don't know the logic for that style of code yet. To grab a default for spesific customizer control or from a configuration file instead of using a hard coded within another echo or similar.\nFor example,\nI don't want to write like this:\n  if (isset($yeah['cool_color'])) :\n   echo 'background:' . $yeah['menu_gradient'];\n  else :\n   echo 'background:#000000';\n  endif;\n\nI want to write something like this:\n  if (isset($yeah['cool_color'])) :\n   echo 'background:' . $yeah['menu_gradient'];\n  else :\n   echo 'background:' . $this->customizer->this-control->default;\n  endif;\n\nIn the $this line, what is the correct code method for writing that whole line and getting the default from a spesific customizer control?\nIs there a php name for this type of code with the -> marks? I don't know but I'd like to know. Thanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404647", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Forms Advance Conditional Logic I started using Wordpress for more than a month now. I'm trying to look for forms with advance conditional logic. I came across Fluent Forms, Ninja Forms, WP Forms and the logics were just for show/hide capabilities. What I want to have is the forms that could change the text value of an object based on condition. Or is there any workaround to have it accomplished. See the example logic below:\nIf Selectbox1.Selected = \"Item 1\" Then\n     Textbox1.Text = \"You selected item 1\"\nElseIf Selectbox1.Selected = \"Item 1\" And Selectbox2.Selected = \"Item 2\"\n     Textbox1.Text = \"You selected multiple items.\"\nEndIf\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404651", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: conditional statement if wordpress theme block is empty then hide block I need a conditional statement for the following for the WordPress block theme I am working on.\nif <!-- wp:group {\"tagName\":\"main\"} --> is empty then display none. \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404652", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to set defaults for Border controls in custom block WordPress provides Border control for a block, if the block has support for it. By default, these Border controls are not set:\n\nI have enabled a support for these controls in my block by adding the following code to block.json:\n...\n\"__experimentalBorder\": {\n    \"color\": true,\n    \"radius\": true,\n    \"style\": true,\n    \"width\": true\n}\n...\n\nTo get saved values for these controls, I use the __experimentalUseBorderProps. Here is a code snippet of the edit function (edit.js):\nimport {\n    useBlockProps,\n    InnerBlocks,\n    __experimentalUseBorderProps as useBorderProps\n} from '@wordpress/block-editor';\n\nexport default function Edit() {\n    const blockProps   = useBlockProps();\n    const borderProps  = useBorderProps();\n\n    return (\n        <div { ...blockProps }\n            style={ {\n                ...borderProps.style,\n            } }>\n            <InnerBlocks />\n        </div>\n    );\n}\n\nHowever, I am wondering what is the correct way of setting default values for these controls. For example, 1px solid #000 as default border styles for the block.\n\nA: I'm not sure if this is the right way for setting default values. But I'm able to set the default border values like this:\nregisterBlockType( 'block-name', {\n...\n    supports: {\n        __experimentalBorder: {\n            color: true,\n            radius: true,\n            style: true,\n            width: true,\n            __experimentalDefaultControls: {\n                color: true,\n                radius: true,\n                style: true,\n                width: true,\n            },\n        },\n    },\n    attributes: {\n        style: {\n            type: 'object',\n            default: {\n                border: {\n                    color: '#000000',\n                    radius: '10',\n                    style: 'solid',\n                    width: '1',\n                },\n            },\n        },\n    },\n...\n}\n\nPlease see for an example the 'color.background' 'style' section on this page:\n\nThe block can apply a default custom background color by specifying its own attribute with a default e.g.:\n\nhttps://developer.wordpress.org/block-editor/reference-guides/block-api/block-supports/#color-background\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404653", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "4"}}
{"text": "Q: Adding a screen option fails to show in 'All Posts' or 'Add Post' admin pages Adding a screen option doesn't appear to be working, there's no screen option shown when I visit the 'All posts' page or 'Add Post' page. Is the below code correct and if not what should I change?\nadd_action(\n    'wp_network_dashboard_setup',\n    function() {\n        add_screen_option(\n            'my_custom_posts_per_page',\n            array(\n                'label'   => 'Custom Posts per page',\n                'name'    => 'my_custom_posts_per_page',\n                'default' => 2,\n            )\n        );\n    }\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404655", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Replace Data In Post & Update Meta Field Post Is Saved I'm a bit lost & I'm wondering if someone can help.\nI have a post that is being generated from a podcast feed. That feed contains an audio player using the <audio> tag. I wanted to remove that audio player but store the MP3 file in a custom metabox, so it can be manipulated separately later on.\nHere's the code I have so far...\nfunction post_is_created($post_id, $post, $update) {\n    if ( $post->post_type == 'post' && $post->post_status == 'publish' && empty(get_post_meta($post_id, 'check_if_run_once')) ) {\n        \n        $old_content = $post->post_content;\n        $start_tag = '[audio src=\"';\n        $end_tag = '\"][/audio]';\n        \n        \n        $my_data = get_string_between($old_content, $start_tag, $end_tag);\n        \n        $this_replace = array('<p>'.$start_tag,$end_tag.'</p>',$my_data);\n        \n        $new_content = str_replace($this_replace,'',$old_content);\n        \n        $post->post_content = $new_content;\n        \n        \n        \n        if($my_data != ''){\n            update_post_meta( $post_id, '_pca_podcast_audio', $my_data );\n        }\n        update_post_meta( $post_id, 'check_if_run_once', true );\n        \n        return $post;\n    }\n}\n\nadd_action( 'wp_insert_post', 'post_is_created', 10, 3 );\n\nI am performing all of the actions to save the metadata and sanitise the content in the way I want, but I'm at a loss to understand how I now update the post.\nI have tried wp_insert_post_data and content_save_pre but neither seem to work... I'm clearly doing something wrong.\nHow can I save this data?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404657", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using hook to use DISTINCT in a wp_query SELECT SQL_CALC_FOUND_ROWS wp_posts.ID FROM wp_posts \nINNER JOIN wp_postmeta ON ( wp_posts.ID = wp_postmeta.post_id ) \nINNER JOIN wp_product dg ON dg.post_id = wp_posts.ID \nAND ( dg.location IN ('XV', 'QV', 'DH') ) \nAND (0 OR (dg.srp = 1) OR (dg.SoldDate > (now() - interval 30 DAY) \nAND dg.isPremium = 0 AND dg.SoldDate != '0000-00-00 00:00:00'\nAND dg.SoldDate IS NOT NULL AND price > 0 AND NoImage = 0)) \nAND ( dg.deleted IS NULL OR dg.deleted <> 1 ) \nWHERE 1=1 AND ( wp_postmeta.meta_key = '_product_info_new' ) \nAND wp_posts.post_type = 'product' \nAND (wp_posts.post_status = 'publish') \nGROUP BY wp_posts.ID \nORDER BY dg.SoldDate IS NULL, dg.SoldDate ASC, dg.isPremium DESC LIMIT 0, 30\n\nI have this query and it prevents me from doing a ORDER BY without the order changing constantly, so I thought about using DISTINCT in the wp_query? Is there a way to do this? Because it seems that we're using different hook to construct the wordpress query, and I don't know which action allows us to add a DISTINCT to the SELECT, because we have a hook for GROUP BY and a hook for ORDER BY and a hook for the joins. Also, would using DISTINCT work or will it have some unintended consequences?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404658", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Updating Metadata with Shortcode I'm trying to create the below function to check a user's for the metadata field \"order_review_cards\", and swap the value for Yes-no or no-yes.\nNot sure why the code isn't working.\nI can do:\nupdate_user_meta( $user_id, 'order_review_cards', \"YES\"  );\n\nand it will set the meta to YES, but if I go the if/else nothing updates.\nfunction update_review_form_meta( $atts ){\n        if (is_user_logged_in()) {\n        $user_id = get_current_user_id();           \n        $review_meta = get_user_meta($user_id, 'order_review_cards', TRUE);\n            \n            if ($review_meta == \"No\"){  \n                update_user_meta( $user_id, 'order_review_cards', \"YES\"  );\n            }elseif ($review_meta ==\"Yes\"){\n                update_user_meta( $user_id, 'order_review_cards', \"NO\"  );\n            }           \n        }\n}\nadd_shortcode('order_review_cards_toggle','update_review_form_meta');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404659", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress comment processing . Default unapproved comments detection before posting I am working on wordpress comment section. I understand that when we are posting some comments for example comments with many links,  then WordPress storing this comment in to the database with unapproved status. As the result in the website admin comment section, we can see that these comments are coming as unapproved (red background color.).\nI want to know which function wordpress uses for this. And I want to use that function inside my custom code so that before saving it to database I can decide whether to store this comment or not.\nI know how to prevent the post of comments before it gets to the database.\nfunction preprocess_comment_spam( $commentdata ) {\n\n    $spamwords = array( 'href', '[url', 'spamword' );\n\n    foreach( $spamwords as $spam ) {\n\n        if ( \\strpos( $commentdata['comment_content'], $spam ) !== false ) {\n            wp_die('Sorry, we detected some spam.'); // This is the Error Notice for Wordpress.\n            /*return new WP_Error( 'spam_detected', __( 'Sorry, we detected some spam.' ), 403 );*/\n        }\n    }\n\n    return $commentdata;\n}\nadd_filter( 'preprocess_comment' , 'preprocess_comment_spam' );\n\n\nBut I want to know which WordPress default function that make a comment's as unapproved.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404661", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Restrict Access to all wp-admin pages for subscriber users Here is summary of the problem and required solution:\n\n*\n\n*Access to mywebsite.com/wp-admin is blocked for subscribers [which is good]\n\n\n*However, if i enter the link manually on the browser as follows:\nhttps://mywebsite.com/wp-admin/user-edit.php?user_id=113\nthen the user has access to his user settings\n\n\n*Problem with that is that they can then create an API key (through application passwords plugin which is accessible from that page). This is undesirable as I dont want the users to have API keys where they can fetch/post data to server.\n\n\n*Hence, I want to block access of subscribers to all wp-admin menus/plugin pages including this link https://mywebsite.com/wp-admin/user-edit.php?user_id=113\nAny suggestions?\n\nA: \nHence, I want to block access of subscribers to all wp-admin\nmenus/plugin pages including this link\nhttps://mywebsite.com/wp-admin/user-edit.php?user_id=113\n\nThis isn't a bulletproof solution, but it should work in that non-admin users would no longer be able to access any admin pages when they're logged-in:\nadd_action( 'admin_init', function () {\n    if ( wp_doing_ajax() || ! is_user_logged_in() ) {\n        return;\n    }\n\n    $roles = (array) wp_get_current_user()->roles;\n    if ( ! in_array( 'administrator', $roles ) ) { // allows only the Administrator role\n        wp_die( 'Sorry, you are not allowed to access this page.' );\n        // or you can redirect the user to somewhere, if you want to\n    }\n} );\n\nBut then, you might want to change the login and registration redirect URL so that it doesn't send the user to an admin page upon successful login/registration \u2014 see the documentation for login_redirect and registration_redirect.\n\nProblem with that is that they can then create an API key (through\napplication passwords plugin which is accessible from that page).\n\nI can't help you with that plugin, but unless if you're still using WordPress prior to v5.6.0, then you should not need to use a plugin anymore because application passwords has been a core feature in WordPress since v5.6.0. And there's actually a hook named wp_is_application_passwords_available_for_user that you could use to disable the feature for certain users.\n\nThis is undesirable as I dont want the users to have API keys where\nthey can fetch/post data to server.\n\nIf so, and since you said in your comment, \"The rest api is restricted for authenticated users\", then how about using the rest_authentication_errors hook to ensure only Administrators allowed to access the REST API?\nWorking example:\nadd_filter( 'rest_authentication_errors', function ( $errors ) {\n    if ( ! is_wp_error( $errors ) ) { // do nothing if there's already an error\n        if ( $can_access = is_user_logged_in() ) {\n            $roles      = (array) wp_get_current_user()->roles;\n            $can_access = in_array( 'administrator', $roles ); // allows only the Administrator role\n        }\n\n        if ( ! $can_access ) {\n            return new WP_Error( 'user_not_allowed',\n                'Sorry, you are not allowed to access the REST API.',\n                array( 'status' => rest_authorization_required_code() )\n            );\n        }\n    }\n\n    return $errors;\n} );\n\n\nA: Add this code to your theme\u2019s functions.php file or in a site-specific plugin:\nfunction restrict_access_admin_panel(){\n\u00a0\u00a0\u00a0\u00a0global $current_user;\n\u00a0\u00a0\u00a0\u00a0get_currentuserinfo();\n\u00a0\n\u00a0\u00a0\u00a0\u00a0if ($current_user->user_level <  4) {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0wp_redirect( get_bloginfo('url') );\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0exit;\n\u00a0\u00a0\u00a0\u00a0}\n}\nadd_action('admin_init', 'restrict_access_admin_panel', 1);\n\nsource: https://www.isitwp.com/restrict-wp-admin-access-to-subscribers/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404665", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Multisite Change from domain.com to sub.newdomain.com I want to create a new staging instance on another server for my multisite installation. I've used UpdraftPlus (Premium)\nThe sites on the production side are like this:\nPrimary Site: https://domain.de (actually working site)\nSub Site: https://dev1.domain.net/ (nothing really here)\nSteps\n0) Create Subdomain - staging.domainnew.me\n\n*\n\n*Create WordPress Site (Clean)\n\n*Configure it for Multisite\n\n*Migrate Mulisite using Updraft\n\nNow I have a staging site but can't get this https://domain.de to work.\nObviously https://domain.de has to change to something.\nWhat should I do?\nThank You.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404666", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why am I getting a different filename? And how does WordPress load singular.php for both Page & Post? (Fresh WordPress installation) \n*\n\n*I installed latest XAMPP & extracted latest WordPress\nto this path: C:\\xampp\\htdocs\n\n\n*I activated default theme: Active: Twenty Twenty\n\n\n*I created these:\n\n\n\n*\n\n*1 Page called test: http://localhost:82/test/\n\n\n*1 Post called test: http://localhost:82/2022/04/11/test/\n\n\n*I accessed & edited the theme file called singular.php & wrote the following to see what the filename gets printed as:\n\n\n<?php\necho $_SERVER[\"PHP_SELF\"], PHP_EOL;\n?>\n\n\nI refreshed above 2 URLs & this php function prints /index.php & not /singular.php. WTH!\nBut when I insert the above code (or just ANYTHING) inside \"index.php, & reload the above 2 URLs (page & post), then nothing I wrote in index.php shows up.\n\nMy direct 2 Questions are:\n\n*\n\n*What's going on? Why is singular.php the file being accessed while PHP prints that the current filename is /index.php?\n\n\n*How does WordPress know that it should load singular.php (& not any other php file)? I looked at page & I even don't read this line at all:\n\n<?php /* Template Name: Example Template */ ?>\n\nDoesn't WordPress count on PHP filename to know which file is for Page & which for Posts?\n\n*\n\n*Here's the theme structure:\n\n\n\n*\n\n*Here's C:\\xampp\\htdocs.htaccess content:\n\n\n<IfModule mod_rewrite.c>\nRewriteEngine On\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /index.php [L]\n</IfModule>\n\n\n\nA: This is because you did not put singular.php in the URL, and if you did it wouldn't make any sense. Remember, WordPress loads the template, not the other way round, your mental model of how this works is upside down.\n\nWhat's going on? Why is singular.php the file being accessed while PHP prints that the current filename is /index.php?\n\nBecause the entry point to WordPress is index.php in the root. index.php then loads WordPress, and starts up the CMS for that request. It'll look at your URL, convert it into arguments for fetching stuff from the database, then it grabs them. Then, it goes through a list of rules to figure out how to display that content, and picks a template file from your theme. So by the time it goes to load singular.php it already knows which posts there are. singular.php doesn't make it display a single post, it's the other way around, displaying a single post makes it load singular.php.\nSince $_SERVER[\"PHP_SELF\"] refers to the PHP file that was loaded by the server to handle the request, not the current file it is being run in, it will return index.php.\n\nHow does WordPress know that it should load singular.php (& not any other php file)? I looked at page & I even don't read this line at all:\n\nYour server does not load singular.php, WordPress does. singular.php is just a PHP file that's meant to display a singular post. Take a look at the template hierarchy for the full flow diagram of WordPress decides which template to load to display what it fetched from the database.\nAnother way to think of the misunderstanding is this:\n\nWhen somebody writes on a piece of paper, how does the ink know to put the words in the persons head? And why does it say the person not the paper when I ask who the author is?\n\nClearly that doesn't make sense when put in more familiar terms\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404668", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Two plugins using the same CSS id I have two plugins that use the same CSS id, in this case id=\"TB_ajaxContent\" which I guess means that those two plugins use the ThickBox widget to display things in a popup blackbox.\nOne of those plugins added the !important tag on some CSS properties on their ThickBox which breaks the layout of the other plugin's ThickBox.\nI imagine that this could happen quite often since many plugins surely must use the same common JavaScript widgets.\nIs there a way around this so that I won't be limited in my use of plugins because they happen to use the same widgets and one of them tweaks them to fit their plugin which could break the other?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404669", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom default settings for WP native Gallery Block I've started with MarkJ's answer - JavaScript included into the block editor.\nI wanted to control more attributes for gallery than linkTo \u2014 the number of columns, cropping, and image size.\nwp.domReady( function() {\n    wp.blocks.registerBlockVariation(\n        'core/gallery', {\n            isDefault: true,\n            attributes: {\n                columns: 6,\n                imageCrop: false,\n                linkTo: 'media',\n                sizeSlug: 'thumbnail', // does NOT work in WP 5.9.3\n            }\n        }\n    );\n});\n\nThis snippet does the job partially. In WP editor block settings panel it looks like OK.\n\nUnfortunately, in fact the size of every image in the gallery remains large. Still needs an intervention (change to another size, then back to thumbnail).\nIs this a sizeSlug bug, or\nis there a better way to achieve custom defaults for Gallery Block?\n\nA: Your understanding of what the default is, is incorrect. \"isDefault for new blocks\" would be a more accurate interpretation, those existing blocks are not this variant.\nThink of it this way, if I'm building a row of houses then the plans/blueprints are the default. Changing the plans does not magically transform all the houses that have already been built.\nYou've told WP when a gallery is created, these are the initial attributes to use when setting this variant. So new gallery blocks would have these attributes, assuming this variant.\nRemember, variants are presets, if you create a gallery block that is not this variant, give it 6 columns, link to media, no crop, and a thumbnail, then it becomes this variant. Default values are initial values, not permanent dynamic values that change when you change the defaults.\nLikewise, if you create a facebook embed, and modify its attributes to insert a twitter URL, then it becomes a twitter embed block, because they are all variants of core/embed. The attributes determine which variant a block is, not the other way around.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404670", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why can my subscribers create new posts for review? My subscribers seem to have permission to create posts. After reading the documentation on capabilities, this shouldn't be the case. Subscribers should only be able to manage their own profile.\nI have tested this with all plugins disabled and using the default 2022 theme, and new users are still able to create posts.\nHow do I troubleshoot this, since it doesn't seem to be a theme or plugin issue? Is this a bug in the latest release, perhaps?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404674", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to manage same slug posts suffix method? domain.tld/post-name   |   post_id = 5\n\nand\ndomain.tld/post-name-2 |   post_id = 77\n\nThe above scenario is the solution brought by wordPress.\nLet's complicate this a bit and add it as a prefix for example or timestamp etc. If we want to add something, how do we do it?\n\nA: Developers can use the following filter:\n/**\n     * Filters the post slug before it is generated to be unique.\n     *\n     * Returning a non-null value will short-circuit the\n     * unique slug generation, returning the passed value instead.\n     *\n     * @since 5.1.0\n     *\n     * @param string|null $override_slug Short-circuit return value.\n     * @param string      $slug          The desired slug (post_name).\n     * @param int         $post_ID       Post ID.\n     * @param string      $post_status   The post status.\n     * @param string      $post_type     Post type.\n     * @param int         $post_parent   Post parent ID.\n     */\n    $override_slug = apply_filters( 'pre_wp_unique_post_slug', null, $slug, $post_ID, $post_status, $post_type, $post_parent );\n\nIt is then the programmer's responsibility to ensure uniqueness of the slug.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404675", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Storing transients giving database error Sorry if vague, trying to track down recent website slowdown reasons, and query monitor shows me this as a DATABASE ERROR consistently for two particular transients being added:\n\nFollowing the stacktrace seems to be a dead end, why is this throwing an error?\nThe line that triggers it is from my custom plugin setting a standard html-filled transient (10,000-20,000 chars), which has worked fine:\nset_transient( $transient_name, $html, $transient_seconds );\n\nBy the way, running SHOW FULL COLUMNS FROM wp_options works fine in phpmyadmin\nI also checked wp_options and saw the timeouts for these particular transients stored, but not the transient/values itself.\nAny ideas?\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404677", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: the_title() & the_content() are retrieving Post details inside a Page, after calling a shortcode I'm trying to create a custom theme, since I need to convert html pages to be used at WordPress.\nIn about.php page, I have this shortcode to retrieve posts of a category:\n<?php echo do_shortcode('[categoryposts catname=\"about-section-1\"]'); ?>\nfunctions.php:\n function wpb_postsbycategory($atts='') {\n\n    // Get parameters\\attributes from shortcode\n    $attributes = shortcode_atts(\n        array(\n            'catname' => '',//this is default value\n        ),\n        $atts,\n        'featured'\n    );\n\n   // the query\n   $the_query = new WP_Query( array( \n       'category_name' => $attributes['catname'], \n       'posts_per_page' => 5\n   ) );\n      \n   // The Loop\n   $string = \"\";\n   if ( $the_query->have_posts() ) {\n       $string .= '<ul class=\"postsbycategory widget_recent_entries\">';\n       while ( $the_query->have_posts() ) {\n           $the_query->the_post();\n               if ( has_post_thumbnail() ) {\n                    $string .= '<li>';\n                    $string .= '<a href=\"' . get_the_permalink() .'\" rel=\"bookmark\">' . get_the_post_thumbnail($post_id, array( 50, 50) ) . get_the_title() .'</a></li>';\n               } else { \n                    // if no featured image is found\n                    $string .= '<li><a href=\"' . get_the_permalink() .'\" rel=\"bookmark\">' . get_the_title() .'</a></li>';\n               }\n            }\n    } else {\n        // no posts found\n        $string .= '<li>No Posts Found</li>';\n   }\n   $string .= '</ul>';\n      \n   return $string;\n      \n   /* Restore original Post Data */\n   wp_reset_postdata();\n }\n // Add a shortcode\n add_shortcode('categoryposts', 'wpb_postsbycategory');\n\nThough about.php is a PAGE (since I linked it using Template Name), if I use the_title() & the_content():\n\n*\n\n*before the shortcode line, they properly get current Page title & content.\n\n*but after the shortcode line, they wrongly get some Post title & content.\n\nQuestion:\nHow can I retrieve Page title & content (instead of Post), after having used shortcode? Do I need some reset functionality?\n\nA: \nDo I need some reset functionality?\n\nYes, you do \u2014 when you call $the_query->the_post(), the global $post variable will be modified so that the the_ functions like the_title(), the_content() and the_permalink() will use the current post in your custom loop, and thus after the loop ends, you should call wp_reset_postdata() in order to restore the $post global to the current post in the main query (that's referenced via the global $wp_query variable), because otherwise then the issue in question would happen.\nAnd your code/function is actually calling wp_reset_postdata(), except that it never got called because it's called after the return line, i.e. you did return $string; wp_reset_postdata();..\nSo you would just need to swap their position, like so:\nwp_reset_postdata(); // call this first\n\nreturn $string;      // then return the output\n\nBut I would probably call the function right after the while block ends, i.e. while ( ... ) { ... } wp_reset_postdata();, because there's nothing to reset if the $the_query->the_post() didn't run.\nAdditionally, the $post_id as in get_the_post_thumbnail($post_id, array( 50, 50) ) is never defined in your code, so you should change that to get_the_ID(), or use null instead to use the current post in your loop.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404681", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there a wordpress filter to edit the markup of inline images? I would like to add a class to wordpress inline images. Is there a filter that i can use to edit its markup?\n\n\n\nA: You can click the vertical \"...\" menu > \"Edit as HTML\" and add your class there manually.\nThere is currently no other interface field to directly add a class to an inline image tag out of the box.\nA plugin could overload the toolbox of the inline image, but currently only the width is editable.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404683", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WooCommerce (Bookings) + AddOns not always calculating correctly the total I have WooCommerce, Bookings and Product AddOns installed and have a random bug/issue when a visitor chooses an option with a product. The total is not always correct on the checkout page, sometimes the cost of the AddOn is not counted in the total.\nAny idea how this can happen?\nthanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404685", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Multisite and how to apply sef urls only to specific sites I have a WordPress Multisite installation with its main url set to\nhttps://web.mydomain.com\n(there are some nginx proxies behind this url which I can't manage)\nMost of the sites are generated as\nhttps://web.mydomain.com/site1\nhttps://web.mydomain.com/site2\nhttps://web.mydomain.com/site3\nOne of the sites has a special url set (masked in one of nginx proxies) as:\nhttps://specialname.mydomain.com\n(which internally -i guess- redirects to https://web.mydomain.com/site1 without user noticing that)\nI've already edited site's settings in WP Site Manager to reflect this url and works\nSiteurl: https://specialname.mydomain.com\nHome: https://specialname.mydomain.com\nMultisite already has an .htaccess file set for sef-urls which is working, but:\nIf I enable (in Permalink settings) the \"entry-name\" (or other) option https://specialname.mydomain.com/example-page/ all the links (including home) give 404\nIs there any way to make sef-urls work for this specific site redirection in .htaccess?\nHere's actual .htaccess code:\nRewriteEngine On\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\nRewriteRule ^([_0-9a-zA-Z-]+/)?wp-admin$ $1wp-admin/ [R=301,L]\nRewriteCond %{REQUEST_FILENAME} -f [OR]\nRewriteCond %{REQUEST_FILENAME} -d\nRewriteRule ^ - [L]\nRewriteRule ^([_0-9a-zA-Z-]+/)?(wp-(content|admin|includes).*) $2 [L]\nRewriteRule ^([_0-9a-zA-Z-]+/)?(.*\\.php)$ $2 [L]\nRewriteRule . index.php [L]\n\nThanks a lot for any tip you can give me about this\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404686", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: the Customizer - proper way to instantiate an image upload control via javascript I am trying to create an image control using:\nwp.customize.control.add(\n  new wp.customize.Control(\n    myControlSettingID\n    {\n      type: \"image\",\n      button_labels: {select: 'Select image', change: 'Change image', remove: 'Remove', default: 'Default', placeholder: 'No image selected'...}\n      description: \"Upload or select an image for this featured link\"\n      id: \"issue_section_term_apple_settings_link_image\"\n      label: \"Custom image\"\n      priority: 1\n      section: \"issue_section_term_apple_section\"\n    }\n  )\n);\n\nI am using the \"type\" property and set it to \"image\" which is what the WP_Customize_Image_Control php class has set for the class \"type\" property.\nThis is only spitting out the label and description, and an empty \"attachment media view\" div and doesnt produce an active media UI:\n<div class=\"attachment-media-view\">\n            \n    <div class=\"actions\">\n                    \n    </div>\n</div>\n\nDo I need to instantiate the control another way, or trigger a JS function to activate the controls?\nAlso - somewhat related. Because I am creating the control via javascript that means that wont work right?  I am trying to toggle this control based on the value of another control.  Will I need to manually bind the controls together?\n\nA: You would just need to add a canUpload: true to your control's options (the 2nd parameter for wp.customize.Control) and then the .actions div would have an upload button.\nHowever, clicking the button would not do anything (the media modal/popup would not appear), hence you need to instead use the specific class for image upload control, which is wp.customize.ImageControl.\nWorking Example (tested with WordPress v5.9.3):\nwp.customize.control.add( new wp.customize.ImageControl( myControlSettingID, {\n    section: 'issue_section_term_apple_section',\n    label: 'Custom image',\n    button_labels: {\n        select: 'Select image',\n        ...\n        frame_title: 'Select image',\n        frame_button: 'Choose image'\n    },\n    canUpload: true,\n    setting: wp.customize( myControlSettingID )\n} ) );\n\nRemember though, that the image upload control will return only the image URL, so if you need its ID, then use new wp.customize.MediaControl instead.\nReferences, or resources that might help you further:\n\n*\n\n*The WP_Customize_Media_Control class (see the to_json() and get_default_button_labels() methods).\n\n\n*https://make.wordpress.org/core/2017/11/01/improvements-to-the-customize-js-api-in-4-9/\n\n\n*https://developer.wordpress.org/themes/customize-api/the-customizer-javascript-api/\n\n\n*and the source code of wp-admin/js/customize-controls.js (see lines 7875-7881).\nAs for this:\n\nI am trying to toggle this control based on the value of another\ncontrol. Will I need to manually bind the controls together?\n\nExcerpt from the 3rd link/resource above:\n\nThere are also activate() and deactivate() methods now for\nmanipulating this active state, for panels, sections, and controls.\nThe primary purpose of these states is to show or hide the object\nwithout removing it entirely from the Customizer.\n\nSo if that's your purpose, then you can use the above methods, like Twenty Twenty-One did, like so: (see assets/js/customize.js)\n// Wait until the customizer has finished loading.\nwp.customize.bind( 'ready', function() {\n    // Hide the \"respect_user_color_preference\" setting if the background-color is dark.\n    if ( 127 > twentytwentyoneGetHexLum( wp.customize( 'background_color' ).get() ) ) {\n        wp.customize.control( 'respect_user_color_preference' ).deactivate();\n        wp.customize.control( 'respect_user_color_preference_notice' ).deactivate();\n    }\n\n    ...\n} );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404688", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: How can I add a filter for specific categories on functions.php? Hi,\nI am on functions.php and I want to add this filter:\nfunction graphene_alter_the_query( $request ) {\n    $dummy_query = new WP_Query(); \n    $dummy_query->parse_query( $request );\n    if (!is_category('25')) {\n     $request['gdsr_sort'] = 'rating';\n    }\n    else {\n        $request['gdsr_sort'] = 'comment_count';\n    }\n    return $request;\n}\nadd_filter( 'request', 'graphene_alter_the_query' );\n\nthe filter should do the same thing for all categories except cat 25 but seems like it cant tell it apart like if the IF condition is not detecting the category so I tried to debug it by looking at the values in WP_Query and I get this:\n$myquery = new WP_Query(); print_r($myquery);\n\nWP_Query Object ( [query] => Array ( [category_name] => 'my cat' ) [query_vars] => Array ( [category_name] => 'my cat' [error] => [m] => [p] => 0 [post_parent] => [subpost] => [subpost_id] => [attachment] => [attachment_id] => 0 [name] => [pagename] => [page_id] => 0 [second] => [minute] => [hour] => [day] => 0 [monthnum] => 0 [year] => 0 [w] => 0 [tag] => [cat] => [tag_id] => [author] => [author_name] => [feed] => [tb] => [paged] => 0 [meta_key] => [meta_value] => [preview] => [s] => [sentence] => [title] => [fields] => [menu_order] => [embed] => [category__in] => Array ( ) [category__not_in] => Array ( ) [category__and] => Array ( ) [post__in] => Array ( ) [post__not_in] => Array ( ) [post_name__in] => Array ( ) [tag__in] => Array ( ) [tag__not_in] => Array ( ) [tag__and] => Array ( ) [tag_slug__in] => Array ( ) [tag_slug__and] => Array ( ) [post_parent__in] => Array ( ) [post_parent__not_in] => Array ( ) [author__in] => Array ( ) [author__not_in] => Array ( ) ) [tax_query] => WP_Tax_Query Object ( [queries] => Array ( [0] => Array ( [taxonomy] => category [terms] => Array ( [0] => 'my cat' ) [field] => slug [operator] => IN [include_children] => 1 ) ) [relation] => AND [table_aliases:protected] => Array ( ) [queried_terms] => Array ( [category] => Array ( [terms] => Array ( [0] => 'my cat' ) [field] => slug ) ) [primary_table] => [primary_id_column] => ) [meta_query] => [date_query] => [post_count] => 0 [current_post] => -1 [in_the_loop] => [comment_count] => 0 [current_comment] => -1 [found_posts] => 0 [max_num_pages] => 0 [max_num_comment_pages] => 0 [is_single] => [is_preview] => [is_page] => [is_archive] => 1 [is_date] => [is_year] => [is_month] => [is_day] => [is_time] => [is_author] => [is_category] => 1 [is_tag] => [is_tax] => [is_search] => [is_feed] => [is_comment_feed] => [is_trackback] => [is_home] => [is_privacy_policy] => [is_404] => [is_embed] => [is_paged] => [is_admin] => [is_attachment] => [is_singular] => [is_robots] => [is_favicon] => [is_posts_page] => [is_post_type_archive] => [query_vars_hash:WP_Query:private] => 6d85cdf18f3e6a58a470a3002d5807fc [query_vars_changed:WP_Query:private] => [thumbnails_cached] => [stopwords:WP_Query:private] => [compat_fields:WP_Query:private] => Array ( [0] => query_vars_hash [1] => query_vars_changed ) [compat_methods:WP_Query:private] => Array ( [0] => init_query_flags [1] => \n\nbut both tag_id and cat appear empty. Why is that?\nThank you.\n\nA: As pointed out in this answer, using the request filter means that some (if not all) of WordPress's is_* functions are unavailable. Use the corresponding member functions of your new WP_Query instead, as they should be available.\nfunction graphene_alter_the_query( $request ) {\n    $dummy_query = new WP_Query(); \n    $dummy_query->parse_query( $request );\n    if ( ! $dummy_query->is_category( 25 )) {\n     $request['gdsr_sort'] = 'rating';\n    } else {\n        $request['gdsr_sort'] = 'comment_count';\n    }\n    return $request;\n}\nadd_filter( 'request', 'graphene_alter_the_query' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404689", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there an additional block.json property to set to get an InnerBlocks child to respect the \"supports\" property? My InnerBlock child block doesn't seem to respect the block.json \"supports\" property and I can't understand why not.\nFor reference, this custom block is comprised of:\n\n*\n\n*a parent ucomm-blocks/accordion-block\n\n*a child ucomm-blocks/accordion-block-item\nThe relevant parts of their block.json files look like this...\naccordion-block.json\n{\n  \"$schema\": \"https://schemas.wp.org/trunk/block.json\",\n  \"apiVersion\": 2,\n  \"name\": \"ucomm-blocks/accordion-block\",\n  \"title\": \"Accordion\",\n  \"icon\": \"menu\",\n  \"category\": \"ucomm-blocks\",\n  \"allowedBlocks\": [\n    \"ucomm-blocks/accordion-block-item\"\n  ],\n  \"attributes\": {\n    // non-relevant attributes\n  }\n}\n\naccordion-block-item.json\n{\n  \"$schema\": \"https://schemas.wp.org/trunk/block.json\",\n  \"apiVersion\": 2,\n  \"name\": \"ucomm-blocks/accordion-block-item\",\n  \"title\": \"UConn Accordion Item\",\n  \"icon\": \"menu\",\n  \"category\": \"ucomm-blocks\",\n  \"parent\": [\n    \"ucomm-blocks/accordion-block\"\n  ],\n  \"allowedBlocks\": [\n    \"core/columns\",\n    \"core/cover\",\n    \"core/embed\",\n    \"core/group\",\n    \"core/heading\",\n    \"core/image\",\n    \"core/list\",\n    \"core/paragraph\",\n    \"core/separator\",\n    \"core/spacer\"\n  ],\n  \"attributes\": {\n    \"backgroundColor\": {\n      \"type\": \"string\"\n    }\n  },\n  \"supports\": {\n    \"anchor\": true,\n    \"color\": {\n      \"background\": true,\n      \"text\": true,\n      \"gradients\": false,\n      \"link\": false\n    }\n  }\n}\n\nWhen I add the supports.color property to the parent, the background/text color picker appears as expected for the parent. However, adding it to the child doesn't appear to do anything. The allowedBlocks of the accordion items all work correctly as well. No errors are thrown regarding the accordion block and I haven't found anything in the documentation that accounts for this. In all other respects these blocks work correctly. What am I doing wrong here?\nThanks for any help you can provide.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404691", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Check If Taxonomy A and Taxonomy B has same Slug, 301 Auto Redirect Tax A to Tax B if True in Wordpress Please How do I achieve this?\nI have WordPress Default Taxonomy - Tag and a custom Taxonomy - Artist.\nI want to check for TAGS that have the same slug as ARTIST and 301 redirect it to the ARTIST.\n\nExample Check If: website.com/tag/drake and website.com/artist/drake have the same slug which is true.\n\nthen\n\nAutomatically 301 Redirect: website.com/tag/drake to website.com/artist/drake\n\nIf the slug is not the same, then do nothing.\n\nI found this Answer but it's not exactly what I need and I don't know how to make it solve my problem. I am very new to WordPress development.\nThanks\n\nA: Try this, which should work, and if necessary, replace the artist on the 5th line below with the correct taxonomy slug:\nadd_action( 'template_redirect', 'my_301_redirect_tag_to_artist' );\nfunction my_301_redirect_tag_to_artist() {\n    if ( is_tag() ) {\n        // Check if an \"artist\" term exists with the same slug as the current tag.\n        $artist = term_exists( get_queried_object()->slug, 'artist' );\n\n        if ( is_array( $artist ) && isset( $artist['term_id'] ) ) {\n            $artist_id = (int) $artist['term_id']; // this ensures it's an integer\n\n            // Perform a safe 301 redirect to the \"artist\"/term archive page.\n            wp_safe_redirect( get_term_link( $artist_id ), 301 );\n            exit;\n        }\n    }\n}\n\nThings to note:\n\n*\n\n*is_tag() is one of the many conditional tags in WordPress, and is_tag() checks if the current page is a tag archive, where \"tag\" here refers to the core post_tag taxonomy in WordPress. You can learn more about conditional tags here.\n\n\n*term_exists() checks if a specific term (tag, category or custom taxonomy's term) exists in the WordPress database, and basically returns an array containing the term ID if the term does exist.\n\n\n*get_queried_object() retrieves the data of the current term where the slug normally presents in the current URL as in https://example.com/tag/tag-slug/.\nOr without permalinks or URL rewriting, the above URL might look like https://example.com/?tag=tag-slug instead.\n\n\n*wp_safe_redirect(), as the name implies, safely redirects to a local URL, i.e. a location at your WordPress website. And in my example, you could see that I explicitly set the status (the 2nd parameter) to 301 because the default one is 302.\n\n\n*get_term_link() retrieves the permalink/URL of a term, and in your case, the URL would look like https://example.com/artist/artist-slug/.\n\n\n*template_redirect is an action hook which fires before WordPress determines and loads the template for the current request, and I used it because the documentation stated:\n\nThis action hook executes just before WordPress determines which\ntemplate page to load. It is a good hook to use if you need to do a\nredirect with full knowledge of the content that has been queried.\n\nThe last 10 words in the last sentence means, by the time the hook runs, WordPress has already setup the main query and determined what the request is for (e.g. a Page, a term archive, a search results page, etc.), and thus conditional tags would work as expected.\nSo I hope that helps, and be sure to visit the above links and understand those functions, instead of simply copy-pasting my code. :) Happy coding!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404694", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Making WP_Query limit results by date before today where date is a meta_query We have a custom post type, events. This has a custom field called event_start.\nIn trying to query only past events, I'd like to limit the query with this basic logic:\n\n*\n\n*post type is events\n\n*event_start is not empty\n\n*event_start is a date before today\n\nFor this I've composed what seems to be a straightforward query:\n$args = array(\n  'post_type'        => 'events',\n  'posts_per_page'   => -1,\n  'meta_query' => array(\n           'relation' => 'AND',\n            array(\n                'key'     => 'event_start',\n                'value'   => $today,\n                'compare' => '<'\n            ),\n            array(\n                'key'     => 'event_start',\n                'compare' => 'EXISTS' \n            ),\n            array(\n                'key'     => 'event_start',\n                'compare' => '!=',\n                'value'   => ''\n            ),\n        ),\n);\n\n$query = new WP_Query($args);\n\nBut this is returning all the events. What am I missing? Appreciate any pointers, thanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404697", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp_dropdown_categories() works correctly but the list is not filtered in admin for custom post type. What is the problem? When the filter is executed the correct query is passed as\nedit.php?s&post_status=all&post_type=banner&action=-1&m=0&banner_cat=31&filter_action=Filter&paged=1&action2=-1\nhowever the items list remains the same and shows all items from all categories.\n\nthe coding\nSelect field\nadd_action('restrict_manage_posts', function($posttype) \n{\n    if( $posttype != 'banner' )\n        return;\n    $tax = 'banner_cat';\n    \n    $selected = (isset($_GET[$tax]) ? $_GET[$tax] : '');\n    wp_dropdown_categories([\n    'show_option_all' => get_taxonomy($tax)->label,\n    'taxonomy'        => $tax,\n    'name'            => $tax,\n    'orderby'         => 'name',\n    'order' => 'DESC',\n    'selected'        => $selected,\n    'hide_empty'      => false,\n    'hierarchical' => true\n    ]);\n});\n\nA quest for solution has returned the below filter but I don't see the logic and using it has not corrected the results.\nglobal $pagenow;\n                \nif( $pagenow == 'edit.php' ) \n{\n    add_filter('parse_query', function($query) \n    {\n        $tax = 'banner_cat';\n        $q = $query->query_vars;\n        if( isset($_GET['filter_action']) ) {\n            $term = get_term_by('id', $_GET[$tax], $tax);\n            $q[$tax] = $term->slug;\n        }\n    });\n}\n\nDo I need to run new  WP_Query() and rebuild the HTML table? It seems like a query overkill so I figure there is a hook or method that is needed.\nEdit to show post_type and taxonomy registration\nadd_action('init', function() {\n\nregister_post_type('banner', [\n'public' => true,\n'rewrite' => false,\n'menu_icon' => 'dashicons-admin-page',\n'show_admin_column' => true,\n'exclude_from_search' => true,\n'publicly_queryable' => true,\n'hierarchical' => true,\n'description' => 'Handle advertising banners',\n'query_var' => true,\n'taxonomies'=>['banner_cat'],\n'supports' => [\n    'title',\n    'thumbnail',\n    'author',\n    'excerpt',\n    //'editor'\n    ],\n'labels' => [\n    'name'=>'Banners',\n    'add_new'=>'Add Banner',\n    'archives' => 'Categories'\n    ],\n]);\n\nregister_taxonomy('banner_cat', 'banner', [\n    'labels' => [\n    'name' => 'Categories', \n    'singular_name' => 'Category',\n    'parent_item' => 'Parent Category',\n    'parent_item_color' => 'Parent Category:',\n    'edit_item' => 'Edit Category',\n    'update_item' => 'Update Category',\n    'add_new_item' => 'Add Category',\n    'new_item_name' => 'Category Name',\n    'menu_name' => 'Category',\n    'all_items'=>'All Categories',\n    ],\n    'public'=>true,\n    'hierarchical'      => true,\n    'show_ui'           => true,\n    'show_admin_column' => true,\n    'query_var'         => true,\n    'rewrite'           => false,\n]);\n\n});\n\n\nA: \nDo I need to run new  WP_Query() and rebuild the HTML table?\n\nNo, you absolutely do not need to! And actually, you don't even need to hook on parse_query (which BTW, is an action and not a filter).\nAll you need to do is set your categories dropdown's name to the taxonomy name/slug, which you've already done so, and set the value_field argument to slug, and then WordPress will automatically filter the posts based on the selected banner_cat term.\nSo just remove the entire add_filter('parse_query', ...) part from your code, and set the value_field like so:\nwp_dropdown_categories([\n    'show_option_all' => get_taxonomy($tax)->label,\n    'taxonomy'        => $tax,\n    'name'            => $tax,   // use the taxonomy name/slug\n    'orderby'         => 'name',\n    'order'           => 'DESC',\n    'selected'        => $selected,\n    'hide_empty'      => false,\n    'hierarchical'    => true,\n    'value_field'     => 'slug', // set to 'slug'\n]);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404698", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Let users sell video in my website I have a WordPress website with version 5.9 and I want functionality to sell video content.\nThese videos could be uploaded by the website users and they can decide the price of their uploaded videos. I also want to keep a small fee as commission.\nWhat plugin do you recommend for it?\n\nA: If you have an education website LearnDash could be a good choice. It's a good plugin but doesn't include a free version. Users can register as teacher and sell their courses.\nOther option could be the combination of WooCommerce and a marketplace plugin like Dokan or YITH WooCommerce Multi Vendor.\nBoth has nearly same features.\nI personally prefer Dokan because it offers a good minimum free version at WordPress repository.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404699", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add class and change src type inside wp_oembed_get So I don't know how to properly do this and I've already spent like 3+ hours attempting to figure this out, so I'm getting help from the community.\nWhat I'm trying to achieve:\n\n*\n\n*Add class='optanon-category-C0002' and change the src to data-src in the iFrame that wordpress builds up.\n\nHere is what I have:\npublic function get_modal()\n{\n    $config = [\n        'content' => '<p>The video is currently unavailable.</p>',\n    ];\n    $video_link = '';\n    if ($video = $this->get_video()) {\n        foreach ($this->get_video()->get_sources() as $each_video) {\n            $video_link .= $each_video->src;\n        }\n        $config['id'] = 'id-' . spl_object_hash($video);\n        if (strpos($video_link, 'youtube')) {\n            $config['content'] = wp_oembed_get($video_link, [\n                'width' => 640,\n                'height' => 480\n            ]);\n        }\n    }\n\n    return new Modal($config);\n}\n\nwp_oembed_get builds up a whole iFrame based on the link provided, such as this:\n<iframe title=\"Jason Kidd, Jalen Brunson &amp; Josh Green React to Dallas Mavs 50th Win, Luka's Insane Pass to Doe\" width=\"640\" height=\"360\" src=\"https://www.youtube.com/embed/OvLkjtcxIA8?feature=oembed\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\"></iframe>\n\nThere are various filters such as oembed_dataparse and oembed_result, but I was not successful in altering the iFrame at all, so all help will be appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404706", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Removing advanced section from brand new gutenberg block I have created a new Gutenberg block using block.json with minimalistic options. However, the Advanced Section automatically appeared.\n\nHow do I remove this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404707", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Hook to add_action('updated_option_my_option', [$this, 'save_data'], 10, 3]); i want to modify my options data after save. Therefore i want to hook into \"updated_option\". This works without problem.\nI create a new option called \"my_update_option\" and want also hook into \"updated_option_my_update_option\" but this won't work.\nDid anyone know whats wrong in my code below?\nclass MyClass {\n\npublic function __construct()\n{\n    add_action('admin_init', [$this, 'theme_init']);\n    add_action('admin_menu', [$this, 'theme_menu']);\n\n    add_action('updated_option', [$this, 'save_options'], 10, 3);\n    add_action('updated_option_my_update_option', [$this, 'save_my_update_option'], 10, 3);\n}\n\npublic function theme_init()\n{\n    register_setting('my_update_option', 'theme_options', 'lapocus_validate_options', 'checkOption');\n}\n\npublic function theme_menu()\n{\n    add_menu_page('Main Page', 'Main Page', 'my_update_option', 'menu-slug', [$this, 'main_page'], 'dashicons-admin-network', 2);\n    add_submenu_page('menu-slug', 'Sub Page', 'Sub Page','my_update_option', 'menu-slug' . '-subpage-online-form', [$this, 'subpage_online_form']);\n}\n\npublic function save_my_update_option($oldvalue, $value, $option) {\n   // do something\n}\n\n\nA: This is no updated_option_{$option} filter.\nYou'd have to use update_option_{$option} instead:\n    /**\n     * Fires after the value of a specific option has been successfully updated.\n     *\n     * The dynamic portion of the hook name, `$option`, refers to the option name.\n     *\n     * @since 2.0.1\n     * @since 4.4.0 The `$option` parameter was added.\n     *\n     * @param mixed  $old_value The old option value.\n     * @param mixed  $value     The new option value.\n     * @param string $option    Option name.\n     */\n    do_action( \"update_option_{$option}\", $old_value, $value, $option );\n\nDon't forget to remove your filter before if you save the option again:\nclass MyClass {\n\npublic function __construct()\n{\n    add_action('admin_init', [$this, 'theme_init']);\n    add_action('admin_menu', [$this, 'theme_menu']);\n\n    add_action('updated_option', [$this, 'save_options'], 10, 3);\n    add_action('update_option_my_update_option', [$this, 'save_my_update_option'], 10, 3);\n}\n\npublic function theme_init()\n{\n    register_setting('my_update_option', 'theme_options', 'lapocus_validate_options', 'checkOption');\n}\n\npublic function theme_menu()\n{\n    add_menu_page('Main Page', 'Main Page', 'my_update_option', 'menu-slug', [$this, 'main_page'], 'dashicons-admin-network', 2);\n    add_submenu_page('menu-slug', 'Sub Page', 'Sub Page','my_update_option', 'menu-slug' . '-subpage-online-form', [$this, 'subpage_online_form']);\n}\n\npublic function save_my_update_option($oldvalue, $value, $option) {\n  // Begin prevent infinite loop\n  remove_action('update_option_my_update_option', [$this, 'save_my_update_option'], 10);\n\n  // do something\n  $value = $this->change_value($old_value, $value);\n\n  // save the option again\n  update_option('my_update_option', $value);\n\n  // End prevent infinite loop\n  add_action('update_option_my_update_option', [$this, 'save_my_update_option'], 10, 3);\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404710", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: woocommerce remove coupon link does not work Woocommerce remove coupon link does not work in custom cart page:\nHere is code my Code:\n<div class=\"report-text-cntr-cart row mr-0 ml-0 <?php echo ( WC()->customer->has_calculated_shipping() ) ? 'calculated_shipping' : ''; ?>\">\n\n    <?php do_action( 'woocommerce_before_cart_totals' ); ?>\n    <div class=\"col-xl-5 col-lg-4 col-md-4 col-sm-12 col-12 total-cntr cart-subtotal\">\n        <label>\u0642\u06cc\u0645\u062a \u06a9\u0644 : </label>\n        <span data-title=\"<?php esc_attr_e( 'Subtotal','woocommerce' ); ?>\"><?php wc_cart_totals_subtotal_html(); ?></span>\n    </div>\n    <?php foreach ( WC()->cart->get_coupons() as $code => $coupon ) : ?>\n        <div class=\"col-xl-2 col-lg-4 col-md-4 col-sm-12 col-12 send-cntr coupon-<?php echo esc_attr( sanitize_title( $code ) ); ?>\">\n            <label><?php wc_cart_totals_coupon_label( $coupon ); ?></label>\n            <span data-title=\"<?php echo esc_attr( wc_cart_totals_coupon_label( $coupon, false ) ); ?>\"><?php wc_cart_totals_coupon_html( $coupon ); ?></span>\n        </div>\n    <?php endforeach; ?>\n\ncode output ajax is:\n?wc-ajax=remove_coupon\n\nbut applied coupon didn`t remove after user clicked on remove link.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404711", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Multiple If Else with WP Query in Wordpress Could anybody help me with this?\nI want to have max 3 post from this query:\ncategory name: activities\nBut if the post is labeled with the tag private there must be a link with the words private link.\nOtherwise the words are public link.\nCould somebody explain and show me how to do this?\nThank you so much for this!\nCODE:\n<?php $wpb_all_query = new WP_Query(array('category_name' => 'activities', 'post_type' => 'post', 'post_status' => 'publish', 'posts_per_page' => 3)); ?>\n\n<div class=\"row\">\n    <?php if ($wpb_all_query->have_posts()) :\n        while ($wpb_all_query->have_posts()) : $wpb_all_query->the_post();\n            $wpb_link_query = new WP_Query(array('category_name' => 'activities', 'tag' => 'private', 'post_type' => 'post', 'post_status' => 'publish'));\n            if ($wpb_link_query->have_posts()) :\n                while ($wpb_link_query->have_posts()) : $wpb_link_query->the_post(); ?>\n                    <a href=\"<?php the_permalink(); ?>\">private link</a>\n                <?php endwhile;\n                wp_reset_postdata();\n            else : ?>\n                <a href=\"<?php the_permalink(); ?>\">public link</a>\n        <?php endif;\n        endwhile;\n        wp_reset_postdata();\n    else : ?>\n        <p><?php _e('Sorry, no posts matched your criteria.'); ?></p>\n    <?php endif; ?>\n</div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404712", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: how to show youtube comment profile pic in wordpress i want to show youtube user's comment section profile pic in my wordpress comment section\nAs i am fetching youtube video along with its commnets but i couldn't show user's profile image in my comment section in my blog\ncomment i fetched with profile pic\n\nin blog comment section its showing blank or default image gravatar\n\nurl i got for author\nhttps://yt3.ggpht.com/ytc/AKedOLRFowb1wyXwkxTIi3UgCrpJlBxZJuP4WLA9vK6f=s48-c-k-c0x00ffffff-no-rj|\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404714", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to redirect old permalinks from https://exmaple.com/category/post_id to https://exmaple.com/category/post_id.html How to redirect old permalinks from  https://exmaple.com/category/post_id to https://exmaple.com/category/post_id.html\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404715", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to set 'column-primary' to backoffice 2nd column by default I'm customizing the way custom posts are displayed in the backoffice.\nI'm trying to shift the section that appear on hover (I'm refering to the four buttons Edit, Quick edit, Trash, Preview) in the first column to the second one.\nThe reason is that the section, even if is hidden, takes up space vertically.\nIt seems that the edit section is assigned to the column that is signed with the class column-primary, so I'd like to assign that class to the second column by default\nActually is like this:\nThis is how should be:\nAny suggestions?\nThanks in advance\n\nUPDATE\nI've seen that this function is managed by the file /wp-admin/includes/class-wp-list-table.php\n\nI've tried changing default primary column to line 1077 by assigning the value \"Titolo\" because it is the value reported in data-colname when inspecting the page\nDoes anyone know where the mistake is?\nThanks in advance\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404721", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there any point setting the keys and salts in wp-config.php? I'm auto-generating WordPress (5.9.3) sites on a VPS. I could, as part of the generation script, create random strings for the various keys and salts in wp-config.php. However, there doesn't appear to be any unequivocal statement in the docs that this is actually necessary, and various sources appear to state that WP will generate the keys and salts anyway if there are none in wp-config.php.\nTwo questions:\n\n*\n\n*If I choose to leave this up to WP, what should I actually put in wp-config.php? I don't want to leave in the default 'put your unique phrase here', because the end-user is then guaranteed to complain that the site is \"insecure\" and I don't know what I'm doing. Can I just delete the key/salt lines?\n\n*Some sources (this SO answer, for example) appear to state that putting the keys and salts in wp-config.php is \"more secure\" than using the database version. Does this make any sense? In my case, the database (MariaDB 10.3.34) has no non-localhost access, and the DB passwords appear to be stored as two rounds of SHA1 hashing, which is fairly secure. Realistically speaking, it's much more likely that someone will break into the server itself, via Apache or otherwise, and simply read the plaintext DB password out of... wait for it... wp-config.php. And, if they can do that, cookie security is irrelevant anyway.\n\n\nA: \n\n*\n\n*If I choose to leave this up to WP, what should I actually put in wp-config.php?\n\n\nSounds like something you can easily find out. My guess: if you don't have the define('AUTH_KEY', ..) etc. statements, the system will not work.\n\n\n\n*Some sources (this SO answer, for example) appear to state that putting the keys and salts in wp-config.php is \"more secure\" than using the database version.\n\n\nWith clever SQL injections it is possible to read data from the DB, even if I don't have direct access to it. So all I need to get the keys is one plugin that has a SQL vulnerability and I can get them.\nIf I store part in the filesystem and part in the DB, just access to information from the DB is not sufficient anymore.\nAs suggested in the other answer, just use WP's generator or any of the other ones (e.g. this from roots.io) and supply these keys differently for each site that you spin up.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404722", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Timber right sidebar in Wordpress theme How can I add the right sidebar only in Blog posts using the Timber theme running in WordPress? I tried all I could find, but for some reason, it's not showing up correctly. Followed the docs.\nbut I can only see in the top left corner heading \"Latest News\" and nothing else.\n{# sidebar.twig #}\n<h3>Latest News</h3>\n{% for post in recent %}\n    <h4><a href=\"{{post.get_path}}\">{{post.post_title}}</a></h4>\n{% endfor %}\n\nAdded to single.php:\n$context['dynamic_sidebar'] = Timber::get_widgets('dynamic_sidebar');\nTimber::render('sidebar.twig', $context);\n\nIf I add to single.twig anywhere these lines:\n<aside class=\"my-sidebar\">\n{{dynamic_sidebar}}\n</aside>\n\nnothing really changes at all. If I add it in single.php it shows on every blog post page but in the left top corner (at the very beginning).\nNow I have full-width posts, and my single.twig looks like:\n{% extends \"base.twig\" %}\n{% block content %}\n    <div class=\"content-wrapper\">\n        <article class=\"post-type-{{ post.post_type }}\" id=\"post-{{ post.ID }}\">\n            <img src=\"{{ post.thumbnail.src|resize(1200, 300) }}\">\n            <section class=\"article-content\">\n                <h1 class=\"article-h1\">{{ post.title }}</h1>\n                <a href=\"{{ post.link }}\">{{ _e('edit') }}</a>\n                <p class=\"blog-author\">\n                    <span>By</span><a href=\"{{post.author.path}}\"> {{ post.author.name }} </a><span>&bull;</span> {{ post.date }}\n                </p>\n                <div class=\"article-body\">\n                    {{post.content}}\n                </div>\n            </section>\n\n            <!-- comment box -->\n            <section class=\"comment-box\">\n                <!-- comments -->\n                <div class=\"comments\">\n                    {% if post.comments %}\n                    <h3> comments </h3>\n                    {% for cmt in post.comments %}\n                        {% include \"comment.twig\" with {comment:cmt} %}\n                    {% endfor %}\n                    {% endif %}\n                </div>\n\n                {% if post.comment_status == \"closed\" %}\n                    <p> comments for this post are closed </p>\n                {% else %}\n                    <!-- comment form -->\n                    {% include \"comment-form.twig\" %}\n                {% endif %}\n            </section>\n        </article>\n    </div><!-- /content-wrapper -->\n{% endblock %}\n\nadded in functions.php\n$context['recent'] = new Timber\\PostQuery(array(\n    'post_type' => 'post',\n    'posts_per_page' => 5,\n));\n\nHow to put e.g. 3/4 column with post data and 1/4 column on the right with the widget? Looks I'm not even rendering single.twig in single.php file.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404723", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Debugging permalink issue I moved a wordpress site into a subdirectory on the same folder and changed the WP address and site address to reflect this.\nI then used search-replace on the database files to replace the previous url with the subdirectory url.\nI then re-saved the permalink structure from the wp-admin control page and checked that the .htaccess file looks OK - it includes the following:\n<IfModule mod_rewrite.c>\nRewriteEngine On\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule ./index.php [L]\n</IfModule>\n\nThe old site home page loads, and I am able to access the wp-admin page, but none of the permalinks work. If I enter the url with the post/page id directly into the browser (eg. www.mysite.com/oldsite/?page_id=12 ) I can still access the content directly.\nI threw the debugging script from here into functions.php and interestingly even going to the home site triggers an error (but without the script index.php still gets displayed presumably because the rewrite is handling the 404 error).\nI have saved the debug script output here (forum won't let me post here as it it thinks it is spam).\n\nA: OK fixed it!\nI had some errant lines in the .htaccess file:\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /index.php [L]\n# WP REWRITE LOOP END\n\nThis was taking precedence over the <IfModule mod_rewrite.c> block - and explains why it was redirecting to the parent directory.\n(The lesson here is if you are asking for questions about .htaccess, it is probably good to post the whole .htaccess file rather than just a snippet!)\n\nA: If your WordPress files are inside a subdirectory, your htaccess should reflect that. I don't see a subdirectory in your htaccess lines. Check out below:\n<IfModule mod_rewrite.c>\nRewriteEngine On\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\nRewriteBase /oldsite/\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /oldsite/index.php [L]\n</IfModule>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404725", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Custom fields values not being created I made a form for vendors to submit bicycle infos for selling in the website, it creates a new woocommerce product but some taxonomies values are not being created, as you can see in image below. Default wp fields are fine. I already tried to set existent or set a new with id name, but unsucessfully\nam I doing sth wrong? thanks\nForm made with Gravity forms.\nhttps://prnt.sc/W1Zm98AmtVYW\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404733", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress custom taxonomy not showing I have a simple custom Taxonomy\n  register_taxonomy( 'categories', array('career'), array(\n        'hierarchical' => true,\n        'label' => 'Departments',\n        'singular_label' => 'Department',\n    )\n);\n\nand I am trying show a list of the Taxonomy like so ..\n   $terms = get_terms(\n    array(\n        'taxonomy'   => 'career',\n        'hide_empty' => false,\n    )\n);\n\nif ( ! empty( $terms ) && is_array( $terms ) ) {\n    foreach ( $terms as $term ) { ?>\n        <a href=\"<?php echo esc_url( get_term_link( $term ) ) ?>\">\n            <?php echo $term->name; ?>\n        </a><?php\n    }\n}\n?>\n\nyet nothing is displaying, I have been over and over for a few hours and cant see the problem, can anyone see why this is not displaying ?\nThank you\n\nA:    $terms = get_terms(\n    array(\n        'taxonomy'   => 'career',\n        'hide_empty' => false,\n    )\n);\n\nYour taxonomy isn't called career. Your taxonomy is called (confusingly) categories.\nIf you check the docs, you'll see the second argument passed to register_taxonomy is the object type (eg, post, my_cpt) that the tax is to be used on. So in your registration you are creating a taxonomy called categories that will be used on the career post type.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404736", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change script type and src of plugins in theme So I have to implement OneTrust which requires all <script type=\"text/javascript\"> to be converted to <script type=\"text/plain\"> and there are various plugins that use script tags that I need to change.\nSo let's say that Contact Form 7 has the following snippet in their plugin:\n$assets = wp_parse_args( $assets, array(\n    'src' => wpcf7_plugin_url( 'modules/recaptcha/index.js' ),\n    'dependencies' => array(\n        'google-recaptcha',\n        'wp-polyfill',\n    ),\n    'version' => WPCF7_VERSION,\n    'in_footer' => true,\n) );\n\nwp_register_script(\n    'wpcf7-recaptcha',\n    $assets['src'],\n    $assets['dependencies'],\n    $assets['version'],\n    $assets['in_footer']\n);\n\nwp_enqueue_script( 'wpcf7-recaptcha' );\n\nHow do I properly change all the types and src to data-src of each enqueued script individually?\nAlso, how would I go about adding classes to the script tag?\nDo I deregister and deenqueue each script and then register and enqueue it again?\nI've tried using the following to change the script src, but it didn't work:\nfunction onetrust_script_manipulation($tag, $handle) {\n    switch($handle) {\n        case 'google-recaptcha':\n            return str_replace(' src', ' data-src', $tag);\n        default:\n            return $tag;\n    }\n}\nadd_filter('script_loader_tag', ns('onetrust_script_manipulation'), 10, 2);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404738", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to get the url of an Image with id If I have the id of an image media file, how can I get the url, to download it via rest api?\nI'm using the Pods Plugin to create my own objects. thes have images included i want to download via rest api.\nI tried\nwp_get_attachment_image_src( $imgid, $default );\n\nor\nwp_get_original_image_path($imgid);\n\nall came back empty\nI got the id with\n$imgid = $designpod->fields( 'app_logo' )\u2192id;\n\ni also tried\n$imgid = $designpod->fields( 'app_logo' )->id;\n$design[\"app_logo\"] = $designpod->pods_image_url($imgid, null );\n\nalso not working /returns empty.\nthat also seems to return the wrong id. it returns 75, but if i look it up in media, it has 76 as id.\nSorry, I have no clue about PHP - i'm a C# programmer.\nMaybe anyone can help me with this.\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404739", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Exclude post with taxonomy and from the terms (taxonomy & tag) posts count Using the below code, i have excluded the taxonomy (slug:expired) from archive or tag or taxonomies pages in front-end.\nadd_action('pre_get_posts','custom_get_posts');\nfunction custom_get_posts($query) {\n    \n  if ( !is_admin() && $query->is_main_query() ) {\n        $taxquery = array(\n            array(\n                'taxonomy' => 'current-status', \n                'field' => 'slug',\n                'terms' => array( 'expired' ),\n                'operator' => 'NOT IN'\n            )\n        );\n        if( $query->is_post_type_archive( 'job' ) || $query->is_tag() || $query->is_tax() || $query->is_search() || $query->is_term() || $query->is_category() ){ \n          $query->set('tax_query', $taxquery );\n        }\n    }\n}\n\n\nThe function excluded all the posts tagged to the taxonomy \"expired\".\nHowever, the term or tag post counts shows all or entire posts count. How to exclude the posts from the count?\nfor example: without the taxonomy[expired], posts in the taxonomy[phd-positions] is 700 https://nviewscareer.com/position/phd/. But in the term counts it shows 3453 posts which includes the taxonomy[expired].\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404741", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Filter sub-category from checkbox form I\u2019m having have a checkbox filtering issue in wordpress - Please have a look at the details below - Any help would greatly be appreciated!\nWhat I\u2019ve built:\nI created three custom taxonomies of topics, skateboard and wheels.\nI have a page that displays the taxonomies with the slug that looks something like this:\n/topics/skateboard/wheels\nI created another taxonomy called regions with three locations North America , South America , All of America.\nI rendered the regions as check boxes onto the page for filtering.\nMy issue:\nThe page /topics/skateboard/wheels is rendering all of the posts associated to its respective taxonomies yet when I select North America - The query returns all of the posts from the database that has North America checked.\nI can\u2019t get the filter to only return posts associated to this slug topics/skateboard/wheels.\nSo i\u2019d like to return posts with North America checked marked only associated to topics -> skateboards -> wheels.\nSo all of the wheels in North America.\nForm with checkboxes:\n          <?php \n            \n            if($_GET['regions[]'] && !empty($_GET['regions[]'])) {\n              $regions = $_GET['regions[]'];\n            }\n            \n            ?>\n\n            <form action = \"\" method=\"GET\">\n              <?php \n                $terms = get_terms([\n                  'taxonomy' => 'regions',\n                  'hide_empty' => false\n                ]);\n                foreach ($terms as $term) :\n              ?>\n              <label>\n                  <input\n                  type=\"checkbox\"\n                  name=\"regions[]\"\n                  value=\"<?php echo $term->slug?>\"\n                  \n                  <?php \n                  checked(\n                    (isset($_GET['regions']) && in_array($term->slug, $_GET['regions']))\n                    ) ?>\n                  /> \n                  <?php echo $term->name; ?>\n            </label>\n            <?php endforeach; ?>\n            <button class=\"uk-button-filter\" type=\"submit\"> Apply Filter </button>\n            </form>\n\nThe Query:\n  <?php\n              $terms = get_terms( 'regions' ); \n              $term_ids = wp_list_pluck( $terms, 'slug' );\n              $args_one = \n              array(\n                  'post_type' => 'post',\n                  'tax_query' => array(\n                      array(\n                          'taxonomy' => 'regions',\n                          'field' => 'slug',\n                          'terms' => $_GET ? $_GET['regions'] : $term_ids,\n                      ),\n                      'relation' => 'AND',\n                  ),\n              );\n\n          ?>\n\nThe Results:\n<?php \n      $the_query = new WP_Query( $args_one );\n\n    // The Loop\n    if ( $the_query->have_posts() ) {\n    while ( $the_query->have_posts() ) {\n        $the_query->the_post(); ?>\n\n      <li>\n\n        <?php echo get_the_title();  ?>\n\n      </li>\n\n\n        \n    <? }\n    } else {\n    // no posts found\n    }\n    /* Restore original Post Data */\n    wp_reset_postdata();\n                            \n    ?>  \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404742", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Paragraph Tags removed when contents are only a shortcode I'm developing a plugin that given a shortcode with attributes will scan a json file and return the appropriate data etc.\nGiven code like this:\n<!-- wp:paragraph -->\n<p>[environ data=\"day_max\" format=\"long\"]</p>\n<!-- /wp:paragraph -->\n\n<!-- wp:paragraph -->\n<p>[environ data=\"day_min\"]</p>\n<!-- /wp:paragraph -->\n\nData is being returned like\n9.82\u00b0C at 12:49:59 AM 9.82\u00b0C\nwithout the paragraphs and bunched together. If I add any leading text the problem vanishes (see below).  If I place short codes within table cells it vanishes.  The issue only presents itself if the short code is alone in a paragraph.\n<!-- wp:paragraph -->\n<p>Test [environ data=\"day_max\" format=\"long\"]</p>\n<!-- /wp:paragraph -->\n\nreturns\n<p>Test 9.82\u00b0C at 12:49:59 AM</p>\nI've looked at Remove empty p-Tags in Shortcode content before non p-Tags and similar posts but they don't seem to address this issue.\nMy code is a add_shortcode('environ', array(&$byteenviron ,'byteenviron_display_handler')); function call to byteenviron_display_handler which processes the attributes and returns a string.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404746", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get Comma Seperated Taxonomy Linked Terms and Last Child Separated By \"&\" Instead Of Comma I Want to List Custom Taxonomy Terms with Link and Separate Each with Comma but add \"&\" before the last term.\nExample:\n\nDrake, Migos, Ciara & Nicki\n\nI found this answer that shows how to add '&' before the last term. BUT the terms are not linked which is what I am trying to achieve.\nMY CURRENT CODE:\n $terms = get_the_terms( $post->ID, 'artist' );\n            foreach($terms as $index => $term) {\n                $enIndex = sizeof($terms) - 2;\n    $end = (isset($terms[$enIndex]) && $index == $enIndex ? ' & ' : ', ');\n    $entry_terms .= $term->name . $end;\n    $term_link = get_term_link( $term );               \n            }\n            $entry_terms = rtrim( $entry_terms, ', ' );\n                                       \n echo '<a href=\"' . esc_url( $term_link ) . '\">' . $entry_terms . '</a>';           \n\nCURRENT RESULT OF MY CODE:\n\nDrake, Migos, Ciara & Nicki\n\nMy code is not working fine. It links all terms to the last term link only. Please help check my code. I am new WordPress development. Thanks.\n\nA: What you're asking is a generic PHP/programming question, and this: \"It links all terms to the last term link only\", is because your code clearly is attaching the link (i.e. the last value assigned to $term_link) to the entire list ($entry_terms), i.e. echo '<a href=\"' . esc_url( $term_link ) . '\">' . $entry_terms . '</a>'.\nSo what you should have done is, attach the link to the term name on this line: $entry_terms .= $term->name . $end;, like so:\n\n*\n\n*Replace this part:\n$entry_terms .= $term->name . $end;\n$term_link = get_term_link( $term );\n\nwith this:\n$term_link = get_term_link( $term );\n$entry_terms .= '<a href=\"' . esc_url( $term_link ) . '\">' . $term->name . '</a>' . $end;\n\nAnd then, after that:\n\n*\n\n*Replace the $entry_terms = rtrim( $entry_terms, ', ' ); with echo rtrim( $entry_terms, ', ' );.\n\n\n*Remove the echo '<a href=\"' . esc_url( $term_link ) . '\">' . $entry_terms . '</a>';.\nAdditional Notes\n\n*\n\n*You should define $entry_terms before the foreach line, i.e. add $entry_terms = '';.\n\n\n*The ampersand sign is being displayed to the user, hence you need to escape the character, i.e. use ' &amp; ' instead on line 4 in your original code.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404747", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: My plugins are ending up above the header? Trying to start writing some plugins, however everytime i use the shortcode that calls my function plugin, the function ends up above the header on that page, instead of right where i placed the shortcode.\nHere is an example of what i used:\n\n\nA: Shortcodes should return their content, never echo it.\nFrom the add_shortcode() docs:\n\nNote that the function called by the shortcode should never produce an output of any kind. Shortcode functions should return the text that is to be used to replace the shortcode. Producing the output directly will lead to unexpected results.\n\nBut the functions you appear to be using\u2014the_title() and the_date()\u2014both echo their output by default. Consider using get_the_title() and get_the_date() instead. You'll need to refactor some of the rest of your code too, but this should be a good starting point.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404750", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Select Option Load Custom Fields I created a new post type called \"Programs\" and i created custom fields on Programs width Advanced Custom Fields plugin. I want to compare the Programs fields with each other on the page width select option.\nLike this;\n\nI brought the program names to the select section.\n<div class=\"ud-program-check__table-header-item\">\n                    <?php\n                    $posts = get_posts (array (\n                        'numberposts' => -1,   // -1 returns all posts\n                        'post_type' => 'programs',\n                        'orderby' => 'title',\n                        'order' => 'ASC'\n                    ));\n                ?>\n                <select id=\"my_great_select\" name=\"my_great_select\">\n                    <?php foreach ($posts as $post): ?>\n                        <option id=\"<?php echo $post->ID; ?>\" value=\"<?php echo $post->post_title; ?>\"><?php echo $post->post_title; ?></option>\n                    <?php endforeach; ?>\n                </select>\n                </div>\n\nbut I don't know how to fetch the custom fields every time a selection is made (width ajax and javascript).\nI want the selected program information to load in the table below;\n<div class=\"ud-program-check__table-item\">\n                    <div class=\"ud-program-check__table-item-container ud-program-check__table-item-container--bg-gray\"></div>\n                    <div class=\"ud-program-check__table-item-container\"></div>\n                    <div class=\"ud-program-check__table-item-container ud-program-check__table-item-container--bg-gray\"></div>\n                    <div class=\"ud-program-check__table-item-container\"></div>\n                    <div class=\"ud-program-check__table-item-container ud-program-check__table-item-container--bg-gray\"></div>\n                    <div class=\"ud-program-check__table-item-container\"></div>\n                    <div class=\"ud-program-check__table-item-container ud-program-check__table-item-container--bg-gray\"></div>\n                    <div class=\"ud-program-check__table-item-container\"></div>\n                    <div class=\"ud-program-check__table-item-container ud-program-check__table-item-container--bg-gray\"></div>\n                    <div class=\"ud-program-check__table-item-container\"></div>\n                    <div class=\"ud-program-check__table-item-container ud-program-check__table-item-container--bg-gray\"></div>\n                    <div class=\"ud-program-check__table-item-container\"></div>\n                    <div class=\"ud-program-check__table-item-container ud-program-check__table-item-container--button ud-program-check__table-item-container--bg-gray\">\n                        <a href=\"#\" class=\"ud-btn ud-btn--program-check\">Get Started\n                            <div class=\"ud-btn__icon\">\n                                <img src=\"assets/icons/right-arrow.png\" class=\"ud-btn__icon-img\">\n                            </div>\n                        </a>\n                    </div>\n                </div>\n\nCan you help me please?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404751", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Remove cpt slug from url and use custom taxonomy instead breaks all other cpt Im trying to do so, it works but also affects all other cpt (404 for all cpt but not resources one)\nthis is what I have\nIn the cpt definition\n...\n\n        'rewrite' => array(\n                      'slug' => 'resource/%resource_type%',\n                       'with_front' => false\n                     )\n...\n\nthe post link filter\n// Rewrite urls of resources and put category on url\nfunction wpa_course_post_link( $post_link, $id = 0 ){\n    $post = get_post($id);  \n    if ( is_object( $post ) ){\n        $terms = get_the_terms( $post->ID, 'resource_type' );\n        \n        if(get_post_type($post->ID) == 'resource' ) {\n            if( $terms ){\n                return str_replace( 'resource/%resource_type%', $terms[0]->slug, $post_link );\n            }else{\n                return home_url( \"/resource/\".$post->post_name );\n            }\n        }else{\n            return $post_link; \n        }\n    }\n}\nadd_filter( 'post_type_link', 'wpa_course_post_link', 1, 3 );\n\n\nand the problem here, the rewrite rule, if I comment this action all works but the resources does not(404), and if I uncomment this resources works (with the custom url) but all the other cpt does not (404)... so i dont know\nfunction resource_rewrite_rules() {\n    add_rewrite_rule(\n        '^(.*)/(.*)/?$',\n        'index.php?post_type=resource&resource_type=$matches[1]&name=$matches[2]',\n        'top'\n    );\n        \n}\nadd_action( 'init', 'resource_rewrite_rules' );\n\n\nany help?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404752", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Include widget file in functions.php of child theme I've created a widget for WP 5.9.3, based on an online tutorial, which I'd got working okay, but it relied on having all the code in the child theme's functions.php, which started looking a bit messy.\nSo, I've put all the code into a separate file, in the base directory of the child theme, and tried to require it from within the child theme's functions.php.\nHowever, now it doesn't seem to work, or get registered, at all. After several hours of tinkering, it still doesn't seem to be recognized at all. I've looked at a ton of other questions, but I can't find anything which works. The site loads still, but the widget is not visible either on the site or in the Admin area.\nAmong the things I've tried putting into functions.php, besides hard-coding (last resort) the path, are the following:\n1) require_once('my_widget1.php');\n\n2) define('MY_THEME_FOLDER_PATH', trailingslashit(get_template_directory(__FILE__)));\n   require_once (MY_THEME_FOLDER_PATH . 'my_widget1.php');\n   \n3) require_once( get_stylesheet_directory() . '/my_widget1.php');\n\nThe actual path to the widget file is:\n/var/www/sites/xyz/wp_main/wp-content/themes/mychildtheme/my_widget1.php\n\nI haven't used WP very much, but I'm mystified as to why it doesn't work. I guess I'm missing something obvious, but I'm not sure how to make further progress. Any suggestions and assistance would be much appreciated.\nPer the request in the comments, here's the widget code (just minus the output bits). It's basically an example from WPB which I modified, and, as noted, already does work fine when the code is actually inside functions.php. Linux permissions 644.\n<?php\n\n// Widget Creation\nclass wpb_widget extends WP_Widget {\n\nfunction __construct() {\nparent::__construct(\n\n// Base ID of your widget\n'wpb_widget',\n\n// Widget name will appear in UI\n__('WPBeginner Widget', 'wpb_widget_domain'),\n\n// Widget description\narray( 'description' => __( 'Sample widget', 'wpb_widget_domain' ), )\n);\n}\n\n// Creating widget front-end\n\npublic function widget( $args, $instance ) {\n$title = apply_filters( 'widget_title', $instance['title'] );\n\n// before and after widget arguments are defined by themes\necho $args['before_widget'];\nif ( ! empty( $title ) )\necho $args['before_title'] . $title . $args['after_title'];\n\n// This is where you run the code and display the output\n\n$post_id = get_the_ID();\n\n# ... then a bunch of stuff to output \n\necho $args['after_widget'];\n}\n\n// Widget Backend\npublic function form( $instance ) {\nif ( isset( $instance[ 'title' ] ) ) {\n$title = $instance[ 'title' ];\n}\nelse {\n$title = __( 'New title', 'wpb_widget_domain' );\n}\n// Widget admin form\n?>\n<p>\n<label for=\"<?php echo $this->get_field_id( 'title' ); ?>\"><?php _e( 'Title:' ); ?></label>\n<input class=\"widefat\" id=\"<?php echo $this->get_field_id( 'title' ); ?>\" name=\"<?php echo $this->get_field_name( 'title' ); ?>\" type=\"text\" value=\"<?php echo esc_attr( $title ); ?>\" />\n</p>\n<?php\n}\n\n// Updating widget replacing old instances with new\npublic function update( $new_instance, $old_instance ) {\n$instance = array();\n$instance['title'] = ( ! empty( $new_instance['title'] ) ) ? strip_tags( $new_instance['title'] ) : '';\nreturn $instance;\n}\n\n// Class wpb_widget ends here\n}\n\n\n// Register and load the widget\nfunction wpb_load_widget() {\n    register_widget( 'wpb_widget' );\n}\n\n?>\n\nIf it's of any relevance, the child theme I'm using is derived from the momentous-lite theme.\n\nA: Okay, so after a couple of days pulling my hair out, I finally realized that I needed to add the following line, after the require_once line in functions.php:\nadd_action('widgets_init', 'wpb_load_widget');\n\n... and everything then worked perfectly. (where wpb_load_widget is the name of my register-widget function in the widget file itself.)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404754", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wpdb prepare without placeholder Recently, I found out why there are a lot of PHP Notice on my debug.log. It is because of wpdb:prepare needing placeholders. Documentation says that I need to do:\n$wpdb->get_results( $wpdb->prepare( \"SELECT * FROM `table` WHERE `column` = %s AND `field` = %d OR `other_field` LIKE %s\", array( 'foo', 1337, '%bar' ) ) );\n\nBut for me I use:\n$wpdb->get_results( $wpdb->prepare( \"SELECT * FROM `table` WHERE `column` = \" . $foo . \" AND `field` = \" . $intvalue . \" OR `other_field` LIKE \" . $bar ) );\n\nSince I find it easier to read. If I do the 2nd option, can I skip $wpdb->prepare if I use the 2nd option? Or should I change my query to the 1st option since this is what is in the documents.\n\nA: Short answer:\nYou should use the way described in the documentation, sanitize anything that goes in an SQL query, and always use prepared statements.\nSlightly longer answer:\nThe main use of $wpdb->prepare() is to prevent against SQL injection attacks.\nHere, we don't know where 'foo', 1337 and '%bar' come from. And that's somewhat the deciding factor.\nFrom a security perspective:\n\n*\n\n*If it doesn't come in any way (even indirect) from user input, it's ok not to use prepared statements\n\n*If it comes from user input, even indirectly, the prepared statement is required\n\n*Most importantly, no one can predict the future: these variables' value may not, directly or indirectly, come in any way from user input, but an update down the line might change that.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404755", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: How to get a random single category name in get_posts()? How can I get a random category name one at a time?? The post may have multiple category instead of a single category. I just want to show a single category name in the post grid loop.\n$home_blog_posts = get_posts(array(\n    'posts_per_page'    =>  3\n));\n\nThanks.\n\nA: You can use wp_get_post_categories to get the categories from your posts. Then you can use array_rand to get one random category from that array.\nCheck out these links on how to use wp_get_post_categories and array_rand to suit your needs:\nhttps://developer.wordpress.org/reference/functions/wp_get_post_categories/\nhttps://www.php.net/manual/en/function.array-rand.php\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404759", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I want a simple dropdown for locations in woocommerce I want to have multi locations for pickup. I want it no where in site, only in checkout when someone click pickup at local pickup, then this dropdown appear. And also it go in emails etc and so on.\nI tried plugins but none of plugin work like this. One work and they are not fixing bug.\nIs there any way that I just put the list or custom post type in backed for the list of local pickups, and as soon as person click on local pickup, then the list appear in dropdown just next to it.\nPlease help\nThanks a lot in advance...\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404760", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: display specific category when website loads I have a website with WordPress and I want to load a specific category when the page loads. I have not tried it. Will it create problems or error if I change it.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404761", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get next post link of child custom post type from parent post and get next post link of parent post from the last child post? I have a custom post type with this structure:\nFirst Parent\n\n*\n\n*1st child of First Parent\n\n*2ndchild of First Parent\n\n*3rd child of First Parent\n\nSecond Parent\n\n*\n\n*1st child of Second Parent\n\n*2nd child of Second Parent\n\n*3rd child of Second Parent\n\nI'm trying to make previous_post_link() and next_post_link() to work that when you are in the First Parent, the next_post_link() will go to the 1st child of First Parent and then when you are in the 1st child of First Parent, you go to the 2nd child of First Parent. When you are in the 3rd child of First Parent, you go to Second Parent when you click next and go to 2nd child of First Parent when you click back.\nBasically, by clicking next and prev link, you go to every page in that sequence regardless of child or parent posts.\nRight now, what happens is that when you are in the parent posts, the next_post_link() will link you to the next parent post.\nCurrently when you click on next:\nFirst Parent -> Second Parent.\nI want it to be like this:\nFirst Parent -> first child of First Parent -> second child of First Parent -> third child of First Parent -> Second Parent -> first child of Second Parent .. and so on.\nHere's what I have on my single-post-type.php\n<li class=\"nav-item\">\n        <?php if (get_previous_post_link()) : ?>\n        <?php previous_post_link( '%link', '<i class=\"bi bi-arrow-left-square\"></i>' ); ?>\n        <?php else : ?>\n        <a class=\"nav-link disabled\" href=\"#\" tabindex=\"-1\" aria-disabled=\"true\"> <i class=\"bi bi-arrow-left-square\"></i></a>\n        <?php endif; ?>\n</li>\n<li class=\"nav-item\">\n        <?php if (get_next_post_link()) : ?>\n        <?php next_post_link( '%link', '<i class=\"bi bi-arrow-right-square\"></i>' ); ?>\n        <?php else : ?>\n        <a class=\"nav-link disabled\" href=\"#\" tabindex=\"-1\" aria-disabled=\"true\"> <i class=\"bi bi-arrow-right-square\"></i></a>\n        <?php endif; ?>\n</li>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404762", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Create a custom posts page I've created a template that shows all my blog posts. But the issue was that this page slug (tips-and-tricks) wasn't added to the URL of the single post.\nSolution: I've selected this page as my blog page under Settings > Read. Now my url is\nhttps://domain.com/tips-and-tricks/post-name.\nIssue: When I select the page as my blog page, the custom template isn't used anymore. Wordpress uses the index.php file.\nHow can I use my custom template for this page?\n\nA: When you select a page as your blog page, the template that WordPress is looking for is the home.php file.\nYou should really check out the Template Hierarchy from the WordPress documentation as these things are really WordPress basic knowledge. Check out the Template Hierarchy here: https://developer.wordpress.org/themes/basics/template-hierarchy/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404763", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to sort WooCommerce products page by latest in-stock items first? How to sort the WooCommerce products page by latest in-stock items first and all the out-of-stock items to the last?\nCurrently, I'm using a code snippet from \"https://www.businessbloomer.com/woocommerce-show-in-stock-products-first-shop/\" and it will sort the products which are in stock first and all the out-of-stock items last. But the problem is the products are not in the latest order. It shows old in-stock products first.\n\nA: There are several options.\n\n*\n\n*If you want to show out of stock but in latest positions you can combine your code snippet with lastest inventary order. You dont need code for this, in customizer theme usually you can change this option:\n\n\n\n\n*If you want to hide out of stock and show in stock by latest. Then deleted your snippet, use same option that 1 and add this option too:\n\nWoocommerce -> Products -> Inventary -> Hide out of stock products.\nIt is the best option for most stores, because it hides the products from the listings, but does not hide product page, and this does not affect seo or require additional work.\nthere's also additional config to hide in serach results like explain here\nMany things that a few years ago had to be done with code, Woocommrece brings that option added.\nOr You can use this free plugin:\nWooCommerce Sort By Stock\nRegards\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404767", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: CPT archive with WP native/core tax/categories So for some reason this is oddly difficult. I need to have a CPT which uses the core categories between the CPT reviews and core posts as news.\nI've tried getting the CPT archives as just URL which is fine until you try to access by category which fails such as /reviews/cpu_mainboard or /reviews/category/cpu_mainboard.\nNext up I tried a custom page template with the query in place and pagination. This worked, but 404's on the paginated results like this: https://stackoverflow.com/questions/41738362/how-to-include-pagination-in-a-wordpress-custom-post-type-query\nAny advise or glaring omissions I'm making here as I've sat on this for a week now and my covid brain cant figure it out. CPT code below:\nfunction cptui_register_my_cpts_reviews() {\n\n    /**\n     * Post Type: Reviews.\n     */\n\n    $labels = [\n        \"name\" => __( \"Reviews\", \"custom-post-type-ui\" ),\n        \"singular_name\" => __( \"Review\", \"custom-post-type-ui\" ),\n        \"menu_name\" => __( \"Reviews\", \"custom-post-type-ui\" ),\n        \"all_items\" => __( \"All reviews\", \"custom-post-type-ui\" ),\n        \"add_new\" => __( \"New review\", \"custom-post-type-ui\" ),\n        \"add_new_item\" => __( \"New review\", \"custom-post-type-ui\" ),\n        \"edit_item\" => __( \"Edit review\", \"custom-post-type-ui\" ),\n        \"new_item\" => __( \"New review\", \"custom-post-type-ui\" ),\n        \"view_item\" => __( \"View review\", \"custom-post-type-ui\" ),\n        \"view_items\" => __( \"View reviews\", \"custom-post-type-ui\" ),\n        \"search_items\" => __( \"Search reviews\", \"custom-post-type-ui\" ),\n        \"not_found\" => __( \"No reviews found\", \"custom-post-type-ui\" ),\n        \"archives\" => __( \"Reviews\", \"custom-post-type-ui\" ),\n    ];\n\n    $args = [\n        \"label\" => __( \"Reviews\", \"custom-post-type-ui\" ),\n        \"labels\" => $labels,\n        \"description\" => \"\",\n        \"public\" => true,\n        \"publicly_queryable\" => true,\n        \"show_ui\" => true,\n        \"show_in_rest\" => true,\n        \"rest_base\" => \"\",\n        \"rest_controller_class\" => \"WP_REST_Posts_Controller\",\n        \"has_archive\" => \"reviews\",\n        \"show_in_menu\" => true,\n        \"show_in_nav_menus\" => true,\n        \"delete_with_user\" => false,\n        \"exclude_from_search\" => false,\n        \"capability_type\" => \"post\",\n        \"map_meta_cap\" => true,\n        \"hierarchical\" => false,\n        \"can_export\" => false,\n        \"rewrite\" => [ \"slug\" => \"reviews\", \"with_front\" => false ],\n        \"query_var\" => true,\n        \"supports\" => [ \"title\", \"editor\", \"thumbnail\", \"custom-fields\", \"revisions\", \"author\", \"post-formats\" ],\n        \"taxonomies\" => [ \"category\", \"post_tag\" ],\n        \"show_in_graphql\" => false,\n    ];\n\n    register_post_type( \"reviews\", $args );\n}\n\nadd_action( 'init', 'cptui_register_my_cpts_reviews' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404770", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to display already created menus via php? So I have a couple of already created menus on my wordpress installation. What I am planning to do is display navigation menus in a sliding popup. I have tried using wp_nav_menu() but it always shows the first (alphabetically) menu instead of the one I want displayed.\n$args = array\n (\n'menu_id' => $short,\n'menu_class' => 'menu',\n'fallback_cb' => false\n );\nwp_nav_menu( $args);\n\n$short is getting the menu name from the URL. As far I have understood the wp_nav_menu function I need to add code to the functions.php as well. Is that correct? I feel like in my usecase that's not the best way to solve the problem, as I want to create 25 sliding navs via PHP. If I have to add code to the functions.php as well for each menu I can do the whole  task manually.\nThank you\n\nA: I found the solution.\nI had to do the following\n$args = array\n(\n'theme_location' => $short,\n'menu_id' => $short,\n'menu_class' => 'menu',\n'menu_id'=>$menu_id,\n'fallback_cb' => false\n );\nwp_nav_menu( $args);\n\nTheme location was the correct attribute.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404772", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add code to `head` with WordPress 5.9 FSE (Full Site Editing) Like adding Google Analytics code, and some other things surrounding the <head> tag, how's all this done in FSE as there's no header.php? Should I use functions.php for everything?\n(Also can somebody make a fse tag in stackexchange?)\n\nA: As far as I understand the wp_head and wp_footer actions should still work under FSE in WP 5.9+, through the template canvas PHP file that's loaded through the locate_block_template(). That PHP file contains the basic HTML structure and there we find e.g. the familiar wp_head() and wp_footer() function calls that we usually had in the old footer.php and header.php theme files. The current block template HTML from get_the_block_template_html() is now displayed within the body tag from the template canvas.\nSo in FSE use e.g. the theme's functions.php file or a custom plugin to add your wp_head and wp_footer actions in PHP.\n\nA: When I was creating a FSE theme I had the same question. I found that the Shorcode Block is an easy way to insert coding into any template. So for a shortcode [custom_content] this is the coding required in the functions file or move the code to a custom.php file in another directory.\n/assets/custom.php\n    function add_custom_content() {\n        ...\n        return [new code...];\n    }\n    add_shortcode('custom_content', 'add_custom_content');\n    \nfunctions.php\nrequire get_template_directory() . '/assets/custom.php';   \n\nEdit: Ok so FSE templates are part of the <body> so this didn't answer the question.\nTo get code into the <head> - this works\n    function add_to_head() {\n        echo '<script> /* code... */ </script>';\n    }\nadd_action( 'wp_head', 'add_to_head' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404774", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "4"}}
{"text": "Q: Display Yoast meta-description `wpseo_desc` within loop of categories and fail silently if no data is set I want to output the Yoast SEO category meta-description within a custom loop. Current code (below) works if there is a meta-description present. However, if no category meta-description is set it breaks.\nIs there a better way to write this so that it fails silently if no meta-description is set\n<?php \n$popular_topics = get_field('popular_topics');\nif( $popular_topics ):\n      foreach( $popular_topics as $topic ): \n        $id    = $topic->term_id;\n        $meta  = get_option( 'wpseo_taxonomy_meta' );\n        $meta_desc   = $meta['category'][$id]['wpseo_desc'];\n        ?>\n          <p class=\"my-paragraph\">\n            <?php echo esc_html( $meta_desc ); ?>\n          </p>\n      <?php endforeach;\nendif; ?>\n\nEdit, wrapped in a simple !empty if statement\nif(!empty( $meta['category'][$id]['wpseo_desc'] )) {\n echo $meta['category'][$id]['wpseo_desc'];\n}\nelse {\n echo \"Meta not present\";\n}\n\n\nA: You can just check if $meta and $meta_desc exist. If not, don't echo anything.\n$popular_topics = get_field('popular_topics');\n\nif ( $popular_topics ) : \n\n    foreach ( $popular_topics as $topic ) : \n\n        $id = $topic->term_id;\n        $meta = get_option('wpseo_taxonomy_meta');\n\n        if ( $id && ( $meta && !empty($meta) ) ) : \n\n            $meta_desc = $meta['category'][$id]['wpseo_desc'];\n\n            if ( $meta_desc ) : ?>\n\n                <p class=\"my-paragraph\">\n                    <?php echo esc_html( $meta_desc ); ?>\n                </p>\n\n                <?php\n\n            endif;\n\n        endif;\n\n    endforeach;\n\nendif;\n\n\nA: Wrap in a !empty statement\nif(!empty( $meta['category'][$id]['wpseo_desc'] )) {\n echo $meta['category'][$id]['wpseo_desc'];\n}\nelse {\n echo \"Meta not present\";\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404776", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Fatal Error Class 'WP_Widget_Pages' not found in /home/****/public_html/wp-includes/class-wp-widget-factory.php So I am not well versed in wordpress and had this site built for a friend and it worked just fine for years. I tried to login to make some changes for him with /wp-admin and got the WSOD. I tried stopping all plugins, reverting to the standard theme and nothing worked. The website still works fine I just cant log in to it. So I turned on debuging through ftp and this is what I got.\nStack trace:\n#0 /home//public_html/wp-includes/widgets.php(115): WP_Widget_Factory->register('WP_Widget_Pages')\n#1 /home//public_html/wp-includes/widgets.php(1809): register_widget('WP_Widget_Pages')\n#2 /home//public_html/wp-includes/class-wp-hook.php(307): wp_widgets_init('')\n#3 /home//public_html/wp-includes/class-wp-hook.php(331): WP_Hook->apply_filters(NULL, Array)\n#4 /home//public_html/wp-includes/plugin.php(474): WP_Hook->do_action(Array)\n#5 /home//public_html/wp-settings.php(592): do_action('init')\n#6 /home//public_html/wp-config.php(119): require_once('/home/zic97gker...')\n#7 /home//public_html/wp-load.php(50): require_once('/home/zic97gker...')\n#8 /home//public_html/wp-blog-header.php(13): require_once('/home/zic97gker...')\n#9 /home/*/public_html/index.php(24 in /home/zic97gkeryai/public_html/wp-includes/class-wp-widget-factory.php on line 61\n[12-Apr-2022 18:48:07 UTC] PHP Fatal error:  Uncaught Error: Class 'WP_Widget_Pages' not found in /home/zic97gkeryai/public_html/wp-includes/class-wp-widget-factory.php:61\nAny help would be great!\n\nA: And your comment got me thinking. Those two folders should be completely untouched so I should be safe to delete the contents and re-upload them. I did that and lo and behold, it works perfect now. Thanks for making me think this through!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404779", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wordpress mysql / wpdb ajax load more for terms help Can anyone pls assist me with my problem. I am not asking for code, but even some guidance as to how to get this working. I have tried many ways, to get my terms to load using ajax load more  and seem to keep having a difficulty with it. The reason for the issue is that i have used $wpdb rather than $wp_query for the data retrieval. Also, I am retrieving terms, not posts. I have ajax load more working for posts, but the same functions cannot be used for wpdb data.\nI find all product category ( terms ) from a custom taxonomy ( workplaces ). I then just want to have the terms load more on the same page rather than normal pagination. ( I have acheived regular pagination but have removed it from here ). I am attempting just a regular load more button, before I change it to infinite.\nThe load more button is getting stuck on Loading... & nothing changes.\nThis is my function to get the initial query, with a limit of 3 to be displayed:\n\nfunction get_product_categories_from_a_product_workplace_all( $workplace_term_slug, $taxonomy = 'workplaces' ) {\n        global $wpdb;\n        global $wp_query;\n        //get the total amount of terms\n        $total_query = $wpdb->get_var(\"SELECT COUNT(*) FROM (SELECT DISTINCT t1.*\n        FROM    {$wpdb->prefix}terms t1\n        INNER JOIN {$wpdb->prefix}term_taxonomy tt1\n            ON  t1.term_id = tt1.term_id \n        INNER JOIN {$wpdb->prefix}term_relationships tr1\n            ON  tt1.term_taxonomy_id = tr1.term_taxonomy_id\n        INNER JOIN {$wpdb->prefix}term_relationships tr2\n            ON  tr1.object_id = tr2.object_id\n        INNER JOIN {$wpdb->prefix}term_taxonomy tt2\n            ON  tr2.term_taxonomy_id = tt2.term_taxonomy_id         \n        INNER JOIN {$wpdb->prefix}terms t2\n            ON  tt2.term_id = t2.term_id\n        WHERE tt1.taxonomy = 'product_cat'\n        AND tt2.taxonomy = '$taxonomy'\n        AND  t2.slug = '$workplace_term_slug' ) AS a\n        \");       \n        $post_per_page  = 3;\n       //get the terms, with a limit of 3\n        $query = ( \"\n            SELECT DISTINCT t1.*\n            FROM    {$wpdb->prefix}terms t1\n            INNER JOIN {$wpdb->prefix}term_taxonomy tt1\n                ON  t1.term_id = tt1.term_id \n            INNER JOIN {$wpdb->prefix}term_relationships tr1\n                ON  tt1.term_taxonomy_id = tr1.term_taxonomy_id\n            INNER JOIN {$wpdb->prefix}term_relationships tr2\n                ON  tr1.object_id = tr2.object_id\n            INNER JOIN {$wpdb->prefix}term_taxonomy tt2\n                ON  tr2.term_taxonomy_id = tt2.term_taxonomy_id         \n            INNER JOIN {$wpdb->prefix}terms t2\n                ON  tt2.term_id = t2.term_id\n            WHERE tt1.taxonomy = 'product_cat'\n            AND tt2.taxonomy = '$taxonomy'\n            AND  t2.slug = '$workplace_term_slug' \n            LIMIT $post_per_page  \n                 \n        \" );\n        $wpdb->show_errors();         \n        $test=   $wpdb->get_results( $query );\n            echo '<div class=\" woocommerce columns-5\"><ul class=\" products columns-5\">';\n        foreach($test as $value){\n          $wp_slug = $wp_query->query_vars['workplaces'];   \n          $cat_slug = $value->slug;                        \n          $cat_name = $value->name;\n    \n          echo '<li class=\"product-category product\"><div class=\"banner-box\"> \n         <div class=\"banner-box__image\"> \n         <a href=\"' . esc_url ( get_bloginfo( 'url' ) ) . '/'. 'product-category'. '/' . esc_html($cat_slug) . '?workplaces=' . esc_html($wp_slug) . '\"';\n          echo theme_woo_subcategory_thumbnail( $value);          \n          echo '</a></div><div class=\"banner-box__info\"><a href=\"' . \n          get_bloginfo( 'url' ) . '/'. 'product-category'. '/' . esc_html($cat_slug) . '?workplaces=' . esc_html($wp_slug) . '/' . '\">' . '<h2 itemprop=\"name\" class=\"woocommerce-loop-category__title\"><span>' . esc_html($cat_name) . '</a></span></h2></li>';  \n     \n        }\n        \n        echo '</ul>';\n        ?>\n        <div class=\"loadmore\">\n          <input type=\"button\" id=\"loadBtn\" value=\"Load More\">\n          <input type=\"hidden\" id=\"row\" value=\"0\">\n          <input type=\"hidden\" id=\"postCount\" value=\"<?php echo $total_query; ?>\">\n        </div> \n\n    }\n<?php\n\n    function db_workplace(){\n\n        if (isset($_POST['row'])) {\n            $start = $_POST['row'];\n            $limit = 3;\n            $query = \"SELECT DISTINCT t1.*\n            FROM    {$wpdb->prefix}terms t1\n            INNER JOIN {$wpdb->prefix}term_taxonomy tt1\n                ON  t1.term_id = tt1.term_id \n            INNER JOIN {$wpdb->prefix}term_relationships tr1\n                ON  tt1.term_taxonomy_id = tr1.term_taxonomy_id\n            INNER JOIN {$wpdb->prefix}term_relationships tr2\n                ON  tr1.object_id = tr2.object_id\n            INNER JOIN {$wpdb->prefix}term_taxonomy tt2\n                ON  tr2.term_taxonomy_id = tt2.term_taxonomy_id         \n            INNER JOIN {$wpdb->prefix}terms t2\n                ON  tt2.term_id = t2.term_id\n            WHERE tt1.taxonomy = 'product_cat'\n            AND tt2.taxonomy = '$taxonomy'\n            AND  t2.slug = '$workplace_term_slug'\n            LIMIT \".$start.\",\".$limit;\n\n            $result = $wpdb->get_results( $query );\n\n            if ($result->num_rows > 0) {\n              while ($row = $wpdb->get_row( $query )) {\n                ?>\n<!--for testing purposes i just want to get the term_id to show so I know it's working but when i get it working properly it will be the html as before -->\n                <div class=\"post\"><?php echo $row['term_id']; ?></div>\n              <?php }\n            }\n          }\n\n\n    }\n\n    add_action('wp_ajax_loadmore-data', 'db_workplace'); // wp_ajax_{action}\n    add_action('wp_ajax_nopriv_loadmore-data', 'db_workplace'); // wp_ajax_nopriv_{action}\n\n\n\nI think this is where my problem lies. I am not sure how to set up the ajax data for the retrieval of more terms\n    add_action( 'wp_footer', 'wpb_hook_load' );\nfunction wpb_hook_load() {\n      ?>\n      <script>\n         jQuery(document).ready(function () {\n           jQuery(document).on('click', '#loadBtn', function () {\n           var row = Number(jQuery('#row').val());\n           var count = Number(jQuery('#postCount').val());\n           var limit = 3;\n           row = row + limit;\n           jQuery('#row').val(row);\n           jQuery(\"#loadBtn\").val('Loading...');\n \n      jQuery.ajax({\n        type: 'POST',\n        url: 'https://stagingwebsite/wp-admin/admin-ajax.php',\n        action: 'loadmore-data',\n        data: 'row=' + row,\n        success: function (data) {\n          var rowCount = row + limit;\n          jQuery('.postList').append(data);\n          if (rowCount >= count) {\n            jQuery('#loadBtn').css(\"display\", \"none\");\n          } else {\n            jQuery(\"#loadBtn\").val('Load More');\n          }\n        }\n      });\n    });\n  });\n</script>\n<?php\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404780", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Only show featured image on first page of paginated posts I'm experimenting with paginated posts on my site using the SmartMag theme, and I've customized my post content template quite a bit.\nHowever, I still have one issue I'd like to fix: On paginated posts, the subsequent pages all show the featured image at the top. Is there a function that is theme agnostic which would only allow the featured image to show on the first page of a paginated post?\n\nA: You can use is_paged() for this. This function determines whether the query is for a paged result and not for the first page. So ofcourse, in your case, you should use !is_paged().\nCheck out the docs here: https://developer.wordpress.org/reference/functions/is_paged/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404782", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Duplicate new categories across multisite network I'm attempting to setup a MultiSite network, and want the same structure across the sites.\nThis includes Categories.\nI've already got code that duplicates Posts - but discovered that if the original post was assigned a category that didn't exist on the other sites in the network,\nWP would just \"create\" a category with the same name (but ignore description, parent etc.).\nI've tried to following function - but see no creation of category on other sites in the network.\nfunction category_to_all( $term_id, $tt_id ){\n\n    remove_action( 'create_category', __FUNCTION__ );\n    \n    $currentcatdata = get_term_by('id', $id, 'category');\n    \n    // Get & Set Category data ready\n    $categorydata = array(\n        'cat_ID'               => $term_id,\n        'taxonomy'             => 'category',\n        'cat_name'             => $currentcatdata->name,\n        'category_description' => $currentcatdata->description,\n        'category_nicename'    => $currentcatdata->slug,\n        'category_parent'      => $currentcatdata->parent,\n    );\n    \n    \n    \n    // Get all blogs/sites, excluding \"current\"\n    $allsiteids = get_sites(array('fields'  => 'ids'));\n    $currentsiteid = get_current_blog_id();\n    if (($key = array_search($currentsiteid, $allsiteids)) !== false) {\n        unset($allsiteids[$key]);\n    }\n    $blog_ids = array_values($allsiteids);\n    \n    foreach( $blog_ids as $blog_id ) {\n        switch_to_blog( $blog_id );\n        //create category?\n    \n        wp_insert_term($categorydata['cat_name'], 'category', \n        array(\n          'description' => $categorydata['category_description'],\n          'slug' => $categorydata['category_nicename'],\n          'parent'=> $categorydata['category_parent']\n          )\n        );\n        \n        restore_current_blog();\n    }\n    \n    \n}\nadd_action( 'create_category', 'category_to_all', 10, 2 );\n\nThe idea is that whenever anyone creates a new category,\nit should be duplicated across the other sites (so new posts can go to the corresponding category per-site).\nAny pointers or help would be appreciated - TY.\n\nA: I think I figured it out.\nI had multiple things wrong with the code:\nfunction category_to_all( $term_id ){\n\n    remove_action( 'create_category', __FUNCTION__ );\n    \n    $currentcatdata = get_term_by('id', $term_id, 'category');\n    \n    \n    $allsiteids = get_sites(array('fields'  => 'ids'));\n    $currentsiteid = get_current_blog_id();\n    if (($key = array_search($currentsiteid, $allsiteids)) !== false) {\n        unset($allsiteids[$key]);\n    }\n    $blog_ids = array_values($allsiteids);\n    \n    foreach( $blog_ids as $blog_id ) {\n        switch_to_blog( $blog_id );\n        \n        $cid = wp_insert_term($currentcatdata->name, 'category', \n        array(\n          'description' => $currentcatdata->description,\n          'slug' => $currentcatdata->slug,\n          'parent'=> $currentcatdata->parent,\n          )\n        );\n        \n        restore_current_blog();\n    }\n}\nadd_action( 'create_category', 'category_to_all', 10, 1 );\n\nThat seems to work, sort of - whatever blog/site your in on the multisite,\nif you create a new category, it gets created on the others as well.\nWhat's missing is handling of \"parent\" - if the IDs don't match,\nit will fail to add a new category due to mismatch.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404783", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What's the point of forbidding access to wp-config.php? Probably a dumb question...\nthe hardening doc suggests setting up your web server so that it prevents access to wp-config.php. If you do this, and a client tries to access the file, Apache returns 403 Forbidden, as expected.\nIf you don't do this, Apache returns 200 Ok with an empty file. This is also as expected, because none of the php code in this file produces any output.\nSo what's the point? Surely this would only be an issue if the attacker had already broken in, and turned off php support?\n\nA: \nSo what's the point? Surely this would only be an issue if the attacker had already broken in, and turned off php support?\n\nIf an attacker has already done this then this particular hardening is pointless. An attacker is unlikely to turn off PHP execution though as that would require more effort and would actually be harder for no gain. It would also make it very obvious you'd been hacked.\nGenerally, wp-config.php contains secrets so this adds an additional layer of security. There is no specific thing it prevents, much like how adding an third wall around a castle doesn't convey any protection the second wall doesn't, it just adds extra obstacles.\nTry not to think of things as \"secure\" or \"not secure\", that's not how website security works. In the same way that your site is neither \"hard\" or \"soft\", you can make it harder, or more secure though.\nWhat's more likely is that while poking around in the server, you make a silly typo or mistake that lists all PHP files as plaintext, so an attack goes to wp-config.php to read your database details but gets a forbidden HTTP code back instead. But the chances of this are incredibly slim.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404784", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: using is_paged for hiding image on posts In my posts I'm using <!--nextpage--> in order to paginate specific blog posts, which works fine. But my issue is that the featured image shows in the post header for each page.\nI've tried using !is_paged but it's not working and I read that it doesn't work for posts using <!--nextpage-->\nThe code I'm using:\nif (isset($props['featured_in_head'])) {\n  if ( !is_paged() ){\n    $props['featured'] = $props['featured_in_head'];\n  }\n}\n\nI've noticed on the sub-pages of this one post that my body has the classes of single-paged-2 or paged-2, but it doesn't look like it has just the paged class, so if there's a way to hide .featured via CSS I could just do that\nAny help is appreciated\n\nA: \nI read that it doesn't work for posts using <!--nextpage-->\n\nNot necessarily, but basically, if the current URL ends with /page/<number> as in https://example.com/page/2/ and https://example.com/category/foo/page/2/, then is_paged() would work, i.e. it returns true on page 2, 3, etc.\nBut for singular posts with a page break, i.e. the <!--nextpage--> tag, where the URL normally ends with /<number> as in https://example.com/hello-world/2/, then is_paged() would return a false.\nHowever, you can use get_query_var( 'page' ) (or the global $page variable) to get the page number and then render the featured image only if the page number is 1 or < 2.\nSo for example, just replace the !is_paged() in your if with (int) get_query_var( 'page' ) < 2, and then that image would no longer appear on page 2, 3 and so on.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404787", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show current custom taxonomy I have a custom post and custom taxonomy my taxonomy is called \"department\"\ni have my loop showing my custom post, I am trying to also show all the departments (custom taxonomy) that my custom post falls under.\nMy different post are all set different departments however I am only seeing the same department on each post, not the department related to the post.\nAm i missing something to show this ?\n<ul>\n                    <?php\n                    $loop = new WP_Query(array('post_type' => 'career', 'posts_per_page' => 10));\n                    $taxonomy = get_queried_object();\n                    while ($loop->have_posts()) :\n                        $loop->the_post(); ?>\n                        <li>\n                            <p><?php echo $term->name; ?></p>\n                            <?php\n                            echo 'Department', $taxonomy->name;\n                            the_title();\n                            $link = get_field('job_link');\n                            if ($link):\n                                $link_url = $link['url'];\n                                $link_title = $link['title'];\n                                $link_target = $link['target'] ? $link['target'] : '_self';\n                                ?>\n\n                                <a class=\"button\" href=\"<?php echo esc_url($link_url); ?>\"\n                                   target=\"<?php echo esc_attr($link_target); ?>\"><?php echo esc_html($link_title); ?></a>\n                            <?php endif;\n                            ?>\n                            <p>Location: <?php the_field('location'); ?></p>\n                        </li>\n                    <?php endwhile; ?>\n                </ul>\n\n\nA: You can use get_the_terms() to retrieve terms from a custom taxonomy which are attached to a post.\nIn your Loop you could do the following to retrieve the terms,\n$departments = get_the_terms( get_the_ID(), 'department' );\n\nThis gives you an array of WP_Terms. If for example, you want to use just the first one you could do it like this.\necho ($departments && is_array($departments) ? $departments[0]->name : '';\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404788", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hooking after blog info update I've been unsuccesfully looking for a way to hook into the \"site information\" update action. With \"site information update\", I mean when the blog's admin changes its title, description, etc. Does such thing exist?\nThanks in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404791", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Separating publish date and last modified Am I correct in understanding that the publish date and the modified date are actually the same thing under the covers in WP?\nWe have a need to show \u201cthis article was last updated on\u201d, which could be 2018 December. But the edit to put this date in our content could be done today, in April 2022. If we change the official modified date to be shown to the world (2018), by changing the publication date in WP, it doesn\u2019t work as it always updates internally the modified date today and the sorting order even by \u201cpublish date\u201d seems to reflect the modification today instead of the 2018 days I put in that article.\nAm I doing something wrongly? How can we put in a custom publication date in the last while still retaining that this modification was done today?\nI\u2019ve tried using \u201cmodified\u201d and \u201cpublish_date\u201d in the WP Query and the results are confusing.\n\nA: The publish date is either when the post is originally published, or the date that you choose to set it as published in the Editor, so that is the part you can manually control. The modified date is whenever an update has most recently occurred, such as when the Update button is pressed in the Editor.\nYou might end up wanting to add a custom field to hold a \"public date.\" The downside there is it would be stored in postmeta, making your queries less performant. Another alternative would be adding custom code that adds a date control in the Editor and forcibly sets the modified date to whatever you are choosing manually.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404793", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disable and Hide WP-JSON Without the use of plugin how is possible to deactivate wp-json and redirect the URL to a 404 page. Whenever someone calls example.com/wp-json it redirects it to 404 page instead of loading?\nI tried to do it via htaccess but it's not working any possible solution please?\n\nA: Does adding this to functions.php work ?\nadd_filter('json_enabled', '__return_false');\nadd_filter('json_jsonp_enabled', '__return_false');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404797", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Could we know who published a post on WordPress? Besides knowing the author, could we know like which user with the Editor role published a post? Is this being tracked in the db?\n\nA: I'm using this plugin to solve the issue - https://wordpress.org/plugins/stream/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404798", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress wp_localize_script nonce and ajax URL I'm making an Ajax call in an Elementor site, and I'd like to use a nonce while doing it. Since my code is really simple, I didn't create a new JS file for it placed in Elementor's HTML widget, and I handle the request in the functions.php file.\nI realized that the best way is to use wp_localize_script to make both the nonce and the Ajax URL available in the client side, but the function is asking for a file to register, and  I don't know how to approach this, since there is no file to register and enqueue, functions.php is probably already enqueued?\nHow is it done? I've already read through so many tutorials and still didn't find that answer.\nAny knowledge will be of great help.\nMany thanks.\n\nA: wp_localize_script() doesn't care much which script handle you use as long as it is a valid one. You could use your theme's or Elementor's main script handle with the function to make the data available for your script. You'll need to check your theme's or Elementors source coude to find what these handles are.\nSide note: It says on More information on the documentation that it is nowadays recommended to use wp_add_inline_script() to provide data to scripts as\n\nwp_localize_script() should only be used when you actually want to\nlocalize strings.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404802", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Wordpress Rest Api access the header and extract stylesheets URL Good morning,\ni have just started to see in depth the WordPress API and the use of the fetch function in javascript and i would like to know if there is the possibility to get the url of the stylesheet that refers to the block (block-library/style.min.css) so that when the WordPress installation is updated, the url and the styles to which it refers are also updated. is this possible in any way?\nthanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404804", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What am I missing in this Code Block? I am using ACF Pro and Oxygen Builder. I have a FG (Repeater) set for a Rooms & Suites FG.\nI have several sub_fields to capture attributes of each such hotel room that gets created via its CPT.\nOne of the sub-fields is Fixtures.\nI am now trying to show the fixtures for each rooms in a Oxygen Repeater element, but the query results are bringing in ALL the fixtures of every room so created, INSTEAD of the fixtures of just the 1 room to which I am applying the query.\nI am a newb (not programmer) and so am unable to debug this piece of code I found elsewhere on the web. And am also unable to guess what I am missing in this code.\nCODE BLOCK\n<?php if( have_rows('rooms_suites') ): ?>\n\n<?php while( have_rows('rooms_suites') ): the_row();?>\n\n<?php\n    // Load field settings and values. \n    $field = get_sub_field_object('fixtures_amenities'); \n    $fixtures = $field['value']; \n    // Display labels. \n    if( $fixtures ): \n    ?> \n    <ol> \n        <?php foreach( $fixtures as $fixture ): ?> \n        <li><?php echo $field['choices'][ $fixture ]; ?></li> \n        <?php endforeach; ?> \n    </ol> \n<?php endif; ?>\n<?php endwhile; ?>\n\n<?php endif; ?>\n\nGrateful if any one of you WP experts could guide me in the right direction please. Thanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404805", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to create a search form with multiple search fields I have a client that would like to add a search facility to their site but...\nThey would like to allow the user to search various different custom fields.\nHere's an example of the sort of thing I'm talking about... http://psychcrime.org/database/\nThe site will be using Advanced Custom Fields.\nI'm amazed this is proving so tricky using Wordpress. I'm aware there are lots of search plugins but most seem to still only work with one search field, or just give extra fields for tags, dates or categories.\nWhat I'm looking for is a search form with a search field for each custom field so for example, one search field for ID number, one for name and so on.\nI also build sites using ExpressionEngine and this would be so easy using EE I'm puzzled why it's so tricky using Wordpress. The trouble is the rest of the client's site is on Wordpress so I'm trying to avoid rebuilding the whole site on EE.\nAny help or pointers will be appreciated.\nThanks,\nTom\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404806", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how does the wordpress rest API work so I am looking into the wordpress REST API for the first time.\nI have some questions that may sound ridiculous to those that are familiar with it, but i am confused as to how it works.\nSo natively wordpress works by its page query ( wp_query ) to retrieve posts associated with that particular archive.\nIf i was to use the REST API to query posts, on the a particular archive page, does it query all posts in the database, or does it be specific to that page's inbuilt query?  By the structure of the API queries, it looks to be just a general search for posts, unless you specify the taxonomy.\nanother question, which may sound complex, is there a feature within the API where a person can find taxonomy terms associated with posts for a particular archive page?\nin what instances ( other than creating a headless site ) would a developer choose to use the API to build queries, rather than using wp_query. Is there performance benefits to using the API over the native methods of retrieving information?\ni would be grateful for any insight into this.\n\nA: \nIf i was to use the REST API to query posts, on the a particular\narchive page, does it query all posts in the database, or does it be\nspecific to that page's inbuilt query?\n\nThe REST API is for getting raw data for external applications or via AJAX with JavaScript. It's not intended to be used for building archive pages or anything like that. The API only returns data according to the parameters you set; it doesn't know anything about a page's existing query.\n\nanother question, which may sound complex, is there a feature within\nthe API where a person can find taxonomy terms associated with posts\nfor a particular archive page?\n\nNo.\nYou can get a list of posts in a particular taxonomy term by specifying that term in the API request, so if the archive page was for a particular term you could get posts for that term using the API, but that's all.\nIf you want to, for example, get all tags used by all posts on the current category archive, then the REST API isn't going to help with that.\n\nBased on your questions I'm inferring that you want to implement some kind of faceted search or filtering. The built in REST API endpoints do not have any built-in behaviour to help with this.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404807", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Translation for a text that is not printed on the screen How can I enable the translation for a text that is not printed on the screen? I was recently implementing the translation to my plugin and everything worked as expected. But doing the tests I realized that I was missing something. There is a small piece of code in my plugin that creates terms based on a condition, but one of them is a text and I need it to be translated. how can I do? I understand that __ and _e are just for static strings that are printed to screen.\nif ( empty ( $cookie ) ) {\n    wp_set_post_terms( $post_id, '- Default', 'directory' );\n}\nelse {\n    wp_set_post_terms( $post_id, $cookie, 'directory' );\n}\n\n(- Default) is what I need to translate\nThanks to whoever can help me\n\nA: \nThere is a small piece of code in my plugin that creates terms based on a condition, but one of them is a text and I need it to be translated. how can I do? I understand that __ and _e are for the text that is printed on the screen.\n\nYou don't, this is not something WordPress supports out of the box and you've misused the functions, you should not be using __ or _e for dynamic content that came from the database or the user.\n__ and _e are a part of the localisation API, intended for static strings in your theme and plugins such as labels.\nFor example:\n<p><?php echo __( 'Name', 'mytextdomain' ); ?>: <?php echo esc_html( $name ); ?></p>\n\nIn the above example, trying to pass $name, or a posts title/content into the __ function would be extreme bad practice and a major mistake. Many would consider it a bug.\nTo translate content from the database such as tags, terms, posts, etc, you need to install a plugin.\nAs for where it works, __ should work everywhere regardless of context.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404813", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Update number of posts when attribute changed I have a simple block that shows the most recent posts. But I want the number of posts to be changeable. To do that, I created a simple attribute and integrate it with a range control.\nconst onChangePosts = ( newContent ) => {\n    setAttributes( { numberPosts: newContent } );\n};\n\n<RangeControl\n    value={ attributes.numberPosts }\n    onChange={ ( value ) => onChangePosts( value ) }\n    min={ 1 }\n    max={ 10 }\n/>\n\nAnd here I'm getting the posts:\nconst posts = useSelect( ( select ) => {\n    return select( 'core' ).getEntityRecords(\n        'postType',\n        'post',\n        {\n            'per_page': attributes.numberPosts\n        }\n    );\n}, [] );\n\nBut when I update the attribute, the number of posts rendered in the block don't change.\nThe is the complete Edit function:\nexport default function Edit( { attributes, setAttributes  } ) {\n    const posts = useSelect( ( select ) => {\n        return select( 'core' ).getEntityRecords(\n            'postType',\n            'post',\n            {\n                'per_page': attributes.numberPosts\n            }\n        );\n    }, [] );\n\n    const onChangePosts = ( newContent ) => {\n        setAttributes( { numberPosts: newContent } );\n    };\n\n    return (\n        <div { ...useBlockProps() }>\n            <InspectorControls key=\"setting\">\n                <Panel>\n                    <PanelBody title=\"Number of posts\">\n                        <RangeControl\n                            value={ attributes.numberPosts }\n                            onChange={ ( value ) => onChangePosts( value ) }\n                            min={ 1 }\n                            max={ 10 }\n                        />\n                    </PanelBody>\n                </Panel>\n            </InspectorControls>\n            { ! posts && 'Loading' }\n            { posts && posts.length === 0 && 'No Posts' }\n            <ul>\n            { posts && posts.length > 0 && posts.map(post => (\n                <li>\n                    <a href={ post.link }>\n                        { post.title.rendered }\n                    </a>\n                </li>\n            ))}\n            </ul>\n        </div>\n    );\n}\n\nindex.js file:\nregisterBlockType( 'create-block/dynamic-block', {\n    /**\n     * @see ./edit.js\n     */\n    edit: Edit,\n} );\n\nblock.json file:\n{\n    \"$schema\": \"https://schemas.wp.org/trunk/block.json\",\n    \"apiVersion\": 2,\n    \"name\": \"create-block/dynamic-block\",\n    \"version\": \"0.1.0\",\n    \"title\": \"Dynamic Block\",\n    \"category\": \"widgets\",\n    \"icon\": \"smiley\",\n    \"description\": \"Example static block scaffolded with Create Block tool.\",\n    \"supports\": {\n        \"html\": false\n    },\n    \"textdomain\": \"dynamic-block\",\n    \"editorScript\": \"file:./index.js\",\n    \"editorStyle\": \"file:./index.css\",\n    \"style\": \"file:./style-index.css\",\n    \"attributes\": {\n        \"numberPosts\" : {\n            \"type\": \"integer\",\n            \"default\": 3\n        }\n    }\n}\n\nPlugin init file:\nfunction create_block_dynamic_block_block_init() {\n    register_block_type( __DIR__ . '/build', [\n        'render_callback' => \"gutenberg_examples_dynamic_render_callback\",\n    ]);\n}\nadd_action( 'init', 'create_block_dynamic_block_block_init' );\n\nfunction gutenberg_examples_dynamic_render_callback( $block_attributes, $content ) {\n    $recent_posts = wp_get_recent_posts( array(\n        'numberposts' => $block_attributes['numberPosts'],\n        'post_status' => 'publish',\n    ) );\n\n    if ( count( $recent_posts ) === 0 ) {\n        return 'No posts';\n    }\n\n    $posts = '';\n    foreach ($recent_posts as $post) {\n        $post_id = $post['ID'];\n        $posts .= sprintf(\n            '<p><a class=\"wp-block-my-plugin-latest-post\" href=\"%1$s\">#%2$s</a></p>',\n            esc_url( get_permalink( $post_id ) ),\n            esc_html( get_the_title( $post_id ) )\n        );\n    }\n\n    return $posts;\n}\n\n\nA: \nwhen I update the attribute, the number of posts rendered in the block\ndon't change\n\nYes, and that's because you did not include the numberPosts attribute in the second parameter (which is an array of dependencies) for useSelect(), so the (memoized) value remains unchanged, even when the block's state is changed, or that you selected a new number of posts via the range control.\nSo your useSelect() should include the above dependency, i.e. use [ attributes.numberPosts ] instead of [] as the 2nd parameter, like so:\nconst posts = useSelect( ( select ) => {\n    return select( 'core' ).getEntityRecords(\n        'postType',\n        'post',\n        {\n            'per_page': attributes.numberPosts\n        }\n    );\n}, [ attributes.numberPosts ] ); // here, make sure you include all dependencies\n\nAdditionally, you should set a key for your list items, e.g. <li key={ `post-${ post.id }` }>.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404815", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Isn't Returning Value While Using SELECT COUNT(*) FROM {$wpdb->prefix} I'm trying to count rows in sql table using SELECT COUNT(*) for the post view count. My code is\n    function get_post_views($offset=0, $post_id){\n        global $wpdb;\n        $get_visit_query = \"SELECT COUNT(*) FROM {$wpdb->prefix}\" . VISITS_TABLE .   \" WHERE object_id = '{$post_id}' AND datetime > '2021-09-07 0:0:0' AND datetime < '2021-09-09 0:0:0'\";\n        \n        $visits_total =  $wpdb->get_var( $get_visit_query, 0 );\n\n        $combined_views = (int)$get_visit_query + (int)$offset;\n\n        return $combined_views;}\n\nAnd if I get the rows count value($combined_views) from VISITS_TABLE, I will change the meta_value in wp_post_meta table with the code\n     function set_post_views($offset=0, $post_id) {\n        $visits_total = apply_filters('get_post_views', $offset, $post_id);\n\n        update_post_meta($post_id, POST_VIEW_COUNT_KEY, $visits_total); \n    }\n\nThe problem is that the meta_value is 0 all the time. (Post view count is 0 all the time)  I tried this tread, but didn't work for me sadly.\n\nA:  $combined_views = (int)$get_visit_query + (int)$offset;\n\nThis doesn't make much sense. $get_visit_query is a string (your query). Converting it to int returns in 0, see this snippet. Instead it should be\n$combined_views = (int)$visits_total + (int)$offset;\n\nSidenote: Are you actually hooking the function via add_filter()? If not, apply_filters('get_post_views', ..) will not have the desired effect. Using the function name doesn't magically add it to the filters, you need to explicitly define it e.g. via add_filter('get_post_views', 'get_post_views', 10, 2);.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404816", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why my query is not \"Main_query\"? I made a new page in admin panel like this. I want my Query here to be main_query so the other plugins could hook it, modify limits, etc...\nadd_action('admin_menu', function (){\n    add_submenu_page('edit.php?post_type=ticket', __('Board', 'askanban'), __('Board', 'askanban'), 'edit_posts', 'askanban', array( $this, 'askanban_display_board' ), 1);\n});\n\npublic function askanban_display_board(){\n        $args = array(\n            'post_type'              => 'ticket',\n            'posts_per_page'         => - 1,\n        );\n        $query =  new \\WP_Query( $args );\n        $query->is_main_query(); // FALSE HERE!!!!!!!\n        $posts = $query->posts;\n        print_r($posts);\n}\n\nI read tons of info like this How to know which one is the main query? , this https://wp-qa.com/can-i-set-my-wp_query-to-be-a-main-query or When should you use WP_Query vs query_posts() vs get_posts()?\nI tried to use get_posts() and even tried to set $GLOBALS['wp_query'] = new \\WP_Query( $args ) or $GLOBALS['wp_the_query'] = new \\WP_Query( $args );\nNoting helps.  The other plugin can't see this query as \"main\". For this \"other plugin\" there is no main query on this page. Why?\n\nA: And the anwser to my question: Don't make new WP_Query object. Don't try to overwrite main query. Use global $wp_query; In my example the function should be like this:\npublic function askanban_display_board(){\n    global $wp_query;\n    $wp_query->set('post_type', 'ticket');\n    $wp_query->set('posts_per_page', -1);\n    $posts = $wp_query->get_posts();\n    print_r($posts);\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404819", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What to do if images are not displayed in mob. versions of the online store on wordpress? Everything has changed in the computer. Same in the code. When I open the mobile version with F12, there are no images in the thumbnails and in the code there are old links to images that are not there. Downloaded WP Fastest Cache, cleared the cache, but to no avail.\nThumbnails, meaning small images that show the product category. Larger images are displayed in the mobile version.\nThe problem was before installing WP Fastest Cache. I installed it, thought it would help. In another browser the same problem, on the phone the same, images are not displayed. Not shown on mobile.\nyankids.in.ua\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404822", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Need to check if user has completed a woo commerce payment I am newbie at php.\nI am trying to check if user has a payment token or some other value that confirms they have made payment.\nI want to redirect the page if the payment status is empty 9they have not made payment yet).\nI tried :\n<?php  \n\n if(get_post_type()==\"sfwd-lessons\"){\n     $lesson_id=get_the_ID();\n }else{\n     $lesson_id=get_post_meta(get_the_ID(),'lesson_id',true);\n }\n\n  $value = get_field( \"new_field\", $lesson_id );\n   $user_status=get_wpmg_woocommerce_payment_tokens($user_id,'token_id',true);\n   //$user_status='';\nif(!empty($value) && empty($user_status)){\n    header('Location: https://xx/checkouts/checkout-page/');\n    exit;\n    ?>\n\nbut I dot think \"get_wpmg_woocommerce_payment_tokens\" is a valid call\nis there another get_ call I can make to check if payment token_id is empty?\nor is there a way on the woo commerce thank you page to write new field \"payment_status\" complete to user_meta_data\nthanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404825", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get quantity of children in all parents and add quanity to all UL class names In wordpress php. Is there a way to get the quantity of children in all parents, all parent UL, and use the quantity count in title of all UL class names, so the output would be like this, see the UL tags:\nI give 2 scenarios. The first would automatically include all UL tags which is probably easier to program. Or the second way would be to only include sub menu UL tags, better if possible.\n#1 (good)\n<ul class=\"HAS_CHILDREN_COUNT_7\">\n <li class=\"menu-item\">Menu name 1</li>\n <li class=\"menu-item\">Menu name 1 with child\n  <ul class=\"HAS_CHILDREN_COUNT_3\">\n   <li class=\"sub\">Menu sub name child 1</li>\n   <li class=\"sub\">Menu sub name child 2</li>\n   <li class=\"sub\">Menu sub name child 3</li>\n  </ul>\n </li>\n <li class=\"menu-item\">Menu name 1</li>\n <li class=\"menu-item\">Menu name 2 with child\n  <ul class=\"HAS_CHILDREN_COUNT_5\">\n   <li class=\"sub\">Menu name child 1</li>\n   <li class=\"sub\">Menu name child 2</li>\n   <li class=\"sub\">Menu name child 3</li>\n   <li class=\"sub\">Menu name child 4</li>\n   <li class=\"sub\">Menu name child 5</li>\n  </ul>\n </li>\n <li class=\"menu-item\">Menu name 1</li>\n <li class=\"menu-item\">Menu name 1</li>\n <li class=\"menu-item\">Menu name 1</li>\n</ul>\n\n#2 (better)\n<ul>\n <li class=\"menu-item\">Menu name 1</li>\n <li class=\"menu-item\">Menu name 1 with child\n  <ul class=\"HAS_CHILDREN_COUNT_3\">\n   <li class=\"sub\">Menu sub name child 1</li>\n   <li class=\"sub\">Menu sub name child 2</li>\n   <li class=\"sub\">Menu sub name child 3</li>\n  </ul>\n </li>\n <li class=\"menu-item\">Menu name 1</li>\n <li class=\"menu-item\">Menu name 2 with child\n  <ul class=\"HAS_CHILDREN_COUNT_5\">\n   <li class=\"sub\">Menu name child 1</li>\n   <li class=\"sub\">Menu name child 2</li>\n   <li class=\"sub\">Menu name child 3</li>\n   <li class=\"sub\">Menu name child 4</li>\n   <li class=\"sub\">Menu name child 5</li>\n  </ul>\n </li>\n <li class=\"menu-item\">Menu name 1</li>\n</ul>\n\nAlso to include same sequence in second or third+ sub menu.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404826", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Updated MAMP and localhost on MacOS site no longer accessible I have tried to access my site on localhost:8888/ and it no longer loads with any formatting since updating MAMP to a newer version.  I am able to access the db through phpMyAdmin but not sure what is what. There is no back-up either since it was on a local machine (my bad!).  This whole issue arose when someone asked if \"I could view the site somewhere other than your computer at my leisure\".  After a few google searches and trying quite a few solutions, which did not work, I've lost my ability to log-into this site and make any changes or even view it.\n\nA: When you upgrade MAMP, it will preserve the existing installation to a folder that is called MAMP_current-date, something like MAMP_2022-04-14_08-00-00 (the last bit is a time stamp). You can revert to the previous version by renaming the current MAMP folder (under the Applications folder) or delete it, then rename the previous version with the date and time stamp appended to just MAMP. Then restart the MAMP services to see if you can access your WP site.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404828", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to select a category automatically based on a word in WordPress post title? I am working with an auto-posting blog where the articles come through RSS Feed. There are lots of posts publishing every day automatically. Now I need to get a category automatically based on a word in the WordPress post title.\nFor example:\nI have a category: \"New York\" and \"Florida\".\nIf any post has the word \"New York\" in the title, then the category \"New York\" will select automatically during publishing.\nSimilarly, if any post has the word \"Florida\" in the title, then the category \"Florida\" will select automatically during publishing.\nHow can I do that?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404829", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sticky option for custom post types without using custom fields or plugins The problem\nWordPress supports the sticky option with some of its default post types and doesn't provide any option to extend this to other post types. It's hard-coded in the met-boxes.php file:\n<?php if ( 'post' === $post_type && current_user_can( 'edit_others_posts' ) ) : ?>\n    <span id=\"sticky-span\"><input id=\"sticky\" name=\"sticky\" type=\"checkbox\" value=\"sticky\" <?php checked( is_sticky( $post_id ) ); ?> /> <label for=\"sticky\" class=\"selectit\"><?php _e( 'Stick this post to the front page' ); ?></label><br /></span>\n<?php endif; ?>\n\nAvailable solutions\nI googled that too much and tried to find a clean solution that avoids adding extra custom fields or using 3rd party plugins, but I failed to find a satisfying answer!!\nMy solution\nSimply, I found that inserting the same HTML tag of the native sticky option checkbox will do the job, and WordPress will recognize it automatically and handle all the related functions to save and get the value of that field.\nI was about to answer some of the questions asking about the same topic, but I found it better to have it on a new question.\n\nA: First of all, we have to restrict this solution to run only with the custom post types that we target because running it globally will make the default post type have 2 sticky checkboxes.\nSo, I suggest adding a new support type to the custom post types that we want them to have the sticky option.\nSuppose we have the custom post type news, we can run the following function to add a new support type for it, and we can do that with each custom post type that we need it to have the sticky option:\nadd_post_type_support('news', 'sticky');\n\nOr we can add that directly the supports array in the custom post type register function:\nadd_action( 'init', 'register_post_type_news' );\nfunction register_post_type_news() {\n    $labels = [\n        ...,\n    ];\n    $args = [\n        ...,\n        'supports' => ['title', ..., 'sticky'],\n        ...,\n        ],\n    ];\n    register_post_type( 'news', $args );\n}\n\nNow we are ready to run our function(s) safely.\nAdd the sticky option to the Post Edit page\nAdd the following code to your functions.php file:\nfunction show_sticky_option__post_edit($post) {\n    if ( current_user_can( 'edit_others_posts' ) && post_type_supports( $post->post_type, 'sticky' ) ) {\n        $sticky_checkbox_checked = is_sticky( $post->post_id ) ? 'checked=\"checked\"' : '';\n        $sticky_span = '<span id=\"sticky-span\" style=\"margin-left:0\"><input id=\"sticky\" name=\"sticky\" type=\"checkbox\" value=\"sticky\" ' . $sticky_checkbox_checked . ' /> <label for=\"sticky\" class=\"selectit\">' . __( 'Stick this post to the front page' ) . '</label><br /></span>';\n        echo $sticky_span . '<br>';\n    }\n}\nadd_action( 'post_submitbox_start', 'show_sticky_option__post_edit' );\n\nAnd that's it! \nNow you will see a new checkbox before the Publish button that works exactly like the native WordPress sticky checkbox.\n\nNEXT is more enhancements to:\n\n*\n\n*Show this field in the same place where WordPress shows it (under the Visibility section).\n\n*Add the sticky option to the Quick Edit box.\n\n*Add the sticky option to the Bulk Edit box.\n\n*Add a counter for the sticky posts in the subsubsub menu.\n\nAnd all of that is done by using the same methodology; adding the same original HTML tag of the sticky option in the right place.\nShow the sticky checkbox under the Visibility section\nInstead of echoing the HTML directly in the Submit box, we can echo a Javascript code that inserts the HTML tag after the Public status in the Visibility section, like this:\nfunction show_sticky_option__post_edit($post) {\n    if ( current_user_can( 'edit_others_posts' ) && post_type_supports( $post->post_type, 'sticky' ) ) {\n        $sticky_checkbox_checked = is_sticky( $post->post_id ) ? 'checked=\"checked\"' : '';\n        $sticky_span = '<span id=\"sticky-span\"><input id=\"sticky\" name=\"sticky\" type=\"checkbox\" value=\"sticky\" ' . $sticky_checkbox_checked . ' /> <label for=\"sticky\" class=\"selectit\">' . __( 'Stick this post to the front page' ) . '</label><br /></span>';\n        $is_sticky = is_sticky( $post->post_id ) ? 'true' : 'false';\n        echo '\n        <script>\n        window.addEventListener(\"load\", (event) => {\n            document.getElementById(\"visibility-radio-password\").insertAdjacentHTML(\"beforebegin\", `' . $sticky_span . '`);\n            if (' . $is_sticky . ')\n                document.getElementById(\"post-visibility-display\").innerHTML = \"Public, Sticky\";\n        });\n        </script>';\n    }\n}\nadd_action( 'post_submitbox_start', 'show_sticky_option__post_edit' );\n\nAnd here's the result:\n\nShow the Sticky Posts Count at the top of the posts list table\nBefore we can hook into the Quick/Bulk Edit boxes, we need to create a new admin column, and I used the same function to print the sticky posts count that shows the number of the sticky posts of the current post type with a link to filter the posts list to show only those sticky posts.\n\nI have no idea if there's a better hook to show the sticky posts count at the top of the posts list table. If you know, please suggest.\n\nAnd I added some Javascript code that will hide the new custom admin column because it's useless to show it in the posts list table.\nAnd here's the code:\nfunction add_sticky_column_and_counter($columns, $post_type)\n{\n    if ( post_type_supports( $post_type, 'sticky' ) ) {\n        $columns['sticky'] = 'Sticky';\n        $args = [\n            'post__in'    => get_option('sticky_posts'),\n            'post_type'   => $post_type,\n        ];\n        $sticky_posts = new WP_Query($args);\n        $sticky_count = $sticky_posts->found_posts;\n        $sticky_count_li = '\n        <li class=\"sticky\">\n            | <a href=\"edit.php?post_type=' . $post_type . '&amp;show_sticky=1\">Sticky <span class=\"count\">(' . $sticky_count . ')</span></a>\n        </li>';\n        echo '\n        <script>\n            window.addEventListener(\"load\", (event) => {\n                let toggle_sticky_column  = document.getElementById(\"sticky-hide\");\n                if (toggle_sticky_column.checked) toggle_sticky_column.click();\n\n                let sticky_count_listitem = document.getElementsByClassName(\"subsubsub\")[0];\n                sticky_count_listitem.insertAdjacentHTML(\"beforeend\", `' . $sticky_count_li . '`);\n            });\n        </script>';\n    }\n    return $columns;\n}\nadd_filter('manage_posts_columns', 'add_sticky_column_and_counter', 10, 2);\n\nNow, we can see the sticky posts count at the top of the posts list table.\n\nAnd the new custom admin column is always hidden:\n\nWe are ready now to add the sticky option to the Quick/Bulk Edit boxes.\nAdd the sticky option to the Quick Edit box\nNow we can hook into the quick_edit_custom_box and insert the HTML of the sticky option in the Quick Edit box, using this code:\nfunction show_sticky_option__quick_edit($column, $post_type) {\n    if ( post_type_supports( $post_type, 'sticky' ) ) {\n        $sticky_span = '\n        <label id=\"quickedit-sticky\" class=\"alignleft\">\n            <input type=\"checkbox\" name=\"sticky\" value=\"sticky\" />\n            <span class=\"checkbox-title\">' . __( 'Make this post sticky' ) . '</span>\n        </label>';\n        echo '\n        <script>document.getElementsByClassName(\"inline-edit-status\")[0].insertAdjacentHTML(\"afterend\", `' . $sticky_span . '`);</script>';\n    }\n}\nadd_action('quick_edit_custom_box', 'show_sticky_option__quick_edit', 10, 2);\n\nAnd here's the result:\n\nAdd the sticky option to the Bulk Edit box\nIn the same way, we will hook into the bulk_edit_custom_box and insert the HTML of the sticky option in the Bulk Edit box, using this code:\nfunction show_sticky_option__bulk_edit($column, $post_type) {\n    if ( post_type_supports( $post_type, 'sticky' ) ) {\n        $sticky_span = '\n        <label id=\"quickedit-sticky\" class=\"alignright\">\n            <span class=\"title\">' . __( 'Sticky' ) . '</span>\n            <select name=\"sticky\">\n                <option value=\"-1\">' . __( '&mdash; No Change &mdash;' ) . '</option>\n                <option value=\"sticky\">' . __( 'Sticky' ) . '</option>\n                <option value=\"unsticky\">' . __( 'Not Sticky' ) . '</option>\n            </select>\n        </label>';\n        echo '\n        <script>document.querySelectorAll(\"#bulk-edit .inline-edit-status\")[0].insertAdjacentHTML(\"afterend\", `' . $sticky_span . '`);</script>';\n    }\n}\nadd_action('bulk_edit_custom_box', 'show_sticky_option__bulk_edit', 10, 2);\n\nAnd the result is:\n\nThe full solution code\nIf you only need to show the sticky option checkbox on the post edit page, you can add the first piece of code to your functions.php file. But if you need to run the full solution, you can add the rest pieces of code, or create a new php file that holds all these functions and, then, include it in the functions.php file.\nHere's the full solution code that you need with some comments to understand what's going on:\n/**\n * This function shows the sticky option checkbox for the post types that supports 'sticky'.\n * So, to show this checkbox with a certain post type, just add 'sticky' to the 'supports' \n * array in the post type register function.\n *\n * Wordpress will handle saving the value of this field automatically because we used\n * the same HTML structure of the sticky <input> field that WordPress uses.\n *\n * @return void\n */\nfunction show_sticky_option__post_edit($post) {\n    if ( current_user_can( 'edit_others_posts' ) && post_type_supports( $post->post_type, 'sticky' ) ) {\n        $sticky_checkbox_checked = is_sticky( $post->post_id ) ? 'checked=\"checked\"' : '';\n        $sticky_span = '<span id=\"sticky-span\"><input id=\"sticky\" name=\"sticky\" type=\"checkbox\" value=\"sticky\" ' . $sticky_checkbox_checked . ' /> <label for=\"sticky\" class=\"selectit\">' . __( 'Stick this post to the front page' ) . '</label><br /></span>';\n        $is_sticky = is_sticky( $post->post_id ) ? 'true' : 'false';\n        /**\n         * The following JS code does the following (after DOM is ready):\n         * - Inserts the sticky option checkbox after Public status item in the\n         * Visibility section\n         */\n        echo '\n        <script>\n        window.addEventListener(\"load\", (event) => {\n            document.getElementById(\"visibility-radio-password\").insertAdjacentHTML(\"beforebegin\", `' . $sticky_span . '`);\n            if (' . $is_sticky . ')\n                document.getElementById(\"post-visibility-display\").innerHTML = \"Public, Sticky\";\n        });\n        </script>';\n    }\n}\nadd_action( 'post_submitbox_start', 'show_sticky_option__post_edit' );\n\n\n\n/**\n * This function adds a new custom column 'sticky' that's mandatory to hook into\n * the quick and bulk edit modes.\n * This will not be applied only to the post types that support 'sticky'.\n *\n * @param $columns   : The admin columns of the current screen\n * @param $post_type : The post type of the current screen\n * @return $columns  : The new set of columns\n */\nfunction add_sticky_column_and_counter($columns, $post_type)\n{\n    if ( post_type_supports( $post_type, 'sticky' ) ) {\n        // Add a new custom column\n        $columns['sticky'] = 'Sticky';\n        // Get the count of the sticky posts of the current post type\n        $args = [\n            'post__in'    => get_option('sticky_posts'),\n            'post_type'   => $post_type,\n        ];\n        $sticky_posts = new WP_Query($args);\n        $sticky_count = $sticky_posts->found_posts;\n        // The HTML tag of the sticky posts count\n        $sticky_count_li = '\n        <li class=\"sticky\">\n            | <a href=\"edit.php?post_type=' . $post_type . '&amp;show_sticky=1\">Sticky <span class=\"count\">(' . $sticky_count . ')</span></a>\n        </li>';\n        /**\n         * The following JS code does the following (after DOM is ready):\n         * - Hides the new custom column 'sticky' if visible on the posts list table\n         * - Appends the sticky count <li> element to the 'subsubsub' <ul>\n         */\n        echo '\n        <script>\n            window.addEventListener(\"load\", (event) => {\n                let toggle_sticky_column  = document.getElementById(\"sticky-hide\");\n                if (toggle_sticky_column.checked) toggle_sticky_column.click();\n\n                let sticky_count_listitem = document.getElementsByClassName(\"subsubsub\")[0];\n                sticky_count_listitem.insertAdjacentHTML(\"beforeend\", `' . $sticky_count_li . '`);\n            });\n        </script>';\n    }\n    return $columns;\n}\nadd_filter('manage_posts_columns', 'add_sticky_column_and_counter', 10, 2);\n\n\n\n/**\n * This function adds the sticky option checkbox to the Quick Edit panel.\n * This will not be applied only to the post types that support 'sticky'.\n *\n * @param $columns   : The admin columns of the current screen\n * @param $post_type : The post type of the current screen\n * @return void\n */\nfunction show_sticky_option__quick_edit($column, $post_type) {\n    if ( post_type_supports( $post_type, 'sticky' ) ) {\n        // The HTML tag of the sticky option checkbox\n        $sticky_span = '\n        <label id=\"quickedit-sticky\" class=\"alignleft\">\n            <input type=\"checkbox\" name=\"sticky\" value=\"sticky\" />\n            <span class=\"checkbox-title\">' . __( 'Make this post sticky' ) . '</span>\n        </label>';\n        /**\n         * The following JS code does the following (after DOM is ready):\n         * - Appends the sticky option checkbox element after the post 'status' field\n         */\n        echo '\n        <script>document.getElementsByClassName(\"inline-edit-status\")[0].insertAdjacentHTML(\"afterend\", `' . $sticky_span . '`);</script>';\n    }\n}\nadd_action('quick_edit_custom_box', 'show_sticky_option__quick_edit', 10, 2);\n\n\n\n/**\n * This function adds the sticky option menu to the Bulk Edit panel.\n * This will not be applied only to the post types that support 'sticky'.\n *\n * @param $columns   : The admin columns of the current screen\n * @param $post_type : The post type of the current screen\n * @return void\n */\nfunction show_sticky_option__bulk_edit($column, $post_type) {\n    if ( post_type_supports( $post_type, 'sticky' ) ) {\n        // The HTML tag of the sticky option menu\n        $sticky_span = '\n        <label id=\"quickedit-sticky\" class=\"alignright\">\n            <span class=\"title\">' . __( 'Sticky' ) . '</span>\n            <select name=\"sticky\">\n                <option value=\"-1\">' . __( '&mdash; No Change &mdash;' ) . '</option>\n                <option value=\"sticky\">' . __( 'Sticky' ) . '</option>\n                <option value=\"unsticky\">' . __( 'Not Sticky' ) . '</option>\n            </select>\n        </label>';\n        /**\n         * The following JS code does the following:\n         * - Appends the sticky option menu element after the post 'status' field\n         */\n        echo '\n        <script>document.querySelectorAll(\"#bulk-edit .inline-edit-status\")[0].insertAdjacentHTML(\"afterend\", `' . $sticky_span . '`);</script>';\n    }\n}\nadd_action('bulk_edit_custom_box', 'show_sticky_option__bulk_edit', 10, 2);\n\nConclusion\nAs you noticed, adding the same original HTML tag of the sticky option field to the right place will make WordPress use it natively. So no more custom fields or plugins are needed to add the sticky option field to the custom posts types.\nAND DON'T FORGET to exclude the default post type in any way to avoid the sticky checkbox duplication. You can add a new support type as suggested above.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404832", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom taxonomy terms as children of multiple custom post types I'm about to start a part of my project that I've been putting off for too long. I'm not looking for code, I'm looking for confirmation that I'm on the right track and any advice Stackexchange may have to give on this subject.\nThe setup:\nI have two different custom post types with two taxonomies, the first custom taxonomy, industries contains three terms for businesses to select, and the first custom post will be business-profiles. The second taxonomy departments will be used to, you guessed it, categorize employees by department and the second custom post type will be employee-profiles.\nI will be using ACF to set up a post relationship field to assign the employees to an employer, and I'll be using rewrites rules to modify the URL's for the departments and employee profiles.\nThe Goal:\nTo have the department taxonomy terms as a child of each company, i.e.:\nExample.com/industry1/business-profile1/department1/employee-profile1\nand\nExample.com/industry2/business-profile1/department1/employee-profile2\nFurther information:\nI know I can do the rewrite for the business profile easily enough, I've done it four other times on the same project, and I've done a rewrite using the ACF relational field for another post type.\nThe Question\nIs using a regular expression such as example.com/([^/]+)/([^/]+)/%departments% the best method to set a taxonomy term as the child of all posts of a custom post type?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404836", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disable WP Bakery plugin on specific page Is it possible to choose not to use WP Bakery on a specific page even if it's used for the rest of the site? Would I be able to upload and use my own template (i.e template-pagename.php) + custom CSS for that one page while leaving the rest of the site intact?\n\nA: Yes, it's possible. You can do it with Freesoul Deactivate Plugins.\nI mean, use FDP to totally unload it on the frontend, so WPBakery will not load any asset, and will not add any database query on that page.\nIf you simply want to edit the page without WPBakery, you don't need FDP, just use Gutenberg or the classic editor, but WPBakery will load all on that page in any case if you don't disable it.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404838", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to download CSV from sub directory in uploads folder hello guys i donot have experience working with the csv. I have a very big form i wanted to make a custom csv export for this form and a new csv is generated every time the form is submited. i am using gravity form and gravity form gform_post_submissiom hook to capture the entry. Everything is working fine until this point. I have created a sub dir in uploads folder. Csv for every entry is being created in this folder. I have created a custom meta box on the entry page too. I just need some guidance to how to download those csv. i am using following code for downloading the csv but it says failed server problem\nfunction download_for_client_asset_entry($args){\n    $form  = $args['form'];\n    $entry = $args['entry'];\n    $path          = wp_upload_dir();\n    $path          = $path['basedir'].'/client-assets';\n    $event_content = array();\n    $filename      = \"/client-assets456.csv\";\n    $filename = $path.$filename;?>\n    <a download href=\"<?php echo $filename; ?>\">download csv</a>\n<?php\n    \n}\n\nright now i have given the name of one csv to test the things but it is still not working\nI have written all the code in functions.php\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404839", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ACF Gut block broke wordpress default style? When I add a new custom ACF gut block, he broke the default WP style:\n\nAfter adding a custom block:\n\nExample of ACF block:\nacf_register_block_type(array(\n            'name'              => 'rte-module',\n            'title'             => __('RTE Module'),\n            'description'       => __('A custom RTE module block.'),\n            'render_template'   => 'template-parts/blocks/rte-module.php',\n            'category'          => 'rte-module',\n            'icon'              => 'admin-comments',\n            'keywords'          => array( 'rte', 'module', 'text' ),\n            'mode'              => 'edit',\n            'supports'          => array('mode' => false),\n            'example'  => array(\n                'attributes' => array(\n                    'mode' => 'preview',\n                    'data' => ['is_example' => true]\n                )\n            )\n        ));\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404842", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Create an user checklist system for a course plateform using ACF Pro and ACF Extended I'm currently trying to develop a learning plateform on my website and I want to integrate a system allowing users to check a list of step defined for each course.\nI don't have heavy PHP skills to be honest, I'm just able to understand what sample codes does and to bring some modification to existing codes.\nSo to give you some details :\nI'm using Divi builder + All Divi Engine plugins to manage the front-end content and display dynamic content and ACF field in a simple way. Divi Machine is build to work with ACF to display ACF fields and form in a such custom way. So for the moment the front-end is not a problem.\nI have created a CPT named \"courses\" on which I added an ACF Field Group to manage the course content (video / description etc.)\nI have created another ACF field group on the \"courses\" CPT to manage the steps I want the user to follow. Inside this field group I added a repeater field with 2 text fields for the step title and instructions, and here come the difficult part.\nThe steps have to be edited by the administrator only for every course specifically (thats ok) but y want to add for every step inside every course a checkbox or boolean field that can be edited on the frontend by the user. I'm able to add an user field and to build a form to allow the user to check or uncheck the box but it is not specific for the step and course.\nSo I need to have on the DB or on the user fields a dynamic list of bool fields that sync with the list of steps and courses I create on the CPT side. Here an example :\nImagine I have 3 courses created with the \"courses\" CPT\nIn the first course I added 2 steps in my repeater, in the second courses I added 1 step and in the third course I added 3 steps.\nOn the user profile fields, my data should be organized like this :\nCourse 1 :\nStep 1 :\nDone : Yes/No\nStep 2 :\nDone : Yes/No\nCourse 2 :\nStep 1 :\nDone : Yes/No\nCourse 3 :\nStep 1 :\nDone : Yes/No\nStep 2 :\nDone : Yes/No\nStep 3 :\nDone : Yes/No\nFor every Step on the user profile fields I should have the label and description of step visible but not editable (as it should only be edited on the course cpt side).\nTo complicate the things again I need to have this system for separated courses programs that the user have access to or not depending on the woocommerce membership plugin so the field steps associated with courses the user is not a member of should not be added to the profile fields. But for that part i think I should find a solution.\nThanks in advance !\nPS : I have ACF Pro and also ACF Extended Pro that add some pretty cool functionalities.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404843", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how i could put my id in the meta field 'meta-value' \n}\n <?php \n\nfunction nova_get_post_id(){\nreturn get_the_ID();\n}\nfunction nova_get_user_id(){\nif(is_user_logged_in()){\nreturn (get_current_user_id());\n}\nreturn ('') ;\n}\nfunction nova_add_user_meta($user_id,$favorites_posts,$postids){\nif(($_POST)){\nupdate_user_meta($user_id,$favorites_posts,$postids ,$postid);\n}else{\ndelete_user_meta($user_id,$favorites_posts,$postids,$postid);\n}\n}\nfunction nova_add_post_meta($user_id,$favorites_posts,$postids){\nif($_POST['favorits']){\nudpate_post_meta($user_id,$favorites_posts,$postids,$postid );\n  }else{\n      delete_post_meta($user_id,$favorites_posts,$postids,$postid);\n     }\n  }\n\n\n  $postid = nova_get_post_id();\n$favorites_posts = 'favorites_post';\n$user_id = nova_get_user_id();\n$postids[] =get_user_meta($user_id,$favorites_posts);\n\n\n\nif(!empty($_POST['favorits'] && get_user_meta($user_id,$favorites_posts))){\n    // j'ajoute metadata\n     nova_add_user_meta($user_id,$favorites_posts,$postids);\n     //si pas remplis je supprime meta\n}else {\n    delete_user_meta($user_id,$favorites_posts,$postids);\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404844", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get_site_option / update_site_option - the main site and sub sites do not share the same storage get_site_option / update_site_option is supposed to get / update an option for the current network (contrary to its name).\nI have noticed that it works only for sub-sites, all sub-sites share the same settings storage, however, the \"main\" site does not (the initial site that is not a subdomain or subdir). Why is that?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404846", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Button doesn't work in the profile panel Can anybody help me out?\nCurrently, I'm having trouble with the Set New Password button in the Profile section of the admin panel.\nThe button is not responsive and nothing happens when clicking. I'm not sure though, but my wide guess is it has occurred after using some caching plugins like combine CSS/JS and inline stuff for site loading speed optimization.\nI deactivated all and re-tried it though, it's still the same.\nPlus, the Update button at the top of the page did even disappear after the plugins took effect. (So no change can be saved on the page as well as the unresponsive Set New Password button)\nCould anybody please help me sort it out?\nSite: https://smartworkershome.com/\nThe troublesome URL: https://smartworkershome.com/wp-admin/profile.php\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404848", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hard-code SEO Title defaults across all sites on a multisite I am using Yoast on a multisite with hundreds of sites and thousands of posts and I would like to make sure that the SEO title always ends with | Sitename and not have to rely on authors not changing the variables while editing the SEO title.\nI could update the default on the \"Yoast SEO Search Appearance\" settings page to not have the sitename and add a filter to add the sitename on output. I know how to do the filter, but this is for a lot of sites, it would be painful to have to go to the settings of every site to change the defaults not to mention the risk that the settings could be changed on individual sites. Is there a way to change the default title setting in code?\nI have a shared plugin with other network wide settings already active on all sites so I can add code there. I am just having a little difficulty finding the right setting to change.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404849", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Intermittent Gutenberg 504 Gateway Timeout when calling REST route to retrieve categories Our Wordpress site uses the Gutenberg editor for editing posts, and occasionally many of our users experience 504 Gateway Timeout errors when the editor is loading in their browser.  Specially, it is when it is trying to retrieve the categories, with a URL like this:\nindex.php?rest_route=/wp/v2/categories\nWe've found that sometimes if we close the accordion for things like Yoast, Categories, etc. that it will load, but when many are open sometimes it won't load.\nIf the user clears the browser cache, the issue seems to go away for a little while.\nWe've tried turning off Object Caching on our server, disabling plugins, etc. but so far have not had any luck.  Please let me know if you have any ideas on what might be causing this intermittent behavior.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404850", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress plugin with CORS I have couple API routes that I want to use on another site by making ajax calls, however, I keep getting Cross-Origin Read Blocking (CORB) blocked cross-origin response.\nI have tried CORS PLUGINS setting it to wildcard (*), also have tried numorous answers in this and other communities to no avail.\nadd_action( 'init', 'allow_origin' );\nfunction allow_origin() {\n    header(\"Access-Control-Allow-Origin: *\");\n}\n\nalso tired this\nadd_action( 'rest_api_init', 'add_custom_headers', 15 );\nfunction add_custom_headers() {\n\n    add_filter( 'rest_pre_serve_request', function( $value ) {\n        header( 'Access-Control-Allow-Headers: Authorization, X-WP-Nonce,Content-Type, X-Requested-With');\n        header( 'Access-Control-Allow-Origin: *' );\n        header( 'Access-Control-Allow-Methods: POST, GET, OPTIONS, PUT, DELETE' );\n        header( 'Access-Control-Allow-Credentials: true' );\n\n        return $value;\n    } );\n}\n\nPlease note, I'm getting this error on local environment provided by local by flywheel. Perhaps there is a server setting I have to tweak but I wasn't able to google it out.\nAlso, this is my ajax function\n$.ajax({\n  url: url,\n  contentType: \"application/json\",\n  dataType: \"jsonp\",\n          \n  success: function(result){\n    let data = $.parseJSON(result);\n    if (data.status === \"success\"){\n      console.log('success');\n    }else if (data.status === \"error\"){\n      console.log(data.description)\n    }\n  }\n})\n\nAnd this is how routes are registered\nadd_action( 'rest_api_init', function () {\n    register_rest_route( 'rc-design-issue/v1', '/new-previews/', array(\n      'methods' => 'GET',\n      'callback' => 'generate_new_previews',\n    ) );\n\n    register_rest_route( 'rc-design-issue/v1', '/new-proofs/', array(\n        'methods' => 'GET',\n        'callback' => 'generate_new_proofs',\n      ) );\n} );\n\nThis all works great on the same domain, but when I put this plugin onto a different domain(locally) I get CORS error.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404852", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: In a WPMU that uses several different domains, how to enable users to register subdomains of any domain from the main site? For example, MainSite.com is the main site for the WPMU installation. Site1.com and Site2.com are added as blog sites with the MainSite.com WP network admin tool. Is it possible to enable a user who registers on MainSite.com to pick their own subdomain for whichever site they choose (User.Site1.com, User.Site2.com, etc.)?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404856", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Filter post style attribute Looking for a hook which enables filtering of a class within the post or content so i can add inline CSS using custom fields for posts on the home page.\nSomething like this -\nadd_filter( 'attr_entry', 'filter_post_html_tag' );\nfunction filter_post_html_tag( $attributes ) {\n\n    $color = get_post_meta( get_the_ID(), 'background_color', true );\n            \n    $colors = $color ? $color : 'grey';\n\n    $attributes['style']  = 'color:' . $colors . '';\n\n    return $attributes;\n}\n\n\nA: What you are looking for is post_class filter.\nHowever, it depends on the theme you are using and how they used the loop\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404860", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What is the \"Force secure connections\" option used for? In the WordPress Admin (5.9) there is a \"Https\" Setting under the general Tab. This seems to be very new, as it is not translated to my native (german) language. Furthermore it says:\n\nHTTPS is essential to securing your WordPress site, we strongly suggest upgrading to it. More details\n\n*\n\n*[ ] Force secure connections\n\n\nThe link is broken, this seems to be the new one. However there is no information about what this option is used for. Is it for HSTS maybe? But what if my webserver already enables that? The security headers check at least tells me so.\nAny ideas?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404861", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: loading images, css and fonts from site url I changed the site url to example.com/blog but the wordress url is blog.example.com, still css, images and fonts are loading from blog.example.com, is there any way to force wordpress to load files from site url?\nP.S: example.com/blog is loading blog.example.com through nginx proxy, so I don't want to use .htaccess rewrite url for this purpose. (because it make a redirect loop)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404866", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can stop redirects 404 in wordpress Currently, all 404 errors are being redirected to the page with the following uri:\nwww.example.com/woops\n(previously above page was called :\nwww.example.com/404-page\nhowever we changed the name from 404-page to woops)\nPlease cancel all error 404 redirects to www.example.com/woops.\nAlso, please cancel all error 404 redirects to www.example.com/404-page\nWe will handle 404 erros from nginx server configuiration\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404867", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get woocommerce orders with get_posts method in a shortcode I'm writing shortcode which must show all orders placed by current user. I followed this two guidee to get them:\n\n*\n\n*https://www.businessbloomer.com/woocommerce-easily-get-product-info-title-sku-desc-product-object/\n\n\n*https://www.businessbloomer.com/woocommerce-easily-get-order-info-total-items-etc-from-order-object/#colophon\nHowever shortcode not working. Get the following error on line 31 of my file - Fatal error: Uncaught Error: Call to undefined method WP_Post::get_items().\nOn line 31 i have this:  foreach ( $order->get_items() as $item_id => $item ) \nI'm relatively new to this, I don't understand what I'm doing wrong, can anyone help me correct this mistake? I appreciate any help.\nMy Shortcode\n// Start Shortcode.\nadd_shortcode( 'orders' , 'prc_orders' );\nfunction prc_orders() {\n    \n// Get all orders for the current user.\n$customer = get_posts(apply_filters('woocommerce_my_account_my_orders_query', array(\n    'numberposts' => -1,\n    'meta_key'    => '_customer_user',\n    'meta_value'  => get_current_user_id(),\n    'post_type'   => wc_get_order_types('view-orders'),\n    'post_status' => array_keys(wc_get_order_statuses())\n)));  \n    \n$total_records = count($customer);\n$posts_per_page = 5;\n$total_pages = ceil($total_records / $posts_per_page);\n$paged = ( get_query_var('page') ) ? get_query_var('page') : 1;\n$customer_orders = get_posts(array(\n    'meta_key' => '_customer_user',\n    'meta_value' => get_current_user_id(),\n    'post_type' => wc_get_order_types('view-orders'),\n    'posts_per_page' => $posts_per_page,\n    'paged' => $paged,\n    'post_status' => array_keys(wc_get_order_statuses())\n));\n\n    foreach ( $customer as $order ) {\n    foreach ( $order->get_items() as $item_id => $item ) {\n    \n    // Get Order info elements - https://www.businessbloomer.com/woocommerce-easily-get-order-info-total-items-etc-from-order-object/\n    $order_id = $order->get_id();\n    $status = $order->get_status();\n    $date_created = $order->get_date_created()->date('d/m/Y - H:i');\n     \n    // Get and Loop Over Order Items Variable - https://www.businessbloomer.com/woocommerce-easily-get-product-info-title-sku-desc-product-object/\n    $product_name = $item->get_name();\n    \n    echo '<div class=\"items_orders_card name\"> '. $order_id .' '. $product_name .' '. $status .' '. $date_created .' </div>';  \n    }} \n\n\n    ?><div class=\"pagination\"><?php\n    $args = array(\n        'base' => '%_%',\n        'format' => '?pagina=%#%',\n        'total' => $total_pages,\n        'current' => $paged,\n        'show_all' => False,\n        'end_size' => 5,\n        'mid_size' => 5,\n        'prev_next' => True,\n        'prev_text' => __('&laquo; Previous'),\n        'next_text' => __('Next &raquo;'),\n        'type' => 'plain',\n        'add_args' => False,\n        'add_fragment' => ''\n    );\n    echo paginate_links($args);\n    ?></div><?php\n\n} // End Shortcode\n\n\n\nA: I found a solution to the problem, here is the code below. I just can't get the pagination to work yet. Everything else works fine.\nShortcode\nadd_shortcode( 'all_orders' , 'prc_orders' );\nfunction prc_orders() {\n    \n// Get all orders for the current user.\n$customer = get_posts(apply_filters('woocommerce_my_account_my_orders_query', array(\n    'numberposts' => -1,\n    'meta_key'    => '_customer_user',\n    'meta_value'  => get_current_user_id(),\n    'post_type'   => wc_get_order_types('view-orders'),\n    'post_status' => array_keys(wc_get_order_statuses('Completed', 'Order status', 'woocommerce'))\n)));  \n    \n$total_records = count($customer);\n$posts_per_page = 3;\n$total_pages = ceil($total_records / $posts_per_page);\n$paged = ( get_query_var('page') ) ? get_query_var('page') : 1;\n$customer_orders = get_posts(array(\n    'meta_key' => '_customer_user',\n    'meta_value' => get_current_user_id(),\n    'post_type' => wc_get_order_types('view-orders'),\n    'posts_per_page' => $posts_per_page,\n    'paged' => $paged,\n    'post_status' => array_keys(wc_get_order_statuses('Completed', 'Order status', 'woocommerce'))\n));\n\n     // Get Access $order variable Foreach\n     foreach ( $customer_orders as $order_id ) {\n        \n     // Get $product object from $order / $order_id\n     $order = wc_get_order( $order_id );\n     $items = $order->get_items();\n     \n     $orders_id = $order->get_id();\n     $status = $order->get_status();\n     $date_created = $order->get_date_created()->date('d/m/Y - H:i');\n     $payment_method = $order->get_payment_method_title();\n     $order_total = $order->get_formatted_order_total();\n    \n    // Get Access Items Variable Foreach\n     foreach ( $items as $item ) {\n     $product_name = $item->get_name();\n         \n     // Get product image - https://www.businessbloomer.com/woocommerce-easily-get-product-info-title-sku-desc-product-object/\n     $product = $item->get_product();\n     if( $product instanceof WC_Product ){\n     $order_img = $product->get_image();\n     }\n    \n    // Get product download button \n    $downloads = $order->get_downloadable_items();\n     if(is_array($downloads)){\n     foreach($downloads as $product){\n     $download_button = '<a href=\"'. $product['download_url'] .'\" target=\"_blank\">Download</a>';\n     } \n    }   \n               \n     echo \n     '\n     <div class=\"container_orders\">\n    \n      <div class=\"container_orders_card_left\"> \n        <div class=\"items_orders_card name\"> '. $product_name .' </div>\n        <div class=\"items_orders_card\"> <span class=\"items_title\">Ordine:</span> #'. $orders_id .'  </div>\n        <div class=\"items_orders_card\"> <span class=\"items_title\">Effettuato il:</span> '. $date_created .' </div>\n        <div class=\"items_orders_card\"> <span class=\"items_title\">'. $payment_method .'</span> \u2022 '. $order_total .' </div>\n        <div class=\"items_orders_card\"> <span class=\"items_title\">Stato:</span> '. $status .' </div>\n      </div>\n    \n      <div class=\"container_orders_card_right\">\n        <div class=\"container_orders_img\"> '. $order_img .' </div>\n        <div class=\"container_orders_download\"> '. $download_button .' </div>\n      </div>\n    \n     </div>\n     \n     '; \n     \n    }} // Closing Foreach\n\n    ?><div class=\"pagination\"><?php\n    $args = array(\n        'base' => '%_%',\n        'format' => '?pagina=%#%',\n        'total' => $total_pages,\n        'current' => $paged,\n        'show_all' => False,\n        'end_size' => 5,\n        'mid_size' => 5,\n        'prev_next' => True,\n        'prev_text' => __('&laquo; Previous'),\n        'next_text' => __('Next &raquo;'),\n        'type' => 'plain',\n        'add_args' => False,\n        'add_fragment' => ''\n    );\n    echo paginate_links($args);\n    ?></div><?php\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404869", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Page Slug Won\u2019t Change - Can\u2019t Edit Archive Page With Slug or Reassign Slug I took over a website that was developed by someone else and have rebuilt it to function in Elementor. Everything works great, except for one Archive page with the slug \u201cour-projects\u201d that I can\u2019t seem to edit or access (it is not an existing page and the Trash has been emptied). The problem is I have another Projects page I need to assign the \u201cour-projects\u201d slug to as this slug has a long SEO history. As this Archives Page exists, I cannot access it to change the slug so I can assign the slug to another page. When I change the new Projects page\u2019s slug to \u201cour-projects\u201d it replaces the new Projects page with the old Archive projects page which I can\u2019t access. Please help!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404870", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: New installation fatal error in 5.9.3 at edit or create entry I just make a new download and installation of Wordpress. So far so good until I edit or create a new entry. Remove it works.\n\nNotice: Undefined property: WP_REST_Terms_Controller::$sql_clauses in\n/wp-includes/rest-api/endpoints/class-wp-rest-terms-controller.php on\nline 625\nWarning: implode(): Invalid arguments passed in /wp-includes/rest-api/endpoints/class-wp-rest-terms-controller.php on\nline 625\nError en la base de datos de WordPress: [You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server\nversion for the right syntax to use near 'FROM ORDER BY .blog_id ASC\nLIMIT 100' at line 1]\nSELECT .blog_id FROM ORDER BY .blog_id ASC LIMIT 100\nFatal error: Uncaught Error: Call to undefined function\n_prime_site_caches() in /wp-includes/rest-api/endpoints/class-wp-rest-terms-controller.php:376\nStack trace: #0\n/wp-includes/rest-api/endpoints/class-wp-rest-terms-controller.php(249):\nWP_REST_Terms_Controller->get_sites() #1\n/wp-includes/rest-api/endpoints/class-wp-rest-terms-controller.php(207):\nWP_REST_Terms_Controller->query('category') #2\n/wp-includes/class-wp-taxonomy.php(556):\nWP_REST_Terms_Controller->__construct('category') #3\n/wp-includes/rest-api.php(255):\nWP_Taxonomy->get_rest_controller() #4\n/wp-includes/class-wp-hook.php(307):\ncreate_initial_rest_routes(Object(WP_REST_Server)) #5\n/wp-includes/class-wp-hook.php(331):\nWP_Hook->apply_filters(NULL, Array) #6\n/wp-includes/plugin.php(474):\nWP_Hook->do_action(Array) #7 /home/pi/www/revistagu in\n/wp-includes/rest-api/endpoints/class-wp-rest-terms-controller.php\non line 376\n\nI'm totally lost here.\nI didn't touch any code or database, just the installation. Any tip or help or comment will be preciated. No plugins. Just Vanilla.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404872", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I get the search form to be selected automatically? There is an icon to open the search form on my site, and when it is clicked, the search form opens in full screen. I want the search form to be selected automatically, how can I do that?\nHere: https://wisekitten.com/\nI'm not using jQuery in my project.\n\nA: This question is more suited to being asked on Stack Overflow as it is not a WordPress specific question, but here's a solution for you anyway:\nThis makes no assumptions about the code controlling the existing functionality on the site, so there might be other ways that are more practical to hook into this process but for now here is an event listening that listens for a click on the \"search button\", then after waiting 200 miliseconds, the callback function provided to setTimeout will focus the cursor onto the input field that is shown when the search container overlays the full-screen.\n!(function($){\n    $(function(){\n        $('.search-button').on('click', function(event) {\n            setTimeout( function() {\n                $('.search-form-input').focus();\n            }, 200)\n        });\n    });\n})(jQuery);\n\n\nA: SOLUTION: I did what I wanted with these codes.\n(function() {\n    document.querySelector(\".search-button\").addEventListener(\"click\", (e) => {\n        setTimeout( function() {\n            document.querySelector(\".search-form-input\").focus();\n        }, 200);\n    });\n})();\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404876", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Remove duplicate media entries from mysql database I am wondering if you can help.\nI have a wordpress site with 90000 media entries, but only 1000 images. I do not want to remove the images from the media gallery just the entries in the database that have been duplicated.\nI know that you can find the duplicates in the wordpress admin area using a plugin however they delete all the images rather than just the duplicated database entries.\nSELECT posts.ID, posts.post_title AS title, posts.post_content AS content, files.meta_value AS filepath \nFROM fc0cy_posts posts \nINNER JOIN fc0cy_posts attachments ON posts.ID = attachments.post_parent \nINNER JOIN fc0cy_postmeta files ON attachments.ID = files.post_id \nWHERE files.meta_key = '_wp_attached_file'\n\nI have the select query, just not the delete one. I am wondering if anyone with more sql knowledge can help to convert it please.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404877", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Strange admin-ajax / CSS / $_SESSION issue TLDR: I'm generating a random token on a front-end form and storing it in $_SESSION to later retrieve by the ajax script.\nTHE ISSUE: The code retrieved by the ajax script does not match the one generated by the form. It seems the token script is run 2x although it's only called once and returns the same code each time on a ajax call. The ajax-side code only changes when the page is refreshed.\n\n*\n\n*ABC - The token code on the form (ok)\n\n*ABC - The token code pulled from the $_Session variable on front (ok)\n\n*123 - The code returned form $_Session by the ajax function\n\nTHE STRANGE PART: After a ton of digging I found that removing the background-image URL string in a CSS file, in a separate plugin resolves this issue.\nCSS Code from the other plugin\n#pnsmisc_button{\nbackground-image:url('img/ico-pnsmisc-mail.png');\n} \n\nLoaded using:\nwp_enqueue_style( 'pnsmisc', $pluginsurl. '/xxxx/style.css' );\n\nTOKEN GEN FUNCTION\nfunction pnsnote_tokenegn() { \n$tokenraw= md5(rand(0,99));\n$_SESSION['pntoken'] = $pnsnotetokenraw;\n}\nadd_action('wp_footer', 'pnsnote_tokenegn');\n\nAJAX JS\n$( \"#goform\" ).click(function() {   \nvar note = $('#pnsnotetxt').val();\n      $.ajax({\n          url: ajaxurl, \n          data: {\n              'action':'pnsnote_request',\n              'note' : note,\n              'token' : tokennote\n          },\n          success:function(data) {\n             alert(data);\n          },\n          error: function(errorThrown){\n         \n          }\n      });\n    });\n});\n\nPHP AJAX\nfunction pnsnote_request() {\nif(isset($_REQUEST)){\n$session_token = $_SESSION['pntoken'];\necho $session_token;\ndie();\n}\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404878", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get page permalink in contact form <?php\n\nfunction leverage_handle_ajax_request() {\n\n    if ( ! empty( $_POST ) ) {\n\n        require_once( plugin_dir_path( __FILE__ ) . 'recaptcha.php' );\n\n        if ( isset( $_POST['section'] ) && $_POST['section'] == 'leverage_form' ) {\n            $source             = 'Contact Form';\n            $field_send_options = 'form_sending_options';\n            $field_recipient    = 'form_email_recipient';\n            $field_webhook_url  = 'form_webhook_url';\n            $wpnonce            = 'leverage_form_wpnonce';\n\n            $subject_text    = get_field( 'form_subject_message', 'option' );\n            $heading_text    = get_field( 'form_heading_message', 'option' );\n            $success_text    = get_field( 'form_success_message', 'option' );\n            $validation_text = get_field( 'form_validation_message', 'option' );\n            $error_text      = get_field( 'form_error_message', 'option' );\n\n        } elseif ( isset( $_POST['section'] ) && $_POST['section'] == 'leverage_subscribe' ) {  \n            $source             = 'Subscribe Form';                  \n            $field_send_options = 'subscribe_sending_options';\n            $field_recipient    = 'subscribe_email_recipient';\n            $field_webhook_url  = 'subscribe_webhook_url';\n            $wpnonce            = 'leverage_subscribe_wpnonce';\n\n            $subject_text    = get_field( 'subscribe_subject_message', 'option' );\n            $heading_text    = get_field( 'subscribe_heading_message', 'option' );\n            $success_text    = get_field( 'subscribe_success_message', 'option' );\n            $validation_text = get_field( 'subscribe_validation_message', 'option' );\n            $error_text      = get_field( 'subscribe_error_message', 'option' );\n        }\n\n        if ( get_field( $field_recipient, 'option' ) ) {\n            $recipient = get_field( $field_recipient, 'option' );\n        } else {\n            $recipient = get_option( 'admin_email' );\n        }\n    \n        if( isset( $_POST['email'] ) ) {\n            $from = sanitize_email( $_POST['email'] );\n        } else {\n            $from = null;\n        }\n\n        if( isset( $_POST['step'] ) ) {\n            $step = $_POST['step'];\n        } else {\n            $step = 'send';\n        }\n\n        $to = $recipient;\n        \n        if ( $subject_text ) {\n            $subject = leverage_translate( $subject_text );\n        } else {\n            $subject = __( 'New contact in ', 'leverage-extra' ) . get_bloginfo( 'name' );\n        }\n\n        if ( $heading_text ) {\n            $heading_message = leverage_translate( $heading_text ).get_bloginfo( 'name' );\n        } else {\n            $heading_message = __( 'New contact in ', 'leverage-extra' ) . get_permalink( $post, $leavename );\n        }\n\n        if ( $success_text ) {\n            $success_message = leverage_translate( $success_text );\n        } else {\n            $success_message = __( 'Your message was sent successful. Thanks.', 'leverage-extra' );\n        }\n\n        if ( $validation_text ) {\n            $validation_message = leverage_translate( $validation_text );\n        } else {\n            $validation_message = __( 'Validation errors occurred. Please confirm the fields and submit it again.', 'leverage-extra' );\n        }\n\n        if ( $error_text ) {\n            $error_message = leverage_translate( $error_text );\n        } else {\n            $error_message =  __( 'Sorry. We were unable to send your message.', 'leverage-extra' );\n        }\n\n        $enable_recaptcha = get_field( 'recaptcha', 'option' );\n\n        if ( isset( $enable_recaptcha ) && $enable_recaptcha['enable_recaptcha'] ) {\n\n            if ( ! empty( $reCAPTCHA['success'] ) ) {\n                $errCaptcha = '';\n\n            } else {\n                $errCaptcha = true;\n            }\n         \n        } else {\n            $errCaptcha = '';            \n        }\n    \n        $errFields = array();\n\n        foreach( $_POST as $key => $value ) {\n            if ( $key != 'action' && $key != 'section' && $key != 'reCAPTCHA' ) {\n\n                if ( $key == 'email' ) {\n                    $validation = filter_var( $_POST[$key], FILTER_VALIDATE_EMAIL );\n                } else {                \n                    if ( strpos( $key, '*not' ) !== false ) {\n                        $validation = true;\n                    } else {\n                        $validation = ! empty( $_POST[$key] );\n                    }\n                }\n                \n                if ( ! $validation ) {\n                    $errFields[$key] = true;\n                } \n            }\n        }\n    \n        if ( empty( $errCaptcha ) && count( $errFields ) === 0 && $step === 'send' ) {\n            \n            $header  = __( 'From ', 'leverage-extra' ) . $from . \" <\" . $from . \">\" . \"\\r\\n\";\n            $header .= \"MIME-Version: 1.0\\r\\n\";\n            $header .= \"Content-type: text/html\\r\\n\";\n    \n            // Main\n            $body  = '<table style=\"min-width: 600px; padding: 35px; background-color: #f5f5f5\"; font-family: Roboto, sans-serif; font-size: 15px; text-align: left; border-radius: 4px>';\n            $body .= '<tr><th style=\"padding-bottom: 15px; font-size: 20px; font-weight: 600; text-align: left; color: #1E50BC\">'.$heading_message.'</th></tr>';\n            $body .= '<tr></td>';\n\n            foreach( $_POST as $key => $value ) {\n                if ( $key != 'action' && $key != 'section' && $key != 'reCAPTCHA' && $key != '_wp_http_referer' && $key != $wpnonce ) {\n                    $body .= '<p style=\"font-size: 15px\"><b>' . str_replace( ['-', '_', '*not'], [ ' ', ' ', ''], ucfirst( $key ) ) . '</b>: ' . nl2br( $value ) . '</p>';\n                }\n            }\n\n            $body .= '</td></tr>';        \n            $body .= '</table>';\n            \n            // Info\n            $body  .= '<table style=\"min-width: 600px; padding: 35px; background-color: #e5e5e5\"; font-family: Roboto, sans-serif; font-size: 15px; text-align: left; border-radius: 4px>';\n            $body .= '<tr></td>';\n            $body .= '<p style=\"font-size: 13px\">This email was sent from the <b>'.$source.'</b> at <b>'.get_bloginfo( 'name' ).'</b>.</p>';\n            $body .= '</td></tr>';        \n            $body .= '</table>';\n\n            $mail = false;\n            if ( get_field( $field_send_options, 'option' ) == 'Email Recipient' ) {\n    \n                $mail = wp_mail( $to, $subject, $body, $header );\n\n            } else {\n\n                if ( get_field( $field_webhook_url, 'option' ) ) {\n                    $webhook = get_field( $field_webhook_url, 'option' );\n                } else {\n                    $webhook = null;\n                }\n\n                $webhook_body = array();\n                foreach( $_POST as $key => $value ) {\n\n                    $webhook_data = array(\n                        'key' => sanitize_text_field( $key ),\n                        'value' => $value\n                    );\n\n                    array_push( $webhook_body, $webhook_data );\n                }\n\n                $webhook_args = array(\n                    'method'      => 'POST',\n                    'timeout'     => 60,\n                    'sslverify'   => false,\n                    'headers'     => array(\n                        'Content-Type'  => 'application/json',\n                    ),\n                    'body'        => json_encode( $webhook_body )\n                );\n\n                $webhook_request = wp_remote_post( $webhook, $webhook_args );\n\n                if ( is_wp_error( $webhook_request ) || wp_remote_retrieve_response_code( $webhook_request ) != 200 ) {\n                    error_log( print_r( get_field( $field_send_options, 'option' ), true ) );\n                } else {\n                    $mail = true; \n                }\n\n                $webhook_response = wp_remote_retrieve_body( $webhook_request );                \n            }\n    \n            if ( $mail ) {\n                $response = array(\n                    'status'  => 'success',\n                    'info'    => $success_message\n                );\n            \n                print_r( json_encode( $response ) );\n    \n            } else {\n                $response = array(\n                    'status' => 'fail',\n                    'info'   => $error_message\n                );\n            \n                print_r( json_encode( $response ) );\n            }\n    \n        } else {\n    \n            $response = array(\n                'status'  => 'invalid',\n                'info'    => $validation_message,\n                'captcha' => $errCaptcha,\n                'fields'  => $errFields,\n                'errors'  => count( $errFields )\n            );\n    \n            print_r( json_encode( $response ) );\n        }\n    }\n\n    exit;\n} \n\nadd_action( 'wp_ajax_leverage_contact_form', 'leverage_handle_ajax_request' );\nadd_action( 'wp_ajax_nopriv_leverage_contact_form', 'leverage_handle_ajax_request' );\n\n\nI've try lots of code(get_permalink( $post = 0, $leavename = false ) but nothing work.\nIt's about the notice mail(to admin) after user fill the contact form on frontend. I'd like to know which page excatly the user is viewing so that I could increase more budget to the GoogleAd. but I can't find a way to make it happen.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404882", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: if role is logged in then do something I need some pro eyes please.\nOver all, I'm adding one button/link to the MAIN NAV depending on the logged in role.\nI have this \u201cworking\u201d code:\nif ( ! function_exists( 'add_extra_item_to_nav_menu' ) ){\n\nfunction add_extra_item_to_nav_menu( $items, $args ) {\n    if (current_user_can('administrator') && is_user_logged_in() && $args->menu-5) {\n        $items .= '<li><a href=\"/product-category/public/SCHOOL_NAME/\" class=\"navShopNow fungula\">SHOP NOW ADMIN</a></li>';\n    }\n\n    //School ROLEABC\n            elseif (current_user_can('ROLEABC') && is_user_logged_in && $args->menu-5) {\n                    $items .= '<li><a href=\"/product-category/public/SCHOOL_NAME/\" class=\"navShopNow fungula\">SHOP NOW ABC</a></li>';\n            }\n    //School ROLEXYZ\n            elseif (current_user_can('ROLEXYZ') && is_user_logged_in && $args->menu-5) {\n                    $items .= '<li><a href=\"/product-category/public/SCHOOL_NAME/\" class=\"navShopNow fungula\">SHOP NOW XYZ</a></li>';\n            }\n\n    return $items;\n\n}\n\nadd_filter( 'wp_nav_menu_items', 'add_extra_item_to_nav_menu', 150, 2 );\n}\n\nIt seems to work (it does what it's supposed to), but it is correct?\nIs it a security issue?\nDid I not close it properly?\nSideNote: \u201csometimes\u201d the button won't load/show on the home page only;\ne.i. \"the button won't appear\",\nbut it always works/appears on the rest of the site.\nThanks in advance, :)\n\nA: Something like this would be more efficient. This is basic PHP by the way, not WP specific.\nfunction add_extra_item_to_nav_menu( $items, $args ) {\n\n    $roles = [\n        'administrator' => [ //Role - slug name\n            'SCHOOL_NAME-A', //url path - appended to the end\n            'ADMIN', // can be any name - appended to SHOP NOW button\n        ],\n        'ROLEABC' => [\n            'SCHOOL_NAME-B',\n            'ABC',\n        ],\n        'ROLEXYZ' => [\n            'SCHOOL_NAME-C',\n            'XYZ',\n        ],\n    ];\n\n    foreach ( $roles as $role => $menu ) {\n        if ( current_user_can( $role ) && is_user_logged_in() && $args->menu-5 ) {\n            $items .= '<li><a href=\"/product-category/public/' . $menu[0] . '/\" class=\"navShopNow fungula\">SHOP NOW ' . $menu[1] . '</a></li>';\n            break;\n        }\n    }\n\n    return $items;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404883", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to fix Scrape key check failed on WordPress VPS? I'm asking here because DigitalOcean support or forums have no idea what's going on.\nI create a LAMP server and the I installed WordPress.\nEverything was working ok, so I created a snapshot of the instance.\nAfter I migrated the site to the new server, and then I receive I critical error from the PHP Code Widget plugin that I had on the original server. So, I removed the plugin, and now the site works.\nThen I receive the error \u201cScrape key check failed. Please try again\u201d when trying to save a PHP file with the WordPress Theme editor.\nI know it's not ideal, but it should work nonetheless because then it means that there's a problem.\nSo, I disabled all the plugins, and I still get the same error.\nI change the theme and I still getting the same error.\nI have a cache plugin w3 total cache, so I disabled it too and deleted the cache, and I\ncontinue with the same error.\nSo, then I decided to delete the VPS and create a new VPS, so tried to create another server with the image I created, and now without doing anything I receive the error \u201cScrape key check failed. Please try again\u201d when trying to save a PHP file with the WordPress Theme editor. So, I don't get it, if it worked before, why I'm getting the error now when I haven't even transferred anything from the old server yet.\nSo, I created another VPS, but this time, I created another VPS using a clean LAMP image provided by DigitalOcean. Then I installed WordPress, and this is supposed to work, right? Wrong, I haven't done anything and every VPS I create from this point forward, I will receive the error \u201cScrape key check failed. Please try again\u201d when trying to save a PHP file with the WordPress Theme editor.\nAlso, for this process, I've been using Chrome and Firefox in incognito mode. I switched computers. and I have even tried a different internet connection with a different computer to end with the same error.\nThe thing is now, I can't even create a brand new VPS without running into the issue.\nAny ideas on how to fix this problem?\nThanks,\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404884", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to work Woocommerce pagination inside shortcode? I have a shortcode that shows the orders history placed by user. It works, however I have pagination with WP_Query which is not working. When I click on any page number the same page is reloaded, the other orders to view are not loaded.\nI followed this documentation: https://woocommerce.github.io/code-reference/files/woocommerce-templates-loop-pagination.html\nAnd also followed this post: pagination in woocommerce order history page\nCan anyone help me figure out where am I wrong? Why aren't the other pages loaded?\nShortcode\nadd_shortcode( 'all_orders' , 'prc_orders' );\nfunction prc_orders() {\n    \n// Get all orders for the current user.\n$customer = get_posts(apply_filters('woocommerce_my_account_my_orders_query', array(\n    'numberposts' => -1,\n    'meta_key'    => '_customer_user',\n    'meta_value'  => get_current_user_id(),\n    'post_type'   => wc_get_order_types('view-orders'),\n    'post_status' => array_keys(wc_get_order_statuses())\n)));  \n    \n// Pagination Part I    \n$total_records = count($customer);\n$posts_per_page = 2;\n$total_pages = ceil($total_records / $posts_per_page);\n$paged = ( get_query_var('page') ) ? get_query_var('page') : 1;\n$customer_orders = get_posts(array(\n    'meta_key' => '_customer_user',\n    'meta_value' => get_current_user_id(),\n    'post_type' => wc_get_order_types('view-orders'),\n    'posts_per_page' => $posts_per_page,\n    'paged' => $paged,\n    'post_status' => array_keys(wc_get_order_statuses())\n));\n\n     // Get Access $order variable Foreach\n     foreach ( $customer_orders as $order_id ) {\n        \n     // Get $product object from $order / $order_id\n     $order = wc_get_order( $order_id );\n     $items = $order->get_items();\n     \n     $orders_id = $order->get_id();\n     $status = $order->get_status();\n     $date_created = $order->get_date_created()->date('d/m/Y - H:i');\n     $payment_method = $order->get_payment_method_title();\n     $order_total = $order->get_formatted_order_total();\n    \n    // Get Access Items & Product Variable Foreach\n     foreach ( $items as $item ) {\n     $product_name = $item->get_name();\n         \n     // Get product image - https://www.businessbloomer.com/woocommerce-easily-get-product-info-title-sku-desc-product-object/\n     $product = $item->get_product();\n     if( $product instanceof WC_Product ){\n     $order_img = $product->get_image();\n     }\n    \n    // Get product download button \n    $downloads = $order->get_downloadable_items();\n     if(is_array($downloads)){\n     foreach($downloads as $product){\n     $download_button = '<a href=\"'. $product['download_url'] .'\" target=\"_blank\">Download</a>';\n     } \n    }   \n               \n     echo \n     '\n     <div class=\"container_orders\">\n    \n      <div class=\"container_orders_card_left\"> \n        <div class=\"items_orders_card name\"> '. $product_name .' </div>\n        <div class=\"items_orders_card\"> <span class=\"items_title\">Ordine:</span> #'. $orders_id .'  </div>\n        <div class=\"items_orders_card\"> <span class=\"items_title\">Effettuato il:</span> '. $date_created .' </div>\n        <div class=\"items_orders_card\"> <span class=\"items_title\">'. $payment_method .'</span> \u2022 '. $order_total .' </div>\n        <div class=\"items_orders_card\"> <span class=\"items_title\">Stato:</span> '. $status .' </div>\n      </div>\n    \n      <div class=\"container_orders_card_right\">\n        <div class=\"container_orders_download\"> '. $download_button .' </div>\n        <div class=\"container_orders_img\"> '. $order_img .' </div>\n      </div>\n    \n     </div>\n     \n     '; \n     \n    }} // Closing Foreach\n\n\n    // Pagination Part II\n    ?><div class=\"pagination\"><?php\n    $args = array(\n        'base' => '%_%',\n        'format' => '?pagina=%#%',\n        'total' => $total_pages,\n        'current' => $paged,\n        'show_all' => False,\n        'end_size' => 5,\n        'mid_size' => 5,\n        'prev_next' => True,\n        'prev_text' => __('&laquo; Previous'),\n        'next_text' => __('Next &raquo;'),\n        'type' => 'plain',\n        'add_args' => False,\n        'add_fragment' => ''\n    );\n    echo paginate_links($args);\n    ?></div><?php\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404885", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: .htaccess with Wordpress - create my own pretty url with parameters (above Wordpress settings) (first of all, sorry for my poor english)\nI have an url what is works just fine: example.com/myevent/?e=event_unique_title , I like to change the way to see it in the address bar to: example.com/myevent/event_unique_title\nIs there a way to add this rule to the .htaccess file to see always the \"pretty\" url and get the parametered version as a result?\nI tried a few versions like this, but got no result:\nRewriteEngine On \nRewriteRule ^myevent/([\\w-]+)$ /myevent/?e=$1 [QSA,L]\nAnd of course I do not like to break the Wordpress own settings.\nThanks for any help!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404886", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Create Custom URL structure for specific Post category using Post ID instead of post name My Custom Structure is set to \"%postname%/\"\nThis works as expected, but for Posts with the Category \"Latest News\", I would like to change the URL structure to be \"%postid%/\".\nI put the following code in my functions.php:\n    add_filter( 'post_link', 'custom_permalink', 10, 3 );\nfunction custom_permalink( $permalink, $post, $leavename ) {\n    // Get the category for the post\n    $category = get_the_category($post->ID);\n    if (  !empty($category) && $category[0]->cat_name == \"latestnews\" ) {\n        $cat_name = strtolower($category[0]->cat_name);\n        $permalink = trailingslashit( home_url('/'. $cat_name . '/' . $post->ID .'/' ) );\n    }\n    return $permalink;\n}\nadd_action( 'init', 'custom_rewrite_rules' );\nfunction custom_rewrite_rules() {\n    add_rewrite_rule(\n        'latestnews/([^/]+)(?:/([0-9]+))?/?$',\n        'index.php?category_name=latestnews&name=$matches[1]&page=$matches[2]',\n        'top' // The rule position; either 'top' or 'bottom' (default).\n    );\n}\n\nThis does ngenerates the desired URL, \"myurl.com/POSTID\" when I try to click on the desired Post its shows me 404 error\nI'd like to accomplish the URL rewrite without needing to register a new Custom Post Type.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404888", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Configuring Xdebug with docker compose I'm trying to configure a WordPress development environment with docker-compose and Xdebug but I can't get the debugger to work with a simple break point on info.php file after starting my debugging session on vscode.\nhere are my configs:\n\nrootDir/.vscode/launch.json\n\n{\n// Use IntelliSense to learn about possible attributes.\n// Hover to view descriptions of existing attributes.\n// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387\n\"version\": \"0.2.0\",\n\"configurations\": [\n    {\n        \"name\": \"Listen for Xdebug\",\n        \"type\": \"php\",\n        \"request\": \"launch\",\n        \"port\": 9003,\n        \"pathMappings\": {\n            \"/var/www/html\":\"${workspaceFolder}/wp\"\n        }\n    },\n    {\n        \"name\": \"Launch currently open script\",\n        \"type\": \"php\",\n        \"request\": \"launch\",\n        \"program\": \"${file}\",\n        \"cwd\": \"${fileDirname}\",\n        \"port\": 0,\n        \"runtimeArgs\": [\n            \"-dxdebug.start_with_request=yes\"\n        ],\n        \"env\": {\n            \"XDEBUG_MODE\": \"debug,develop\",\n            \"XDEBUG_CONFIG\": \"client_port=${port}\"\n        }\n    },\n    {\n        \"name\": \"Launch Built-in web server\",\n        \"type\": \"php\",\n        \"request\": \"launch\",\n        \"runtimeArgs\": [\n            \"-dxdebug.mode=debug\",\n            \"-dxdebug.start_with_request=yes\",\n            \"-S\",\n            \"localhost:0\"\n        ],\n        \"program\": \"\",\n        \"cwd\": \"${workspaceRoot}\",\n        \"port\": 9003,\n        \"serverReadyAction\": {\n            \"pattern\": \"Development Server \\\\(http://localhost:([0-9]+)\\\\) started\",\n            \"uriFormat\": \"http://localhost:%s\",\n            \"action\": \"openExternally\"\n        }\n    }\n]\n\n}\n\nrootDir/docker-compose.yml\n\nversion: \"3.9\"\n\nservices:\n  db:\n    image: mysql:5.7\n    volumes:\n      - db_data:/var/lib/mysql\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: somewordpress\n      MYSQL_DATABASE: wordpress\n      MYSQL_USER: wordpress\n      MYSQL_PASSWORD: wordpress\n\n  wordpress:\n    depends_on:\n      - db\n    build: .\n    volumes:\n      - ./wp:/var/www/html\n      - ./php.ini:/usr/local/etc/php/php.ini\n    ports:\n      - \"80:80\"\n    restart: always\n    environment:\n      PHP_EXTENSION_DEBUG: 1\n      WORDPRESS_DB_HOST: db\n      WORDPRESS_DB_USER: wordpress\n      WORDPRESS_DB_PASSWORD: wordpress\n      WORDPRESS_DB_NAME: wordpress\nvolumes:\n  db_data: {}\n  wp: {}\n\n\nrootDir/dockerfile\\\n\nFROM php:7.4-apache\n\nRUN docker-php-ext-install mysqli\n\nRUN pecl install xdebug\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404889", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Dynamically switch file in get_template_directory_uri() | Function I need to switch scheme color of my WordPress theme trough Redux option panel.\nMy plan is switch the CSS file trough get_template_directory_uri() | Function.\nThe scenario is:\n\n*\n\n*Create 2 scheme color: dark and light with dark.css and libght.css.\n\n\n*Control from redux panel with this code:\n<?php\nRedux::setSection( $opt_name, array(\n 'title'  => __( 'Color Scheme', 'javapaper' ),\n 'id'     => 'test_scheme',\n 'icon'   => 'el el-list',\n 'fields' => array(\n     array(\n         'id'       => 'color_scheme',\n         'type'     => 'image_select',\n         'title'    => __( 'SELECT Color Scheme', 'javapaper' ),\n         'subtitle' => __( '2 scheme Available', 'javapaper' ),              \n         'options'  => array(\n             'dark' => array(\n                 'title' => 'dark',\n                 'alt' => 'dark',\n                 'img' => get_stylesheet_directory_uri() . '/images/header-styledefault.png'\n             ),              \n             'light' => array(\n                 'title' => 'light',                 \n                 'alt' => 'light',\n                 'img' => get_stylesheet_directory_uri() . '/images/header-style2.png'\n             )                   \n         ),\n\n         'default'  => 'dark'\n     ),          \n\n      )\n  ) );\n?>   \n\n\n\n*Call the code from Redux panel into get_template_directory_uri() | Function like this:\n wp_enqueue_style( 'javapaper-lightbox-style', get_template_directory_uri() . '/css/$redux_demo[\"color_scheme\"]' );  \n\nBut Unfortunately It did not work. I am newbie on php. Please help.\n\nA: If you are sure that $redux_demo[\"color_scheme\"] is getting the corresponding value, so your code should be:\nglobal $redux_demo;\nwp_enqueue_style( 'javapaper-lightbox-style', get_template_directory_uri() . \"/css/{$redux_demo['color_scheme']}.css\" );\n\nAssuming that you have files in this structure css/dark.css and css/light.css.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404891", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: List page is showing 404 I have built a new site based on a content from an old one. Also, there is some partial content in another WordPress blog which I have to import. Unfortunately, on the blog I don't have full access, but the owner shared the full backup file. I needed only some categories, not the entire blog.\nSo, I tried to import the file in a brand-new website, on a subdomain, but the export file was too big and the settings of the server didn't allow me to import the file (shared hosting). I've created another blog on wordpress.com, and I've imported the site there. After, I've exported only the necessary category. Unfortunately also having only few articles in the exported file, I couldn't import it because the import was crashed/blocked. The last solution was to import the articles manually. Bad and awful, I know. Anyway, I've started to import them and set the date to its original date in the blog, in the past.\nOn the newly created site, I've created a new permastruct to allow filtering the loop by category and year\n$wp_rewrite->add_rewrite_tag(\"%muz_category_name%\", '([^/]+)', \"category_name=\");\n$wp_rewrite->add_rewrite_tag(\"%muz_year%\", '([0-9]{4})', \"year=\");\n$wp_rewrite->add_permastruct( 'category-archive', 'category-archive/%muz_category_name%/%muz_year%', array( 'walk_dirs' => false, 'paged' => true ) );\n\nThese links are working well, but for the year 2021 where I receive a 404. When I check the query, the year is added as the name argument, not the year.\nIs this something that can be linked to the fact that the date of the post is set back in history? I checked the records in DB and I haven't found anything strange between these old posts and the newly created ones.\nAlso, I don't understand why I receive a 404 response. I expect something like \"No posts found on provided criteria\" or something like that. As I said, this happens only for year 2021. For the rest of the years, until 2012 everything works well.\nSo, trying the URL /category-archive/expozitii-temporare/2022 will search in the category Expozi\u021bii temporare filtered by year 2022. WP Query object looks like this:\n[query] => Array\n    (\n        [year] => 2022\n        [category_name] => expozitii-temporare\n    )\n\nUsing /category-archive/expozitii-temporare/2021 the WP Query object returns:\n[query] => Array\n    (\n        [category_name] => expozitii-temporare\n        [page] => 0\n        [name] => 2021\n    )\n\nIn fact, what I want is to alter main Loop Query to filter posts by category and year and still have a friendly URL.\nAny starting point is much appreciated, so...\nThanks in advance!\n\nA: Having the permalink as /%postname%/ it doesn't work either if I switch back to the original WP theme and disable all plugins. It works though if I change the permalink to the predefined /%year%/%monthnum%/%postname%/ or to a custom /%year%/%postname%/ permalink. From my point of view, it is a WP bug.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404899", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to changes mobile menu toggle breakpoint in Wordpress I want to change the mobile menu toggle breakpoint in twenty-twenty one theme, want to show on 767px but it shows on 481px by default.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404900", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I structure my permalinks in Wordpress? I am using wordpress and all I want to do is make the URL appear in the form where, Blogs is mentioned and then the blogname. But I want this structure only when someone visits blogs page. The blogs slug shouldn't appear elsewhere like if i go another page, then the blogs shouldn't be shown. The structure I am desiring should only appear when someone is accessing blogs pages.\nFor Ex: www.example.com/blogs/blogname - That's it!\nNO CATEGORY, NO NOTHING. ONLY FOR BLOGS.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404902", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Set the payment processor callbacks to a plugin We need for our Wordpress page a plugin which processes in certain situations the payments independently from the regular check-out page. Normally, a payment processor like PayPal, Stripe and others, use callback URLs to inform the site about the result.\nSo, we have now this situation:\nThe plugin needs to know the result of the payment process but the callback URLs are set to some URL which do not belong to the plugin. With other words, we would have 2 check-out pages.\nMy question:\nIs there a general way how this plugin can catch/get the result of any payment and evaluate the result only then, when the payment was initiated by the plugin?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404904", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Changing update message from Newspaper child theme Maybe my question is very particular and limited to Newspaper theme users.\nI\u2019m using child theme with an update server. It works fine.\nI\u2019m wondering if I can change this update message and actions just for the child theme:\n\nWanna do this because when I hit the Update button it actually updates the parent theme instead. I don't know if this can actually be changed from child theme or custom plugins. This message only appears under /wp-admin/themes.php\nI\u2019ve tried coding this but got unsuccessful.\nAny ideas? Thanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404905", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress REST API V2: \"{CUSTOM_POST_TYPE} matches Term ID List and Term ID Taxonomy Query, but should match only one.\" I am trying to use the V2 REST API to filter a custom post type by a custom taxonomy, and if I try to specify the custom post type parameter, the request fails. I understand what the response is saying, but I don't understand how I can create a custom taxonomy that doesn't exist as both part of the list of terms for the custom post type as well as the root of a taxonomy query.\nExample request URL: https://www.my-domain.com/?rest_route=/wp/v2/my_custom_post_type&my_custom_taxonomy={ID}\nHere's how the custom post type is registered on the WP side:\nregister_post_type('my_custom_post_type', [\n        'capabilities' => [\n            ...\n        ],\n        'description' => 'Custom Posts',\n        'graphql_single_name' => 'myCustomPostType',\n        'graphql_plural_name' => 'myCustomPostTypes',\n        'label' => 'Custom Posts',\n        'labels' => [\n            ...\n        ],\n        'menu_icon' => 'https://cdn.someurl.com/posts-icon.svg',\n        'menu_position' => 4,\n        'public' => true,\n        'show_in_admin_bar' => true,\n        'show_in_graphql' => true,\n        'show_in_menu' => true,\n        'show_in_nav_menus' => true,\n        'show_in_rest' => true,\n        'show_ui' => true,\n        'supports' => [\n            'author',\n            'custom-fields',\n            'page-attributes',\n            'thumbnail',\n            'title'\n        ]\n    ]);\n\nAnd here's how the custom post type is registered:\nregister_taxonomy(\n        'my_custom_taxonomy',\n        'my_custom_post_type',\n        [\n            'description' => 'These categories are used to group custom posts',\n            'graphql_single_name' => 'myCustomPostType',\n            'graphql_plural_name' => 'myCustomPostTypes',\n            'labels' => [\n                'all_items' => 'All Categories',\n                'name' => 'Custom Categories',\n                'popular_items' => 'Popular Categories',\n                'search_items' => 'Search Categories',\n                'singular_name' => 'Custom Category',\n            ],\n            'hierarchical' => true,\n            'public' => true,\n            'show_admin_column' => true,\n            'show_in_rest' => true,\n            'show_in_graphql' => true,\n            'sort' => false\n        ]\n    );\n\nThe API responds with a 400 and the following detailed message:\n\"my_custom_post_type matches Term ID List and Term ID Taxonomy Query, but should match only one.\"\nAny ideas how I can register it properly so that there is no clash? I'm wondering if it has something to do with enabling the GraphQL options in the back-end, but I'm using it with Gatsby to statically generate some content at build time and then pulling these queries as part of user searches at client runtime.\nThank you!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404906", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Override WordPress core post-template.php block template I need to modify the default markup generated using the render_block_core_post_template function located inside wp-includes > blocks > post-template.php.\nI don't see any other way of modifying the markup so i can insert a custom field.\nIs it possible to override this core template via a theme or plugin? If so, where to start.\nfunction register_block_core_post_template() {\n    register_block_type_from_metadata(\n        __DIR__ . '/post-template',\n        array(\n            'render_callback'   => 'render_block_core_post_template',\n            'skip_inner_blocks' => true,\n        )\n    );\n}\nadd_action( 'init', 'register_block_core_post_template' );\n\n\nA: To insert a custom field:\nI recommend using the Meta Field Block plugin developed just for this purpose\nTo alter core/post-template's DOM with PHP\nAdd a filter to render_block action e.g. in functions.php\n// Replace post-template block with custom DOM\nadd_filter( 'render_block', 'MyPostTemplate' , 10, 2 );\n\nfunction MyPostTemplate( $block_content, $block )\n{\n    // bypass if other block\n    if ( 'core/post-template' !== $block['blockName'] ) return $block_content;\n\n    // do something with $block_content (here we prepend a paragraph to each listed entry)\n    $block_content=str_replace(\"<li \", \"<p>Hello world!</p><li \", $block_content);\n\n    return $block_content;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404908", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can I add a default Block to my custom theme? Lots of plugins provide both shortcodes and PHP for adding elements... either directly in a page or post, or programmatically in a theme template. Is there a process for adding a Block, like Latest Posts, directly to a theme using PHP? I imagine it might be like this:\n<?php add_block('latest_posts'); ?>\n\nI'm running 5.9.3.\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404909", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to set \"split_on_numerics\" to false in ElasticSearch mapping using ElasticPress? (for proper SKU search in WooCommerce) I've been using ElasticSearch v7.10 installed on the same server that I have a website in WordPress with WooCommerce, that is connected using the plugin ElasticPress v4.0.\nI am trying to modify mapping but so far with no success. This because when we search for a SKU, although the corresponding item comes up in first most of the times, it also shows other results and sometimes it's not even on the first place the exact match.\nHere's what I've done so far:\n\n*\n\n*Forced SKU to be indexed\n\n*Forced variations SKUs to be indexed\n\n*Used Debug Bar with ElasticPress Debug to check query\n\n*Google searched for days for ways to modify ElasticSearch mapping and tried multiple examples\n\n*Asked for help in Github for ElasticPress (which they answered this is not a bug or issue to solve there and pointed to paid consultancy)\n\nAnd here's the code that supposedly should work and it's not:\nfunction configMapping($mapping){\n    // bail early if $mapping is missing or not array\n    if ( ! isset( $mapping ) || ! is_array( $mapping ) ) {\n        return false;\n    }\n\n    // ensure we have filters and is array\n    if (! isset( $mapping['settings']['analysis']['filter'] )\n        || ! is_array( $mapping['settings']['analysis']['filter'] )) {\n        return false;\n    }\n\n    // ensure we have analyzers and is array\n    if (! isset( $mapping['settings']['analysis']['analyzer']['default']['filter'] )\n        || ! is_array( $mapping['settings']['analysis']['analyzer']['default']['filter'] )) {\n        return false;\n    }\n\n    // define the custom filter\n    $mapping['settings']['analysis']['filter']['my_custom_word_delimiter_filter'] = array(\n        'type'                  => 'word_delimiter',\n        'split_on_case_change'  => false,\n        'split_on_numerics'     => false\n    );\n\n    // tell the analyzer to use our newly created filter\n    $mapping['settings']['analysis']['analyzer']['default']['filter'][] = 'my_custom_word_delimiter_filter';\n    return $mapping;\n}\nadd_filter('ep_config_mapping', 'configMapping', 10, 1);\n\nAny help will be much appreciated, I'm just out of ideas! :(\n\nA: This one was tough, but here is the solution for this!\nFirst, you will need to use SSH to access the server where you have ElasticSearch installed.\nAfter that, you will want to perform these commands:\n\n*\n\n*This one will first close your index, only then you can perform changes:\ncurl -X POST http://localhost:9200/YOUR-INDEX/_close?pretty\n\n\n*This one will put the filter for \"word_delimiter\":\ncurl -X PUT \"localhost:9200/YOUR-INDEX/_settings?pretty\" -H 'Content-Type: application/json' -d'\n{\n\"settings\": {\n\"analysis\": {\n\"analyzer\": {\n\"my_analyzer\": {\n\"tokenizer\": \"keyword\",\n\"filter\": [ \"word_delimiter\" ]\n}\n}\n}\n}\n}'\n\n\n*Then we put the filters we want, like so:\ncurl -X PUT \"localhost:9200/aYOUR-INDEX/_settings?pretty\" -H 'Content-Type: application/json' -d'\n{\n\"settings\": {\n\"analysis\": {\n\"analyzer\": {\n\"my_analyzer\": {\n\"tokenizer\": \"keyword\",\n\"filter\": [ \"my_custom_word_delimiter_filter\" ]\n}\n},\n\"filter\": {\n\"my_custom_word_delimiter_filter\": {\n\"type\": \"word_delimiter\",\n\"type_table\": [ \"- => ALPHA\" ],\n\"split_on_case_change\": false,\n\"split_on_numerics\": false,\n\"stem_english_possessive\": true\n}\n}\n}\n}\n}'\n\n\n*Last but not least, you will want to open your index again, so here we go:\ncurl -X POST http://localhost:9200/YOUR-INDEX/_open?pretty\nI had to perform all these steps because my index was already created, otherwise it would be basically like we see on the example page.\nHope this helps future visitors. :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404911", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Customizer control save then return to default Is it possible with default wordpress controls to use the radio control then save then automatically revert to default after each save. For example radio select 0, 1, 2 is option and you select 2, then after saving it reverts back to radio select 0 so at the next full page load it is back at radio select 0.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404912", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disable Category Taxonomy There's a similar question to this posted back in 2013 (Completely disable categories), but the proposed solution doesn't provide information as to how to implement it (where do I place the provided code? The theme's functions.php?) and as mentioned, is pretty old now.\nI was hoping for an updated answer: How do I disable both front end and back end functionality categories?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404913", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get_terms with specific id order I have the specific query\n$queried_object = get_queried_object();\n$taxonomy = $queried_object->taxonomy;\n$term_id = $queried_object->term_id;\n$isActive = 0;\n$postTerms = get_terms( [\n'taxonomy' => 'field',\n'orderby' => 'id',\n'hide_empty' => true,\n   ] );\n foreach($postTerms as $postTerm) :\n ?>\n <?php if($postTerm->term_id == 1 || $postTerm->term_id ==  2|| $postTerm->term_id == \n 2):?>\n\nThis returns the fied in order 1,2,3.\nI'm trying to return them in a specific order: 2,1,3\nI don't think I can use an array with get_terms, so I'm a little lost on the best way to do that.\nAny little guidance would be much appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404915", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why is my Javascript console showing a 404 error for a file called \"null\" on a clean Wordpress install? Every Wordpress site I am building shows 404 (Not Found) error in the Javascript console for a file called null. I have confirmed that this happening on a clean install of WP 5.9.3 without any plugins, settings changes, or database edits. Here's what it looks like in Chrome Dev console:\n\nThis happens on every page on the site whether I am logged in or not. In the above example, if you look at the referenced line 330, it's always a blank line at the end of the rendered HTML:\n\nWhat is causing this error?\n\nA: Turns out this was being caused by a Chrome browser extension. I use an extension installed called \"CrxMouse Chrome Gestures.\" This extension is the cause of this error. I have turned off the extension and notified the author of this bug.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404916", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Cannot read properties of undefined (reading 'firstChild') using photoswipe in product page <div class=\"pswp\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n    <div class=\"pswp__bg\"></div>\n    <div class=\"pswp__scroll-wrap\">\n        <div class=\"pswp__container\">\n            <div class=\"pswp__item\"></div>\n            <div class=\"pswp__item\"></div>\n            <div class=\"pswp__item\"></div>\n        </div>\n        <div class=\"pswp__ui pswp__ui--hidden\">\n            <div class=\"pswp__top-bar\">\n                <div class=\"pswp__counter\"></div>\n                <button class=\"pswp__button pswp__button--close\" aria-label=\"<?php esc_attr_e( 'Close (Esc)', 'woocommerce' ); ?>\"></button>\n                <button class=\"pswp__button pswp__button--share\" aria-label=\"<?php esc_attr_e( 'Share', 'woocommerce' ); ?>\"></button>\n                <button class=\"pswp__button pswp__button--fs\" aria-label=\"<?php esc_attr_e( 'Toggle fullscreen', 'woocommerce' ); ?>\"></button>\n                <button class=\"pswp__button pswp__button--zoom\" aria-label=\"<?php esc_attr_e( 'Zoom in/out', 'woocommerce' ); ?>\"></button>\n                <div class=\"pswp__preloader\">\n                    <div class=\"pswp__preloader__icn\">\n                        <div class=\"pswp__preloader__cut\">\n                            <div class=\"pswp__preloader__donut\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class=\"pswp__share-modal pswp__share-modal--hidden pswp__single-tap\">\n                <div class=\"pswp__share-tooltip\"></div>\n            </div>\n            <button class=\"pswp__button pswp__button--arrow--left\" aria-label=\"<?php esc_attr_e( 'Previous (arrow left)', 'woocommerce' ); ?>\"></button>\n            <button class=\"pswp__button pswp__button--arrow--right\" aria-label=\"<?php esc_attr_e( 'Next (arrow right)', 'woocommerce' ); ?>\"></button>\n            <div class=\"pswp__caption\">\n                <div class=\"pswp__caption__center\"></div>\n            </div>\n        </div>\n    </div>\n</div>\n<script src='https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js'/></script>\n<script src='https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js'/></script>\n<script type=\"text/javascript\">\n jQuery(document).ready(function() {\nconst lightboxx = new PhotoSwipe({\n  // may select multiple \"galleries\"\n  gallery: '.pswp',\n children: 'div',\n});\n\n  lightboxx.init();\n        \ndocument.getElementById('btnShow').onclick = lightboxx ;\n\n});\n</script>\n\n\nA: I was doing it wrong. Data has to go into javascript, and orignal html should not be changed\n<div class=\"pswp\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n                <div class=\"pswp__bg\"></div>\n\n                \n                <div class=\"pswp__scroll-wrap\">\n\n                    <!-- Container that holds slides. -->\n                    <div class=\"pswp__container\">\n                        <!-- don't modify these 3 pswp__item elements, data is added later on -->\n                        <div class=\"pswp__item\"></div>\n                        <div class=\"pswp__item\"></div>\n                        \n                    </div>\n\n                    <!-- Default -->\n                    <div class=\"pswp__ui pswp__ui--hidden\">\n\n                        <div class=\"pswp__top-bar\">\n\n                            <!--  Controls are self-explanatory. Order can be changed. -->\n\n                            <div class=\"pswp__counter\"></div>\n\n                            <button class=\"pswp__button pswp__button--close\" title=\"Close (Esc)\"></button>\n<button class=\"pswp__button pswp__button--share\" title=\"Share\"></button>\n\n                            <button class=\"pswp__button pswp__button--fs\" title=\"Toggle fullscreen\"></button>\n\n                            <button class=\"pswp__button pswp__button--zoom\" title=\"Zoom in/out\"></button>\n\n                            \n                            <div class=\"pswp__preloader\">\n                                <div class=\"pswp__preloader__icn\">\n                                    <div class=\"pswp__preloader__cut\">\n                                        <div class=\"pswp__preloader__donut\"></div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class=\"pswp__share-modal pswp__share-modal--hidden pswp__single-tap\">\n                            <div class=\"pswp__share-tooltip\"></div>\n                        </div>\n\n                        <button class=\"pswp__button pswp__button--arrow--left\" title=\"Previous (arrow left)\">\n                        </button>\n\n                        <button class=\"pswp__button pswp__button--arrow--right\" title=\"Next (arrow right)\">\n                        </button>\n\n                        <div class=\"pswp__caption\">\n                            <div class=\"pswp__caption__center\"></div>\n                        </div>\n\n                    </div>\n\n                </div>\n\n        </div>\n <script src='https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js'/></script>\n<script src='https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js'/></script>       \n<script type=\"text/javascript\" >\n            var openPhotoSwipe = function() {\n                var pswpElement = document.querySelectorAll('.pswp')[0];\n\n                // build items array\n                var items = [\n                {\n                    html: '<iframe src=\"http://www.africau.edu/images/default/sample.pdf\"></iframe>'\n                },\n                {\n                    html: '<iframe src=\"http://www.africau.edu/images/default/sample.pdf\"></iframe>'\n                    \n                }\n                ];\n\n                // define options (if needed)\n                var options = {\n                    // history & focus options are disabled on CodePen        \n                    history: false,\n                    focus: false,\n\n                    showAnimationDuration: 0,\n                    hideAnimationDuration: 0\n\n                };\n\n                var gallery = new PhotoSwipe( pswpElement, PhotoSwipeUI_Default, items, options);\n                gallery.init();\n            };\n\n            //openPhotoSwipe();\n\n            document.getElementById('btnShow').onclick = openPhotoSwipe;\n        </script>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404917", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP_Query - How to query all of post types categories I added a custom taxonomy to woocommerce's products post type. The custom taxonomy is called Brands and is simply used to select the brand of the product.\nI am using wp_query to query all of the brands so that I may click them and get all of the products that associate. I just cant figure out how to query all of the brands for a given post type.\nHere is my attempted query which isnt returning anything:\n    $brands = array(\n            'post_type' => 'product',\n            'posts_per_page' => -1,\n            'tax_query'     => array(\n                array(\n                'taxonomy'  => 'brands',\n                'field'     => 'name',\n                ),\n            ),\n        );\n$query = new WP_Query( $brands );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404918", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Log in user using Wordpress REST API I am having problems authenticating a user after logging in using a custom endpoint using the WordPress REST API.\nI'm aware that this is not the perfect approach but I am just trying to make a few custom routes so that I can prototype a mobile app. I have searched countless forums and I have looked at a number of other answers but I can't seem to find out what the problem is in my code.\nCode to create a User account\nadd_action( 'rest_api_init', 'my_test_register_user_routes' );\nfunction my_test_register_user_routes() {\n    \n    register_rest_route( APP_NAMESPACE, '/user', [\n        'methods'  => WP_REST_Server::CREATABLE,\n        'callback' => 'my_test_create_user',\n    ] );\n}\n\nfunction my_test_create_user($request) \n{   \n    //create user and get ID\n    $new_user = [];\n    $new_user['username'] = $request['username'];\n    $new_user['email'] = $request['email'];\n    $new_user['password'] = $request['password'];\n\n    $user = wp_insert_user( [\n        'user_login' => $new_user['username'],\n        'user_email' => $new_user['email'],\n        'user_pass' => $new_user['password']\n    ] );\n\n    if( is_wp_error( $user ) ) {\n        return rest_ensure_response( [\n            'error' => 1,\n            'msg' => $user->get_error_message()\n        ] );\n    }\n        \n    return rest_ensure_response( ['User' => 'User created'] );\n}\n\nCode to log in a user\n/* \n    ========================AUTHENTICATION ROUTES========================\n*/\nadd_action( 'rest_api_init', 'my_test_register_authentication_routes' );\nfunction my_test_register_authentication_routes() {\n    \n    register_rest_route( APP_NAMESPACE, '/login', [\n        'methods'  => WP_REST_Server::CREATABLE,\n        'callback' => 'my_test_login_user',\n    ] );\n}\n\nfunction my_test_login_user($request) \n{   \n    $creds = [];\n    $creds['user_login'] = $request[\"user\"];\n    $creds['user_password'] =  $request[\"password\"];\n    $creds['remember'] = true;\n    $user = wp_signon( $creds, false ); \n    \n    if ( is_wp_error($user) )\n        return rest_ensure_response( [\n            'login' => 0,\n            'msg'   => $user->get_error_message()\n        ] );\n    \n\n    wp_set_current_user($user->ID);\n    wp_set_auth_cookie($user->ID,true);\n    $nonce = wp_create_nonce('wp_rest');\n\n    if (is_user_logged_in()) {\n        $current_user = 'Y';\n    } else {\n        $current_user = 'N';\n    }\n    \n    return rest_ensure_response( [\n        'login' => 1,\n        'id' => $user->ID,\n        'nonce' => $nonce,\n        'is_user_logged_in' => $current_user,\n        'msg'   => 'You have successfully logged in'\n    ] );\n}\n\nNow all this looks fine, the user is successfully logged in and expected the data is returned.\nThe code to check if the user is logged in below\nadd_action( 'rest_api_init', 'check_status_route' );\nfunction check_status_route($request)\n{\n    register_rest_route( APP_NAMESPACE, '/status', [\n        'methods'  => WP_REST_Server::READABLE,\n        'callback' => 'check_status',\n    ] );\n}\n\nfunction check_status($request)\n{\n    if (is_user_logged_in()) {\n        $status = \"Logged In\";\n    } else {\n        $status = \"Logged Out\";\n    }\n    \n    return rest_ensure_response( ['status' => $status] );\n}\n\nThe check_status() function returns the following\n{\n    \"code\": \"rest_cookie_invalid_nonce\",\n    \"message\": \"Cookie nonce is invalid\",\n    \"data\": {\n        \"status\": 403\n    }\n}\n\nI have tried using the nonce as both a header and in the URL. What am I missing/doing wrong?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404920", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: WP_Query return posts in wrong order I have a strange WP_Query behavior when using this query arguments:\n$qargs = array(\n        'post_type' => 'any',\n        'post_status' => array('publish', 'inherit'),\n        'post__in' => $post_ids,\n        'lang' => '',\n        'posts_per_page' => $atts['limit'],\n        'orderby' => 'post__in',\n    );\n\n    $the_query = new WP_Query( $qargs );\n\nThe $post_ids variable contains an array of post IDs:\n array (size=9)\n      0 => int 30874\n      1 => int 30394\n      2 => int 30527\n      3 => int 30790\n      4 => int 30761\n      5 => int 30733\n      6 => int 30700\n      7 => int 30685\n      8 => int 30603\n\nThe first ID (30874) is an attachment type post and when the query returns this post becomes the third in the order and I don't know why.\nThis is the var_dump of the query object:\nobject(WP_Query)[20311]\n  public 'query' => \n    array (size=6)\n      'post_type' => string 'any' (length=3)\n      'post_status' => \n        array (size=2)\n          0 => string 'publish' (length=7)\n          1 => string 'inherit' (length=7)\n      'post__in' => \n        array (size=9)\n          0 => int 30874\n          1 => int 30394\n          2 => int 30527\n          3 => int 30790\n          4 => int 30761\n          5 => int 30733\n          6 => int 30700\n          7 => int 30685\n          8 => int 30603\n      'lang' => string '' (length=0)\n      'posts_per_page' => string '8' (length=1)\n      'orderby' => string 'post__in' (length=8)\n  public 'query_vars' => \n    array (size=66)\n      'post_type' => string 'any' (length=3)\n      'post_status' => \n        array (size=2)\n          0 => string 'publish' (length=7)\n          1 => string 'inherit' (length=7)\n      'post__in' => \n        array (size=9)\n          0 => int 30874\n          1 => int 30394\n          2 => int 30527\n          3 => int 30790\n          4 => int 30761\n          5 => int 30733\n          6 => int 30700\n          7 => int 30685\n          8 => int 30603\n      'lang' => string '' (length=0)\n      'posts_per_page' => int 8\n      'orderby' => string 'post__in' (length=8)\n      'error' => string '' (length=0)\n      'm' => string '' (length=0)\n      'p' => int 0\n      'post_parent' => string '' (length=0)\n      'subpost' => string '' (length=0)\n      'subpost_id' => string '' (length=0)\n      'attachment' => string '' (length=0)\n      'attachment_id' => int 0\n      'name' => string '' (length=0)\n      'pagename' => string '' (length=0)\n      'page_id' => int 0\n      'second' => string '' (length=0)\n      'minute' => string '' (length=0)\n      'hour' => string '' (length=0)\n      'day' => int 0\n      'monthnum' => int 0\n      'year' => int 0\n      'w' => int 0\n      'category_name' => string '' (length=0)\n      'tag' => string '' (length=0)\n      'cat' => string '' (length=0)\n      'tag_id' => string '' (length=0)\n      'author' => string '' (length=0)\n      'author_name' => string '' (length=0)\n      'feed' => string '' (length=0)\n      'tb' => string '' (length=0)\n      'paged' => int 0\n      'meta_key' => string '' (length=0)\n      'meta_value' => string '' (length=0)\n      'preview' => string '' (length=0)\n      's' => string '' (length=0)\n      'sentence' => string '' (length=0)\n      'title' => string '' (length=0)\n      'fields' => string '' (length=0)\n      'menu_order' => string '' (length=0)\n      'embed' => string '' (length=0)\n      'category__in' => \n        array (size=0)\n          empty\n      'category__not_in' => \n        array (size=0)\n          empty\n      'category__and' => \n        array (size=0)\n          empty\n      'post__not_in' => \n        array (size=0)\n          empty\n      'post_name__in' => \n        array (size=0)\n          empty\n      'tag__in' => \n        array (size=0)\n          empty\n      'tag__not_in' => \n        array (size=0)\n          empty\n      'tag__and' => \n        array (size=0)\n          empty\n      'tag_slug__in' => \n        array (size=0)\n          empty\n      'tag_slug__and' => \n        array (size=0)\n          empty\n      'post_parent__in' => \n        array (size=0)\n          empty\n      'post_parent__not_in' => \n        array (size=0)\n          empty\n      'author__in' => \n        array (size=0)\n          empty\n      'author__not_in' => \n        array (size=0)\n          empty\n      'update_post_term_cache' => boolean true\n      'ignore_sticky_posts' => boolean false\n      'suppress_filters' => boolean false\n      'cache_results' => boolean true\n      'lazy_load_term_meta' => boolean true\n      'update_post_meta_cache' => boolean true\n      'nopaging' => boolean false\n      'comments_per_page' => string '50' (length=2)\n      'no_found_rows' => boolean false\n      'order' => string '' (length=0)\n  public 'tax_query' => \n    object(WP_Tax_Query)[20312]\n      public 'queries' => \n        array (size=0)\n          empty\n      public 'relation' => string 'AND' (length=3)\n      protected 'table_aliases' => \n        array (size=0)\n          empty\n      public 'queried_terms' => \n        array (size=0)\n          empty\n      public 'primary_table' => string 'wp_posts' (length=9)\n      public 'primary_id_column' => string 'ID' (length=2)\n  public 'meta_query' => \n    object(WP_Meta_Query)[20313]\n      public 'queries' => \n        array (size=0)\n          empty\n      public 'relation' => null\n      public 'meta_table' => null\n      public 'meta_id_column' => null\n      public 'primary_table' => null\n      public 'primary_id_column' => null\n      protected 'table_aliases' => \n        array (size=0)\n          empty\n      protected 'clauses' => \n        array (size=0)\n          empty\n      protected 'has_or_relation' => boolean false\n  public 'date_query' => boolean false\n  public 'queried_object' => *uninitialized*\n  public 'queried_object_id' => *uninitialized*\n  public 'request' => string 'SELECT SQL_CALC_FOUND_ROWS  wp_posts.ID FROM wp_posts  WHERE 1=1  AND wp_posts.ID IN (30874,30394,30527,30790,30761,30733,30700,30685,30603) AND wp_posts.post_type IN ('post', 'page', 'attachment', 'staff', 'event', 'publikacio', 'programs') AND ((wp_posts.post_status = 'publish' OR wp_posts.post_status = 'inherit'))  ORDER BY FIELD(wp_posts.ID,30874,30394,30527,30790,30761,30733,30700,30685,30603) LIMIT 0, 8' (length=419)\n  public 'posts' => \n    array (size=8)\n      0 => \n        object(WP_Post)[20912]\n          public 'ID' => int 30394          \n          ...\n      1 => \n        object(WP_Post)[20941]\n          public 'ID' => int 30527\n         ...\n      2 => \n        object(WP_Post)[20909]\n          public 'ID' => int 30874\n          ...\n      3 => \n        object(WP_Post)[20942]\n          public 'ID' => int 30790\n          ...\n      4 => \n        object(WP_Post)[20943]\n          public 'ID' => int 30761\n          ...\n      5 => \n        object(WP_Post)[20944]\n          public 'ID' => int 30733\n          ...\n      6 => \n        object(WP_Post)[20945]\n          public 'ID' => int 30700\n          ...\n      7 => \n        object(WP_Post)[20946]\n          public 'ID' => int 30685\n          ...\n  public 'post_count' => int 8\n  public 'current_post' => int -1\n  public 'in_the_loop' => boolean false\n  public 'post' => \n    object(WP_Post)[20912]\n      public 'ID' => int 30394\n      ...\n  public 'comments' => *uninitialized*\n  public 'comment_count' => int 0\n  public 'current_comment' => int -1\n  public 'comment' => *uninitialized*\n  public 'found_posts' => int 9\n  public 'max_num_pages' => float 2\n  public 'max_num_comment_pages' => int 0\n  public 'is_single' => boolean false\n  public 'is_preview' => boolean false\n  public 'is_page' => boolean false\n  public 'is_archive' => boolean false\n  public 'is_date' => boolean false\n  public 'is_year' => boolean false\n  public 'is_month' => boolean false\n  public 'is_day' => boolean false\n  public 'is_time' => boolean false\n  public 'is_author' => boolean false\n  public 'is_category' => boolean false\n  public 'is_tag' => boolean false\n  public 'is_tax' => boolean false\n  public 'is_search' => boolean false\n  public 'is_feed' => boolean false\n  public 'is_comment_feed' => boolean false\n  public 'is_trackback' => boolean false\n  public 'is_home' => boolean true\n  public 'is_privacy_policy' => boolean false\n  public 'is_404' => boolean false\n  public 'is_embed' => boolean false\n  public 'is_paged' => boolean false\n  public 'is_admin' => boolean false\n  public 'is_attachment' => boolean false\n  public 'is_singular' => boolean false\n  public 'is_robots' => boolean false\n  public 'is_favicon' => boolean false\n  public 'is_posts_page' => boolean false\n  public 'is_post_type_archive' => boolean false\n  private 'query_vars_hash' => ***\n  private 'query_vars_changed' => boolean true\n  public 'thumbnails_cached' => boolean false\n  private 'stopwords' => null\n  private 'compat_fields' => \n    array (size=2)\n      0 => string 'query_vars_hash' (length=15)\n      1 => string 'query_vars_changed' (length=18)\n  private 'compat_methods' => \n    array (size=2)\n      0 => string 'init_query_flags' (length=16)\n      1 => string 'parse_tax_query' (length=15)\n\nAs you see in the results (WP_Query->posts) the 30874 becomes the third. Even the SQL query gives back the right order if I try it in phpMyAdmin.\nI need to preserve the post__in order.\nI don't understand, please help.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404925", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP_REST_Response - How to return Gzip answer and add Content-encoding header? This code runs correctly :\nfunction get_travelbooks($request)\n{\n    global $tsp_mdlObj;\n\n    $result = $tsp_mdlObj->read_travelbooks();\n\n    return new WP_REST_Response($result, 200);\n\n}\n\nNow I would like send a gzip answer. So I try :\nfunction get_travelbooks($request)\n{\n    global $tsp_mdlObj;\n\n    $result = $tsp_mdlObj->read_travelbooks();\n\n    $result = gzencode(json_encode($result), 9);\n\n    $response = new WP_REST_Response($result, 200);\n\n    $response->header('Content-Encoding', 'gzip');\n\n    return $response;\n\n}\n\nBut this code doesn't work.\nThe content of $result before gzencode(json_encode is an array :\nArray\n(\n    [0] => stdClass Object\n        (\n            [id] => 5\n            [name] => travel 2021\n        )\n\n    [1] => stdClass Object\n        (\n            [id] => 4\n            [name] => travel 2020\n        )\n\n    [2] => stdClass Object\n        (\n            [id] => 3\n            [name] => travel 2019\n        )\n)\n\nhereafter is the register_rest_route used\nadd_action('rest_api_init', function () {\n  register_rest_route( 'travelsteps/v1', 'travelbooks',array(\n                'methods'  => 'GET',\n                'callback' => 'get_travelbooks',\n                'permission_callback' => '__return_true',\n      ));\n});\n\nI got the following error in console :\nxhr.js:177          GET xxxxxx/v1/travelbooks net::ERR_CONTENT_DECODING_FAILED 200 (OK)\nAnd the network header Content-Encoding: gzip  is present.\nAnd inside the network response tab i get the following message :\nno data found for resource with given identifier\nAny suggestion to fix this problem or a resource regarding gzip for a wp custom end point api rest. Thanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404928", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Want to create custom design of progress indicator in wpforms Is there any way to create custom design of progress indicator of multistep form in wpforms. By default wpforms has three templates to chose from. I have chosen progress bar which has design like this\n\nBut I dont want this design and other two designs as well. I want design like this\n\nSo my question is there any hook or any other way to change design\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404929", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to make Subdomain work for product_tag? I'm trying to find a way to make subdomains work for some of my product_tags. For example nike.myshop.com will display the content of myshop.com/product_tag/nike.\nI googled for a long time, but most of the solutions and plugins only work for wordpress post_tag, like wp subdomain, wp super domain. Can anyone provide a solution for woocommerce?\nEnvironment\n1 woocommerce\n2 *.mydoamin.com  DNS is set\n3 Access to .htaccess\n4 Access to functions.php\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404930", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I insert code into the pluggable.php file without it getting deleted after a wordpress update Regarding the code that is being inserted into the pluggable.php file: its a require statement that links to a php file that is used to overwrite the basic wp mail functionality.\nThanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404933", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Block Editor: Reset Reusable Blocks to last saved record I\u2019m trying to build my own Block Editor and I would like to reset all blocks to their last saved state by dismissing all unsaved changes when switching from Edit Mode to Preview Mode without reloading the page.\nCurrently it works fine with all \u201cnormal\u201d blocks:\nconst originalContent = select('core/editor').getCurrentPost().content;\nconst parsedOriginalContent = wp.blocks.parse(originalContent);\ndispatch('core/block-editor').resetBlocks(parsedOriginalContent);\n\nUnfortunately it doesn\u2019t work as expected with Reusable Blocks.\nFor example I can get all saved Reusable Blocks with\nconst savedReusableBlocks = select('core').getEntityRecords('postType','wp_block');\n\nthen parse its raw content as well, add them to an array with all other blocks currently on the page and throw it altogether into the resetBlocks() method. The behavior I\u2019m getting is that the saved Reusable Blocks are just added to the current page, in addition to the edited Reusable Blocks, so that there are now duplicates on the page. I\u2019m not quite sure why this is happening and I\u2019m wondering if anybody knows what\u2019s going on or if anybody has an idea of how it could be done.\nAny help is greatly appreciated \nThank you!\nP.S. It could be done if I could get the block content from all the InnerBlocks inside Reusable Blocks, but these InnerBlocks are always multiple layers deep nested, differently for all individual Reusable Blocks, which are again different for every website. So that seems like an impossible task for me.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404935", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How can I make this cleaner or smaller? This code works, but it's going to get huge!\nI have 150 \"a href\" to make and this is going to get rough, lol\nEach role has a custom url.\n\nHow can I make this cleaner or smaller?\n\n    if ( ! function_exists( 'add_extra_item_to_nav_menu' ) ){\n\n    global $user_ID;\n\n    function add_extra_item_to_nav_menu( $items, $args ) {\n       if (current_user_can('administrator') && is_user_logged_in() && $args->menu-5) {\n         $items .= '<li><a href=\"/product-category/public/SCHOOL_NAME-A/\" class=\"navShopNow fungula\">SHOP NOW ADMIN</a></li>';\n       }\n \n       // School ROLEABC\n       elseif (current_user_can('ROLEABC') && is_user_logged_in && $args->menu-5) {\n         $items .= '<li><a href=\"/product-category/public/SCHOOL_NAME-B/\" class=\"navShopNow fungula\">SHOP NOW ABC</a></li>';\n       }\n       // School ROLEXYZ\n       elseif (current_user_can('ROLEXYZ') && is_user_logged_in && $args->menu-5) {\n         $items .= '<li><a href=\"/product-category/public/SCHOOL_NAME-C/\" class=\"navShopNow fungula\">SHOP NOW XYZ</a></li>';\n       }\n \n       return $items;\n    }\n \n   add_filter( 'wp_nav_menu_items', 'add_extra_item_to_nav_menu', 150, 2 );\n }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404936", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Update media library image shown in \"attachment details\" when using wp_insert_attachment to add item to the media library I'm using the function wp_insert_attachment() to run on a form submission from GravityForms, take a file uploaded in the form, and add it to the WordPress Media Library.\nCode in functions.php below, also in Github:\nfunction form_to_media_library($entry){\n// from https://developer.wordpress.org/reference/functions/wp_insert_attachment/#div-comment-948\n\n// set filename\n$upload_path = GFFormsModel::get_upload_path( $entry[ 'form_id' ] );\n$upload_url = GFFormsModel::get_upload_url( $entry[ 'form_id' ] );\n$filename_verbose = str_replace( $upload_url, $upload_path, $entry[ '1' ] );\n$filename = trim($filename_verbose, ' \"[]\\ ');\n\n\n// check the type of file. We'll use this as the 'post_mime_type'\n$filetype = wp_check_filetype( basename( $filename ), null );\n\n// Get the path to the upload directory.\n$wp_upload_dir = wp_upload_dir();\n\n// Prepare an array of post data for the attachment.\n$attachment = array(\n    'guid'           => $wp_upload_dir['url'] . '/' . basename( $filename ),\n    'post_mime_type' => $filetype['type'],\n    'post_title'     => preg_replace( '/\\.[^.]+$/', '', basename( $filename ) ),\n    'post_content'   => '',\n    'post_status'    => 'inherit'\n);\n\n// Insert the attachment.\n$attach_id = wp_insert_attachment( $attachment, $filename );\n\n// Make sure that this file is included, as wp_generate_attachment_metadata() depends on it.\nrequire_once( ABSPATH . 'wp-admin/includes/image.php' );\n\n// Generate the metadata for the attachment, and update the database record.\n$attach_data = wp_generate_attachment_metadata( $attach_id, $filename );\nwp_update_attachment_metadata( $attach_id, $attach_data );\n\ndo_action( 'qm/debug', $attach_id );\n}\n\n// targets the specific form by form ID of 1\nadd_action( 'gform_after_submission_1', 'form_to_media_library', 10, 2 );\n\nThis is adding the image as expected to the Media Library screen:\n\nHowever, when I click into that image and view the \"Attachment Details\" screen for that one item, it shows a default image instead.\n\nThis doesn't happen on items I manually uploaded to the media library (through WordPress admin). There it shows the actual uploaded image in Attachment Details.\nHow can I get this function to apply the correct image in the Attachment Details view?\nNote that these images uploaded through the GravityForms form should not have parent posts - they should be unattached to posts.\nWordPress 5.9.3\nRelevant plugins:\n\n*\n\n*Gravity Forms\n\n*Media Library Assistant\n\n*Advanced Custom Fields\n\n\nA: Hello Mike can you check that folder is the image is there which you have uploaded and if yes then when you click on attachment details then on right there is a key which shows File URL: can you check that.if it is empty or wrong path to show.\nIf file is not there you can use wp_upload_bits to move the file as wp_insert_attachment not move the files automatically.\nIf still not works can you check your wp_posts and wp_postmeta table for that particular attachment for correct path.\nI have tried this code and it successfully works please check\n    // set filename\n    $upload_path = GFFormsModel::get_upload_path( $entry[ 'form_id' ] );\n    $upload_url = GFFormsModel::get_upload_url( $entry[ 'form_id' ] );\n    $filename_verbose = str_replace( $upload_url, $upload_path, $entry[ '1' ] );\n    $filename_backslashes = trim( $filename_verbose, ' \"[] ');\n    $filename = stripslashes( $filename_backslashes );\n\n    // check the type of file. We'll use this as the 'post_mime_type'\n    $filetype = wp_check_filetype( basename( $filename ), null );\n\n    // Get the path to the upload directory.\n    $wp_upload_dir = wp_upload_dir();\n\n    // Prepare an array of post data for the attachment.\n    $attachment = array(\n        'guid'           => $wp_upload_dir['url'] . '/' . basename( $filename ),\n        'post_mime_type' => $filetype['type'],\n        'post_title'     => preg_replace( '/\\.[^.]+$/', '', basename( $filename ) ),\n        'post_content'   => '',\n        'post_status'    => 'inherit'\n    );\n\n    // create a file in the upload folder\n    $upload = wp_upload_bits( basename ( $filename ), null,  file_get_contents( $filename ));\n\n    // Insert the attachment.\n    $attach_id = wp_insert_attachment( $attachment, $upload['file'] );\n\n    // Make sure that this file is included, as wp_generate_attachment_metadata() depends on it.\n    require_once( ABSPATH . 'wp-admin/includes/image.php' );\n\n    // Generate the metadata for the attachment, and update the database record.\n    $attach_data = wp_generate_attachment_metadata( $attach_id, $upload['file'] );\n    wp_update_attachment_metadata( $attach_id, $attach_data );\n\nIf still there is issue please post your post and post meta result with Admin file url.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404943", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Taxonomy archive uses incorrect template when query strings are used I have two taxonomies in use on my site, both of which have their own taxonomy archive templates with different interfaces. I use query strings to perform filtering on each of the archives. My problem is that if I use query strings on one taxonomy archive to filter by ANOTHER taxonomy, WordPress switches the taxonomy template.\nFor example, let's say I have a car taxonomy and a color taxonomy. If I want to see all sports cars I use this URL:\nhttp://example.com/car/sports-cars/\n\nNow, if I want to filter the results to only show all green sports cars, I use this:\nhttp://example.com/car/sports-cars/?color=green\n\nMy expectation is that both URLs would render using taxonomy-car.php since that's the main query, but when the query string is added suddenly WordPress starts using taxonomy-color.php instead. The two templates are not interchangeable, so this is a problem.\nAny ideas how to prevent this from happening?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404944", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Check if an option exists and get its value in one hit I have an option admins_settings that has an array of sub-options that is stored in the wp_options table. Before I get its value from the table, I check if this field exists by running this code:\nif ( !isset( get_option( 'admins_settings' )['option_name'] ) ) {\n    return false;\n} else {\n    return get_option( 'admins_settings' )['option_name'];\n}\n\nHere, I'm hitting the table 2 times (if the field exists) to get its value. Is there any way to get the value of the field with one hit?\nI know that the get_option function accepts a default value if the option doesn't exist. But this works with the simple values:\nget_option( 'admins_settings', false );\n\nBut not with array values:\nget_option( 'admins_settings' )['option_name'];\n\nBecause the option admins_settings could be there, but it doesn't have that item option_name.\nAgain, is there any way to get the sub-value of the field with one hit?\n\nA: \nI'm hitting the table 2 times (if the field exists) to get its value.\n\nNo, you aren't, and there is no evidence for this. You may not be hitting the database at all if it has autoload enabled. WordPress caches things in memory during the same request, and it bulk fetches options set to autoload for performance reasons.\nThe same is true of other things such as post meta. WordPress will attempt to store this data in WP Cache to avoid going back to the database again. E.g. when you fetch a post, it also fetches its post meta and its terms all at once to avoid lots of small database queries. This is also why object caches have such a huge boost to performance as it allows that cache to stay alive across multiple requests.\n\nBut this works with the simple values:\nBut not with array values:\n\nThey are all simple values, and they are always simple values. Options are strings, and have always been strings. If you try to save an array/object then WordPress will attempt to turn it into a string using PHP serialize, then deserialize it when you fetch it. This has security consequences.\nThere is no such thing as \"sub-options\", \"nested options\", or \"child options\". There is just options. admins_settings is your option, and WordPress sees the entire array as the value, not a series of values, but a singular value that must be serialized. You cannot provide defaults for sub-values this way because options cannot have sub-values. That your value contains structured data is coincidental.\nInstead, you have 2 options\n\n*\n\n*Store separate values as separate values, ideally with a prefix\n\n*Treat you array as an array and not a weird sub-option ( because there's no such thing as sub-options )\n\nSo you would check it the same way you would check an array has a value:\n$data = [];\nif ( isset( $data['test'] ) ) {\n    return $data;\n} else {\n    return false;\n}\n\nRemember, the options table uses plaintext for the value column, the idea that you can store objects and arrays is an illusion WordPress provides to make life easier, and one that would be near impossible to fix after nearly 2 decades.\n\nA: Upon entering the if() statement of your code, it will return to the calling function either way. So, you could simply use:\nreturn get_option('admins_settings')['option_name'];\nwhich will return boolean false if the option doesn't exist or it will return the option value if it does exist.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404948", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Array data not saving to specified sections. How to make seting independantly? I think I am writing the array part wrong. When saving on this array if you set all five settings, the setting from the 5th option is saved on all the settings. But if you then set the first four settings the setting on 4th is saved on all 5 settings.\nThis is the start of the function line:\nCan this be improved where I write $input?\nfunction thefunction($input) {\n\nThis is how I have the array part written:\n$thisisit = array(\n 'setting_one' => $input['setting_one'],\n 'setting_two' => $input['setting_two'],\n 'setting_three' => $input['setting_three'],\n 'setting_four' => $input['setting_four'],\n 'setting_five' => $input['setting_five']);\n\nWhat can I add to make the settings set independently?\nAnd saved with this for first add_option:\nreturn sanitize_text_field(add_option($option_name, $thisisit, $deprecated, $autoload));\n\nI have a option_update line also but it seems the add_option and option_update function fine. It must be the array definition part that is not good, right?\nHere is the option_update line:\nreturn sanitize_text_field(update_option($option_name, $thisisit));\n\nI think I am writing the array part wrong.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404955", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to use the Yoast SEO wpseo_canonical filter to set a canonical URL for /, /au/ & /uk/ sites in a MU environment Our company has markets in USA, UK & Australia.\nWe've just started using WP MU on our development server where the USA/global version is @ www.example.com, and then there are www.example.com/uk/ & www.example.com/au/.\nWe're probably going to create an AJAX function to redirect the visitor based on their geographical location to the appropriate website, with www.example.com being the catch-all.\nI've come across the Yoast SEO wpseo_canonical filter which might help us set a canonical URL for all of our posts and custom post types.\nHow would I use wpseo_canonical filter to set a canonical URL for the posts in www.example.com/uk/?\nE.g. the blog post www.example.com/uk/blog/post-1/ should have a canonical URL of www.example.com/blog/post-1/ I believe.\nHelp appreciated.\n\nA: \nHow would I use wpseo_canonical filter to set a canonical URL for\nthe posts in www.example.com/uk/?\nE.g. the blog post www.example.com/uk/blog/post-1/ should have a\ncanonical URL of www.example.com/blog/post-1/ I believe.\n\nI don't know if that should be the canonical URL, but if you are asking how can that be done, then this would do it, for the core post post type:\nfunction prefix_filter_canonical_example( $canonical ) {\n    if ( ! is_main_site() && is_single() ) {\n        // Get the ID of the main blog/site.\n        $main_site_id = get_main_site_id();\n\n        // Get the slug of the current post.\n        $post_slug = get_queried_object()->post_name;\n\n        // Switch to the main site and find a post with the same slug.\n        switch_to_blog( $main_site_id );\n        $posts = get_posts( array(\n            'post_type' => 'post',\n            'name'      => $post_slug,\n        ) );\n        // If found, then use its permalink as the canonical URL.\n        $permalink = empty( $posts ) ? '' : get_permalink( $posts[0] );\n        restore_current_blog();\n\n        return $permalink ? $permalink : $canonical;\n    }\n\n    return $canonical;\n}\nadd_filter( 'wpseo_canonical', 'prefix_filter_canonical_example' );\n\nOr if all the sites use the same permalink structure, e.g. %postname%, and that the same post also exists in the main site (i.e. same slug and post type), then you could simply use the current post's permalink and just replace the WordPress \"home\" URL in that permalink.. E.g.\nfunction prefix_filter_canonical_example( $canonical ) {\n    if ( ! is_main_site() && is_single() ) {\n        // Get the ID of the main blog/site.\n        $main_site_id = get_main_site_id();\n\n        // Get the data of the main and current sites.\n        $main_blog    = get_blog_details( $main_site_id );\n        $current_blog = get_blog_details();\n\n        // Replace the home URL in the current post's permalink.\n        return str_replace( \"$current_blog->home/\", \"$main_blog->home/\", get_permalink() );\n    }\n\n    return $canonical;\n}\nadd_filter( 'wpseo_canonical', 'prefix_filter_canonical_example' );\n\nSo I hope that helps, but remember that switch_to_blog() does not switch plugins, and thus get_permalink() might not return the \"correct\" permalink that would otherwise be returned if plugins were also switched.\nAlso, a hook can run in various places on the same page, so you might want to cache the result of the $permalink value in the 1st snippet above..\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404959", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to display customer mobile number in woocommerce customers page I'm unable to display the customer phone number in https://www.example.com/wp-admin/admin.php?page=wc-admin&path=%2Fcustomers.\nis there any function to do this.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404962", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Loop inside Loop? I'm using ACF, and displaying the Brands CPT. Inside of brands, I will want to setup a separate loop for posts containing certain tags.\nMy loop works, meaning that I'm able to access the brands and their ACF fields, but when I try to implement the posts loop inside of the brands loop, no brand_partners( ACF subfield ) are found.\nI saw other people struggling with this, so I searched and found this:\nLoop within a loop?\nI tried updating my code, but it results in a timeout:\n    <?php\n$args = array(\n\n    'posts_per_page' => -1,\n    'post_type'      => 'brands',\n);\n\n$brands_query = new WP_Query( $args );\n\nif ( $brands_query->have_posts() ) {\n    $loop_counter = 1;\n    while ( $brands_query->have_posts() ) {\n\n        $brands_query->the_post();\n        $posttags = get_the_tags();\n        ?>\n\n<div class=\"container col-6 col-md-3 partner\">\n    <div class=\"popup popup--maxwidth\" onclick=\"popItUp()\">\n        <img src=\"<?php echo get_the_post_thumbnail_url(); ?>\"></img>\n        <span class=\"p-2 popuptext\">\n            <span class=\"popup--close\" onclick=\"popItUp()\"><i class=\"fa fa-close\" style=\"font-size:36px; color:white;\"></i></span>\n            <div class=\"partner-container\">\n                <div class=\"partner-flex-1\">\n                    <img class=\"mx-auto pb-4 pr-2\" src=\"<?php echo get_the_post_thumbnail_url(); ?>\"></img>\n                </div>\n                <div class=\"partner-flex-2\">\n                    <h4 class=\"tagline--subheadline pt-2\"><?php the_title(); ?></h4>\n                    <img class=\" mx-auto\" src=\"<?php echo get_theme_file_uri( '/images/dots.png' ); ?>;\" width=\"45\">\n                    <h5><?php the_excerpt(); ?></h5>\n                </div>\n            </div>\n            <h3 class=\"tagline--subheadline pt-2\">Related posts</h3>\n            <img class=\"mx-auto pb-3\" src=\"<?php echo get_theme_file_uri( '/images/dots.png' ); ?>;\" width=\"45\">\n\n            <div class=\"container mr-1\">\n                <div class=\"d-flex\">\n\n                    <!-- INNER POSTS QUERY -->\n                    <?php\n                    $inner_args = array(\n                        'posts_per_page' => 3,\n                    );\n\n                    $inner_query = new WP_Query( $inner_args );\n\n                    if ( $inner_query->have_posts() ) {\n                        $loop_counter = 1;\n                        global $post;\n                        $backup = $post;\n                        while ( $inner_query->have_posts() ) {\n                            $inner_query->the_post();\n                            $posttags = get_the_tags();\n                            ?>\n\n<div class=\"col-12 col-md-6 col-lg-4 pr-0 pl-0 mr-2 ml-2 mt-4 mb-4 posts posts--container flex-row post-<?php echo $loop_counter; ?>\"\n    style=\"background-image: url('<?php echo get_theme_file_uri( '/images/blogbg.jpg' ); ?>\">\n    <a href=\"<?php echo get_the_permalink(); ?>\">\n        <div class=\"posts popup--img\" style=\"background-image:url('<?php echo get_the_post_thumbnail_url(); ?>')\" alt=\"\"></div>\n\n        <h5 class=\"posts posts--tagname\"><?php echo $tag->name . ' '; ?></h5>\n        <h3 class=\"posts posts--title\"><?php echo the_title(); ?></h3>\n        <h5 class=\"posts posts--tagname\"><?php echo get_the_date(); ?></h5>\n        <h6 class=\"posts posts--desc p-4\"><?php echo get_the_content(); ?></h6>\n</div>\n</a>\n\n\n<?php\n                        }\n                        $post = $backup;\n                    }\n\n                    ?>\n                    <!-- INNER POSTS QUERY END -->\n\n                </div>\n            </div>\n\n\n            <h3 class=\"tagline--subheadline pt-2\">Partners</h3>\n            <img class=\"mx-auto pb-3\" src=\"<?php echo get_theme_file_uri( '/images/dots.png' ); ?>;\" width=\"45\">\n            <div class=\"container col-10 partner d-block d-md-flex justify-content-center flex-lg-wrap\">\n                <?php\n\n\n\n                if ( have_rows( 'brand_partners' ) ) :\n                    while ( have_rows( 'brand_partners' ) ) :\n                        the_row();\n                        $partner_image = get_sub_field( 'brand_partner_image' );\n                        // Do something...\n                        ?>\n                <div class=\"popup--partnerimage  col-md-4\" style=\"background-image: url(\n                        <?php\n                        echo $partner_image;\n                        ?>\n );\"></div>\n                        <?php\n                    endwhile;\n                                else :\n                                    echo 'No partners found';\n                                endif;\n                                ?>\n\n\n            </div>\n    </div>\n    </span>\n</div>\n\n        <?php\n    }\n}?>\n\nAny clues as to what I am doing wrong?\nThanks!\n\nA: Try defining the post_type in your $inner_args array\n$inner_args = array(\n    'post_type' => 'post',\n    'posts_per_page' => 3\n    );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404963", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Editor role can only create/edit/delete users who have one of two roles I need help with something, what happens is that I have created a custom role derived from the Editor role that Wordpress has by default and I have added some extra capabilities.\nNow, my goal is that this role can only create, edit or delete users that have as role one of the ones I want (e.g. Driver or Team).\nHow can I achieve this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404969", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Override une fonction dans une class Woocommerce Bonjour,\nVoil\u00e0 WooCommerce r\u00e9cup\u00e8re le num\u00e9ro de t\u00e9l\u00e9phone de mes clients pour l'adresse de facturation mais pas pour l'adresse de livraison...\nVu que j'utilise un ERP qui se base sur l'adresse de livraison pour les \u00e9tiquettes transporteur, j'ai besoin de cette information, j'ai donc un peu modifier la fonction qui r\u00e9cup\u00e8re cette info dans: woocommerce/includes/class-wc-order.php\nde cette fa\u00e7on :\npublic function get_shipping_phone( $context = 'view' ) {\n        return $this->get_address_prop( 'phone', 'billing', $context );\n    }\n\nComme ceci tout marche, malheureusement la modif saute \u00e0 chaque maj car je n'ai pas override la fonction en question car elle fait partie de la class WC_order et que d\u00e8s que je touche \u00e0 celle-ci tout plante...\nUne id\u00e9e pour fixer cette modif ?\n", "meta": {"language": "fr", "url": "https://wordpress.stackexchange.com/questions/404970", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Does an administrator access allow someone to access to the WordPress database? I gave an administrator access to a developper and he made a copy of my entire Wordpress website (meaning : files from my FTP and the whole database).\nHow did he succeed to do that ?\nDoes creating an administrator role grant access to the whole FTP and the mysql database ?\n\nA: No, wp-admin Administrator access does not grant direct access to files or the database. However, as an Administrator, you can install / activate / use / deactivate / uninstall plugins, and there are a number of plugins which can take backups of the files and the database. So, anything WordPress has access to, they would have access to.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404971", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: PHP using external anonymous function inside class I have two files. In file1.php I have an anonymous function:\n    $myfunc = function($params) {\n         // do something\n}\n\nin file2.php I have a class and inside this class I need to use the function defined in file1.php.\nI am using global to declare the variable assigned function from file1.php and then calling it like this:\nclass {\n// properties\n  mymethod(){\n    global $myfunc\n    $myfunc()\n }\n} \n\nThis gives me an error:\n\nFatal error: Uncaught Error: Function name must be a string\n\nI tried to look elsewhere but there aren't any blogs explaining how to do this or others who've had the same problem.\nHelp would be highly appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404975", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Compare User meta_value with Product meta_value In Wordpress I've added a new field called \"user_branche\" on the user edit profile page within the admin. On the Woocommerce product page in the admin I added a meta field called \"product_branche\".\nNow I need a database query to compare these. I only want to show the products with the same value for \"user_branche\" as \"product_branche\".\nI've spent some hours researching but I can't figure it out.\nI tried using this:\nSELECT t1.* from wp_postmeta t1 left outer join wp_usermeta t2 on t1.meta_value=t2.meta_value;\n\nBut that gives me a timeout and results in a phpmyadmin that is not working for several minutes.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404976", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom PHP script throws critical error ONLY when editing page I have the following script added to functions.php in my child theme:\nfunction getlatestfile() { \n    $iterator = new RecursiveIteratorIterator(new RecursiveDirectoryIterator('wp-content/uploads/cams/'));\n    foreach ($iterator as $file) {\n        if ($file->isDir()) continue;\n        $path = $file->getPathname();\n    }\n    return \"<img src='https://mysite.url/\" . $path . \"' />\";\n}\n// register shortcode\nadd_shortcode('getfieldimage', 'getlatestfile');\n\nI can save the code, insert the shortcode [getfieldimage] on the page, and the page indeed displays the latest image. No complains.\nBut when trying to edit again the page containing the shortcode, WP tells me that there's a critical error, and wants me to go to https://wordpress.org/support/article/faq-troubleshooting/ . Cannot get any helpful info there.\n\nA: When you're editing the page, you're in the directory wp-admin, and wp-admin doesn't contain wp-content (they're both children of your site's root directory).\nInstead of 'wp-content/uploads/cams/', I'd recommend ABSPATH . 'wp-content/uploads/cams/' which should work wherever you might be in the WordPress environment.\n\nA: ABSPATH helps to display the page in the backend in editmode. But for the frontend, the path for the <img../> tag needs to be modified. cutprefix() function (taken from here) does the job.\nThis is the working solution for the front- and backend:\nfunction getlatestfile() {\n\n  $iterator = new RecursiveIteratorIterator(new RecursiveDirectoryIterator( ABSPATH . 'wp-content/uploads/cams' ));\n  foreach ($iterator as $file) {\n    if ($file->isDir()) continue;\n    $path = $file->getPathname();\n  }\n  $path = cutprefix($path, '/home/username/web/mysite.url/public_html/');\n  return(\"<img src='https://mysite.url/\" . $path . \"' />\");\n}\n\n\nfunction cutprefix($str, $prefix){\n  if (substr($str, 0, strlen($prefix)) == $prefix) {\n    $str = substr($str, strlen($prefix));\n  } \n  return $str;\n}\n\nThanks to Pat J for leading me in the right direction.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404977", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I cant find the custom html block I cant find the custom html block in wordpress. Does it not automatically come with a custom html block or do I have to create my own? I look for it in the search but it doesnt come up. I will click to add a block and then ill type 'html' or 'custom' and the block doesnt come up. Is there a way I can add this block? I need it for iframes. The plugins i have installed do not work. Has anyone else come across this issue? Is it possibly disabled?\n\nA: Welcome on StackOverFlow.\nThis block is the legacy custom HTML and as far I know, it's hidden  but you\nadd_filter( 'widget_types_to_hide_from_legacy_widget_block','sof_hide_legacy' );\nfunction sof_hide_legacy( $widget_id ){\n    $widget_to_show = array( 'custom_html' );\n    $widget_id = array_diff( $widget_id, $widget_to_show );\n\n    return $widget_id;\n}\n\nDoes this help you ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404981", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: 404 on category URL I think this is basic but none of the advice I have found seems to work for me.  My URLs that access a category directly have been working for 3 or more years but no longer work since an upgrade and some problem with my server.  [I have tried removing my custom theme and deactivating all plugins, but no improvement].\nWP home page: www.mysite.com/monitor/   This works fine and shows all posts as expected.\nSelect a category:  If I select a category from the dropdown on the WP home page above then the URL changes to www.mysite.com/monitor/?cat=102 and posts are filtered correctly and displayed correctly.  So that works too.\nHowever, when I go to www.mysite.com/monitor/category/algeria I get a 404 error.\nI have a slug shown in every category in the editor.  e.g. algeria  (my categories are countries)\nI have been to the settings permalinks page and tried various things including adding 'category' as my 'Category base'. [In fact, I have tried just about every combination on this page without success].\nI noticed that when I was editing the permalinks page just after the error started, an .htaccess file was being created in the /monitor/ folder of my file structure, but this is not happening any more.\nAnyone know why this isn't working; whether the URLs including categories are redirected with an .htaccess file or whether this stuff is coded within the WP php files (and if so where).\nThanks in advance for help.\nUPDATE: 21-Apr-22\nI have now, through further research, established that:\n\n*\n\n*htaccess is only there to divert certain pages back to index.php or when a custom permalink structure is created (so that has answered that)\n\n*the instructions for permalinks are stored as rewrite_rules in the wp_options table.\n\n*accessing a page directly can be done using the URL mysite.com/monitor/?category_name=algeria (this works with the expected behaviour)\n\nI notice two things:\n\n*\n\n*The rewrite_rules entry of the database is empty.  It is being updated when i visit the permalinks settings and save but is always blank after save! (i.e. if i manually write something in the field and then save permalinks then the record is emptied, so writing is occurring).\n\n*The category_base entry in the table does change when i visit the permalinks setting and add to that field.\n\nOther blogs speak of the basic rewrite_rules in $wp_rewrite array to include an element like this:\n[category/(.+?)/?$] = > index.php?category_name=$matches[1]\nIf I dump $wp_rewrite I get no rules:\n[matches] => matches\n    [rules] => \n    [extra_rules] => Array\n        (\n        )\n    [extra_rules_top] => Array\n        (\n            [^wp-json/?$] => index.php?rest_route=/\n            [^wp-json/(.*)?] => index.php?rest_route=/$matches[1]\n            [^index.php/wp-json/?$] => index.php?rest_route=/\n            [^index.php/wp-json/(.*)?] => index.php?rest_route=/$matches[1]\n            [^wp-sitemap\\.xml$] => index.php?sitemap=index\n            [^wp-sitemap\\.xsl$] => index.php?sitemap-stylesheet=sitemap\n            [^wp-sitemap-index\\.xsl$] => index.php?sitemap-stylesheet=index\n            [^wp-sitemap-([a-z]+?)-([a-z\\d_-]+?)-(\\d+?)\\.xml$] => index.php?sitemap=$matches[1]&sitemap-subtype=$matches[2]&paged=$matches[3]\n            [^wp-sitemap-([a-z]+?)-(\\d+?)\\.xml$] => index.php?sitemap=$matches[1]&paged=$matches[2]\n        )\n\nif I manually add\na:2:{s:17:\"category/(.+?)/?$\";s:35:\"index.php?category_name=$matches[1]\";}\nto the rewrite_rules field in the database it still doesn't work.\nSo still 404 on any attempt to use the category url.  Any help please?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404982", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get Posts List of Current Selected Custom Taxonomy in Shortcode I have a custom taxonomy called Album Link (album_link). I created this so I could link all music that has the term e.g (Glorious Album) to an album post type that uses the same term.\nThe goal here is to insert a shortcode [album] into the album post type which will look into the current selected Term of Taxonomy (Album Link) and retrieve all the music post type that uses that same term.\nLet me break it down further:\n\n*\n\n*I have a custom tax (Album Link) term called (Glorious Album) and Post Types (Music) and (Album).\n\n*I select the (Album Link) term Glorious Album while posting songs through the music post type.\n\n*I now create an Album post type, choosing the Album Link term Glorious Album and inserting [album] shortcode to retrieve all the songs (music post type) posted using the same term.\n\n*The [album] will now auto-detect the current selected Album link term (Glorious Album) and display all posts from the music post type that uses the same term.\n\nMY CODE ONLY WORKS IF I ENTER THE TERM ID OF THE ALBUM LINK TAX E.G [album id=\"123\"]\n// ALBUM TRACKLIST SHORTCODE\nfunction album_shortcode( $atts , $content = null ) {\nextract(shortcode_atts(array(\n\"title\" => '',\n\"id\" => '', \n\"url\" => '#',\n\"text\" => '',\n), $atts));\nob_start(); ?>\n  <?php  \n$albumitems = get_posts(array(\n'post_type' => 'music',\n'orderby'=>'date','order'=>'ASC',\n'posts_per_page'=>-1,   \n'tax_query' => array(\n            array(\n                'taxonomy' => 'album',\n                'field' => 'term_id',\n                'terms' => $id,\n            )\n        )   \n)); ?>\n<?php\n$postNumber = 1;\n?>\n<?php if( $albumitems ): ?>\n<div class=\"mu-o\">\n  <div class=\"mu-o-c\">\n    <div class=\"mu-o-unit mu-o-head\">\n      <div class=\"mu-o-ind\">No.\n      </div> \n      <div class=\"mu-o-info\">Title\n      </div>\n      <div class=\"mu-o-act\">Download\n      </div>\n    </div>\n    <?php foreach( $albumitems as $albumitem ) { ?>\n    <div class=\"mu-o-unit-c\">\n      <div class=\"mu-o-unit\">\n        <div class=\"mu-o-ind ind\">\n          <b class=\"rindx\"><?php echo $postNumber++; ?>\n          </b>\n        </div>\n        <div class=\"mu-o-info\">\n          <h4 class=\"mu-o-title\">\n            <a href=\"<?php echo get_permalink( $albumitem->ID ); ?>\">\n              <?php the_field( 'track_title', $albumitem->ID ); ?> \n            </a> \n          </h4>\n          <div class=\"mu-o-prod\"><?php\n$artists = get_field('artiste_name', $albumitem->ID );\n                echo 'By ';\n                $artist_terms = '';                         \n                foreach($artists as $index => $artist) {\n                    $enIndex = sizeof($artists) - 2;\n        $end = (isset($artists[$enIndex]) && $index == $enIndex ? ' x ' : ' x ');\n        $artist_link = get_term_link( $artist );\n        $artist_terms .= '<a href=\"' . esc_url( $artist_link ) . '\">' . $artist->name . '</a>' . $end;    \n                }\n                echo rtrim($artist_terms, ' x ' );       \n                \n                  ?>\n              \n              \n            <?php $featuring = get_field( 'featuring', $albumitem->ID ); \n            if ( $featuring ): \n                    echo 'feat. ';\n                    $feature_terms = '';                                    \n                foreach($featuring as $index => $feature) {\n                    $enIndex = sizeof($featuring) - 2;\n        $end = (isset($featuring[$enIndex]) && $index == $enIndex ? ' and ' : ', ');\n        $feature_link = get_term_link( $feature );\n        $feature_terms .= '<a href=\"' . esc_url( $feature_link ) . '\">' . $feature->name . '</a>' . $end;     \n                }\n        echo rtrim($feature_terms, ' , ' );        \n\n?> <?php endif; ?>\n          </div>\n        </div>\n    </div>\n    </div>\n    <?php } ?>\n  </div>\n</div>\n<?php endif; ?>\n\n<?php\nreturn ob_get_clean();\n}\nadd_shortcode( 'album', 'album_shortcode' );\n\nMY PROBLEM:\nI want it to auto-detect the current selected Album Link terms without the need for manual id=\"\" insertion. But if I use an id=\"\" it will override the auto-detect.\nAlso, If 2 or more terms are selected it will display their posts respectively.\nThanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404987", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show Last Revision Of Post That Has A Published Status On Single Page I used this code to make a custom post status which is public so that the post is still available for people to view.\n// Define new awaiting status\nfunction my_custom_post_status(){\n   register_post_status( 'awaiting', array(\n      'label'                     => _x( 'Changes Awaiting Approval', 'custom-post-type' ),\n      'public'                    => true,\n      'exclude_from_search'       => false,\n      'show_in_admin_all_list'    => true,\n      'show_in_admin_status_list' => true,\n      'label_count'               => _n_noop( 'Changes Awaiting Approval <span class=\"count\">(%s)</span>', 'Changes Awaiting Approval <span class=\"count\">(%s)</span>' ),\n   ) );\n}\nadd_action( 'init', 'my_custom_post_status' );\n\nThen I added this code so that when a certain role saves a post, the post status is changed from published to awaiting\nfunction published_to_pending($post_id) {\n    global $post, $current_user, $wp_meta_boxes;\n\n    if (!is_object($post))\n        $post = get_post($post_id);\n    //if ( !current_user_can( 'edit_post', $post_id ) )\n    //    return $post_id;\n    // check for specific user that needs this publish to pending. otherwise exit\n    if (get_current_user_role() != \"speaker\") {\n        return;\n    }\n    if ($post->post_status == \"publish\") {\n        global $wpdb;\n        $result = $wpdb->update(\n                $wpdb->posts,\n                array('post_status' => \"awaiting\"),\n                array('ID' => $post_id)\n        );\n      \n    }\n}\n\nadd_action('post_updated', 'published_to_pending', 13, 2);\n\nfunction get_current_user_role() {\n    global $wp_roles;\n    $current_user = wp_get_current_user();\n    $roles = $current_user->roles;\n    $role = array_shift($roles);\n\n    return $role;\n}\n\nThe idea is then that an admin would then see the post with the revisions added to it and then put it back to the published state to then approve the changes and make them visible to all visitors of the website.\nHowever, as the last step, I now want to allow the user who updated the post to see how their post will now look with their proposed revisions before it is approved by the admin. So essentially I was imagining it would work that if the post has an awaiting status:\n\n*\n\n*For any public visitors, they would see the last version of the post that had the published status.\n\n*For admins and the author of the post, they would see the latest version of the post with the revised changes (so essentially the standard behaviour)\n\nHow would I go about achieving this? Would this be something I would need to add to the single.php page of the theme or would I need to make a custom query elsewhere?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404989", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add custom taxonomy to post content body? I've built a CPT that has three different custom taxonomies, I've also built a custom search form that has fields for each taxonomy, and a field for \"search by keyword\".\nI want the taxonomy terms associated with each instance of the CPT to be included in the \"search by keyword\" field. By default, WordPress does not include custom taxonomy in its search however I need to find a way to make this happen. I would prefer to not use a plugin to accomplish this.\nWhat I am thinking of is injecting all the custom taxonomy terms associated with each CPT into the default content area, the default content area is not being used anyway, each CPT is put together with ACF, so it's currently blank and I am free to use it in this way.\nMY QUESTION: Is there a filter or way I can inject all of the custom taxonomy terms into the content field when a CPT is published or updated?\nBelow is the code that I am using to create the query for context. This works fine, I just need the default search behavior to look in the custom taxonomies...\nAs an example is a user types \"hospital\" in the industry_select field it will include all the CPT's that have the word \"hospital\" in their industry taxonomy terms.\nHowever, if they were to type \"hospital\" in the keyword field nothing will show up because nothing in the content or title has the word hospital in it...\nfunction custom_search( $query ) {\n    if ( is_post_type_archive( 'experts' ) && $query->is_main_query() && !is_admin() ) {\n\n        $keyword = get_query_var( 'keyword', FALSE );\n        $industry_select = strtolower(str_replace(' ', '-', get_query_var( 'industry_select', FALSE ) ));\n        $speciality_select = strtolower(str_replace(' ', '-', get_query_var( 'speciality', FALSE ) ));\n        $location_select = strtolower(str_replace(' ', '-', get_query_var( 'location_select', FALSE ) ));\n\n\n        // create list of terms similar to what the user typed in\n\n        $broad_match_ind = get_terms( array(\n            'taxonomy' => 'experts_industries',\n            'fields' => 'slugs', \n            'name__like' => $industry_select,\n            'hide_empty' => false \n        ) );\n\n        $broad_match_spec = get_terms( array(\n            'taxonomy' => 'experts_specialities',\n            'fields' => 'slugs', \n            'name__like' => $speciality_select,\n            'hide_empty' => false \n        ) );\n\n        $broad_match_loc = get_terms( array(\n            'taxonomy' => 'experts_locations',\n            'fields' => 'slugs', \n            'name__like' => $location_select,\n            'hide_empty' => false \n        ) );        \n\n        // Keywords query\n        $keyword ? $keyword : $keyword = null;\n\n        $query->set('s', $keyword);\n        \n        // Build taxonomy array based on what's been filled out \n\n        $tax_query_array = array('relation' => 'OR');\n        $location_select ? array_push($tax_query_array, array('taxonomy' => 'experts_locations', 'field' => 'slug', 'terms' => $broad_match_loc) ) : null ;\n        $speciality_select ? array_push($tax_query_array, array('taxonomy' => 'experts_specialities', 'field' => 'slug', 'terms' => $broad_match_spec) ) : null ;\n        $industry_select ? array_push($tax_query_array, array('taxonomy' => 'experts_industries', 'field' => 'slug', 'terms' => $broad_match_ind) ) : null ;\n\n        $query->set( 'tax_query', $tax_query_array);\n\n    }\n}\nadd_action( 'pre_get_posts', 'custom_search' );\n\n\nA: Even though extending your custom search would be the proper WP way to solve your problem, the answer to your workaround question would be the below function:\nfunction change_content_on_save($post_id, $post, $update) {\n  if ($_SERVER['REQUEST_METHOD'] !== 'POST' || empty($_POST))\n    return;\n  if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE)\n    return;\n  if (!current_user_can('edit_post', $post_id))\n    return;\n  \n  // create your terms list and insert to content here:\n  $post->post_content = $terms_list;\n  \n  // Delete hook to avoid endless loop\n  remove_action('save_post', 'change_content_on_save', 10);\n  wp_update_post($post);\n}\nadd_action( 'save_post', 'change_content_on_save', 10, 3 );\n\nsave_post is an action triggered whenever a post or page is created or updated\nhttps://developer.wordpress.org/reference/hooks/save_post/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404991", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Where to call add_shortcode function in WordPress Plugin Boilerplate? I am creating a new plugin and have decided to use WordPress Plugin Boilerplate.\nHowever, I'm not sure where the correct place is to call WP's add_shortcode. I'm  stuck on two counts:\n\n*\n\n*add_shortcode doesn't usually have a hook - so I doubt I would call it via my define_admin_hooks or  define_public_hooks functions.\n\n*I'm not sure how I would specify the callback function for add_shortcode now that everything is object orientated.\n\nSo where is the best place for me to call add_shortcode? A short example/snippet would be much appreciated.\n\nA: Add the below function in /includes/class-plugin-loader.php :\npublic function add_shortcode( $tag, $component, $callback, $priority = 10, $accepted_args = 2 ) {\n        $this->shortcodes = $this->add( $this->shortcodes, $tag, $component, $callback, $priority, $accepted_args );\n}\n\nYou can then define your shortcode in /includes/class-plugin.php within this function:\n/**\n * Register all of the hooks related to the public-facing functionality\n * of the plugin.\n *\n * @since    1.0.0\n * @access   private\n */\nprivate function define_public_hooks() {\n\n    $plugin_public = new Plugin_Public( $this->get_plugin_name(), $this->get_version() );\n\n    $this->loader->add_action( 'wp_enqueue_scripts', $plugin_public, 'enqueue_styles' );\n    $this->loader->add_action( 'wp_enqueue_scripts', $plugin_public, 'enqueue_scripts' );\n\n    $this->loader->add_shortcode( 'YOUR-SHORTCODE-NAME', $plugin_public, 'YOUR_CALLBACK_FUNCTION' );\n\n}\n\nFinally add your callback function in the /public/class-plugin-public.php like this:\npublic function YOUR_CALLBACK_FUNCTION( $atts ){ \n    // do your shortcode stuff\n}\n\nChange plugin in the filenames above with your own plugin name.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404992", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Working Around rest_forbidden_context I am trying to request page content, but the raw page content, calling this route:\n\"/wp-json/wp/v2/pages/\" + id + \"?context=edit\"\n\nIn response to this I get:\ncode: \"rest_forbidden_context\"\ndata: {status: 401}\nmessage: \"Sorry, you are not allowed to edit this post.\"\n\nMakes sense, guessing I just can't get the edit content unathenticated.\nHowever, it is unclear to me how I can retrieve the raw content of a post/page from the API.\nPotential Solutions I am struggling to find:\n\n*\n\n*Is there a way to auth through the api?\n\n*Can I define my own endpoint to get around this?\n\n*Can I turn off any authentication requirements (my wordpress sits headless behind a server anyways so I'm not worried about security)\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404997", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to custom post type in wordpress different style Types category I want to customize the posts for each category to be different. but I can't do it, can you please take a look at me, where is my mistake?\nFor example, I have 2 categories.\n1 window 2 android\nI want my posts in the windows category to be called file in content-windows-details.php.\nandroid content-app-details.php\nBut now post the category Windows will call the app-details.php file. i need to windown call windows-details.php\nCode single.php\n<?php\n\n/**\n\n * The template for displaying all single posts\n\n *\n\n * @link https://developer.wordpress.org/themes/basics/template-hierarchy/#single-post\n\n *\n\n * @package bizcare\n\n */\n\n\n\nget_header();\n\n$p_id = get_the_ID();       \n$terms = get_the_terms( $p_id, 'category' ); \n$is_tip = false;\n$cat_id = 0;\nforeach($terms as $term) { \n    if( !is_app_cat($term->term_id)){\n        $is_tip = true;\n        $cat_id = $term->term_id;\n        break;\n    }\n    else{\n        if($term->parent != 0){\n            $cat_id = $term->term_id;\n        }\n    }\n} \nif($is_tip){\n    $is_topten = false;\n    foreach($terms as $term) { \n        if($term->slug == 'windows'){\n            $is_topten = true;\n            break;\n        }\n    }\n    if($is_topten){\n        get_template_part( 'template-parts/content', 'windows-details' ); \n    }\n    else{\n        get_template_part( 'template-parts/content', 'single' );\n    }\n}\nelse{\n    get_template_part( 'template-parts/content', 'app-details' );\n}\n\n\n\n?>\n\n\n<?php\n\nget_footer();\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/404998", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I rewrite /blog/ slug in URL to '/' in a WordPress custom type post I have developed custom type post in wordpress and it's working well. But when you try to post an article its displays /blog/ slug URL example https://example.net/blog/best-construction-company. And when I try to remove taxonomy in my code its removes slug but its display page is not found. Also when I try to false rewrite the rule it still displays/blog/ slug. Now, how do I remove /blog/ slug on my custom blog type? i.e https://example.net/best-construction-company\n<?php\nfunction equipments_blog_post_type() {\n    $labels = array(\n        'name'               => _x( 'Blog Post', 'blog posts and articles' ),\n        'singular_name'      => _x( 'Blog', 'blog posts and articles' ),\n        'add_new'            => _x( 'Add New', 'Blog Post' ),\n        'add_new_item'       => __( 'Add New Blog Post' ),\n        'edit_item'          => __( 'Edit Blog Post' ),\n        'new_item'           => __( 'New Blog Post' ),\n        'all_items'          => __( 'All Blog Posts' ),\n        'view_item'          => __( 'View Blog Post' ),\n        'search_items'       => __( 'Search Blog Posts' ),\n        'not_found'          => __( 'No blog posts found' ),\n        'not_found_in_trash' => __( 'No blog posts found in the Trash' ), \n        'menu_name'          => 'Blog Post'\n    );\n    $args = array(\n        'labels'        => $labels,\n        'description'   => 'Blog posts and articles',\n        'public'        => true,\n        'menu_position' => 5,\n        'rewrite' => array('slug' => 'blog'),\n        'capability_type' => 'post',\n        'show_in_rest' => true,\n        'exclude_from_search'   => false,\n        'publicly_queryable'    => true,\n        'has_archive'         => true,\n        'query_var' => true,\n        'taxonomies' => array('category', 'post_tag'),\n        'supports' => array( 'title', 'editor', 'excerpt', 'author', 'thumbnail', 'comments', 'revisions', 'custom-fields', 'taxonomies')\n    );\n\n    register_post_type( 'blog', $args ); \n}\n  \nadd_action( 'init', 'equipments_blog_post_type' );\n\nfunction equipments_create_custom_taxonomies(){\n    register_taxonomy('blog', 'posttypename', array( 'hierarchical' => true, 'label' => 'Blog'));\n    \n    /* IMPORTANT: This is bad! Don't do this! Read the important update at the top of the page, and update 2 below for details */\n    flush_rewrite_rules( false );/* Please read \"Update 2\" before adding this line */\n}\n\nadd_action('init', 'equipments_create_custom_taxonomies' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405000", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add custom regex validation to WPForms password field I'm using WPForms Pro and I'd like to add custom requirements to the password field on a form.\nI know that the password field has a password strength requirement setting, but I have specific rules I'd like to enforce, which are:\n\n*\n\n*Between 12 and 32 characters\n\n*At least 1 number\n\n*At least 1 capital letter\n\n*At least 1 special character\n\nI came up with the following regex for this: ^(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{12,32}$\nand wrote to WPForms support, who told me that they can only go as far as giving me a code snippet to enforce a minimum length:\n/**\n * Require number of characters allowed for an input field\n * Apply the class \"wpf-char-require\" to the field to enable.\n *\n */\nfunction wpf_dev_char_require() {\n    ?>\n    <script type=\"text/javascript\">\n        jQuery(function($){\n            $('.wpf-char-require input').attr('minlength',4); // Change number to character requirement (input fields)\n        });\n    </script>\n    <?php\n}\nadd_action( 'wpforms_wp_footer', 'wpf_dev_char_require' );\n\n(I'd add the wpf-char-require class to the field I want to validate).\nHow can I modify this to validate using my regex instead of the rule they've given me?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405001", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Website show Google Ads when we have no Google Ads linked to our website Today we noticed that one of our website has started showing random Google Ads on our website when we have not added any Google Ads to our website.\nI would appreciate if someone can help in case they have faced such scenario.\nI am not sure at this point if website is hacked or shared hosting server is compromised.\nAny points or steps i should follow to get rid of these ads on website\n\nA: probably your website is hacked.\nThe first thing to do is:\n\n*\n\n*if you still have access to your website and can log in, try to\nput it in maintenance mode (you can use any free plugin).\n\n*change your password and delete any unknown user.\n\n*if your hosting has a Malware Removal Service, use it to clean up\nyour site.\n\n*if not, then 5\n\n*try to update your themes and plugins.\n\n*re-install WordPress (I prefer manually using FTP)\n\n*Re-install the plugins\n\n*reinstall the theme\n\n*Clean out your database\n\n*use a security tool.\n\nTo make sure your website is hacked, you can use this tool: https://sitecheck.sucuri.net/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405003", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to correctly escape an echo In WordPress they recommend that I should escape any part of the code of my plugin that shows data to the user, I have made most of the corrections but this specific case I don't know how to escape that echo. Please help.\n<option value=\"\">\n    <?php _e( '- Default', MF_TEXT_DOMAIN ); ?>\n</option>\n<?php foreach ( $folders as $folder ) {\n    $folder = trim( $folder );\n    echo \"<option value=\\\"{$folder}\\\">{$folder}</option>\";\n} ?>\n\n\n\nA: Escaping is only necessary when you have no full control of the the thing you are echoing. So as long as $folder is a variable that you have defined yourself, there's no real need to escape. But if there is user input involved, there is esc_html, to be used as follows:\necho esc_html (\"this input string contains a > character\");\n\nIn this case, however, more drastic measures may be needed, because there can be no html tags at all inside option tags, so you add wp_strip_all_tags like this:\n$folder = wp_strip_all_tags ($folder);\necho esc_html (\"<option value=\\\"{$folder}\\\">{$folder}</option>\");\n\nUPDATE (thanks to Kero in the comments for noticing the error)\n$folder = esc_html (wp_strip_all_tags ($folder));\necho \"<option value=\\\"{$folder}\\\">{$folder}</option>\";\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405006", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Error: Attempt to read property \"ID\" on null I have the following error Attempt to read property \"ID\" on null in this code snippet\nglobal $wp_query;\n$categories =  get_the_terms($wp_query->post->ID, 'live_stream_categories');\n$cat_slug = '';\n$live_stream_true = False;\nif(!empty($categories)){\n    foreach ($categories as $cat) {\n        if($cat->slug != 'live-stream')\n        {\n            $cat_slug = $cat->slug;\n        }\n        if($cat->slug == 'live-stream')\n        {\n            $live_stream_true = True;\n        }\n     }\n }\n\nHowever I'm not sure what the workaround would be. Any advice? I've took over this site from a previous developer\n\nA: Where did you put that function ? that's better call that it inside the action, the error probably coming from missing variable.\nadd_action('init','newFunction');\nfunction newFunction(){\n global $wp_query;\n // Do your code here\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405009", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: enabling Twig as Template Engine withing own plugin I would like to integrate an Templating Engine (TWIG) within our custom plugin.\nMy question is:\nhow to handle/pass parameters which already are \"echoing\" its content.\nfor example:\necho $this->twig->render($file, ['val1' =>  settings_fields('settings')]; \n\n\nA: I would use output buffering to capture the content, then pass that in to the template.\nob_start();\nsettings_fields('settings');\n$settings_fields = ob_get_clean();\necho $this->twig->render($file, ['val1' =>  $settings_fields]);\n\nI think that should work.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405010", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Delete images from media library when user deletes an image from ACF Gallery When a user deletes an image from the gallery in wp-admin I need it to be deleted from the media library too. I have a function using the acf/update_value hook which works uncorrectly. When a user simply updates a post, WordPress removes all images from the media library and current gallery field. Please tell me how to fix it? All the old questions don't work :(\nadd_filter('acf/update_value/type=gallery', 'remove_gallery_images', 10, 3);\n\nfunction remove_gallery_images($value, $post_id, $field) {\n    $images_to_delete = array();\n    $old_value = get_post_meta($post_id, $field['name'], true);\n    $old_value = maybe_unserialize($old_value);\n    if (!is_array($old_value)) {\n        return $value;\n    }\n    if (!empty($value)) {\n        $images_to_delete = $old_value;\n    } else {\n        foreach ($old_value as $image_id) {\n            if (!in_array($image_id, $value)) {\n                $images_to_delete[] = $image_id;\n            }\n        }\n    }\n    if (count($images_to_delete)) {\n        foreach ($images_to_delete as $image_id) {\n            wp_delete_attachment($image_id, true);\n        }\n    }\n    return $value;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405011", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to only show ACF field if another block is being used? I'm developing a tab system on my site and I want to build the contents of the tabs using ACF blocks.\nI have a \"Tabs\" block which handles the titles of the tabs. I have linked the index number of the tabs via JS and CSS to show and hide content on the page.\nI'm currently using a ACF field to pick the tab the current block is shown in.\nSo there is a field \"Choose the tab where this block will be shown in\" with the choises 1 or 2 (being the index numbers of the tabs).\nI am adding this field to each block, but I would like the field to be visible ONLY when I'm using the \"Tabs\" block on the same page.\nThe field \"Choose the tab where this block will be shown in\" is now shown on every page on my site, even when the \"Tabs\" block is not in use, and it can be confusing.\nI tried hiding the field with CSS and then enqueuing a block-specific CSS file to show it but apparently the block-specific CSS file is loaded in admin even when the block is not in use so the CSS rule to show the field is always present in admin...\nIs there any way to check if a specific block is being used on a page and then show a field in all of the blocks if that's the case?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405013", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to add a custom filter (by coding) before access one wordpress page ? And where to call the custom filter? My requirement is to create a survey in wordpress, and the user needs to log in before answering. But the login page uses our own business account, so we created a login page ourselves (using .net core). Therefore After logging in, we migrated to the wordpress survey page . But before entering the wordpress page, the wordpress side needs to check whether the user is logged in through a cookie. Go to the survey page if you have logged in, otherwise jump to the login page.\nSo I want to make a filter on the wordpress side and want to call before accessing the page. But I don't know where to write the code to  call it .(Or just use the fiter name already defined in wordpress)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405014", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add Network Sites are not working I have my website for tests. I added a Network and now I have 2 blogs. The second blog is in a subdirectory store as you can see in the screenshot.\n\nNow, if I open the store it seems the theme is missing.\n\nbut also, if I click on Dashboard the page store/wp-admin is not found.\n\nI changed the wp-config.php and the web.config as the instructions.\nHere the webconfig\n<rewrite>\n    <rules>\n        <rule name=\"WordPress Rule 1\" stopProcessing=\"true\">\n            <match url=\"^index\\.php$\" ignoreCase=\"false\" />\n            <action type=\"None\" />\n        </rule>\n        <rule name=\"WordPress Rule 2\" stopProcessing=\"true\">\n            <match url=\"^([_0-9a-zA-Z-]+/)?wp-admin$\" ignoreCase=\"false\" />\n            <action type=\"Redirect\" url=\"{R:1}wp-admin/\" redirectType=\"Permanent\" />\n        </rule>\n        <rule name=\"WordPress Rule 3\" stopProcessing=\"true\">\n            <match url=\"^\" ignoreCase=\"false\" />\n            <conditions logicalGrouping=\"MatchAny\">\n                <add input=\"{REQUEST_FILENAME}\" matchType=\"IsFile\" ignoreCase=\"false\" />\n                <add input=\"{REQUEST_FILENAME}\" matchType=\"IsDirectory\" ignoreCase=\"false\" />\n            </conditions>\n            <action type=\"None\" />\n        </rule>\n        <rule name=\"WordPress Rule 4\" stopProcessing=\"true\">\n            <match url=\"^([_0-9a-zA-Z-]+/)?(wp-(content|admin|includes).*)\" ignoreCase=\"false\" />\n            <action type=\"Rewrite\" url=\"{R:1}\" />\n        </rule>\n        <rule name=\"WordPress Rule 5\" stopProcessing=\"true\">\n            <match url=\"^([_0-9a-zA-Z-]+/)?([_0-9a-zA-Z-]+/)?(.*\\.php)$\" ignoreCase=\"false\" />\n            <action type=\"Rewrite\" url=\"{R:2}\" />\n        </rule>\n        <rule name=\"WordPress Rule 6\" stopProcessing=\"true\">\n            <match url=\".\" ignoreCase=\"false\" />\n            <action type=\"Rewrite\" url=\"index.php\" />\n        </rule>\n    </rules>\n</rewrite>\n\nHow can I fix it?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405017", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: add class to element if user is not logged in Please help . I need to add class to this button if user is not logged in\n<?php echo apply_filters( 'my_order_html', '<button type=\"submit\" class=\"ADD-CLASS-HERE cfw-primary-btn cfw-next-tab validate\" name=\"my_list_html\" id=\"place_order\" formnovalidate=\"formnovalidate\" value=\"' . esc_attr( $order_button_text ) . '\" data-value=\"' . esc_attr( $order_button_text ) . '\"><span class=\"cfw-button-text\">' . esc_html( $order_button_text ) . '</span></button>' ); // @codingStandardsIgnoreLine ?>\n\n\nA: You can try something like this and implement it in your own case\n<?php\nif ( is_user_logged_in() ) {\n   $extraClass = \"hide-button\";\n} else {\n   $extraClass = \"\";\n}\n?>\n\n<a class=\"<?php echo $extraClass;? href=\"#\">\">Button text</a>\n\n\nand give the new class a styling like \"display: none;\" or something\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405021", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disable permalinks, but allow RSS feeds Have a custom post type event that needs an RSS feed (/feed/?post_type=event) but should not generate permalinks (/events/title-of-post).\nProblem is that the publicly_queryable argument for register_post_type enables both RSS and permalinks.\n'public' => false, //private, turns off permalinks and more\n'show_ui' => true, //allow edit via wp-admin\n'publicly_queryable' => true, //turn on RSS for events, but (whooops!) also turns permalinks back on\n\nIs there a simple way to enable the default Wordpress RSS feed for a custom post type without generating permalinks? (Or will I have to make a custom RSS feed using add_feed?)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405023", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to fix select filter on category I created a filter where I can filter on different types of machines by a custom taxonomy. It shows the right taxonomies in the filter and after submitting the right url is shown. Problem is that despite of these good things the archive still shows all the machines, and not only the one with the matching taxonomy.\nAnyone who can help me?\nThe code I used is\nfunction MachineSoortMagni() { \n//Labels voor de custom taxonomy\n     $labels = array(\n       'name' => _x( 'Types', 'type-magni' ),\n       'singular_name' => _x( 'Type', 'type' ),\n       'search_items' =>  __( 'Zoek Types' ),\n       'all_items' => __( 'Alle Types' ),\n       'parent_item' => __( 'Parent Type' ),\n       'parent_item_colon' => __( 'Parent Type:' ),\n       'edit_item' => __( 'Bewerk Type' ), \n       'update_item' => __( 'Update Type' ),\n       'add_new_item' => __( 'Voeg nieuw Type toe' ),\n       'new_item_name' => __( 'Nieuwe Type naam' ),\n       'menu_name' => __( 'Types' ),\n     );    \n    \n   // Taxonomy registreren\n     register_taxonomy('type-magni',array('magni'), array(\n       'hierarchical' => true,\n       'labels' => $labels,\n       'show_ui' => true,\n       'show_in_rest' => true,\n       'show_admin_column' => true,\n       'query_var' => true,\n       'rewrite' => array( 'slug' => 'type-magni' ),\n     ));\n    \n   }\n   add_action( 'init', 'MachineSoortMagni', 0 );\n\nfunction filterTypeMagni(){\n    echo 'Soort machine: ';\n    echo '<form method=\"GET\" class=\"custom-filter\">';\n    echo '<select name=\"orderby\" id=\"orderby\"><option value=\"\">Soort machine</option>';\n            $terms = get_terms([\n                'taxonomy' => 'type-magni',\n                'hide_empty' => 'false'\n            ]);\n            foreach ($terms as $term) :\n                echo '<option value=\"' . $term->slug . '\" name=\"type-magni[]\">' . $term->name . '</option>';\n                                \n            \n            endforeach;\n            echo '</select>';\n        echo '<button type=\"submit\">Filter</button>';\n    echo '</form>';\n}\nadd_shortcode('filter_type_magni', 'filterTypeMagni');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405024", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp_redirect is only working in Chrome Network, page is not redirecting I created a custom WordPress Payment Plugin for WooCommerce, Everything is working fine. When I try to use wp_redirect('url'); page starts to load in Browser Network, but the page is not redirecting it gives me the following error:\nSyntaxError: Unexpected token < in JSON at position 0\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405028", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to left join meta in queries I have a query something like\n  //read products with thumbnail and sku\n  SELECT products.*, pm1.meta_value as sku, p1.guid as thumbnail\n  FROM `wp_posts` as products\n  LEFT JOIN `wp_postmeta` as pm1 ON products.ID = pm1.post_id \n  LEFT JOIN `wp_postmeta` as pm2 ON products.ID = pm2.post_id \n  LEFT JOIN `wp_posts` as p1 ON pm2.meta_value = p1.ID\n  WHERE products.post_type = 'product' AND pm1.meta_key = '_sku' AND pm2.meta_key = '_thumbnail_id';\n\nThis Query will get all the products that have a sku and a thumbnail but will not get any products who are missing a sku or thumbnail.\nHow do I get all products and the sku if it exists and the thumbnail if it exists?\nI do not want to have to run 3 queries and merge the data.\n\nA: One possible solutions is use Queries in the joins instead of tables.\nso the query would look something like\n//read products with thumbnail and sku\n  SELECT products.*, skus.sku, thumbs.thumbnail\n  FROM `wp_posts` as products\n  LEFT JOIN (\n    SELECT posts2.ID, pm1.meta_value as sku\n    FROM `wp_posts` as posts2\n    LEFT JOIN `sf_postmeta` as pm1 ON posts2.ID = pm1.post_id \n    WHERE pm1.meta_key = '_sku'\n  ) as skus ON products.ID = skus.ID \n  LEFT JOIN (\n    SELECT posts3.ID, p1.guid as thumbnail\n    FROM `wp_posts` as posts3\n    LEFT JOIN `sf_postmeta` as pm2 ON posts3.ID = pm2.post_id \n    LEFT JOIN `sf_posts` as posts4 ON pm2.meta_value = posts4.ID\n    WHERE  pm2.meta_key = '_thumbnail_id'\n  ) as thumbs ON products.ID = thumbs.ID \n  WHERE products.post_type = 'product';\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405030", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can't render shortcode when html tag contains hyphen Let's say I have a web component called <x-interaction>. I want to pass the ID of the post to the web component as an attribute, so I write a shortcode to render the ID.\nadd_shortcode('get_the_id', 'get_the_ID');\n\nIn the post I write the following:\n<x-interaction postid=[get_the_id]>\n  <span slot=\"title\">This is slotted content</span>\n</x-interaction>\n\nSo far, so good.\nBut the shortcode isn't rendered on the page. The shortcode appears verbatim in the rendered HTML.\nI want this:\n<x-interaction postid=\"4\">\n\nBut I get this:\n<x-interaction postid=\"[get_the_id]\">\n\nWhat? \u200d\nAs an experiment, I removed the hyphen from the tag name, and the shortcode renders appropriately: <xinteraction>\n<xinteraction postid=\"4\">\n\nThis seems to be related to the hyphen in the web component tag name. Or something else with Wordpress and web components that I don't know.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405034", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Time Delay a URL Redirect for Specific Page I need to set a time delay redirect for a specific page.\nReason is because we have a URL redirect on the specific page and it is not registering for a Google Analytic page visit conversion. So we need to have a short time delay on the page before the redirect starts.\nI found the below code to use, but I prefer not to add the code to the specific page, but instead in the functions.php if this is the recommended route.\n(CODE FOR FUNCTIONS PHP FILE)\nAny suggestions are greatly appreciated.\nCODE TO USE (found this when doing some research)\n<!DOCTYPE html>\n<html>\n   <body>\n      <script>\n         setTimeout(myURL, 5000);\n         function myURL(){\n            window.open('http://www.samplewebsite.com/pageone');\n         }\n      </script>\n      <p>Web page loads after 5 seconds.</p>\n   </body>\n</html>\n\nCODE FOR FUNCTIONS PHP FILE\nfunction js_code_page() {\nif (is_page ('pageID')) { \n?>\n<script type=\"text/javascript\">\n setTimeout(myURL, 5000);\n function myURL(){\n    window.open('http://www.samplewebsite.com/pageone');\n }\n</script>\n<?php\n}\n}\nadd_action('wp_head', 'js_code_page');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405037", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Detect selected block pattern from a specific Pattern category It is possible to detect when the Inserter panel is opened. It can be done using the following code snippet:\nwp.data.select( 'core/edit-post' ).isInserterOpened()\n\nHowever, I am wondering if there is an event in wp.data that allows to detect if the user has selected a block pattern (via Patterns tab) from a specific category (for instance, the Query category).\nUse case\nI have a theme that has two templates: Default and Custom.\nThe Default template displays a page layout with the page title, content area and sidebar.\nThe Custom template displays a page layout with with content only.\nAlso, the theme has a special Pattern category named \"Pages\". This category contains pre-made page layouts.\nBy default, WordPress displays (sets) Default template as initial template of the page.\nMy goal is to detect when user selects a block pattern from \"Pages\" category, and change template from Default to Custom in the editor automatically.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405040", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Rewrite parameters as Url for SEO I have urls of this form:\nexample.com/event/?eventId=1\nexample.com/event/?eventId=2\nThe problem is Google is indexing only example.com/event, which is a blank page.  It's not able to display an event without the Id.  I would like to redirect this url to this form:\nexample.com/event/1\nThis will allow Google to index each event individually.\nThe event page is provided by the admin.  I imagine something like:\nfunction add_eventId_rule() {\n  $post = get_post(get_option('EVENT_AGENT_EVENT_PAGEID'));\n  if($post != null)\n  {\n    add_rewrite_rule(\n      substr(wp_make_link_relative(get_permalink($post)), 1) . '(\\d*)/?$',\n      'index.php?page_id=' . $post->ID .'&eventId=$matches[1]',\n      'top'\n    );\n    // this produces the regex event/(\\d*)/?$  Can produce foo/bar/event if\n    // the display page has parent pages\n  }\n}\n\nfunction ea_query_vars($qvars) {\n  $qvars[] = 'eventId';\n  return $qvars;\n}\n\nfunction capture_event_display_page($post)\n{\n  add_option('EVENT_AGENT_EVENT_PAGEID', $post->ID);\n  flush_rewrite_rules(true);\n}\n\nadd_filter( 'query_vars', 'ea_query_vars' );\nadd_action( 'init', 'add_eventId_rule');\nadd_action( 'save_post', 'capture_event_display_page')\n\nUsing this code, the following work:\nhttps://www.eventagent.ai/event/?eventId=80\nhttps://www.eventagent.ai/index.php?page_id=87&eventId=80\nBut the one I want doesn't.  It strips the eventId:\nhttps://www.eventagent.ai/event/80\nHow come?  What am I missing?\n\nA: Because it's not enough to register your rule, you need to flush the rewrite rules for it to take effect. An easy way of doing this is to visit the permalinks settings page.\nThis is true regardless of where the rewrite rule came from. The most common reason people encounter this is because of the rewrite rules core creates for custom post types, but this is not unique to custom post types.\nAnother possibility is that your rewrite rules regular expression doesn't match the URLs you are testing, or, that another rule with higher priority matches it first. The rewrite analyser plugin or one of its competitors can help diagnose this.\nWarning: A common mistake developers make to try and work around this is to flush the rewrite rules programmatically on every request so they don't have to do it manually. This introduces bugs but it also adds a heavy performance hit that's trivially avoided. Flush them on plugin de/activation, when you update your plugins database settings, or when user interaction requires it, and never on the frontend unless absolutely unavoidably necessary. You may see this referred to as flushing on the init hook.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405041", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Could not override the url in wp-config file for the wordpress deployment purpose I have added the following code in wp-config.php file\ndefine( 'WP_HOME', 'http://example.com');\n\ndefine( 'WP_SITEURL', 'http://example.com');\n\nI did not make any changes in wp-option table. there its shows localhost url. I don't want to change here every time. so I tried to override using wp-config file.\nissues is: it is not working on server. all the images are showing with localhost url\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405043", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: users in their Role can only their Posts I got a custom post type called \"objects\". I now want that only users in the role \"groupA\" can edit nor delete posts from users in role \"groupA\". Same with Media.\nIs that possible?\nbest regards\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405046", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can we use a webservice with Wordpress? Assuming that my site uses a database through the web service to fetch content, style and other things for my site. Can we make this connection in a way provided by the CMS? A plugin does that? Should we do it ourselves?\nThanks for answers.\n\nA: Yes, you can write php code, potentially in the form of a plugin, to access a remote web service.\nPresumably you want to use a web service accessed via https (or http). WordPress provides the wp_remote_request() function to do that. You can call it from your php code (in your plugin). When your server runs that function, it will retrieve a result from your web service. You can then use it as needed. Notice this is server-side code, not client-side.\nOr you can use the simpler wp_remote_post() or wp_remote_get() functions if they work for your web service.\nEdit You can write a plugin, but that takes software-engineering work to make it integrate cleanly with your site.\nYou can use the Code Snippets plugin to insert a little chunk of php. That's ok for development and experimentation, but a sizable security risk in production (or in dev for that matter).\nSome suggest editing your theme's functions.php file to add a bit of code. But I don't suggest that approach: theme updates will make your changes vanish.\nYou didn't mention what you want to do with the result you get back from your webservice, so it's hard to recommend which hook you should use to invoke your code.\n\nA: The answer to the current question is found. Thank you all for your answers.\nThe answer to the question is 'yes'. We can use an external webservice/API in the Wordpress code. We can use for this, wp_remote_request to call through an URL. For my part, I did otherwise because my webservice is a special one, so I created a SoapClient class in the files of my plugin to make the connection and the function calls.\nTo provide a correct display of the webservice, I decided to use 2 widgets. 1 for the search and 1 for the display. I still have some problems with the display with the web page but that will be another issue. Thanks again.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405049", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Add Block Before Entry Title Using PHP I'm using this code to add a block before the entry title on the front page but its not working:\n$e      = get_block( '552' ); \n$eblock = apply_filters( 'the_content', $e->post_content );\n\necho $eblock;\n\nNote : The code works fine within the content area but not outside the loop.\nI also tried do_blocks() but it prints multiple instances of the output which is form HTML.\n$get_block = get_post( '552' );\n$footer = $get_block->post_content; \n$out = do_blocks($footer);\n\nreturn $title .  $out;\n\nHere's where i got the reusable block ID http://example.com/wp-admin/post.php?post=552&action=edit\nIt must have something to do with add_filter('the_title', i'm using because it works fine when i echo it without a hook.\n\nA: I worked this out. The code for the_title filter was causing the problem so i added the code to the entry header template part and it works fine.\necho apply_filters( 'the_content', get_post_field('post_content', '552' ) );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405050", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP Query Order By Multiple Values I have created the following query. The query works perfectly. However, I despair with the order. I would like the posts in which the custom field \"nft_featured\" have the value \"yes\" to be first (the only options are yes or no) and then all other posts, sorted by the custom field \"nft_datetime\" (Date Field).\nThanks in advance!\n<?php\n    $args = array(\n        'post_type'  => 'nft',\n        'post_status' => 'publish',\n        'posts_per_page' => '15',\n        'no_found_rows' => 'true',\n        'meta_key'=>'nft_datetime',\n                \n        \n        'meta_query' => array(\n        \n            'relation' => 'OR',\n            \n            'date_clause' => array(\n                    'key'     => 'nft_datetime',\n                    'type'     => 'DATE',\n                    'value'   => date('Y-m-d'),\n                    'compare' => '>=',\n                    ),\n                \n            \n            'featured_clause' => array(\n                    'key'     => 'nft_featured',\n                    'value'   => 'yes',\n                    'compare' => '=',\n                    'type'   => 'CHAR',\n                    ),\n                ),\n                \n                \n        'orderby' => array( \n            'featured_clause' => 'DESC', \n            'date_clause' => 'DESC', \n        ) \n                \n    );\n    \n    echo build_query( $args );\n    \n?>  \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405054", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add rewrite rule for custom post type single page I am new in the WordPress and I do not know how to convert query parameter as URL for custom post type single page. I do not want to change any affect result of single.php.\nJust want to convert below single details page URL\nhttp://example.com/whitepapers/example-of-whitepaper-item?status=complete\n\nto\nhttp://example.com/whitepapers/example-of-whitepaper-item/complete\n\nwhere the whitepapers = custom post type\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405059", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change the \"Register\" headline in Woocommerce I want to change the Register text on the \"My account\" page.\nBut I cant figure out how to do it. \n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405062", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Login page too many redirects I have a custom plugin that handles the login and verification of customers. It creates default WordPress users with custom usermeta. But as an admin whenever I try to access the wp-admin dashboard on my live site I get an error page with too many redirects. This however works on my local dev site. Below is the function that fires after logging in and gives the error.\n    function redirect_to_lvkg_login() {\n\n        if ( $_SERVER['REQUEST_METHOD'] == 'GET' ) {\n\n            if ( is_user_logged_in() ) {\n                lvkg_redirect_logged_in_user();\n                exit;\n            }\n\n            $login_url = home_url( 'login' );\n\n            if (!empty($_REQUEST['redirect_to'])) {\n                $login_url = add_query_arg('redirect_to', $_REQUEST['redirect_to'], $login_url);\n            }\n            \n            if (!empty($_REQUEST['checkemail'])) {\n                $login_url = add_query_arg('checkemail', $_REQUEST['checkemail'], $login_url);\n            }\n\n            if (!empty($_REQUEST['verify']) && lvkg_check_code($_REQUEST['verify'], 'verif_id')) {\n                \n                $user_id = lvkg_check_code($_REQUEST['verify'], 'verif_id');\n\n                $user_stat = get_user_meta($user_id, 'status', true);\n                $user_info = get_userdata($user_id);\n\n                $args = array('login' => $user_info->user_login);\n                $args['verify'] = ($user_stat == \"unverified\") ? 'verified' : 'already_verified';\n\n                if($user_stat == \"unverified\")\n                    update_user_meta($user_id, 'status', 'verified');\n\n                $login_url = add_query_arg($args, $login_url);\n\n            }\n\n            wp_redirect($login_url);\n            exit;\n        }\n    }\n\nfunction lvkg_redirect_logged_in_user($redirect_to = null ) {\n    $user = wp_get_current_user();\n    if (user_can($user,'manage_options')) {\n        if ($redirect_to) {\n            wp_safe_redirect($redirect_to);\n            exit;\n        } else {\n            wp_redirect(admin_url());\n            exit;\n        }\n\n    } else {\n        wp_redirect(home_url());\n        exit;\n    }\n}\n\nAm I missing something, or could this be a problem with my hosting?\n\nA: Try this\nif ( is_user_logged_in() && !is_admin()) {\n                lvkg_redirect_logged_in_user();\n                exit;\n            }\n\n!is_admin() will make sure that this function is not called if a user is already in wp-admin or has been successfully redirected to wp-admin.\nWithout this check after every redirection to wp-admin, this function will be called again lvkg_redirect_logged_in_user(); hence creating an infinite loop.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405063", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Automatically add images to a menu I am calling a menu into a page, but I want to add images next to the title of the menu items.\nI have this code:\n<ol>\n<?php\n    $navMenu = wp_get_nav_menu_items(2096); /*/Pass Nav Menu_id or Name*/\n    $previousMenuParent = $level = 0;\n    foreach ($navMenu as $menu) {\n\n        if($menu->menu_item_parent == 0)\n        {\n            $level = 0;\n            echo '<li><a href=\"'. $menu->url .'\"><img src=\"'. get_the_post_thumbnail($menu->ID) .'\"/> '. $menu->title .'</a>';\n            \n        }\n      \n    }\n?>\n</li>\n\nIt works, it is showing the list of the menu items, with title and link, but for some reason, it won't show the post's image next to its title.\nI also tried using get_the_post_thumbnail('thumbnail') instead of get_the_post_thumbnail($menu->ID) but that won't show an image either, with or without the <img src=\"\nI would also prefer to call a post's custom field, which has an image URL, instead of the post thumbnail. Is that possible?\nAny help would be greatly appreciated.\nThank you\n\nA: I guess you need this function\nget_the_post_thumbnail_url($menu->object_id);\n\n(provided menu item is not a custom link)\n$menu->ID is not the id of the post/page it is linking to.\nAbout calling meta yes it is also possible\n$image_url = get_post_meta( $menu->object_id, 'meta_key', true );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405064", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: REGEXP_REPLACE in post_contet So, basically, I want to remove trailing slashes from specific domain urls. For example: https://www.example.com/here/postname/\ninto https://www.example.com/here/postname\nI have 10.4.21-MariaDB which should support REGEXP_REPLACE function.\nThis is my query:\nUPDATE wp_posts SET post_content = REGEXP_REPLACE(post_content, '(http\\S+)\\/(\\s|$)', '$1');\n\nor this one more specifically:\nUPDATE wp_posts SET post_content = REGEXP_REPLACE(post_content, '(https:\\/\\/www\\.example\\.com\\/here\\/\\S+)\\/(\\s|$)', '$1');\n\nwhich according to regular expressions should work:\nhttps://regex101.com/r/slLbgg/1\nWhat am I doing wrong?\nAny kind of help is appreciated! :)\nThis is the result:\n\n\nA: Ok, if someone in the future also needs something like this,\nI found the solution after some time of playing with regular expressions.\nThis worked for me:\nUPDATE `wp_posts` SET `post_content` = REGEXP_REPLACE(`post_content`, 'https:\\/\\/www\\.example\\.com\\/magazin\\/(.*?)\\/\">', 'https://www.example.com/magazin/\\\\1\">');\n\nExample in action can be seen here:\nhttps://regex101.com/r/3ZPylJ/1\nHope it helps!\nSmile to all :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405065", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Getting \"Years Only \" from ACF Date Picker field to Hidden filed in the fields group I have a Date Picker field and text field, or hidden field, can I get the year filled up to the text field or hidden field when filling up the date picker filed?\nthis is for a filtring reason I do need the year only.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405068", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Foreach loop is unexpectedly outputting an extra empty a tag I am using a for each loop to output elements on a grid and I am using acf's gallery type to input images.\nIt is outputting this extra a tag with empty space and no hrefs. See below\n\nHere is my php\n<?php if( have_rows('image_galleries') ): ?>\n    <?php while ( have_rows('image_galleries') ) : the_row();\n        $header = get_sub_field('gallery_header');\n        $header_background = get_sub_field('header_background');\n        $images = get_sub_field('images');\n        $count = 1;\n    ?>\n    <div id=\"<?php echo 'gallery-' . get_row_index(); ?>\" class=\"pt-20<?php echo get_row_index() % 2 === 0 ? ' text-right' : ''; ?>\">\n        <?php if( $header_background ): ?>\n        <div class=\"relative inline-block\">\n            <img class=\"w-80<?php echo get_row_index() % 2 === 0 ? ' transform rotate-180' : ''; ?>\" src=\"<?php echo $header_background['url']; ?>\" alt=\"<?php echo $header_background['alt']; ?>\">\n            <h3 class=\"text-white text-center absolute transform top-1/2 -translate-y-1/2 normal-case w-full\"><span class=\"relative inline-block<?php echo get_row_index() % 2 === 0 ? ' left-4' : ' right-4'; ?>\"><?php echo $header; ?></span></h3>\n        </div>\n        <?php else : ?>\n            <h3 class=\"text-center\"><?php echo $header; ?></h3>\n        <?php endif; ?>\n        <div class=\"grid gap-6 xsm:grid-cols-2 md:grid-cols-3 lg:grid-cols-2 masonry-grid mt-10 justify-center\">\n        <?php foreach( $images as $image ): $translate = $count % 2 === 0 ? 'translate-x-full' : '-translate-x-full';?>\n        <a target=\"_blank\" href=\"<?php echo $image['description']; ?>\" class=\"block relative hover:z-20 masonry-grid-item\">\n        <?php echo wp_get_attachment_image( $image['id'], 'full', \"\", array( 'class' => 'mx-auto transform duration-500 hover:scale-110 duration-700 opacity-0 transform transition-all ' . $translate ))  ?>\n            </a>\n        <?php $count++; endforeach; ?>\n        </div>\n    </div>  \n    <?php endwhile; ?>\n<?php endif; ?>\n\nAnything that I'm missing I'm not sure why this is happening.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405072", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is this a backup door? So I am working on client's site and I found this code in the functions.php file highlighted as a virus.\n@!!!>$user_search->query_where=str_replace('WHERE 1=1',\"WHERE 1=1 AND{$wpdb->users}.user_login!='f*****k@gmail.com'\",$user\n\nNow I don't know php but it looks like it is trying to replace the user 1's email in the database with this email. I censored the email. am I right? but if so how is the attacker going to excite this? There has to be a trigger for this, right?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405073", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Cannot read properties of undefined (reading 'show_ui') Error on WordPress Post Editor We're getting the following error on our Block Editor when trying to edit a post:\nTypeError: Cannot read properties of undefined (reading 'show_ui')\nat https://informationsecurityleadership.com/wp-includes/js/dist/editor.min.js?ver=8d4a298f55ea5a97c9e5147f9e132d82:7:114477\nat i (https://informationsecurityleadership.com/wp-includes/js/dist/vendor/lodash.min.js?ver=4.17.19:10:88)\nat lf (https://informationsecurityleadership.com/wp-includes/js/dist/vendor/lodash.min.js?ver=4.17.19:84:172)\nat https://informationsecurityleadership.com/wp-includes/js/dist/editor.min.js?ver=8d4a298f55ea5a97c9e5147f9e132d82:7:114458\nat Le (https://informationsecurityleadership.com/wp-includes/js/dist/vendor/react-dom.min.js?ver=17.0.1:100:3)\nat Pj (https://informationsecurityleadership.com/wp-includes/js/dist/vendor/react-dom.min.js?ver=17.0.1:231:183)\nat di (https://informationsecurityleadership.com/wp-includes/js/dist/vendor/react-dom.min.js?ver=17.0.1:168:305)\nat Nj (https://informationsecurityleadership.com/wp-includes/js/dist/vendor/react-dom.min.js?ver=17.0.1:168:236)\nat sc (https://informationsecurityleadership.com/wp-includes/js/dist/vendor/react-dom.min.js?ver=17.0.1:168:96)\nat gf (https://informationsecurityleadership.com/wp-includes/js/dist/vendor/react-dom.min.js?ver=17.0.1:162:109)\n\nHere are the details on how our WordPress is configured:\n\n*\n\n*Our WordPress sits behind an AWS Firewall and our resources are served through Cloudfront.\n\n*We have a staging site identical to the production environment minus Cloudfront and we are not seeing this error on the staging site even though all the plugins and WordPress version are the same.\n\n*The oddest thing about this error is that we are only seeing it when trying to edit a post and not when trying to edit a page.\n\n*A lot of solutions suggest changing a configuration on a NGINX server BUT we are not running our WordPress on NGINX. We're just using Apache2 and PHP-FPM.\n\nHere's what I've tried:\n\n*\n\n*I've tried clearing the CloudFront, Site and Browser cache as suggested in this article: https://www.techrbun.com/wordpress-editor-unexpected-error-fix/\n\n*I've added a rule in the WAF/Cloudfront to not cache resources from the following URL: https://informationsecurityleadership.com/wp-includes/js/*\n\n*I've reviewed some PHP changes to no avail.\n\nIt is getting frustrating as I am not able to pinpoint to the exact problem(I am not familiar with React or its problems). It's also frustrating that many of the solutions assume that there will be a NGINX server. Some help would be appreciated. If this is really a cache problem then kindly suggest what exceptions to add.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405077", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sort query_terms_list for post_tags alphabetically I have the following array that currently sorts tags by tag count and returns the tags with the individual tag count. I would like to keep the individual tag count but sort the tags alphabetically instead. I tried to change arsort( $list ) to sort ( $terms->name ) but I think my logic here is completely off. Any assistance is much appreciated :)\nExample:\nchange from: oranges(20 )apples(12) bananas(10)\nto:\napples(12) bananas(10) oranges(20)\nfunction get_query_terms_list( $taxonomy = 'post_tag', $sep = '' ) {\n    $list = array();\n    \n    foreach ( $GLOBALS['wp_query']->posts as $post ) {\n        if ( is_array( $terms = get_the_terms( $post, $taxonomy ) ) ) {\n            foreach ( $terms as $term ) {\n                // Set the term's initial count.\n                if ( ! isset( $list[ $term->term_id ] ) ) {\n                    $list[ $term->term_id ] = 0;\n                }\n                // And then increment it for each post.\n                $list[ $term->term_id ]++;\n            }\n        }\n    }\n    \n    \n    // Sort by the count, highest to lowest.\n    arsort( $list );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405078", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can't deregister / dequeue scripts in WordPress There's a plugin putting scripts in the footer of my site seemingly with the rest of the enqueued scripts that have been enqueued with wp_enqueue_script( $in_footer = true ). However when I use the following code, these scripts are not present.\nvar_dump(wp_scripts());\nI know the handles for these scripts (without the -js at the end) and have tried deregistering and dequeuing these scripts with priorities from 0 to 99999999999. The code at the moment is:\nadd_action( 'wp_enqueue_scripts', 'remove_unused_homepage_code' , 99999999999 );\nfunction remove_unused_homepage_code() {\n    wp_deregister_script( 'handle_here' );\n    wp_dequeue_script( 'handle_here' );\n    wp_deregister_style( 'handle_here' );\n    wp_dequeue_style( 'handle_here' );\n}\n\nI've looked at the plugin's enqueue functions and they're just normal wp_enqueue_script() functions with no priorities defined.\nHow in the world do I get rid of these scripts? The plugin, which is https://wpdatatables.com/ btw, wants to put these huge scripts on all pages of my site regardless of where the plugin is used.\nI'd really appreciate any help.\n\nA: You are dequeuing before the script may even be enqueued. Test with a hook that is actioned after wp_enqueue_scripts to deque.\nhttps://developer.wordpress.org/reference/functions/wp_dequeue_script/\n/**\n * Dequeue the jQuery UI script.\n *\n * Hooked to the wp_print_scripts action, with a late priority (100),\n * so that it is after the script was enqueued.\n */\nfunction wpdocs_dequeue_script() {\n    wp_dequeue_script( 'jquery-ui-core' );\n}\nadd_action( 'wp_print_scripts', 'wpdocs_dequeue_script', 100 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405079", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to access WC()->cart in CF7 hook wpcf7_special_mail_tags I have created a page that allows users to request a quote based on Cart contents, in the wpcf7 hook wpcf7_special_mail_tags() I want to get the cart contents and return the output (cart items), but WC()->cart appears null in this hook, I cant work out how to get access to WC()->cart in this hook.\nThe wpcf7_special_mail_tags() works fine and inserts other data into email, I just want cart data though.\nThanks for any help.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405080", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: flush_rewrite_rules on MultiSite I'm trying to update all the permalinks on my MU install. But I'm not sure how to go about it.\nThis is what I have so far. But I think it's only updating the first sites permalinks.\n   switch_to_blog( $site->id );\n    delete_option( 'rewrite_rules' );\n    global $wp_rewrite;\n    $wp_rewrite->init();\n    $wp_rewrite->flush_rules();\n   restore_current_blog();\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405081", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: OOP PHP class extends TwentyTwenty_Customize in Child Theme Not sure if OOP is covered here but i've copied the class-twentytwenty-customize.php file from the Twenty Twenty parent theme to my child theme and renamed it to class-customize.php because i need to modify it and add more settings to the customizer, but i get errors.\nI changed line 16 from this\nclass TwentyTwenty_Customize {\n\nto this :\nclass TwentyTwenty_Customize_Extended extends TwentyTwenty_Customize {\n\nWhat am i missing\nI'm loading the class in my child theme like this\nrequire get_stylesheet_directory() . '/class-customize.php';\n\nUpdate: Warning:\ncall_user_func_array() expects parameter 1 to be a valid callback, class 'TwentyTwenty_Customize_Extended' not found in /Users/michelle/Desktop/local/app/public/wp-includes/class-wp-hook.php on line 307\n\nThis is the code in class-customize.php:\nadd_action( 'customize_register', array( 'TwentyTwenty_Customize_Extended', 'register' ) );\nfunction register() {\n\nif ( ! class_exists( 'TwentyTwenty_Customize' ) ) {\n    return;\n}\n\n    class TwentyTwenty_Customize_Extended extends TwentyTwenty_Customize {\n\n        public static function register( $wp_customize ) {\n\n// Default code.\n\n\n    $new = new TwentyTwenty_Customize_Extended;\n\n    $new->register( $wp_customize );\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405083", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get products by custom date variable i have a product attribute called review_date, and i would like to order these products by that date. I haven't seen a working solution yet.. what am I doing wrong here?\n$args = array(\n        'post_type'      => 'product',\n        'posts_per_page' => 20,\n        'orderby'   => 'meta_value_num',\n        'meta_key'  => 'pa_review_date',\n); \n\n\nA: Try use meta_value instead of meta_value_num.\n$args = array(\n        'post_type'      => 'product',\n        'posts_per_page' => 20,\n        'orderby'   => 'meta_value',\n        'meta_key'  => 'pa_review_date',\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405084", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can i strip shortcode from HTML title tag? On a website, I am using Wordpress shortcodes for French example words: [ex]beau[/ex] becomes <span class=\"ex\" xml:lang=\"fr\" lang=\"fr\">beau</span>.\nI would like to use the shortcode also in the title of a page/post. add_filter( 'the_title', 'do_shortcode' ); in the functions.php works almost perfectly, but the HTML title tag includes [ex]beau[/ex] now.\nI am looking for a way to use a shortcode in the title of page/post (<?php the_title() ?> in my page.php), but it should not appear in the HTML title tag (<?php single_post_title(); ?> in my header.php).\nYour help is greatly appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405087", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to display translated content with custom slug? I used Polylang plugin to translate pages, So url of english page https://www.example.com/protfolio\nWhen I translated this page will be https://www.example.com/ar/protfolio-ar\nSo I can't see content of the page because I addedd -ar in slug but polylang can't duplicate slug\nso How can I show translated content even I added custom slug\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405089", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: custom post type query causing errors Any idea what is wrong with this? It \"works\" but it runs the error_log bananas. It should be noted that this code excerpt is from the \"404.php\" file\nHere's the code:\n                        <div class=\"col-md-12 mb-3\">\n                        <h3 class=\"heading\">Service Areas</h3>\n                        <?php\n                        $allCities_args = array(\n                            'post_type' => 'local',\n                            'posts_per_page' => -1,\n                            'post_status' => 'publish',\n                            'orderby' => 'title',\n                            'order'   => 'ASC'\n                        );\n\n                        $all_cities = new WP_Query($allCities_args);\n                        ?>\n                        <div class=\"nearby_cities \">\n                            <?php\n\n                            if ($all_cities->have_posts()) {\n                                while ($all_cities->have_posts()) {\n                                    $all_cities->the_post();\n                                    $city_id = get_the_ID();\n                                    $state_check = get_post_ancestors($post_id);\n                                    $parent_id = $state_check[0];\n                                    if ($parent_id !== 0) {\n                                        $nbcities = get_the_title();\n                            ?>\n                                        <div class=\"col-md-12 p-0\">\n                                            <a href=\"<?php the_permalink(); ?>\" class=\"nearby-city\" data-parentid=\"<?php echo $parent_id; ?>\"><?php echo $nbcities; ?></a>\n                                        </div>\n                            <?php\n                                    }\n                                }\n                            }\n                            ?>\n                        </div>\n\nHere's not even a fraction of what the error_log is throwing at me (note that the time discrepancies are because I had to get rid of a lot of it to comply with the 30000 character limit):\n[23-Apr-2022 18:09:09 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 456\n[23-Apr-2022 18:09:09 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 482\n[23-Apr-2022 18:09:11 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 456\n[23-Apr-2022 18:09:11 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 482\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:10 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/types-of-jobs.php on line 93\n[23-Apr-2022 18:11:14 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 456\n[23-Apr-2022 18:11:14 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 482\n[23-Apr-2022 18:11:16 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 456\n[23-Apr-2022 18:11:16 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 482\n[23-Apr-2022 18:14:48 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 456\n[23-Apr-2022 18:14:48 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 482\n[23-Apr-2022 18:14:54 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 456\n[23-Apr-2022 18:14:54 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 482\n[23-Apr-2022 18:15:18 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 456\n[23-Apr-2022 18:15:18 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 482\n[23-Apr-2022 18:16:26 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 456\n[23-Apr-2022 18:16:26 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 482\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 456\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Attempt to read property \"post_type\" on null in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/functions.php on line 482\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined array key 0 in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 222\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n[23-Apr-2022 18:22:17 UTC] PHP Warning:  Undefined variable $post_id in /home/wastere1/staging.wasteremovalusa.com/wp-content/themes/wasteremovalusa/404.php on line 221\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405090", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to override supports of innerBlocks? Is it possible to specify the supports of each specific InnerBlock when using nested components?, In the following example I want to disable the color background feature added in the theme.json to the paragraph only in my custom block.\n// MyCustomBlock.ts\n\nconst BLOCKS_TEMPLATE = [\n        ['core/image'],\n        [\n            'core/heading',\n            {\n                placeholder: __('Your title in here', 'test-blocks'),\n                level: 6\n            },\n        ],\n        ['core/paragraph', {\n            placeholder: __('Your text in here', 'test-blocks'),\n            supports: {\n                color: {\n                    background: false\n                }\n            } }],\n    ];\n\n    const INNER_BLOCKS_PROPS = {\n        template: BLOCKS_TEMPLATE,\n        templateLock: 'all',\n    };\n\n    return (\n        <div {...useBlockProps()}>\n            <InnerBlocks {...INNER_BLOCKS_PROPS} />\n        </div>\n    );\n\nI did some investigation and:\nWhen an EditBlock is being rendered is passed through withBlockControls HOC.\nIf there is no way to do it easily, I could remove the filter\nremoveFilter('editor.BlockEdit',\n    'core/style/with-block-controls'\n);\n\nThen I could add a custom filter that could be a copy-paste of the existing one but with a layer with some logic to conditionally add or not the ColorEdit component for example:\nexport const withBlockControls = createHigherOrderComponent(\n    ( BlockEdit ) => ( props ) => {\n        const shouldDisplayControls = useDisplayBlockControls();\n        // custom logic in here\n        const supportsEditColor = doesSupportsColorBackgroundRelativeToParent(props.clientId)\n        // end custom logic\n        return (\n            <>\n                { shouldDisplayControls && (\n                    <>\n                        {supportsEditColor && <ColorEdit { ...props } />}\n                        <TypographyPanel { ...props } />\n                        <BorderPanel { ...props } />\n                        <DimensionsPanel { ...props } />\n                    </>\n                ) }\n                <BlockEdit { ...props } />\n            </>\n        );\n    },\n    'withToolbarControls'\n);\n\nAt this moment it is not possible to apply just a condition because the block-editor module does not export all the components used in here. E.g:\nColorEdit\nReplicating the Logic of those components is not ideal.\nAny help would be great\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405091", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce Variable Product Dropdown for Custom Shop Template I'm building out a custom shop template and I'm trying to achieve something like this.\n\nWhere the user can choose the product variation in the dropdown, choose quantity, and click add to cart without redirecting using AJAX.\nThis got me close to what I was trying to achieve, but I can figure out how to add the quantity option, and it would also redirect to the product page after adding to cart.\nI appreciate any help!\n<?php\n\n /**\n * Replace add to cart button in the loop.\n */\nfunction iconic_change_loop_add_to_cart() {\n    remove_action( 'woocommerce_after_shop_loop_item', 'woocommerce_template_loop_add_to_cart', 10 );\n    add_action( 'woocommerce_after_shop_loop_item', 'iconic_template_loop_add_to_cart', 10 );\n}\n\nadd_action( 'init', 'iconic_change_loop_add_to_cart', 10 );\n\n/**\n * Use single add to cart button for variable products.\n */\nfunction iconic_template_loop_add_to_cart() {\n    global $product;\n\n    if ( ! $product->is_type( 'variable' ) ) {\n        woocommerce_template_loop_add_to_cart();\n        return;\n    }\n\n    remove_action( 'woocommerce_single_variation', 'woocommerce_single_variation_add_to_cart_button', 20 );\n    add_action( 'woocommerce_single_variation', 'iconic_loop_variation_add_to_cart_button', 20 );\n\n    woocommerce_template_single_add_to_cart();\n}\n\n/**\n * Customise variable add to cart button for loop.\n *\n * Remove qty selector and simplify.\n */\nfunction iconic_loop_variation_add_to_cart_button() {\n    global $product;\n\n    ?>\n    <div class=\"woocommerce-variation-add-to-cart variations_button\">\n        <button type=\"submit\" class=\"single_add_to_cart_button button\"><?php echo esc_html( $product->single_add_to_cart_text() ); ?></button>\n        <input type=\"hidden\" name=\"add-to-cart\" value=\"<?php echo absint( $product->get_id() ); ?>\" />\n        <input type=\"hidden\" name=\"product_id\" value=\"<?php echo absint( $product->get_id() ); ?>\" />\n        <input type=\"hidden\" name=\"variation_id\" class=\"variation_id\" value=\"0\" />\n    </div>\n    <?php\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405092", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: order the meta query results by 2 custom fields I have a custom post type 'brewery', I want to fetch results by 2 custom fields. The desired result is to get all posts with highest review rating (value is in decimal like 4.2 or 4.8) and if few posts have same review rating then I want to sort the results by review count (value is numeric and can be any number like 5, 400 or even 2500).\nExample:\nPost 1 -> Review rating = 4.8 & Review Count = 2500\nPost 2 -> Review rating = 4.8 & Review Count = 1500\nPost 3 -> Review rating = 4.5 & Review Count = 3500\nPost 4 -> Review rating = 4.5 & Review Count = 3000\nThe below code is sorting the results only by review rating and not by review count. Can somene please let me know what is wrong with the code or if there is something that I am missing?\nAlso, please find the attached screenshot of results.\n\n$args = array(  \n    'post_type' => 'brewery',\n    'post_status' => 'publish',\n    'posts_per_page' => -1, \n    'meta_query'     => array(\n        'review_rating_meta' => array(\n            'key' => 'review_rating',\n        ),\n        'reveiw_count_meta' => array(\n            'key' => 'reveiw_count',\n        ),\n    ),\n\n    'orderby'    => array(\n        'review_rating_meta' => 'DESC',\n        'reveiw_count_meta' => 'DESC',\n    )\n);\n\n\nA: You forgot to use relation in meta_query .\nI think this will work:\n$args = array(  \n    'post_type' => 'brewery',\n    'post_status' => 'publish',\n    'posts_per_page' => -1, \n    'meta_query'     => array(\n    'relation' => 'AND',\n        'review_rating_meta' => array(\n            'key' => 'review_rating',\n        ),\n        'reveiw_count_meta' => array(\n            'key' => 'reveiw_count',\n        ),\n    ),\n\n    'orderby'    => array(\n        'review_rating_meta' => 'DESC',\n        'reveiw_count_meta' => 'DESC',\n    )\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405093", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there any way to store single.php wordpress file into a php variable I am finding an way to store single.php file in a variable in wordpress file, I want to use preg_match_all to this file.\n$regex = \"~(<h([2-6]))(.*?>(.*)<\\/h[2-6]>)~\";\n$singlefile= single.php\n\npreg_match_all($regex, $singlefile, $heading_results);\n\nCan anyone tell me proper way to do this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405094", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Cannot Set Custom Permalinks for Multisite Post Migration I recently migrated my mutlisite to a new host and I run into a strange issue, that prevents me from setting custom permalinks.\nCurrently, my multisite (and subsites) have all been switch to to the \"Plain\" option\nhttps://example.test/?p=123\n\nHowever, whenever I switch to my desired custom permalink:\nhttps://example.com/%postname%/\n\nI can still access each multisite/subsite homepage, but the secondary links are all broken.    \\But if I use:\nhttps://example.com/index.php/%postname%/ \n\nall of the links will work.  I mention this because I have recently noticed \"index.php\" appearing in various directories of wp install.\nIs this some security requirement that I wasn't aware of ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405095", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress cannot auto update and cannot find .maintenance file i recently installed wordpress manually on a linux cloud machine via DigitalOcean which I migrated from a previous hosting service.\nBut now there is a warning up top of my Settings page that says \"An automated WordPress update has failed to complete - please attempt the update again now.\"\nI have been looking for a solution but the only ones i can find is to delete the wp-content/upgrade/ folder and .maintenance file. The former I have deleted and the latter I could not find under /usr/share/wordpress. And yet I still get this error (and the current version of my WordPress seems to be 5.3.2 when the newest is 5.9.3 according to this site: https://en-ca.wordpress.org/download/)\nWould anyone be able to advise on what to do to resolve this...?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405096", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Need help with creating a searchable user data by name or specific number like ID Thanks for this gift. Here is my issue, i wish to be able to add users profiles to my wordpress company site in which we register the users name and other details as need be. The purpose for this is that we safe files for customers and i want to register all user data accordingly then provide a search form where the users or myself can enter their name or a unique code or id which should display their complete information once the enter button is pressed. The customer doesnt have to create the profile by themselves in a registration manner, i want this information to be added from the backend or however possible without the customer expected to register on site.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405097", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get List of Terms based on a given term (different taxonomy) I have two taxonomy and a post type.\n\n*\n\n*Post type: Employee (employee)\n\n\n*Taxonomy: Location (term example chicago, id 1)\n\n\n*Taxonomy: Job Title (job-title)\nI want to list all job title based on a particular location. If CPT not available on that location the job title shouldn't be added.\nI have tried to use WP_Term_Query() and wp_terms() but haven't found a way.\n\nA: You will need a two step process for that.\n\n*\n\n*Get all the posts from the location (Using WP_Query(). You will only need the ID of the posts, so get_posts() will do too.),\n\n*Now use wp_get_post_terms() to retrieve the job titles from the posts.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405099", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display list of only specific tags on product Good afternoon,\nI know I'm doing this wrong, looked at all the other questions but can't get it figured out.  I have a tag list with images assigned that are displayed in a separate area of my site. I don't want to display all the tags assigned to the product, only the specific tags; they are TAG1, TAG2, and TAG3.  I attempted to put the below <<< >>> in to see if it would work but to no avail. My best guess is I need to create an array to put the tag names in and inject them into the loop a different way.\nThanks in advance\n    public function shortcode_custom_tags() {\n    if ( is_product() || is_shop() ) {\n\n        ob_start();\n\n    \n        global $product;\n        //var_dump($product);\n        $product_tags = get_the_terms( $product->get_id(), 'product_tag' );\n\n        if ( ! is_array( $product_tags ) ) {\n            return $product_tags;\n\n        }\n        ?>\n    <div class=\"img-listings\">\n        <label style=\"font-weight: bold; font-size: 16px;\">Works with</label>\n        <ul>\n            <?php\n            foreach ( $product_tags as $product_tag ) {\n        <<<<<<if ( $product_tag->slug = [\"TAG1, \"TAG2\", \"TAG3\"]) {>>>>\n                $img_url = get_option( 'z_taxonomy_image' . $product_tag->term_id );\n\n                $this->format_setting( $product_tag->name, $img_url, $product_tag->term_id );\n            <<<}>>>\n            }\n            ?>\n        </ul></div>\n            <?php\n    } else {\n        return;\n    }\n    return ob_get_clean();\n}\n\n\nA: First: you're using = which assigns a value; use == to compare the values (or === to compare strictly, ie, match both the value and the type).\nSecond: Your code snippet shows that you've mismatched the \"s in the array, which should probably result in a PHP fatal error. I'm assuming that's an error in the posted code but not in your production code.\nFinally: your comparison will only work if $product_tag->slug matches the entire array shown. If you only want to check if $product_tag->slug matches one of the items in the array, you'll need to use in_array().\neg:\nif ( in_array( $product_tag->slug, [\"TAG1\", \"TAG2\", \"TAG3\"] ) ) {\n    $img_url = get_option( 'z_taxonomy_image' . $product_tag->term_id );\n\n    $this->format_setting( $product_tag->name, $img_url, $product_tag->term_id );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405105", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Images not uploading on product page of woocommercr Images on showing on product page and also on all product list.\n\nProduct image not showing\nenter image description here\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405107", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How Do I Redirect Wordpress Pages but not posts? I have a client that changed jobs. He wants to redirect all pages on the wordpress site to a specific page on that site. But he also wants to keep all the SEO from the blog posts. So I need all the blog posts to show up, but redirect any old pages to the new page. So, for example:\noldpage.com > oldpage.com/specificpage\nso anything that is not a blog post goes to oldpage.com/specificpage\nthe blogpost would go to blogpost\nI am able to redirect everything to oldpage.com/specificpage\nI have excluded the homepage and /wp-admin/ etc.\nBut there are over 4,000 posts and to redirect each one individually is impractical\nIs there a way to redirect everything except the posts through .htaccess?\n\nA: You can either add the following code to your functions.php or create a custom plugin with the code.\nfunction my_custom_page_redirect() {\n  if (is_page()) {\n    wp_redirect(home_url());\n    exit;\n  }\n}\nadd_action('template_redirect', 'my_custom_page_redirect');\n\nNote - change the URL in wp_redirect() to whatever the 'specificpage' is. I just used home_url() in the redirect as an example.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405110", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Custom SQL Table with UserID Filter for results UPDATE: I have realised that I need to use a plugin like PHP Snipping or Insert PHP to make this work, I have updated my screen shots to reflect where Im upto from my research.\nThe code is working and outputting the right User ID but the SQL is not echoing the Table data, if you have some advice on where I might of gone wrong would be great.\n<?php\nglobal $wpdb;\n$uid = get_current_user_id();\n\n$sql = $wpdb->prepare(\"SELECT * FROM  sr3_characters WHERE wp_id = $uid\" );\n$results = $wpdb->get_results( $sql);\n?>\n<html>\n<body>\n<table border=\"1\">\n<tbody>\n<tr>\n<th>Name</th>\n<th>Race</th>\n<th>Gender</th>\n<th>Age</th>\n</tr>\n<tr>\n<td><?php foreach ($results as $value) { echo \"$value->char_name<br>\"; }; ?></td>\n<td><?php foreach ($results as $value) { echo \"$value->char_race<br>\"; }; ?></td>\n<td><?php foreach ($results as $value) { echo \"$value->char_gender<br>\"; }; ?></td>\n<td><?php foreach ($results as $value) { echo \"$value->char_age<br>\"; }; ?></td>\n</tr>\n</tbody>\n</table>\n</body>\n</html>\n\n\n\n\n\n\n\n\nA: The evolution of this question makes it difficult to succinctly answer, but in brief summary:\n\n*\n\n*Using $wpdb->prepare() to construct arbitrary SQL queries to execute against the database helps to mitigate injection vulnerabilities by escaping inserted variables. To use it, instead of concatenating or directly inserting variables into the query, use a placeholder for the appropriate type of data, then pass the variable which be inserted in that location in a respectively indexed array as the second argument.\n\n*If this character data is input by end-users, you should also consider sanitizing the inputs prior to inserting them into the database, and possibly escaping the values prior to displaying them on the front-end to further mitigate the risk of injection vulnerability and to prevent end users from displaying arbitrary HTML/JavaScript when their character data is displayed.\n\n*Queries executed via $wpdb->get_results() return an array of objects, with the properties on the objects being named after the columns in the SQL table. If you prefer to work with arrays instead (either associative or numerically indexed) you can change this behavior by passing one of the predefined constants in as the second argument.\n\n*When printing a non-primative data structure such as an object, PHP won't automatically serialize the object into a string for display. print_r() is capable of printing most common data structures, but var_dump() is a invaluable development aide when you're not sure of the type of the value.\n\nAll of that said, since each object in the array represents one row from your database table and since HTML tables are constructed one row at a time, you can simply use a single foreach loop to place the relevant values from each item into a cell:\n<?php\nglobal $wpdb;\n$uid = get_current_user_id();\n\n$sql = $wpdb->prepare( \"SELECT * FROM `sr3_characters` WHERE `wp_id` = %s\", array( $uid ) );\n$results = $wpdb->get_results( $sql );\n?>\n<html>\n<body>\n  <table border=\"1\">\n    <thead>\n      <tr>\n        <th scope=\"col\">Name</th>\n        <th scope=\"col\">Race</th>\n        <th scope=\"col\">Gender</th>\n        <th scope=\"col\">Age</th>\n      </tr>\n    </thead>\n    <tbody>\n      <?php foreach( $results as $row ) { ?>\n      <tr>\n        <th scope=\"row\"><?php echo esc_html( $row->char_name ); ?></th>\n        <td><?php echo esc_html( $row->char_race ); ?></td>\n        <td><?php echo $row->char_gender; ?></td>\n        <td><?php echo $row->char_age; ?></td>\n      </tr>\n      <?php } ?>\n    </tbody>\n  </table>\n</body>\n</html>\n\n\nA: Without seeing the values of your custom table, wp_get_current_user() is probably returning the wrong user compared to what is in your table. Assuming this is running on the frontend, and you want to check the current user, it would be better to use get_current_user_id() and parse that to your query.\nI would also suggest that you sanitise all your queries before putting them through get_results. See here https://codex.wordpress.org/Data_Validation#Database\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405113", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: AJAX function running TWICE with WordPress admin-ajax.php I have a form submit event that calls a WordPress ajax function. The form submit event occurs only once (It is correct as expected). But the ajax function loaded TWICE (expected to occur once).\nHere is a sample of my code.\n#Jquery\n$('#my_form').submit(function () {\n        console.log(\"This log print ONCE\");\n        var name = $('#name').val();\n        var email = $('#email').val();\n        $.ajax({\n            type: 'post',\n            url: '/wp-admin/admin-ajax.php',\n            data: {\n               action: 'my_ajax_function',\n               name: name,\n               email: email,\n            },\n            dataType: \"json\",\n            success: function (data) {\n                $('#response').html(data.message);\n            }\n        });\n        return false; //  to prevent default form submit;\n    });\n\n#WordPress functions.php\n<?php\nfunction my_ajax_function() {\n    custom_log(\"This log print TWICE\"); \n\n    $name = (isset($_POST[\"name\"])) ? $_POST[\"name\"] : '';\n    $email = (isset($_POST['email'])) ? $_POST['email'] : '';\n\n    // call to a function to encrypt data\n    encrypt_data($name, $email);\n  \n    // send response back to ajax\n    $result['type'] = \"success\";\n    $result['message'] = \"Email sent successfully\";\n    json_encode($result);\n    echo $result;\n    die();\n}\n\nadd_action('wp_ajax_nopriv_my_ajax_function', 'my_ajax_function'); \nadd_action('wp_ajax_my_ajax_function', 'my_ajax_function');\n?>\n\nAjax functionality is worked. But the \"encrypt_data\" function called twice. (I have created a log function custom_log in my_ajax_function and it also get printed twice).\nNb: I have checked the Network tab in inspect mode. The my_ajax_function action called only once in network tab.\nWhy the ajax function loading multiple times (twice) ? Is there anything I am missing?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405119", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: ACF: replace comma with another sign I am using ACF.\nI am using this function to display numbers in number fields in this way 1,000.00\n// Return ACF Number Fields Formatted with Commas on the Frontend\nadd_filter('acf/format_value/type=number', 'acf_number_comma_decimal', 20, 3);\n\n// Without Decimal\nfunction acf_number_comma($value, $post_id, $field) {\n$value = number_format(floatval($value));\nreturn $value;\n}\n// With Decimal\nfunction acf_number_comma_decimal($value, $post_id, $field) {\n$value = number_format(floatval($value), 2);\nreturn $value;\n}\n\nI would like to replace the \u201d , \u201d with this \u201d \u2018 \u201d so the value will be displayed in this way: 1\u2019000.00.\nHow can i achieve that?\n\nA: Modify the following line in your function:\n$value = number_format(floatval($value), 2);\n\nTo include another two arguments from the number_format() function - namely the decimal separator (set to a dot) and the thousands separator (set to an apostrophe)\n$value = number_format(floatval($value), 2, \".\", \"'\");\n\nSo in total this line says: format the number (after floating it to an integer) to two decimal places using a dot to separate decimals and an apostrophe to separate the thousands.\nOnline demo: https://shorturl.at/twFWX\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405121", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Woocommerce. Get a list of products in the current category on the archive page and product page I'm trying to create a small code that will display a list of discounted products that belong only to the category of products that the user is on, that is, if the user is on the clothing category page, then the code should display only discounted products from the clothing category, I also want the code to work on the product page. For now, here's what I got.\n$args = array(\n    'post_type'      => 'product',\n    'posts_per_page' => '5',\n    'product_cat'    => 'clothes',\n     );\n                            \n$args['order'] = 'ASC';\n$args['orderby'] = 'popularity';\n$products = wc_get_products( $args );\n$product->get_id();\n$loop = new WP_Query( $args );\n                            \nwhile ( $loop->have_posts() ) : $loop->the_post();\n       global $product;\n       echo '<div class=\"image_product_list\"><a class=\"image_product_list\" href=\"'.get_permalink().'\">' . woocommerce_get_product_thumbnail().'</a></div>';\n       echo '<br /><a class=\"product_title_list\" href=\"'.get_permalink().'\">' .get_the_title().'</a>';\n       echo '<br /><a class=\"product_price_list\" href=\"'.get_permalink().'\">'. $product->get_price_html().'</a>';\nendwhile;\n                            \nwp_reset_query();\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405122", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Password protect URLs I have a Wordpress site set up with download links that either could be set as external URLs or links to media items uploaded to Wordpress. I would like to password protect these, so clicking a download link would prompt you with an input field for a password, and when entering the correct password, you would be redirected to the external URL or the WP media URL. This should not be connected to user authentication, so you should be able to click these links as a logged out user and as long as you know the password, it should be possible to download them. How would you suggest doing this?\nIt would not be possible of course to directly password protect an external link, you would still be able to visit the link directly from the moment you know what the protected URL is, but it would at least hide the URL for users that don't know the password until they've entered the correct one.\nCurrently I don't have any concrete code for this, but I have one concept for a method that I'm thinking could work and would like to get your opinion on this.\nI'm thinking that one solution could be to use some kind of encode/decode function that is based on the password. The password could for example be set using ACF on an option page in the admin. So the download link would then for example be https://domain.com/download/?link=<DECODED URL> and if you enter the correct password and submit, some PHP code connected to the form of the password input would decode the link parameter using the password as the salt/key for the decoding and then redirect you to that URL. Do you see any problems with this method?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405123", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Help with htaccess querystring rewrite Been working on a solution to remove odd query strings from pages after search engines keep adding them at random. I have a solution that semi works, but I would ideally like to see it clear them all. Right now the code I have is this:\n<IfModule mod_rewrite.c>\nRewriteEngine On\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /index.php [L]\n</IfModule>\n\n<IfModule mod_rewrite.c>\nRewriteEngine on\nRewriteCond %{QUERY_STRING} ^(.*)&?sort=[^&]+&?(.*)$ [NC]\nRewriteRule ^/?(.*)$ /$1?%1%2 [R=301,L]\n</IfModule>\n<IfModule mod_rewrite.c>\nRewriteEngine on\nRewriteCond %{QUERY_STRING} ^(.*)&?order=[^&]+&?(.*)$ [NC]\nRewriteRule ^/?(.*)$ /$1?%1%2 [R=301,L]\n</IfModule>\n\n<IfModule mod_rewrite.c>\nRewriteEngine on\nRewriteCond %{QUERY_STRING} ^(.*)&?m=[^&]+&?(.*)$ [NC]\nRewriteRule ^/?(.*)$ /$1?%1%2 [R=301,L]\n</IfModule>\n<IfModule mod_rewrite.c>\nRewriteEngine on\nRewriteCond %{QUERY_STRING} ^(.*)&itemid[^&]+&?(.*)$ [NC]\nRewriteRule ^/?(.*)$ /$1?%1%2 [R=301,L]\n</IfModule>\n\n<IfModule mod_rewrite.c>\nRewriteEngine on\nRewriteCond %{QUERY_STRING} ^(.*)&amp[^&]+&?(.*)$ [NC]\nRewriteRule ^/?(.*)$ /$1?%1%2 [R=301,L]\n</IfModule>\n\nI am very open to suggestion to clean things up and make a much more optimized solution.\nthanks in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405127", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: do_blocks does not include its CSS I have a template where I must use the do_blocks function.\nIt works fine in the HTML sense, but it seems to just not load the CSS related to the block.\nIs there a way to force it to load the CSS of the blocks you call with do_blocks?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405133", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is it possible to embed a wordpress tag page on wordpress? I'm trying to use the \"Embed URL\" block to include another WP site's tag page on my WP page.  It seems like I'm able to embed individual posts from that site (so the theme supports embedding) but I get the error \"Sorry, this content could not be embedded.\" when I try to use the tag page url.  Is it possible to embed a tag page?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405137", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show index.php template instead of 404 page template I have some posts that were permanently deleted, however, instead of wordpress returning the 404.php page template, it is returning the index.php template. In other posts, the behavior is right, but in some like this it is not\nWhat I've done so far:\n\n*\n\n*theme change to twenty-two\n\n*I updated the permalink structure\n\n*I cleaned the database with the advanced database cleaner plugin.\n\n*There is no cache\n\nHowever, nothing resolved. You can see below the template shown and the correct status which is 404.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405138", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Pagination not working on custom post types with rewrite slug I've been trying to fix my pagination to work on custom post type slugs for example article/post-title/page/2 it just keeps showing the first page's results, the URL is changing but the posts remain the same\nMy post type has rewrite slugs written like this\n'rewrite'       => ['slug' => 'article'],\n\nThis is the query I used\n$paged = ( get_query_var('paged') ) ? get_query_var('paged') : 1;\n    $args = [\n        'numberposts' => -1,\n        'post_type' => $post_type,\n        'posts_per_page' => $post_per_page,\n        'post_status' => 'publish',\n        'paged' => $paged,\n        'orderby' => [\n            'date' => 'ASC'\n        ]\n    ];\nreturn new \\WP_Query($args);\n\nThis is the paginate link I used\n$total_pages        = $query->max_num_pages;\n    $current_page = max(1, get_query_var('paged'));\n\n    return paginate_links(array(\n        'base' => get_pagenum_link(1) . '%_%',\n        'format' => 'page/%#%',\n        'current' => $current_page,\n        'total' => $total_pages,\n        'prev_text'    => __('\u00ab prev'),\n        'next_text'    => __('next \u00bb'),\n    ));\n\nIt's working on a normal page but on the post type it kept refreshing the page so I used these rewrite rules which now change the URL but it still shows the same results(cleared permalinks and all that too)\nadd_action('init', function() {\n\n            add_rewrite_rule( \"^article/([^/]+)/?\", 'index.php?post_type=article&name=$matches[1]', 'top' );\n            add_rewrite_rule( \"([^/]+)/page/([0-9]{1,})/?$\", 'index.php?pagename=$matches[1]&paged=$matches[2]', 'top' );\n            add_rewrite_rule(\"article/([^/]+)/page/?([2-9][0-9]*)\",\n                \"index.php?post_type=article&author_name=\\$matches[1]&paged=\\$matches[2]\", 'top');\n            add_rewrite_rule(\"article/([^/]+)\",\n                \"index.php?post_type=article&author_name=\\$matches[1]\", 'top');\n    });\n\nTried different rewrite rules but nothing was working these were the latest ones I tried and the URL is changing with these but the results remain the same\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405139", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show an admin menu item in Editor role I am new to Wordpress and would like to know how to add a specific admin menu item to the role Editor (in this case it is \"User Login History\"). This plugin shows its name for Administrator but not for Editor\nPlease help\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405140", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to set a template with wp_insert_post I'm trying to set my template to the Elementor Canvas when using wp_insert_post but it isn't working. It is creating the new page fine but not using the canvas. What am I doing wrong?\n{\n\"action\": \"create_post\",\n\"post_author\": \"<authorID>\",\n\"post_content\": \"<post content>\",\n\"post_title\": \"Leave us a Review\",\n\"post_status\": \"publish\",\n\"post_type\": \"page\",\n\"comment_status\": \"closed\",\n\"post_name\": \"<post-name>\",\n\"page_template\": \"elementor_canvas\"\n\n}\n\nA: You can check this code  I am able to work with this\nfunction cutom_function() {\n\n    $new_page_id = wp_insert_post( array(\n        'post_title'     => 'PKB',\n        'post_type'      => 'page',\n        'post_name'      => 'pkb',\n        'comment_status' => 'closed',\n        'ping_status'    => 'closed',\n        'post_content'   => '',\n        'post_status'    => 'publish',\n        'post_author'    => get_user_by( 'id', 1 )->user_id,\n        'menu_order'     => 0,\n        // Assign page template\n        'page_template'  => 'pratik.php'\n    ) );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405141", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get an attachment id from a filename I have not been able to find a reliable solution for how to lookup the id for attachments in the media library from a filename as Wordpress does not appear to provide such a function.\nMost solutions rely on searching the GUID field in various tables, however there are issues with attachments uploaded with greater than 2560px resolution. Wordpress appends '-scaled' to the filename returned by functions like get_attached_file(), but this is not reflected in the guid database column.\nI'd be grateful for a generic function that returns the attachment id when given a filename.\n\nA: I worked this out eventually by tracing through the code for get_attached_file() to see where it was getting the filename from, and reverse engineered the following:\nfunction get_attachment_id_by_filename($filename) {\n    global $wpdb;\n    $sql = $wpdb->prepare(\"SELECT * FROM  $wpdb->posts WHERE  post_type = 'attachment' and guid like %s order by post_date desc\", \"%$filename\");\n    $attachments = $wpdb->get_results($sql, OBJECT);\n    return $attachments[0]->ID ?? false;\n}\n\nNote that it is possible the query will return more than one row if the same file basename exists in different media library folders.  This routine will however only return the most recent found.\nThis works for everything I can throw at it so far, but welcome any issues people may be aware of with this solution.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405145", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Custom Block Not Shown in Block Inserter I am attempting to create a new custom block plugin in Wordpress v5.9.3. I'm following this Wordpress guide on creating a simple block. My block does not appear when I search for it in the Block Inserter, however.\nTo try to rule out anything I may have done incorrectly I used the default Twenty Twenty Two theme and added the '01-basic' example provided in the Wordpress Gutenberg Examples to the plugins folder. Note that the basic example does not require a build step. I activate the plugin, but again find that as with my code the block does not appear in the Block Inserter (e.g. searching for \"example\").\nThis question is similar, but the official block registration method has apparently changed since then, and the question was unresolved.\nThis has been very frustrating, especially since even the official example does not work for me.\nThank you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405148", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ACF: Update field value based on value of another field I have some custom posts that lists cars, motorcycles and trucks.\nThe values in the ACF fileds are automaticaly populated and I cannot change them manually because they come from an external software.\nIn this CPT I have 2 ACF fields (both are text fields):\n\n*\n\n*one called \u201cCategroy\u201d that can be Cars, Motorcycle, Truck.\n\n\n*Another one called \u201cService\u201d, that can be a value from 1 to 9.\nAs you can see the \u201cobjects\u201d can have different Categories but they maybe share the same \u201cService\u201d.\nFor example:\nCategroy = Car\nService = 9\nCategory = Truck\nService = 9\nI would like to update the value of the ACF Field \u201cService\u201d based on the value in \u201cCategory\u201d.\nFor example:\nif Category is \u201cCar\u201d and the Service is 9, then 9 should be udpated in \u201cRent\u201d\nif Categroy is \u201cTruck\u201d and Service is also 9, then 9 should be udpated in \u201cBuy\u201d\nHow can I achieve that?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405149", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Load JavaScript on specific page with @wordpress compiler I'm new to WordPress development.\nI have been following a tutorial in Udemy to build my new WordPress website. As recommended by the trainer, it is useful to use npm to package the JavaScripts using \"@wordpress/scripts\". The npm command monitors a single index.js file, which is then compiled into WordPress friendly version. Then in functions.php I added the wp_enqueue_script() function to call the index.js from build folder.\nThe problem: I have created multiple JavaScript files, which contain new classes with the required code and are imported into the main index.js file. Each parent JavaScript file is responsible for a specific functionality, e.g. I have MyLogin.js file which is responsible for handling user login and another file EditProfile.js which handles user profile editing functionality. The EditProfile.js should be called/instantiated only when the user is logged in and the MyLogin.js should be called/instantiated only when user is not logged in. According to the articles I have read online, I can use functions.php to enqueue specific JavaScript files when a user is on a specific page. This would work if I would not use the npm to package my JavaScripts into a single file, but how do I handle the load of required JavaScript files from a single bundled index.js file?\nThe only solution I thought of, was to create an evaluation statement in the index.js file to only call/instantiate the required class if the current page is home page or profile page respectively, but to me it seems as a bad coding practice.\nCan you please guide me to the right direction?\nP.S. Is it even worth to use \"@wordpress/scripts\" to compile everything into a single file?\nHere is my index.js file\nimport \"../css/general.css\";\nimport \"../css/style.css\";\nimport \"../css/queries.css\";\nimport \"../css/profile.css\";\nimport \"../css/login.css\";\nimport \"../css/front-page.css\";\n\nimport EditProfile from \"./modules/EditProfile\";\nimport MyLogin from \"./modules/MyLogin\";\n\nconst myLogin = new MyLogin();\nconst editProfile = new EditProfile();\n\nThe logic I was thinking of would be something like this:\nimport \"../css/general.css\";\nimport \"../css/style.css\";\nimport \"../css/queries.css\";\nimport \"../css/profile.css\";\nimport \"../css/login.css\";\nimport \"../css/front-page.css\";\n\nimport EditProfile from \"./modules/EditProfile\";\nimport MyLogin from \"./modules/MyLogin\";\n\nif (window.location.href == \"https://<site_url>\") {\n  const myLogin = new MyLogin();\n}\n\nif (window.location.href == \"https://<site_url>/profile\") {\n  const editProfile = new EditProfile();\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405150", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Type character in name and make it invisble my website is using MyHome theme. I need to write identical names for two search fields.\nHere - https://komand.suvenirite.net/dava-pod-naem/?offer-type=rent\nAnd here- https://komand.suvenirite.net/prodava-offer-typesalecitygrad-sofia/?offer-type=sale\nUnder the search field \"\u0412\u0418\u0414 \u041d\u0410 \u0418\u041c\u041e\u0422\u0410\" (the first one)\nThe need for that is that the system gets confused if there are identical names even thought their parent fields are different, but for the client they need to appear the same.\nYes, I have tried changing the structure, but of no use. The client is unbeatable.\nAdding simple invisible character does not work. Adding space or removing the \"-\" does not work either. It should be drastic change in the name for the theme to accept it.\nWhat I have achieved until now with some javascript and css:\njQuery.fn.highlight = function (str, className) {    \n    var regex = new RegExp(str, \"gi\");\n\n    return this.each(function () {\n        this.innerHTML = this.innerHTML.replace(regex, function(matched) {return \"<span class=\\\"\" + className + \"\\\">\" + matched + \"</span>\";});\n    });\n};\n\n$(\"span\").highlight(\"___\",\"highlight\");\n\nCSS\nspan.highlight {\n   color:#FFF;\n    visibility: hidden!important;\n    display: none!important;\n}\n\nThis doesn't work :\nbutton.btn.dropdown-toggle.btn-default span.filter-option.pull-left span.highlight {\n   color:#FFF;\n    visibility: hidden!important;\n    display: none!important;\n}\n\nHere it can be seen how it works - https://komand.suvenirite.net/dava-pod-naem/?offer-type=rent\nUnder the field \u0412\u0418\u0414 \u041d\u0410 \u0418\u041c\u041e\u0422\u0410 > 1-\u0441\u0442\u0430\u0435\u043d___\nAs \"___\" these characters should not be seen but when active they are.\nPlease, can anyone help me?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405151", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change default Video Player without Plugin We all know there are various types of plugins to EMBED Video Players.\nMy issue is, that I have a Theme, which links the Videos only with a link and not with some kinda Plugin. Is there any possible way to change the default Video Player Design hardcoded ? I didn't find a solution in the WWW.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405155", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP_Query order posts by category In a custom WP_Query I want to order posts by category. I mean that I want to show posts with term_id=1291 first and then show other posts.\nwhen I use two WP_Query , I cant use pagination.\n\"edited\"\nI tried this at first. I thought when I use post__in, wp_query ,keep posts order in post__in.\n$c_cat=$_GET[\"c_cat\"]\n$query1 = new WP_Query(array(\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'category',\n            'field'    => 'term_id',\n            'terms'    => $c_cat,\n        )\n    )\n));\n\n$query1_ids=array();\nforeach ($query1->posts as $p){\n    array_push($query1_ids,$p->ID);\n}\n\n//new query, using post__in parameter\n$finalQuery = new WP_Query(array('post__in' => $query1_ids));\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405156", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: The Global Styles missing I am working on my first block-based theme, and trying to leverage theme.json as much as possible.\nI would like to allow client to change the the fonts, colors and other variations defined in the theme.json globally, for the whole site, and in the tutorials over the net I saw this can be done in the Global Styles menu.\nBut, I don't see Global Styles menu in any of the block-based WP sites I have access to, including the Gutenberg demo site.\nWhat am I missing? Is Global Styles feature deprecated? If not, how can I find / enable it?\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405158", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Creating dynamic content and pages for 1000's of locations How can I generate dynamic pages on a Wordpress website from information provided in a separate MySQL database?\nI have a database with Locations and I would like to have a page for each of these created dynamically. For example, I have a database entry for LOCATION1. If the location exists in the database, I would like a page such as www.example.com/LOCATION1/ and for the content to be dynamic, using information from the database.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405159", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add starts rating in woocommerce product comment from backend I collect reviews from different websites and I would like to be able to add them manually to my products in woocommerce, how can I add the star rating from the back office over the text? in the comment there is no metabox of the choice.\nI searched for this information and the only document found is this woocommerce report in the issue sections:\nhttps://github.com/woocommerce/woocommerce/issues/25656\ncan you help me understand how to add the rating change from the backoffice on new comments?\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405160", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Programatically upload a file to be stored inside blob field in database, NOT on filesystem old php developer here,  very.. very new to WP, so be kind.\nAs part of a plugin, I am trying to allow files to be uploaded with the intended destination storage in a specific table. I have the following code which works fine (almost).\n    // File handing preparation. Count how many files were uploaded\n    $wx_countFiles = count($_FILES['file']['name']);\n\n    // For each uploaded file, process them accordingly\n    for($i=0; $i<$wx_countFiles; $i++) {\n\n        // Assign values required\n        $wx_fileName = $_FILES['file']['name'][$i];\n        $wx_fileMime = $_FILES['file']['type'][$i];\n        $wx_fileSize = $_FILES['file']['size'][$i];\n        $wx_tmpf = $_FILES['file']['tmp_name'][$i];\n        $wx_file = fopen($_FILES['file']['tmp_name'][$i], \"rb\");\n\n        // Setup out allowed filetypes here\n        $wx_allowed_filetypes = array('doc', 'docx', 'pdf', 'png', 'jpg', 'jpeg', 'gif');\n\n        // Perform error/size checking\n        $wx_upload_error = null;\n        if(!in_array(strtolower(end(explode('.', $_FILES['file']['name'][$i]))), $wx_allowed_filetypes)) { $wx_upload_error .= \"This filetype is not permitted<br>\"; }\n        if($wx_fileSize > 15360000) { $wx_upload_error .= \"File is too large<br>\"; }\n        if($wx_fileSize == 0) { $wx_upload_error .= \"The file is corrupted - 0 bytes<br>\"; }\n        if($_FILES['file']['error'][$i] != UPLOAD_ERR_OK) { $wx_upload_error .= \"There was an upload error<br>\"; }\n\n        if($wx_upload_error == null) {\n\n            //$wpdb->query(\"INSERT INTO $tbl_docs(userID, dataID, fileName, fileMime, fileSize, dateUploaded, file) VALUES('$user_id', '$wx_dataID', '$wx_fileName', '$wx_fileMime', '$wx_fileSize', '$record_date', '$wx_file')\");\n\n        }\n\nThe $wx_dataID value is set just a fraction earlier on in the process via a $wx_dataID = $wpdb->insert_id; step so that all the files associated with the upload are connected to entries in another table.\nOn post, all fields are filled correctly except the file input, which seems to just contain \"Resource id #741\" instead of the binary file within the assigned mediumblob cell. I have this system working perfectly using PDO prepare statements on another, non-WP system. I know WP prefers to utilise it's uploads director for this sort of thing, however for sync reasons these files need to be saved into the DB, not into the FS. Can anyone turn some light on how to do this for me? Thanks!\nWorking on DevKinsta, MariaDB, WP 5.9.2\n\nA: After some further experimenting and talking to a colleague, we found the answer (team effort!) altering how the file handler deals with the file content.\n        // Assign values required\n        $wx_fileName = $_FILES['file']['name'][$i];\n        $wx_fileMime = $_FILES['file']['type'][$i];\n        $wx_fileSize = $_FILES['file']['size'][$i];\n        $wx_tmpf = $_FILES['file']['tmp_name'][$i];\n        //$wx_file = fopen($_FILES['file']['tmp_name'][$i], \"rb\");\n        $wx_file = base64_encode(file_get_contents($_FILES['file']['tmp_name'][$i]));\n\nBasically replacing fopen() with file_get_contents() and base64 encoding the stream. This worked (finally, yay!)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405161", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Mailing list submission from a post that doesn't have a form on it I've received a mailing list submission from a blog post page on my WP site which doesn't currently show any forms. Any ideas how this could have happened?\nWhen I log in to the WP admin, go to Forms, and click on the form which the sign-up came from, I can see the embed URL, but there is no form visible there.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405165", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Download file and redirect to page or vice versa I have a Wordpress site with a custom post type called downloads. The post type has a file field added to it with Advanced Custom Fields (ACF). The downloads post type is used for download links spread across the site and I want them to sometimes be password protected using the native password protection of pages in Wordpress.\nWhen clicking a link to a downloads post type, you're directed to www.domain.com/?downloads=<NAME OF POST>&redirect=<CURRENT URL>. If the download is password protected, you need to enter the correct password and then click \"Enter\".\nWhat I then want is for the visitor to automatically download the file connected to the post and be redirected to the page where the download link was clicked initially. The order of this is not really important, as long as the file is being downloaded when entering the correct password and that you are redirected to the URL you was on before.\nThe redirect to the initial URL is set up by having the parameter called redirect, that stores the URL that the user was on when clicking on the download link.\nThe code I have so far is a very slight modification of the code given in this answer for how to initialize a download and then redirect the user to another page:\nsingle-downloads.php\n<?php function force_file_download($filepath, $filename = ''){\n        if($filename == ''){\n            $filename = basename($filepath);\n        }\n        header('Content-Type: application/octet-stream');\n        header(\"Content-Transfer-Encoding: Binary\"); \n        header(\"Content-disposition: attachment; filename=\\\"\" . $filename . \"\\\"\"); \n        readfile($filepath); // do the double-download-dance (dirty but worky)  \n    }\n?>\n\n<?php\n    if (!empty(get_query_var('redirect'))) {\n        $redirect_url = get_query_var('redirect');\n    } else {\n        $redirect_url = get_bloginfo(\"url\");\n    }\n?>\n\n<?php \n//If download is password protected and correct password has not been entered yet, show password protection form\nif (post_password_required()) {\n    <?php get_header(); ?>\n    <main id=\"content\">\n        <?php if (have_posts()) : while (have_posts()) : the_post(); ?>\n                    <?php the_content(); ?>\n        <?php endwhile;\n        endif; ?>\n    </main>\n    <?php get_footer(); ?>\n} else { ?>\n// If download is not password protected or correct password has been entered, do download\n        $url = get_field(\"upload_file\")['url'];\n        force_file_download($url);\n        echo '<script type=\"text/javascript\">';\n        echo 'window.location.href = \"' . $redirect_url . '\"';\n        echo '</script>';\n<?php } ?>\n\nEverything until the redirection is working with the code above. I can enter the correct password and the file is being downloaded, but the redirection is halted. I imagine this is because the header for the file download is conflicting with the redirect (made with JavaScript). The password form is still showing when the file is downloaded, so it seems like the loading of the template in Wordpress is being halted as well.\nIs it even possible to make it so that the file is downloaded and the user is then redirected to the URL in the redirect URL parameter? And in that case, how do I do it? Like I mentioned, the exact order is not really important to me as long as the file is being downloaded while you are redirected to the initial URL.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405166", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Selector for page to set up scrolling plugin I'm trying to set up infinite scrolling for pages on my site, using the Catch plugin.  It asks for an item selector.  The default is article.status-publish.  I'm guessing that if I can figure out what the page selector is, that setting may do the job.\nI'm not familiar with CSS, have tried some reading, but all the guides about finding selectors seem to want much more CSS knowledge than I have. How can I make this \"simple\" plugin work?\nThanks\ndave\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405168", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Escape when echoed I've been trying to submit a plugin for review and I keep having problems with the echo line.\nThe last version I sent was like this.\n<option value=\"\">\n    <?php _e( '- Default', MF_TEXT_DOMAIN ); ?>\n</option>\n<?php foreach ( $folders as $folder ) {\n    $folder = trim( $folder );\n    $folder = esc_attr( $folder );\n    echo \"<option value=\\\"{$folder}\\\">{$folder}</option>\";\n} ?>\n\nAnd the WordPress response was:\n\nThis is not escaped:\necho \"<option value=\\\"{$folder}\\\">{$folder}</option>\";\n\n$folder MUST be escaped when it's echo'd.\n\nNow I'm ready to submit the code for review again but first I want to make sure I'm correct.\nHere the new code\n<option value=\"\">\n    <?php _e( '- Default', MF_TEXT_DOMAIN ); ?>\n</option>\n<?php foreach ( $folders as $folder ) {\n    $folder = trim( $folder );\n    echo '<option value=\"' . esc_attr( $folder ) . '\">' . esc_attr( $folder ) . '</option>';\n} ?>\n\nI'd be very grateful if someone could help, as I'm a bit confused about the (escaped).\n\nA: In fact to be super pedantic, I think the correct code is actually:\necho '<option value=\"' . esc_attr( $folder ) . '\">' . esc_html( $folder ) . '</option>';\n\nSince the first variable is an attribute, and the second is encased in html, although I wold bet that the code you have would pass review, and is certainly fit for purpose.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405169", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to remove the message 'We could not find any results for your search' without changing template files and without adding posts/pages? I take the question back with context.\nThe goal is not to add posts or pages so that the post is replaced by the title of the post/page.\nThe goal is not to modify the search.php file to remove this error message by hand.\nImagine the situation. We have a normal page with a search widget in a sidebar or in the footer. If you launch the search, you will have your site loading due to the widget submit. Wordpress will search for search.php but since I have 0 articles on my site it will display the title of this topic. I want to delete this message no matter what theme a user selects. If I manage to remove this message, I will be able to use my second widget which will take care of the particular display, but I need to remove the message first.\nI can't use AJAX because I will lose the URL change when searching.\nI can't use style classes because each theme has its own style.\nIs there any way to remove this message despite these conditions?\n\nA: The answer was to change the input name variable of the form. It was 's' for my widget.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405173", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change Dropdown jQuery to show/hide but with default place holder that shows all How to set the jQuery so if default \"Department\" is selected show all, and only hide all else one other section made.\nfor example, if non selected will be \"Department\", if \"Department 1\" selected only show \"Department 1\" and same with other options.\ncode\n     <script>\n        jQuery(document).ready(function ($) {\n            $(\"select\").change(function () {\n                $(this).find(\"option:selected\").each(function () {\n                    var optionValue = $(this).attr(\"value\");\n                    if (optionValue) {\n                        $(\".box\").not(\".\" + optionValue).hide();\n                        $(\".\" + optionValue).show();\n                    } else {\n                        $(\".box\").hide();\n                    }\n                });\n            }).change();\n        });\n    </script>\n\n    <div>\n        <label>\n            <select>\n<!--                <option value=\"starter\" selected>Department (--><?php //echo $total; ?><!--)</option>-->\n                <?php\n                $tax_terms = get_terms('department', array('hide_empty' => '0'));\n                foreach ($tax_terms as $tax_term):\n                    ?>\n                <?php\n                    echo '<option value=\"' . $tax_term->name . '\">' . $tax_term->name, '<span> (' . $tax_term->count . ')</span>' . '</option>';\n                endforeach;\n                ?>\n            </select>\n        </label>\n    </div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405177", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Pull in posts using post meta for REST API So I wasn't able to find much detail about this, so I wanted to ask the community to see if I can get an answer.\nSo let's say that I have the following:\n$this->global_endpoint = 'https://example.com/wp-json/global/v1/posts` which is the REST API endpoint for pulling in posts for WordPress.\n\nThen I am calling wp_remote_request such as this:\n$response = wp_remote_request(add_query_arg( [\n    'page' => 1,\n    'per_page' => 3,\n    'post_status' => 'publish',\n], $this->global_endpoint));\n\nDoes anyone know if it's possible to get a REST API return of posts based on just the post_meta?\nSo let's say that I want /wp-json/global/v1/posts to just return all posts if they have a post_meta key of _global_posts with the meta_value true.. is this possible?\nAll help will be appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405179", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why is Google Search Console getting X-Robots-Tag noindex? As can be safely inferred from the question, I'm trying to get Google to index my site.\nI'm using Wordpress 5.9 served by nginx (1.13.12), with SEOPress (5.6 up-to-date).\nI let the wizard guide me for the settings and created a sitemap that I registered with Google Search Console - as advised.\nI let Google do its work and came back later to check, and found that every page exposed in my sitemap returns a noindex meta (X-Robots-Tag with User-Agent 'Googlebot for smartphones').\nI did uncheck the \"discourage search engines...\" checkbox in Wordpress Reading settings.\nI also did reset opcache, and I don't have a wp cache plugin (I don't have that much traffic so far).\nAnd when I load the pages in a browser or with curl the X-Robots-Tag is set to none...\n$ curl -I https://www.alchimie-web.com\nHTTP/1.1 200 OK\nServer: nginx/1.13.12\nDate: Tue, 26 Apr 2022 15:07:44 GMT\nContent-Type: text/html; charset=UTF-8\nConnection: keep-alive\nX-Powered-By: PHP/7.3.16\nSet-Cookie: __wpdm_client=ce7f05b428fa7da70dc3dd9192fdc0a5; secure; HttpOnly\nLink: <https://www.alchimie-web.com/wp-json/>; rel=\"https://api.w.org/\"\nLink: <https://www.alchimie-web.com/wp-json/wp/v2/pages/7>; rel=\"alternate\"; type=\"application/json\"\nLink: <https://www.alchimie-web.com/>; rel=shortlink\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nX-Robots-Tag: none\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\n\neven with various User-Agents to try and reproduce what the Googlebot reads :\n$ curl -A 'Googlebot/2.1 (+http://www.google.com/bot.html)' -I https://www.alchimie-web.com\n\nor\ncurl -A 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)' -I https://www.alchimie-web.com\n\nor\ncurl -A 'Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.93 Mobile Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)' -I https://www.alchimie-web.com\n\nThe site never returns a X-Robots-Tag: noindex...\nAny hint on what I'm doing wrong ?\nShould I use another SEO plugin ? (though I read that the same problem sometimes occurs with Yoast...)\n\nA: I have a nginx directive that set X-Robots-Tag to none for every page. I thought it was some kind of null value for the header...\nNow that I took some time to RTFM, I learned that none means both noindex and nofollow... So it wouldn't let the SEO plugin do its job.\nNow that I removed it, it certainly works better.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405180", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: excluding posts by an ACF field in pagination So I have this\n$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n$args = array(\n    'post_type' => 'post',\n    'posts_per_page' => 12,\n    'category' => 1165,\n    'meta_query' => array(\n        'meta_key' => 'price_special',\n        'value' => array('New Boat', 'Under Offer', 'Reduced', 'Just Added', 'Coming soon', 'New Build'),\n        'compare' => 'IN',\n        ),\n    'suppress_filters' => false,\n    'meta_key' => 'price',\n    'orderby' => 'meta_value_num',\n    'order' => 'DESC',\n    'paged' => $paged,\n);\n$query = new WP_Query($args);\n\n\nbut the meta_query is having no effect on the number of results and therefore the number of pages, can anyone tell me where I am going wrong please?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405183", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Setting an expiration date for wordpress roles I need to know if there is any manual way to set expiration date for a given role.\nIn my website, when a person purchases a video, they are assigned a role. What I am looking for is to restrict this role to 30 days. Meaning that this person has access for this restricted content during 30 days, after that, they will go back to \"subscriber\" with no further access to the video he purchased.\nThank you and regards\nLiliana\nKindly let me know if I can do this manually. I am currently using a plugin.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405184", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to order query results based on if a custom field has been populated, then the order by the date of the post? I am trying to custom sort a query for product posts (custom content type) based on if a specific ACF custom field for a product ID number has been populated. My client wants to feature products with this first as it adds extra details for inventory.\nMy current script works to a degree, but doesn't seem to factor date into the order/sort so I am assuming it is sorting based on the actual product ID number, versus if it just exists or not, then date for the sort order beyond that.\n        $args = array(\n            'meta_query' => array(\n                'relation' => 'OR',\n                array(\n                    'key' => 'product_identifier',\n                    'compare' => 'NOT EXISTS',\n                ),\n                array(\n                    'key' => 'product_identifier',\n                    'compare' => 'EXISTS',\n                ),\n            ),\n            'orderby' => 'meta_value date',\n            'order' => 'DESC DESC',\n            'post_type' => 'products',\n            'offset' => $offset,\n            'posts_per_page' => $ipp,\n        );\n\nUPDATE: So far my answer has been to add a second custom field that is just a checkbox to say to feature this product first. Being that sets the same value to each, I can then order by it and the fall back to date then works it seems.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405187", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP_Query, Taxonomy, list of attached items to a Term, sorted I have a Taxonomy, \u201cGenre\u201d.\n\u201cGenre\u201d has a Term, \u201cadvert\u201d.\nI want my taxomomy template to grab all Custom Posts attached to that term, sort them by my last_name, first_name, short_title Custom Fields, and output.\nBut my custom query is returning 0 posts! I would love to get another set of eyes on this. I\u2019m missing something!\n<?php\n$args = array(\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'genre',\n            'terms'    => array( 'advert' )\n        )\n    ),\n        'meta_query'      => array(\n            'relation'           => 'AND',\n            'last_name_clause'   => array(\n                'key'     => 'last_name',\n                'compare' => 'EXISTS',\n            ),\n            'first_name_clause'  => array(\n                'key'     => 'first_name',\n                'compare' => 'EXISTS',\n            ),\n            'short_title_clause' => array(\n                'key'     => 'short_title',\n                'compare' => 'EXISTS',\n            ),\n        ),\n        'orderby'        => array(\n            'last_name_clause'   => 'ASC',\n            'first_name_clause'  => 'ASC',\n            'short_title_clause' => 'ASC',\n        ),\n    );\n$newQuery = new WP_Query( $args );\n?>\n\nBest regards,\nMark\n\nA: You're looking for custom posts, but don't define post_type in your query, which means it will default to the core post post type only.\nYou need to incorporate\n'post_type' => 'my-cpt'\ninto your query.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405189", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hook or callback when wp_nav_menu() has completed I am modifying the $output of wp_nav_menu() using a custom walker, and I need to run a function after the final closing </ul> of the entire menu. I can only see the following methods available:\nstart_lvl()    // Runs when a child menu is started\nend_lvl()      // Runs when a child menu is completed\nstart_el()     // Runs when a menu item is started\nend_el()       // Runs when a menu item is completed\n\nI can't find anything that runs when the top level menu is completed. Is this possible?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405191", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can part of my WordPress website be headless? Just to set the scene I have a client that has a wordpress site with a mixture of \"static\" pages and woocommerce shop. The product catalogue has approx \"86,000\" products in it. This number may include variation though it is massive.\nThe client relies heavily on product filtering functionality for users to get to the correct products. Using WP AJAX to do this has proven really slow. After a bit of research I think the best way to perform the filtering super fast is through a React JS app and accessing the product data through the REST API (I've been looking at using Frontity). My question is: Can the static pages be served though regular wordpress and a filtering page served via a single page React JS application?\nThis needs to be done all via the same URL: www.example.com(served via wordpress)www.example.com/choose-product(served via React JS app) both sharing a common header, footer and styles to mimic all one website.\n\nA: You can mount a react or a vue app partially into a page, so what you ask is theoretically possible but probably not the best solution.\nYou may consider expanding the react application a bit and go fully headless. In this case, next.js (based on react) might be a better solution as it will allow you easy static page generation/server side rendering. Of course this will be not as easy as a regular WordPress theme editing job, and definitely will take more time. In any case, I suggest you to use graphql instead of wp rest api which will perform better.\nOn the other hand, the poor performance may not be because of the ajax calls, but because of the poor query/database performance which react or graphql cannot solve as well.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405197", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: AJAX call inside plugin class is not getting to it's response function I've looked at a heap of other people with this same problem but I still can't find a solution. Hopefully someone can see what I've missed because I'm about to pull my hair out.  \nMy ajax call is not getting to the response function. \nThis is how my code is called. This function gets called from a template.\nfunction build_a_boat(){\n\n    // blah blah blah\n\n    require_once BUILDNEWBOAT_PATH . 'includes/BuildNewBoatPlugin.php';\n\n    $build_boat_plugin = new BuildNewBoatPlugin();\n    $build_boat_plugin->run();\n\n}\n\nThe below code is inside by plugin class. When I click a radio button, I receive the \"javascript is working\" alert, then an admin-ajax.php 400 error in the console. \nI think my problem is that the ajax return hook isn't firing (wp_ajax_post_new_boat_form).  If I move my code out of the plugin class, everything works.\n    public function __construct() {\n\n        // other stuff happens here\n\n        $this->init_plugin();\n\n        add_action( 'wp_enqueue_scripts', array( $this, 'init_plugin' ) );\n        add_action( 'wp_ajax_post_new_boat_form', array($this,'next_step_ajax' ));\n        add_action( 'wp_ajax_nopriv_post_new_boat_form', array($this,'next_step_ajax' ));\n\n\n    }\n\n    function init_plugin() {\n\n        wp_register_script( 'new_boat_form_script', plugin_dir_url( __FILE__ ) . 'js/new_boat_form.js', array() );\n        wp_enqueue_script( 'new_boat_form_script');\n        wp_localize_script( 'new_boat_form_script', 'new_boat_form_script_ajax_object',\n            array(\n                'ajax_url'   => admin_url( 'admin-ajax.php' ),\n                //'ajax_nonce' => wp_create_nonce( 'new_boat_form_ajax_nonce' )\n            )\n        );\n\n    }\n\n    public function next_step_ajax(){\n\n        print \"It worked. Moving to the next step<br>\";\n\n        die();\n    }\n\nMy javascript is this\n$(function () {\n    $(\"#boatFormStep input[type=\\\"radio\\\"]\").on(\"change\",function(){\n\n        alert(\"javascript is working\");\n\n        $.ajax({\n            url: new_boat_form_script_ajax_object.ajax_url,\n            data: {\n                action: 'post_new_boat_form'\n            },\n            method: 'POST',\n            success: function (response) {\n                console.log(response)\n                $(\"#boatFormStep\").html(response);\n            },\n            error: function (error) {\n                console.log(error)\n            }\n        })\n    })\n\n});\n\nHelp!\n\nA: Problem seems with build_a_boat() function. You called that function from inside a template file. Does that gets called on the desired page load?\nSolution: Try to call that function from plugin root file. Also add that function in root file to ensure the call is working.\nTry by adding this in plugin root file.\nfunction build_a_boat(){\n    // blah blah blah\n    require_once BUILDNEWBOAT_PATH . 'includes/BuildNewBoatPlugin.php';\n\n    $build_boat_plugin = new BuildNewBoatPlugin();\n    $build_boat_plugin->run();\n}\n\nbuild_a_boat() // call to the function\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405199", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Displaying page content from plugin, inside exising empty WP page Old php developer here, very.. very new to WP, so be kind.\nI am building my first WP Plugin. I have this in the plugin central file (the one that is /plugins/my_plugin/my_plugin.php):\n// Setup the admin management page\nfunction wx_admin_burger_management() {\n    add_menu_page(\n        'Burger Manager',           // Page title\n        'Burger Manager',           // Menu title\n        'manage_options',           // Capability\n        'admin-manage-burger',      // Menu slug\n        'wx_burger_admin',          // Callback function\n        'dashicons-list-view',      // Menu icon\n        '3'                         // Priority\n    );\n}\n\nfunction wx_burger_admin() {\n    include(trailingslashit(WX_PLUGIN_PATH).'my-burger-admin.php');\n}\nadd_action('admin_menu', 'wx_admin_burger_management');\n\nThis works exactly as it is supposed to, which is encouraging. It adds a page to the Admin menu that lets admin type people do admin type things.\nI have used WP to create a blank page with a suitable menu item, that shows once the regular user on the front end is logged in. It does not show to an un-logged-in user. The menu item points to sitename.com/my-burger/ which has the wonderful title of \"My Burger\" at the top. Nothing else is displayed on this page currently. I am trying to get content to be pulled from another php document inside my plugins directory, to show up here. Currently I am attempting (and failing) to do this using:\nfunction wx_burger_user_page_content() {\ninclude(trailingslashit(WX_PLUGIN_PATH).'burger-management-user.php');\n}\nadd_action('my-burger', 'wx_burger_user_page_content');\n\nThere is no menu section to callback from, since the menu is already in place from the WP side of things.\nI am presuming that the problem is my add_action line, specifically the 'my-burger' part. I'm guessing I need to change this for a hook of some type that is aware the page is called and then triggers the wx_burger_user_page_content() function to display burger-management-user.php within the page.\nAm I correct, and if so, how do I go about discovering the hook that I should be using here to achieve this?\nTIA\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405201", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sort posts by child category name I have a category \"year\" and child-category names with year numbers 1966, 1972, 1980 etc.\nI have a category \"publisher\" and child-categories with publisher names.\nEach post is assigned a year child-category and a publisher child-category.\nWhen listing posts with child-category of a specific publisher, I want to order them according to the name of the child category of category \"year\".\nI looked around and didn't find a solution.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405205", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Delete Post but retain image of post [WP REST API] Currently, when I delete a post in my wordpress website, the image is deleted automatically.\nWhich is fine for most cases, however, there are certain posts where I don't want to delete the image from the database such as a post that has the plain website logo (default background image when subscribers don't post image). In such case, how can I delete the post while keeping the image.\nI'am using the wordpress rest api and issuing the following request (in python) to delete the post.\nurl='https://mywebsite.com/wp-json/wp/v2/posts'\npost_id=22334\n\nr = requests.delete(url + '/' + str(post_id) + '?force=True')\n\nAny suggestions?\nPossible solution routes:\n-Is there a way to mark/protect an image from auto deletion when post is deleted\n-Is there a way to instruct wordpress not to delete featured media when deleting the post\nThis is the deleteimage function used by the custom theme when a post is deleted:\npublic function deleteImages(Post $post)\n{\n    foreach (themeApp('gallery_fields') as $galleryField) {\n        /* @var GalleryField $galleryField */\n        foreach ($galleryField->getValue($post) as $imageId) {\n\n            wp_delete_attachment($imageId);\n        }\n    }\n}\n\nRESOLVED:\nIssue was due to custom theme not designed/configured properly. Hence I modified the deleteImages function in the theme files to check if image is used more than once (if used once delete image, if more than once then dont delete image):\npublic function deleteImages(Post $post){\nforeach (themeApp('gallery_fields') as $galleryField) {\n    /* @var GalleryField $galleryField */\n    foreach ($galleryField->getValue($post) as $imageId) {\n\n\n        $args = array( 'numberposts' => -1, 'fields'=>'ids');\n        $array2 = get_posts( $args );\n\n        foreach($array2 as $item){\n            $images = get_post_meta( $item,'customfield_19213');#this is the custom field corresponding to image id\n\n            $imagelist[]=$images;\n        }\n\n        foreach ($imagelist as $img){foreach ($img as $im){\n            $imageflattened[]=$im;\n        }\n        }\n        $imageflattened=array_count_values($imageflattened);\n        $ImageID=strval($imageId);\n        $count= $imageflattened[$ImageID];\n\n        if ($count==1){ wp_delete_attachment($imageId);}\n    }\n}\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405206", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wpdb get_results() and prepare when to use prepare? so if i have a function that gets terms from the database ( not the user ) do I need to use prepare first ( before get_results() ), or some sort of data sanitizing?\n\nA: \nso if i have a function that gets terms from the database ( not the user ) do I need to use prepare first ( before get_results() ), or some sort of data sanitizing?\n\nYes, but you should be using get_terms/WP_Term_Query/wp_get_object_terms/etc and the other term APIs instead as they're safer and can be much faster. SQL bypasses object caches and performance plugins, as well as local caches, bulk fetches and security protections.\nIf you're going to perform an SQL query though, don't try to escape it, use prepare to insert variables into the query ( never do it directly! ):\n$safe_sql = $wpdb->prepare(\n    \"SELECT * FROM `table` WHERE `column` = %s AND `field` = %d OR `other_field` LIKE %s\",\n    [ 'foo', 1337, '%bar' ]\n);\n\nRemember, if you need to use an SQL query on the core WordPress tables, there's a high chance you've done something wrong or don't know about a function that does it for you.\n\nA: You shouldn't need to pre-sanitize, wordpress takes care of that with the wpdb class.\n   global $wpdb;\n   $rows = $wpdb->get_results(\"SELECT * FROM \" . $wpdb->prefix . \"posts\");\n\nHowever, have a look at this:\nhttps://wordpress.stackexchange.com/questions/217765/do-i-need-to-prepare-query-before-get-results-get-row-and-get-var#:~:text=You%20can%20sanitize%20before%20passing,doing%20the%20sanitization%20for%20you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405207", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Disclaimer that will show every refresh of the page Hello I have here a code that is based on a \"where you first access the page you will see the Disclaimer template\" but I want it to show every time I refresh the page\n<?php \n\n// DISCLAIMER CHECK\n    \n$ip = TCG_RETURN_IP();\n$disclaimer_option = 'tcg_disclaimer_'.$ip;\n$get_disclaimer    = get_option($disclaimer_option);\n$date_now   = new DateTime();\n$date_now   = $date_now->setTimezone( new DateTimeZone('GMT+1') );\n\n\n    if( (TCG_CHECK_DISCLAIMER() != false) || (TCG_CHECK_DISCLAIMER() != '') ){\n\n        // if($date_now>$get_disclaimer){\n        if($date_now>$get_disclaimer){\n            delete_option($disclaimer_option);\n            get_template_part('topcitygirls/templates/topcity','disclaimer');\n            //get_template_part('topcitygirls/templates/topcity','header');\n\n                echo 'true';\n            \n        }else{\n            get_template_part('topcitygirls/templates/topcity','header');\n\n        }\n    }else{\n        if( is_user_logged_in() ) {\n            get_template_part('topcitygirls/templates/topcity','disclaimer');\n        }else{\n           $date_expire = clone $date_now;\n            $date_expire = $date_expire->add(new DateInterval('PT1H'));\n            update_option($disclaimer_option,$date_expire);\n            get_template_part('topcitygirls/templates/topcity','header');\n           \n        }\n    }\n\n    get_template_part('topcitygirls/templates/topcity','passwords');\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405208", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to set add_query_arg properly for home page? I want to add lang query variable to existing URL.\nI have registered query variable:\nadd_filter('query_vars', 'custom_add_query_vars');\nfunction custom_add_query_vars($vars){\n    $vars[] = \"lang\";\n    return $vars;\n}\n\nThe following code works good everywhere but not when I'm currently on the home page.\n<?php global $wp; ?>\n<a href=\"<?php echo add_query_arg(array('lang' => 'en'), $wp->request); ?>\">English</a>\n\nIs there a problem with the code? On the homepage\nURL becomes http://localhost/mywebsitename/?lang=en which should be ok but supposedly it tries to load index.php instead of page.php, which generally wouldn't be a problem but in that case some things like is_front_page() don't behave as it should.\nStatic page is set as a homepage under Settings->Reading and pretty permalinks are active (\"Post name\" option).\n\nA: \nIs there a problem with the code?\n\nYour code is already properly adding the lang query variable to the homepage URL. But you need to understand these points:\n\n*\n\n*\n\nOn the homepage URL becomes http://localhost/mywebsitename/?lang=en which should be ok\n\n$wp->request is empty on the homepage, hence the above URL is expected. And you could use get_queried_object()->post_name to force the Page's slug be in that URL, but WordPress would actually redirect you to the URL without that slug, because the Page is set as the static front page, which means the content at example.com and example.com/page-slug/ are identical and thus WordPress performs a (canonical) redirect when loading the latter URL.\n\n\n*\n\nbut supposedly it tries to load index.php instead of page.php, which generally wouldn't be a problem but in that case some things like is_front_page() don't behave as it should\n\nNo, WordPress will try to load front-page.php, home.php or page.php before falling back to the index template. But even if the index template is used, is_front_page() would still behave properly \u2014 remember that the query determines the template and not the other way round.\nSo one could say that \"if is_front_page() returns true, page.php might be used\", but this is incorrect: \"if index.php is used, is_front_page() would return false\".\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405212", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Scheduling an event inside plugin class is not working wp_schedule_single_event is not firing.\nI wrote a function that is posting to external API, if it failed I schedule the same posting function to run 5 seconds later in cases of timeouts.\nHere's the simplified code of the function:\nclass MyPlugin {\n    public function post( $fields, $type ) {\n        // Posting to external API logic, if it failed I schedule the same function to run in 5 seconds.\n        wp_schedule_single_event( time() + 5, 'post', array( $fields, $type ) );\n        \n        return;\n    }\n}\n\nI assumed that the post function is simply not found so when the time comes for that function to run, nothing happens, so I tried to use:\nwp_schedule_single_event( time() + 5, MyPlugin->post(), array( $fields, $type ) );\nOR\nwp_schedule_single_event( time() + 5, 'MyPlugin->post', array( $fields, $type ) );\nNothing seems to work! How can I get the same function to run with the same accepted args, 5 seconds after it failed?\nThanks!\n\nA: \nI assumed that the post function is simply not found so when the time\ncomes for that function to run, nothing happens\n\nThe second parameter for wp_schedule_single_event() is actually an event name, which is really a hook. So the event/hook could be named my_event, my_plugin_retry_post, etc., and if you want the post() method to be called via that hook or when that event runs, then you need to attach the method to that event.\nSomething like so, assuming that your class is instantiated on page load:\n<?php\n/*\nPlugin Name: My Plugin\nVersion: 1.0\n*/\n\nclass MyPlugin {\n    public function __construct() {\n        // Calls the post() method when the my_event hook runs.\n        add_action( 'my_event', array( $this, 'post' ), 10, 2 );\n    }\n\n    public function post( $fields, $type ) {\n        // your API call logic\n\n        if ( the API succeeded ) {\n            // your code here\n        } elseif ( ! wp_next_scheduled( 'my_event', array( $fields, $type ) ) ) {\n            // The last 2 parameters are the same as the 1st & 2nd for wp_next_scheduled().\n            wp_schedule_single_event( time() + 5, 'my_event', array( $fields, $type ) );\n        }\n    }\n}\n\n// Instantiate MyPlugin on page load.\n// Or immediately when WordPress loads this plugin.\nglobal $myplugin;\n$myplugin = new MyPlugin;\n\n/* Then later on, e.g. in a function, you could do:\nglobal $myplugin;\n$myplugin->post( [ 'foo', 'bar' ], 'baz' );\n*/\n\nOr if you want, you could instead create a callback which calls the post() method and attach the callback to your event.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405213", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why is my child theme style.css not found (404) in the front-end? I have a brand new Wordpress install (5.9.3) served by nginx (1.13.12).\nI'm using Docker containers for nginx and wordpress.\nI created a child theme based on twentytwentytwo following the WP codex instructions. It shows in the wp-admin and I was able to activate it and customize it through the block Editor.\nNow I want to add a css class to my style.css. Here's the function to enqueue my child-theme's styles :\nadd_action( 'wp_enqueue_scripts', 'chesnaie_styles' );\nfunction chesnaie_styles() {\n    $parenthandle = 'twentytwentytwo-style';\n    $theme = wp_get_theme();\n\n    wp_enqueue_style(\n        'chesnaie-style', \n        get_stylesheet_uri(),\n        array( $parenthandle ),\n        $theme->get( 'Version' )\n    );\n}\n\nAccording to codex, I don't need to enqueue the parent's style :\n\nIf the parent theme loads its style using a function starting with get_template, such as get_template_directory() and get_template_directory_uri(), the child theme needs to load just the child styles, using the parent\u2019s handle in the dependency parameter.\n\nWhen I refresh the front-end to check my changes, I notice that my child theme's style.css is not loaded (I get a 404 not found).\nI checked the files and directory permissions and ownership on the server, it's all set according to WP codex (755 for dirs and 644 for files), if I'm to believe this post. And it's identical to the parent's files.\nI did refresh the permalinks (as advised in a related post) - though I'm not sure how that's relevant. And there's no caching plugin.\nStill, the file returns 404. I can fetch the parent's style.css directly in the browser, but not my child-theme's.\nAny hint ?\n\nA: You mentioned in the comments you can't access any files from the theme folder via the webserver. This usually means some configuration has gone wrong.\nIn docker / docker-compose the first thing that comes to mind is that the theme is not mounted into the webserver container.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405218", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to clone homepage for multi region site? How would i clone the homepage of my website ? I understand and have used to plugins that duplicate your page, the difficulty I am having is that I need to create a multi-site from 1 domain.\nFor example, I have\nmywebsite.com - this targets my usa audience\nmywebsite.com/es - this would target spanish audience\nI would really like to know how I would duplicate mywebsite.com and then edit that page and content so that it is in spanis\nIf you know, please can you help me.\n\nA: Multisites don't have to be separate domains, they can be subfolders. You can have your root/original blog/site at / then put new sites at /es/ /fr/ etc etc.\nAs for how you would copy your content to that site however, WordPress provides no solution here other than a manual copy/paste. You would need to reconstruct all the pages and copy what content you have in the main site to these secondary sites. You would need to translate all this content by hand anyway.\nFor any automation you would need to use 3rd party plugins. Some multilingual plugins rely on multisites and would do all of this automatically.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405219", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Use custom image size in admin panel I have add some image size like:\nadd_image_size( 'custom-small', 600, 600 );\nadd_image_size( 'custom-medium', 1280, 1280 );\nadd_image_size( 'custom-large', 2560, 2560 );\n\nand I have removed all the default sizes.\nNow the Media Library in the Admin panel is loading full image instead of medium.\nIs it possible to specify a custom size to use?\n\nA: Image sizes are hard-coded throughout WordPress core; Tom's comment to adjust the dimensions of the built-in image sizes is the best approach.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405223", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Parent field missing from custom post type in the block editor I have a hierarchical custom post type, but the Parent field is missing in the block editor sidebar.\n\nregister_post_type( 'guides',\n    [\n        'public' => true,\n        'hierarchical' => true,\n        'has_archive' => true,\n        'menu_position' => 20,\n        'menu_icon' => 'dashicons-format-aside',\n        'rewrite' => [\n            'slug' => 'guides',\n            'with_front' => false,\n            'feeds' => true\n        ],\n        'supports' => [ 'title', 'editor', 'excerpt', 'revisions', 'page-attributes' ],\n        'show_in_rest' => true,\n        'rest_base' => 'cs_guides',\n        'taxonomies' => [ 'topic', 'county' ],\n        'labels' => [\n            'name' => __( 'Guides', 'textdomain' ),\n            'singular_name' => __( 'Guide', 'textdomain' ),\n            'add_new' => __( 'Add New', 'textdomain' ),\n            'add_new_item' => __( 'Add New Guide', 'textdomain' ),\n            'edit_item' => __( 'Edit Guide', 'textdomain' ),\n            'new_item' => __( 'New Guide', 'textdomain' ),\n            'all_items' => __( 'All Guides', 'textdomain' ),\n            'view_item' => __( 'View Guide', 'textdomain' ),\n            'search_items' => __( 'Search Guides', 'textdomain' ),\n            'not_found' =>  __( 'No Guides found', 'textdomain' ),\n            'not_found_in_trash' => __( 'No Guides found in trash', 'textdomain' ),\n            'parent_item_colon' => '',\n            'menu_name' => __( 'Guides', 'textdomain' ),\n        ]\n    ]\n);\n\n\nA: tl;dr - The Parent select menu will not render in the block editor if the parent_item_colon label is an empty string.\nRuling Out Common Issues\nFirst, I needed to confirm that the following frequent reasons for the Parent field missing were all not the problem:\n\n*\n\n*\u2714 hierarchical is true in register_post_type()\n\n*\u2714 page-attributes is included in the array of supports in register_post_type\n\n*\u2714 There are at least two published posts of the custom post type, the one I'm editing and one other (that could be the parent)\n\nAll of these things were true, but I still couldn't set the Parent. I was able to further confirm most things were working by seeing that the Parent field was visible in the Quick Edit interface.\nThe breakthrough came when someone helping me tried removing the labels parameter from register_post_type() in the code above...\nThe Problem and Solution\nIf ['labels']['parent_item_color'] is set to an empty string in register_post_type() the Parent field will not appear in the the Page Attributes panel of the block editor sidebar.\nThis was a mistake on my part, but the impact was so unexpected that I wanted to share.\nSetting the label to a non-empty string like __( 'Parent Guide:', 'textdomain' ) made the Parent select menu appear in the Block Editor sidebar.\nCredits\nI ran into this issue and was totally flummoxed for a day. Thanks to Elaine on the WP Campus community Slack who made a discovery leading to the answer!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405225", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Trying to get_adjacent_post - in same category not working this is my first time here.\nI need my previous and next posts to show only posts on the same category. But I don't know how to do it.\nThis is the code in my template (called Valenti) it is in a file called core.php\n/*********************\n CLEAN NEXT/PREVIOUS LINKS\n*********************/\n\nif ( ! function_exists( 'cb_previous_next_links' ) ) {\n    function cb_previous_next_links() {\n\n          $cb_previous = get_adjacent_post( false, '', true );\n          $cb_next = get_adjacent_post( false, '', false );\n          if ( ( $cb_next != NULL ) || ( $cb_previous != NULL ) ) {\n\n              $cb_empty = '<div class=\"cb-empty\">' . __(\"x\", \"cubell\").'</div>';\n\n              echo'<div id=\"cb-previous-next-links\" class=\"cb-post-footer-block clearfix\">';\n\n              if ( $cb_previous != NULL ) {\n\n                         echo '<div id=\"cb-previous-link\"><a href=\"' . get_permalink($cb_previous) . '\"><i class=\"fa fa-long-arrow-left\"></i></a>';\n                         previous_post_link('%link');\n                         echo '</div>';\n\n              } else {\n                  echo $cb_empty;\n              }\n               if ( $cb_next != NULL ) {\n                         echo '<div id=\"cb-next-link\"><a href=\"' . get_permalink($cb_next) . '\"><i class=\"fa fa-long-arrow-right\"></i></a>';\n                         next_post_link('%link');\n                         echo '</div>';\n\n              } else {\n                  echo $cb_empty;\n              }\n\n              echo '</div>';\n           }\n    }\n}\n\n\nI have been  trying many things, but none is working, it is not showing posts on the same category.\ntryied doing this, but it is not working and don't know why\n $cb_previous = get_adjacent_post( true, '', true, 'category' );\n  $cb_next = get_adjacent_post( true, '', false, 'category' );\n\nwhat can I do? Not a coder, so I need you to explain in details or with examples if I have to add a snippet in functions or to modify the code above.\nThanks in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405231", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Trying to edit a page returns the editor encountered an unexpected error I have a website hosted on server that doesn\u2019t have any server cache , neither any wp cache plugins are installed and when I try to edit a page it returns a blank page with message \u201cthe editor encountered an unexpected error\u201d and looing in the console I see this error:\nUncaught TypeError: Cannot destructure property \u2018setUsedPageOrPatternsModal\u2019 of \u2018(0 , a.useDispatch)(\u2026)\u2019 as it is null.\nrelated on page-patterns-plugin.tsx:20.\nMaybe it is something related to WordPress.com block editor toolkit plugin that could have a bug since I see it\u2019s often updated and actually at version 3.31689?\nOr shall I have to install a plugin to clear wordpress cache and if yes which one would you suggest me between those wp cache cleaners since I see there are many?\u2026.\nIf more informations needed then I can provide\u2026\nThanks in advance to all!\nCheers! :-)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405236", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to disable inline css styles generated by Gutenberg editor? I've got Genesis-blocks plugin installed (it got updated from Atomic blocks). I am using blocks and resuable blocks to create pages. The problem I am facing is, most of these blocks inject their own inline styling, e.g. button block creates an anchor tag, but it gives inline styling for background-color and text-color as well.\nDoing my own research I found that the default appearance of these blocks can be edited with javascript api, but the docs don't tell which javascript file to use. That is, all this jsx code, where am supposed to put this? Am I supposed to create a new plugin? Obviously js code won't go in functions.php and I don't really think it is going into my theme's main.js file as well because that is going to be loaded for the end user not the wp-admin. The only way I found to do this is somewhat done here: https://developer.wordpress.org/reference/hooks/render_block/  but I need more explanation to this, is render_block triggered every time a block is rendered on the front end? Are $block_content and  $block passed by render_block internally?\nThere's some more documentation that suggest changing theme.json file, but I am using wordpress 5.8, which has version:1 for theme.json file and the docs don't any example on that.\nQuestion: So, can I access similar functions to js api in my functions.php file or if js is the only way, which js file am I supposed to use? Also, is it possible to disable all inline styles generated by the gutenburg block editor and genesis blocks?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405240", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How To Use do_shortcode with WooCommerce One Page Checkout I'm trying to use the WordPress do_shortcode function for the WooCommerce One Page Checkout Plugin which uses shortcode like this: [woocommerce_one_page_checkout template=\"product-table\" product_ids=\"product, ids, here\"]. I can ONLY use this shortcode IF it's in the content editor and it won't allow me to add this to a page template using the do_shortcode function.\nTheir documentation here says:\n\nIf you wish to display the One Page Checkout Shortcode using\nWordPress\u2019 do_shortcode() function instead of including the shortcode\nin a post or page\u2019s content, you will also need to attach custom code\nto the 'is_wcopc_checkout' filter and make sure a boolean true value\nis returned.\n\nSo I tried adding the following to the functions.php file:\nadd_filter( 'is_wcopc_checkout', '__return_true' );\nI also tried\nadd_filter( 'is_wcopc_checkout', function(){ return true; } );\nand it didn't work either.\nI also tried:\nadd_filter( 'is_wcopc_checkout', 'my_one_page_checkout' );\nfunction my_one_page_checkout(){\n  return true;\n}\nadd_filter( 'is_wcopc_checkout', 'true' );\n\nThat didn't seem to do it either.\nAm I adding this code to the functions.php wrong? I don't seem to see that there is a filter named is_wcopc_checkout in the code of WooCommerce one page checkout version 1.0.2\nAny help on how I can get the One Page Checkout Plugin to work using do_shortcode?\nHere's my full code in the page template for reference:\n<?php \necho do_shortcode('[woocommerce_one_page_checkout template=\"product-table\" product_ids=\"62, 122, 438, 52, 433, 435, 512, 514\"]');\n?>\n\nThanks for your help.\n(I tried contacting WooCommerce support and they were no help saying that this is custom code and they can't do anything to help.)\n\nA: Here's a partial solution that has worked for me so far:\nIf you use the full do_shortcode() as in your example, and you also put the basic [woocommerce_one_page_checkout] shortcode (even without any attributes) into the content field, that seems to be enough to load the missing scripts and load the checkout form.\nNot ideal but better than nothing because at least you can still programatically build out the do_shortcode() function in PHP to do whatever you need.\nThis probably works because of what is stated in this part of the documentation:\n\nTo display a working checkout form, One Page Checkout needs to enqueue a variety of scripts and styles prior to outputting the content on the page. In order to do this, it will check if the current post content to determine if it contains the One Page Checkout shortcode, and only add the require styles and scripts when it does (to avoid loading them on all pages)\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405244", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: save_post trigerred twice I am trying to add more functionality to the update button. My end result is that I wish to call a python script but for now I am messing around with writing a log file. This is resulting in the log file being written to twice. Can someone help me?\n add_action('save_post', 'test',10,2);\n\nfunction test($id, $post) \n{\n    if ($post->post_type != 'item'){\n        return;\n    }\n\n     if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE ) {\n        return;\n    }\n\n    if (wp_is_post_revision($id)) {\n        return;\n    }\n\n    if (wp_is_post_autosave($id)) {\n        return;\n    }\n\n    $tmp = fopen(dirname(__file__).'/my_logs.txt', \"a+\"); \n    fwrite($tmp,\"\\n\".$id.\" - Fail\\n\");\n    fclose($tmp);     \n           \n\n}\n\nI added the following:\n if(did_action($save_post)==0){\n    $tmp = fopen(dirname(__file__).'/my_logs.txt', \"a+\"); \n    fwrite($tmp,\"\\n\".did_action($save_post).\" - Fail\\n\");\n    fclose($tmp);     \n}\n\nbut still I am getting:\n0 - Fail\n\n0 - Fail\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405245", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ACF: If field contain a specific value, update value in another field As I wrote in the title, how can I change the value of a field based on the value of another field programatically?\nThis other field has already a value but I need to replace / update it.\nTo be more precise:\nIf the Text Field named type has value \"Houses\" AND another Text Field named service has value 2, this should be updated in NOT AVAILABLE.\nOr ...\nIf the Text Field named type has value \"Parks\" AND another Text Field named service has value 2, this should be updated in AVAILABLE.\nOr ...\nIf the Text Field named type has value \"Store\" AND another Text Field named service has value 2, this should be updated in COMING SOON.\nI read the update_field doc but I could not solve this.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405246", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenberg Editor: dynamicaly change slug field with an ACF field I have a custom field with ACF named \"short_title\" and I want the post's slug based on this field instead of the post title field.\nI already wrote this code:\nfunction testSlug($post_id)\n{\n    if (get_post_type($post_id) == 'my-custom-post-type') {\n        if (defined('DOING_AUTOSAVE' && DOING_AUTOSAVE)) {\n            return;\n        }\n\n        if (!current_user_can('edit_post', $post_id)) {\n            return;\n        }\n\n        remove_action('save_post', 'testSlug');\n        $updated_post              = [];\n        $updated_post['ID']        = $post_id;\n        $updated_post['post_name'] = sanitize_title($_POST['acf']['field_61f8bacf53dc5']);\n        wp_update_post($updated_post);\n        add_action('save_post', 'testSlug');\n        clean_post_cache($post_id);\n    }\n}\nadd_action('save_post', 'testSlug');\n\nthis works great and edit the slug, but on the editor, the slug field is not synchronised with this field and when we click on \"Save\" or \"Publish\" button, the slug field is filling with the post title slug.\n\nBut, if we refresh the edit page, the correct slug is shown.\n\nI tried to do some JS to synchronise input event of the ACF field with the slug field, but it doesn't work because when the panel is close, the element disapear from the DOM. Plus, even if the panel is open when the page load, the script run too early, when the editor is not fully loaded, and it return undefined because the field have a dynamic ID (inspector-text-control-X, with X is 1, 2, ...).\nHow can I synchronize the slug field with my custom field? And how can I prevent the event from the post title field to edit the slug field?\n\nA: I've found a way to dynamicaly change the slug field with the short title custom field.\njQuery(document).ready(() => {\n\n    const acfField = 'field_61f8bacf53dc5';\n    const inputShortTitle = document.getElementById('acf-' + acfField);\n\n    const slugify = (str) => {\n        return str.toLowerCase().replace(/ /g, '-')\n            .replace(/-+/g, '-').replace(/[^\\w-]+/g, '');\n    }\n\n    const updateSlug = () => {\n        wp.data.dispatch('core/editor').editPost({slug: slugify(inputShortTitle.value)});\n    }\n\n    if (inputShortTitle !== null) {\n        inputShortTitle.addEventListener('input', () => updateSlug());\n    }\n});\n\nwp.data.dispatch('core/editor').editPost({slug: 'my-slug-value-here'});\n\nis the command that can change React Gutenberg slug field component. No more PHP is needed because when I pressed the Save button, the actual value filled by my script is send to the API.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405250", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I want to include a particular word into the excerpt of every posts of a custom post type. How can I do that pragmatically? I want to include a particular word into the excerpt of every posts of a custom post type. The custom post type \"movie\" has thousand of posts. It is not possible to manually edit the excerpt of every post.\nI do not know much of php. Here to get the help which i need badly.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405251", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ACF field group not showing in page i've created an ACF field group just for one page, since my clients will need to upload 2 files directly related to that page (it's a page about a basketball team, so they'll have to upload the leaderboards and upcoming matches from time to time).\nSo i've set up the field group like this:\n\nAs you can see this field group only shows if the page is 1\u00b0 divisione (the team's name).\nBut when it comes to call that field group in the page, it doesn't show - as you can see from the screen below; instead completely unrelated field groups are shown (these 2 field group are used for posts, not pages).\n\nWhat am i missing? I need those documents to be file custom fields as i've created a front-end dashboard for my clients to manage the posts, and i want to add the edit files functionality.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405254", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: 404/500 error on content images if Referer header is from another domain Not very familiar with WordPress so I'm not sure what's causing this.\nEssentially, we have a few image assets stored under wp-content. When we access some assets (i.e. cmssubdomain.apex.com/wp-content/image.png) we are getting some peculiar behavior around the Referer request header:\n\n*\n\n*It works if accessed without the Referer header\n\n*It works if accessed with the Referer header as long as the value matches the cms subdomain\n\n*It fails once the Referer header is set to a value different than the subdomain\n\nThis is a problem for us as our CMS is hosted under a subdomain (i.e. subdomain1.apex.com), whereas our main site also acts as a proxy to serve CMS content as a path under the main site (i.e. www.apex.com/subdomain1/cmspaths).\nNow, the browser sets the referer header, and we are getting 404/500 on images if they are viewed through the main site (proxied content from CMS).\nIs handling of Referer header a default WordPress behavior, or is it due to some plugin (security? cors?) that was installed? Can anyone point to where valid domains can be whitelisted?\n\nA: It has nothing to do with WordPress. Your server is configured to refuse access from other domains. All you need to enable CORS Origin.\nThis will allow request from other domains. But it will decrease security. You might want to change the * (allow all) to your sub domain. Just put it in your .htaccess file.\n<IfModule mod_headers.c>\n  <FilesMatch \"\\.(jpg|png|gif)$\">\n    Header set Access-Control-Allow-Origin \"*\"\n  </FilesMatch>\n</IfModule>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405256", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Best way to set up \"reviewed by\" in Wordpress? I would like to show both \"author\" (one or more) and \"reviewed by\" (just one person) for Wordpress posts and pages on my website.\nThis would be for example a situation where an article is written by a content producer but the information has to be reviewed by an MD or other credentialed medical expert.\nThis type of functionality is in my opinion pretty much a must on YMYL (your money, your life) type websites.\nMy current understanding is that there is no way to do this in a way that would be native to Wordpress and I should just use some sort of meta information plugin and add the reviewer as meta information on each page and post.\n\nA: You could achieve this with ACF and add a meta field that is the 'Reviewer' that is set after it's reviewed. Then you can all the ACF field on the front end as per their docs.\n\nA: WordPress has a function to retrieve the name of the editor who last modified a post: get_the_modified_author.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405260", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce custom taxonomy filtering Hey guys here's the situation:\nWe have a woocommerce site hooked up with woocommerce product filters - the filter works perfectly on category pages, however, we have a custom taxonomy template for taxonomies we have added to the site.\nFor example if you were to have a WC site selling apples, you have multiple different categories of apples but you also have a custom taxonomy of apple colour.\nFor the apple color archive page, the filters that work on category page now longer have no effect:\nHere is my template code:\n\n\n       $term = get_queried_object();\n       $image = wp_get_attachment_url( $thumbnail_id ); \n           $params = array(\n               'posts_per_page' => 20, \n               'post_type' => 'product' , \n               'tax_query' => array(\n                   array(\n                       'taxonomy' => 'style',\n                       'terms' => $term\n                   )\n               )\n               );\n\n\n\n       \n\n       \n\n$wc_query = new WP_Query($params); // (2)\n?>\n\n<?php if ($wc_query->have_posts()) : // (3) ?>\n<?php while ($wc_query->have_posts()) : // (4)\n               $wc_query->the_post(); // (4.1) ?>\n\n                           \n                           \n\n<div class=\"col-md-3 style__col\">\n   <?php the_post_thumbnail(); ?> \n   <h3 class=\"loop-subcategory__title style__title\"> <?php the_title(); // (4.2) ?> </h3> \n   <a class=\"loop-subcategory__view btn btn-primary style__view\" href=\"<?php the_permalink(); ?>\">View Product</a>\n</div>\n\n   \n       <?php endwhile; ?>\n<?php wp_reset_postdata(); // (5) ?>\n<?php else:  ?>\n<p>\n    <?php _e( 'No Products' ); // (6) ?>\n</p>\n\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405261", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to prevent to create same url of post, if the previous was deleted? Let's say I'm creating a post, it's URL will be:\nwww.example.com/posts/test-article\n\nso far so good. Then, I delete it and also remove from trash bin.\nAgain, I create with the same title, and the URL will be:\nwww.example.com/posts/test-article\n\nthat's no good, I would like to get:\nwww.example.com/posts/test-article1\n\nand so on. How to achieve that?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405262", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why does admin_body_class not work? I'm trying to add the body class of the current user role to both the frontend and the admin backend.\nWhy does admin_body_class not work for admin?\nThe comment to this question does not work: How to insert the current user's role into the body class in the admin backend\nThis works for the front end in the theme's functions.php file:\nadd_filter(\"body_class\", function($classes) {\n    global $current_user;\n    foreach ($current_user->roles as $user_role) {\n        $classes[] = \"role-{$user_role}\";\n    }\n    return $classes;\n});\n\nThis does not work for the backend in the theme's functions.php file:\nadd_filter(\"admin_body_class\", function($classes) {\n  $user = wp_get_current_user();\n  foreach ($user->roles as $user_role) {\n    $classes .= \" role-{$user_role}\";\n  }\n  return $classes;\n});\n\n\nA: This works for the admin backend; I needed to restructure the filter to be able to add a priority:\nfunction add_admin_body_class($classes) {\n$user = wp_get_current_user();\nforeach ($user->roles as $user_role) {\n    $classes .= \" role-{$user_role}\";\n  }\n  return $classes;\n}\nadd_filter(\"admin_body_class\", \"add_admin_body_class\", 9999);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405264", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can't log into wordpress site - I have made a new user and still cant access I recently took over website management for my company but I can not access 1 of our sites.\nThe user name and password provided by the last management team does not work. I refrenced my Wp-Config to determine which SQLdb was being used. Then accessed phpMyAdmin and reviewed the wp_user table for the db and the user they provided was not even listed. I edited the existing admin user password (using MD5) and still could not log in with that user/pass combo. I then made an entirely new admin user following this guide - https://wpengine.com/support/add-admin-user-phpmyadmin/ - and that user does not work. I cant even do a \"lost my password\" for that second users email address. I'm concerned the website is somehow using a different database? I have verified multiple times that I'm in the SQLdb listed in wp-config.\nAny advice would be greatly appreciated.\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405266", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there builtin way to use protected AJAX endpoint? Usually I declare \"protected\" endpoints as this. So logged in users can use this endpoint.\nadd_action( 'wp_ajax_my_action', 'my_action_callback' );\n\nIs there a way to make it only accessible to administrators (and not other users)?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405270", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Display post in order of ACF checkbox? I have a custom post type called \u2018Skateboards\u2019. Within the custom post type of \u2018Skateboards\u2019 , I added three checkboxes (filed type checkbox) with a field name of \u2018skateboard_performance\u2019 associated to the \u2019Skateboards\u2019 custom post type via ACF.  The values of the  three check boxes are \u2018Platinum\u2019 , \u2018Gold\u2019 and \u2018Silver \u2019.\nWhat I am trying to accomplish is to display the \u2018Skateboards\u2019 post type in order of \u2018Platinum\u2019 , \u2018Gold\u2019 and \u2018Silver\u2019.\nSo all of the Skateboards posts marked with \u2018Platinum\u2019 checkbox will display 1st. Followed by all Skateboards posts marked with \u2018Gold\u2019 checkbox to display 2nd and then all skateboards posts marked with \u2018Silver\u2019 to display 3rd.\nAny ideas on what the $args to do that would look like?\nSo far i got up to here but I am having difficulty ordering them correctly :\n\n$args = get_posts(array(\n\u2018post_type\u2019 => \u2018skateboards\u2019, //insert the correct post_type name\n\u2018posts_per_page\u2019 => -1,\n\u2018meta_key\u2019 => \u2018skateboard_performance\u2019, //sample acf field name\n\u2018orderby\u2019 => \u2018meta_value\u2019,\n\u2018order\u2019 => \u2018ASC\u2019\n));\n\n\n\nA: Given that this order you desire is unfortunately not alphabetical (although that wouldn't be very scaleable... but it would be handy). You might make life easier on yourself by adding another custom field called (say) \"display_order\". Then add the numbers 1,2 and 3 to that field, and then query the post type ordering by these values.\nAs far as I can see, it's that or running three separate queries to retrieve the three \"levels\" of board. Or some madder idea of retrieving them via one query into an array, and ordering that array as you require.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405271", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: show a specific metabox dependent on the page template For a few days I am trying to show a specific metabox dependent on the page template. I can do it but my problem is when I have selected a page template and hit the update button then the metabox does not show. metabox is showing when I reload the page. Actually, I want when I will hit the update button then the metabox will be shown. please help me.\nNote: I use CMB2 for meta boxes.\nI tried this way\nfunction cmb2_add_pricingtable() {\n\n    $prefix = '_next_pt_';\n\n    $cmb = new_cmb2_box( array(\n        'id'           => $prefix . 'pricing_table',\n        'title'        => __( 'Pricing Table', 'next' ),\n        'object_types' => array( 'page' ),\n        'context'      => 'normal',\n        'priority'     => 'high',\n        'show_names'    => true,\n    ) );\n\n    $group=$cmb->add_field( array(\n        'name' => __( 'Pricing Table', 'next' ),\n        'id' => $prefix . 'pricing_table',\n        'type' => 'group',\n    ) );\n    $cmb->add_group_field($group, array(\n        'name' => __( 'Caption', 'next' ),\n        'id' => $prefix . 'price_caption',\n        'type' => 'text',\n        \n    ) );\n\n    $cmb->add_group_field($group, array(\n        'name' => __( 'Price Option', 'next' ),\n        'id' => $prefix . 'price_option',\n        'type' => 'text',\n        'repeatable'=>true,\n    ) );\n    $cmb->add_group_field($group, array(\n        'name' => __( 'Price', 'next' ),\n        'id' => $prefix . 'price',\n        'type' => 'text',\n        \n    ) );\n\n}\n\n$post_id = null;\nif(isset($_REQUEST['post']) || isset($_REQUEST['post_ID'])){\n    $post_id = empty($_REQUEST['post_ID']) ? $_REQUEST['post'] : $_REQUEST['post_ID'];  \n}\n\n$pageTemplate=get_post_meta( $post_id, '_wp_page_template', true );\n\nif('price-page-template.php'==$pageTemplate){\n    add_action( 'cmb2_init', 'cmb2_add_pricingtable' ); \n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405272", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: mysql - Delete keyword with link from wordpress post database I have a problem and if anyone can help thanks in advance.\nI want to remove some stuffed keyword with link from my wordpress post table example of link\n<a href=\"http://example.com/keyword/\">keyword</a>\n\nI have some posts since 2011 and it`s quite hard to edit all those posts to remove the links....\nI wonder if i can use this code UPDATE wp_posts SET post_content = replace(post_content, '<a href=\"example.com/keyword/\">keyword</a>', '' ) ;\nAny help is most welcome\nRegards\nDaniel\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405275", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce inventory I'm working on woocommerce project and I need to check inventory status via external API before I create order. It is a cash register system in physical store that I can't change.\nI'm using\n\nwoocommerce_checkout_order_processed\n\nhook to add my logic here but I'm not sure how can I prevent order from saving if invenotry over API changed in meantime. So the flow I need here is:\n\n*\n\n*User wants to buy 10 items, adds them to cart\n\n*User clicks 'Place Order'\n\n*hook is activated\n\n*api is triggered and it returns that only 5 are available at the moment\n\n*show message and don't save order\n\n\nA: The woocommerce_checkout_order_processed hook is too late. The order has already been created. You'd probably want to hook into woocommerce_after_checkout_validation so that you can check for the inventory before the order is even triggered and set an error that will be displayed at checkout.\nBy hooking in here, you will be able to short circuit the order creation with the error notice.\nYou can find more details about this in the WC_Checkout class.\nSee: https://github.com/woocommerce/woocommerce/blob/trunk/plugins/woocommerce/includes/class-wc-checkout.php#L849-L890\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405276", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I apply an ACF field to a single custom post if it refers to the taxomy of that post type in the rules? need to hide a div inside custom posts in a given category. I created an ACF True/False field and applied it to the category taxonomy for this post type. But this True/false should work on internal records that refer to the selected category to which ACF True/false is applied. I understand that there must be something like this ... but what exactly, I do not know) :\n$terms= something here that I don't know..) ;\n<?php if ( 'yes' == get_field('name_field',$terms)): ?>\n\n....\nPS: Perhaps I'm not entirely competent of the above. The logic is this: I check the box, inside the category, that I need to hide the div, in all case records associated with this category, the div is hidden.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405283", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom page from wp admin area I would like to display custom page from Wordpress admin area.\nMy plugin code is as follows:\nadd_action('admin_menu', 'apvr_admin_menu');\n\nfunction apvr_admin_menu(){\n\n    add_menu_page(esc_html__(\"Virtual Reality Viever\", APVR_TEXTDOMAIN), esc_html__(\"Virtual Reality Viever\", APVR_TEXTDOMAIN), APVR_CAPABILITY, \"apvr_settings\", \"apvr_settings_page\", plugins_url('assets/menu.png', __FILE__));\n\n}\n\nfunction apvr_settings_page(){\n\n    include(\"includes/settings.php\");\n\n}\n\nThis displays a section within Wordpress admin area (Wordpress menu being on the left and top bar): \nFrom this section I would like to have an option to redirect to another page (in which there will be no other elements like Wordpress menu etc, just my own content). and then option to return  back to this page.\nHow could I achieve that?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405288", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display all categories but only if they have posts in them that have a specific tag assigned I have a WooCommerce site and am working on the product tag pages. I want to display every product that is assigned to that tag, and break them up into their individual categories (this bit is working).\nThe only issue I am having is it is displaying every single category, even if 0 products in the current tag have that assigned.\n<?php $tag_id = get_queried_object(); ?>\n\n  <div id=\"product-list\" class=\"product-list\">\n\n    <?php // Get all products inside the current tag ?>\n    <?php $collectionProducts = array(\n      'post_type' => 'product',\n      'order' => 'ASC',\n      'hide_empty' => true,\n      'parent' => 0,\n      'taxonomy' => 'product_tag',\n      'field' => 'slug',\n      'terms' => $tag_id->slug\n    );\n\n    // Get list of categories, but only display them if they have products with the current tag assigned \n    //(THIS BIT ISN'T WORKING)\n\n    $child_terms = get_categories( array(\n      'parent' => 0,\n      'hide_empty' => true,\n      'taxonomy' => 'product_cat',\n      'tax_query' => array (\n        'taxonomy' => 'product_tag',\n        'field' => 'slug',\n        'terms' => $tag_id->slug,\n        'operator' => 'IN'\n      )\n    ));\n    ?>\n\n      <?php // List products, broken down by category ?>\n      <?php foreach($child_terms as $child_term) { \n        $shortcode = do_shortcode('[products tag=\"' . $tag_id->slug .'\" category=\"' . $child_term->slug . '\" per_page=\"-1\" columns=\"3\" orderby=\"date\"]');\n      ?>\n\n        <div class=\"product-list-single-category\" id=\"<?php echo $child_term->slug; ?>\">\n          <div class=\"title\">\n            <h3><?php echo $child_term->name; ?></h3>\n          </div>\n          <?php echo $shortcode; ?>\n        </div>\n      <?php } ?>\n\n    </div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405289", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Category post count is not correct When I go to Posts > Categories, some categories show that they have a post. See screenshot. But there are no posts linked to that category. When you click on that \"1\"-number, no posts are shown.\n\nThis is an issue because my blog page shows the category title and description even if there are no actual posts linked to that category (Wedge-system - see screenshot).\nThis is how I loop over all the categories and show the posts from that category:\n<?php\n$loop = new WP_Query( array(\n                            'post_type' => 'Post',\n                            'posts_per_page' => $post_per_page,\n                            'tax_query' => array(\n                                array(\n                                    'taxonomy' => 'category',\n                                    'field'    => 'id',\n                                    'terms'    => array( $category->term_id ),\n                                    'operator' => 'IN'\n                                ),\n                            ),\n                        )\n                        );\n?>\n\n<?php while ( $loop->have_posts() ) : $loop->the_post(); ?>\n    /* post template here */\n<?php endwhile; wp_reset_query(); ?>\n\n\nA: You're a post type that doesn't exist, there is no Post post type, did you mean post?\n\nSidenotes:\n\n*\n\n*wp_reset_query is only for use after query_posts you should be using wp_reset_postdata instead.\n\n*There is no if ( $loop->have_posts() ) check so if no posts are found there is no message and it looks like the page is broken\n\n*This page would be much faster if you used category archives for your category archives, then used pre_get_posts to modify the query, instead of a page template and a brand new custom query\n\n*\n\n*if you are doing this on category.php or archive.php then you're doubling the number of queries so that you can change posts_per_page, use pre_get_posts to change it instead\n\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405290", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Uncaught TypeError: switchEditors.switchto is not a function I have the following line of code:\nswitchEditors.switchto(ctmce[0]);\n\nwhich gives this error:\nUncaught TypeError: switchEditors.switchto is not a function\n\nSearching around I found out that, due to changes to the core in WordPress 4.3, switchEditors.switchto() is not available/usable now.\nDo you know how can I fix it?\nYou can see the complete code here.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405292", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get specific setting by settings_fields()? I am working on a plugin and on the settings page I have 2 settings\nand I want to show Only one setting \"backgroundColor\" so how should i do that?\nThis is the code:\n<form action=\"options.php\" method=\"post\">\n<?php\n    settings_errors();\n\n    settings_fields( 'bg_color' );  **<<< I want only background settings to show how i can do it correclty?**\n\n    do_settings_sections( 'plugin-style' );\n\n    submit_button( __('Save settings', 'trans') );\n                                        ?>\n</form>\n\n\n        /* Add Settings Field for Background Color */\n    add_settings_field(\n        'background-color',\n        __('Background Color', 'trans'),\n        'plugin_background_color_ca',\n        'plugin-style',\n        'style-settings-section-2',\n        array(\n            'name'      => 'bg_color',\n            'id'        => 'style-settings-background-color',\n            'class'     => 'style-settings-background-color',\n            'options'   => $style_opts,\n        )\n    );\n\n    /* Add Settings Field for Font Size */\n    add_settings_field(\n        'st-search-font-size',\n        __('Font Size', 'trans'),\n        'plugin_font_size_ca',\n        'plugin-style',\n        'style-settings-section-2',\n        array(\n            'name'      => 'font_size',\n            'id'        => 'style-settings-font-size',\n            'class'     => 'style-settings-font-size',\n            'options'   => $style_opts,\n        )\n    );\n\nN\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405295", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: What does the underscore translate function do in my code without a textdoman I am hooking into comment_form_default_fields doing some heavy string replacements.\nThere are translated strings like __( 'Name' ) in there. I need the text.\nI have two or three different ways to solve this.\n\n*\n\n*I could just use my own text domain, but that would mean I have to provide my own translation for my code, do not like that. Especially because I just reuse already translated strings.\n\n*Extract the text (with regex). Better but not a huge fan either.\n\n*Just use the same words __( 'Name' ) as in core without textdomain?\n\nThe translation is done by lines in files to some extent I think, but when lines change the translations do not suddenly stop to work correctly, but I think there can be different translation for the same world, and it will pick the right ones. If the translation is properly done.\nMy question is what actually happens when I use no domain? Will it work at all? Will it just pull the first translation for a word it can find in WP core?\n\nA: In the __() documentation, it says\n\nIf there is no translation, or the text domain isn\u2019t loaded, the original text is returned.\n\nAlso, if you don't provide a textdomain, then 'default' is used.\nSo, essentially, __( 'Name' ) will try to find a translation in the 'default' domain, and, failing that, return 'Name'.\nIf you do provide your own textdomain (eg __( 'Name', 'my-plugin-text-domain' )) but no translations, then the untranslated string will be used. There is, as far as I know, no downside to this, and it has the upside of making your theme or plugin translatable by you or others who wish to do it in the future.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405296", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Custom Fields - How to create a list from multi-line entries of a single value If I have the following name/value pair for a custom field....\n\n...is there a PHP loop process I can apply that will allow me to display them on the front-end as individual values because there is a line-break between each item?\nor do I have to create multiple name/value pairs for each item?\nThe end goal in my case is to create a list on the front end of these items that are being pulled from this value area.\nThanks for any tips!\n\nA: Yes, grab the value via get_post_meta, then it's just a matter of generic PHP loops and string manipulation.\nTry using the explode function with \\n as the separator to create an array you can loop through. You may need to check for empty values since some of your lines are blank, but the get_post_meta part is the only part of this question that requires WordPress knowledge:\n$data = get_post_meta( $post_id, 'What Responsibilities Will I have?', true );\n$lines = explode( '\\n', $data );\n\n// now do things with the $lines array\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405297", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Mailing issues with wordpress? I'm working on a client's website and they are not getting messages from the site anymore.\nI've found that no mail will go to an email address ending in @gmail.com, I can send mail just fine to anyone within my company that has an email with a custom domain. But a Gmail inbox the messages never even seem to make get close. They're not in spam, not in promotions, nowhere.\nI've installed WP mail log, and see no errors on the site. It doesn't appear to be an SMTP issue as I can send messages just fine.\nI know this is not explicitly a WordPress issue but I've run out of ideas and options to try so if anyone has encountered this and has any ideas it would be appreciated.\n\nA: Ended up setting up Gmail SMTP through the Gmail API, and this seemed to solve the problem in this case.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405301", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change the behaviour of a button I'm using Flatesome theme and I have a use case that I need to refresh the page after closing the popup, I'm wondering if I can change the behavior of the close button in Lightbox Popup so instead of closing the popup only I want it also to reload the page, This will be the best solution for my need and if it's not possible to do it this way, Can I change the whole function of the close button so it goes to a specific page instead of closing the popup?\nI see they have filter (Lightbox: close button) but it only covers how to change the button position either inside or outside and the markup icon.\n\n1-flatsome_lightbox_close_btn_inside\nThe  flatsome_lightbox_close_btn_inside filter allows changing the lightbox close button position. Inside (true) or outside (false).\n<?php // Do not include this if already open!\n\nadd_filter( 'flatsome_lightbox_close_btn_inside', '__return_true' );\n\n2-flatsome_lightbox_close_button\nThe  flatsome_lightbox_close_button filter allows changing the lightbox close button markup.\n<?php // Do not include this if already open!\n\nadd_filter( 'flatsome_lightbox_close_button', function ( $html ) {\n    $html = '<button title=\"%title%\" type=\"button\" class=\"mfp-close\">';\n    /* f.ex. We're replacing the SVG icon into another one. */\n    $html .= '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 475.2 475.2\" width=\"28\" height=\"28\"><path d=\"M405.6 69.6C360.7 24.7 301.1 0 237.6 0s-123.1 24.7-168 69.6S0 174.1 0 237.6s24.7 123.1 69.6 168 104.5 69.6 168 69.6 123.1-24.7 168-69.6 69.6-104.5 69.6-168-24.7-123.1-69.6-168zm-19.1 316.9c-39.8 39.8-92.7 61.7-148.9 61.7s-109.1-21.9-148.9-61.7c-82.1-82.1-82.1-215.7 0-297.8C128.5 48.9 181.4 27 237.6 27s109.1 21.9 148.9 61.7c82.1 82.1 82.1 215.7 0 297.8z\" data-original=\"#000000\" class=\"active-path\" data-old_color=\"#000000\" fill=\"#FFF\"/><path d=\"M342.3 132.9c-5.3-5.3-13.8-5.3-19.1 0l-85.6 85.6-85.6-85.6c-5.3-5.3-13.8-5.3-19.1 0-5.3 5.3-5.3 13.8 0 19.1l85.6 85.6-85.6 85.6c-5.3 5.3-5.3 13.8 0 19.1 2.6 2.6 6.1 4 9.5 4s6.9-1.3 9.5-4l85.6-85.6 85.6 85.6c2.6 2.6 6.1 4 9.5 4 3.5 0 6.9-1.3 9.5-4 5.3-5.3 5.3-13.8 0-19.1l-85.4-85.6 85.6-85.6c5.3-5.3 5.3-13.8 0-19.1z\" data-original=\"#000000\" class=\"active-path\" data-old_color=\"#000000\" fill=\"#FFF\"/></svg>';\n    $html .= '</button>';\n\n    return $html;\n} );\n\nLightbox: close button\nAny example of how can I achieve that using these filters? either reload the page after clicking the close button or open a specific page when clicking the close button instead of closing the popup?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405303", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Plugin main file is constantly been fired on every website visit Greetings to everyone!\nI'm working on a WordPress plugin, and while debugging something with the error_log function in the plugin main file, I noticed that the main plugin file is constantly fired...\nThe plugin is more complex but it's stracture can be considered as:\nmyplugin:\n-- myplugin.php\n-- fileA.php\n-- fileB.php\n\nIn myplugin.php the code is like this:\nif (!defined(\"ABSPATH\")) {\n    exit();\n}\ninclude_once plugin_dir_path(__FILE__) . \"fileA.php\";\ninclude_once plugin_dir_path(__FILE__) . \"fileB.php\";\n\nclass main_class\n{\n    static function __construct()\n    {\n        error_log(\"in install main_class\");\n        new FileAclass();\n        new FileBclass();\n    }\n}\n$test = new main_class();\nerror_log(\"after test\");\n\nand the fileA.php, fileB.php like this respectively:\nclass FileAclass{\n    error_log(\"in class FileAclass\");\n    function __construct(){\n    add_action(...)\n    }\n}\n\nclass FileBclass{\n    error_log(\"in class FileBclass\");\n    function __construct(){\n    add_action(...)\n    }\n}\n\nPlease, note that the above is just a pseudocode. Let me know if the original code might be helpful.\nWhen I zip the plugin and upload it the activation is done without errors but the debug file is like this:\nin install main_class\nin class FileAclass\nin class FileBclass\nafter test\nin install main_class\nin class FileAclass\nin class FileBclass\nafter test\nin install main_class\nin class FileAclass\nin class FileBclass\nafter test\n...\n\nand the above text is repeated while navigating in the website (front and in wp-admin).\nWhat I have tried and didn't work:\n\n*\n\n*with and without the register_activation_hook and __construct in the classes\n\n*with register_activation_hook and :: notation without __construct just by calling a install() static function in the classes\n\n*deleted everything in the main page and left only the error_log(\"some text\"). That made me crazy... the same thing happened...\n\n*wrapped the $test = main_class(); code with if (class_exists) logic\n\n*installed the plugin in other domain with shared hosting instead of a VPS\n\nReally, I have tried everything I could think of and find through google searches.\nAny ideas why this happens???\nIs the above behavior normal?\nThank you in advance.\n\nA: Ofcourse! It always loads and runs the code in the main plugin file, that's by design and is how plugins are intended to work. Why would it work any other way? How would it know without being told which code to run when?\nThere are no  sandboxes that ensure your classes only work in certain scenarios, they're still written in the PHP programming language. Computers are very literal, it always runs because you never told it not to run in certain situations.\nWordPress will load your activated plugins and your themes functions.php files, which are just PHP files that get executed. Anything you do in those files will run, wether it's a frontend request, admin area, REST API, or even an RSS feed. It will run and any that is not in an action will immediately run, and it isn't sandboxed or cordoned off from the rest of WordPress or the other activated plugins. It's all loaded into the same memory at the same time in a single shared space.\nSo What Should I do?\nWhat you need to do, is use actions to schedule when things are meant to happen. If you want to specify that something should only happen in a certain situation, you have to implement that yourself via hooks and if statements. Doing things in the main plugin files outside of actions other than adding actions and filters or loading more PHP files is ill-advised.\nFor example, you should only register admin pages when in WP Admin, so you would hook into the admin_init event and do work there, ensuring the code does not run on the frontend and other locations. Likewise you would register REST API endpoints for AJAX on rest_init. This also improves performance.\nThe rare exception is uninstall.php. If no uninstallation hook is registered it will load uninstall.php when a plugin is uninstalled. This is because you can't register an uninstallation hook if the plugin is not activated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405306", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Programmatically creating site in a network Goal\nCreate multiple, predefined sites using wordpress multisite on plugin activation.\nCurrent Code\n    $domains = array('however', 'many', 'hardcoded', 'subdomains',);\n\n    foreach($domains as $domain){\n        $meta = array(\n            'public' => 1,\n            'WPLANG' => '',\n        );\n        $newdomain = $domain . '.' . preg_replace( '|^www\\.|', '', get_network()->domain );\n        $user_id  = get_option('admin_email');\n        $id = wpmu_create_blog( $newdomain, get_network()->path, $domain, $user_id, $meta, get_current_network_id() );\n        if ( ! is_wp_error( $id ) ) {\n            update_user_option( $user_id, $domain, $id, true );\n        }\n    }\n}\n\nCurrent Functionality\nThe code creates the sites and they are listed on the sites page in the network admin panel.\nCurrent Issues\nSites created with this code don't have a user set as admin. The sites are also not listed in the 'my sites' drop down., but I'm willing to bet that it's because there's no admin set on the sites.\nWhere I need help\nI've sifted through the files in the wp-admin/network and can't figure out what function I'm needing to incorporate that sets a user as an admin of a subnetwork site. What function would I need to finish off the plugin activation code?\n\nA: You're using $user_id = get_option( 'admin_email' ); and then using that $user_id. However, get_option( 'admin_email' ); returns an email address, not the int that wpmu_create_blog() expects. So your sites are (presumably) being created with a user_id of 0.\nHere's how I'd address this:\n$user_email  = get_option('admin_email');\n$user_object = get_user_by( 'email', $user_email );\nif ( false !== $user_object ) {\n    $user_id = $user_object->ID;\n}\n$id = wpmu_create_blog( $newdomain, get_network()->path, $domain, $user_id, $meta, get_current_network_id() );\n\nReferences\n\n*\n\n*wpmu_create_blog()\n\n*get_user_by()\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405311", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Script widget works only in admin view but not in Public Script Widget bug in WordPress.\nThe embed widget from Funda was working before, clueless why it suddenly stopped working. In Public view, it's not working. Preview mode while logged in to WordPress shows the correct page.\nActually, the same embedded script from FUNDA is working on this page\nhttps://www.homecrew.nl/rent-out/. But the issue is with this page. The script isn\u2019t working on this page https://www.homecrew.nl/reviews-recensies-beoordelingen-klanten-engels/. The Editor & method of placing the script is the same. I cleared the cache etc. But still, the issue is there.\nHere is the screenshot attached of the working script. https://ibb.co/MZD5Tqb\nThis script isn't working in this image https://ibb.co/0c57zK3\nMay be a difference in the script here. only script tags is not working. But in 1st picture script tag is with ...\nEither the script can be executed within the post or I have to place this script in the head tag etc. I'm using beTheme WordPress\nI found this on Wpbegginer. Is this okay to add a script in funcations.php for this specific page id?\nAdding JavaScript to a Specific WordPress Post Using Code\nIf you only want to add JavaScript to a single WordPress post, then you will need to add conditional logic to the code.\n    function wpb_hook_javascript() {\n  if (is_single ('5')) { \n    ?>\n        <script type=\"text/javascript\">\n          // your javscript code goes here\n        </script>\n    <?php\n  }\n}\nadd_action('wp_head', 'wpb_hook_javascript');\n\nThanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405313", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Where is this text in a wordpress email coming from? Want to change/remove I vaguely remember adding this text somehow (\"Thank you for trying our product. We hope it brings you joy.\") during some late night coding session. However, I've since forgot and want to remove it very much. I've looked all through the settings and can't find where it was added. Please advise!\n\n\nA: That looks like an order note for the specific product. Check the order notes under advanced when editing the product.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405314", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add WordPress user custom meta to chartjs vertically stacked chart in Divi theme I have created a user dashboard using the Divi theme where I need to add a chart like the attached screenshot. The data are specific for every different user. I have tried many premium plugins but none of them fits my requirement.\nThis is how I added the user meta -\n<?php\nfunction hfa_custom_user_fields( $user ) {\n    $services_subscribed_options = array(\n        'Airbnb' => 'Airbnb',\n        'Vrbo' => 'Vrbo',\n        'Trucking' => 'Trucking'\n    );\n    $services_subscribed = get_user_meta($user->ID, 'services_subscribed', true);\n    $services_subscribed = (array)unserialize($services_subscribed);\n    $total_invest = get_user_meta($user->ID, 'total_invest', true);\n    $total_invest = empty($total_invest) ? '0' : $total_invest;\n    $total_spent = get_user_meta($user->ID, 'total_spent', true);\n    $total_spent = empty($total_spent) ? '0' : $total_spent;\n    $total_made = get_user_meta($user->ID, 'total_made', true);\n    $total_made = empty($total_made) ? '0' : $total_made;\n    $airbnb_invest = get_user_meta($user->ID, 'airbnb_invest', true);\n    $airbnb_invest = empty($airbnb_invest) ? '0' : $airbnb_invest;\n    $airbnb_spent = get_user_meta($user->ID, 'airbnb_spent', true);\n    $airbnb_spent = empty($airbnb_spent) ? '0' : $airbnb_spent;\n    $airbnb_made = get_user_meta($user->ID, 'airbnb_made', true);\n    $airbnb_made = empty($airbnb_made) ? '0' : $airbnb_made;\n    $vrbo_invest = get_user_meta($user->ID, 'vrbo_invest', true);\n    $vrbo_invest = empty($vrbo_invest) ? '0' : $vrbo_invest;\n    $vrbo_spent = get_user_meta($user->ID, 'vrbo_spent', true);\n    $vrbo_spent = empty($vrbo_spent) ? '0' : $vrbo_spent;\n    $vrbo_made = get_user_meta($user->ID, 'vrbo_made', true);\n    $vrbo_made = empty($vrbo_made) ? '0' : $vrbo_made;\n    $trucking_invest = get_user_meta($user->ID, 'trucking_invest', true);\n    $trucking_invest = empty($trucking_invest) ? '0' : $trucking_invest;\n    $trucking_spent = get_user_meta($user->ID, 'trucking_spent', true);\n    $trucking_spent = empty($trucking_spent) ? '0' : $trucking_spent;\n    $trucking_made = get_user_meta($user->ID, 'trucking_made', true);\n    $trucking_made = empty($trucking_made) ? '0' : $trucking_made;\n    $output = '';\n    $output .= '<table class=\"form-table\">';\n        $output .= '<tr>';\n            $output .= '<th colspan=\"2\">';\n                $output .= '<h1>Hands-free Automation Services Subscription Information</h1>';\n            $output .= '</th>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"automation_services\">'.__('Services Subscribed','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                foreach($services_subscribed_options as $key=>$item){\n                    $output .= '<label><input'.(in_array($key,$services_subscribed) ? ' checked':'').' type=\"checkbox\" value=\"'.$key.'\" name=\"services_subscribed[]\" />&nbsp;'.$item.'</label>&nbsp;&nbsp;&nbsp;&nbsp;';\n                }\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th colspan=\"2\">';\n                $output .= '<h3>Total Subscription Informations</h3>';\n            $output .= '</th>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"total_invest\">'.__('Money Invest','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$total_invest.'\"  type=\"number\" id=\"total_invest\" name=\"total_invest\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"total_spent\">'.__('Money Spent','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$total_spent.'\"  type=\"number\" id=\"total_spent\" name=\"total_spent\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"total_made\">'.__('Money Made','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$total_made.'\"  type=\"number\" id=\"total_made\" name=\"total_made\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th colspan=\"2\">';\n                $output .= '<h3>Airbnb Informations</h3>';\n            $output .= '</th>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"airbnb_invest\">'.__('Money Invested','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$airbnb_invest.'\"  type=\"number\" id=\"airbnb_invest\" name=\"airbnb_invest\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"airbnb_spent\">'.__('Money Spent','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$airbnb_spent.'\"  type=\"number\" id=\"airbnb_spent\" name=\"airbnb_spent\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"airbnb_made\">'.__('Money Made','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$airbnb_made.'\"  type=\"number\" id=\"airbnb_made\" name=\"airbnb_made\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th colspan=\"2\">';\n                $output .= '<h3>Vrbo Informations</h3>';\n            $output .= '</th>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"vrbo_invest\">'.__('Money Invest','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$vrbo_invest.'\"  type=\"number\" id=\"vrbo_invest\" name=\"vrbo_invest\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"vrbo_spent\">'.__('Money Spent','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$vrbo_spent.'\"  type=\"number\" id=\"vrbo_spent\" name=\"vrbo_spent\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"vrbo_made\">'.__('Money Made','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$vrbo_made.'\"  type=\"number\" id=\"vrbo_made\" name=\"vrbo_made\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th colspan=\"2\">';\n                $output .= '<h3>Trucking Informations</h3>';\n            $output .= '</th>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"trucking_invest\">'.__('Money Invest','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$trucking_invest.'\"  type=\"number\" id=\"trucking_invest\" name=\"trucking_invest\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"trucking_spent\">'.__('Money Spent','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$trucking_spent.'\"  type=\"number\" id=\"trucking_spent\" name=\"trucking_spent\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n        $output .= '<tr>';\n            $output .= '<th><label for=\"trucking_made\">'.__('Money Made','handsfreeautomation').'</label></th>';\n            $output .= '<td>';\n                $output .= '<input value=\"'.$trucking_made.'\"  type=\"number\" id=\"trucking_made\" name=\"trucking_made\" placeholder=\"\" />';\n            $output .= '</td>';\n        $output .= '</tr>';\n    $output .= '</table>';\n    echo $output;\n}\n\nadd_action( 'show_user_profile', 'hfa_custom_user_fields' );\nadd_action( 'edit_user_profile', 'hfa_custom_user_fields' );\n\nfunction hfa_custom_user_fields_save( $user_id ) {\n\n    if ( !current_user_can( 'edit_user', $user_id ) ) {\n        return false;\n    }\n    update_user_meta($user_id, 'services_subscribed', serialize($_POST['services_subscribed']));\n    update_user_meta($user_id, 'total_invest', $_POST['total_invest']);\n    update_user_meta($user_id, 'total_spent', $_POST['total_spent']);\n    update_user_meta($user_id, 'total_made', $_POST['total_made']);\n    update_user_meta($user_id, 'airbnb_invest', $_POST['airbnb_invest']);\n    update_user_meta($user_id, 'airbnb_spent', $_POST['airbnb_spent']);\n    update_user_meta($user_id, 'airbnb_made', $_POST['airbnb_made']);\n    update_user_meta($user_id, 'vrbo_invest', $_POST['vrbo_invest']);\n    update_user_meta($user_id, 'vrbo_spent', $_POST['vrbo_spent']);\n    update_user_meta($user_id, 'vrbo_made', $_POST['vrbo_made']);\n    update_user_meta($user_id, 'trucking_invest', $_POST['trucking_invest']);\n    update_user_meta($user_id, 'trucking_spent', $_POST['trucking_spent']);\n    update_user_meta($user_id, 'trucking_made', $_POST['trucking_made']);\n}\n\nadd_action( 'personal_options_update', 'hfa_custom_user_fields_save' );\nadd_action( 'edit_user_profile_update', 'hfa_custom_user_fields_save' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405316", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom post type category link redirecting to 404 page I have created a custom post type. There is no issue with post and it's working. I am getting issue in the catgory links. When i click on the Category name it's redirecting on 404 page\nI am getting category link like https://example.co/blog/categoryname/\nI have tried to reset the peramlink but still getting issues.\nfunction create_blog_cpt() {\n\n  $labels = array(\n    'name' => _x( 'blogs', 'Post Type General Name', 'blogsdomain' ),\n    'singular_name' => _x( 'blog', 'Post Type Singular Name', 'blogsdomain' ),\n    'menu_name' => _x( 'Blogs', 'Admin Menu text', 'blogsdomain' ),\n    'name_admin_bar' => _x( 'blog', 'Add New on Toolbar', 'blogsdomain' ),\n    'archives' => __( 'blog Archives', 'blogsdomain' ),\n    'attributes' => __( 'blog Attributes', 'blogsdomain' ),\n    'parent_item_colon' => __( 'Parent blog:', 'blogsdomain' ),\n    'all_items' => __( 'All blogs', 'blogsdomain' ),\n    'add_new_item' => __( 'Add New blog', 'blogsdomain' ),\n    'add_new' => __( 'Add New', 'blogsdomain' ),\n    'new_item' => __( 'New blog', 'blogsdomain' ),\n    'edit_item' => __( 'Edit blog', 'blogsdomain' ),\n    'update_item' => __( 'Update blog', 'blogsdomain' ),\n    'view_item' => __( 'View blog', 'blogsdomain' ),\n    'view_items' => __( 'View blogs', 'blogsdomain' ),\n    'search_items' => __( 'Search blog', 'blogsdomain' ),\n    'not_found' => __( 'Not found', 'blogsdomain' ),\n    'not_found_in_trash' => __( 'Not found in Trash', 'blogsdomain' ),\n    'featured_image' => __( 'Featured Image', 'blogsdomain' ),\n    'set_featured_image' => __( 'Set featured image', 'blogsdomain' ),\n    'remove_featured_image' => __( 'Remove featured image', 'blogsdomain' ),\n    'use_featured_image' => __( 'Use as featured image', 'blogsdomain' ),\n    'insert_into_item' => __( 'Insert into blog', 'blogsdomain' ),\n    'uploaded_to_this_item' => __( 'Uploaded to this blog', 'blogsdomain' ),\n    'items_list' => __( 'blogs list', 'th-blogs' ),\n    'items_list_navigation' => __( 'blogs list navigation', 'blogsdomain' ),\n    'filter_items_list' => __( 'Filter blogs list', 'blogsdomain' ),\n  );\n  $args = array(\n    'label' => __( 'blog', 'blogsdomain' ),\n    'description' => __( '', 'blogsdomain' ),\n    'labels' => $labels,\n    'menu_icon' => 'dashicons-book-alt',\n    'supports' => array('title', 'editor', 'excerpt', 'thumbnail'),\n    'taxonomies' => array('blogs_cats'),\n    'public' => true,\n    'show_ui' => true,\n    'show_in_menu' => true,\n    'menu_position' => 5,\n    'show_in_admin_bar' => true,\n    'show_in_nav_menus' => true,\n    'can_export' => true,\n    'has_archive' => true,\n    'hierarchical' => false,\n    'exclude_from_search' => false,\n    'show_in_rest' => true,\n    'publicly_queryable' => true,\n    'capability_type' => 'post',\n  );\n  register_post_type( 'blog', $args );\n\n}\nadd_action( 'init', 'create_blog_cpt', 0 );\n\nregister category\nfunction create_blog_taxonomy() {\n    register_taxonomy(\n        'blogs_cats',\n        'blog',\n        array(\n            'label' => __( 'Category' ),\n            'rewrite' => array( 'slug' => 'blog' ),\n            'show_ui'           => true,\n            'hierarchical' => true,\n            'show_in_rest' => true,\n            'show_admin_column' => true,\n\n        )\n    );\n}\nadd_action( 'init', 'create_blog_taxonomy' );\n\nI am using below code\n$args_cats = array('taxonomy' => 'blogs_cats');\n$cat = get_terms($args_cats);\n      foreach ($cat as $catVal) { \necho '<a href=\"'.get_term_link($catVal->term_id,'blogs_cats').'\">Category name</a>';\n}\n\n\nA: Its because you are already registered the cpt as blog and set has_archive to true. That means, the url https://example.co/blog/ will act as the archive page for that CPT and URLs like this (https://example.co/blog/categoryname/) will be treated as a post in that CPT.\nAll you have to do is change the rewrite slug of the custom taxonomy ('rewrite' => array( 'slug' => 'blog' ),) to something else, then flush the rewrite rules (just hitting the save button in permalinks will do it) and it will work.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405321", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to work with multilingual sites using the full site editor and block themes? I'm developing a block theme and I need the user to edit the site content with the full site editor in two different languages.\nIn this situation, what would be the approach to allow the same page to have two versions, each one in a different language?\n\nA: you either duplicate your website,\nor pay multi-money  \u20ac \u00a5 \u20aa \u00a5 $.\nThe old alternative is to implement multiple languages yourself,\ne.g. either a complete duplicate of the website (terrible maintenance)\nor a lot of tweaking and customizations (duplicate pages, post types, custom templates per page, where needed, and so forth).\nWordpress developers made it clear by now (20 years) that they don't care about multiple languages, (and some langauges are not even really supported, which is about 1/5 of the world population writing from right to left).\nyou either pay with money or with (a lot of) time.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405325", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Additional file upload in Gutenberg page options/featured image I would like to add an additional image upload in the featured image part of the Gutenberg page options editor. e.g. as in the image below, but with an additional file upload area.\n\nIn my PHP file I currently have these lines to import a javascript function to add an additional dropdown, that looks like the below. (Code based off this post)\n\nI have tried to add a file form upload component, but this a) isn't displayed, and b) I'm not sure how to then use the resulting upload (i.e. implement a similar withSelect function?)\nDoes anyone have any suggestions. Apologies if i'm missing the obvious as I'm very new to wordpress.\nPHP file:\nfunction myguten_register_meta()\n{\n    wp_enqueue_script( 'guten', get_template_directory_uri() . '/theme/js/guten-hero.js', [ 'wp-element', 'wp-hooks' , 'wp-compose', 'wp-data'] );\n    register_meta('post', 'align_featured_image', array(\n        'show_in_rest' => true,\n        'single' => true,\n        'type' => 'string',\n    ));\n}\n\nadd_action('init', 'myguten_register_meta');\n\nJS file:\n\"use strict\"\n\nconst el = wp.element.createElement;\nconst withSelect = wp.data.withSelect;\nconst withDispatch = wp.data.withDispatch;\n\n\nwp.hooks.addFilter(\n    'editor.PostFeaturedImage',\n    'enchance-featured-image/align-featured-image-control',\n    wrapPostFeaturedImage\n);\n\nfunction wrapPostFeaturedImage( OriginalComponent ) {\n    return function (props) {\n        return (\n            el(\n                wp.element.Fragment,\n                {},\n                el(\n                    OriginalComponent,\n                    props\n                ),\n                el(\n                    composedSelectControl\n                ),\n                el(\n                    fileUpload\n                )\n            )\n        );\n    }\n}\n\nclass SelectControlCustom extends React.Component {\n    render() {\n        const {\n            meta,\n            updateFeaturedImage,\n        } = this.props;\n\n        return (\n            el(\n                wp.components.SelectControl,\n                {\n                    heading: \"Manage Featured Image\",\n                    label: \"Set Position\",\n                    help: \"Set vertical alignment for featured image\",\n                    // value: this.state.value,\n                    options: [\n                            { value: 'flex-start', label: 'Select an alignment', disabled: true },\n                            { value: 'flex-start', label: 'Top' },\n                            { value: 'center', label: 'Center' },\n                            { value: 'flex-end', label: 'Bottom' },\n                            ],\n                    onChange:\n                        ( value ) => {\n                            this.setState( { alignment: value } );\n                            updateFeaturedImage( value, meta );\n                        }\n                }\n            )\n        )\n    }\n}\n\n\nclass FormFileUploadCustom extends React.Component {\n    render() {\n        const {\n            meta,\n            updateFeaturedImage,\n        } = this.props;\n\n        return (\n            el(\n                wp.components.FormFileUpload,\n                {\n                    heading: \"Manage Featured Image\",\n                    label: \"Set Position\",\n                    help: \"Set vertical alignment for featured image\",\n                    // value: this.state.value,\n                    accept: \"image/*\",\n                    onChange:\n                        ( value ) => {\n                            this.setState( { image: value } );\n                            // updateFeaturedImage( value, meta );\n                        }\n                }\n            )\n        )\n    }\n}\n\nconst composedSelectControl = wp.compose.compose( [\n    withSelect( ( select ) => {\n        const currentMeta = select( 'core/editor' ).getCurrentPostAttribute( 'meta' );\n        const editedMeta = select( 'core/editor' ).getEditedPostAttribute( 'meta' );\n        return {\n            meta: { ...currentMeta, ...editedMeta },\n        };\n    } ),\n    withDispatch( ( dispatch ) => ( {\n        updateFeaturedImage( value, meta ) {\n            meta = {\n                ...meta,\n                align_featured_image: value,\n            };\n            dispatch( 'core/editor' ).editPost( { meta } );\n        },\n    } ) ),\n] )( SelectControlCustom );\n\n\nconst fileUpload = wp.compose.compose( [\n//\n] )( FormFileUploadCustom );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405327", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I replace a render_callback function for a block? I like to basically use a modified version of the below function.\nThere is pre_render_block and other filters. I have not found out how to get attributes and context the exact way that function does.\nhttps://github.com/WordPress/wordpress-develop/blob/5.9/src/wp-includes/blocks.php\nI see how I can filter the context there how the file adds the global $post->ID to the block context, but I do not get what filter I am supposed to use to get whatever is in context. The GB functions needs $block->context['queryId']\nAm I supposed to unregister the entire block and register it again with my own callback?\n/**\n * Renders the `core/query-pagination-numbers` block on the server.\n *\n * @param array    $attributes Block attributes.\n * @param string   $content    Block default content.\n * @param WP_Block $block      Block instance.\n *\n * @return string Returns the pagination numbers for the Query.\n */\nfunction gutenberg_render_block_core_query_pagination_numbers( $attributes, $content, $block ) {\n    $page_key = isset( $block->context['queryId'] ) ? 'query-' . $block->context['queryId'] . '-page' : 'query-page';\n    $page     = empty( $_GET[ $page_key ] ) ? 1 : (int) $_GET[ $page_key ];\n    $max_page = isset( $block->context['query']['pages'] ) ? (int) $block->context['query']['pages'] : 0;\n\n    // stuff\n}\n\n/**\n * Registers the `core/query-pagination-numbers` block on the server.\n */\nfunction gutenberg_register_block_core_query_pagination_numbers() {\n    register_block_type_from_metadata(\n        __DIR__ . '/query-pagination-numbers',\n        array(\n            'render_callback' => 'gutenberg_render_block_core_query_pagination_numbers',\n        )\n    );\n}\nadd_action( 'init', 'gutenberg_register_block_core_query_pagination_numbers', 20 );\n\nMy test:\nadd_filter( 'pre_render_block', __NAMESPACE__ . '\\replace_pagination', 10, 3 );\n\nfunction replace_pagination( $pre_render, $parsed_block, $parent_block  ) {\n\n    if ( 'core/query-pagination-numbers' !== $parsed_block['blockName'] ) {\n        return $pre_render;\n    }\n\n    dd($parsed_block);\n\n    return $pre_render;\n}\n\ndd = Kint  debugger output :\n\nNo context\n// OK, I got it, I can get the context from the $parent_block. Probably specific to this Block as it needs the pagination block as a parent. Still like to know how to just replace the callback.\n\nA: Try This one on your functions.php or main Plugin file\nadd_filter('register_block_type_args', function ($settings, $name) {\n    if ($name == 'demo/content-with-sidebar') {\n        $settings['render_callback'] = 'demo_blocks_content_with_sidebar';\n    }\n    return $settings;\n}, null, 2);\n\nreplace your block name with demo/content-with-sidebar here demo is the block name space.\n\nA: Just for completeness, based on @Ronak's answer, actual working code with WP coding standards and types.:\n<?php\nnamespace Nextgenthemes\\Stackshitflow;\n\nadd_filter(\n    'register_block_type_args',\n    __NAMESPACE__ . '\\change_render_callback_for_query_pagination_numbers',\n    10,\n    2\n);\n\nfunction change_render_callback_for_query_pagination_numbers( array $settings, string $name ): array {\n    if ( 'core/query-pagination-numbers' === $name ) {\n        $settings['render_callback'] = __NAMESPACE__ . '\\render_query_pagination_numbers';\n    }\n    return $settings;\n}\n\nfunction render_query_pagination_numbers( array $attributes, string $content, \\WP_Block $block ): string {\n\n    $content = '<h1>HELLO WORLD</h1>';\n\n    return $content;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405330", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Hide Heading if ACF Field is empty I am trying to add a \"Local FAQ\" section to all the individual location pages on a site with literally thousands of individual location pages. I am doing this by using ACF field in the custom post type. I've implemented this in a staging site. To give the local FAQ section a heading as opposed to there just being a list of questions & answers, I added a h3 as seen below\n    <h3 class=\"local_faq\" style=\"text-align: center; font-size: 50px;\"><?php the_title(); ?> Dumpster Rental FAQs</h3>\n\nHowever, since there are literally thousands of these pages, I want to implement this over time so I can still publish other changes I've made to the production site and therefore I don't want this h3 to be visible on pages that I haven't added any FAQs for yet.\nHere's the full code for the local FAQ section:\n<h3 class=\"local_faq\" style=\"text-align: center; font-size: 50px;\"><?php the_title(); ?> Dumpster Rental FAQs</h3>\n<div class=\"local_faq\">\n    <?php if (get_field('local_faq')) : ?>\n        <?php while (the_repeater_field('local_faq')) : ?>\n            <div class=\"local_faq\" style=\"margin-left: 100px; margin-right: 100px;\">\n                <h4>\n                    <?php the_sub_field('question'); ?>\n                </h4>\n                <p>\n                    <?php the_sub_field('answer'); ?>\n                </p> \n            </div>\n        <?php endwhile; ?>\n    <?php endif; ?>\n</div>\n\nSo, how do I hide the h3 if there aren't any FAQs entered yet?\n\nA: Move the outer(of the two) div.local_faq inside the if statement which checks if the faq field is set, because that\u2019s the outer parent container. Also it would make sense to change the outer container div to have a plural div.local_faqsclass instead of the same class as the nested div.local_faq\nThen just add the h3 part inside the outer div.local_faqs and the faqs and header will only show if the field is set:\n<?php if (get_field('local_faq')) : ?>\n    <div class=\u201clocal_faqs\u201d>\n        <h3 class=\"local_faq\" style=\"text-align: center; font-size: 50px;\"><?php the_title(); ?> Dumpster Rental FAQs</h3>\n        <?php while (the_repeater_field('local_faq')) : ?>\n            <div class=\"local_faq\" style=\"margin-left: 100px; margin-right: 100px;\">\n                <h4><?php the_sub_field('question'); ?></h4>\n                <p><?php the_sub_field('answer'); ?></p> \n            </div>\n        <?php endwhile; ?>\n    </div>\n<?php endif; ?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405333", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Best method of implementing compartmentalized custom post types on a multi-site network I'm aware that there are many different ways to implement custom post types on a multi-site network, however, I'm unsure as to the best method to do so for my application. I have a website with multiple subdomains that are only accessible by users with specific user roles. Each subdomain will have a set of custom post types that the users can create and edit from a front end dashboard, but I need many of them to be accessible on the main website without adding the subdomain to the URL. I can either use a broadcast plugin to accomplish this or I can use the save_post hook to duplicate the information on the main website. The issue still remains on the method of registering the custom post types.\nSince the users would not have access to the admin dashboard, would it be better to write a network plugin that creates all the custom post types at once, but only does so on the sites where the ID matches a hard coded parameter for each custom post type, or should I write multiple plugins that handle the custom post types for each blog, install them on the network, and only activate them for the relevant subdomains? Or is there a better method that I'm unaware of?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405337", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom Header added within Dashboard pages, is this possible with custom template files? I created a custom template and called it Header Home\"header-home.php\"\n<?php\n/**\n* Template Name: Header Home\n*/\n?>\n<?php\n  if( have_post() ) {\n    while( have_post() ){\n      the_post();\n    }\n  }\n?>\n\nThen on my front page i call it with\n<?php get_header( 'home' ); ?>\n\nNow, when i create a page, and use template \"Header Home\" and add my html content inside, it's not showing on the front page at all. Shouldn't the loop grab those html and add it on the header-home.php then be shown when get_header( 'home' ) is called?\nWhen i add the html code directly in the header-home.php, it is working, but is there a way to add it within the dashboard page so it's easily \"codeable\"\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405339", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woo commerce product quantity wise SKU In woocommerce i have multiple readymade garment VARIABLE product all have multiple variations with size and colour, I want now variations stock wise SKU field\nSuppose I have variations of t-shirt yellow XL size 5 quantity I want 5 SKU fields.\nSo in short i want product quantity wise SKU in VARIABLE & simple product both.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405342", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to remove the two duplicate values How to remove the two duplicate values\nExample I have the variable 1 $help_brother:\n$help_brother = '30,45,12,13,14,15';\n\nAnd the variable 2 Force World:\n$force_world = '45,12,15';\n\nThe result must be:\nResult: '30,13,14';\nAny help is welcome. Thanks in advance.\n\nA: Here is the result\n$help_brother = '30,45,12,13,14,15';\n$force_world = '45,12,15';\n\n$help_brother_array = explode(',', $help_brother);\n$force_world_array = explode(',', $force_world);\n\n\n$Result = array_diff($help_brother_array, $force_world_array);\necho implode(\",\",$Result);\n\nYou can get the following result.\nIf it helps then upvode the answer.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405343", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ACF: If field contain a specific value, update value in another field programatically how can I change the value of a field based on the value of another field programatically?\nThis other field has already a value but I need to replace / update it.\nTo be more precise:\nIf the Text Field named type has value Houses AND another Text Field named service has value 2, this should be updated in NOT AVAILABLE.\nOr ...\nIf the Text Field named type has value Parks AND another Text Field named service has value 2, this should be updated in AVAILABLE.\nOr ...\nIf the Text Field named type has value Store AND another Text Field named service has value 2, this should be updated in COMING SOON.\nI read the update_field doc but I could not solve this.\n\nA: Did you trying something like this in a JS script?\nAssuming you wants to edit the service text field.\njQuery(document).ready(() => {\n  const textfield_type = document.querySelector('input[name=\"type\"]');\n  const textfield_service = document.querySelector('input[name=\"service\"]');\n\n  const updateField = () => {\n    if (textfield_type.getAttribute('value') === 'Houses' && textfield_service.getAttribute('value') === '2') {\n      textfield_service.setAttribute('value', 'NOT AVAILABLE');\n    }\n\n    // ... other rules\n  }\n\n  // Launch the event only if the two fields exists\n  if (textfield_type !== null && textfield_service !== null) {\n    textfield_service.addEventListener('focusout', () => updateField());\n  }\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405348", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to get serialized post meta I have posts that have video content and these videos stored in database like this (serialized)  a:1:{s:9:\"video_url\";s:0:\"\";} \nThis serialized data have post video urls but can not get this data. I used <?php echo get_post_meta(get_the_ID(), '_custom_field', TRUE); ?>\nBut this get_post_meta display output \"array\" instead of video urls\n\nA: get_post_meta() with the 3rd parameter set to true will return a single item with the key specified in the 2nd parameter (_custom_field in your code). If this item is an array, it'll return as the array. In your case, it appears that the data is:\narray(\n    'video_url' => '',\n)\n\n...which is why, when you try to echo it, it's printing Array to the screen.\nI'd suggest something more like this:\n<?php\n$meta = get_post_meta(get_the_ID(), '_custom_field', TRUE);\necho $meta['video_url'];\n?>\n\n...or, if you're expecting multiple video_urls, you could do this:\n<?php\n$meta = get_post_meta(get_the_ID(), '_custom_field');\nforeach ( $meta as $item ) {\n    echo $item['video_url'];\n}\n?>\n\n(Note that it also appears that, in the metadata you've posted, there's an empty value for the actual video_url, but I can't say what might have caused that.)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405349", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenberg Editor: dynamically edit slug field based on ACF field I'm trying to edit the slug field on the right panel of Gutenberg editor and edit its content based on a custom field.\nI noticed that I can access the field by using this JavaScript to interact with the React Component:\nwp.data.select('core/editor').getEditedPostSlug();\nMy question is: How can I edit this field in JavaScript?\nThere's no .setEditedPostSlug() method for this and select the field in normal JS script is impossible because the field's ID is generated each time the panel is opened and if we close the panel, the field disappear from the DOM.\n\nA: I've found the way to edit the slug's field. Just simply use:\nwp.data.dispatch('core/editor').editPost({slug: 'my-slug-value-here'});\n\nWith an event listener like this, I can dynamically change the slug field based on a custom field:\njQuery(document).ready(() => {\n\n    const acfField = 'field_61f8bacf53dc5';\n    const inputShortTitle = document.getElementById('acf-' + acfField);\n\n    const slugify = (str) => {\n        return str.toLowerCase().replace(/ /g, '-')\n            .replace(/-+/g, '-').replace(/[^\\w-]+/g, '');\n    }\n\n    const updateSlug = () => {\n        wp.data.dispatch('core/editor').editPost({slug: slugify(inputShortTitle.value)});\n    }\n\n    if (inputShortTitle !== null) {\n        inputShortTitle.addEventListener('input', () => updateSlug());\n    }\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405353", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How can i show ACF in post excerpts I am using a custom post type and would like to show Advanced Custom Fields in my blog module (Divi). I think i should go and load that values from ACF in the post excerpts. How should i do this?\n\nI would like to show the ACF Values in the red marker area.\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405354", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: add 360 (non-Wordpress) tours in a subfolder with the same name as the main (Wordpress)page of the 360 tours I'm looking for a solution to put my 360 tours (all in their own subfolder) in the subfolder of the Wordpress page about the tours.\nFor instance:\nWordpress page: domain/vr/\nTours:\ndomain/vr/tour1/index.html\ndomain/vr/tour2/index.html\nThe tours are not made in Wordpress and have been uploaded via ftp.\nCan anyone help me? :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405356", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: is_main_query() always returning false I've built a Wordpress site using Oxygen builder.\nI'm using the 'Post Types Order' plugin to control the post order.\nI have an Archive Page for a custom Post Type.\nFor the Loop/Oxygen Repeater I'm using the Default WP Query.\nMy Archive page correctly shows the list of posts according to taxonomy.\nFor this custom post type I want to order it Alphabetically.\nI added the following snippet :\nadd_action( 'pre_get_posts', 'lit_category_filter' );\n\nfunction lit_category_filter($query) {\n    if ( ! is_admin() && $query->is_main_query() ) {\n         if( $query->is_category('product')) {\n             $query->set( 'order', 'Desc' );\n         }\n    }\n}\n\nadd_action( 'pre_get_posts', 'lit_category_filter' );\n\nUnfortunately this doesn't do anything.\nI did a test with this hacky script :\nfunction custom_query( $query ) {\n     if( $query->is_main_query()  ) {\n      echo(\"<script>console.log('********************* is_main_query')</script>\");    \n     }else{\n      echo(\"<script>console.log('is not  main query')</script>\");\n     }\n}\n add_action( 'pre_get_posts', 'custom_query' );\n\nAnd on every page  $query->is_main_query() returns false.\nSo it looks my original script isn't working because it never identifies queries as being the main_query.\nAs I mentioned, all the pages are working correctly and displaying the correct contents, I'm just unable to add filters to the Default WP Query.\nAny idea what I might be doing wrong here?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405357", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to enqueue a script which is type module without using script_loader_tag filter? I'm creating a theme and i want to upload it to envato. I have a javascript file that is type module and i can enqueue it and then use script_loader_tag filter to add type module to it by these lines.\nwp_enqueue_script( 'slider-js', get_stylesheet_directory_uri() . '/src/js/slider.js', array(), time(), true );\n\nadd_filter( 'script_loader_tag', 'add_type_attribute', 10, 3 );\nfunction add_type_attribute( $tag, $handle, $src ) {\n\n    if ( 'slider-js' !== $handle ) {\n        return $tag;\n    }\n    $tag = '<script type=\"module\" src=\"' . esc_url( $src ) . '\"></script>';\n    return $tag;\n}\n\nbut the problem is when i run envato theme check and it gives this error:\nREQUIRED: Found script_loader_tag in the file functions.php. Do not remove core functionality.\nLine 137: add_filter( 'script_loader_tag', 'add_type_attribute', 10, 3 );\nIs there any other way to add type module ?\n\nA: Lets try this:\n  function slider_script () {\n    wp_enqueue_script( 'slider-js', get_stylesheet_directory_uri() . '/src/js/slider.js', array(), time(), true );\n  }\n  function add_type_attribute( $tag, $handle, $src ) {\n  \n      if ( 'slider-js' !== $handle ) {\n          return $tag;\n      }\n      $tag = preg_replace(\"/(.*)(><\\/script>)/\", '$1 type=\"module\"$2', $tag);\n      return $tag;\n  }\n  add_action('wp_enqueue_scripts', 'slider_script');\n  add_filter( 'script_loader_tag', 'add_type_attribute', 10, 3 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405362", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom Icon for Plugin is there a hook to add a icon to a plugin? I just found the information about how to add it, when you want to publish a icon. https://developer.wordpress.org/plugins/wordpress-org/plugin-assets/\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405367", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Import JSON feed into Wordpress Post (wp_insert_post) every 24 hours I am importing a JSON feed using a php file I am then looping through the JSON data and creating/updating a post using the wp_insert_post function. I want to query the JSON feed every 24 hours to sync any new information to Wordpress. I thought having something like zapier hit the page every 24 hours to run the php could work but it seemed there must be a better way to do that in wordpress/php?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405370", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to loop specific Category menu from archive page? I'm trying to loop a specific product category menu from the archive.php page\nand the category has 4 columns or as a 4th Tree\nHow I can Loop it here in ul ?\n   <ul><!-- 1-->\n      <li><a> First tree</a>\n         <ul><!-- 2-->\n            <li><a>Second Tree</a>\n               <ul><!-- 3-->\n                  <li><a>Third Tree</a>\n                     <ul><!-- 4-->\n                        <li><a>Fourth Tree</a></li>\n                     </ul>\n                  </li>\n               </ul>\n            </li>\n         </ul>\n      </li>\n   </ul>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405371", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to implement very unusual wordpress routing structure? Been trying the last two weeks to setup an unusual routing structure for a WordPress website but cannot manage to make it work.\nBasically there is a custom post type that will get the post url based on the post category(multiple categories) eg: site.com/movie-category/list/movie/\nIn this there are also news located at: Site.com/movie-category/news/ and for single news it will be site.com/moviecategory/thenews.\nThen another one called e.g. articles which are located at: Site.com/moviecategory/list/articles Site.com/moviecategory/list/articles/articlename\nA bunch of others too like /blog/post etc\nI cannot think of a solid way to handle this without getting messy and hacky, the only way to deal with this is using a permalink redirect plugin.\nI've tried a lot, I mean a lot of setups. Timber routing, WordPress rewrites, themosis, headless(this will do but we also get an api call into the single-movie.php (don't ask hehe)) etc etc.\nI would happily accept any advice as i feel lost in this\nThank you\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405372", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to remove Stats by jetpack dashboard widget? How can I remove the Stats by Jetpack widget from dashboard, especially for non-admin users? This is the widget that shows how much spam has been blocked and I want to keep it active (blocking spam) but just remove the widget.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405373", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add author role as a custom field to custom post type in wordpress? I want to add a custom field in the wordpress custom post type, such that this field dynamically fetches the value of the author role.\nPurpose -\nI want to add this custom field so that I can filter custom post types based on the user role of the author of the posts, that is editor, subscriber, etc.\nWhat have I tried?\nWell, I looked up the solution on Internet but couldn't find one and I am not that great in PHP so couldn't give it a shot myself.\nKindly suggest a solution.\nThanks a lot, in advance.\n\nA: You can hook into save_post_{$post->post_type} which fires after the post has been saved in database.\nfunction wpse405375_save_author_role_as_meta( $post_ID, $post, $update ) {\n    \n    //Get the User object from author id.\n    $author = get_user_by( 'ID', $post->post_author );\n    \n    //Get author roles\n    $roles = $author->roles;\n    \n    //Store the role/roles in post meta\n    \n    /* This one will store all the roles as serialized array. */\n    update_post_meta( $post_ID, '_author_roles', $roles );\n    \n    /* If you want just the first role as string (in case the user is associated with multiple roles)\n     * Or, in your case, use it for a simple meta_query\n    */\n    update_post_meta( $post_ID, '_author_role', $roles[0] );\n    \n}\nadd_action( 'save_post_MYCPT', 'wpse405375_save_author_role_as_meta', 10, 3 );\n\nReplace MYCPT with your CPT.\nEDIT : 07-05-2022\nfunction wpse405375_change_user_posts_meta(  $user_id, $role, $old_roles ) {\n    \n    //Get User's posts first\n    $posts = get_posts(array(\n        'post_type' => 'MYCPT', //Change it to your CPT\n        'posts_per_page' => -1,\n        'author' => $user_id,\n    ));\n    \n    //Loop through the posts and update meta\n    if ( $posts && !empty($posts) ) {\n        foreach( $posts as $post ) {\n            update_post_meta( $post->ID, '_author_role', $role );\n        }\n    }\n}\nadd_action( 'set_user_role', 'wpse405375_change_user_posts_meta', 10, 3);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405375", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Admin slow on Postlist (over 30k Posts in Database) we have a Site with around 20k Posts in the normal postlist and another 10k in other CPT.\nThe custom post types work really fast, but the normal Post List doesn't.\nI assume that might be because the server aggregates how many posts are published, how many are mine and how many are deleted, but I'm not really sure about that.\nAny idea how to limit what is being queried - I looked in google how to remove sections from the query but all I find is css \"hacks\" to not display the filters, not how to remove them from the query.\nif you have any other ideas, please let me know.\n\nA: Perhaps this filter can help you to modify the query for the specific post type and inside wp-admin\nas per the documentation, this filter is called before the query is executed so you can modify/optimize the query with the help of this filter.\ndo_action_ref_array( 'pre_get_posts', WP_Query $query )\n\nfurther reference: https://developer.wordpress.org/reference/hooks/pre_get_posts/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405377", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to change text color depending on the number value (Using javascript) I'm trying to change text on the table depending on the meta value I give (number).\n\n*\n\n*if meta value >= 7, number text on table changes to green.\n\n*else if meta value >= 4, number text on table changes to yellow.\n\n*else, number text on table changes to red.\n\nHowever, this code doesn't work.\n<script type=\"text/javascript\">\n    function change_color_text (num1) {\n        var rate_num = num1;\n        if(rate_num >= 7) {\n            rate_num.style.color = \"green\"; // green\n        } else if (rate_num >= 4) {\n            rate_num.style.color = \" yellow\"; // yellow\n        } else {\n            rate_num.style.color = \"red\"; // red\n        }\n    return rate_num;\n    }\n</script>\n\n<?php $ccf_CAR = get_post_meta( get_the_ID(), 'ccf_CAR', true ); ?> // meta data is number value like 7,2,5 etc. (This code is working)\n<?php $ccf_PSC = get_post_meta( get_the_ID(), 'ccf_PSC', true ); ?> // meta data is number value like 7,2,5 etc. (This code is working)\n\n<figure class=\"wp-block-table\">\n    <table>\n        <thead>\n            <tr>\n                <th>Rate Subject</th>\n                <th class=\"has-text-align-center\" data-align=\"center\">Status</th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr>\n                <td>Safe Score</td>\n                <td class=\"has-text-align-center\" data-align=\"center\"><p id=\"safe_score\"><?php echo \"<script> change_color_text($ccf_CAR); </script>\"; ?></p></td>\n            </tr>\n            <tr>\n                <td>Price Score</td>\n                <td class=\"has-text-align-center\" data-align=\"center\"><p id=\"price_score\"><?php echo \"<script> change_color_text($ccf_PSC); </script>\"?></div></td>\n            </tr>\n            ....same code above for the table\n        </tbody>\n    </table>\n</figure>\n\nI think there's an error in javascript function or maybe I didn't write properly with this code.\n<?php echo \"<script> change_color_text($ccf_CAR); </script>\"; ?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405381", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Restrict users of site 1 to login in site 2 in wordpress multisite I'd setup Wordpress Multisite.\nsite-1: www.abc.com (is main site).\nsite-2: www.abc.com/site2 (is a subsite).\nI'd setup other site in sub directory not on as a subdomain.\nRight now if a user register and login to site-2 it is registering on www.abc.com and can access both sites.\nI want to restrict the users on site-2 so if they visit site-1 they will not be logged in for that site.\nAlso on site-1 there are some user roles. Administrator, Business Owner, Installer Employees, etc. The Business Owner should have permission to login to the site-2 and only he can permit his team (Installer Employees) to login to the site-2.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405382", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Rest API - Get all posts based on post_meta on custom endpoint So I can't seem to figure out how to get ALL posts based on a specific post meta, so I wanted to reach out and see if someone might be able to assist.\nWhat I am trying to achieve:\n\n*\n\n*I have website A, which has posts that I can access using /wp-json/wp/v2/posts which outputs ALL posts on the website.\n\n*Then I have website B which I want to access website A posts, but I want to pull in only specific posts based on post_meta over the Rest API.\n\nWhat I have added on website A:\nif (!function_exists('post_meta_request_params')) {\n    function post_meta_request_params($args, $request): array\n    {\n        $args += [\n            'meta_key'   => $request['meta_key'],\n            'meta_value' => $request['meta_value'],\n            'meta_query' => $request['meta_query'],\n        ];\n\n        return $args;\n    }\n    add_filter('rest_post_query', 'post_meta_request_params', 99, 2);\n}\n\nWhere I can access the Rest API using /wp-json/wp/v2/posts?meta_key=author_id&meta_value=104, which works on website A, but the problem is, when I attempt to use it on website B, it doesn't work using wp_remote_request:\n    $response = wp_remote_request(add_query_arg( [\n        'page' => 1,\n        'per_page' => 3,\n        'post_status' => 'publish',\n    ], 'https://www.websiteA.com/wp-json/wp/v2/posts?meta_key=author_id&meta_value=104'));\n\n\nCould I create a custom endpoint with just posts with post_meta author_id and meta_value of 104, so that I can access that endpoint on website B?\nIf so, does anyone have an example of a register_rest_route with feeding posts with specific meta, so that I can access for example /wp-json/wp/v2/custom_posts on website B?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405385", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress blocking polling request when signed into Admin I've setup a polling script in js that sends an XMLHttpRequest to the server to wp-admin/admin-ajax.php (yes, legacy, I know) at a fixed interval of x seconds. The response returned by that request from the server corresponds to a simple and minimal JSON.\nIt was all working good, until I've noticed the following:\n\n*\n\n*When I login to my platform (on the frontend) and access the profile page, the polling starts.\n\n\n*It all works perfectly, BUT, as soon as I login to the wp-admin in another tab within the same browser, the next polling request fails, with a 403 client error, and -1 response from the server. From my experience, wp-ajax answers with -1 when it cannot authenticate the client, for example when the nonce is wrong (which obviously is also indicated by 403). But why is this happening? Does the login to the wp-admin section somehow invalidate a certain cookie that is also used on the frontend tab for authentication? That's the only thing I could imagine, as the ajax request which can only be triggered by the frontend must be hooked to both:\n\n\n*the wp_ajax_{action} hook\n\n\n*the wp_ajax_nopriv_{action} hook\nIMPORTANT NOTE\nJUST TO BE CLEAR ONCE AGAIN: MY AJAX CALLBACK IS CURRENTLY HOOKED TO BOTH HOOKS, AND THE ABOVE-MENTIONED HAPPENS!!!!!!!\nSo actually my wp_ajax_{action} is tied to the change if a client is logged in to the admin area, so I'm wondering if that's causing the issue.\nI'm actually wondering if it is even necessary to register exclusive frontend calls (so for clients who have totally nothing to do with wp admin) to both the wp_ajax_ AND the wp_ajax_nopriv hooks? Why is it not enough to simply hook to the wp_ajax_nopriv_{action} hook for exclusive frontend requests? That's at least what it says here, but so many articles out there always state that you should hook your ajax requests to both hooks. Why??\nAs I understand it, the is_user_logged_in() function, called via the wp_ajax_{$action} hook, triggers if the client making the request is logged in to the wp admin dashboard.\nHence, ajax calls that must be triggered from within the wp admin panel should be registered via the wp_ajax_{$action} hook, and ajax calls that are triggered from the frontend and have totally nothing to do with wp-admin, but are like simple REST interactions of your platform users with your platform server, should be registered via the wp_ajax_nopriv_{action} hook, no?\nBut that as a side-note, anyone has an idea why my issue is happening?\n\nA: \nHence, ajax calls that must be triggered from within the wp admin\npanel should be registered via the wp_ajax_{$action} hook, and ajax\ncalls that are triggered from the frontend and have totally nothing to\ndo with wp-admin, but are like simple REST interactions of your\nplatform users with your platform server, should be registered via the\nwp_ajax_nopriv_{action} hook, no?\n\nNo.\nwp_ajax_ is used for logged in users. wp_ajax_nopriv_ is used for logged out users. It has nothing to do with whether you're in the admin panel or not. It's only whether the user is logged in or not.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405387", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: How to pass username in affiliate link in wordpress website I need to pass current logged in user in wordpress website as SUBID in the affiliate link as follows.\nAffiliate link format is like below.\nhttps://affiliatenetwork.com/track?id=myuserid&url=https://nike.com&subid={subid}\n\nI want to pass current logged in user as a subid in above link. I have written below code in functions.php.\nif ( is_user_logged_in() )\n{\n    $userName = get_current_user_id();\n}\n<----Need code here to pass $userName as subid ( mentioned in above link).------>\n\nPlease help.\n\nA: This code adds the subid parameter if does not exist to the current URL.\nUse this plugin to insert the php code:\nhttps://wordpress.org/plugins/my-custom-functions/\nBut you need to use add_action() to call this function somewhere.\nfunction my_change_url() {\n    global $wp;\n    $current_url = home_url(add_query_arg(array($_GET), $wp->request));\n    if ( empty($_GET['subid']) ) {\n        $cuser = wp_get_current_user();\n        $username = $cuser->user_login;\n        $current_url = add_query_arg(array($_GET), $wp->request);\n        $current_url = add_query_arg('subid', $username);\n        $current_url = home_url($current_url);\n    }\n    return($current_url);\n}\n\nOR\nYou may use a shortcode:\nadd_shortcode('affiliate_subid', 'my_change_url');\n\nPut the short code anywhere on a page:\n[affiliate_subid]\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405388", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Exclude posts w/ specific post_meta on Rest API endpoint So WordPress offers the default Rest API endpoint, which is: https://example.com/wp-json/wp/v2/posts which pulls in all the posts.\nIs there a way to configure and modify the existing /wp/v2/posts endpoint to exclude posts that have a post_meta of global_post?\n\nA: Caveat\nFrom the REST API docs:\n\nChanging or removing data from core REST API endpoint responses can break plugins or WordPress core behavior, and should be avoided wherever possible.\n\nThat said, there's a rest_post_query filter (well, rest_{$this->post_type}_query) that will let you modify the WP_Query that's grabbing your posts, so you should be able to add a meta_query to the query.\neg:\nadd_filter( 'rest_post_query', 'wpse405394_remove_global_posts', 10, 2 );\n/**\n * Removes the \"global_post\" posts from the REST API.\n *\n * @param  array           $args    The WP_Query arguments.\n * @param  WP_REST_Request $request The REST request.\n * @return array                    The filtered $args.\n */\nfunction wpse405394_remove_global_posts( $args, $request ) {\n    if ( empty( $args['meta_query'] ) ) {\n        $args['meta_query'] = array();\n    }\n    $args['meta_query'][] = array(\n        'key'     => 'global_post',\n        'value'   => true,\n        'compare' => '!=', \n    ); \n    return $args;\n}\n\nThis code is not tested, and may break things in your site. A lot of things use the REST API under the hood (eg: the block editor). Test thoroughly.\nReferences\n\n*\n\n*rest_{$this->post_type}_query\n\n*WP_Query class\n\n*WP_Meta_Query class\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405394", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Order WP_Query by meta_key priority when 'OR' relation used for multiple meta values I have a WP_Query that queries posts by an ACF date field AND an ACF true/false field.  I am requesting all posts that have a date field value past the current date OR have the true/false field checked true be returned.  It appears like such:\n$args = array( \n    'post_type' => 'post', \n    'posts_per_page' => 6,\n    'meta_key' => 'event_date',\n    'orderby' => 'meta_value_num',\n    'order' => 'ASC',\n    'cat' => 3,\n    'meta_query' => array(\n        'relation' => 'OR',\n        array(\n            'key'     => 'event_date',\n            'value'   => date('Ymd'),\n            'compare' => '>='\n        ),\n        array(\n            'key'     => 'recurring_event',\n            'value'   => 1,\n            'compare' => '=='\n        )\n    )\n);\n\nThis works great except for the order.  It lists the True/False \"true\" posts first, most likely because the event_date field value is blank.  I would like it to still order the posts by event_date and then place all the posts with the recurring_event value to true afterwards.\nI am getting this as the results:\n\n*\n\n*Post 1 - Recurring Event Selected True\n\n*Post 2 - Recurring Event Selected True\n\n*Post 3 - June 1st, 2022\n\n*Post 4 - July 1st, 2022\n\n*Post 5 - August 1st, 2022\n\nBut I would prefer it like this:\n\n*\n\n*Post 1 - June 1st, 2022\n\n*Post 2 - July 1st, 2022\n\n*Post 3 - August 1st, 2022\n\n*Post 4 - Recurring Event Selected True\n\n*Post 5 - Recurring Event Selected True\n\nDo I need to sort the array independently after queried or is there a way to accomplish this through the orderby field?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405396", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenburg: Remove border of selected block I am writing a plugin that creates a custom block. When the block is selected/focused in the editor, a border is created abound it (blue in the current version of WP).\nI would like to disable the border for the specific block type, either in JavaScript or CSS. The problem is that the block content in the editor is wider than the block border, so it looks awkward.  What would be a good solution?\nEDIT (further explanation):\nThe content of the block is generated by the following command in the edit function passed to the call to  wp.blocks.registerBlockType(...):\nReact.createElement('div',\n        {\n            className: 'IA_Presenter_Container',\n            'data-block-id': props.attributes.block_id,\n            'behaviour': 'adaptive'\n        },\n    );\n\nBasically, an empty <div> element is created. The <div> element is then taken over by a complex JavaScript application which build a full GUI environment in SVG. The environment is used to build and set the preferences for a dynamic gallery which will be displayed in the active page. All this happens without leaving the editor page, and it is important to be so.\nWhen the block is focused, it is expanded by applying the following CSS to the div (the class IA_Designer_Full_Width is added in script):\n.IA_Designer_Full_Width{\n    position: relative;\n    width: 96vw;\n    left: 50%;\n    right: 50%;\n    margin-left: -48vw !important;\n    margin-right: -48vw !important;\n    max-width: 100vw !important;\n}\n\nThe result (in a prototype) can be seen below. You see the blue border overlaying the interface:\n\n\nA: It appears that the border is set by the following style definition on the block container (it is in block-editor/style.css):\n.block-editor-block-list__layout .block-editor-block-list__block:not([contenteditable]):focus::after {\n  position: absolute;\n  z-index: 1;\n  pointer-events: none;\n  content: \"\";\n  top: 1px;\n  bottom: 1px;\n  left: 1px;\n  right: 1px;\n  box-shadow: 0 0 0 var(--wp-admin-border-width-focus) var(--wp-admin-theme-color);\n  border-radius: 1px;\n  outline: 2px solid transparent;\n}\n\nChanging setting box-shadow to \"none\" removes the border.\nThus, adding this css will remove the border:\nsome-selector-to-the-container:focus::after{\n    box-shadow: none !important;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405397", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display parent page URL for child page I have this code that is working but is giving me the wrong link\ngives me this link example.com/index.php/sample-page/\nbut I need this link example.com/sample-page/\n <?php global $post;\n  if ( $post->post_parent ) { ?>\n    <a href=\"<?php echo get_permalink( $post->post_parent ); ?>\" >\n    <?php echo get_the_title( $post->post_parent ); ?>\n    </a> <Br><?php echo get_permalink( $post->post_parent ); ?>\n<?php } ?>\n\n\nA: $post->post_parent returns 0 when there's no parent associated. You need to check if the value is greater than 0.\n<?php global $post;\n  if ( $post->post_parent > 0 ) { ?>\n    <a href=\"<?php echo get_permalink( $post->post_parent ); ?>\" >\n    <?php echo get_the_title( $post->post_parent ); ?>\n    </a> <Br><?php echo get_permalink( $post->post_parent ); ?>\n<?php } ?>\n\nAlso, check your permalink settings URL base.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405401", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add posts to custom table in database instead of wp_posts What the code does:\n\n*\n\n*Imports posts, loops through all the posts and calls wp_insert_post to create a new posts for each import.\n\nObjective:\n\n*\n\n*Import posts and store them in another table, not under the wp_posts table, but retain the associated wp_postmeta tables.\n\nIssues:\n\n*\n\n*For some reason, in it's current state, the new table doesn't get created and the posts don't get inserted - What am I doing wrong? I'd like to import the posts to the new table.\n\n\n*Since I don't have the table created, does $wpdb->insert create the table? If not, do I have to create one beforehand and how so?\nHere is the code:\n$response = wp_remote_get(\n    $this->global_endpoint . '/' . $page\n);\nif (is_wp_error($response)) {\n    error_log(\n        print_r(\n            'Error: module/rest/Endpoint.php, Line 52: ' . $response->get_error_message(),\n            true\n        )\n    );\n    echo 'Error: ' . $response->get_error_message();\n    return;\n}\ntry {\n    $posts = json_decode(\n        wp_remote_retrieve_body($response),\n        false,\n        512,\n        JSON_THROW_ON_ERROR\n    );\n    if (empty($posts)) {\n        return;\n    }\n} catch (Exception) {\n    error_log(\n        print_r('Error: module/rest/Endpoint.php, Line 92: ' . json_last_error(),\n            true\n        )\n    );\n    return;\n}\nglobal $wpdb;\nforeach ($posts as $post) {\n    $my_post = [\n        'post_type'     => 'post',\n        'post_status'   => 'pending',\n        'post_title'    => wp_strip_all_tags($post->title->rendered),\n        'post_content'  => wp_strip_all_tags($post->content->rendered),\n        'post_excerpt'  => wp_strip_all_tags($post->excerpt->rendered),\n        'post_author'   => 0,\n        'post_date'     => $post->date,\n        'post_date_gmt' => $post->date_gmt,\n    ];\n    $create_post = wp_insert_post($my_post);\n    $wpdb->insert('wp_corporate_posts', $my_post);\n    update_post_meta($create_post, 'corporate_id', $post->id);\n    echo \"ID: \" . $post->id . \" - Title: \" . $post->title->rendered . \" has been imported.\\n\";\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405402", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I modify the position of a plugin? I am trying to modify a plugin but I'm a tech newbie. My plugin is for a floating mini cart. it's a great plugin but the position options are limited to \"left-middle\" or right-middle\". I would like it to be shown in the \"left-bottom\" position of my site. I found an area in the plugin editor that mentioned it's current position (left-middle). I was hoping by simply changing the word \"middle\" to \"bottom\" it would work but it did not. What's the easiest way to achieve this? is there a simple css I could add to my theme to just over ride it's current position?\n\nA: It's always bad practise to modify a plugin file. For one thing you will lose your changes when the plugin is updated. Look to see if your plugin has been created with filters (good plugins should be).\nSearch within your plugin for \"apply_filters(\" - With luck you will find this near the positional code. It might look something like this:\nfunction cart_display() {\n  $html .= '<div style=\"float-right\">Cart position</div>';\nreturn apply_filters( 'cart_display_html', $html );\n\nThis code is getting the contents (in the $html variable) ready for display, but also telling it to pass it through a filter called cart_display_html.\nWithin your functions file you can then hook into this filter to alter the display \"on the fly\". Using, for example:\nfunction modify_cart_html( $html ) {\n  return '<div>' . $html . '</div>';\n}\nadd_filter( 'cart_display_html', 'modify_cart_html' );\n\nThere may well be CSS that can be used as well, likely simply overriding the plugins build in css.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405404", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How can I register a new REST context? I'm using the REST API to get datas from Wordpress within my React App.\nI've seen that you can filter the responses Wordpress returns by using the filter rest_prepare_{$this->post_type} documented here.\nI've also seen that you can use a context (view,edit) parameter when making a rest request; which will alter the responses.\nIn the documentation about modifying responses, there is a note that says\n\nAdding fields is not dangerous, so if you need to modify data, it\u2019s\nmuch better to duplicate the field instead with your modified data.\nRemoving fields is never encouraged; if you need to get back a smaller\nsubset of data, use the _fields parameter or work with contexts\ninstead.\n\nI would thus use a custom context for my rest requests\nBut how do you register a new context ?\nIf I just do my requests with a parameter ?context=react set, I get a 400 (Bad Request) error.\nThanks !\n\nA: GraphQL is more flexible in general than the built-in REST API, regarding customizing the response. GraphQL is currently not shipped with the WordPress core, but is available as a plugin.\nLet's look at the existing endpoints for the WP_Post object(s).\nWe note that it is possible to use the _fields query parameter to include specific fields in the general REST response.\nHere are few ways we can define new custom schema contexts, to the existing endpoints, using the schema setup in:\n\n*\n\n*register_rest_field() when adding new rest fields.\n\n*register_post_meta() when adding existing post meta as new rest fields.\n\n*WP_REST_Posts_Controller::get_item_schema() for the existing rest fields and append new contexts to their item schema via the rest_{$this->post_type}_item_schema filter. This filter was added in 47779.\n\nLet's look at two examples:\nExample: New custom context for a new rest field\nHere's an example for adding the new foo rest field with the bar value for the post object type and the custom wpse_react context:\nadd_action( 'rest_api_init', function () {\n    register_rest_field( 'post', 'foo',\n        array(\n            'get_callback' => function ( $object ) {\n                return 'bar'; \n            },\n            'schema'       => array(\n                'type'     => 'string',\n                'context'  => array( 'wpse_react' ),\n                 // ... etc\n            ),\n            // ... etc\n        )\n    );\n} );\n\nThen try e.g. the GET request /wp-json/wp/v2/posts/?context=wpse_react and verify that the new field is displayed under the wpse_react context.\nExample : New custom context for existing rest fields\nWe can filter the existing post type schema with rest_{$this->post_type}_item_schema. So for the post post type we can add the custom wpse_react context to e.g. the existing rest fields date, title.rendered and content.rendered:\nadd_filter( 'rest_post_item_schema', function( $schema ) {\n    // 1st level.\n    foreach ( ['date','title','content'] as $item ) {\n        if ( is_array( $schema['properties'][$item]['context'] ) ) {\n            $schema['properties'][$item]['context'][] = 'wpse_react';\n        }\n    }\n    // 2nd level for the 'rendered' part.\n    foreach ( ['content', 'title'] as $item ) {\n        if ( is_array( $schema['properties'][$item]['properties']['rendered']['context'] ) ) {\n            $schema['properties'][$item]['properties']['rendered']['context'][] = 'wpse_react';\n        }\n    }\n    return $schema;\n} );    \n\nThen try e.g. the GET request /wp-json/wp/v2/posts/?context=wpse_react.\nExtending existing REST controllers\nIf we need to modify existing endpoints into our own custom endpoints, it is informative to look at e.g. how the Blocks controller extends the Posts controller to remove fields and change the contexts:\nclass WP_REST_Blocks_Controller extends WP_REST_Posts_Controller\n\nhttps://github.com/WordPress/wordpress-develop/blob/5.9/src/wp-includes/rest-api/endpoints/class-wp-rest-blocks-controller.php\nwhere it overrides these methods with:\n/**\n * Filters a response based on the context defined in the schema.\n *\n * @since 5.0.0\n *\n * @param array  $data    Response data to fiter.\n * @param string $context Context defined in the schema.\n * @return array Filtered response.\n */\npublic function filter_response_by_context( $data, $context ) {\n    $data = parent::filter_response_by_context( $data, $context );\n\n    /*\n     * Remove `title.rendered` and `content.rendered` from the response. It\n     * doesn't make sense for a reusable block to have rendered content on its\n     * own, since rendering a block requires it to be inside a post or a page.\n     */\n    unset( $data['title']['rendered'] );\n    unset( $data['content']['rendered'] );\n\n    return $data;\n}\n\nand\n/**\n * Retrieves the block's schema, conforming to JSON Schema.\n *\n * @since 5.0.0\n *\n * @return array Item schema data.\n */\npublic function get_item_schema() {\n    // Do not cache this schema because all properties are derived from parent controller.\n    $schema = parent::get_item_schema();\n\n    /*\n     * Allow all contexts to access `title.raw` and `content.raw`. Clients always\n     * need the raw markup of a reusable block to do anything useful, e.g. parse\n     * it or display it in an editor.\n     */\n    $schema['properties']['title']['properties']['raw']['context']   = array( 'view', 'edit' );\n    $schema['properties']['content']['properties']['raw']['context'] = array( 'view', 'edit' );\n\n    /*\n     * Remove `title.rendered` and `content.rendered` from the schema. It doesn\u2019t\n     * make sense for a reusable block to have rendered content on its own, since\n     * rendering a block requires it to be inside a post or a page.\n     */\n    unset( $schema['properties']['title']['properties']['rendered'] );\n    unset( $schema['properties']['content']['properties']['rendered'] );\n\n    return $schema;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405405", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "4"}}
{"text": "Q: Search Character Set Problem I have a local WordPress setup in the Turkish language. I have a post title like ... MAMASI ....\nWhen I search by keyword mamas\u0131 in lower-case it doesn't find post. I try the table Character set utf8mb4_unicode_ci, utf8mb4_general_ci, utf8_unicode_ci, utf8_general_ci, utf8_turkish_ci but it gave me same result.\nHow can I solve I\u0131 sensivite problem?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405407", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenberg InnerBlocks with ACF Blocks - How to enable multiple buttons? I'm trying to use Gutenberg's InnerBlocks with ACF Blocks in my allowedBlocks I have [ 'core/heading', 'core/paragraph', 'core/buttons'] In my 'core/buttons' block I'd like to allow multiple buttons, but it only seems to enable one.\nMy block template is as follows:\n[\n    [\n         'core/heading',\n         [\n             'level'       => 3,\n             'placeholder' => __( \"Add Heading...\", THEMENAME ),\n             'align'       => 'center',\n             'className'   => 'has-text-align-center',\n         ],\n     ],\n    [\n          'core/paragraph',\n          [\n               'placeholder' => __( \"Add paragraph text...\", THEMENAME ),\n               'align'       => 'center',\n          ],\n    ],\n    [\n          'core/buttons',\n          [\n               'align'       => 'center',\n          ],\n    ],\n] \n\nAdditionally the align 'center' doesn't seem to work for this block.\n\nA: if you have a look at this site:\nhttps://developer.wordpress.org/block-editor/reference-guides/core-blocks/#buttons\nYou can see that \"Core/Buttons\" (plural) only supports \"full/wide\" on \"align\". You can however use \"align\" => \"center\" on \"core/button\".\nI don't know how you can add multiple buttons inside \"core/buttons\", but you can however add multiple \"core/button\" inside your template:\n[ 'core/button', [ 'align' => 'center' ] ],\n[ 'core/button', [ 'align' => 'center' ] ],\n\nHope this helps!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405409", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Custom RSS does not work for categories and tags We have a custom RSS in our web.\nIt works normally on Main page and post - https://www.kryptonovinky.cz/feed/spotify\nBut in categories and tags it does not work https://www.kryptonovinky.cz/category/podcasty/feed/spotify\nredirect to https://www.kryptonovinky.cz/category/podcasty/feed\nDo you have any idea how to solve it?\n/* This code initializes the custom RSS Feeds for your website*/\nadd_action('init', 'customRSS');\nfunction customRSS(){\n        add_feed('spotify', 'customRSSFunc');\n}\n \n/* This code seeks the template for your RSS feed */\nfunction customRSSFunc(){\n        get_template_part('rss', 'spotify');\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405416", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Custom Post Types not queried in Custom Taxonomy archives or Native archives I have declared a selection of custom post types as an array, allowing post_tags but not categories:\n// Add Multiple Custom Post Types\n\nadd_action('init', 'all_custom_post_types');\n\nfunction all_custom_post_types() {\n  $types = array(\n    array('the_type' => 'mama',\n      'single' => 'Mama',\n      'plural' => 'Mamas'),\n    array('the_type' => 'webinar',\n      'single' => 'Webinar',\n      'plural' => 'Webinars'),\n    array('the_type' => 'video',\n      'single' => 'Video',\n      'plural' => 'Videos'),\n    array('the_type' => 'discount',\n      'single' => 'Discount',\n      'plural' => 'Discounts'),\n    array('the_type' => 'faq',\n      'single' => 'FAQ',\n      'plural' => 'FAQs'),\n  );\n\nforeach ($types as $type) {\n  $the_type = $type['the_type'];\n    $single = $type['single'];\n    $plural = $type['plural'];\n    $labels = array(\n      'name' => _x($plural, 'post type general name'),\n      'singular_name' => _x($single, 'post type singular name'),\n      'add_new' => _x('Add New', $single),\n      'add_new_item' => __('Add New '. $single),\n      'edit_item' => __('Edit '.$single),\n      'new_item' => __('New '.$single),\n      'view_item' => __('View '.$single),\n      'search_items' => __('Search '.$plural),\n      'not_found' =>  __('No '.$plural.' found'),\n      'not_found_in_trash' => __('No '.$plural.' found in Trash'),\n      'parent_item_colon' => ''\n    );\n    $args = array(\n      'labels' => $labels,\n      'public' => true,\n      'publicly_queryable' => true,\n      'show_ui' => true,\n      'query_var' => true,\n      'rewrite' => true,\n      'capability_type' => 'post',\n      'hierarchical' => false,\n      'has_archive' => true,\n      'menu_position' => 5,\n      'supports' => array('title','editor','thumbnail','author','comments','excerpt'),\n      'show_in_menu' => true,\n      'show_in_nav_menus' => true,\n      'exclude_from_search' => true,\n      'taxonomies' => array( 'post_tag' ),\n    );\n    register_post_type($the_type, $args);\n  }\n}\n\nAs can be seen, the arguments allow for public => true; and has_archive => true;.\nI've also set up a custom taxonomy to work as Categories for CPTs only:\nfunction topics() {\n    $labels = array(\n        'name'              => _x( 'Topics', 'taxonomy general name' ),\n        'singular_name'     => _x( 'Topic', 'taxonomy singular name' ),\n        'search_items'      => __( 'Search Topics' ),\n        'all_items'         => __( 'All Topics' ),\n        'parent_item'       => __( 'Parent Topic' ),\n        'parent_item_colon' => __( 'Parent Topic:' ),\n        'edit_item'         => __( 'Edit Topic' ), \n        'update_item'       => __( 'Update Topic' ),\n        'add_new_item'      => __( 'Add New Topic' ),\n        'new_item_name'     => __( 'New Topic' ),\n        'menu_name'         => __( 'Topics' ),\n    );\n    $args = array(\n        'labels' => $labels,\n        'hierarchical' => true,\n        'has_archive' => true,\n    );\n    register_taxonomy( 'topics', array( 'discount', 'video', 'webinar' ), $args );\n}\nadd_action( 'init', 'topics', 0 );\n\nMy problem is that when calling the archive pages for these The CPTs are simply not being found. Tags shared by CPTs and standard posts return only the latter, and topics archives or tag archives with only CPTs assigned return empty.\nI can see from my markup that the correct templates are being called (tag.php, taxonomy.php) but all are empty.\nWhy would this be happening?\n\nA: \nTags shared by CPTs and standard posts return only the latter, and topics archives or tag archives with only CPTs assigned return empty.\n\nAs for the tag archives, that's a default behavior in WordPress core, i.e. tag (post_tag taxonomy) and category (category taxonomy) archives will only query posts where the type is post.\nHowever, the pre_get_posts hook can be used to include custom post types in the main posts query on tag and category archives, like so for tag archives and your CPTs:\nadd_action( 'pre_get_posts', function ( $query ) {\n    if ( ! is_admin() && $query->is_main_query() && is_tag() ) {\n        $query->set( 'post_type', array( 'post', 'mama', 'webinar', 'video',\n                                         'discount', 'faq' ) );\n    }\n} );\n\nAs for the topics archives, they're empty because you set exclude_from_search to true, which not only excludes the post type from search results, but also taxonomy/term archives.\nExcerpt from the documentation: (formatting by me)\n\nNote: If you want to show the posts\u2019s list that are associated to taxonomy\u2019s terms, you must set exclude_from_search to false (ie : for call site_domain/?taxonomy_slug=term_slug or site_domain/taxonomy_slug/term_slug). If you set to true, on the taxonomy page (ex: taxonomy.php) WordPress will not find your posts and/or pagination will make 404 error\u2026\n\nSo to fix the topics archives, either set the exclude_from_search to false, or you could use the pre_get_posts hook like the example for tag archives:\nadd_action( 'pre_get_posts', function ( $query ) {\n    if ( ! is_admin() && $query->is_main_query() && is_tax( 'topics' ) ) {\n        $query->set( 'post_type', array( 'discount', 'video', 'webinar' ) );\n    }\n} );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405419", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding onload to body for certain pages I am looking for a function to add\n<body onload=\"prepareFrame('https://airtable embed URL here')\">\n\nto certain wordpress pages only.\nI know how to add a custom body class but not an onload statement.\nadd_filter('body_class', 'custom_body_class');\nfunction custom_body_class($classes) {\n    global $post;\n    if ($post->ID == 346) {\n        $classes[] = 'services';\n    }\n    return $classes;\n}\n\n\nA: You could use the body_class filter to add additional attributes. I'm not sure if this is the best option out there. Maybe javascript would be better for this.\nfunction my_add_body_attribute($classes) {\n    echo 'onload=\"doyourthing\" ';\n    return $classes;\n}\nadd_filter('body_class', 'my_add_body_attribute');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405420", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Exclude post_meta from Rest API Endpoint So I know that I can call:\n$response = wp_remote_get(\n    'https://www.example.com/wp-json/wp/v2/posts'\n);\n\nTo get all the posts from a specific website using the Rest API Endpoint.\n\nI also know that we can pass in the parameters to exclude tags and categories, such as:\nhttps://www.example.com/wp-json/native/v1/posts?exclude_categories=42\nBased on this: https://developer.wordpress.org/rest-api/reference/posts/#list-posts\n\nIs there a way that I can exclude specific post_meta posts from showing in the Rest API?\nSo let that I want to do: https://www.example.com/wp-json/native/v1/posts?exclude_postmeta_key=global and grab all posts that don't have the global post_meta attached to the post.\nIs something like this possible?\n\nA: Yes, it's surely possible, but not out-of-the-box.\nI.e. There's no such REST query parameter in the WordPress core, but you can add it to your REST API request, e.g. via the URL query string, and then use the rest_<post type>_query hook which \"Filters WP_Query arguments when querying posts via the REST API\" and \"Enables adding extra arguments or setting defaults for a post collection request\".\nAnd here's an example for the post post type:\nadd_filter( 'rest_post_query', 'my_rest_post_query', 10, 2 );\nfunction my_rest_post_query( array $args, WP_REST_Request $request ) {\n    if ( $meta_key = $request->get_param( 'exclude_postmeta_key' ) ) {\n        $args['meta_key']     = $meta_key;\n        $args['meta_compare'] = 'NOT EXISTS';\n    }\n\n    return $args;\n}\n\nSo with that, example.com/wp-json/wp/v2/posts?exclude_postmeta_key=global would now give you the posts that do not have the meta named global.\nIf you need help with WordPress meta query, see the documentation. ( and/or post another question :) )\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405422", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Updates for a private theme I wrote a own theme and I dont wanna deploy it by myself.\nThe customer should do that himself. I found this solution for plugins. But it doesn't work for themes. Is there an alternative to  add_filter( 'update_plugins_(hostname) for themes?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405423", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Change permalink structure specific category I have a specific category that all posts that are in that category must follow the following structure:\ncategory-name/child-category-name(if any)/post-name\nThe other posts will remain with the current base structure defined which is %postname%\nWhat filter, hook that can change the permalink of these posts? How would it be?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405427", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how remove font to increase site speed load in my site(zamiin.ir) there are some font that slow my site speed .\nfont fa-solid-900.woff2 two time load in my site ,one time in my theme and one time in elementor\ngtmetrix test:\nwhat can i do?\n\nA: You can either make a child theme, or make a plugin. Within that child theme or plugin, you'll dequeue one of the copies. If you don't have any other theme customizations, it probably makes the most sense to create a custom plugin.\nBoth your theme and your plugin are paid, so you'll need to look through their code to find out how they enqueue the font. Specifically, you are looking for a call to wp_enqueue_style that includes the URL, something similar to this:\nwp_enqueue_style( 'load-fa', 'https://use.fontawesome.com/releases/v5.5.0/css/all.css' );\n\nor\nfunction wp_styles() {\n    wp_register_style( 'font-awesome', plugins_url( 'wp-plug-in/css/font-awesome.min.css' ) );\n    wp_enqueue_style( 'font-awesome' );\n}\n\nWhat you're trying to find is the \"handle,\" which in the first example is \"load-fa\" and in the second example is \"font-awesome\". Once you identify the handle, your plugin can be as simple as:\n<?php\n/** Plugin Name: Remove duplicate FA\n*/\n\nadd_action( 'wp_enqueue_scripts', 'dedupe_font_awesome', 100 );\n\nfunction dedupe_font_awesome() {\n     // Change the text within quotes to the handle you found.\n     wp_dequeue_style( 'handle-goes-here' );\n}\n\nYou'll definitely need to change the 'handle-goes-here' part, and it's possible you might have to adjust the number 100. That is a priority, telling WP to execute your code after any code that's registered with a lower number. If no number is present in the enqueue call, it is the default 10, meaning your 100 will fire after it, find Font Awesome, and remove it.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405428", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Set term on an attachment using wp_set_object_terms and want to display the full term text but it's showing a slug instead I have a form that visitors use to upload files and fill out information about them and a function that adds those files to the media library and set various fields (including some custom taxonomies) on the media library items based on fields that the visitor filled out in the form.\nThe problem is, I have an email address field. When a visitor fills out the email address field with \"name@email.com\", what is displayed on the Attachment details screen (as in siteurl.com/wp-admin/upload.php?item=xx ) for that email field is \"nameemail-com\".\n\nI want the Attachment details screen to show the actual entered value (a valid email address) as in \"name@email.com\" instead. How do I achieve this?\nHere's the function (in functions.php) where I add the uploaded files to the media library and set the fields based on form fields.\nfunction form_to_media_library($entry){\n\n\n// Get the path to the upload directory.\n$wp_upload_dir = wp_upload_dir();\n\n// build array of uploads\n$all_files_string = trim ($entry[ '1' ], '[]');\n$all_files = explode(\",\", $all_files_string);\n\n// start loop to process each uploaded file\n\nforeach ($all_files as $this_file) {\n\n    // set filename\n    $upload_path = GFFormsModel::get_upload_path( $entry[ 'form_id' ] );\n  $upload_url = GFFormsModel::get_upload_url( $entry[ 'form_id' ] );\n  $filename_verbose = str_replace( $upload_url, $upload_path, $this_file );\n    $filename_backslashes = trim( $filename_verbose, ' \" ');\n    $filename = stripslashes( $filename_backslashes );\n\n    // check the type of file. We'll use this as the 'post_mime_type'\n    $filetype = wp_check_filetype( basename( $filename ), null );\n\n\n\n    // Prepare an array of post data for the attachment.\n    $attachment = array(\n        'guid'           => $wp_upload_dir['url'] . '/' . basename( $filename ),\n        'post_mime_type' => $filetype['type'],\n        'post_title'     => preg_replace( '/\\.[^.]+$/', '', basename( $filename ) ),\n            //get caption from upload form field\n        'post_excerpt'   => rgar( $entry, '8'),\n        'post_content'   => '',\n        'post_status'    => 'inherit'\n    );\n\n    // create a file in the upload folder\n    $upload = wp_upload_bits( basename ( $filename ), null,  file_get_contents( $filename ));\n\n    // Insert the attachment.\n    $attach_id = wp_insert_attachment( $attachment, $upload['file'] );\n\n    // Make sure that this file is included, as wp_generate_attachment_metadata() depends on it.\n    require_once( ABSPATH . 'wp-admin/includes/image.php' );\n\n    // Generate alternate sizes for the attachment, and update the database record.\n    $attach_data = wp_generate_attachment_metadata( $attach_id, $upload['file'] );\n    wp_update_attachment_metadata( $attach_id, $attach_data );\n\n    // set custom field values\n        wp_set_object_terms( $attach_id, rgar( $entry, '2'), 'submitter_name' );\n        wp_set_object_terms( $attach_id, rgar( $entry, '3'), 'submitter_email' );\n        wp_set_object_terms( $attach_id, rgar( $entry, '4'), 'vhs_year' );\n        wp_set_object_terms( $attach_id, rgar( $entry, '6'), 'ensemble' );\n        wp_set_object_terms( $attach_id, rgar( $entry, '11'), 'creator_name' );\n        wp_set_object_terms( $attach_id, rgar( $entry, '7'), 'copyright' );\n\n// end loop\n}\n\n}\n\n// targets the specific form by form ID of 1\nadd_action( 'gform_after_submission_1', 'form_to_media_library', 10, 2 );\n\nHere's how the taxonomy for the email field on attachments is registered (also in functions.php).\nfunction register_taxonomy_submitter_email(){\n$labels = array(\n        'name'              => _x( 'Submitter Email', 'taxonomy general name' ),\n        'singular_name'     => _x( 'Submitter Email', 'taxonomy singular name' ),\n        'search_items'      => __( 'Search Submitter Emails' ),\n        'all_items'         => __( 'All Submitter Emails' ),\n        'parent_item'       => __( 'Parent Submitter Email' ),\n        'parent_item_colon' => __( 'Parent Submitter Email:' ),\n        'edit_item'         => __( 'Edit Submitter Email' ),\n        'update_item'       => __( 'Update Submitter Email' ),\n        'add_new_item'      => __( 'Add New Submitter Email' ),\n        'new_item_name'     => __( 'New Submitter Email Name' ),\n        'menu_name'         => __( 'Submitter Email' ),\n);\n$args   = array(\n        'hierarchical'      => false, // make it hierarchical (like categories)\n        'labels'            => $labels,\n        'show_ui'           => true,\n        'show_admin_column' => true,\n        'query_var'         => true,\n        'create_posts'      => false,\n        'rewrite'           => [ 'slug' => 'submitter_email' ],\n);\nregister_taxonomy( 'submitter_email', 'attachment', $args );\n}\n\nHere's my entire functions.php file.\nWordPress 5.9.3\nRelevant plugins:\n\n*\n\n*Advanced Custom Fields (some other fields are defined using this plugin, but the email field is not)\n\n*Gravity Forms\n\n*Media Library Assistant\n\n\nA: \nWhen a visitor fills out the email address field with\n\"name@email.com\", what is displayed on the Attachment details screen\n(as in siteurl.com/wp-admin/upload.php?item=xx ) for that email field\nis \"nameemail-com\".\n\nYes, and that is the default behavior, i.e. WordPress displays the term slug instead of name (or the actual email address in your case).\nBut there's a filter hook you can use, namely attachment_fields_to_edit, if you want the term field to display the name instead of slug.\nWorking example:\nadd_filter( 'attachment_fields_to_edit', 'my_attachment_fields_to_edit' );\nfunction my_attachment_fields_to_edit( $form_fields ) {\n    $taxonomy = 'submitter_email';\n\n    // Do nothing if the Submitter Email field is not in the fields list.\n    if ( ! isset( $form_fields[ $taxonomy ] ) ) {\n        return $form_fields;\n    }\n\n    // Get the term by its slug.\n    $field = (array) $form_fields[ $taxonomy ];\n    $term  = empty( $field['taxonomy'] ) ? null :\n        get_term_by( 'slug', $field['value'], $taxonomy );\n\n    // Use the term name.\n    if ( $term instanceof WP_Term ) {\n        $form_fields[ $taxonomy ]['value'] = $term->name;\n    }\n\n    return $form_fields;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405431", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Find variables available at a given hook I'm hoping for a simple way to tell/find/echo what the available arguments are available for use at a given hook.\nFor example \u2014\nfunction example_function($something){\n\n    //do stuff with $something\n    return $something;\n\n}\nadd_action('some_hook','example_function');\n\nIn the above case, is there a quick way to tell what $something is (if there is one at all), or if there are multiple $somethings / arguments I have available to use at that point?\n\nA: In general the best solution would be to refer to the documentation for the hook - or the source for the action call within WordPress core's codebase if the documentation proves insufficient.\nYou can search the documentation for the relevant action or filter here. Many pages actually include the source of the filter/action call which can prove invaluable in determining what variables are passed as arguments.\nWhile some reference pages include elaboration on the mechanism and usage of the hook (such as that of pre_get_posts), many do not. Depending on the hook in question you may be able to find more information and usage examples in the Plugin Developer Handbook or the Theme Developer Handbook, among others.\nWhen that fails, performing a full-text file search of a local WordPress installation or utilizing GitHub's search within the WordPress repository for the respective apply_filters()/apply_filters_ref_array()/do_action()/do_action_ref_array() call to see where it's executed can yield answers.\nExamples: Source & Documentation\nFor example, the apply_filters() call for the map_meta_cap filter's source both has inline documentation describing the possible arguments, and we can scroll further up to read through the function if we need further context:\n    /**\n     * Filters the primitive capabilities required of the given user to satisfy the\n     * capability being checked.\n     *\n     * @since 2.8.0\n     *\n     * @param string[] $caps    Primitive capabilities required of the user.\n     * @param string   $cap     Capability being checked.\n     * @param int      $user_id The user ID.\n     * @param array    $args    Adds context to the capability check, typically\n     *                          starting with an object ID.\n     */\n    return apply_filters( 'map_meta_cap', $caps, $cap, $user_id, $args );\n\nThese inline comments are also parsed directly into the reference documentation.\nPrinting Passed Arguments\nWhen all else fails, you can utilize PHP's func_get_args() function to see exactly which arguments were passed:\nadd_action( 'pre_get_posts', 'wpse40532' );\n\nfunction wpse40532() {\n  $args = func_get_args();\n\n  for( $i = 0; $i < count( $args ); $i++ ) {\n    echo \"\\nArgument $i is:\\n;\n    var_dump( $args[$i] );\n  }\n}\n\n\nSince var_dump() utilizes newlines instead of HTML for output formatting, view the output in the webpage's source (Ctrl+U for most browsers) for a more human-readable display.\n\nHowever, note that when an action or filter hook is registered via add_action() or add_filter(), one of the arguments for that registration is the number of arguments which the registered callback accepts - or defaults to 1 if no count is specified. If the hook registration specified a number of arguments less than what the action or filter can actually provide, then the mechanism above will not print all possible arguments. If you are in control of the hook registration, you can work around this restriction by registering the hook to accept an absurdly high argument count:\nadd_action( 'pre_get_posts', 'wpse40532', 10, 100 );\n\nThis should only be used as a development aide - be sure to set the argument count to that which you intend to use in production.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405432", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: How to Display WooCommerce Product Price in WooCommerce Archive I have created a custom function to display 2 custom fields (ACF) and the price of the product after the item in the WooCommerce Archive/Shop page.\nMy Custom fields are show, but I am unable to get the WooCommerce price. How can I fix my function to show the price?\n    add_action( 'woocommerce_after_shop_loop_item', 'acf_template_loop_product_meta', 20 );\nfunction acf_template_loop_product_meta() {\n    global $product;\n\n    if ( $brand  = get_field('brand', $product->get_id()) ) {\n        echo '<p><strong>'. __(\"&nbsp;&nbsp;&nbsp;&nbsp\") . '</strong> ' . $brand . '</p>';\n    }\n\n    if ( $designer  = get_field('designer', $product->get_id()) ) {\n        echo '<p><strong>'. __(\"&nbsp;&nbsp;&nbsp;&nbsp\") . '</strong> ' . $designer . '</p>';\n    }\n    if ( $price = $product->get_price(); ) {\n        echo '<p><strong>'. __(\"&nbsp;&nbsp;&nbsp;&nbsp\") . '</strong> ' . $price . '</p>';\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405435", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: JS / jQuery in Elementor pages vs JS file I have a lot of JavaScript and jQuery functions that are all working fine, but it's quite fragmented and hard to maintain as some are in Elementor HTML widgets, others in specific Pho functions annd some in an enqueued JS file.\nIdeally I'd like to move everything into the single JS file so it's easier to maintain, but would there be any performance implications? For example some scripts only need to run on specific pages but I assume they would load everywhere in a file. Would this have any realistic performance implications or am I being overly obsessive...?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405437", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Newly created user role not displaying on users screen I have created a new role with the following code:\nadd_role('sponsored_content', 'Sponsored Content', get_role('contributor')->capabilities);\n\nI have added users to this role.\nWhen viewing the users screen this Sponsored Content role does not display.\n\nUsing the browser inspect tool the markup is present:\n<li class=\"sponsored_content\"><a href=\"users.php?role=sponsored_content\">Sponsored Content <span class=\"count\">(6)</span></a> |</li>\n\nThere is styling coming from a \"constructed stylesheet\" preventing it from displaying:\n.sponsored_content {\n    display: none !important;\n}\n\nThis is not styling that I have added and I do not know where it is coming from. Any ideas where this styling is coming from or how to remove it?\n\nA: The constructed stylesheet was coming from the browser, in this case Brave Browser. The ad blocking feature added this styling. Turning shields off fixed the issue.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405442", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Nav Walker that shows only children and siblings of top level parent menu item I have a nav menu that is structured like this..\nMain Section 1\n\u2013 Child Link 1\n-- Grandchild Link 1\n\u2013 Child Link 2\n\u2013 Child Link 3\nMain Section 2\n\u2013 Child Link 1\n\u2013 Child Link 2\n\u2013 Child Link 3\n\nLets say that I am on any page within Main Section 1 (including Main Section 1 itself). I want to only show the menu items (and their children) that have Main Section 1 as their parent. So in this scenario the menu items that would be output by wp_nav_menu would be...\nChild Link 1\n- Grandchild Link 1\nChild Link 2\nChild Link 3\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405447", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Rewrite comment form post ID on submit I have a WordPress comment form, with a custom field (added with the Advanced Custom Field plugin) where the visitor can chose from a options (these are page IDs). When submitting the form, I want this select value to replace the comment_post_ID that by default adds the current page ID.\nWhat I'm trying to achieve is having a global comment form on just one page and then for the visitor to select a page (in our case, these are medical treatments) and then on submit, the comment is attached to the selected page, rather than the page the comment form is on.\nI have tried the preprocess_comment filter, which works fine if I hardcode the ID:\nfunction overwrite_comment_post_id( $commentdata ) {\n    $commentdata['comment_post_ID'] = '1562';\n    return $commentdata;\n}\nadd_filter( 'preprocess_comment' , 'overwrite_comment_post_id' );\n\nSince the preprocess_comment filter doesn't yet have a comment ID (comment hasn't been saved), I don't know how I can access my custom field value here?\nI have also read about the comment_post action (as suggested here on StackExchange), but I can't figure out how to get my custom field here either.\nIf anyone has any other suggestions, I would be curious to hear them!\nUpdated code\nfunction comment_post_id_update( $comment_ID, $comment_approved, $commentdata ) {\n    $commentdata = [];\n    $commentdata['comment_post_ID'] = $_POST['acf']['field_6278d64aecf19'];\n    wp_update_comment($commentdata);\n}\nadd_action( 'comment_post', 'comment_post_id_update', 10, 3 );\n\n\nA: This bit of code will update the comment_post_ID with the value submitted using your custom form.\nfunction wpse405448_update_comment( $comment_ID, $comment_approved, $commentdata ) {\n    if ( isset($_POST['acf']['field_6278d64aecf19']) && !empty($_POST['acf']['field_6278d64aecf19']) ) {\n        $comment_post_id = intval($_POST['acf']['field_6278d64aecf19']);\n        \n        $com_arr = array(\n            'comment_ID' => $comment_ID,\n            'comment_post_ID' => $comment_post_id,\n        );\n        \n        wp_update_comment($com_arr);\n    }\n}\nadd_action( 'comment_post', 'wpse405448_update_comment', 10, 3 );\n\nMake sure both the comment_ID and comment_post_ID are valid. Otherwise it wont get updated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405448", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I add a shortcode to query Custom Post Type with ACF in Wordpress? I am building a website for a client, and I needed to build a game release calendar using Custom Post Type and Advanced Custom Fields. Everything is built out, but the last step.\nI need to be able to query the CPT automatically whenever a new game is added, and pull it into the WP Bakery Visual Composer front end via shortcode. Below is the code added to the functions.php file, but I'm getting syntax errors because of \"<\". Can anyone help me with the proper syntax/formatting for getting it to save and call in properly via the shortcode?\nFUNCTIONS.PHP code\n// Custom Game Releases Shortcode\nadd_shortcode( 'my_vc_php_output', 'game_release_listings');\nfunction game_release_listings( $atts ) {\n    <?php \n\n$posts = get_posts(array(\n    'posts_per_page'    => -1,\n    'post_type'         => 'game_release'\n));\n\nif( $posts ): ?>    \n    <ul>\n        \n    <?php foreach( $posts as $post ): \n        \n        setup_postdata( $post );\n        \n        ?>\n        <li>\n            <a href=\"<?php the_permalink(); ?>\"><?php the_field('release_date'); ?></a>\n        </li>\n    \n    <?php endforeach; ?>\n    \n    </ul>\n    \n    <?php wp_reset_postdata(); ?>\n\n<?php endif; ?>\n}\n\n\nA: I ultimately figured out getting a shortcode to work by reworking the code to the following:\nadd_shortcode( 'gr_shortcode', 'gr_shortcode' );\nfunction gr_shortcode() {\n    $buffer = '<h3>Upcoming Titles</h3>';\n    $q = new WP_Query(array(\n        'post_type' => 'game_release',\n        'posts_per_page' => 3\n    ));\n    while ($q->have_posts()) {\n        $q->the_post();\n        $buffer = $buffer.get_the_title().'<br>'.$buffer.the_field('release_date');\n    \n    }\n    wp_reset_postdata();\n    return $buffer;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405449", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get a list of all attachements urls for every post of a wordpress installation? I'd like to retrieve a list of all attachment URLs for all posts of a website.\nThis would bring something like\nhttp://example.com/mypost/attachment-1/\nhttp://example.com/mypost/attachment-2/\nhttp://example.com/anotherpost/attachment-deff/\nhttp://example.com/post3/attachment-deff4/\n\nWould it imply to use: wp_get_attachment_url\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405450", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Should /wp-includes/js/* folder be blocked in robots.txt file for a WordPress website? In my WordPress website.\nI am disallowing /wp-includes/js/* folder in the robots file. Is that bad?\nI use SEMRush to audit my site and it shows an error that a resource at the above location is being blocked.\nThis is my robots.txt\n\nUser-agent: *\nAllow: /wp-content/uploads/\nDisallow: /wp-admin/\nDisallow: /wp-includes/\nDisallow: /wp-content/plugins/\nDisallow: /linkout/\nDisallow: /recommended/\nDisallow: /comments/feed/\nDisallow: /trackback/\nDisallow: /index.php\nDisallow: /xmlrpc.php\nDisallow: /readme.html\nDisallow: /refer/\nDisallow: /search/\n\nAllow: /wp-admin/admin-ajax.php\n\n\nSitemap: https://www.example.com/post-sitemap.xml\nSitemap: https://www.example.com/page-sitemap.xml\nSitemap: https://www.example.com/video_portal-sitemap.xml\nSitemap: https://www.example.com/press_release-sitemap.xml\nSitemap: https://www.example.com/careers-sitemap.xml\nSitemap: https://www.example.com/emplois-sitemap.xml\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405451", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Prevent posts with certain post_meta to be edited So I am looking at adding some custom post_meta to posts and I want those posts to not be editable, which will be some content that I am pulling in.\nHere is what I have:\nI have solved the issues when visiting the Post post_type and attempting to edit a post with a specific post_meta using this (This works great in the UI):\nadd_filter('post_row_actions', function($actions, $post) {\n    if (get_post_meta($post->ID, 'global_post', true)) {\n        unset($actions['edit']);\n        unset($actions['inline hide-if-no-js']);\n    }\n\n    return $actions;\n}, 10, 2);\n\nThe above hides the \"edit\" and \"quick edit\" buttons for posts with specific post_meta in the UI.\nHowever, when visiting the edit link directly (Example: https://example.com/wp-admin/post.php?post=19771&action=edit - I was still able to edit the post.\nIs there a way that I can prevent a post from being edited when visiting a link directly? I was able to successfully hide the buttons in the UI, but this would also be helpful.\n\nA: I think an elegant way to accomplish this would be to hook into map_meta_cap and deny users as though they do not have the capability to edit the post. This should also gate any other potential work-arounds, such as modifying the post through the REST API or direct POSTing. As an added benefit, it will also take care of omitting the edit links such that you don't need to include your current solution.\nadd_filter( 'map_meta_cap', 'wpse405452_restrict_global_post_editing', 10, 4 );\n\nfunction wpse405452_restrict_global_post_editing( $caps, $cap, $user_id, $args ) {\n  if( $cap !== 'edit_post' )\n    return $caps;\n  \n  $post_id = $args[0];\n\n  if( get_post_meta( $post_id, 'global_post', true ) )\n    $caps[] = 'do_not_allow';\n    \n  return $caps;\n}\n\nAn introduction to roles & capabilities can be found in the Plugin Developer Handbook\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405452", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I stop a dynamic Gutenberg component from re-rendering on every keystroke? I'm using some dynamic components inside a custom block; predominantly used for input fields inside the <InspectorControls> component. Below are the relevant portions of the custom block.\nimport summaryTypes from './components'\n\n// Dynamically set the component\nfunction SummaryTitle(props) {\n    const ThisComponent = summaryTypes.find((c) => c.value === summaryType).components.title\n    return <ThisComponent {...props}/>\n}\n\n// Slot fill provider\nconst TitleSlotFill = () => {\n    const TitleSlot = () => <Slot name=\"TitleSlot\"/>\n    TitleSlot.Content = () => (\n        <Fill name=\"TitleSlot\">\n            <SummaryTitle\n                content={title}\n                onUpdate={(title) => setAttributes({title})}\n            />\n        </Fill>\n    )\n    return (\n        <SlotFillProvider>\n            <TitleSlot/>\n            <TitleSlot.Content/>\n        </SlotFillProvider>\n    )\n}\n\n// Render\nreturn (\n    <>\n        <InspectorControls>\n            <Panel>\n                ...\n                <TitleSlotFill/>\n                ...\n            </Panel>\n        </InspectorControls>\n    </>\n)\n\nEverything displays correctly, however whenever the onUpdate function prop runs, the input (a TextControl component) loses focus. Obviously this doesn't happen when using the TextControl directly, and after doing some searching it seems that something somewhere in the chain is being re-rendered.\nMy question is, how can I prevent this re-rendering from happening, and keep focus on the input while typing?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405457", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Next and Previous Page links based on 'Order' attribute I'm trying to add Next and Previous links to my site Pages (not Posts) to navigate based on the 'Order' information. I copied some code from the Codex (https://codex.wordpress.org/Next_and_Previous_Links) that works fine (displays the pages in the right order - not cronological) except on the first and last pages where I get an error. The error shows \"Undefined array key\" where the Previous link on the first page should be and the same error (different array entry) where the Next link should be on the last page. Looks like an index error but I'm not a confident enough PHP programmer to figure it out. A lot of other solutions (plugins) link the pages cronologicaly and I want to be able to rearrange the page order (using Simple Page Ordering plugin by Jake Goldman).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405460", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: SQL query - get a featured image's alt / alternative text I am writing some SQL queries to get post data out of a database for certain posts (so WP functions are not an option). I am trying to get post IDs, post URLs, post featured image URLs and associated alt text for the featured images. Alt text is held in the postmeta table with the meta_key '_wp_attachment_image_alt'.\nThe query below works for everything except alt text. I am confident I need to use a left join because I want all posts returned regardless of whether they have featured images. My query however is returning null values for alt text for images I have confirmed have alt text.\nSELECT \n    wp_posts.id as \"Post ID\",\n    wp_posts.guid as \"Post URL\",\n    (SELECT wp_posts.id\n        FROM   wp_posts\n        WHERE  wp_posts.id = pm13.meta_value) AS \"Featured Image ID\",\n    \n    (SELECT wp_posts.guid\n        FROM   wp_posts\n        WHERE  wp_posts.id = pm13.meta_value) AS \"Featured Image URL\",\n    \n    (SELECT pm14.meta_value\n        FROM wp_postmeta\n        WHERE  wp_posts.id = pm14.meta_value\n        ) as \"Featured Image Alt Text\"\n\n    FROM   wp_posts\n    \n    LEFT JOIN wp_postmeta pm13\n        ON (\n            pm13.post_id = wp_posts.ID  AND\n            pm13.meta_key    = '_thumbnail_id'\n        )\n\n    LEFT JOIN wp_postmeta pm14\n        ON (\n            pm14.post_id = wp_posts.ID  AND\n            pm14.meta_key    = '_wp_attachment_image_alt'\n        )\n    \n    WHERE  wp_posts.post_status = \"publish\"\n           AND wp_posts.post_type = \"post\"\n    \n    \n    ORDER  BY wp_posts.post_date DESC\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405461", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Contact form 7 Hide response messages after 5 seconds I just installed this plugin and I must say it does everything I need.\nI am using a custom made popup div with a CF7 inside it.\nI need to hide response messages (error, success message) after 5 seconds. Is that possible?\n\nA: you can use below code to hide message\n// Contact Form 7 submit event fire\ndocument.addEventListener('wpcf7submit', function(event) {\n  setTimeout(function() {\n        jQuery('form.wpcf7-form').removeClass('sent');\n        jQuery('form.wpcf7-form').removeClass('failed');\n        jQuery('form.wpcf7-form').addClass('init');\n  }, 1000);\n\n}, false);\n\n\nA: I would like to use css than:\n.wpcf7-form.sent .wpcf7-response-output {\n  animation: hideresp 5s forwards; \n  animation-iteration-count: 1;\n}\n\n@keyframes hideresp {\n  90% { opacity:1; }\n  100% { opacity:0; }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405465", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Disable auto-embed feature when pasting links in Gutenberg editor? I want to disable the auto embed feature of Wordpress, when pasting arbitrary text that includes links in Gutenberg.\nI tried this with something like:\nadd_filter('allowed_block_types', 'remove_default_blocks');\nfunction remove_default_blocks($allowed_blocks){\n// Get all registered blocks\n$registered_blocks = WP_Block_Type_Registry::get_instance()->get_all_registered();\n\n// unset embed block\nunset($registered_blocks['core/embed']);\n\n// Get keys from array\n$registered_blocks = array_keys($registered_blocks);\n\n// Merge allowed core blocks with plugins blocks\nreturn $registered_blocks;\n\n}\nThis works - but unfortunately this disables all embed blogs and I want the user to manually embed e.g. YouTube.\nBest would be, if just the \"auto embedding\" could be disabled, but if the user could still choose the embed blocks manually and embed thinks.\nCan anybody help me here?\nThanks\nHarald\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405470", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to have multiple search result pages in wordpress with taxonomy terms listed I am using a custom theme which has custom post types. First one is Doctors another is Hospital. Both doctors and hospitals have a common taxonomy named specialities. Each speciality has some services assigned to them(Services here is a child taxonomy). What i want to achieve is once i select speciality as a filter The first search results appear which has 4 sections as follows :-\n\n*\n\n*The Services of the speciality listed(Services here is the child taxonomy). When i click on one of the services it shows me the second search results page which shows all Doctors, Hopitals and products linked to the particular service.\n\n\n*List of a few doctors which has a view all button spmewhere which shows all doctors assigned to that speciality.\n\n\n*List of a few hospitals which has a view all button somewhere which shows all hospitals assigned to that speciality.\n\n\n*List of all products assigned to the speciality.\nNote - I am using woocommerce for products and i have sucessfully achieved the above with that. Currently when i search for a speciality i have two sections in search results pages one for doctors and hospitals combined and one for the products linked to the speciality. I also know how to create different sections for doctors and hospitals in the search results page. What I am strugging with is how to display Services(Child taxonomy of Speciality) in the search result pages and have a permalink assigned to the same which displays all doctors,hospitals and products linked with that particular service in the second search results page. Please Help me out with this I am struggling with this for a long time.\nThanks In Advance\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405472", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Javascript code inside \"<# #>\" in core WordPress files .php I found some interesting embeding JavaScript mix with HTML in WordPress php files, for instance:\n<?php // Template for the Attachment Details two columns layout. ?>\n<script type=\"text/html\" id=\"tmpl-attachment-details-two-column\">\n    <div class=\"attachment-media-view {{ data.orientation }}\">\n        <h2 class=\"screen-reader-text\"><?php _e( 'Attachment Preview' ); ?></h2>\n        <div class=\"thumbnail thumbnail-{{ data.type }}\">\n            <# if ( data.uploading ) { #>\n                <div class=\"media-progress-bar\"><div></div></div>\n            <# } else if ( data.sizes && data.sizes.large ) { #>\n                <img class=\"details-image\" src=\"{{ data.sizes.large.url }}\" draggable=\"false\" alt=\"\" />\n            <# } else if ( data.sizes && data.sizes.full ) { #>\n                <img class=\"details-image\" src=\"{{ data.sizes.full.url }}\" draggable=\"false\" alt=\"\" />\n            <# } else if ( -1 === jQuery.inArray( data.type, [ 'audio', 'video' ] ) ) { #>\n                <img class=\"details-image icon\" src=\"{{ data.icon }}\" draggable=\"false\" alt=\"\" />\n            <# } #>\n\nCould you say pls, how and why this mix HTML with JS does work(HTML rendered)? Why Javascript is executed inside \"<# #>\"? Is it special syntax or what?\n\nA: These are Underscore Templates, handled by the wp.template() JavaScript function (source here) which takes in a template ID corresponding to a <script type=\"text/html\" id=\"tmpl-{template ID}\"> element containing such code and compiles it into a function. This function can then be executed with the variables used in the template in order to produce a string of HTML.\nFor the template in the excerpt provided in the question, that call might look like this:\nconst template = wp.template( 'attachment-details-two-column' );\nconst markup = template( {\n  orientation: 'landscape',\n  type: 'image',\n  uploading: false,\n  sizes: {\n    large: {\n      url: 'http://placehold.jp/3d4070/ffffff/150x150.png'\n    }\n  }\n} );\n\nWhere markup would now be a string containing (in part):\n    <div class=\"attachment-media-view landscape\">\n        <h2 class=\"screen-reader-text\">Attachment Preview</h2>\n        <div class=\"thumbnail thumbnail-image\">\n            <img class=\"details-image\" src=\"http://placehold.jp/3d4070/ffffff/150x150.png\" draggable=\"false\" alt=\"\" />\n\nwp.template() configures Underscores to use <# #> delimiters instead of the standard <% %> in order to avoid conflicts with some environments, where PHP versions prior to 7.0 may have been configured with the now deprecated asp_tags directive.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405473", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Unzip file in functions.php, and add it to cron I have a file in the root folder of my wordpress installation (myfolder, wp-content, wp-config, and all other).\nI want unzip a test.zip archive in my myfolder folder in root directory.\nI try this function on my theme functions.php :\nadd_action( 'test_unzip', 'unzip_folder' );\nfunction unzip_folder() {\n    WP_Filesystem();\n    $destination = '../myfolder/';\n    $destination_path = $destination['path'];\n    unzip_file( $destination_path.'/test.zip', $destination_path);\n}\n\nI add the action in cron to do it every 3 hours, and also to try my code. It's not work and I can't find where I failed :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405474", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Console errors in 6.0-RC1 Widget screen Sine 6.0-RC1 the following console error appears on the block widgets screen, on Firefox:\nWarning: Can't perform a React state update on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in a useEffect cleanup function.\nNotEmpty@https://betatest.opajaap.nl/wp-includes/js/dist/widgets.js?ver=80e98954519d1dad7a91a2248dbc2cc9:1118:7\ndiv\nEdit@https://betatest.opajaap.nl/wp-includes/js/dist/widgets.js?ver=80e98954519d1dad7a91a2248dbc2cc9:1051:7\nEdit@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:12908:7\nwithToolbarControls</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:12263:7\nwithInspectorControl</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:12475:26\ncustom_class_name_withInspectorControl</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:12582:35\nwithBlockControls</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:36311:33\nwithDuotoneControls</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:36678:32\nwithInspectorControls</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:36924:7\nqueryTopInspectorControls</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-library.js?ver=c0a77efe7e30b81595292ba7bdec3d8f:35990:7\nwithMoveToWidgetAreaToolbarItem</<@https://betatest.opajaap.nl/wp-includes/js/dist/edit-widgets.js?ver=6d1c3f1e5fbca4e69781de58b399425e:2327:7\nFilteredComponentRenderer@https://betatest.opajaap.nl/wp-includes/js/dist/components.js?ver=704ed65a1b8b5c891184113526f15ce4:73834:9BlockListBlock@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:18670:7\nwithDataAlign</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:12314:7\nwithBorderColorPaletteStyles</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:32258:7\nwithColorPaletteStyles</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:34086:7\nwithFontSizeInlineStyles</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:35312:31\nwithElementsStyles</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:36324:112\nwithDuotoneStyles</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:36722:29\nwithLayoutStyles</<@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:36944:7\nFilteredComponentRenderer@https://betatest.opajaap.nl/wp-includes/js/dist/components.js?ver=704ed65a1b8b5c891184113526f15ce4:73834:9\nifCondition/</<@https://betatest.opajaap.nl/wp-includes/js/dist/compose.js?ver=da94d523b115836ddbf0b3b774ddd94a:2201:8\nwithDispatch/</<@https://betatest.opajaap.nl/wp-includes/js/dist/data.js?ver=38ad563aa39c8f314fe6f6e430d81a69:4316:46\nwithSelect/</<@https://betatest.opajaap.nl/wp-includes/js/dist/data.js?ver=38ad563aa39c8f314fe6f6e430d81a69:4160:31\n@https://betatest.opajaap.nl/wp-includes/js/dist/compose.js?ver=da94d523b115836ddbf0b3b774ddd94a:2236:12\nItems@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:31568:7\nBlockListItems\nBlockContextProvider@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:12861:7\nUncontrolledInnerBlocks@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:31358:7\nControlledInnerBlocks@https://betatest.opajaap.nl/wp-includes/js/dist/block-editor.js?ver=e2ef0c6eb29e06ea9efedec924f1b9a8:31396:15\n\nETC ETC\n\nI found out that this only happens when plugin wp-photo-album-plus is activated (of which i am the author), and it only happens when one specific classic widget out of a total of 20 is loaded (need not to be activated).\nEven when i strip the code to the bare minimum this errors arise although it functions correct both at admin and froontend.\nThe bare minimum code is:\n/* wppa-searchwidget.php\n* Package: wp-photo-album-plus\n*\n* display the search widget\n* Version 8.0.09.003\n*\n*/\n\nclass wppaSearchPhotos extends WP_Widget {\n\n    /** constructor */\n    function __construct() {\n        $widget_ops = array(    'classname' => 'wppa_search_photos',\n                                'description' => __( 'Display search photos dialog', 'wp-photo-album-plus' )\n                            );\n        parent::__construct( 'wppa_search_photos', __( 'WPPA+ Search Photos', 'wp-photo-album-plus' ), $widget_ops );\n    }\n\n    /** @see WP_Widget::widget */\n    function widget( $args, $instance ) {\n\n    }\n\n    /** @see WP_Widget::update */\n    function update( $new_instance, $old_instance ) {\n\n        $instance = $new_instance;\n\n        return $instance;\n    }\n\n    /** @see WP_Widget::form */\n    function form( $instance ) {\n\n    }\n\n} // class wppaSearchPhotos\n\n// register wppaSearchPhotos widget\nadd_action('widgets_init', 'wppa_register_wppaSearchPhotos' );\n\nfunction wppa_register_wppaSearchPhotos() {\n    register_widget( \"wppaSearchPhotos\" );\n}\n\nDo i something wrong or is this a 6.0-RC1 bug ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405476", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change reminder email date to 14 days before I want to send the reminder email for a booking (from the Woocommerce Booking plugin) 14 days before the activity instead of the default 1. I have found the following code online and added it to wp-content/themes/flatsome-child/functions.php but none of them seem to trigger or work.\nadd_filter( 'woocommerce_bookings_remind_before_days', 'drop_reminder_days', 10 );\nfunction drop_reminder_days($value) {\n    error_log(\"===== this is the amount of days ======\");\n    error_log($value);\n    return 14;\n}\n\nadd_filter( 'woocommerce_bookings_remind_before_days', function() {return 14;}, 10, 2 );\n\nadd_filter( 'woocommerce_bookings_remind_before_days', create_function( '', 'return 3;' ) );\n\nAny Idea how to fix this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405479", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display post title from WordPress excluding a string via API Imagine you have custom post types -  Users.\nThere are fields for each user as the post title, description, image, and rules.\nAll titles are names of the Users and all they have Mr. before the names.\nWhat is the correct way and how to display all these fields via API in another site(not WordPress) but for the titles to exclude/strip the string Mr.?\n\nA: If you're pulling REST API data from a WordPress site (\"server\") to a non-WordPress site (\"client\"), your client site won't have access to WordPress functions like get_the_title(), etc.\nWhat you will receive from the server is a JSON string that will look something like this:\n// eg. from example.com/wp-json/wp/v2/posts\n\n[\n    {\n        \"id\":10887,\n        \"date\":\"2022-05-04T11:25:43\",\n        \"date_gmt\":\"2022-05-04T16:25:43\",\n        \"guid\":\n            {\n                \"rendered\":\"https:\\/\\/example.com\\/?p=10887\"\n            },\n        \"modified\":\"2022-05-04T15:43:25\",\n        \"modified_gmt\":\"2022-05-04T20:43:25\",\n        \"slug\":\"bacon-its-whats-for-dinner\",\n        \"status\":\"publish\",\n        \"type\":\"post\",\n        \"link\":\"https:\\/\\/example.com\\/2022\\/05\\/04\\/bacon-its-whats-for-dinner\\/\",\n        \"title\":\n            {\n                \"rendered\":\"Bacon: It&#8217;s What&#8217;s for Dinner\"\n            },\n        \"content\":\n            {\n                \"rendered\":\"{some content here}\",\n                \"protected\":false\n            },\n        \"author\":7,\n        \"featured_media\":0,\n        # ... more and more ...\n    },\n    { ... }\n]\n\nIf you're using PHP, you can convert that JSON string to an array of stdClass objects using json_decode().\nAssuming that $json is the JSON response you've received from your WordPress server's REST API, and that you're using the standard WP posts endpoint, you can do something like this:\n$data = json_decode( $json );\nforeach ( $data as $post ) {\n    $title = $post->title->rendered;\n    $my_title = str_replace( 'Mr.', '', $title );\n}\n\nIf you've got some other custom endpoint set up for your custom posts, you'll need to use the appropriate property in your JSON data to get the title (and any other data you might need to display/store/retrieve on the client side).\nIf you haven't encountered it, I recommend looking through the REST API Handbook that WordPress provides.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405481", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How does add_option() function enable action hooks to fire right after actiavtion? The documentation page says that the hook process performs an instant redirect after it fires. So, in order to do something right after the activation the page suggests using add_option like so,\nfunction my_plugin_activate() {\n\n  add_option( 'Activated_Plugin', 'Plugin-Slug' );\n\n  /* activation code here */\n}\nregister_activation_hook( __FILE__, 'my_plugin_activate' );\n\nfunction load_plugin() {\n\n    if ( is_admin() && get_option( 'Activated_Plugin' ) == 'Plugin-Slug' ) {\n\n        delete_option( 'Activated_Plugin' );\n\n        /* do stuff once right after activation */\n        // example: add_action( 'init', 'my_init_function' );\n    }\n}\nadd_action( 'admin_init', 'load_plugin' );\n\nHow is this any different from,\nfunction load_plugin()\n{\n //some code\n}\nadd_action('admin_init','load_plugin');\n\nWon't load_plugin() function run in the same order in both the cases?\n\nA: The important thing to note is that admin_init runs on every admin page load. So if you put a redirect inside that hook it will redirect every time you try to do something in the admin.\nIn this code when the plugin is activated an option is saved in the database, Activated_Plugin. The next time admin_init runs this option is checked and if it exists the option is deleted. This means that the option will only exist for one page load. So if you put code inside this check it will only run once, because the next time admin_init runs the database option won't exist anymore.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405482", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change \"published by\" https://i.stack.imgur.com/tHTdu.jpg\nAt my blogg / news is this line is coming at a new post.\nI use norwegian as language and then I want to change the word I marked yellow.\nIn english is \"published by:\"\nIn norwegian is would be \"publisert av:\", but I want it to say \"Written by:\" or in norwegian \"Skrevet av:\"\nHow can I fix that ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405484", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Parent User and Child User - relate users I need to create a system in which I have 2 types of users: Company User (C) and Employee User (E).\nI need C to be able to register as many E as necessary and for C users to be able to publish articles that will only be visible to E users, children of C users.\nI figured it would be possible to do this with meta fields so I created the ACF DAD and CHILD field with Jet Engine plugin. I couldn't but I didn't succeed.\nCan anyone tell me if it is possible to use metafields for this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405487", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: can't install any wp plugins We recently moved WP hosts.\nWe backed up WP and imported it to a development site wp.mysite.com to get it all set up.\nOnce everything was done, we switched the DNS and went live with newdomain.com on the new server. It's been running for a while but I now see a problem with plug-ins. The end user wanted to add a plugin but gets a 403 permissions denied error and at the top of the error it lists wp.mysite.com (the old development site URL). So as it stands we cannot add any plug-ins.\nI downloaded the entire database in SQL text and searched but couldn't find any references to wp.mysite.com.\nMy assumption is that the permalink hash does not match the permalinks (which appear correct).\nI've went to  Settings >> Permalinks and saved but they did not correct.\nCould this be corrected with a RewriteRule in .htaccess where wp.mysite.com gets redirected to newsite.com?\nIs there a better way to correct the permalink hash?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405488", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I detect user's timezone? I have a custom post type in wordpress. I am pulling various data from remote server with API and adding it as custom fields to this post type. Among them is date and time whose Timezone is Turkey. I'm saving this date as a custom field.\nBut I want to implement Time Zone based on visitor's location while showing date in front-end.\nWhen I researched I realized that we cannot detect client-side Time Zone easily with PHP. I've looked at some recommendations using cookies and JavaScript, but the client's first visit will show an incorrect date and in subsequent requests, the correct timezone will be visible thanks to the cookie. Naturally, this is undesirable.\nFinally, I can't think of a solution other than using 3rd party services.\nDo you think there is a way to get the correct timezone of the client on the server side with PHP?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405494", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can i redirect one url to another url using .htaccess or add_rewrite_rule I am stuck at redirecting one url to another url.\nI want to redirect\nhttps://samedomain.com/page-check-927GSJAYS639AL/highlights\n\nto\nhttps://samedomain.com/page-highlights/\n\n(927GSJAYS639AL this is id it can be anything)\nthe http://samedomain.com/page-highlights/ is the wordpress page\nThe rewrite rule I tied in .htaccess file (added this in the first line it-self) is:\nRewriteEngine On\nRewriteRule ^page-check-([A-Z0-9_-]+)/highlights$ page-highlights?id=$1 [L]\n\nbut I see a 404 error page\nIt worked for\nRewriteEngine On\nRewriteRule ^page-check-([A-Z0-9_-]+)/highlights$ info.php?id=$1 [L]\n\nI also tried WP rewrite API php code\nUPDATE 1\nadd_action('init', 'ao_add_rewrite_rule');\nfunction ao_add_rewrite_rule() {\n   add_rewrite_rule('^page-check-([A-Z0-9_-]+)/highlights/?$', 'index.php?pagename=page-highlights&id=$matches[1]', 'top');\n}\n\nUPDATE 2\nadd_action('init', 'ao_add_rewrite_rule');\nfunction ao_add_rewrite_rule() {\n   add_rewrite_rule('^page-check-([A-Z0-9_-]+)/highlights/?$', 'index.php?pagename=page-highlights&id=$matches[1]', 'top');\n}\nadd_filter( 'query_vars', 'wpa5413_query_vars' );\nfunction wpa5413_query_vars( $query_vars ) {\n   $query_vars[] = 'id';\n   return $query_vars;\n}\n\nAdding this line RewriteRule ^page-check-([A-Z0-9_-]+)/highlights$ index.php?pagename=page-highlights&id=$1 [L]  in .htaccess file works, but it will do 301 redirect, so the URL also changes back to https://samedomain.com/page-highlights/\nNo Luck :( in finding solutions\nAny help is highly appreciated. Thanks in advance.\n\nA: I'm honestly struggling to comprehend this failure state - I believe I've reproduced the issue locally, and in my testing the RewriteRule directive hits but then WordPress processes the original input, resulting in a fairly catch-all attachment rewrite producing a query for a non-existent attachment. I may continue playing with it to try and figure out what's going on.\nIn the meantime, I think the root of the issue is complexity introduced by using a URI as the target of the RewriteRule. Using a file path seems to alleviate the problem:\nRewriteRule ^page-check-([A-Z0-9_-]+)/highlights/?$ index.php?pagename=page-highlights&id=$1 [L]\n\nRegarding the use of add_rewrite_rule(), I have a few notes:\n\n*\n\n*When you use a target which does not start with index.php, WordPress will write the rule to the .htaccess file and implicitly begin the pattern with the ^ character - thus, starting a pattern with ^ while using a URI target can result in malformed rule beginning with ^^.\n\n*Instead of positional references to matches such as $1, WordPress uses the syntax $matches[1].\n\n*Flushing rewrite rules is a fairly expensive operation - I'd strongly recommend against flushing them in routine hook!\n\nThe above in mind, an add_rewrite_rule() with using a filepath target akin to the above RewriteRule directive would look as such:\nadd_action('init', 'ao_add_rewrite_rule');\n\nfunction ao_add_rewrite_rule() {\n   add_rewrite_rule('^page-check-([A-Z0-9_-]+)/highlights/?$', 'index.php?pagename=page-highlights&id=$matches[1]', 'top');\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405495", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Changing labels of status filters for post grid Is there a way to change filter labels for custom post type? For example, change Drafts (2) to Disabled (2) without localization plugins like Loco Translate?\n\nI've tried apply_filters( \"views_{$this->screen->id}\", $views ); filter, but array already contains links with html. Regex doesn't looks \"the right way\".\nArray\n(\n    [all] => <a href=\"edit.php?post_type=sha-wlc\" class=\"current\" aria-current=\"page\">All <span class=\"count\">(13)</span></a>\n    [publish] => <a href=\"edit.php?post_status=publish&#038;post_type=sha-wlc\">Published <span class=\"count\">(11)</span></a>\n    [draft] => <a href=\"edit.php?post_status=draft&#038;post_type=sha-wlc\">Drafts <span class=\"count\">(2)</span></a>\n    [trash] => <a href=\"edit.php?post_status=trash&#038;post_type=sha-wlc\">Trash <span class=\"count\">(1)</span></a>\n)\n\n\nA: Here's an untested way to override it, based on my older answer:\nadd_action( 'init', function() {   \n    $vars = get_object_vars( \n        get_post_status_object( 'draft' ) \n    );\n    $vars['label_count'] = _n_noop(\n        'Disabled <span class=\"count\">(%s)</span>',\n        'Disabled <span class=\"count\">(%s)</span>',\n        'wpse-domain'\n    );\n    register_post_status( 'draft', $vars );\n}, 1 );\n\nWe use the priority 1, since the default draft status is registered at priority 0.\nYou might look into the $vars['label'] as well.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405498", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How can I view my site directly from WordPress dashboard? Basically, I am using localhost through XAMPP, it has been 2 weeks since I started and and I had to reinstall XAMPP because I was having problems with ports. And now, I just started remaking my website again, using the port '3000' for apache and everything seemed to work fine until I can't even see the changed I have made from the wordpress dashboard or by just writing the domain name in the search bar, what is weird is that, I can access the admin page without a problem but I can't view the site.\nWhat am I missing? What is the problem?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405500", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Add Extra Settings to Appearance/Customizer Sections homepage I want to exactly add settings to the static_front_page section in the customizer Sections homepage, I wrote code in functions.php for that but it doesn't work.\n\nmy code in functions.php file:\nfunction mytheme_customize_register($wp_customize) {\n    $wp_customize->add_setting( 'homepage_heading', array(\n        'capability' => 'edit_theme_options',\n        'default' => ''\n    ));\n\n    $wp_customize->add_control( new WP_Customize_Control($wp_customize, 'homepage_heading_control', array(\n        'label' => 'Homepage Heading',\n        'section' => 'static_front_page ',\n        'settings' => 'homepage_heading'\n    ) ));\n}\n\nadd_action('customize_register', 'mytheme_customize_register');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405502", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get ACF taxonomy term and sub-term lists ACF blocks I want to get list of parents and child terms from ACF field type Taxonomy. This things need to display as ACF blocks. i have tried many things to done this stuffs but but it's not working for me.\nScreenshots:\nFrontend:\nhttps://shorturl.at/sHK02\nBackend:\nhttps://shorturl.at/ESV06\nACF Field:\nhttps://shorturl.at/lntI7\n <div class=\"filter\">\n                        <small class=\"filter-title\">Categories</small>\n                        <div class=\"filter--select\">\n                            <div class=\"filter--select-active\"><span class=\"filter--select-active-text\">All</span></div>\n                            <div class=\"filter--select-options\">\n                                <div class=\"filter--accordion\">\n                                    <div class=\"filter--accordion-title\">\n                                        <h5>Blog</h5>\n                                        <div class=\"checkbox\">\n                                            <input id=\"blog\" type=\"checkbox\" value=\"filter0\">\n                                            <label for=\"blog\"></label>\n                                        </div>\n                                    </div>\n                                    <ul class=\"filter--accordion-body\">\n                                        <li>\n                                            <p>Career advancement</p>\n                                            <div class=\"checkbox\">\n                                                <input id=\"careerAdvancement\" type=\"checkbox\" value=\"filter1\">\n                                                <label for=\"careerAdvancement\"></label>\n                                            </div>\n                                        </li>\n                                        <li>\n                                            <p>Leadership</p>\n                                            <div class=\"checkbox\">\n                                                <input id=\"leadership\" type=\"checkbox\" value=\"filter2\">\n                                                <label for=\"leadership\"></label>\n                                            </div>\n                                        </li>\n                                        <li>\n                                            <p>Technical skills</p>\n                                            <div class=\"checkbox\">\n                                                <input id=\"technicalSkills\" type=\"checkbox\" value=\"filter3\">\n                                                <label for=\"technicalSkills\"></label>\n                                            </div>\n                                        </li>\n                                        <li>\n                                            <p>Thought leadership</p>\n                                            <div class=\"checkbox\">\n                                                <input id=\"thoughtLeadership\" type=\"checkbox\" value=\"filter4\">\n                                                <label for=\"thoughtLeadership\"></label>\n                                            </div>\n                                        </li>\n                                        <li>\n                                            <p>Current events</p>\n                                            <div class=\"checkbox\">\n                                                <input id=\"currentEvents\" type=\"checkbox\" value=\"filter5\">\n                                                <label for=\"currentEvents\"></label>\n                                            </div>\n                                        </li>\n                                    </ul>\n                                </div>\n                         \n                              \n                            </div>\n                        </div>\n                        <div class=\"filter-reset\" id=\"clear-filters\">Reset filter</div>\n                    </div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405503", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sort posts according to a numeric value entered with ACF I've tried a little bit of everything, but I still can't find the right solution.\nI need to sort my posts according to a numeric value that is entered in each post. I'm using the following PHP code, but it's not working:\n$args['meta_query'] = array(\n    array(\n        'key' => 'key',\n        'type' => 'numeric',\n    )\n);\n\nI also tried this code:\n$args['meta_key'] = 'costo_attrazioni_ridotti_18_25';\n\nThen of course I have these other values in the args as well:\n$paged = ( get_query_var('paged') ) ? get_query_var('paged') : 1;\n$args=array(\n        'post_type' => 'post',\n        'post_status' => 'publish',\n        'posts_per_page' => 10,\n        'meta_key' = 'costo_attrazioni_ridotti_18_25',\n        'order' => 'ASC',\n        'orderby' => 'meta_value_num',\n        'paged' => $paged,\n);\n$the_query = new WP_Query( $args );\nif ($the_query->have_posts()):\n    while ($the_query -> have_posts()) : $the_query -> the_post();?>\n        ...\n    endwhile;\nendif; unset($the_query); wp_reset_query();\n\nHow can I solve it? Thank you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405505", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to show records that don't have custom meta value Running pre_get_posts, I want to order the items by a custom meta value. The problem is that by default this doesn't exist. Only if a user performs a certain action does the meta key/value get added.\nThat being said, even if they don't ever click on the item itself, I would like it to be displayed. Basically the order is the number of clicks an items has received.\nSo, the most clicked item should be first and the items that haven't been clicked yet should be last, but they are not showing up at all.\nfunction show_user_counts( $query ) {\n\n  if( !is_admin() && $query->is_main_query() && $query->is_tax('my_category')) {\n    $query->set('meta_key', 'number_clicks' );\n    $query->set('orderby', 'meta_value'  );\n    $query->set( 'order', 'DESC' );\n  }\n}\nadd_action('pre_get_posts', 'show_user_counts', 9999);\n\n\nA: \nthe most clicked item should be first and the items that haven't been clicked yet should be last, but they are not showing up at all\n\nThey aren't showing up because your posts query is only selecting posts that have the number_clicks meta, and thus MySQL ignores all posts which do not have that meta.\nSo what you need is two meta query clauses with an OR relation \u2014 the 1st clause will select posts that have the number_clicks meta, whereas the 2nd clause will select posts without that meta.\nAnd for that, you can instead use the meta_query arg, so in your code, just replace the $query->set('meta_key', 'number_clicks' ); with:\n$query->set( 'meta_query', array(\n    'relation'       => 'OR',\n\n    'number_clicks'  => array( // 1st clause\n        'key' => 'number_clicks',\n    ),\n\n    'number_clicks2' => array( // 2nd clause\n        'key'     => 'number_clicks',\n        'compare' => 'NOT EXISTS',\n        'type'    => 'NUMERIC',\n    ),\n) );\n\nThen to sort the results by the number_clicks value, set the orderby to the array key (number_clicks2) for the 2nd clause above, i.e. $query->set( 'orderby', 'number_clicks2' ).\nAnd note that the 2nd clause above uses NUMERIC as the type so that MySQL will convert the meta value to a number which then gives us the correct numerical sorting.\n\n*\n\n*Remember that meta values are stored as strings/text in the database, hence for example (these individual values \u2014 ) 10, 4, 1, 3, 2 will be sorted into 1, 10, 2, 3, 4 instead of 1, 2, 3, 4, 10. Because that's what happen when the values are sorted as strings.\n\n\n*So actually, you should've used $query->set( 'orderby', 'meta_value_num' ) so that the meta value is converted to a number prior to sorting. But now you no longer need to use that because the meta value type is already set in the 2nd clause above.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405506", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can't find out why dbDelta dosen't create my table I have a function which needs to create a new table an d i can't see for the life of me why it dosen't create the table:\nfunction afdv_create_delivery_table ( $id ){\n\n    global $wpdb;\n\n    $charset_collate = $wpdb->get_charset_collate();\n\n    //table name composed of db prefix + delivery + company ID\n    $table_name = $wpdb->prefix . \"delivery_\" . $id;\n\n    $sql = \"CREATE TABLE $table_name (\n      id int(10) unsigned NOT NULL AUTO_INCREMENT,\n      userId int(10) NOT NULL,\n      plati DECIMAL(10,2) NOT NULL,\n      incasariCash DECIMAL(10,2) NOT NULL,\n      incasariPvo DECIMAL(10,2) NOT NULL,\n      incasariTransfer DECIMAL(10,2) NOT NULL,\n      incasariOnline DECIMAL(10,2) NOT NULL,\n      balanta DECIMAL(10,2) NOT NULL,\n      transportIncasat DECIMAL(10,2) NOT NULL,\n      bacsis DECIMAL(10,2) NOT NULL,\n      sold DECIMAL(10,2) NOT NULL,\n      cardId varchar(255) DEFAULT NULL,\n      walletId varchar(255) DEFAULT NULL,\n      data DATETIME default '0000-00-00 00:00:00' NOT NULL,\n      terminalId varchar(255) DEFAULT NULL,\n      transactionType int(10) DEFAULT NULL,\n      companyId int(10) DEFAULT NULL,\n      messageId varchar(255) DEFAULT NULL,\n      dataModificare DATETIME default '0000-00-00 00:00:00' NOT NULL,\n      paired int(10) NOT NULL,\n      createdBy int(10) NOT NULL,\n      PRIMARY KEY  (id),\n      INDEX idx_card (cardId),\n      INDEX idx_wallet (walltId),\n      INDEX idX_terminal (terminalId)\n    ) $charset_collate;\";\n\n    require_once( ABSPATH . 'wp-admin/includes/upgrade.php' );\n\n    return dbDelta( $sql, true );\n}\n\nI tryied changing INDEX to KEY, changing all the \"int\" to \"INT\", lower case for all columns names.\nI can't see what is wrong. I get the message that table was created but the table is not present in the database.\nAny help appreciated!\nThanks!\nEDIT: OP Found it.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405507", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Dynamically add Js I have a basic bunch of CSS/Js files defined in my functions.php file. There I register and enqueue those scripts and stylesheets.\nBut in specific situations I want to load additional scripts based on the site template which is used.\nI tried to register and enqueue those additional scripts in the specific Template file, but it didnt work. It does only work when included in the functions.php.\nWhat is the correct way to do this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405508", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Install a MU plugin from within another plugin I am writing a plugin that needs to disable another plugin on specific pages of the site.  I know how to do this using the option_active_plugins filter, but that filter only works from an MU plugin.\nSo is it possible to programatically install a MU plugin from my main plugin so that I can run this filter?  Or is there another way to tackle this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405516", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: can't modify post title using the_posts filter I tried to modify post title and content, content is modified in output, but title stays intact:\nfunction filter_the_posts( $array , $oQuery) {\n   ...\n   $array[0]->post_title='new title';\n   $array[0]->post_content ='new content';\n   return $array;\n}\n\nadd_filter( 'the_posts', 'filter_the_posts', 10, 2 );\n\n\nA: You missed the return statement.\nfunction filter_the_posts( $array , $oQuery) {\n       ...\n       $array[0]->post_title='new title';\n       $array[0]->post_content ='new content';\n       return $array;\n    }\n   \nadd_filter( 'the_posts', 'filter_the_posts', 10, 2 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405517", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding custom column in User List with custom action I want to add a custom column in the User list in the WordPress admin dashboard with a custom action to perform. It means in the custom column, I want to add a button for each user. While clicking the button, it will redirect to a new page link with user_id. How can I achieve this?\n\nA: Start up a new custom plugin for something like this, and add the first code below to add a custom \u201cActions\u201d column, and the second function will add some link to the column for each row.\nadd_filter( 'manage_users_columns', 'new_column_user_table' );\nfunction new_column_user_table( $column )     {\n    $column['actions'] = 'Actions';\n    return $column;\n}\n\nadd_filter( 'manage_users_custom_column', 'new_column_user_table_row', 10, 3 );\nfunction new_column_user_table_row( $val, $column_name, $user_id ) {\n    if($column_name == 'actions') {\n        return \u201cnot sure what link you want, but your link code goes here\u201d;\n    }\n    return $val;\n}\n\nRefs:\n\n*\n\n*https://developer.wordpress.org/reference/hooks/manage_screen-id_columns/\n\n*https://developer.wordpress.org/reference/hooks/manage_users_custom_column/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405519", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: How to Get Last ID? I am developing a plugin for wordpress. I have created table in SQL for export ID. I need to call back this ID by adding 1. The code I use is as below\nThis is how I query the ID in SQL table.\n    global $wpdb; $last_id = $wpdb->get_var( 'SELECT id FROM ' . $wpdb->prefix . '_bek_exports' . ' ORDER BY id DESC LIMIT 1');\n\nThis is how I use it in the code below\nif ( $export_id == (++$last_id) ) {\n\nUPDATE\nI solved the problem. If you want to use it, it is written below.\n$last_id = $wpdb->get_var( 'SELECT id FROM ' . $wpdb->prefix . 'bek_exports' . ' ORDER BY id DESC LIMIT 1 ');\n\nWhen you write as in the code, it takes the last id created.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405521", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Broken link additional images after moving server Recently we moved the website of our client to a new server, and in doing so the links to almost all the images were broken. I've been able to fix the majority of them, but somehow in the woocommerce, it's not showing additional images.\nAt first it wasn't even showing the primary image, but I was able to solve that by fixing the links in the database.\nThe aditional images however are still not loading. Using a product feed plugin I've found that they are trying to load from a broken url (as is shown in the attached image).\nNow, I'm unable to find where the path for the additional images is in order to change it. I've searched the database for any '//wp_content/' links but nothing shows.\nHow do I go about fixing this?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405522", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to assign php file(template) to several pages with same prefix page name/slug Can I assign WP php file (specific template) to several pages with same prefix name/slug using (if is_page(){}) ?\nIf it's possible it could be useful.\nIs there a php function to do like css selector : [class*=\"activity-\"]\nfor example ??: if(is_page('[activity-]')){ include \"activity.php\"; }\nthe goal is to not repeat 4 times the same function :\nif(is_page('activity-sport')){ include \"activity.php\"; } \nactivity.php assign to :\n\n*\n\n*website/activity-sport\n\n*website/activity-culture\n\n*website/activity-charity\n\n*website/activity-work\n\nA: How about this?\nFor PHP 8 (faster)\nif ( str_contains( get_post_field( 'post_name' ), 'activity') ) { \n    get_template_part( 'activity' );\n}\n\nFor older versions of PHP\nif ( strpos(get_post_field( 'post_name' ), 'activity') !== false ) { \n    get_template_part( 'activity' );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405524", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Dynamically insert code to custom post type loop I need to display post from custom post type name \"film\", from a specific taxonomy \"Horror.\"\nEverything work fine when I type the taxonomy directly like this:\n    <?php  $blog = array(\n    'post_type'         => 'film',\n    'catfilm' => 'Horror',                      \n    'post_status'       => 'publish',\n    'posts_per_page'    =>4,\n    'ignore_sticky_posts' => 1,\n     );\n    ?>\n        \n\nI need to insert dynamically the taxonomy with CMB2, so I change the code like this, but no luck. The post failed to appear:\nMy CMB2 function:\n$cmb_tvseries->add_field( array(\n    'name'        => esc_html__( 'type the category', 'cmb2' ),\n    'id'          => 'mytheme_catfilm',\n    'type'        => 'text',\n) );\n\nMy loop change to:\n  <?php $blog = array(\n    'post_type'         => 'film',\n    'catfilm' => '<?php echo ( get_post_meta( get_the_ID(), \"mytheme_catfilm\", true ) ); ?>',                       \n    'post_status'       => 'publish',\n    'posts_per_page'    =>4,\n    'ignore_sticky_posts' => 1,\n    );\n    ?>\n\nI am newbie on php. Please help.\n\nA: Create a variable outside the array and then pass it to the array:\n<?php \n$catfilm = get_post_meta( get_the_ID(), \"mytheme_catfilm\", true );\n$blog = array(\n    'post_type'         => 'film',\n    'catfilm'           => $catfilm,                       \n    'post_status'       => 'publish',\n    'posts_per_page'    => 4,\n    'ignore_sticky_posts' => 1,\n    );\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405525", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to stop your plugin from executing on certain pages? I'm building a plugin that extends WooCommerce and I want to prevent it from executing once it hits the template_redirect hook. My goal is to stop the plugin from loading all the assets on non-product pages. Any ideas on how to do this?\nCode\nadd_action('template_redirect', array($this, 'stoplight'));\n\nfunction stoplight() {\n        $post_type = get_post_type();\n        if ($post_type != 'product') {\n            return;\n            //I used wp_die() here as well, but it killed WordPress.\n        }\n    }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405527", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Same URL for portfolio and for a page creates 404 error. Is there any filter that i can use for a child page? What I try to achieve is to have the portfolio slug as a page slug also, and when I will assign the page as a parent to another, then that page must look for a specific page's parent ID and return the correct results.\nIf I have the same slug in portfolio and in a page and try to create a child page, then I will get an error.\nExample: Portfolio slug: test/rent-a-car. Page slug: test/rent-a-car.\nIf I create a page test/rent-a-car/child-page, then the child page will give a 404 error.\nIs this possible to be achieved anyhow?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405533", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add .html permalink to post if specific category I followed this helpful guide (update 2)\nGiving specific category posts its own permalink structure returns 404\nthat creates the following permalink if the category \u201cFoodguide\u201d is selected:\n/foodguide/25/post name slug.html\n(Category/post Id/post name.html)\nHere is the code that I am using in functions.php:\n//Rewrite URLs for \"Foodguide\" category\nadd_filter( 'post_link', 'custom_permalink', 10, 3 );\nfunction custom_permalink( $permalink, $post, $leavename ) {\n    // Get the category for the post\n    $category = get_the_category($post->ID);\n    if (  !empty($category) && $category[0]->cat_name == \"Foodguide\" ) {\n        $cat_name = strtolower($category[0]->cat_name);\n        $permalink = untrailingslashit( home_url( '/'. $cat_name . '/' . $post->ID . '/' . $post->post_name . '.html' ) );\n    }\n    return $permalink;\n}\n\nadd_filter( 'category_link', 'custom_category_permalink', 10, 2 );\nfunction custom_category_permalink( $link, $cat_id ) {\n    $slug = get_term_field( 'slug', $cat_id, 'category' );\n    if ( ! is_wp_error( $slug ) && 'foodguide' === $slug ) {\n        $link = home_url( user_trailingslashit( '/foodguide/', 'category' ) );\n    }\n    return $link;\n}\n\nadd_action( 'init', 'custom_rewrite_rules' );\nfunction custom_rewrite_rules() {\n    add_rewrite_rule(\n        'foodguide(?:/page/?([0-9]{1,})|)/?$',\n        'index.php?category_name=foodguide&paged=$matches[1]',\n        'top' // The rule position; either 'top' or 'bottom' (default).\n    );\n\n    add_rewrite_rule(\n    '^foodguide/(\\d+)/[^/]+\\.html$',\n    'index.php?category_name=foodguide&p=$matches[1]',\n    'top'\n);\n}\nfunction cancel_canonical_redirect( $wp ) {\n    if ( '^foodguide/(\\d+)/[^/]+\\.html$' === $wp->matched_rule ) {\n        remove_action( 'template_redirect', 'redirect_canonical' );\n    }\n}\nadd_action( 'parse_request', 'cancel_canonical_redirect' );\n\nThe change that I need is the following:\nWhen category \u201cFoodguide\u201d is selected, I want to show domain.com/postname.html\n(No category or post id)\nAppreciate any help.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405534", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hot to check if new posts have been published since page load and notify online users? I want to show a div notifying online users that there are new posts since they have accessed the page, in the index and also if new posts have been added in the category or tag they are browsing.\nI have been trying for hours to find a script that does exactly what I need, but I have not found anything exact, and my programming level is very low. Can anybody help me please?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405537", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Get Category Name When Export Products I'm writing an export plugin for WooCommerce. I want to print the product categories and subcategories in separate columns while exporting the products in the plugin I developed.\nMy code is as below.\nfunction wpae_wp_all_export_csv_headers( $headers, $export_id ) {\nglobal $wpdb;\n$last_id = $wpdb->get_var( 'SELECT id FROM ' . $wpdb->prefix . 'bek_export' . ' ORDER BY id DESC LIMIT 1 ');\n    if ( $export_id == $last_id++ ) { \n        $additional_headers = array(\n            'Category 1',\n            'Category 2',\n            'Category 3',\n            'Category 4',\n            'Sub-Category 1',\n            'Sub-Category 2',\n            'Sub-Category 3',\n            'Sub-Category 4'\n        );\n        $headers = array_merge( $headers, $additional_headers );\n    }\n    return $headers; \n}\n\nfunction wp_all_export_csv_rows( $articles, $options, $export_id ) {\nglobal $wpdb;\n$last_id = $wpdb->get_var( 'SELECT id FROM ' . $wpdb->prefix . 'bek_export' . ' ORDER BY id DESC LIMIT 1 ');    \n    if ( $export_id == $last_id++ ) { // change to your export ID\n        foreach( $articles as $key => $article ) {\n            if ( array_key_exists( 'ID', $article ) ) {\n                $i = 1;\n                $product = wc_get_product( $article['ID'] );\n\n                if ( ! empty( $product ) ) {\n\n                    $m_category = get_term_by( 'id',  'product_cat' );\n\n                    if ( ! empty( $m_category ) ) {\n                        foreach ( $m_category as $id ) {\n                            $articles[ $key ]['Category '] = $m_category;\n                        }\n                    }\n                }\n            }    \n        }\n    }\n    return $articles; // Return the array of records to export\nBut the code returning nothing to csv column.\nUpdate 1\nI changed code. I am getting categories names with url below\n <a href=http://url.net/product-category/harnesses/ rel=tag>Harnesses</a>\n\nCode below\n$m_category = wc_get_product_category_list( $product-> get_id() );\n    if ( ! empty( $m_category ) ) {\n    // use $m_category->parent to check if it's a parent category or sub-category.\n    $articles[ $key ]['Category ' . $i] = $m_category->name; //category name from category object\n                            }\n\n\nA: You should change this block of code\nif ( ! empty( $m_category ) ) {\n   foreach ( $m_category as $id ) {\n       $articles[ $key ]['Category '] = $m_category;\n   }\n}\n\nto be something like this:\nif ( ! empty( $m_category ) ) {\n   // use $m_category->parent to check if it's a parent category or sub-category.\n   $articles[ $key ]['Category '] = $m_category->name; //category name from category object\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405538", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to make WooCommerce payment method field optional? Here is my current code on a plugin.\n    /**\n     * Field Validation.\n     */\n    public function payment_process() {\n        if ( 'woo_bkash' !== $_POST['payment_method'] ) {\n            return;\n        }\n\n        $number   = sanitize_text_field( $_POST['bKash_acc_no'] );\n        $trans_id = sanitize_text_field( $_POST['bKash_trans_id'] );\n\n        if ( '' === $number ) {\n            wc_add_notice( __( 'Please enter your bKash number.', 'bangladeshi-payment-gateways' ), 'error' );\n        }\n\n        if ( '' === $trans_id ) {\n            wc_add_notice( __( 'Please enter your bKash transaction ID.', 'bangladeshi-payment-gateways' ), 'error' );\n        }\n    }\n\nI want to make these fileds optional by adding code on the function.php file of the child theme.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405540", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: First click to blog title does not open the blog article I notice when visiting my blog https://www.datanumen.com/blogs/ via iPhone. Sometimes the first click to the blog title, such as \"11 methods to fix...\", will not open the blog article. I need to click for the 2nd time, to be able to bring out the blog article.\nI have used Lamdatest real devices to make the tests, and below are the results:\n\n*\n\n*In Canada, Australia. The click will always bring out the article body.\n\n*In US. The problem will occur, but not very frequently.\n\n*In Israel, Kuwait. The problem will always occur.\n\nSo, I just wonder whether the issue comes with the blog theme, or the server, or the CDN(I am using Cloudflare CDN), or the mobile phone device, or the mobile service provider?\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405541", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress PageNavi Plugin not working in category.php I tried different codes to be able to use the PageNavi Plugin in category.php, but all were not working. I don't know what was the problem? here is my working category.php code:\n   <?php\n     $cat = get_the_category();  \n     $cat = $cat[0];            \n     $catname = get_cat_name($cat->term_id);    \n     $catid = get_cat_ID($catname);       \n   ?>\n                  \n   <?php\n     $paged = get_query_var('paged', 1);\n     $args = array(       \n       'paged' => $paged,\n       'post_type' => 'post',\n       'cat' => $catid,\n     );\n   $query = new WP_Query($args);  \n        global $query_string;\n        query_posts( $query_string . \"&posts_per_page=1&paged=\".$paged );\n        while ( have_posts() ) : the_post()\n   ?>\n\nI tried and displayed 1 post per page only, so I can see if its working. the 1 post was displayed successfully, however the PageNavi Plugin was not working.\nCan anyone help me with this issue?\n\nA: I had the same problem but you just have to put the native loop in category.php which is this:\n<?php if ( have_posts() ) : while ( have_posts() ) : the_post();  ?>\n\nthen put the function of the plugin:\n<?php endwhile; wp_pagenavi(); endif; ?>\n\nAlso check in reading settings, how many posts you want to show.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405542", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Any quicker alternative for WP_Query \"NOT IN\" I am using the following wp_query to pull up a list of post, and I want to exclude a few categories of a custom taxonomy.\nIt works well, however Query Monitor is telling me that the query is slow.\nI removed the 'tax_query' part of the query and it sped up.\nIs there a faster way to exclude these categories?\nThanks!\nMy Query:\n$args = array(\n    'post_type'         => array( 'recipe' ),\n    'post_status'       => array( 'publish' ),\n    'order'             => 'DESC',\n    'orderby'           => 'date',\n    'posts_per_page'    => 40,\n    'no_found_rows'     => true,\n    'tax_query'         => array(\n        array(\n            'taxonomy' => 'ingredients',\n            'field'    => 'slug',\n            'operator' => 'NOT IN',\n            'terms'    => array( 'onion', 'pepper', 'bean' )\n        )\n    )\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405544", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Use current class method inside add_submenu_page() I have a class like below.\nnamespace Inc\\Admin;\n\nclass Admin\n{\n    public function __construct()\n    {\n        add_action('admin_menu', [$this, 'admin_menu']);\n    }\n\n    public function admin_menu()\n    {\n       add_submenu_page('sports_info', 'Sports Information', 'Sports Information', 'manage_options', [$this,'sports_info_page'], [$this, 'html_page']);\n    }\n\n    public function html_page() {\n       //some code\n    }\n\n    public function sports_info_page() {\n      //some code\n    }\n\n}\n\nI am getting below errors.\nFatal error: Uncaught Error: Object of class Inc\\Admin\\Admin could not be converted to string\n\nError comes from [$this,'sports_info_page'] of add_submenu_page().\n\nA: You're getting that error because the 5th parameter for add_submenu_page() should be a string which is the menu slug and yet you supplied a callback ([$this,'sports_info_page']). So be sure to use a valid slug like so and the error will be gone:\nadd_submenu_page(\n    'sports_info',             // parent slug\n    'Sports Information',      // page title\n    'Sports Information',      // menu title\n    'manage_options',          // capability\n    'your-menu-slug',          // menu slug\n    [$this,'sports_info_page'] // callback\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405545", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can't see past events on admin dashboard Wordpress admin dashboard only shows the current and upcoming events, but there's seemingly no way to access the past events through admin dashboard. The event page on admin dashboard (wp-admin/edit.php?post_type=event) tells me that there are 146 events in total but only show 19 (current/upcoming) and there seems to be no way to change filtering/options to show all events. I feel like I have to be missing something incredibly obvious here.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405546", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Creating a \"Delete\"-Button for Metadata userspecific I want to build a dashboard, where a \"Trash\"-Symbol (Button) is shown.\nThe User has several Accounts to manage in the dashboard.\nAccount 01\nAccount 02\nAccount 03\nand so on..\nIn each of this as gravity forms, where userdata is created and saved in the user meta.\naccount01_login\naccount01_target\naccount02_login\naccount02_target\nare the meta keys for example.\nIs it possible to build a button, where it is possible to do 2 things, if the button is pressed:\n\n*\n\n*Send an e-mail to me - that XXX is deleted.\n\n*Delete the entrie of the metakey account01_login and account01_target (if trash button is hit by account 01).\n\nHope I wrote it understandable. :)\nThanks for advice and help! :)\nBest Regards,\nAndreas\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405550", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Restrict heading level in Gutenberg block `core/heading` I'm building a simple Gutenberg Block that lets the user create just headlines and lists. I've got a solution, but the user can select any heading level she or he wants to.\nHow I can I restrict the core/heading block to e.g. heading level H4?\nThe crucial part in my edit.js is this:\nreturn (\n    <div {...blockProps}>\n        <InnerBlocks\n            onChange = { onChangeContent }\n            allowedBlocks={ ['core/list', 'core/heading'] }\n        />\n    </div>\n)\n\n\nA: Since the allowed blocks are entered as strings there is no way to add parameters to them. You would have to make your own component for each heading type.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405558", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Remove all messages, when untrash a post I'm trying to replace default untrash message to my own with error class. admin_notices do everything as expected, but even if I return empty messages array in bulk_post_updated_messages filter, I'm still see notice, but with empty content with Edit link.\n\nAccording to wp-admin/edit.php, messages generating based on $bulk_counts, but bulk_post_updated_messages filter returns $bulk_messages only and even if I change this array, nothing happened. How to access $bulk_counts?\n$bulk_messages = apply_filters( 'bulk_post_updated_messages', $bulk_messages, $bulk_counts );\n$bulk_counts   = array_filter( $bulk_counts );\n\n...\n\n// If we have a bulk message to issue:\n$messages = array();\nforeach ( $bulk_counts as $message => $count ) {\n    if ( isset( $bulk_messages[ $post_type ][ $message ] ) ) {\n        $messages[] = sprintf( $bulk_messages[ $post_type ][ $message ], number_format_i18n( $count ) );\n    } elseif ( isset( $bulk_messages['post'][ $message ] ) ) {\n        $messages[] = sprintf( $bulk_messages['post'][ $message ], number_format_i18n( $count ) );\n    }\n\n    if ( 'trashed' === $message && isset( $_REQUEST['ids'] ) ) {\n        $ids        = preg_replace( '/[^0-9,]/', '', $_REQUEST['ids'] );\n        $messages[] = '<a href=\"' . esc_url( wp_nonce_url( \"edit.php?post_type=$post_type&doaction=undo&action=untrash&ids=$ids\", 'bulk-posts' ) ) . '\">' . __( 'Undo' ) . '</a>';\n    }\n\n    if ( 'untrashed' === $message && isset( $_REQUEST['ids'] ) ) {\n        $ids = explode( ',', $_REQUEST['ids'] );\n\n        if ( 1 === count( $ids ) && current_user_can( 'edit_post', $ids[0] ) ) {\n            $messages[] = sprintf(\n                '<a href=\"%1$s\">%2$s</a>',\n                esc_url( get_edit_post_link( $ids[0] ) ),\n                esc_html( get_post_type_object( get_post_type( $ids[0] ) )->labels->edit_item )\n            );\n        }\n    }\n}\n\n\nA: As stated before, bulk messages output based on $bulk_counts variable and can't be edited in admin_notices hook. This is strange, because they has their own html wrapping in wp-admin/edit.php without any actions and filters. So I dig deeper in WP core.\n$bulk_counts variable generating in the wp-admin/edit.php in this line:\n$bulk_counts = array(\n    'updated'   => isset( $_REQUEST['updated'] ) ? absint( $_REQUEST['updated'] ) : 0,\n    'locked'    => isset( $_REQUEST['locked'] ) ? absint( $_REQUEST['locked'] ) : 0,\n    'deleted'   => isset( $_REQUEST['deleted'] ) ? absint( $_REQUEST['deleted'] ) : 0,\n    'trashed'   => isset( $_REQUEST['trashed'] ) ? absint( $_REQUEST['trashed'] ) : 0,\n    'untrashed' => isset( $_REQUEST['untrashed'] ) ? absint( $_REQUEST['untrashed'] ) : 0,\n);\n\nAs we can see, untrashed key gets from the query string. If we untrash single record, this action processing in wp-admin/post.php in this code:\ncase 'untrash':\n        check_admin_referer( 'untrash-post_' . $post_id );\n\n        if ( ! $post ) {\n            wp_die( __( 'The item you are trying to restore from the Trash no longer exists.' ) );\n        }\n\n        if ( ! $post_type_object ) {\n            wp_die( __( 'Invalid post type.' ) );\n        }\n\n        if ( ! current_user_can( 'delete_post', $post_id ) ) {\n            wp_die( __( 'Sorry, you are not allowed to restore this item from the Trash.' ) );\n        }\n\n        if ( ! wp_untrash_post( $post_id ) ) {\n            wp_die( __( 'Error in restoring the item from Trash.' ) );\n        }\n\n        $sendback = add_query_arg(\n            array(\n                'untrashed' => 1,\n                'ids'       => $post_id,\n            ),\n            $sendback\n        );\n        wp_redirect( $sendback );\n        exit;\n\nno filters and actions again, but at the end we got wp_redirect() function, which has a filter wp_redirect.\nTo disable messages, we must remove untrashed=1 argument and optional ids=*** with current post id. In my case I'm writing a flag in session and check this flag in wp_redirect\nAfter redirection\n'untrashed' => isset( $_REQUEST['untrashed'] ) ? absint( $_REQUEST['untrashed'] ) : 0;\n\npart returns 0 and according to code in my initial post messages will disappear.\nAt this time this is the only solution which I've found. Any other solutions are welcomes.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405560", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I check if an article is popular this week? I use this function to set and get post view of post in my WordPress\nfunction wpb_set_post_views($postID) {\n    $count_key = 'wpb_post_views_count';\n    $count = get_post_meta($postID, $count_key, true);\n    if($count==''){\n        $count = 0;\n        delete_post_meta($postID, $count_key);\n        add_post_meta($postID, $count_key, '0');\n    }else{\n        $count++;\n        update_post_meta($postID, $count_key, $count);\n    }\n}\nremove_action( 'wp_head', 'adjacent_posts_rel_link_wp_head', 10, 0);\nfunction wpb_get_post_views($postID){\n    $count_key = 'wpb_post_views_count';\n    $count = get_post_meta($postID, $count_key, true);\n    if($count==''){\n        delete_post_meta($postID, $count_key);\n        add_post_meta($postID, $count_key, '0');\n        return \"0 view\";\n    }\n    return $count.' view';\n}\n\nPlease , how can I check if an article is popular within a week or a month in archive list.\nFor example, if the article in list was popular during the same week, a .popular_week class is added to the article.\nlike :\n\n<div class=\"loop\">\n<div class=\"article\">article1</div> \n<div class=\"article\">article2</div>\n<div class=\"article popular_week\">article3</div>\n<div class=\"article\">article4</div>\n</div>\n\n\nI hope the idea is clear\n\nA: Short answer:\nYou can't from that code\n\nLonger answer:\nSo the code above will simply increment a counter based on the last value the counter was on. There's no way to tell when that page-view or count starts from it's simply a number. You have no data on when that page view was counted or even last updated and certainly not how many of those counts occurred in the last week.\nI've written about this before as it's not a simple topic but in a nutshell counting post views efficiently is a nightmare - by recording views and writing data back to that same data source you are removing your read-cache from the database query, every time a page is viewed your database will need to be read from fresh as a write has just written your post-meta value with a counter.\nThe most efficient way I've found of doing this is to use an external service like Google Analytics or Adobe Analytics then query their API periodically for your popularity data. Perhaps every 2 -3 or 6 - 12 hours (depending on your web traffic) and get your popularity data from a data source that already has it there. You're really re-inventing the wheel with page-views - big companies have already spent 000s on making this efficient.\nIf you want to do it yourself - strap-in as you'll be looking at multiple, separate database tables, custom indexing structure, cron-jobs to process lists of timestamps against pages and Ajax calls to your counter so server-side page caching can work effectively.\nI've had to abandon the more popular page view counting plugins on the WP.org plugin repo as they were all dismally inefficient - adding overhead and page-load times that were unacceptable. If you're running a small site it probably won't matter - you should take something off the shelf and use that... but remember to add it to the top of the list to change when / if your site traffic grows.\n\nAlso, a warm welcome to WPSE @jimi-del don't forget to read up on our community guidelines.\nHow do I ask a good question?\nCode of Conduct\nWhat should I do when someone answers my question?\n\nA: You can try this code may be useful for you.\n<?php\nadd_action('wp_head', 'artical_count_post_visits');\nfunction artical_count_post_visits() {\n    if (is_single()){\n        global $post;\n        $views = get_post_meta($post->ID , 'article_views', true);\n        if((date('D') != 'Sun')){ //weekly\n            if ($views == ''){\n                update_post_meta( $post->ID, 'article_views', '1');\n            } else {\n                $views_no = intval($views);\n                update_post_meta( $post->ID, 'article_views', ++$views_no);\n            }\n        }else{\n            update_post_meta($post->ID, 'article_views', '');\n        }\n    }\n    //popular article set into option meta\n    if((date('D') != 'Sun')){\n        $blog_query = new WP_Query( array( 'post_type' => 'post','posts_per_page' => -1 ));\n        if($blog_query->have_posts()){\n            $previous_views = \"\";\n            $max_views      = \"\";\n            $article_max_id = \"\";\n            while ($blog_query->have_posts() ) {\n                $blog_query->the_post(); \n                $current_views= get_post_meta(get_the_ID(), \"article_views\", true);\n                if($current_views > $previous_views){\n                    $previous_views = $current_views;\n                    $max_views      = $current_views;\n                    $article_max_id = get_the_ID();\n                }\n            }\n           if(!empty($article_max_id) && !empty($max_views)){\n            update_option( 'popular_article_save', array($article_max_id => $max_views) );\n           }\n            wp_reset_postdata();\n            wp_reset_query();\n        }\n    \n    }else{\n        update_option( 'popular_article_save', array() );\n    }\n}\n?>\n\n<?php\nget_header(); ?>\n<!-- archive list -->\n<div class=\"loop\">\n    <?php\n    if ( have_posts() ) {\n        $popular   = get_option('popular_article_save');\n        while ( have_posts() ) {\n            the_post(); \n            $views     = get_post_meta(get_the_ID(), \"article_views\", true);\n            $class    = \"\";\n            if(!empty($popular)){\n               foreach($popular as $key_id=>$max_views){\n                    if($key_id == get_the_ID() && $max_views == $views && !empty($max_views)){\n                      $class    = \"popular_week\";\n                    }\n                }\n            }\n            ?>\n            <div class=\"article <?php echo $class; ?>\" ><?php echo get_the_title();?></div>\n            <?php\n        } \n    } \n    ?>\n</div>\n<?php get_footer();?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405562", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Split in 2 columns add to cart button and variable forms I'm struggling to separate variation form from the add to cart button in 2 columns.\nHere is what I need:\n\nThe data inside the squer comes from a third party plugin called \"TM Extra Product Options\"\nI'm using WP Bakery to build the layout as a \"content template\".\nI've created these shortcodes:\n    /* from tm extra options plugi. show final price */\n    \nfunction preco_final() {\n        do_action( 'teste' );\n    }\n    add_shortcode('precofinal', 'preco_final');\n    \n    /*from tm extra optins plugin. show extra fields */\n    \nfunction opcoes_extras() {\n        do_action( 'campos_extras' );\n    }\n    add_shortcode('opcoesextras', 'opcoes_extras');\n    \n    /* here is where i'm trying to load only the add to cart button without the form */\n    \nfunction botao_comprar(){\n        do_action( 'woocommerce_single_variation', 'woocommerce_single_variation_add_to_cart_button', 20 );\n    }\n    add_shortcode('botao-comprar', 'botao_comprar');\n\nIn my experiments I've already manage to split the form from the button but when it happens the extra produt options form fades out!\nI'm on this about a week and I already did everything I know. I hope someone colud help me on that.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405563", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add sub variations in product page Is there any way to add specific variations switches in woocommerce sites.\nSuppose I want to create a phone cover/case website. When user selects a design, it will ask for phone brand. Like iPhone, Redmi or OnePlus. Then there comes another drop-down menu with list of different models of selected brand.\nAlready tried variation swatches and product variation swatches.\nIs there any way or plugins to do like this?\nTIA\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405565", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Pagination at category doesnt work with same name of page i have a problem with my pagination but only at category page.\nI'am not developer, and i try fix it from few days.\nMy pagination working if i make different name of pages for main BLOG, and category of BLOG, but if is the same, doesn't work...  I would like set everywhere \"blog/category/?strona=4\" and \"category/?strona=4\".\nFor example now if i have 3 pages at main page of blog, on category doesn't work page 1 2 and 3, page 4 and more working.\nPagination MAIN BLOG:\nfunction.php\nfunction pagination($paged = '', $max_page = '') {\n  if (!$paged) {\n    $paged = get_query_var('paged');\n  }\n  if (!$max_page) {\n    $max_page = $wp_query->max_num_pages;\n  }\n  \n  global $wp;\n  $base = home_url($wp->request);\n  \n  return paginate_links([\n    'base' => $base . '%_%',\n    'format' => '?strona=%#%',\n    'current' => max(1, $paged),\n    'total' => $max_page,\n    'mid_size' => 2,\n    'prev_text' => '<span class=\"pagination-prev\"><img src=\"/wp-content/themes/naturahome/assets/images/arrow-left.png\" alt=\"\"></span>',\n    'next_text' => '<span class=\"pagination-next\"><img src=\"/wp-content/themes/naturahome/assets/images/arrow-right.png\" alt=\"\"></span>',\n    'type' => 'list',\n  ]);\n} \n\nblog-page.php\n$posts = get_posts([\n  'numberposts' => -1,\n  'post_type' => 'post'\n]);\n$paged = !empty($_GET['strona']) ? absint($_GET['strona']) : 1;\n$args = [\n  'numberposts' => -1,\n  'paged' => $paged\n];\n$query = new WP_Query($args);\n$mp = $query->max_num_pages;\n\n <section>\n  <div>\n    <div>\n      <div class=\"row\">\n        <?php while ($query->have_posts()) : $query->the_post(); ?>\n          <div class=\"col-sm-12\">\n              <?= get_template_part('partials/blog-item', null, ['one' => $post]) ?>\n          </div>\n        <?php endwhile; ?>\n      </div>\n      <?php if ($query->have_posts()) : ?>\n        <div>\n           <?= pagination($paged, $mp); ?>\n        </div>\n      <?php endif; ?>\n    </div>\n  </div>\n</section> \n\nAnd here i have a code of category.php which working if name of pages is different than this which is in the main blog.\nglobal $wp;\n    $current_url = home_url(add_query_arg(array(), $wp->request));\n\n    $category = get_queried_object();\n    $id = $category->term_id;\n    $allPosts = get_posts([\n        'numberposts' => -1,\n        'category' => $id,\n        'post_type' => 'post'\n    ]);\n\n\n    $itemsCount = count($allPosts);\n\n    $perPage = 1;\n\n\n    $postsGroupsIds = [];\n    $key = 1;\n    if (!empty($allPosts)) {\n        $i = 0;\n        foreach ($allPosts as $p) {\n            if (!isset($postsGroupsIds[$key])) {\n                $postsGroupsIds[$key] = [];\n            }\n\n            $postsGroupsIds[$key][] = $p->ID;\n\n            $i++;\n            if ($i == $perPage) {\n                $key++;\n                $i = 0;\n            }\n        }\n    }\n\n\n    $pagesCount = count($postsGroupsIds);\n\n    $pagenumber = 1;\n    if (!empty($_GET['strona'])) {\n        $pagenumber = $_GET['strona'];\n    }\n\n    $posts = get_posts([\n        'numberposts' => $perPage,\n        'post_type' => 'post',\n        'include' => $postsGroupsIds[$pagenumber]\n    ]);\n\n\n\n\n<section class=\"blog-list\">\n    <div class=\"container\">\n        <?php foreach ($posts as $post) : ?>\n        <div class=\"row\">\n            <div class=\"col-lg-4\">\n                <?php \n                $img = get_field('grafika');\n                ?>\n                <a href=\"<?= get_permalink() ?>\" class=\"wow fadeInUp\">\n                    <div class=\"blog-list-img\">\n                        <?php\n                    if($img) { ?>\n                        <img src=\"<?= $img['sizes']['large'] ?>\" alt=\"<?= $img['alt'] ?>\" title=\"<?= $img['title'] ?>\">\n                        <?php\n                    } else { ?>\n                        <img src=\"<?= get_stylesheet_directory_uri(); ?>/img/default_listing.png\" alt=\"Za\u015blepka\">\n                        <?php } ?>\n                    </div>\n                </a>\n            </div>\n            <div class=\"col-lg-8\">\n                <a href=\"<?= get_permalink() ?>\">\n                    <h4 class=\"blog-list-title\"><?= get_the_title() ?></h4>\n                </a>\n                <p class=\"blog-list-description\"><?= get_field('zajawka') ?></p>\n                  <div class=\"date d-flex\">\n                    <img src=\"<?= get_stylesheet_directory_uri(); ?>/img/calendar.svg\" alt=\"Data wydarzenia w House Natura\">\n                    <span><?= get_the_date('j F Y') ?></span>\n                  </div>\n            </div>\n        </div>\n        <?php endforeach; ?>\n    </div>\n</section>\n                \n                \n<section class=\"section-full suggestions\">\n    <div class=\"content-wrapper container\">\n        <div class=\"row\">\n            <div class=\"col-md-12\">\n\n\n                <?php if (!empty($posts)) : ?>\n                    <div class=\"pagination_outer d-new-a\">\n                        <?php if ($pagesCount > 1) : ?>\n                            <div class=\"pagination_list d-new-a w100p\">\n                <div class=\"pagina_left wow fadeInUp\">\n                    <ul class=\"page-numbers\">\n                    <?php if ($pagenumber >= 2) : ?>\n                        <li class=\"pagina_left wow fadeInUp\">\n                        <a href=\"<?= $current_url ?>?strona=<?= $pagenumber - 1 ?>\" class=\"d-flex popular-category-btn custom-btn\">\n                            <span class=\"pagination-prev\">\n                            <img src=\"/wp-content/themes/naturahome/assets/images/arrow-left.png\" alt=\"Poprzednia strona\">\n                            </span>\n                        </a>\n                        </li>\n                    <?php endif; ?>\n\n                                        <?php if ($pagesCount <= 8) : ?>\n                                            <?php for ($i = 1; $i <= $pagesCount; $i++) : ?>\n                                                <?php if ($pagenumber == $i) : ?>\n                                                    <li><span aria-current=\"page\" class=\"page-numbers current\"><?= $i ?></span></li>\n                                                <?php else : ?>\n                                                    <li class=\"\"><a href='<?= $current_url ?>?strona=<?= $i ?>' class=\"page popular-category-btn custom-btn <?= ($pagenumber == $i) ? 'current' : '' ?>\" data-page=\"<?= $i ?>\"><?= $i ?></a></li>\n                                                <?php endif; ?>\n                                            <?php endfor; ?>\n                                        <?php else : ?>\n                                            <?php if ($pagenumber <= 1) : ?>\n                                                <li><span aria-current=\"page\" class=\"page-numbers current\"><?= $pagenumber ?></span></li>\n                                                <?php for ($i = 2; $i <= 3; $i++) : ?>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $i ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $i ?>\"><?= $i ?></a></li>\n                                                <?php endfor; ?>\n                                                <li><span class=\"page-numbers dots\">\u2026</span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagesCount ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagesCount ?>\"><?= $pagesCount ?></a></li>\n\n                                            <?php elseif ($pagenumber > 1 && $pagenumber <= 2) : ?>\n                                                <li><a href='<?= $current_url ?>?strona=1' class=\"page popular-category-btn custom-btn\" data-page=\"1\">1</a></li>\n                                                <li><span aria-current=\"page\" class=\"page-numbers current\"><?= $pagenumber ?></span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber + 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber + 1 ?>\"><?= $pagenumber + 1 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber + 2 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber + 2 ?>\"><?= $pagenumber + 2 ?></a></li>\n                                                <li><span class=\"page-numbers dots\">\u2026</span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagesCount ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagesCount ?>\"><?= $pagesCount ?></a></li>\n\n                                            <?php elseif ($pagenumber > 2 && $pagenumber <= 3) : ?>\n                                                <li><a href='<?= $current_url ?>?strona=1' class=\"page popular-category-btn custom-btn\" data-page=\"1\">1</a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber - 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber - 1 ?>\"><?= $pagenumber - 1 ?></a></li>\n                                                <li><span aria-current=\"page\" class=\"page-numbers current\"><?= $pagenumber ?></span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber + 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber + 1 ?>\"><?= $pagenumber + 1 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber + 2 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber + 2 ?>\"><?= $pagenumber + 2 ?></a></li>\n                                                <li><span class=\"page-numbers dots\">\u2026</span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagesCount ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagesCount ?>\"><?= $pagesCount ?></a></li>\n\n                                            <?php elseif ($pagenumber > 3 && $pagenumber <= 4) : ?>\n                                                <li><a href='<?= $current_url ?>?strona=1' class=\"page popular-category-btn custom-btn\" data-page=\"1\">1</a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber - 2 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber - 2 ?>\"><?= $pagenumber - 2 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber - 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber - 1 ?>\"><?= $pagenumber - 1 ?></a></li>\n                                                <li><span aria-current=\"page\" class=\"page-numbers current\"><?= $pagenumber ?></span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber + 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber + 1 ?>\"><?= $pagenumber + 1 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber + 2 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber + 2 ?>\"><?= $pagenumber + 2 ?></a></li>\n                                                <li><span class=\"page-numbers dots\">\u2026</span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagesCount ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagesCount ?>\"><?= $pagesCount ?></a></li>\n\n                                            <?php elseif ($pagenumber > ($pagesCount - 1)) : ?>\n                                                <li><a href='<?= $current_url ?>?strona=1' class=\"page popular-category-btn custom-btn\" data-page=\"1\">1</a></li>\n                                                <li><span class=\"page-numbers dots\">\u2026</span></li>\n                                                <?php for ($i = ($pagesCount - 2); $i < $pagesCount; $i++) : ?>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $i ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $i ?>\"><?= $i ?></a></li>\n                                                <?php endfor; ?>\n                                                <li><span aria-current=\"page\" class=\"page-numbers current\"><?= $pagesCount ?></span></li>\n\n                                            <?php elseif ($pagenumber > ($pagesCount - 2)) : ?>\n                                                <li><a href='<?= $current_url ?>?strona=1' class=\"page popular-category-btn custom-btn\" data-page=\"1\">1</a></li>\n                                                <li><span class=\"page-numbers dots\">\u2026</span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber - 2 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber - 2 ?>\"><?= $pagenumber - 2 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber - 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber - 1 ?>\"><?= $pagenumber - 1 ?></a></li>\n                                                <li><span aria-current=\"page\" class=\"page-numbers current\"><?= $pagenumber ?></span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagesCount ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagesCount ?>\"><?= $pagesCount ?></a></li>\n\n                                            <?php elseif ($pagenumber > ($pagesCount - 3)) : ?>\n                                                <li><a href='<?= $current_url ?>?strona=1' class=\"page popular-category-btn custom-btn\" data-page=\"1\">1</a></li>\n                                                <li><span class=\"page-numbers dots\">\u2026</span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber - 2 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber - 2 ?>\"><?= $pagenumber - 2 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber - 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber - 1 ?>\"><?= $pagenumber - 1 ?></a></li>\n                                                <li><span aria-current=\"page\" class=\"page-numbers current\"><?= $pagenumber ?></span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber + 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber + 1 ?>\"><?= $pagenumber + 1 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagesCount ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagesCount ?>\"><?= $pagesCount ?></a></li>\n\n                                            <?php elseif ($pagenumber > ($pagesCount - 4)) : ?>\n                                                <li><a href='<?= $current_url ?>?strona=1' class=\"page popular-category-btn custom-btn\" data-page=\"1\">1</a></li>\n                                                <li><span class=\"page-numbers dots\">\u2026</span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber - 2 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber - 2 ?>\"><?= $pagenumber - 2 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber - 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber - 1 ?>\"><?= $pagenumber - 1 ?></a></li>\n                                                <li><span aria-current=\"page\" class=\"page-numbers current\"><?= $pagenumber ?></span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber + 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber + 1 ?>\"><?= $pagenumber + 1 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber + 2 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber + 2 ?>\"><?= $pagenumber + 2 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagesCount ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagesCount ?>\"><?= $pagesCount ?></a></li>\n\n                                            <?php else : ?>\n                                                <li><a href='<?= $current_url ?>?strona=1' class=\"page popular-category-btn custom-btn\" data-page=\"1\">1</a></li>\n                                                <li><span class=\"page-numbers dots\">\u2026</span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber - 2 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber - 2 ?>\"><?= $pagenumber - 2 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber - 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber - 1 ?>\"><?= $pagenumber - 1 ?></a></li>\n                                                <li><span aria-current=\"page\" class=\"page-numbers current\"><?= $pagenumber ?></span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber + 1 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber + 1 ?>\"><?= $pagenumber + 1 ?></a></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagenumber + 2 ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagenumber + 2 ?>\"><?= $pagenumber + 2 ?></a></li>\n                                                <li><span class=\"page-numbers dots\">\u2026</span></li>\n                                                <li><a href='<?= $current_url ?>?strona=<?= $pagesCount ?>' class=\"page popular-category-btn custom-btn\" data-page=\"<?= $pagesCount ?>\"><?= $pagesCount ?></a></li>\n                                            <?php endif; ?>\n                                        <?php endif; ?>\n                                    <?php if ($pagenumber < $pagesCount) : ?>\n                                        <li class=\"pagina_right wow fadeInUp\">\n                                            <a href=\"<?= $current_url ?>?strona=<?= $pagenumber + 1 ?>\" class=\"d-flex popular-category-btn custom-btn\">\n                                            <span class=\"pagination-next\">\n                                                <img src=\"/wp-content/themes/naturahome/assets/images/arrow-right.png\" alt=\"Nast\u0119pna strona\">\n                                            </span>\n                                            </a>\n                                        </li>\n                                    </ul>\n                                </div>\n\n                                <?php endif; ?>\n                            </div>\n                        <?php endif; ?>\n                    </div>\n                <?php endif; ?>\n            </div>\n        </div>\n    </div>\n</section>\n\n\n\nOne more information. My pagination looks like that:\n/%category%/%postname%\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405568", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Place image caption outside of figure tag (Gutenburg Image Markup) I format my single.php images to a perceived 3:2 ratio like this:\n<figure style=\"position:relative; width:100%; padding-bottom:66%;\">\n<img style=\"position:absolute; width:100%; height:100%; object-fit:cover;\">\n<figcaption>some text</figcaption>\n</figure>\n\nWith Gutenberg, this sticks my caption behind my image or on top of my image (if I position figcaption relative or absolute). I'd like it to be below my image.\nBefore gutenberg, I could customize my image markup. No longer can.\nNow I am trying to figure out how to make my image caption the next sibling of the figure tag and not a child of it.\nSomething like\n<figure>\n<img>\n</figure>\n<figcaption>some text</figcaption>\n\nI know this breaks the figcaption rules. Right now I am worried about styling.\nAny recommendations are appreciated. Thanks!\n\nA: I control the aspect ratio/crop of my images with padding, like this. Though, new WP blocks styles clash with this method. Resulting in captions behind or on top of the image. By looping through each image block  <figure class=\"wp-block-image\"> I was able to insert some markup of my choice, using this method\nAlmost like the old image_send_to_editor filter.\nThis moved my styles off the <img> and <figure> tags to my new classes/elements. Which allowed wordpress and my custom theme styles to get along.\nmyFunc(){\nconst block = Array.from(document.getElementsByClassName(\"wp-block-image\"));\n\nblock.forEach((i) => {\n  const org_html = i.innerHTML;\n  const new_html =\n    \"<div class='fig-container'>\" +\n    \"<div class='fig-wrapper'>\" +\n    org_html +\n    \"</div>\" +\n    \"</div>\";\n  i.innerHTML = new_html;\n});\n}\nmyFunc();\n\nPen\nIt has tested well with galleries and columns with images. It also works with straight image blocks, though, having some new margin issues with those scenarios.\nedited for clarity\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405569", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: DISALLOW_FILE_EDIT is false but I still am not able to edit files from the admin interface and the menus do not show up I have checked the constant DISALLOW_FILE_EDIT and it's set to false.\nI am using Trellis to setup my sites, and it is working correctly on my actually staging server VPS. But on the local virtual machine it's not working.\nLooking for help in how I can debug this, what source file or WP to check ... I assume this has something with the NFS shared folders mechanic the files are shared across the host OS and guest VM.\nHost OS is Ubuntu 22.04 and guest is Ubuntu 20.04. I went into the VM and ran sudo chmod 777 -Rv /srv/ but trellis already takes care of permissions, so I was not really expecting this to work, and it did not. I have tested that PHP can create files with this code:\nfunction logfile( string $name, $var, string $file ) {\n    $msg = $name . var_export( $var, true ) . PHP_EOL; //phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_var_export\n    error_log( $msg . PHP_EOL, 3, \"$file.log\" ); //phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_error_log\n}\n\nlogfile( 'nn', 'vr', __FILE__ ); \n\nIt can create and write to a log file inside my mu-plugins folder and probably everywhere else in the WP installation. But it seems WP makes some checks on being able to write files that fail.\nI found some code in the Gutenberg patch I like to try out.\n    /**\n     * Checks whether the user has permission to edit themes. In classic themes\n     * this controls access to Appearance > Theme Editor to edit theme files.\n     * In block themes editing theme files via the visual editor is similar.\n     *\n     * @return WP_Error|bool True if the request has access, or WP_Error object.\n     */\n    public function permissions_check() {\n        if ( current_user_can( 'edit_themes' ) ) {\n            return true;\n        }\n\n        return new WP_Error(\n            'rest_cannot_edit_theme',\n            __( 'Sorry, you are not allowed to edit theme templates and template parts.', 'gutenberg' ),\n            array( 'status' => rest_authorization_required_code() )\n        );\n    }\n\nThis message is triggered for me so it seems my user does not have the permission ot edit themes. But I do not get why, its the default admin user that is created by Trellis.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405571", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to pass multiple parameter in add_action() I have below code.\nadd_action( 'admin_init', [$this, 'settings_page_registration'] );\n\nI would like to use enqueue_assets function name inside add_action().\nShould I use like below ?\nadd_action( 'admin_init', [$this, 'settings_page_registration', 'enqueue_assets'] );\n\n\nA: If you need to call enqueue_assets at admin_init, then add a new add_action():\nadd_action( 'admin_init', [$this, 'settings_page_registration'] );\nadd_action( 'admin_init', [$this, 'enqueue_assets'] );\n\n\n*\n\n*https://developer.wordpress.org/reference/functions/add_action/\nThat said, if your assets are JS scripts or CSS, you should consider wp_enqueue_script() & wp_enqueue_scripts\n\n*\n\n*https://developer.wordpress.org/reference/functions/wp_enqueue_script\n\n*https://developer.wordpress.org/reference/hooks/wp_enqueue_scripts/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405572", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding hreflang tags automatically in WordPress subdirectory multisite We have a WordPress MU subdirectory network setup:\n\n*\n\n*www.example.com - main website, USA, global\n\n*www.example.com/uk/ - to display for UK visitors\n\n*www.example.com/au/ - to display for Australian visitors.\n\nWe want to add hreflang tags for each webpage and exclude the locations custom post type.\nFrom this question, I've adjusted the code in the child theme's\nfunctions.php to:\nfunction add_hreflang_attribute() {\n   $site_url = network_site_url(); // base URL\n   $alt_langs = array( 'au', 'uk' ); // two-letter language code\n   $page_path = substr(get_permalink(), strlen(home_url('/'))); // path of page after base URL\n   \n   if (!( is_singular( 'locations' ) ) ) {\n           \n       // loop through the alternative languages, and get the appropriate hreflang tag for each that exists\n       foreach ($alt_langs as $lang) {\n           $updated_url_lang_path = $site_url . $lang . '/' . $page_path;\n           $url_headers = @get_headers($updated_url_lang_path);\n           if($url_headers && strpos( $url_headers[0], '200')) {\n               if ($lang == 'uk') {\n                   echo '<link rel=\"alternate\" href=\"' . $updated_url_lang_path . '\" hreflang=\"en-gb\" />'. PHP_EOL;\n               } elseif ($lang == '') {\n                 \n               }\n               else {\n                   echo '<link rel=\"alternate\" href=\"' . $updated_url_lang_path . '\" hreflang=\"en-' . $lang . '\" />'. PHP_EOL;\n               }\n           }\n       }\n       \n       // set primary as x-default\n       echo '<link rel=\"alternate\" href=\"' . $site_url . $page_path . '\" hreflang=\"x-default\" />';\n        \n   }\n\n}\n\nThis code works on the main website's home page & example page: www.example.com/features/;\n<link rel=\"alternate\" href=\"https://www.example.com/au/features/\" hreflang=\"en-au\" />\n<link rel=\"alternate\" href=\"https://www.example.com/uk/features/\" hreflang=\"en-gb\" />\n<link rel=\"alternate\" href=\"https://www.example.com/features/\" hreflang=\"x-default\" />\n\nand it works for the:\n\n*\n\n*AU site's home page,\n\n*the AU site's features page: https://www.example.com/au/features/,\n\nbut on www.example.com/uk/ it only produces:\n<link rel=\"alternate\" href=\"https://www.example.com/au/\" hreflang=\"en-au\" />\n<link rel=\"alternate\" href=\"https://www.example.com/\" hreflang=\"x-default\" />\n\nIt is missing:\n<link rel=\"alternate\" href=\"https://www.example.com/uk/\" hreflang=\"en-gb\" />\n\nThe features page is a simple WordPress page.\nHelp appreciated.\n\nA: Alternatively we can set the hreflang as a site meta for each site:\nupdate_site_meta( 1, 'hreflang', 'x-default' );\nupdate_site_meta( 3, 'hreflang', 'en-au' );\nupdate_site_meta( 5, 'hreflang', 'en-gb' );\n\nand then for the hreflang attribute use;\nget_site_meta( $site->blog_id, 'hreflang' )\n\nand for the href attribute:\nget_home_url( $site->blog_id, $page_path )\n\nIf we want to skip the site meta and use:\n$hreflangs = array(\n    1 => 'x-default',\n    3 => 'en-au',\n    5 => 'en-gb',\n);  \n\nthen the sites loop becomes:\n$page_path = substr( get_permalink(), strlen( home_url('/') )); \n\n$sites = get_sites();\nforeach ( $sites as $site ) {\n    if ( isset( $hreflangs[ $site->blog_id ] ) ) {\n        printf ( \n            '<link rel=\"alternate\" href=\"%s\" hreflang=\"%s\" />'. PHP_EOL,\n            esc_url( get_home_url( $site->blog_id, $page_path ) ),\n            esc_attr( $hreflangs[ $site->blog_id ] )\n        );\n    }\n}\n\nOne might further check if the page-path/slug exists on each site with e.g. get_page_by_path() or get_posts() via switch_to_blog().\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405573", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to implement __() function in my theme's php file? I am translating a site with Polylang that was created by someone else using a custom theme. Some strings couldn't be found by Polylang, so I need to manually register them for Polylang to see.\nNow, some of the strings were pretty easy to translate using __():\n    $args = shortcode_atts([\n    'link'      => 'service',\n    'text'      => __('Get the code now!'),\n    'title'     => __('Code'),\n    'id'        => '',\n    'class'     => 'width300',\n], $args, '' );\n\nBut I don't know how to translate strings in these scenarios:\n        $popup = do_shortcode('[popup id=\"110\" link=\"vacancy\" class=\"\" title=\"Code\" text=\"Get the code now!!\" ]');\n\nor here words Details, Close\n        $script = ' \n        <script>\n            $(document).ready(function(){\n                btn = $(\\'.add_vakan_info\\'),\n                popup = $(\\'.add_popup\\');\n\n                btn.click(function(){\n                    var block_info  = $(this).closest(\\'.vacancy\\').find(\\'.content\\');\n                    if(block_info.hasClass(\\'active\\')){\n                        block_info.removeClass(\\'active\\');\n                        $(this).html(\\'Details <i class=\"las la-angle-down\"></i>\\');\n                    }else{\n                        block_info.addClass(\\'active\\');\n                        $(this).html(\\'Close <i class=\"las la-angle-up\"></i>\\');\n                    }\n                })\n                popup.click(function(){\n                    var text = $(this).closest(\\'.vacancy\\').find(\\'.title\\').text(),\n                        form = $(\\'.vacancy_name\\');\n                    form.val(text);\n                })\n                FileInput();\n            })\n        </script>';\n\nor\n    else:\n    $html = '<h4>No vacancy </h4>';\n\nor\n                <div class=\"content col\">\n                <div class=\"sp-20\"></div>\n                <h4>Description</h4>\n                '.$description.'\n\n                <div class=\"sp-20\"></div>\n                <h4>Requirements</h4>\n                '.$requirements.'\n\n                <div class=\"sp-20\"></div>\n                <h4>Conditions</h4>\n                '.$conditions.'\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405575", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Take a custom taxonomy value and save as a standard Product Tag I'm trying to find a way to take a custom taxonomy value, and add it as a tag to that same product.\nLong story short: a third party CRM only respects woo native categories & tags, so we'd like to take three custom taxonomy values and save them as tags. For instance, if a product is a Ganni dress in UK size 10 and has a 'style profile' of Romantic, then the three custom tax values retrieved will be 'ganni', 'uk-10', and 'romantic'.  These should then be saved as standard tags.\nHere's a stab at the 'product_brand' custom tax, which doesn't work. Can anyone please point me to where it's going wrong?\n(This needs to happen any time a product is created or saved)\nadd_action( 'save_post', 'action_save_product_data', 20);\nfunction action_save_product_data( $post_id ) {\n    global $typenow;\n    if ( 'product' === $typenow ) {\n\n        $terms = wp_get_post_terms( $post_id, 'product_brand', array( 'fields' => 'all' ) );\n                if ( $terms ) {\n                    $prod_brand = $terms[0]->slug;\n                }\n\n        wp_set_object_terms( $post_id, $prod_brand, 'post_tag', true );\n    }\n}\n\n\nA: Got it worked out, working code as follows:\nfunction action_save_product_data( $post_id ) {\n  if ( 'product' !== $post->post_type ) {\n    $terms = wp_get_post_terms( $post_id, 'product_brand', array( 'fields' => 'all' ) );\n    if ( $terms ) {\n      $prod_brand = $terms[0]->slug;\n      wp_set_object_terms( $post_id, $prod_brand, 'product_tag', true );\n    }\n  }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405577", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Output product category link from WP_Query I have a WP_Query that outputs products from given Product category name. For each product list I would also like to link to the category of that product, but I'm not sure how.\nMy query:\n<?php\n$new_posts = new WP_Query([\n  'product_cat' => 'printer',\n  'post_type' => 'product',\n  'orderby' => 'meta_value_num',\n  'order' => 'DESC',\n  'meta_key' => 'view_count',\n  'posts_per_page' => 9,\n]);\n?>\n\nOutput link something like this:\n  <a href=\"<?php echo $cat_id ?>\" class=\"procat-link\">More Products...</a>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405579", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to exclude labels from certain categories in a shortcode? Good afternoon. There is a shortcode [alltags] that displays ALL site tags on a separate page of the site in alphabetical order with a letter.\nfunction wph_alltags_shortcode( $atts, $content ) {\n    $posttags = get_tags();\n    $output = '';\n    if ( $posttags ) {\n        $output = '<dl class=\"alltags\">';\n        foreach ( $posttags as $tag ) {\n            $l = mb_strtoupper( mb_substr( $tag->name, 0, 1, 'UTF-8'), 'UTF-8' );\n            if ( $L != $l ) {\n                if ( $L )\n                    $output .= '</dd>';\n                $L = $l;\n                $output .= '<dt>' . $L . '</dt><dd>';\n            }\n            $output .= '<a href=\"/tag/' . $tag->slug . '\">' . $tag->name . '</a> '; \n        }\n        $output .= '</dl>';\n    }\n    return $output;\n}\nadd_shortcode( 'alltags', 'wph_alltags_shortcode' );\n\nI need to exclude the display of tags from certain categories of the site, at least from one. I am completely new to PHP. (Please help me with solving this problem. Thank you very much in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405584", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using pre_get_posts on a specific core/query block I\u2019m trying to apply the pre_get_posts to a specific core/query block, in order to programatically modify the number of posts displayed when a custom attribute is set. If I use the render_block hook, the block is already pre-rendered and so modifying the query using pre_get_posts has no effect. Is there any way to achieve this?\n(I don't need help adding the custom attribute; I've done so already using block filters.)\n\nA: Update:\nIt's possible to use the render_block_data filter to modify the query block's data before it's rendered.\nSince 6.1. the query_loop_block_query_vars filter is available if one needs to modify the underlying WP_Query arguments (e.g. those that are still unsupported by the query block's interface) but it only works for the front-end but not the editor preview that uses the REST API (see more on that in the docs here).\nOriginal answer:\nThere's an open ticket for such a query args filter #54850.\nIn the meanwhile you can try this approach, replacing the render callback of the core/post-template block with a wrapper callback:\nadd_filter( 'block_type_metadata_settings', function( $settings ) {\n    if ( $settings['parent'][0] !== 'core/query' ) {\n        return $settings;\n    }\n    if ( $settings['render_callback'] !== 'render_block_core_post_template' ) {\n        return $settings;\n    }\n    $settings['render_callback']= 'wpse_render_block_core_post_template';\n    return $settings;\n}); \n\nwith the wrapper callback as:\nfunction wpse_render_block_core_post_template($attributes, $content, $block ){\n    $output = render_block_core_post_template( $attributes, $content, $block );\n    return $output;\n}\n\nNow we have a better way to target the WP_Query instance within that core template.\nFollowing are two such examples.\nExample with pre_get_posts\nHere's an example how to override the number of posts with the help of the pre_get_posts hook:\nfunction wpse_render_block_core_post_template( $attributes, $content, $block ) {\n    $cb = fn( $q ) => $q->set( 'posts_per_page', 2 );\n    \n    add_action( 'pre_get_posts', $cb, 999 );\n    $output = render_block_core_post_template( $attributes, $content, $block );\n    remove_action( 'pre_get_posts', $cb, 999 );\n\n    return $output;\n}\n\nExample with block context\nWe could also change existing query arguments within build_query_vars_from_query_block(), like perPage, with:\nfunction wpse_render_block_core_post_template( $attributes, $content, $block ) {\n    $block->context['query']['perPage'] = 2;\n    return render_block_core_post_template($attributes, $content, $block );\n}\n\nThen you can add further restrictions as needed to both approaches, from e.g. other block info, like queryId.\n\nA: A modified version of the suggestion from @birgire works. Note that this applies to the core/post-template block, not the core/query block.\nadd_filter('block_type_metadata_settings', function ($settings, $metadata) {\n    if ($metadata['name'] !== 'core/post-template') {\n        return $settings;\n    }\n    if ($settings['render_callback'] !== 'render_block_core_post_template') {\n        return $settings;\n    }\n    $settings['render_callback'] = 'wpse_render_block_core_post_template';\n    return $settings;\n}, 10, 2);\n\nfunction wpse_render_block_core_post_template($attributes, $content, $block)\n{\n    $callback = fn ($query) => $query->set('posts_per_page', 2);\n\n    add_action('pre_get_posts', $callback, 999);\n    $output = render_block_core_post_template($attributes, $content, $block);\n    remove_action('pre_get_posts', $callback, 999);\n\n    return $output;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405588", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: Admin Panel Development How to create Tab on Admin Panel like \"General Settings\" screenshot ?\nHow to create List on Admin Panel like \"Pages\" screenshot ?\n\n\n\nA: *\n\n*This would be a good place to start. add_menu_page.\n\n\n*The posts list are automatically created when you register a new CPT. You can, however, create anything in a custom menu page (read the docs from point 1).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405591", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Post in bulk based on category template Let's start with an example of what I want to do.\ntake a look at hardreset.info / devicesfaq.com\nas you can see, the articles are almost the same, they only change few keywords / or based on title (device name)\nlet's say I have the same categories and a custom article for each one (hard reset, check imei, delete google account, etc).\nOk, now I want to post in bulk in all the categories I choose (check imei, hard reset, delete google account) at the same time without posting manually on each one.\nIf I am posting about Samsung A53, there will be posted articles like Hard Reset Samsung A53, Check Imei Samsung A53, and so on.\nHowever, I am also looking for a way to \"get\" those articles from. I am thinking to have multiple single.php template pages for each category (hardreset.php, checkimei.php) and then include some code in single.php to show article if in category.\nCan be done?\nThanks a lot.\nlater: still looking for some answers\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405599", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to access wordpress menu & submenu item through the REST API? I want to display the menu & submenu items from Wordpress in another web-application, menu and Submenu are get but there is more menu inside Submenu I want that.\nfunction return_menus( $data ) {\n$menuID = $data['id']; \n//$primaryNav = wp_get_nav_menu_items($menuID);\n$x = wp_get_nav_menu_items($menuID);\n// echo '<pre>';\n//   print_r($x);\n// echo '</pre>';\n    $menu = array();\n    $submenu = array();\n    foreach($x as $y){\n        $y-> submenu = array();\n        if($y->menu_item_parent === '0')\n            array_push($menu, $y);\n        else \n            array_push($submenu, $y);\n    }\n    for($i=0; $i < count($submenu); $i++) {\n        $index = get_index($menu,$submenu[$i]->menu_item_parent);\n        if($index > -1) {\n            array_push($menu[$index]->submenu,$submenu[$i]);\n        }\n    }\nreturn $menu;\n}\nfunction get_index($menu,$parent_id){\n    $index = -1;\nfor($i = 0; $i < count($menu); $i++) {\n        if((string)$menu[$i]->ID === $parent_id) {\n            $index = $i;\n            break;\n        }\n    }\n    return $index;\n}\nadd_action( 'rest_api_init', function () {\n    register_rest_route( 'rix', '/menu/(?P<id>\\d+)', array(\n        'methods' => 'GET',\n        'callback' => 'return_menus',\n    ) );\n} );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405602", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I automatically hyperlink tag names that are in my post body to the tag page I have a number of sports sites with hundreds of thousands of existing news posts. The site also has a custom post type for team and a custom post type for person. I wish to be able to somehow automatically find team names and player names in news post body and hyperlink them to the correct team / player post.\nThe post names exist with exact player and team names. For example\nLionel Messi  << Player post\nManchester United << Team post\nLionel Messi snubs Manchester United and joins Wolverhampton Wanderers << news post\nWhat approach should I take here?\nBonus karma for this additional consideration. In Drupal the post text filtering actions can be cached against the text filter so that the calculations on the body wouldn't have to be done on every page load.  Are there similar considerations in Wordpress to make this relatively efficient?.\n\nA: If I am guessing it right, it would be a 2 step process.\n\n*\n\n*Store the post title and post id in an assosiative array while publishing the posts (save_post_POST_TYPE hook). For ex: array('Post Title' => 101) where 101 being the id of the post. I'd use WordPress Options table to store them and quickly retrieve when needed.\n\n\n*Now, you can hyperlink (str_replace) them on the fly using the_content filter or even better save them as hyperlinked when saving the posts.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405603", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: isSavingPost() for widgets I want to get the block ID of my widgets (e.g. #block-1, which is displayed on the frontend after saving a widget) on the widgets screen in the backend. What I try to achieve is to display the ID of the widget in the toolbar so that you can easily copy it.\n\nI currently use a custom API endpoint to receive the ID but it will trigger a request on every render (I already debounced it, but am searching for a better way).\nMy idea was than to subscribe to the save action of the widgets, since the ID is first available after saving the widgets screen:\nconst widgetIdToolbar = createHigherOrderComponent( ( BlockEdit ) => {\n    if ( select( 'core/editor' ).getCurrentPostType() ) {\n        return BlockEdit;\n    }\n    \n    return ( props ) => {\n        if ( props.name === 'core/widget-area' || props.name === 'core/legacy-widget' ) {\n            return ( <BlockEdit { ...props } /> );\n        }\n        \n        const [ widgetId, setWidgetId ] = useState( 0 );\n\n        subscribe( () => {\n            const isAutosavingPost = select( 'core/editor' ).isAutosavingPost();\n            const isSavingPost = select( 'core/editor' ).isSavingPost();\n                \n            if ( isSavingPost || isAutosavingPost ) {\n                // do stuff\n            }\n        } );\n        \n        return (\n            <>\n                <BlockEdit { ...props } />\n            </>\n        );\n    }\n}, 'widgetIdToolbar' );\n\naddFilter( 'editor.BlockEdit', 'rh-widget-toolbar/add-toolbar', widgetIdToolbar );\n\nUnfortunately, both isAutosavingPost and isSavingPost always return false. It seems they don\u2019t apply to widgets. How to get the similar functionality for \u201con widgets save\u201d?\n\nA: If the goal is to display the block ID so that the user can get it easily, instead try using a block editor filter to add a panel in the sidebar:\nFrom: https://developer.wordpress.org/block-editor/reference-guides/filters/block-filters/#editor-blockedit\nconst { createHigherOrderComponent } = wp.compose;\nconst { Fragment } = wp.element;\nconst { InspectorControls } = wp.blockEditor;\nconst { PanelBody } = wp.components;\n \nconst withInspectorControls = createHigherOrderComponent( ( BlockEdit ) => {\n    return ( props ) => {\n        return (\n            <Fragment>\n                <BlockEdit { ...props } />\n                <InspectorControls>\n                    <PanelBody>My custom control</PanelBody>\n                </InspectorControls>\n            </Fragment>\n        );\n    };\n}, 'withInspectorControl' );\n \nwp.hooks.addFilter(\n    'editor.BlockEdit',\n    'my-plugin/with-inspector-controls',\n    withInspectorControls\n);\n\nThen inside the panel, use props to retrieve the blocks ID and display it, perhaps in an input with the disabled property. Specifically clientId.\nIt might look like this (untested):\nconst { createHigherOrderComponent } = wp.compose;\nconst { Fragment } = wp.element;\nconst { InspectorControls } = wp.blockEditor;\nconst { PanelBody } = wp.components;\n \nconst withWidgetIDPanel = createHigherOrderComponent( ( BlockEdit ) => {\n    return ( props ) => {\n        const widgetID = props.__internalWidgetId ? props.__internalWidgetId : 0;\n        return (\n            <Fragment>\n                <BlockEdit { ...props } />\n                <InspectorControls>\n                    <PanelBody>\n                        <input\n                            class=\"components-text-control__input\"\n                            type=\"text\"\n                            disabled\n                            value={ props.widgetID }\n                        />\n                    </PanelBody>\n                </InspectorControls>\n            </Fragment>\n        );\n    };\n}, 'withWidgetIDPanel' );\n \nwp.hooks.addFilter(\n    'editor.BlockEdit',\n    'tomjn/display-widget-id',\n    withWidgetIDPanel\n);\n\nThis will give you the widget ID if it's available in the sidebar for every legacy widget if enqueued on the widgets page, and provides a useful debug panel for non-widget editors too. It also gives you a place to use react hooks and other WordPress APIs in the context of a specific block, without needing to figure out which widget belongs to which block ID.\nNote that when the widget ID changes, React will re-render the component automatically, no subscription is necessary. Note that no local state is in use.\nFrontend Block ID\nIf however you want the ID that gets used on the frontend, there's an attribute named __internalWidgetId. When this changes React will re-render the edit component because its props have changed, so no subscription to the store is necessary.\nBefore the widget is saved, this __internalWidgetId attribute does not exist, and will be null if accessed, and when it comes into existence again the edit component will re-render because changed props are how React knows to re-render a DOM element.\nStoring the widget ID in local state is not necessary and could lead to problems. Just pass the raw attribute down if it's not null to any child components that need it or use the internal widget ID directly.\nAs a bonus, you can select on the core/edit-widgets store to grab the widget data directly.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405608", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to add site tags in alphabetical order to shortcode? Good morning. There is a shortcode that displays site tags on a separate page.\n    function tag_cloud_shortcode($atts) {\n   \n      extract(shortcode_atts(array(\n          'cat' => ''\n      ), $atts));\n   \n      $query_args = array( 'cat' => $atts, 'posts_per_page' => -1 );\n      $custom_query = new WP_Query( $query_args );\n      if ($custom_query->have_posts()) :\n          while ($custom_query->have_posts()) : $custom_query->the_post();\n              $posttags = get_the_tags();\n              if ($posttags) {\n                  foreach($posttags as $tag) {\n                      $all_tags[] = $tag->term_id;\n                  }\n              }\n          endwhile;\n      endif;\n   \n      $tags_arr = array_unique($all_tags);\n      $tags_str = implode(\",\", $tags_arr);\n   \n      $args = array(\n      'echo'      => false,\n      'smallest'  => 10,\n      'largest'   => 10,\n      'unit'      => 'px',\n      'number'    => 0,\n      'format'    => 'flat',\n      'order'     => 'count',\n      'include'   => $tags_str\n      );\n      return wp_tag_cloud($args);\n  }\n  add_shortcode( 'tagscloud', 'tag_cloud_shortcode' );\n\nI need them to be arranged alphabetically, i.e., for example, capital letter A and below it all tags starting with A. Capital letter B, below it all tags starting with B, and so on. Here's how it is on this screen.\n\nNow they are all located just in one line, one after another. Can you please tell me how to add this parameter to this shortcode? Thank you very much in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405609", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to avoid saving empty data to sql while using add_meta_box I'm trying not to save empty data (null) while using add_meta_box function. My code is\n/**\n * Register meta boxes.\n */\nfunction hcf_register_meta_boxes() {\n    add_meta_box( 'hcf-1', __( 'Hello Custom Field', 'hcf' ), 'hcf_display_callback', 'post' );\n}\nadd_action( 'add_meta_boxes', 'hcf_register_meta_boxes' );\n\n\n/**\n * Meta box display callback.\n *\n * @param WP_Post $post Current post object.\n */\nfunction hcf_display_callback( $post ) {\n    include plugin_dir_path( __FILE__ ) . './form.php';\n}\n\n\n/**\n * Save meta box content.\n *\n * @param int $post_id Post ID\n */\nfunction hcf_save_meta_box( $post_id ) {\n    if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) return;\n    if ( $parent_id = wp_is_post_revision( $post_id ) ) {\n        $post_id = $parent_id;\n    }\n    $fields = [\n        'hcf_author',\n        'hcf_published_date',\n        'hcf_price',\n    ];\n    foreach ( $fields as $field ) {\n        if ( array_key_exists( $field, $_POST ) ) {\n            update_post_meta( $post_id, $field, sanitize_text_field( $_POST[$field] ) );\n        }\n     }\n}\nadd_action( 'save_post', 'hcf_save_meta_box' );\n\nI'm using code from https://medium.com/meta-box/how-to-create-custom-meta-boxes-custom-fields-in-wordpress-4703e53638bd .\nHowever whenever I save my post, the null data always be stored to wp_postmeta(sql) eventhough I didn't put data in the metabox and it is making  a lot of garbage rows to my sql. I don't want to save null data to my sql. Please help me with this. Thanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405611", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Reciving Error 404 blog/page/2/ I can't seem to understand the issue here with my pagination? when visiting /blog/page/2  page goes to 404 page. Help me guys?\n<div class=\"row\">\n                    <?php\n                    // $paged = get_query_var('paged') ? get_query_var('paged') : 1;\n                    if (get_query_var('paged')) {\n\n                        $paged = get_query_var('paged');\n                    } elseif (get_query_var('page')) {\n\n                        $paged = get_query_var('page');\n                    } else {\n\n                        $paged = 1;\n                    }\n                    $querys = new WP_Query(array(\n                        'post_type' => 'blog',\n                        'post_status' => 'publish',\n                        'paged' => $paged\n                    ));\n                    if ($querys->have_posts()) {\n                        while ($querys->have_posts()) {\n                            $querys->the_post(); ?>\n                            <div class=\"col-lg-6 col-md-6\">\n                                <a href=\"<?= the_permalink(); ?>\">\n                                    <div class=\"news-modal-wrap radius5\">\n                                        <div class=\"new-img-wrap\">\n                                            <?php if (has_post_thumbnail($post->ID)) : ?>\n                                                <?php $image = wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), 'single-post-thumbnail'); ?>\n                                                <img src=\"<?= $image[0] ?>\" alt=\"\">\n                                            <?php endif; ?>\n                                            <div>\n                                                <img src=\"<?= bloginfo('template_directory') ?>/assets/images/logo2.png\" class=\"logo2\" alt=\"logo2\">\n                                            </div>\n                                        </div>\n                                        <div class=\"p-4\">\n                                            <?php\n                                            $categories = get_the_terms($post->ID, 'blog_taxonomy');\n                                            foreach ($categories as $category) { ?>\n                                                <p class=\"d-inline value-btn p-1 radius5 text-uppercase\"><?= $category->name; ?></p>\n                                            <?php } ?>\n                                            <h5 class=\"mt-4\">\n                                                <?php the_title(); ?>\n                                            </h5>\n                                            <p class=\"my-4\">\n                                                <?php $content = get_the_content();\n                                                $trimmed_content = wp_trim_words($content, 25); ?>\n                                                <?php echo $trimmed_content; ?>\n                                            </p>\n                                            <div class=\"new-date d-flex\">\n                                                <p><?= get_the_date(); ?></p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </a>\n                            </div>\n                        <?php wp_reset_query();\n                        }\n                    } else { ?>\n                        No Posts Found Of This <p class=\"d-inline value-btn p-1 radius5 text-uppercase\"><?= $sector; ?> Category</p>\n                    <?php } ?>\n                    <?= wp_pagenavi(array('query' => $querys)); ?>\n                </div> \n\n\nA: function wphelp_custom_pre_get_posts( $query ) {\nif( $query->is_main_query() && !$query->is_feed() && !is_admin() && is_category()) {\n    $query->set( 'paged', str_replace( '/', '', get_query_var( 'page' ) ) );  }  }\nadd_action('pre_get_posts','wphelp_custom_pre_get_posts');\nfunction wphelp_custom_request($query_string ) {\n     if( isset( $query_string['page'] ) ) {\n         if( ''!=$query_string['page'] ) {\n             if( isset( $query_string['name'] ) ) { unset( $query_string['name'] ); } } } return $query_string; }\nadd_filter('request', 'wphelp_custom_request'); \n\nI have used this code and it helped me through for now.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405612", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Redeclaring a plugin function within a class In the code below, a user defined add_meta_box() function is hooked to add_meta_boxes action. How does wordpress know that the add_meta_box() function used inside the user-defined add_meta_box( $post_type ) function is a plugin function and not a recursive one?\nclass someClass {\n \n    /**\n     * Hook into the appropriate actions when the class is constructed.\n     */\n    public function __construct() {\n        add_action( 'add_meta_boxes', array( $this, 'add_meta_box' ) );\n        add_action( 'save_post',      array( $this, 'save'         ) );\n    }\n \n    /**\n     * Adds the meta box container.\n     */\n    public function add_meta_box( $post_type ) {\n        // Limit meta box to certain post types.\n        $post_types = array( 'post', 'page' );\n \n        if ( in_array( $post_type, $post_types ) ) {\n            add_meta_box(\n                'some_meta_box_name',\n                __( 'Some Meta Box Headline', 'textdomain' ),\n                array( $this, 'render_meta_box_content' ),\n                $post_type,\n                'advanced',\n                'high'\n            );\n        }\n    }\n \n    /**\n     * Save the meta when the post is saved.\n     *\n     * @param int $post_id The ID of the post being saved.\n     */\n    public function save( $post_id ) {\n \n        /*\n         * We need to verify this came from the our screen and with proper authorization,\n         * because save_post can be triggered at other times.\n         */\n \n        // Check if our nonce is set.\n        if ( ! isset( $_POST['myplugin_inner_custom_box_nonce'] ) ) {\n            return $post_id;\n        }\n \n        $nonce = $_POST['myplugin_inner_custom_box_nonce'];\n \n        // Verify that the nonce is valid.\n        if ( ! wp_verify_nonce( $nonce, 'myplugin_inner_custom_box' ) ) {\n            return $post_id;\n        }\n \n        /*\n         * If this is an autosave, our form has not been submitted,\n         * so we don't want to do anything.\n         */\n        if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) {\n            return $post_id;\n        }\n \n        // Check the user's permissions.\n        if ( 'page' == $_POST['post_type'] ) {\n            if ( ! current_user_can( 'edit_page', $post_id ) ) {\n                return $post_id;\n            }\n        } else {\n            if ( ! current_user_can( 'edit_post', $post_id ) ) {\n                return $post_id;\n            }\n        }\n \n        /* OK, it's safe for us to save the data now. */\n \n        // Sanitize the user input.\n        $mydata = sanitize_text_field( $_POST['myplugin_new_field'] );\n \n        // Update the meta field.\n        update_post_meta( $post_id, '_my_meta_value_key', $mydata );\n    }\n \n \n    /**\n     * Render Meta Box content.\n     *\n     * @param WP_Post $post The post object.\n     */\n    public function render_meta_box_content( $post ) {\n \n        // Add an nonce field so we can check for it later.\n        wp_nonce_field( 'myplugin_inner_custom_box', 'myplugin_inner_custom_box_nonce' );\n \n        // Use get_post_meta to retrieve an existing value from the database.\n        $value = get_post_meta( $post->ID, '_my_meta_value_key', true );\n \n        // Display the form, using the current value.\n        ?>\n        <label for=\"myplugin_new_field\">\n            <?php _e( 'Description for this field', 'textdomain' ); ?>\n        </label>\n        <input type=\"text\" id=\"myplugin_new_field\" name=\"myplugin_new_field\" value=\"<?php echo esc_attr( $value ); ?>\" size=\"25\" />\n        <?php\n    }\n}\n\n\nA: \nHow does wordpress know that the add_meta_box() function used inside the user-defined add_meta_box( $post_type ) function is a plugin function and not a recursive one?\n\nIt doesn't, WordPress just calls it, so you can indeed create infinite loops.\nInstead what I think you're asking is how PHP knows to call that class method and not the function with the same name. Remember, WordPress is an application written in PHP, it's not a programming language itself, and you're writing PHP code that calls WordPress functions/APIs, not WordPress code.\nThe answer, is that the parameter expects a callable value, something PHP recognises as something it can call, e.g. the name of a function, an anonymous function, etc.\nThe answer becomes clearer when you compare the following:\n\n*\n\n*'bar' is equivalent to bar();\n\n*array( $this, 'bar' ), is equivalent to $this->bar();\n\n*array( 'Foo, 'bar' ), is equivalent to Foo::bar()\n\n*etc...\n\nAs you can see, the code in your question used an array, where the entry is the object, and the second entry is the name of the method to call.\nIt's also helpful to refer to these by their proper names, e.g. a function inside a class is a class method, sometimes known as a class function. This is different from a normal function.\nFor more information on what callables are and how they work:\nhttps://www.php.net/manual/en/language.types.callable.php\nCallables are a PHP language feature, and one that WordPress relies on for specifying callbacks for actions/hooks/filters and other APIs.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405613", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to make entire  in blog post page linked? I am using a theme where on the blog page only the featured image and the post title are using anchor link. On clicking it redirects to that respective post page.\nBut I want to link the entire  so that if anybody clicks on that area it will redirect to that respective post page.\nI saw a website \"https://www.tidio.com/blog/\" where their entire article section was linked. So when i inspect their code, I found that they are using pseudo-element ::before to make the whole section linked.\nSimilarly, I also tried the same but didn't work out for me. It really helps if someone can assist me in this. I am also attaching an image for better understanding.\nThanks in Advance.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405616", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Contact form 7 radio button default:get I have three radio buttons and each should be selected according to which link the user click on some previous page\n[radio saletype use_label_element default:get \"Commission sale\" \"Immediate sale\" \"Car exchange\"]\nand /?saletype=2\ndont work. Help please\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405617", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Very simple wordpress block to display posts from an api call I've been banging my head on this for a bit now.\nI'm trying to create a simple wordpress block that fetches custom post types from the rest api, then displays the fetched posts via react. It only needs to do this, and requires no other editor functionality.\nHowever, I'm a bit of a react/wp noob and I may be fundamentally misunderstanding how wordpress react functions, as I can't seem to get anywhere.\nHere is my code so far:\nclass oupSeriesBlock extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {data: []};\n    }\n\n    getOupSeries() {\n        console.log('mounted');\n        apiFetch({\n            path: 'wp/v2/oup_series'\n        }).then((response) => {\n            this.state = {data: response}\n            console.log(this.state);\n        })\n    }\n\n    componentDidMount() {\n        this.getOupSeries();\n    }\n\n    render() {\n        return(\n            <div>\n                Test\n                {this.state.data.length > 0 ? this.state.data.map(data => <div>{data.id}</div>) : 'empty'}\n            </div>\n        )\n    }\n}\n\nregisterBlockType('cb/oup-series', {\n    title: 'OUP Book Series',\n    apiVersion: 2,\n    category: 'cb-layout',\n    icon: 'book-alt',\n    description: 'Shows list of OUP book series',\n    keywords: ['book', 'series', 'oup'],\n    edit: () => {\n        const blockProps = useBlockProps();\n        return (\n            <div {...blockProps}>\n                <div>OUP Series List</div>\n            </div>\n        )\n    },\n    save: oupSeriesBlock\n});\n\n\nThe block is available and rendering without error but is not displaying any data, only 'Test' is rendered.\nThe rest route is definitely functioning correctly as I've tested it, but componentDidMount() is never being called.\nthis.state.data.map also works correctly when constructed with dummy data.\nI've read through multiple examples and tutorials, but I'm having trouble applying them to my problem, if anyone could help it would be greatly appreciated.\n\nA: This is because when your block was rendered for save the API call had not finished. Save components do not run on the frontend.\n    render() {\n        return(\n            <div>\n                Test\n                {this.state.data.length > 0 ? this.state.data.map(data => <div>{data.id}</div>) : 'empty'}\n            </div>\n        )\n    }\n\nThe purpose of a save component is to take your blocks attributes, and turn them into static HTML to be saved in the post content. None of the code in your save component executes on the frontend. Your save component cannot have side effects or lifecycle methods.\nIn order to implement fetching posts from the API endpoint when the block is viewed by frontend users, you need to enqueue a javascript file, identify all the places your block is used, and fetch the data. This is not different to when a shortcode has frontend javascript. The main difference here is that WordPress has hooks and filters to let you only enqueue the blocks frontend assets when it's actually used.\nIn summary:\n\n*\n\n*Save components can't have state, side effects, or pull data from external sources such as editor state or remote APIs\n\n*Save components don't run on the frontend\n\n*Only the static serialised output of a save component is saved, not the react component itself\n\n*A save component must always return the same output given the same block attributes, or it is built incorrectly and will fail block validation\n\n*Use functional components so that you can use newer versions of the block API and hooks such as useBlockProps for better performance and features.\n\n*frontend javascript requires a separate frontend JS file to be enqueued\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405618", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Auto populate a user custom field from another user custom field I have a WP theme with its own custom fields including one for Phone Number. I also installed the Digits Plugin which allows users to sign up/login with their phone number and OTP, which has its own phone number custom field.\nWhat I want to do is to use the phone number they use to sign up/login to also be the phone number used within the theme and also within Woocommerce if possible.\nAny help would be appreciated\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405624", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Contact form 7 send product PDF after submit We are trying to display a cf7 form on woocommerce product pages, where users can submit the form and receive a pdf file related to the product (either as an email file attachment, as a link in the email body or even as a link that opens in a new browser tab).\nSo far we have tried adding the pdf link as a product attribute and returning it with a shortcode, but... shortcodes don't work on CF7 e-mails.\nDoes any of you know a way to return shortcodes on cf7 emails? Or maybe you have a better idea to do such a thing, because our idea doesn't seem that optimized.\nAnd obviously we don't want to create one form per product, that would be a nightmare.\nHere's the code used for our shortcode :\n/**\n * Attributes shortcode callback.\n */\nfunction so_39394127_attributes_shortcode( $atts ) {\n\n    global $product;\n\n    if( ! is_object( $product ) || ! $product->has_attributes() ){\n        return;\n    }\n\n    // parse the shortcode attributes\n    $args = shortcode_atts( array(\n        'attributes' => array_keys( $product->get_attributes() ), // by default show all attributes\n    ), $atts );\n\n    // is pass an attributes param, turn into array\n    if( is_string( $args['attributes'] ) ){\n        $args['attributes'] = array_map( 'trim', explode( '|' , $args['attributes'] ) );\n    }\n\n    // start with a null string because shortcodes need to return not echo a value\n    $html = '';\n\n    if( ! empty( $args['attributes'] ) ){\n\n        foreach ( $args['attributes'] as $attribute ) {\n\n            // get the WC-standard attribute taxonomy name\n            $taxonomy = strpos( $attribute, 'pa_' ) === false ? wc_attribute_taxonomy_name( $attribute ) : $attribute;\n\n            if( taxonomy_is_product_attribute( $taxonomy ) ){\n\n                // Get the attribute label.\n                $attribute_label = wc_attribute_label( $taxonomy );\n\n                // Build the html string with the label followed by a clickable list of terms.\n                // Updated for WC3.0 to use getters instead of directly accessing property.\n                $html .= get_the_term_list( $product->get_id(), $taxonomy); \n            }\n\n        }\n\n        // if we have anything to display, wrap it in a <ul> for proper markup\n        // OR: delete these lines if you only wish to return the <li> elements\n\n    }\n\n    return $html;\n}\nadd_shortcode( 'display_attributes', 'so_39394127_attributes_shortcode' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405627", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Finding the screen id of a page generated with add_menu_page I'm at a basic level of WordPress + PHP and I'm trying to build a pretty simple plugin.\nI've set up the plugin correctly, and the plugin page is generated with\nfunction wpplugin_settings_page() {\n    add_menu_page(\n        'Modal Generator',\n        'Modal Generator',\n        'manage_options',\n        'modal-slug',\n        'wpplugin_settings_page_markup',\n        'dashicons-format-gallery',\n        100\n    );\n}\n\nWhereas wpplugin_settings_page_markup is a function that generates my HTML on the plugin page.\nI copy-pasted a code to create/generate metaboxes and they work great. I can get them to show on posts & pages with this code:\nfunction single_repeater_meta_boxes() {\n    add_meta_box( 'single-repeater-data', 'Single Repeater', 'single_repeatable_meta_box_callback', 'page', 'normal', 'default');\n}\n\nI achieved this by changing the $screen-parameter, as WordPress' official documentation states:\n\n$screen\n(string|array|WP_Screen) (Optional) The screen or screens on which to show the box (such as a post type, 'link', or 'comment'). Accepts a single screen ID, WP_Screen object, or array of screen IDs. Default is the current screen. If you have used add_menu_page() or add_submenu_page() to create a new screen (and hence screen_id), make sure your menu slug conforms to the limits of sanitize_key() otherwise the 'screen' menu may not correctly render on your page.\n\nHowever, I can't get them to show on my dynamically generated plugin page. I somehow need to find the screen ID and use that as the parameter value for $screen. The slug modal-generator shouldn't be an issue. I hope my question makes sense and if not, feel free to ask.\nadd_action('admin_init', 'single_repeater_meta_boxes', 2);\n\nfunction single_repeater_meta_boxes() {\n    add_meta_box( 'single-repeater-data', 'Single Repeater', 'single_repeatable_meta_box_callback', 'toplevel_page_wp-nordic-modal', 'normal', 'default');\n}\n\n/* =========== GENERATING METABOXES =========== */\nfunction single_repeatable_meta_box_callback($post) {\n\n    $single_repeater_group = get_post_meta($post->ID, 'single_repeater_group', true);\n    $banner_img = get_post_meta($post->ID,'post_banner_img',true);\n    wp_nonce_field( 'repeaterBox', 'formType' );\n    ?>\n    <script type=\"text/javascript\">\n        jQuery(document).ready(function( $ ){\n            $( '#add-row' ).on('click', function() {\n                var row = $( '.empty-row.custom-repeater-text' ).clone(true);\n                row.removeClass( 'empty-row custom-repeater-text' ).css('display','table-row');\n                row.insertBefore( '#repeatable-fieldset-one tbody>tr:last' );\n                return false;\n            });\n\n            $( '.remove-row' ).on('click', function() {\n                $(this).parents('tr').remove();\n                return false;\n            });\n        });\n\n    </script>\n\n    <table id=\"repeatable-fieldset-one\" width=\"100%\">\n        <tbody>\n            <?php\n            if ( $single_repeater_group ) :\n                foreach ( $single_repeater_group as $field ) {\n                    ?>\n                    <tr>\n                        <td><input type=\"text\"  style=\"width:98%;\" name=\"title[]\" value=\"<?php if($field['title'] != '') echo esc_attr( $field['title'] ); ?>\" placeholder=\"Heading\" /></td>\n                        <td><input type=\"text\"  style=\"width:98%;\" name=\"tdesc[]\" value=\"<?php if ($field['tdesc'] != '') echo esc_attr( $field['tdesc'] ); ?>\" placeholder=\"Description\" /></td>\n                        <td><a class=\"button remove-row\" href=\"#1\">Remove</a></td>\n                    </tr>\n                    <?php\n                }\n            else :\n                ?>\n                <tr>\n                    <td><input type=\"text\"   style=\"width:98%;\" name=\"title[]\" placeholder=\"Heading\"/></td>\n                    <td><input type=\"text\"  style=\"width:98%;\" name=\"tdesc[]\" value=\"\" placeholder=\"Description\" /></td>\n                    <td><a class=\"button  cmb-remove-row-button button-disabled\" href=\"#\">Remove</a></td>\n                </tr>\n            <?php endif; ?>\n            <tr class=\"empty-row custom-repeater-text\" style=\"display: none\">\n                <td><input type=\"text\" style=\"width:98%;\" name=\"title[]\" placeholder=\"Heading\"/></td>\n                <td><input type=\"text\" style=\"width:98%;\" name=\"tdesc[]\" value=\"\" placeholder=\"Description\"/></td>\n                <td><a class=\"button remove-row\" href=\"#\">Remove</a></td>\n            </tr>\n\n        </tbody>\n    </table>\n    <p><a id=\"add-row\" class=\"button\" href=\"#\">Add another</a></p>\n    <?php\n}\n\n/* =========== SAVING METABOXES ===========*/\nadd_action('save_post', 'single_repeatable_meta_box_save');\n\nfunction single_repeatable_meta_box_save($post_id) {\n\n    if (!isset($_POST['formType']) && !wp_verify_nonce($_POST['formType'], 'repeaterBox'))\n        return;\n\n    if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE)\n        return;\n\n    if (!current_user_can('edit_post', $post_id))\n        return;\n\n    $old = get_post_meta($post_id, 'single_repeater_group', true);\n\n    $new = array();\n    $titles = $_POST['title'];\n    $tdescs = $_POST['tdesc'];\n    $count = count( $titles );\n    for ( $i = 0; $i < $count; $i++ ) {\n        if ( $titles[$i] != '' ) {\n            $new[$i]['title'] = stripslashes( strip_tags( $titles[$i] ) );\n            $new[$i]['tdesc'] = stripslashes( $tdescs[$i] );\n        }\n    }\n\n    if ( !empty( $new ) && $new != $old ){\n        update_post_meta( $post_id, 'single_repeater_group', $new );\n    } elseif ( empty($new) && $old ) {\n        delete_post_meta( $post_id, 'single_repeater_group', $old );\n    }\n    $repeater_status= $_REQUEST['repeater_status'];\n    update_post_meta( $post_id, 'repeater_status', $repeater_status );\n}\n\n/* =========== PLUGIN PAGE ===========*/\nfunction wpplugin_settings_page()\n{\n    add_menu_page(\n        'Modal Generator',                  // page title\n        'Modal Generator',                  // menu title\n        'manage_options',                   // capability\n        'wp-nordic-modal',                  // menu_slug\n        'wpplugin_settings_page_markup',    // callable function\n        'dashicons-format-gallery',         // icon\n        100\n    );\n    add_submenu_page(\n      'wp-nordic-modal',\n      __( 'Popup Generator', 'wp-nordic-modal' ),\n      __( 'Popup', 'wp-nordic-modal' ),\n      'manage_options',\n      'wpplugin-feature-1',\n      'wpplugin_settings_subpage_markup'\n    );\n\n}\nadd_action( 'admin_menu', 'wpplugin_settings_page' );\n\n\nfunction wpplugin_settings_page_markup()\n{\n    // Double check user capabilities\n    if ( !current_user_can('manage_options') ) {\n      return;\n    }?>\n    <div class=\"wrap\">\n      <h1><?php esc_html_e( get_admin_page_title() ); ?></h1>\n      <p><?php esc_html_e( 'Some content.', 'wpplugin' ); ?></p>\n    </div>\n    <div>save</div>\n    <?php\n}\n\nfunction wpplugin_settings_subpage_markup()\n{\n  // Double check user capabilities\n  if ( !current_user_can('manage_options') ) {\n      return;\n  }\n  ?>\n  <div class=\"wrap\">\n    <h1><?php esc_html_e( get_admin_page_title() ); ?></h1>\n    <p><?php esc_html_e( 'Some content.', 'wpplugin' ); ?></p>\n  </div>\n  <?php\n}\n\n\nA: The function add_menu_page return the hook suffix that inform you about the current page.\nA simple example to get the hook suffix.\npublic function add_menu_page() {\n    $page_hook_suffix = add_menu_page(\n        esc_html__( 'Admin Page', 'translation-slug' ),\n        esc_html__( 'Admin Page', 'translation-slug' ),\n        'read',\n        'My Name',\n        array( $this, 'get_styles' )\n    );\n    add_action( 'admin_print_scripts-' . $page_hook_suffix, array( $this, 'enqueue_assets' ) );\n}\n\nThe example above add the scripts only on the custom admin page, because the hook admin_print_scripts-* is fired only on the hook suffix from the return value of add_menu_page.\nWP_Screen\nAlso, you can use the function get_current_screen to identify the page and use the value after identification.\nHelpers\nThere are also helper plugins to find this value, if is not dynamically, like Query Monitor and Debug Objects.\nScreenshot\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405628", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Create field of Custom Post Types I am using below code to create Custom Post Types.\n$supports = array(\n                    'title', // post title\n                    'editor', // post content\n                    'author', // post author\n                    'thumbnail', // featured images\n                    'excerpt', // post excerpt\n                    'custom-fields', // custom fields\n                    'comments', // post comments\n                    'revisions', // post revisions\n                    'post-formats', // post formats\n                );\n\n                $labels = array(\n                    'name' => _x('news', 'plural'),\n                    'singular_name' => _x('news', 'singular'),\n                    'menu_name' => _x('news', 'admin menu'),\n                    'name_admin_bar' => _x('news', 'admin bar'),\n                    'add_new' => _x('Add New', 'add new'),\n                    'add_new_item' => __('Add New news'),\n                    'new_item' => __('New news'),\n                    'edit_item' => __('Edit news'),\n                    'view_item' => __('View news'),\n                    'all_items' => __('All news'),\n                    'search_items' => __('Search news'),\n                    'not_found' => __('No news found.'),\n                );\n\n                $args = array(\n                    'supports' => $supports,\n                    'labels' => $labels,\n                    'public' => true,\n                    'query_var' => true,\n                    'rewrite' => array('slug' => 'news'),\n                    'has_archive' => true,\n                    'hierarchical' => false,\n                );\n                register_post_type('news', $args);\n\n\nI am getting below Form at the time of Custom Post entry.\n\nHow can I add another Text field after Title named Name ?\n\nA: As you are using the classic editor, you can add new input fields to the editing view by creating custom metaboxes. This is done with add_meta_box(). Check out the code reference for further details and good examples on how to register a metabox, and how to save and edit post meta with it.\nAlthough I can't quite remember, if it is possible to have the metabox between the title and editor fields.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405629", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Multisite login_redirect to primary blog and specific page based on role I'm stumped trying to redirect my users to a specific page on their primary blog when they login to the root/main site on a MU setup.  I have the site editors with a specific 'editor' role and then tenants with 'subscriber' role.  The following code (in a plugin in MU folder) redirects the users with one of the 3 editor roles but will not redirect those with 'subscriber' role.  Any help would be greatly appreciated!  Thanks!\npublic function login_redirect($redirect_to, $requested_redirect_to, $user) {\n    $user = wp_get_current_user();\n    \n    if ( (in_array( 'editor-tier3', $user->roles )|| in_array( 'editor-tier2', $user->roles ) || in_array( 'editor-tier1', $user->roles )))  {\n        \n        if ($user->ID != 0 && $user->ID != 1) {\n    \n            $user_info = get_userdata($user->ID);\n    \n            if ($user_info->primary_blog) {\n    \n                $primary_url = get_blogaddress_by_id($user_info->primary_blog) . 'management-dashboard/';\n    \n                if ($primary_url) {\n    \n                    wp_redirect($primary_url);\n    \n                    die();\n    \n                }\n    \n            }\n    \n        }\n    }\n    \n    elseif (in_array('subscriber', $user->roles))  {\n    \n        if ($user->ID != 0 && $user->ID != 1) {\n    \n            $user_info = get_userdata($user->ID);\n    \n            if ($user_info->primary_blog) {\n    \n                $primary_url = get_blogaddress_by_id($user_info->primary_blog) . 'tenant-dashboard/';\n    \n                if ($primary_url) {\n    \n                    wp_redirect($primary_url);\n    \n                    die();\n    \n                }\n    \n            }\n    \n        }   \n    \n        \n    }\n        \n       // return $redirect_to;\n    \n    }\n\n\nA: I opted to create two functions - 1 to redirect the user based on their primary blog and then a second to redirect any attempt at accessing the /wp-admin/ (wordpress redirects users to admin on login) to a different page based on their role.  Seems to work.  I think there's some sort of two step process in wordpress login that's tripping up role validation so this is the next best thing\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405630", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is it possible to restore a deleted WordPress plugin I deleted from WordPress admin menu? I know it is very, very stupid of me. But I deleted my plugin while I was coding my new plugin. I worked weeks, if not months, on it.\nI deleted it from the WordPress admin menu, by just clicking the 'delete' link.\n(So stupid, but I was trying if it was possible to delete the plugin and the database table that belongs to the plugin.)\nAre there any solutions to get my files back?\nThanks in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405633", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Trying to change category of wp_query I'm trying to change the category of the main loop, after printing posts from each category. The page shows:\n\n*\n\n*3 most recent posts\n\n*3 posts from first category\n\n*3 posts from second category\n\n*3 posts from third category\n\n*3 posts from fourth category\n\nThe category-specific posts can't be from the most recent.\nThe category-specific posts aren't right, though. I see posts, but they're not from the right category!\nHere's my template. It uses blade, so slightly different syntax, but more or less the same as PHP.\n  @php\n    $args = array(\n      'numberposts' => 3,\n      'fields'      => 'ids'\n    );\n    $posts = new WP_Query( $args );\n  @endphp\n\n  @include ('partials.content-lh-post-previews', ['featured_text' => true, 'limit' => 3, 'headline' => 'Recent Articles', 'include_cat' => true])\n  \n\n  {{-- Posts by category --}}\n  @php\n    $args  = array(\n      'taxonomy' => 'category',\n      'parent' => 0,\n      'fields' => 'ids',\n      'meta_key' => 'category_weight',\n      'orderby' => 'meta_value_num'\n    );\n\n    $terms = get_terms($args);\n  @endphp\n\n\n  @foreach ($terms as $index => $term)\n    @php wp_reset_postdata(); @endphp\n    @php\n      $posts->query['cat'] = [$term];\n      $term_name = get_term( $term )->name;\n      $headline = $index == 0 ? 'Featured Stories' : '';\n    @endphp\n\n    @include ('partials.content-lh-post-previews', ['featured_text' => false, 'limit' => 3, 'supertext' => $term_name, 'view_more' => $term, 'headline' => $headline])\n  @endforeach\n\nAnd the template partial I call on lines 9 and 34:\n<?php \n    $count = 0;\n?>\n@if ($posts)\n    <section class=\"post-preview-section\">\n        <div class=\"wrapper\">\n            @if ( isset($headline) && $headline )\n                <h2 class=\"header header-large post-preview-section-headline\">{{ $headline }}</h2>\n            @endif\n            @isset ( $supertext )\n                <label class=\"post-preview-section-supertext supertext\">{{ $supertext }}</label>\n            @endisset\n            <div class=\"post-preview-container{{ isset($view_more) ? ' view-more' : '' }}\">\n                <?php while ($posts->have_posts() && $count < $limit) : $posts->the_post(); ?>\n                    @php\n                        $image = get_field('small_image');\n                        $title = get_the_title();\n                        $copy  = $featured_text ? get_field('featured_text') : null; // only show post copy if is latest section\n                        if ( isset($include_cat) && $include_cat ) :\n                            $cat = get_field('main_category')['label'];\n                        endif;\n                    @endphp\n                    <a class=\"post-preview\" href=\"{{ get_the_permalink() }}\">\n                        @if ( $image )\n                            <img src=\"{{ $image }}\" class=\"post-preview-image\">\n                        @endif\n                        <div class=\"post-preview-copy-area\">\n                            @isset( $include_cat )\n                                <label class=\"post-preview-supertext\"><?php echo $cat ?></label>\n                            @endisset\n                            <h3 class=\"header header--small post-preview-title\">{!! $title !!}</h3>\n                            @if ( $copy )\n                                <div class=\"post-preview-copy\">{!! $copy !!}</div>\n                            @endif\n                            <div class=\"arrow post-preview-link\">Read the article</div>\n                        </div>\n                    </a>\n                    <?php $count++; ?>\n                <?php endwhile; ?>\n                @isset($view_more)\n                    @php\n                        $term       = get_term($view_more);\n                        $term_icon  = get_field('category_icon', $term);\n                        $term_color = get_field('category_color', $term);\n                        $term_link  = get_category_link($view_more);\n                        $term_name  = $term->name;\n\n\n                    @endphp\n                    <a href=\"{{ $term_link }}\" class=\"post-preview post-preview-more\" style=\"background-color: {{ $term_color }}\">\n                        @if ( $term_icon )\n                            <div style=\"background-color: {{ $term_color }}\" class=\"post-preview-more-icon-container post-preview-image\">\n                                <img src=\"{{ $term_icon['url'] }}\" class=\"post-preview-more-icon\" alt=\"{{ $term_icon['alt'] }}\">\n                            </div>\n                        @endif\n                        <div class=\"post-preview-copy-area\">\n                            <h3 class=\"post-preview-title header header--small\">More {{ $term_name }} Articles</h3>\n                            <div class=\"arrow post-preview-link\">View all</div>\n                        </div>\n                    </a>\n                @endisset\n            </div>\n        </div>\n    </section>\n@endif\n\n@php wp_reset_postdata() @endphp\n\nWhy isn't the category working?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405636", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to redirect outgoing links via my own website How can redirect outgoing links first to my own site?\nfor example i got a recipe post and i got a outgoing link to another website\nthis link is stored in a metafield\n$recipe_url = \"https://recipes.com/applepie\";\n\nbut in the post i dont want to href recipes.com i want\nmy own link like:\n$displayed_url = \"https://myownsite.com/redirect/recipe/123\";\n\ndoes someone know how to archive this in wordpress?\n\nA: Here is a simple solution..\n\n*\n\n*Create a page that you want to use as your redirect handler and get the ID of that page.\n\n\n*This goes into your theme's functions.php or any of your plugin file.\nfunction wpse405640_redirect() {\n     if ( is_page(123) ) { //Assuming your page id is 123\n         $redirect = isset($_GET['url']) && !empty($_GET['url']) ? $_GET['url'] : home_url('/');\n         wp_redirect( $redirect );\n         exit;\n     }\n }\n add_action('template_redirect', 'wpse405640_redirect');\nThe URL structure should be https://myownsite.com/redirect/?url=https://recipes.com/applepie.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405640", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Need to add a post\u2019s featured image to a section on the frontpage It looks like I will need to create custom PHP code for this and either add it to my includes directory within a custom PHP file, or to the functions.php file.\nI need the ability to use a featured image in a post and be able to also dynamically display that same image in a gallery on the frontpage.\nI am not a PHP master by any means, but I know a bit to get around.\nMy guess is I would need something comparable to this:\nif ( has_post_thumbnail() ) {     \n    echo '<div style='background-image: url(' . get_the_post_thumbnail_url() . ');></div>';\n}\n?>\n\nHow would I get the featured image to display within in a certain section on the frontpage?\nWould I need to create a custom class to place this in a specific section on the frontpage?\nThere\u2019s a \u201cProjects\u201d custom post type where the actual posts are created. There are fields within this post type created using ACF. There\u2019s a \u201cProject Featured\u201d section in this custom post type that offers a toggle to turn off or on \u201cFeatured\u201d. If the toggle is on, that is when the featured image should be used and displayed on the frontpage.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405641", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Linking form to user meta fields I currently have my login page set up to allow sign up through google. Immediately after a successful sign up I'm looking to set up a redirect to a form where the user can enter additional details and these are saved within predefined user meta fields.\nI know how to set up the fields using ACF or Pods. Are there free plugins available which can link a form to the meta fields? I'm fairly new to developing hooks but if there's a way of doing this with code I would appreciate any advice on which files I should be looking to edit and what commands to make use of.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405643", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to disable edit post option? I have a WordPress LMS site, and the Tutor Instructor role can create posts as courses and these posts are custom post types called courses, and I want to disallow the Tutor Instructor to edit their courses after they publish them.\nI saw this How to disable edit post option after period of time?\nIt doesn't work. I changed the role to Tutor Instructor and made it 1 hour but still not working, maybe because the post type is not in the code.\nThis is the frontend page from where the Tutor Instructor can click edit or delete, and the page will redirect him to the course builder to edit the link will be like this (https://**************.com/dashboard/create-course/?course_ID=13865).\n<div class=\"mycourse-footer\">\n                        <div class=\"tutor-mycourses-stats\">\n                            <?php echo tutor_utils()->tutor_price( tutor_utils()->get_course_price() ); ?>\n                            <div class=\"course-actions\">\n                                <a href=\"<?php echo esc_url( tutor_utils()->course_edit_link( $post->ID ) ); ?>\"\n                                   class=\"tutor-mycourse-edit edit\">\n                                    <i class=\"fal fa-pencil-alt\"></i><?php esc_html_e( 'Edit', 'edumall' ); ?>\n                                </a>\n                                <a href=\"#tutor-course-delete\"\n                                   class=\"tutor-dashboard-element-delete-btn tutor-mycourse-delete\"\n                                   data-id=\"<?php echo esc_attr( $post->ID ); ?>\">\n                                    <i class=\"fal fa-trash-alt\"></i><?php esc_html_e( 'Delete', 'edumall' ) ?>\n                                </a>\n                                <?php do_action( 'tutor_course_dashboard_actions_after', $post->ID ); ?>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n\nThe full-page code for the frontend publishing (where the Tutor Instructor can create the courses, and this is where he can edit the course).\n<?php\n\ndefined( 'ABSPATH' ) || exit;\n\nget_tutor_header( true );\ndo_action( 'tutor_load_template_before', 'dashboard.create-course', null );\nglobal $post;\n\n$course_id          = get_the_ID();\n$can_publish_course = (bool) tutor_utils()->get_option( 'instructor_can_publish_course' ) || current_user_can( 'administrator' );\n\nif ( ! tutor_utils()->can_user_edit_course( get_current_user_id(), $course_id ) ) {\n    tutor_load_template( 'permission-denied' );\n\n    return;\n}\n?>\n\n<?php do_action( 'tutor/dashboard_course_builder_before' ); ?>\n    <form action=\"\" id=\"tutor-frontend-course-builder\" class=\"tutor-frontend-course-builder\" method=\"post\"\n          enctype=\"multipart/form-data\">\n\n        <?php wp_nonce_field( tutor()->nonce_action, tutor()->nonce ); ?>\n\n        <header id=\"page-header\" class=\"page-header header-dark header-sticky-dark-logo\">\n            <div class=\"page-header-place-holder\"></div>\n            <div id=\"page-header-inner\" class=\"page-header-inner\" data-sticky=\"1\">\n                <div class=\"container\">\n                    <div class=\"header-wrap\">\n                        <div class=\"header-left\">\n                            <?php\n                            $branding_args = [\n                                'reverse_scheme' => true,\n                            ];\n                            ?>\n                            <?php edumall_load_template( 'branding', null, $branding_args ); ?>\n\n                            <button type=\"submit\"\n                                    class=\"tutor-dashboard-builder-draft-btn tutor-btn bordered-btn\"\n                                    name=\"course_submit_btn\"\n                                    value=\"save_course_as_draft\">\n                                <i class=\"fal fa-save\"></i>\n                                <span><?php esc_html_e( 'Save', 'edumall' ); ?></span>\n                            </button>\n                        </div>\n\n                        <div class=\"header-right\">\n                            <div class=\"header-content-inner\">\n                                <div id=\"header-right-inner\" class=\"header-right-inner\">\n                                    <div class=\"header-right-inner-content\">\n                                        <?php Edumall_Templates::render_button( [\n                                            'link'        => [\n                                                'url'         => get_the_permalink( $course_id ),\n                                                'is_external' => true,\n                                            ],\n                                            'text'        => esc_html__( 'Preview', 'edumall' ),\n                                            'icon'        => 'fal fa-glasses',\n                                            'extra_class' => 'button-grey',\n                                        ] ); ?>\n\n                                        <div class=\"form-submit\">\n                                            <?php if ( $can_publish_course ) : ?>\n                                                <button class=\"tutor-button\" type=\"submit\"\n                                                        name=\"course_submit_btn\"\n                                                        value=\"publish_course\"><?php esc_html_e( 'Publish Course', 'edumall' ); ?></button>\n                                            <?php else: ?>\n                                                <button class=\"tutor-button\" type=\"submit\"\n                                                        name=\"course_submit_btn\"\n                                                        value=\"submit_for_review\"><?php esc_html_e( 'Submit for Review', 'edumall' ); ?></button>\n                                            <?php endif; ?>\n                                        </div>\n                                        <div class=\"return-dashboard-link\">\n                                            <a href=\"<?php echo tutor_utils()->tutor_dashboard_url(); ?>\"> <?php esc_html_e( 'Exit', 'edumall' ); ?></a>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <?php Edumall_Header::instance()->print_more_tools_button(); ?>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </header>\n\n        <div class=\"tutor-frontend-course-builder-section tm-sticky-parent\">\n            <div class=\"container\">\n                <div class=\"row\">\n                    <div class=\"col-lg-8\">\n                        <input type=\"hidden\" value=\"tutor_add_course_builder\" name=\"tutor_action\"/>\n                        <input type=\"hidden\" name=\"course_ID\" id=\"course_ID\" value=\"<?php echo get_the_ID(); ?>\">\n                        <input type=\"hidden\" name=\"post_ID\" id=\"post_ID\" value=\"<?php echo get_the_ID(); ?>\">\n                        <div class=\"tutor-dashboard-course-builder-wrap tm-sticky-column\">\n\n                            <!--since 1.8.0 alert message -->\n                            <?php\n                            $instructor_can_publish = tutils()->get_option( 'instructor_can_publish_course' );\n                            ?>\n                            <?php if ( current_user_can( 'tutor_instructor' ) && ! current_user_can( 'administrator' ) ) : ?>\n                                <?php if ( isset( $_COOKIE['course_submit_for_review'] ) && ! $instructor_can_publish ) : ?>\n                                    <div class=\"tutor-alert tutor-alert-info\">\n                                        <?php esc_html_e( 'Your course has been submitted to the admin. It will be published once it has been reviewed by the admins.', 'edumall' ); ?>\n                                    </div>\n                                <?php endif; ?>\n                            <?php endif; ?>\n                            <!--alert message end -->\n\n                            <?php do_action( 'tutor/dashboard_course_builder_form_field_before' ); ?>\n\n                            <div class=\"tutor-course-builder-section tutor-course-builder-info\">\n                                <div class=\"tutor-course-builder-section-title\">\n                                    <h3>\n                                        <i class=\"tutor-icon-down\"></i><span><?php esc_html_e( 'Course Info', 'edumall' ); ?></span>\n                                    </h3>\n                                </div> <!--.tutor-course-builder-section-title-->\n                                <div class=\"tutor-course-builder-section-content\">\n                                    <div class=\"tutor-frontend-builder-item-scope\">\n                                        <div class=\"tutor-form-group\">\n                                            <label><?php esc_html_e( 'Course Title', 'edumall' ); ?></label>\n                                            <input type=\"text\" name=\"title\"\n                                                   value=\"<?php echo esc_attr( get_the_title() ); ?>\"\n                                                   placeholder=\"<?php esc_attr_e( 'ex. Learn photoshop CS6 from scratch', 'edumall' ); ?>\">\n                                        </div>\n                                    </div> <!--.tutor-frontend-builder-item-scope-->\n\n                                    <div class=\"tutor-frontend-builder-item-scope\">\n                                        <div class=\"tutor-form-group\">\n                                            <label> <?php esc_html_e( 'Description', 'edumall' ); ?></label>\n                                            <?php\n                                            $editor_settings = array(\n                                                'media_buttons' => false,\n                                                'quicktags'     => false,\n                                                'editor_height' => 150,\n                                                'textarea_name' => 'content',\n                                            );\n                                            wp_editor( $post->post_content, 'course_description', $editor_settings );\n                                            ?>\n                                        </div>\n                                    </div>  <!--.tutor-frontend-builder-item-scope-->\n\n                                    <?php do_action( 'tutor/frontend_course_edit/after/description', $post ); ?>\n\n                                    <div class=\"tutor-frontend-builder-item-scope\">\n                                        <div class=\"tutor-form-group\">\n                                            <label>\n                                                <?php esc_html_e( 'Choose a category', 'edumall' ); ?>\n                                            </label>\n                                            <div class=\"tutor-form-field-course-categories\">\n                                                <?php //echo tutor_course_categories_checkbox($course_id);\n                                                echo tutor_course_categories_dropdown( $course_id, array( 'classes' => 'tutor_select2' ) );\n                                                ?>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <div class=\"tutor-frontend-builder-item-scope\">\n                                        <div class=\"tutor-form-group\">\n                                            <label>\n                                                <?php esc_html_e( 'Choose a tag', 'edumall' ); ?>\n                                            </label>\n                                            <div class=\"tutor-form-field-course-tags\">\n                                                <?php //echo tutor_course_tags_checkbox($course_id);\n                                                echo tutor_course_tags_dropdown( $course_id, array( 'classes' => 'tutor_select2' ) );\n                                                ?>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <?php\n                                    $monetize_by = tutils()->get_option( 'monetize_by' );\n                                    if ( $monetize_by === 'wc' || $monetize_by === 'edd' ) {\n                                        $course_price    = tutor_utils()->get_raw_course_price( get_the_ID() );\n                                        $currency_symbol = tutor_utils()->currency_symbol();\n\n                                        $_tutor_course_price_type = tutils()->price_type();\n                                        ?>\n                                        <div\n                                            class=\"tutor-frontend-builder-item-scope tutor-frontend-builder-course-price\">\n                                            <div class=\"tutor-form-group\">\n                                                <label><?php esc_html_e( 'Course Price', 'edumall' ); ?></label>\n                                                <div class=\"tutor-row tutor-align-items-center\">\n                                                    <div class=\"tutor-col-auto\">\n                                                        <label for=\"tutor_course_price_type_pro\"\n                                                               class=\"tutor-styled-radio\">\n                                                            <input id=\"tutor_course_price_type_pro\" type=\"radio\"\n                                                                   name=\"tutor_course_price_type\"\n                                                                   value=\"paid\" <?php $_tutor_course_price_type ? checked( $_tutor_course_price_type, 'paid' ) : checked( 'true', 'true' ); ?> >\n                                                            <span></span>\n                                                            <div class=\"tutor-form-group\">\n                                                            <span\n                                                                class=\"tutor-input-prepand\"><?php echo esc_html( $currency_symbol ); ?></span>\n                                                                <input type=\"text\" name=\"course_price\"\n                                                                       value=\"<?php echo esc_attr( $course_price->regular_price ); ?>\"\n                                                                       placeholder=\"<?php esc_attr_e( 'Set course price', 'edumall' ); ?>\">\n                                                            </div>\n                                                        </label>\n                                                    </div>\n                                                    <div class=\"tutor-col-auto\">\n                                                        <label class=\"tutor-styled-radio\">\n                                                            <input type=\"radio\" name=\"tutor_course_price_type\"\n                                                                   value=\"free\" <?php checked( $_tutor_course_price_type, 'free' ); ?> >\n                                                            <span><?php esc_html_e( 'Free', 'edumall' ); ?></span>\n                                                        </label>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div> <!--.tutor-frontend-builder-item-scope-->\n                                    <?php } ?>\n\n                                    <div class=\"tutor-frontend-builder-item-scope\">\n                                        <div class=\"tutor-form-group\">\n                                            <label>\n                                                <?php esc_html_e( 'Course Thumbnail', 'edumall' ); ?>\n                                            </label>\n                                            <div\n                                                class=\"tutor-form-field tutor-form-field-course-thumbnail tutor-thumbnail-wrap\">\n                                                <div class=\"tutor-row tutor-align-items-center\">\n                                                    <div class=\"tutor-col-5\">\n                                                        <div class=\"builder-course-thumbnail-img-src\">\n                                                            <?php\n                                                            $builder_course_img_src = tutor()->url . 'assets/images/placeholder-course.jpg';\n                                                            $_thumbnail_url         = get_the_post_thumbnail_url( $course_id );\n                                                            $post_thumbnail_id      = get_post_thumbnail_id( $course_id );\n\n                                                            if ( ! $_thumbnail_url ) {\n                                                                $_thumbnail_url = $builder_course_img_src;\n                                                            }\n                                                            ?>\n                                                            <img src=\"<?php echo esc_url( $_thumbnail_url ); ?>\"\n                                                                 class=\"thumbnail-img\"\n                                                                 data-placeholder-src=\"<?php echo esc_url( $builder_course_img_src ); ?>\">\n                                                            <a href=\"javascript:;\"\n                                                               class=\"tutor-course-thumbnail-delete-btn\"\n                                                               style=\"<?php echo esc_attr( sprintf( 'display: %s;', $post_thumbnail_id ? 'block' : 'none' ) ); ?>\">\n                                                                <i class=\"tutor-icon-line-cross\"></i>\n                                                            </a>\n                                                        </div>\n                                                    </div>\n\n                                                    <div class=\"tutor-col-7\">\n                                                        <div class=\"builder-course-thumbnail-upload-wrap\">\n                                                            <p class=\"builder-course-thumbnail-guide-line\">\n                                                                <?php echo sprintf( __( \"Important Guideline: %1\\$s 700x430 pixels %2\\$s %3\\$s File Support: %1\\$s .jpg, .jpeg, .gif, or .png %2\\$s no text on the image.\", 'edumall' ), \"<strong>\", \"</strong>\", \"<br>\" ); ?>\n                                                            </p>\n                                                            <input type=\"hidden\" id=\"tutor_course_thumbnail_id\"\n                                                                   name=\"tutor_course_thumbnail_id\"\n                                                                   value=\"<?php echo esc_attr( $post_thumbnail_id ); ?>\">\n                                                            <a href=\"javascript:void(0);\"\n                                                               class=\"tutor-course-thumbnail-upload-btn tutor-button bordered-button\"><?php esc_html_e( 'Upload Image', 'edumall' ); ?></a>\n                                                        </div>\n                                                    </div>\n                                                </div>\n\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <?php do_action( 'tutor/dashboard_course_builder_form_field_after', $post ); ?>\n\n                            <div class=\"tutor-form-row tutor-form-submit\">\n                                <div class=\"tutor-form-col-12\">\n                                    <div class=\"tutor-form-group\">\n                                        <div class=\"tutor-form-field tutor-course-builder-btn-group\">\n                                            <button type=\"submit\" class=\"tutor-button btn-save-as-draft\"\n                                                    name=\"course_submit_btn\"\n                                                    value=\"save_course_as_draft\"><?php esc_html_e( 'Save course as draft', 'edumall' ); ?></button>\n                                            <?php if ( $can_publish_course ) :  ?>\n                                                <button class=\"tutor-button tutor-success\" type=\"submit\"\n                                                        name=\"course_submit_btn\"\n                                                        value=\"publish_course\"><?php esc_html_e( 'Publish Course', 'edumall' ) ; ?></button>\n                                            <?php else : ?>\n                                                <button class=\"tutor-button tutor-success\" type=\"submit\"\n                                                        name=\"course_submit_btn\"\n                                                        value=\"submit_for_review\"><?php esc_html_e( 'Submit for Review', 'edumall' );  ?></button>\n                                            <?php endif; ?>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"col-lg-4\">\n                        <div class=\"tutor-course-builder-upload-tips tm-sticky-column\">\n                            <h3 class=\"tutor-course-builder-tips-title\">\n                                <i class=\"far fa-lightbulb-on\"></i><?php esc_html_e( 'Course Upload Tips', 'edumall' ); ?>\n                            </h3>\n                            <ul>\n                                <li><?php esc_html_e( 'Set the Course Price option or make it free.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Standard size for course thumbnail is 700x430.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Video section controls the course overview video.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Course Builder is where you create & organize a course.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Add Topics in the Course Builder section to create lessons, quizzes, and assignments.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Prerequisites refers to the fundamental courses to complete before taking this particular course.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Information from the Additional Data section shows up on the course single page.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Make Announcements to notify any important notes to all enrolled students at once.', 'edumall' ); ?></li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </form>\n\n\n\n<?php do_action( 'tutor/dashboard_course_builder_after' ); ?>\n\n<?php do_action( 'tutor_load_template_after', 'dashboard.create-course', null ); ?>\n\n<?php\nget_tutor_footer( true );\n\n\nA: This will restrict all users, except admins to edit a post after one day. You can, however, change the allowed user roles or time by simply tweaking the code.\nfunction wpse405644_restrict_editing() {\n    \n    $screen = get_current_screen();\n    if ( $screen->base == 'post' && $screen->post_type == 'courses' ) {\n        $post = get_post($_GET['post']);\n        $user = wp_get_current_user();\n        if ( !in_array( 'administrator', $user->roles ) ) {\n            if ( $post->post_status == 'publish' && (strtotime( $post->post_date ) < strtotime( '-1 day' )) ) {\n                wp_die( 'You are not allowed to edit this post.');\n            }\n        }\n    }\n}\nadd_action( 'current_screen', 'wpse405644_restrict_editing' );  \n\nYou may need to change the CPT with your own.\nEDIT (Frontend Restriction)\nThis code goes in your theme's functions.php.\nfunction wpse405644_is_frontend_editing_allowed () {\n    \n    if ( isset($_GET['course_ID']) && !empty($_GET['course_ID']) ) {\n        $post = get_post($_GET['course_ID']);\n        $user = wp_get_current_user();\n        if ( !in_array( 'administrator', $user->roles ) ) {\n            if ( $post->post_status == 'publish' && (strtotime( $post->post_date ) < strtotime( '-1 day' )) ) {\n                return false;\n            }\n        }\n    }\n    \n    return true;\n}\n\nNow at the create course template, wrap the whole content section with the conditional function.\n<?php\ndefined( 'ABSPATH' ) || exit;\n\nget_tutor_header( true );\n\n    if ( wpse405644_is_frontend_editing_allowed() ) {\n        \n        // The content BETWEEN get_tutor_header and get_tutor_footer goes here.\n        \n        \n    } else {\n        echo '<h2>You are not allowed to edit this post.</h2>';\n    }\n<?php get_tutor_footer( true );\n\nThis will show a message when the user isn't allowed to edit course.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405644", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: *Just curious* I erroneously used hook add_action() instead of add_filter() and there was no error and the result was correct. Why is that? While working on a project I used the incorrect hook type add_action() which does not exist, yet there was no error notice and the correct result returned. I only realized it was wrong while searching for the method along with the $hook_name name in the package and it was not found, and when I checked the code reference page, it showed that it is add_filter().\nWhy does it still work?\n\nA: add_action() uses add_filter() behind the hood.\nfunction add_action( $hook_name, $callback, $priority = 10, $accepted_args = 1 ) {\n    return add_filter( $hook_name, $callback, $priority, $accepted_args );\n}\n\nSource: https://developer.wordpress.org/reference/functions/add_action/\nSo basically it doesn't matter if you use add_filter or add_action.\nBut it doesn't mean you should, using the appropriate function for a event will make your code easier to follow and understand, if you always use add_filter or add_action for every single event it can create a lot of confusion.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405647", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: The wp_blogmeta table is not installed. Please run the network database upgrade We\u2019re using WP Engine for web hosting.\nI originally manually turned on Multisite through wp-config.php & Tools > Network Setup.\nSince then, I've learned we need to use their Enable Multisite function to enable subdirectory multisite.\nWhen WP_DEBUG is on, we see a message:\n\nNotice: wp_check_site_meta_support_prefilter was called incorrectly. The wp_blogmeta table is not installed. Please run the network database upgrade.\n\nI then created wp_blogmeta manually using:\nCREATE TABLE IF NOT EXISTS wp_blogmeta (\nmeta_id bigint(20) unsigned NOT NULL AUTO_INCREMENT,\nblog_id bigint(20) NOT NULL DEFAULT \u20180\u2019,\nmeta_key varchar(255) COLLATE utf8mb4_unicode_520_ci DEFAULT NULL,\nmeta_value longtext COLLATE utf8mb4_unicode_520_ci,\nPRIMARY KEY (meta_id),\nKEY meta_key (meta_key(191)),\nKEY blog_id (blog_id)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_520_ci AUTO_INCREMENT=1;\n\nIf I run the network database upgrade, the error remains.\nHow do I populate/\u201dinstall\u201d this table?\nEDIT: WP Engine say they do not support issues with Multisite, so they're unable to help me resolve this.\nOur wp-config.php contains:\ndefine('MULTISITE', true);\ndefine('SUBDOMAIN_INSTALL', false);\ndefine('DOMAIN_CURRENT_SITE', 'example.com');\ndefine('PATH_CURRENT_SITE', '/');\ndefine('SITE_ID_CURRENT_SITE', 1);\ndefine('BLOG_ID_CURRENT_SITE', 1);\n\ndefine('ADMIN_COOKIE_PATH', '/'); \ndefine('COOKIE_DOMAIN', ''); \ndefine('COOKIEPATH', ''); \ndefine('SITECOOKIEPATH', '');\n\nWe're using WordPress 6.0.\n\nA: This was an error on an older version of WordPress, version 5.1 (Core Issue #46167). Do you use the last stable version of WordPress?\nBut try the following options to solve the problem.\nInstall again, Core or WP CLI\nCopy all files from the core again in your installation, like via sFTP, especially all files in the directories wp-inlcudes and wp-admin. Run the installation again. Alternate if you have the possibility with the usage of WP CLI wp core update-db --network.\nUpgrade again\nGo in your installation to the URL wp-admin/network/upgrade.php and perform the upgrade again.\nManual\nCreate the table or check your manual steps for this creation\nCREATE TABLE $wpdb->blogmeta (\n    meta_id bigint(20) unsigned NOT NULL auto_increment,\n    blog_id bigint(20) NOT NULL default '0',\n    meta_key varchar(255) default NULL,\n    meta_value longtext,\n    PRIMARY KEY  (meta_id),\n    KEY meta_key (meta_key($max_index_length)),\n    KEY blog_id (blog_id)\n) $charset_collate;\n\nNow look at the table wp_sitemeta, field site_meta_supported and set the value to 1. Background is, WP looks via is_site_meta_supported() for this value to use the table.\n\nA: I noticed I was only getting the error for certain subsites.  I had run the Network Upgrade successfully multiple times, but when I went directly to the subsite upgrade page like at mysite.com/subsites/wp-admin/upgrade.php\nand then ran the database upgrade that made the errors go away for me. (I had to do that for each subsite that was creating errors)\nI also still do not have a wp_blogmeta table, but no more errors.\nThis was running wp version 5.9.3.\n\nA: The URL to access the network database update is\nhttps://www.website.test/wp-admin/network/upgrade.php\nOr the location to where /wp-admin/ is installed plus /network/upgrade.php- as commenters have mentioned - I would reach out to WP Engine though - as you may have done something unexpected by adding those tables yourself.\nNow might be a good time to check your backup processes have been working correctly too :-)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405649", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Maximum image width/height? If uploading a big image, WP will decrease the dimension and add -scaled to the file. How can I get what is its max limit?\n5000x5000 => it can't be greater than X so WP will make it smaller than X. How can I find the X?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405652", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WooCommerce Subscriptions: Hide one variation subscription Woocommerce subscriptions | All Products for WooCommerce Subscriptions\nDoes anyone know if there's a way to disable the subscribe option for a specific product variation?\ni.e. product with 2x attributes: attr-1, attr-2\nAll of which can be bought singly or via a sub on the PDP, is there a way to disable the subscribe option for one of the attributes?\nThere's no succinct way using the wcsatt_product_subscription_scheme filter without a lot of JS logic.\nHave reached out to WC and would love to give back if there's a more a elegant solution\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405654", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Empty Pdf file generated with FPDF library in WordPress plugin I am currently implementing a pdf export functionality within a wordpress plugin i'm developing but the pdf file generated when i click on export button is empty. To implement the export i use FPDF library\nIve put the code which uses FPDF in a function which is executed by the wp_ajax_ action hook. Here is the code:\n<?php\n\nrequire_once plugin_dir_path( __FILE__ ) . 'fpdf/fpdf.php';\n\nfunction pdf_pull_wpse_212972() {\n\n  $pdf = new FPDF('p','mm','a4');\n  $pdf->SetFont('arial','b',14);\n  $pdf->AddPage();\n  $pdf->Cell(40,10,'Referrer URL',1,0,'C');\n  $pdf->Cell(40,10,'User IP Address',1,0,'C');\n  $pdf->Cell(40,10,'User Agent',1,0,'C');\n  $pdf->Cell(40,10,'Browser',1,0,'C');\n  $pdf->Cell(40,10,'OS',1,0,'C');\n  $pdf->Output();\n\n  wp_die();\n\n}\n\nadd_action('wp_ajax_pdf_pull','pdf_pull_wpse_212972'); \n\n\nHere is the jQuery code executed when i click on the export button\njQuery(document).ready(function($) {\n\n  \n  jQuery('#pdf-export-btn').click(function(){\n\n    var data = {\n      'action': 'pdf_pull',\n    };\n    \n    jQuery.post(tclisecure.ajax_url, data, function(response) {\n\n\n        var downloadLink = document.createElement(\"a\");\n        var fileData = [response];\n\n        var blobObject = new Blob(fileData,{\n            type: \"application/pdf\"\n          });\n\n        var url = URL.createObjectURL(blobObject);\n        downloadLink.href = url;\n        downloadLink.download = \"tracked_info.pdf\";\n\n        /*\n        * Actually download PDF\n        */\n        document.body.appendChild(downloadLink);\n        downloadLink.click();\n        document.body.removeChild(downloadLink);\n      \n    });\n\n  });\n\n\n});\n\n\nA: This might not solve the problem, but what you're currently doing looks unnecessarily convoluted (ajax request, fake link, serve PDF via link click etc.)\nWhy not just a link styled as a button...\n<a class=\"button\" href=\"<?= admin_url( 'admin-post.php?action=wpse_212972_pdf' ) ?>\">Download</a>\n\n...and then serve the PDF as a download directly from the server (using WP's generic POST/GET handler admin-post.php):\nfunction wpse_212972_pdf() {\n    $pdf = new FPDF('p','mm','a4');\n    $pdf->SetFont('arial','b',14);\n    $pdf->AddPage();\n    $pdf->Cell(40,10,'Referrer URL',1,0,'C');\n    $pdf->Cell(40,10,'User IP Address',1,0,'C');\n    $pdf->Cell(40,10,'User Agent',1,0,'C');\n    $pdf->Cell(40,10,'Browser',1,0,'C');\n    $pdf->Cell(40,10,'OS',1,0,'C');\n\n    // http://www.fpdf.org/en/doc/output.htm\n    $pdf->Output( 'D', 'tracked_info.pdf' );\n    exit;\n}\n\nadd_action( 'admin_post_wpse_212972_pdf', 'wpse_212972_pdf' );\n\n// Non-logged-in users (remove if not required)\nadd_action( 'admin_post_nopriv_wpse_212972_pdf', 'wpse_212972_pdf' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405655", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I create a custom page for this error? How can I create a custom page for this too many connections error page because I know it's because my server is overloaded? I wanted to show a custom error page instead of this when my website is overloaded by traffic.\n\n\nA: Check out the source of dead_db() which powers the message.\nYou'll see that you can create a file db-error.php in your WP content directory (which by default is /wp-content/) and it'll load that instead!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405656", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: How to inherit field value from parent post into in child / sub post I have created a custom post type, called 'centres'. This CPT is hierarchical, ie, I can create child pages under each custom post.\nCentre1\n\n*\n\n*Location1\n\n*Contact1\n\nCentre 2\n\n*\n\n*Location2\n\n*Contact2\n\nI've defined a custom field called phone_number. This field is populated at the 'parent' level.  Ie, Centre1, Centre2.\nI want to display the phone number on each child page. I don't want to have to add the phone number every time to each page, so would like to get or inherit the phone_number field from its parent.\nSimply speaking, I'd like to just add the shortcode [acf field=\"phone_number\"] in any given child page (eg, contact page) and have it pull the values from it's parent.\nI've searched everywhere, but can't find a solution.  I'm a novice wordpress user (not a php developer).  Is there code I can add into my functions.php file that can get the values of a particular field (or all fields) from the parent?\nMuch appreciated.\n\nA: You can use get_post_field( 'post_parent' ) to get the parent ID of the current post.\nWhilst ACF is technically off-topic, FWIW you can pass the ID of a post as the second parameter to get_field.\nCombined together we can fashion a shortcode centre_field that will return any field value for the post's parent. I've skipped the need for an attribute name as I think the shortcode looks a little cleaner...\ne.g. [centre_field phone_number]\nAnd the code behind it:\nfunction wpse_405660_centre_field( $atts ) {\n    // Just grab the first value of the attribute array\n    $field_name = current( $atts );\n\n    $parent_id = get_post_field( 'post_parent' );\n\n    return get_field( $field_name, $parent_id );\n}\n\nadd_shortcode( 'centre_field', 'wpse_405660_centre_field' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405660", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can we intercept user_login and user_pass from a wp_login_form? with my plugin, I have a login form. I use the wp_login_form() function of Wordpress.\nAs you know, this function links to the wp-login page. But if the user_login is not present or if the email is empty in the database, an error will be present.\nMy users come from an external database. Imagine the following situation: A user from my external database connects for the first time on the site, so he is not in the wp_users table of Wordpress.  When he goes to submit, I would like him to add the user in the wp_users table before being logged in because he exists in my external database.\nDo you have an idea for the interception, or for another way to do it?\nThanks in advance for the answers\n\nA: Thanks @Buttered_Toast !\nThe answer was to use the wp_authenticate hook and put my custom function as argument. I should have thought about it...\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405662", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: For each loop on every word in post I'm having a recipe site where every post naturally contains ingredients. Every ingredient is a tag, and I would like to automatically link every ingredient so the user can click on it and see all recipes that uses that certain ingredient.\nFor this to be possible I guess I have to loop through every word in the post, then check if that word is equal to an existing tag, and wrap that word in a hyperlink. But I'm not sure that's the most efficient solution.\nDo anyone of you have any suggestions here?\n\nA: Are you sure you want to link every instance of each ingredient? As a user, I wouldn't mind if the ingredient list above the recipe had all its ingredients linked, but if the following instructions continued linking every ingredient I'd find that to be a lot of links I could accidentally tap on and lose the recipe.\nIf you're using the Block Editor, you could use the Tag List block to list the ingredients wherever in the recipe posts you need them. (Optionally you could add a block style to style them differently if you like.) If you're not using the Block Editor, you might want to set up a custom template for recipes, so that the template automatically creates an ingredients section between the recipe title and the rest of the content and outputs the tags there. If you're tagging anything besides ingredients, you could create a custom taxonomy so you're only outputting ingredients and not other unrelated tags.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405665", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Having a repeating custom field in admin custom post type, what I'd go better with, for DB's sake? ACF repeater or query a different post type? I have:\nA main custom post type - 'Cards' - each post showing its ACF repeater custom field - 'operations' - with the following sub-fields: 'add/remove', 'amount, 'value', 'date'.\nLet's say the fully operational website will have 500 Cards posts, with about 50/100 operation rows each.\nWhat would be the less stressing solution, to keep querys and Database load reasonable?\n\n*\n\n*Keeping my first choice and use custom fields with ACF repeater, inside the Cards posts.\n\n*Creating a dedicated custom post type 'operations', one new post for every single repeated row, and query all the related 'operations' post from within the 'Card' post they belong to.\n\n\nCard post & operation as ACF repeater fields:\n\n    Card[post]\n            operation [custom fields]\n            operation [custom fields]\n            operation [custom fields]\n    ...\n    Card\n    Card\n\n\nCard post & Operation as post:\n\n    Card[post]\n            {wp_query all the related operation[post], return operation[post] fields}\n    ...\n    Card\n    Card\n\n    Operation[post]\n            [custom fields]\n            [custom fields]\n            [custom fields]\n    ...\n    Operation\n    Operation\n\n\nAny suggestion will be most appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405669", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to crop thumbnail size, from both width and height sides I would like to crop in particular dimensions but I need that to be done on both height and width of the image. Here is a small illustration of what I am trying to do:\n\nWhen I try to use this snippet:\nadd_image_size( 'custom-thumbnail', 160, 160, true);\n\nor even\nadd_image_size( 'custom-thumbnail', 160, 160, array( 'center', 'center' ));\n\nit only crops the horizontal side and so this is what I get:\n\nAnd this is what needs to be achieved:\n\nIs there any way to do that in WordPress? I made a lot of searches on Google but without success.\nThank you in advance for your help.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405671", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP_Query retuning empty array in rest api I recently started writing a rest api for my plugin. I need to access some custom posts however WP_Query is returning an empty array when I'm querying the db.\nThere is the custom post type declaration.\n\n// custom post type declaration\nadd_action('init', 'register_plugin_custom_post_type');\nfunction register_plugin_custom_post_type() {\n    register_post_type('my_post_type', \n        [\n            'label' => \"A name\",\n            'StackExchange exemple',\n            'public' => false,\n            'show_in_rest' => true\n        ]);\n}\n\nRest api route registration\n\nadd_action('wp_rest_init', 'my_plugin_rest_init_callback');\nfunction my_plugin_wp_rest_callback() {\n    register_rest_route('my-rest-route', '/endpoint', \n        [\n            'method' => 'GET',\n            'callback' => 'rest_api_callback',\n            'permission_callback' => function() {\n                return current_user_can('manage_options');\n            }\n        ]);\n}\n\nThe rest api callbacks\n\n// Rest api callback using wp_query\nfunction rest_api_callback() {\n    $args = [\n        'post_type' => 'my_post_type'\n    ];\n\n    $query = new WP_Query($args);\n\n    // Here $posts is empty \n    $posts = $query->get_posts();\n}\n\n\n// same function using wpdb\nfunction rest_api_callback() {\n    global $wpdb;\n    $table = \"{$wpdb->prefix}posts\";\n    $query = \"SELECT ID FROM $table WHERE post_type='my_post_type';\"\n\n    // Here $post_ids is [ 0 => ID0, 1 => ID1, ..., n => IDn]\n    $post_ids = $wpdb->get_col($query);\n}\n\nIs there is a way to use wp_query in the WordPress rest api ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405672", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Product count in archive page Title in WooCommerce How to show in the archive page TITLE, the number of products, in WooCommerce?\nThanks!\n\nA: add_filter( 'woocommerce_page_title', 'add_products_number_to_category_title', 99, 1 );\nfunction add_products_number_to_category_title($title) {\n    if ( ! is_product_category() ) {\n        return $title;\n    }\n    \n    $products_count = get_queried_object()->count;\n    \n    return $title . ' (' . esc_html( $products_count ) . ')';\n} \n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405674", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Comment Table Size Results in Slow Page Loads and 500 Errors I manage a small site that has a very active comment area. The site is on shared hosting. There is a daily post entry, then a robust comment area. It is not untypical to have more than 100 comments on a day's post.\nThe result is that loading or refreshing the current day's page is very slow - up to or more than 30 seconds. Sometimes a page load will time out with a 500 error. Other times a comment 'submit' will result in a 500 error, and the comment is lost.\nThe site gets under 5K visits a day, with less than 30 concurrent users during the day. Some of those visits are individuals re-loading the page to see the latest comments.\nLately, the search engines have been indexing the site. I see this in the GA real-time monitor as page loads from past years. Each search index page load also displays that day's comments, which put an additional load on the comment query for that page.\nThe daily comments area is a popular feature of the site, so do not want to disable that. The increased costs in changing from a shared server to a dedicated server are not possible (there is no revenue generated for the site). Blocking specific search engines via the robots.txt or htaccess files won't work - the search engine locations are variable and change. The theme uses the standard loop for displaying the comments.\nI tried a caching plugin (WP Cache), but it didn't seem to reduce the page load time. (Not to mention that it shortened the 'remember me' in the comment entry form to 1 day, which irritated the commenters and me.)\nSo what is the best way to increase the 'efficiency' of the site's page load time with the active discussion environment on the site?\nAdded\nI have used the Query Monitor plugin to look at query times. It still seems that the queries related to the comments table are the main issue in slowing down page response. (Page response takes about 8-10 seconds to show a page with comments.)\nSplitting the comments into pages irritated the regular visitors on the site. And it didn't seem to improve page load time.\nWould partitioning the comments table help? Only the comments from the last 5 days need optimization. I don't worry about search indexing time to get old posts. Just the response time for looking at the latest post.\nOr is there an additional index that might be added to the comments table to make it's queries more efficient?\n\nA: The solution to the issue of slow queries on a site that has a very active comment 'gang' (there are over 150K comments on that site, with about 50-100 added each day) (sort of a long answer, but the details might help others):\nThe first step was to ask the hosting company to move the shared hosting to another, more efficient server. Since this site has been around for many years, it's possible it was still on it's original server, with more powerful servers available after the sites' hosting was started. This is just speculation, though.\nBut a move to a newer server improved overall response times, so pages wouldn't time out, but database queries will still slow. According to the WP Query plugin, the typical page load of the current page had about 80-90 queries, with a query time of about 11-15 seconds. These numbers were consistent over several days.\nSo, the next step was to see if the SQL server could be faster. Note that the database had already been optimized. An caching did not help, because of the number of comments added each day. (In fact, adding caching slowed things further, as the page was never 'static' enough for caching to be effective.)\nThe hosting company investigated, and (after suggesting the standard 'optimize your database' answer), determined that the new server was in a data center on one side of the country (US), and the SQL server in a different data center on the opposite side of the country.\nThe hosting company moved the database to a newer, more powerful SQL server in the same data center as the hosting (shared) server.\nThis improved query response times from 11-15 seconds down to 1-3 seconds; a significant improvement.\nTo sum up:\n\n*\n\n*a more power shared server was used\n\n*the database was moved to a SQL server in the same data center as the shared server\n\nAfter one day on the new SQL server, the changes have apparently resolved the issue of slow page loads, slow queries, and timeouts (including 500 errors).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405675", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Locking Down Wordpress Application Password Permissions / Capabilities I am working on a Wordpress installation where we recently decoupled the frontend into a NextJS application that is no longer hosted on the same domain as the admin. We are accessing data etc through the API.\nThat's been fine for non-logged in users viewing posts etc. But recently we realized that the \"preview post\" functionality has been broken, because users who are logged in on the admin side are no longer logged in on the frontend. So they can't preview posts they're working on.\nTo preview posts via the WP API, you have to authenticate to it. It seemed like an Application Password was the best solution for this. However, I don't want to grant any permissions to the Application Password except the ability to preview posts (that's the edit_others_posts permission).\nSo I created a special role with only the edit_others_posts capability, and attached to Application Password to a user with that role.\nUnfortunately I'm still able to do a lot more with it that I'd like. I can list users, for example - that's a capability that's usually reserved only for Admins and Super admins. I can see tags and taxonomies, I can create a post - but not delete it. I can't view / manage plugins or settings, or view the application passwords of the super admin user, so that's bit of a relief.\nI just don't know how to get my hands around what this password allows and how to manage it securely. But this video seems to suggest it's the preferred, secure way and has made things like JWT tokens obsolete.\nI've seen conflicting information out there - some blog posts saying that an Application Password only has as many permissions as the user it's attached to. But then I see the actual integration guide (from when they moved this functionality from a plugin to core) says that authentication scoping is a future feature they'd love to implement.\nWhere can I find information on how Application Password permissions are determined? And do I have any control whatsoever over what permissions are granted via an Application Password? This has been incredibly frustrating. Any help is greatly appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405679", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: How get custom field from custom taxonomy? I need to list all categories and their respective posts.\nEach taxonomy has an image created by ACF in jetengine plugin. I created the loop that returns the list of categories and posts for each category. But I can't capture the custom field from the taxonomy image. Can anyone give me some tips on how to do it?\nforeach($custom_terms as $custom_term) {\n        wp_reset_query();\n        $args = array('post_type' => 'post',\n            'tax_query' => array(\n                array(\n                    'taxonomy' => 'custom_tax',\n                    'field' => 'slug',\n                    'terms' => $custom_term->slug,\n                ),\n            ),\n         );\n         $loop = new WP_Query($args);\n         if($loop->have_posts()) {\n            echo '<h2>'.$custom_term->name.'</h2>';\n            while($loop->have_posts()) : $loop->the_post();\n                echo '<a href=\"'.get_permalink().'\">'.get_the_title().'</a><br>';\n            endwhile;\n         }\n    }\n}\n\nUPDATE:\nFollowing @Abhik tip, tip I was able to list the image of each category using the ACF plugin only for img.\nTaxonomy IMG\n\n*\n\n*List item (CPT item)\n\n*List item (CPT item)\n\n*List item (CPT item)\n\n*List item (CPT item)\n\nTaxonomy IMG\n\n*\n\n*List item (CPT item)\n\n*List item (CPT item)\n\n*List item (CPT item)\n\n*List item (CPT item)\n\nThat way I was able to create a really efficient dynamic menu. I appreciate the contribution of those who commented!\nI'm still open to suggestions for improvement.\nCode:\nadd_shortcode( 'list_terms_post_cod', 'list_terms_post_func' );\nfunction list_terms_post_func(){\n$custom_terms = get_terms('taxonomy');\n    foreach($custom_terms as $custom_term) {\n        wp_reset_query();\n        $args = array('post_type' => 'custom_post',\n            'tax_query' => array(\n                array(\n                    'taxonomy' => 'custom_term',\n                    'field' => 'slug',\n                    'terms' => $custom_term->slug,\n                ),\n            ),\n         );\n         $loop = new WP_Query($args);\n         $image = get_field( 'cat_image', $custom_term );\n\n         //Taxonomies Loop\n         if($loop->have_posts()) {\n            echo '<h2>'.$custom_term->name.'</h2>';\n            echo '<img src=\"'.$image.'\"/>';\n            \n            //Post loop\n            while($loop->have_posts()) : $loop->the_post();\n                echo '<a href=\"'.get_permalink().'\">'.get_the_title().'</a><br>';\n            endwhile;\n         }\n        wp_reset_postdata(); // reset global $post;\n    }\n\n}\n\n\nA: Since you are using ACF, you can take advantage of the get_field() function ACF provides.\nYou will need to pass the term object as the second parameter.\n$image = get_field( 'field_key', $custom_term );\n\n\nA: The thumbnail is probably stored in the termmeta table using a meta key specified the jetengine plugin, which is out of scope here.\nYou should be able to identify the key by querying the DB for one of the category terms. Assuming one of the category terms has and ID of 13 and the default WP table prefix is used, you can query the termmeta like this:\nSELECT * FROM wp_termmeta where term_id = 13;\nOnce you've identified the meta key that stores the image, you can use WP's get_term_meta() function to get the meta value containing the image. Then it's just a matter of outputting the value in an image tag.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405683", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: Change the destination of the URLs in post.php The post.php screen lists posts vertically in the admin area [and other post types]. Each item's post_title is a hyperlink, directly above some inline choices. Both the title link, and the \"Edit\" inline selection, redundantly go to the same destination, namely:\nhttp[s]://{yoursite.tld}/wp-admin/post.php?post={postID}&action=edit\n\n\nI want to filter the post_title URL href using PHP. Specifically, I want to set a custom destination to the URL, based on metadata stored in the post.\ni.e post_ID:123 has post meta data:\n{'custom_URL' : 'http:somesite.com'}\n\nIn post.php, how can I change the post_title hyperlink href destination URL, to a custom destination - preferably with PHP?\nI'll need to somehow intercept the main query loop within post.php, because I need to do a metadata query for each of the displayed items, based on their postID. Which could be 1-200 things, generally. I could use JS to fetch the post IDs, and then do an API call(s) to the server from the browser, but I'd rather filter it from PHP before it's emitted.\n\nA: The post title and inline \"Edit\" links in the posts list table at wp-admin/edit.php uses get_edit_post_link() which applies a filter hook also named get_edit_post_link, so if (I correctly understood that) you want to modify those links (URL), you can use that filter. E.g.\n// Note: The callback will run anywhere, not just at wp-admin/edit.php\nadd_filter( 'get_edit_post_link', 'my_filter_edit_post_link', 10, 2 );\nfunction my_filter_edit_post_link( $link, $post_id ) {\n    $url = get_post_meta( $post_id, 'custom_URL', true );\n\n    // it's all up to you on what params to add to the custom URL\n    return $url ? add_query_arg( 'post', $post_id, $url ) : $link;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405684", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to rewrite URL back to default custom URL if no destination found My current situation is:\nI'm redirecting the custom category request to below kind of url:\nhttp://my_url/news/category/abc\nI've managed to add my custom query var category and can get the query var now. The hook is as below:\nadd_filter('rewrite_rules_array', function ($rules) {\n    return\n        ['^news/?$' => 'index.php?post_type=news&page=1&category=all'] +\n        ['^news/category/(.+)/?$' => 'index.php?post_type=news&category=$matches[1]'] +\n        $rules;\n});\n\nUrl like http://my_url/news/category/abc now goes to archive-news.php and list all posts which has custom category abc.\nAnd url like http://my_url/news/lalala goes to single-news.php and display full content of post with title lalala.\nMy problem is:\nwhen url is http://my_url/news/category/ it goes to an empty page which I believe is t he 404.php.\nSeek solution\nI'm think about how to redirect it to http://my_url/news in my hook so it will automatically picks all as its default category.\nAll practical solutions are welcome. Thanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405690", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: PHP File_exist() not working - Checking if File Exist in WordPress Theme Directory I am trying to check if a certain archive file template exists in the WP theme directory. This is my code, I am not sure what I am missing here.\n<?php \n\n$file_name = '/archive.php';\n$base_template_dir = get_template_directory_uri();\n\n$file_uri = $base_template_dir.$file_name;\n$file_uri = str_replace('http://', '', $file_uri);\n$file_uri = str_replace('https://', '', $file_uri);\n\n$file_uri = str_replace($_SERVER['HTTP_HOST'], '', $file_uri);\n\nif (file_exists($file_uri)) {\n    echo 'File Found: '.$file_uri;\n} else {\n    echo 'File Not Found: '.$file_uri;\n}\n?>\n\n\nA: Most of this code is unnecessary. You're attempting to convert a URL to a path when you could just use the function that returns a path.\n$path = get_theme_file_path( 'archive.php' );\n\nif ( file_exists( $path ) ) {\n    echo 'File Found: '. $path;\n} else {\n    echo 'File Not Found: '. $path;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405691", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Cant upload larger than 100MB I am using DO Droplet 2gb RAM Shared CPU running apache. I cant upload files larger than 100MB in the Media Uploader but I can upload LOWER than 100mb. I already tried modifying php.ini and other stuffs like htaccess and wp-config.\n@ini_set( 'upload_max_filesize' , '512M' );\n@ini_set( 'post_max_size', '512M');\n@ini_set( 'memory_limit', '512M' );\n@ini_set( 'max_execution_time', '300' );\n@ini_set( 'max_input_time', '300' );\n\nphp.ini is also modified like the above. Media uploader on backend shows I can upload 512M but its just stuck in 1% or 0%. Tried uploading larger than 512M it shows an error.\nI tried also reinstalling BOOT IMAGE like Wordpress on Ubuntu and OpenLiteSpeed Wordpress and Suchs but still not working with the changed PHP.INI values and same.\nI was thinking that this is a wordpress problem as I tried other PHP Scripts and it uploads larger than 100M.\nHelp is appreciated. Thank you guys!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405692", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to replace WooCommerce Product Gallery Trigger icon using PHP/CSS? How can I modify the hook to change the glass icon to zoom? Or is there a way to do that via CSS avoiding replacing content via JS?\n\nA: Its more of a hack than actual solution. But, I am using it in a lot of themes without any issues.\n.woocommerce div.product div.images .woocommerce-product-gallery__trigger {\n    visibility: hidden;\n}\n.woocommerce div.product div.images .woocommerce-product-gallery__trigger::before {\n    visibility: visible;\n}\n.woocommerce div.product div.images .woocommerce-product-gallery__trigger::after {\n    visibility: visible;\n}\n\nPlease note I have removed the my styling from these psudo elements. You can now use any of the ::before or ::after psudo elements to make your own styles.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405693", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding google fonts to WordPress theme I am trying to add google fonts to a custom WordPress theme. Therefore I tried to enqueue selected three font faces at once to make it fast loading. So, I use the below codes to register and enqueue the same.\nwp_register_style('googlFonts', '//fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400;1,500;1,700&family=DM+Serif+Display&family=La+Belle+Aurore&display=swap');\nwp_enqueue_style('googlFonts');\n\nWhen I search via source code I can only see the last font. Other fonts are not loading. Even I can't see the same complete URL in the source code. Below is what I saw from the source code.\n\nCan anybody help me with this?\nThanks in advance\n\nA: Just remove version parameter.\nwp_register_style('googlFonts', '//fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400;1,500;1,700&family=DM+Serif+Display&family=La+Belle+Aurore&display=swap', array(), null);\nwp_enqueue_style('googlFonts');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405694", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using full site editing, can I edit just one specific post / page to be unique? Let's say I have a special news report post and I want it to have a unique title (so that on the archive page it has the original post title, but on the post page it has a different title that I can set) and maybe a different background color.\n\nBasically, what I'm trying to do is to deviate from the default single post template only for one specific post.\n\nIs this doable somehow? Or do I have to create a unique template just for that one post? Maybe there is a better way to do what I'm trying to do and I'm just confused?\n\nA: In your single template you could include a condition to print a different title\nSomething like\nif( 123 === get_the_ID() ) { // Add your special post ID here ?> \n    <h1>My custom title</h1>\n<?php } else { ?>\n    <h1><?php the_title(); ?></h1>\n<?php }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405699", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Post and page content not displaying in search results I am using a content-search.php template part to output my search results. The post/page titles and links to those posts/pages are working correctly, but for some reason the the_content() function is not rendering any HTML. I have tested for errors with debugging on, but nothing is displayed.\nHere is my content-search.php template code:\n<article id=\"post-<?php the_ID(); ?>\" <?php post_class(); ?>>\n  <header class=\"entry-header\">\n    <?php the_title( sprintf( '<h2 class=\"entry-title\"><a href=\"%s\" rel=\"bookmark\">', esc_url( get_permalink() ) ), '</a></h2>' ); ?>\n  </header><!-- .entry-header -->\n\n  <div class=\"entry-content\">\n    // No content from posts or pages is displayed using the_content function\n    <?php the_content(); ?>\n  </div><!-- .entry-content -->\n\n  <footer class=\"entry-footer\">\n    <?php flagstaffcounty_entry_footer(); ?>\n  </footer><!-- .entry-footer -->\n</article><!-- #post-<?php the_ID(); ?> -->\n\nHere is the search.php template code:\nget_header(); ?>\n<div class=\"content-and-sidebar\">\n  <main class=\"main\">\n    <?php get_search_form(); ?>\n    <?php if ( have_posts() ) : ?>\n      <?php while ( have_posts() ) :\n        the_post();\n        get_template_part( 'template-parts/content', 'search' );\n      endwhile;\n      the_posts_navigation();\n    else :\n      get_template_part( 'template-parts/content', 'none' );\n    endif;\n    ?>\n  </main><!-- main -->\n  <aside class=\"sidebar\">\n    <?php get_sidebar(); ?>\n  </aside><!-- aside -->\n</div><!-- .content-and-sidebar -->\n<?php get_footer();\n\nThe the_content function is working on all other templates on my site.\nUpdate\nIncluding offending iframe wrapper filter function for reference.\nfunction themename_iframe_wrapper($content) {\n  if( is_page() ) {\n    $pattern = '~<iframe.*</iframe>~';\n    preg_match_all($pattern, $content, $matches);\n\n    foreach ($matches[0] as $match) {\n      $wrappedframe = '<div class=\"iframe-container\">' . $match .   '</div>';\n      $content = str_replace($match, $wrappedframe, $content);\n    }\n    return $content;\n  }\n}\nadd_filter('the_content', 'themename_iframe_wrapper');\n\nAny ideas on what I am missing?\n\nA: The problem in your code is that your function is only returning the content when is_page() is true, which is not on the default search results page, where is_search() is true. Likewise, the content would also not be returned on singular post pages and anywhere where is_page() is not true.\nSo remember that a filter callback (like your themename_iframe_wrapper() function) must always return the content, just as with shortcode handler functions.\nfunction themename_iframe_wrapper($content) {\n  if( is_page() ) {\n    ... your code.\n    return $content; // don't just return it here\n  }\n\n  return $content; // always return the content\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405701", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Insert Custom Post Types I am learning WordPress plugin development. I need to insert Custom Post Type. I registered custom post type using register_post_type(). I am getting below Form when I would like to insert a New Csutom Post Types (News).\n\nHow can I customize this Form ?\nI would like to add some radio buttons and text fields here.\n\nA: You maybe want to add extra information fields, and settings for individual posts - single posts in CPT - Custom Post Types.\nOut of the box, WordPress gives us -\n\n*\n\n*\u2018title\u2019\n\n*\u2018editor\u2019 (content)\n\n*\u2018author\u2019\n\n*\u2018thumbnail\u2019 (featured image, current theme must also support\npost-thumbnails)\n\n*\u2018excerpt\u2019\n\n*\u2018trackbacks\u2019\n\n*\u2018custom-fields\u2019\n\n*\u2018comments\u2019 (also will see comment count balloon on edit screen)\n\n*\u2018revisions\u2019 (will store revisions)\n\n*\u2018page-attributes\u2019 (menu order, hierarchical must be true to show\nParent option)\n\n*\u2018post-formats\u2019 add post formats, see Post Formats\n\nActual Answer\nWordPress Team is very aware that you might want to add additional fields and that is where custom fields/meta box comes in.\nYou can use 'custom-fields' that also WordPress gives us but that is not that much intuitive. Rather people in general use metabox. You can go through this article to get a clear idea how metabox works - what is metabox and how to use it in WordPress\nBut it is something like reinventing the wheel. You can have some great solutions to your problem. And that is some plugin that you can include in your theme or plugin in no cost.\nThere are some popular metabox for you to inlcude in your themes or plugin.\nCMB2, Carbon fields, Advanced Custom Fields, metabox.io and many more.\nBut I would recommend or personally like carbon fields to include in the plugin or theme.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405703", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: using wp_insert_term to create custom terms for a custom taxonomy from frontend form, I have a form which allows certain roles to add custom terms to a taxonomy.\nMy taxonomy is called Genre (slug genre)\n<form method='post' enctype='multipart/form-data'>\n<input type=\"text\" value=\"\" name=\"new\">\n    <input type='submit' name='Save'>\n</form> \n\nI have been going around in circles with this for hours. Ive searched for other questions similar and have tried the suggestions.\nI am using https://wordpress.org/plugins/custom-post-type-ui/ to create the custom taxonomies - Was wondering maybe my script is firing before this plugin does and therefore wp_insert_terms happens before the register of the custom taxonomy?\nMy PHP:\nif(isset($_POST['save']) && !empty($_POST)) {\n\n    $term = ($_POST['new']);\n        \n    \n      $existent_term = term_exists( $term, 'genre' );\n\n    if( $existent_term && isset($existent_term['term_id']) ) {\n\n        $term_id = $existent_term['term_id'];\n\n    } else {\n\n        //insert the term if it doesn't exsit\n        $term = wp_insert_term(\n            $term, // the term \n            'genre' // the taxonomy\n        );\n        if( !is_wp_error($term ) && isset($term['term_id']) ) {\n             $term_id = $term['term_id'];\n        } \n\n   }\n\n} //end isset\n\nNothing shows in the error log either.\nHas anyone come across this issue before? or is anyone able the assist please\nIve tried things like setting $term = ($_POST['new']); to $term = \"music\"; and having the input value like  <input type=\"text\" value=\"music\" name=\"new\">\nAlso I have tried with an array\nwp_insert_term(\n    $term,   // the term \n    'genre', // the taxonomy\n    array(\n        'description' => 'I am description.',\n        'slug'        => 'music',\n       \n    )\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405705", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Additional navigation bar in header \nRecently, my site started showing two navigation bars at the top of my page.  They are also the wrong layout. I am fairly new to WordPress.  I have only designed five websites so far.  This is the first time I have encountered this issue.  I am editing through Elementor Pro, and this does not show up when I preview the page, but it shows up when you enter into the website itself.  How can this be fixed?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405706", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Table of contents (TOC) plugin is not showing header tag I made a post template using meta box(custom field). If I put data into metabox, the template part (contents with h2, h3, p) shows up at the bottom of post (not on post edit page). However, every TOC plugins use \"revisions\" to check if there is h2 or h3 like this code.\npublic function widget( $args, $instance ) {\n        global $ht_kb_toc_tools, $wp_query;\n\n        if( ! is_singular() )\n            return;\n\n        if ( ! isset( $wp_query ) ) {\n            return;\n        }\n\n\n        if( is_a($ht_kb_toc_tools, 'HT_KB_TOC_Tools') ){\n            if( $ht_kb_toc_tools->ht_block_toc_detected && apply_filters('ht_kb_toc_disable_on_ht_block_toc', true ) ){\n                //early exit if ht-block-toc detected\n                return;    \n            }                \n        }\n\n        extract( $args, EXTR_SKIP );\n\n        $instance = wp_parse_args( $instance, $this->defaults );\n\n        //$post = get_post( $wp_query->post->ID );\n        $post = get_post();\n\n        if( is_preview() ){\n            //get the post revisions\n            $post_revisions = ( wp_get_post_revisions( $post ) );\n\n            if ( !empty( $post_revisions ) ) {\n                //get the latest revision - this should be the current preview\n                $post = current( $post_revisions );\n            }\n        }\n\n        $title = apply_filters( 'widget_title', empty( $instance['title'] ) ? '' : $instance['title'], $instance, $this->id_base );   \n\n        if(is_a($ht_kb_toc_tools, 'HT_KB_TOC_Tools')){\n\n            //extract headings\n            $headings = $ht_kb_toc_tools->ht_kb_toc_extract_headings( do_shortcode( $post->post_content ), true ); \n\n            //don't output widget if no headings are in content\n            if(empty($headings))\n                return;\n\n            echo $before_widget;\n\n            if ( $title )\n                echo $before_title . $title . $after_title;\n\n\n            ?>\n            <nav id=\"navtoc\" role=\"navigation\">\n\n                \n\n            <?php\n            //display items\n            $ht_kb_toc_tools->ht_kb_display_items();\n            ?>\n\n            </nav>\n\n            <?php\n        }\n\n        echo $after_widget;\n\n    } // end widget\n\nIs there another way to check h2 or h3 beside checking revision? or is there a way that shows my metabox data show on post edit page? Thanks.\n\nA: Even if they're not looking at revisions, all table of contents plugins are likely to only look at post_content rather than postmeta, because postmeta can be anything and it would be hard to query for something that doesn't exist on every site.\nYour best bet may be to update your site to use the Block Editor. From there, you can create a custom block that displays the postmeta within the post_content. Then, some plugins may be able to pick up the heading tags - though some may still not, so you might want to first experiment with some other blocks that create heading tags that are not the Core Heading block to find a TOC plugin that picks those up.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405709", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display a specific category in a focused area of my site I've been trying to change the code of my WordPress site. Rather than showing \"trending posts\" which is determined by post_views_count, I simply want to show posts from a certain category. The code, as it stands is:\nif ( !function_exists( 'getCrunchifyPostViews' ) ) {\nfunction getCrunchifyPostViews($postID){\n    $count_key = 'post_views_count';\n    $count = get_post_meta($postID, $count_key, true);\n    if($count==''){\n        delete_post_meta($postID, $count_key);\n        add_post_meta($postID, $count_key, '0');\n        return \"0 View\";\n    }\n    return $count.' Views';\n  }\n}\n\nif ( !function_exists( 'setCrunchifyPostViews' ) ) {\nfunction setCrunchifyPostViews($postID) {\n    $count_key = 'post_views_count';\n    $count = get_post_meta($postID, $count_key, true);\n    if($count==''){\n        $count = 0;\n        delete_post_meta($postID, $count_key);\n        add_post_meta($postID, $count_key, '0');\n    }else{\n        $count++;\n        update_post_meta($postID, $count_key, $count);\n    }\n  }\n}\n\nHow can I simply get it to show posts of a certain category? (FYI the category_name is 'review')\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405712", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is wp-admin/about.php required? Can i omit it from my website There is a page in wordpress available by default(accessible from wp-admin), the url is as follows:\nhttps://mywebsite.com/wp-admin/about.php\nI'am considering to remove this page, or block access to it however I understand that some wp-admin resources are required for proper functioning of WP websites Hence why i want to confirm and ask whether or not I can omit wp-admin/about.php from my wordpress website?\nIf I dont remove it  it might be indexed by google.\n\nA: \nThere is a page in wordpress available by default(accessible from wp-admin), the url is as follows:\n\nOnly for logged in users, like any other WP Admin URL it redirects to a login page\n\nI'am considering to remove this page, or block access to it however I understand that some wp-admin resources are required for proper functioning of WP websites Hence why i want to confirm and ask whether or not I can omit wp-admin/about.php from my wordpress website?\n\nThis would be a massive mistake and extreme bad practice, you should never modify the contents of the wp-admin or wp-includes folders unless you're updating WordPress. They must remain identical to the official WP download for the version you are running.\nIf these folders differ in any way, either because you added, modified, or removed files, this is seen as a security breach by many security software vendors and plugins. You should be able to delete wp-admin and replace it with a copy from a WP download and notice no difference.\nOn managed hosts, you'll find that you do not have access to these folders for security reasons.\nModifying/deleting or adding to the contents of the wp-admin folder is extreme bad practice and is considered sign of a security breach by many hosts and security software.\n\nIf I dont remove it it might be indexed by google.\n\nThere is no evidence for this, and the file redirects to a login screen if you are not logged in, so Google cannot access this file.\nThe only way for this to happen is if you've made custom modifications to WP Admin files to allow about.php to be loaded without logging in. If this is the case then about.php being visible via Google is the least of your worries and you should put your site in maintenance mode immediately to limit the damage.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405716", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Trying to re-direct users to specific page based on an ACF variable I have a case where I have an ACF variable that is stored within a users profile and based on that variables state I need to redirect to one of two pages once the user logs in. This is just a true or false value that will represent if a user has logged in before.\nI have tried using wp_redirect to do this and it does sort of work but seems to run excruciatingly slow and sometimes will briefly get stuck in a loop of redirecting to the same page it's already on several times in a row.\nAs an example something like this is roughly what I have\nfunction redirect_to_welcome() {\n    $acf_user_id = get_current_user_id();\n    $acf_User = \"user_$acf_user_id\";\n    $has_user_previously_logged_in = get_field('has_this_user_logged_in_before', $acf_User);\n\n    if(is_user_logged_in() && $has_user_previously_logged_in == true && is_page('welcome')){\n        wp_redirect( home_url()); \n        exit;\n   }elseif(is_user_logged_in() && $has_user_previously_logged_in == false && !is_page('welcome')){\n        wp_redirect('welcome'); \n        exit;\n   }\n\nI also have another redirect happening that redirects the user to the login page if they are not logged in, while allowing for some page exceptions from an array.\n\nadd_action( 'template_redirect', 'redirect_if_user_not_logged_in' );\nfunction redirect_if_user_not_logged_in() {\n    global $unrestricted_pages;\n    if ( !is_page($unrestricted_pages) && get_post_type() != 'groups' && ! is_user_logged_in() ) {\n        wp_redirect( wp_login_url()); \n         exit;\n   }\n}\n\nI am sure this is not the best way of going about this but it is what I have come up with so far.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405719", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: It is possible to pass $args that sent by add_settings_field() inside another function? I'm trying To do my plugin Setting with OOP PHP\nwhen I'm Creating Setting Filed it sends $args so I can use it in their function, but when I call this function in another place it is for $args and it's undefined.\nhere are my codes:\n\n*\n\n*Please Look At the Last Chapter and see the $args\nAdd Setting:\n    add_settings_field(\n        'st-test-color',\n        __('Color', 'st-search'),\n        'st_color_ca',\n        'st-test',\n        'st-test-settings-section-2',\n        array(\n            'name'      => 'color_css',\n            'id'        => 'st-test-color',\n            'class'     => 'st-test-color',\n            'options'   => $st_test,\n        )\n    );\n\n    class STTEST\n    {\n      public function st_color_ca($args) {\n        global $stsearch_style_get_opts;\n        ?>\n        <label for=\"<?php echo esc_attr($args['id']); ?>\">\n                    <input type=\"color\" name=\"stsearch_style_opts[<?php echo esc_attr($args['name']); ?>]\" >\n        </label>\n        <?php\n    }\n\n}\n\nNow Let's Put the function inside the Form\n    function myform() {\n        <form action=\"options.php\" method=\"post\">\n        <?php\n                                                                        \n        settings_errors();\n    \n        settings_fields( 'st-search-style' );\n    \n        // Call the Function the color\n    \n         $class = new STTEST();\n         echo $class->st_color_ca($args); <---- THIS $args is not undefined!!\n        \n       ?>\n       </form>\n    }\n\nHow I can solve this problem with the correct way?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405721", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Menu Problem <!-- Mobile Menu Desktop -->\n<div class=\"show-mobile\">\n    <div class=\"site-menu\">\n        <ul class=\"menu\">\n        <li><a href=\"#\">Link</a></li>\n            <li><a href=\"#\">Link</a></li>\n            <li><a href=\"#\">Link</a></li>\n                <ul class=\"dropdown-menu\">\n                        <li><a class=\"dropdown-item\" href=\"#\">Link</a></li>\n                        <li><a class=\"dropdown-item\" href=\"#\">Link </a></li>\n                        <li><a class=\"dropdown-item\" href=\"#\">Link</a></li>\n                        <li><a class=\"dropdown-item\" href=\"#\">Link</a></li>\n                        <li><a class=\"dropdown-item\" href=\"#\">Link</a></li>\n                        <li><a class=\"dropdown-item\" href=\"#\">TLink</a></li>\n                    </ul>\n            </li>\n            <li><a href=\"#\">Link</a></li>\n            <li><a href=\"#\">Link</a></li>\n            <li><a href=\"#\">Link</a></li>\n            <li><a href=\"#\">Link</a></li>\n        </ul>\n        </div>\n    </div>\n    <small> Copyright 2022</small> </div>\n</aside>\n<nav class=\"navbar\">\n<div class=\"container\">\n\n<!-- Desktop Menu -->\n<div class=\"logo\"> <a href=\"#\"><img src=\"<?php bloginfo('template_url');?>/img/logo.png\" alt=\"Image\"></a> </div>\n\n  \n\n<div class=\"site-menu\">\n<ul class=\"menueffect\">\n<li><a href=\"#\">Link</a></li>\n<li><a href=\"#\">Link</a></li>\n<li><a href=\"#\">Link \n</a>\n    <ul class=\"dropdown-menu\">\n        <li><a class=\"dropdown-item\" href=\"#\">Link</a></li>\n        <li><a class=\"dropdown-item\" href=\"#\">Link </a></li>\n        <li><a class=\"dropdown-item\" href=\"#\">Link</a></li>\n        <li><a class=\"dropdown-item\" href=\"#\">Link</a></li>\n        <li><a class=\"dropdown-item\" href=\"#\">Link</a></li>\n        <li><a class=\"dropdown-item\" href=\"#\">TLink</a></li>\n        </ul>\n</li>\n<li><a href=\"#\">Link</a></li>\n<li><a href=\"#\">Link</a></li>\n<li><a href=\"#\">Link</a></li>\n</ul>\n</div>\n<div class=\"hamburger-menu\"> <span></span> <span></span> <span></span> </div>\n<div class=\"navbar-button\"> <a href=\"#\"><i class=\"flaticon-call\"></i>&amp;nbsp;&amp;nbsp;&amp;nbsp;123 456 789</a> </div>\n</div>\n</nav>\n\nHello,\nI want to create a menu structure like this. For the first time, I will set up a theme with Wordpress. There is a place where I hang out. How can I define these menus with php code. I tried a lot but I keep getting errors. I'm waiting for your help.**\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405723", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: redirect after submiting post for review I have a frontend page that allows \"Tutor Instructor\" role, to create a course and this course is a custom type post called courses, when the Tutor Instructor finishes creating the course he must click submit for review. when he clicks that button, the page will refresh and change the link to the editing link of the course (https://**************.com/dashboard/create-course/?course_ID=13865).\nI want when the Tutor Instructor clicks submit for review the page redirects him to another page for example (https://**************.com/thank-you). How can I do that?\nthe code of the page\n<?php\n\ndefined( 'ABSPATH' ) || exit;\n\nget_tutor_header( true );\n\n    if ( wpse405644_is_frontend_editing_allowed() ) {\ndo_action( 'tutor_load_template_before', 'dashboard.create-course', null );\nglobal $post;\n\n$course_id          = get_the_ID();\n$can_publish_course = (bool) tutor_utils()->get_option( 'instructor_can_publish_course' ) || current_user_can( 'administrator' );\n\nif ( ! tutor_utils()->can_user_edit_course( get_current_user_id(), $course_id ) ) {\n    tutor_load_template( 'permission-denied' );\n\n    return;\n}\n?>\n\n<?php do_action( 'tutor/dashboard_course_builder_before' ); ?>\n    <form action=\"\" id=\"tutor-frontend-course-builder\" class=\"tutor-frontend-course-builder\" method=\"post\"\n          enctype=\"multipart/form-data\">\n\n        <?php wp_nonce_field( tutor()->nonce_action, tutor()->nonce ); ?>\n\n        <header id=\"page-header\" class=\"page-header header-dark header-sticky-dark-logo\">\n            <div class=\"page-header-place-holder\"></div>\n            <div id=\"page-header-inner\" class=\"page-header-inner\" data-sticky=\"1\">\n                <div class=\"container\">\n                    <div class=\"header-wrap\">\n                        <div class=\"header-left\">\n                            <?php\n                            $branding_args = [\n                                'reverse_scheme' => true,\n                            ];\n                            ?>\n                            <?php edumall_load_template( 'branding', null, $branding_args ); ?>\n\n                            <button type=\"submit\"\n                                    class=\"tutor-dashboard-builder-draft-btn tutor-btn bordered-btn\"\n                                    name=\"course_submit_btn\"\n                                    value=\"save_course_as_draft\">\n                                <i class=\"fal fa-save\"></i>\n                                <span><?php esc_html_e( 'Save', 'edumall' ); ?></span>\n                            </button>\n                        </div>\n\n                        <div class=\"header-right\">\n                            <div class=\"header-content-inner\">\n                                <div id=\"header-right-inner\" class=\"header-right-inner\">\n                                    <div class=\"header-right-inner-content\">\n                                        <?php Edumall_Templates::render_button( [\n                                            'link'        => [\n                                                'url'         => get_the_permalink( $course_id ),\n                                                'is_external' => true,\n                                            ],\n                                            'text'        => esc_html__( 'Preview', 'edumall' ),\n                                            'icon'        => 'fal fa-glasses',\n                                            'extra_class' => 'button-grey',\n                                        ] ); ?>\n\n                                        <div class=\"form-submit\">\n                                            <?php if ( $can_publish_course ) : ?>\n                                                <button class=\"tutor-button\" type=\"submit\"\n                                                        name=\"course_submit_btn\"\n                                                        value=\"publish_course\"><?php esc_html_e( 'Publish Course', 'edumall' ); ?></button>\n                                            <?php else: ?>\n                                                <button class=\"tutor-button\" type=\"submit\"\n                                                        name=\"course_submit_btn\"\n                                                        value=\"submit_for_review\"><?php esc_html_e( 'Submit for Review', 'edumall' ); ?></button>\n                                            <?php endif; ?>\n                                        </div>\n\n                                        <div class=\"return-dashboard-link\">\n                                            <a href=\"<?php echo tutor_utils()->tutor_dashboard_url(); ?>\"> <?php esc_html_e( 'Exit', 'edumall' ); ?></a>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <?php Edumall_Header::instance()->print_more_tools_button(); ?>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </header>\n\n        <div class=\"tutor-frontend-course-builder-section tm-sticky-parent\">\n            <div class=\"container\">\n                <div class=\"row\">\n                    <div class=\"col-lg-8\">\n                        <input type=\"hidden\" value=\"tutor_add_course_builder\" name=\"tutor_action\"/>\n                        <input type=\"hidden\" name=\"course_ID\" id=\"course_ID\" value=\"<?php echo get_the_ID(); ?>\">\n                        <input type=\"hidden\" name=\"post_ID\" id=\"post_ID\" value=\"<?php echo get_the_ID(); ?>\">\n                        <div class=\"tutor-dashboard-course-builder-wrap tm-sticky-column\">\n\n                            <!--since 1.8.0 alert message -->\n                            <?php\n                            $instructor_can_publish = tutils()->get_option( 'instructor_can_publish_course' );\n                            ?>\n                            <?php if ( current_user_can( 'tutor_instructor' ) && ! current_user_can( 'administrator' ) ) : ?>\n                                <?php if ( isset( $_COOKIE['course_submit_for_review'] ) && ! $instructor_can_publish ) : ?>\n                                    <div class=\"tutor-alert tutor-alert-info\">\n                                        <?php esc_html_e( 'Your course has been submitted to the admin. It will be published once it has been reviewed by the admins.', 'edumall' ); ?>\n                                    </div>\n                                <?php endif; ?>\n                            <?php endif; ?>\n                            <!--alert message end -->\n\n                            <?php do_action( 'tutor/dashboard_course_builder_form_field_before' ); ?>\n\n                            <div class=\"tutor-course-builder-section tutor-course-builder-info\">\n                                <div class=\"tutor-course-builder-section-title\">\n                                    <h3>\n                                        <i class=\"tutor-icon-down\"></i><span><?php esc_html_e( 'Course Info', 'edumall' ); ?></span>\n                                    </h3>\n                                </div> <!--.tutor-course-builder-section-title-->\n                                <div class=\"tutor-course-builder-section-content\">\n                                    <div class=\"tutor-frontend-builder-item-scope\">\n                                        <div class=\"tutor-form-group\">\n                                            <label><?php esc_html_e( 'Course Title', 'edumall' ); ?></label>\n                                            <input type=\"text\" name=\"title\"\n                                                   value=\"<?php echo esc_attr( get_the_title() ); ?>\"\n                                                   placeholder=\"<?php esc_attr_e( 'ex. Learn photoshop CS6 from scratch', 'edumall' ); ?>\">\n                                        </div>\n                                    </div> <!--.tutor-frontend-builder-item-scope-->\n\n                                    <div class=\"tutor-frontend-builder-item-scope\">\n                                        <div class=\"tutor-form-group\">\n                                            <label> <?php esc_html_e( 'Description', 'edumall' ); ?></label>\n                                            <?php\n                                            $editor_settings = array(\n                                                'media_buttons' => false,\n                                                'quicktags'     => false,\n                                                'editor_height' => 150,\n                                                'textarea_name' => 'content',\n                                            );\n                                            wp_editor( $post->post_content, 'course_description', $editor_settings );\n                                            ?>\n                                        </div>\n                                    </div>  <!--.tutor-frontend-builder-item-scope-->\n\n                                    <?php do_action( 'tutor/frontend_course_edit/after/description', $post ); ?>\n\n                                    <div class=\"tutor-frontend-builder-item-scope\">\n                                        <div class=\"tutor-form-group\">\n                                            <label>\n                                                <?php esc_html_e( 'Choose a category', 'edumall' ); ?>\n                                            </label>\n                                            <div class=\"tutor-form-field-course-categories\">\n                                                <?php //echo tutor_course_categories_checkbox($course_id);\n                                                echo tutor_course_categories_dropdown( $course_id, array( 'classes' => 'tutor_select2' ) );\n                                                ?>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <div class=\"tutor-frontend-builder-item-scope\">\n                                        <div class=\"tutor-form-group\">\n                                            <label>\n                                                <?php esc_html_e( 'Choose a tag', 'edumall' ); ?>\n                                            </label>\n                                            <div class=\"tutor-form-field-course-tags\">\n                                                <?php //echo tutor_course_tags_checkbox($course_id);\n                                                echo tutor_course_tags_dropdown( $course_id, array( 'classes' => 'tutor_select2' ) );\n                                                ?>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <?php\n                                    $monetize_by = tutils()->get_option( 'monetize_by' );\n                                    if ( $monetize_by === 'wc' || $monetize_by === 'edd' ) {\n                                        $course_price    = tutor_utils()->get_raw_course_price( get_the_ID() );\n                                        $currency_symbol = tutor_utils()->currency_symbol();\n\n                                        $_tutor_course_price_type = tutils()->price_type();\n                                        ?>\n                                        <div\n                                            class=\"tutor-frontend-builder-item-scope tutor-frontend-builder-course-price\">\n                                            <div class=\"tutor-form-group\">\n                                                <label><?php esc_html_e( 'Course Price', 'edumall' ); ?></label>\n                                                <div class=\"tutor-row tutor-align-items-center\">\n                                                    <div class=\"tutor-col-auto\">\n                                                        <label for=\"tutor_course_price_type_pro\"\n                                                               class=\"tutor-styled-radio\">\n                                                            <input id=\"tutor_course_price_type_pro\" type=\"radio\"\n                                                                   name=\"tutor_course_price_type\"\n                                                                   value=\"paid\" <?php $_tutor_course_price_type ? checked( $_tutor_course_price_type, 'paid' ) : checked( 'true', 'true' ); ?> >\n                                                            <span></span>\n                                                            <div class=\"tutor-form-group\">\n                                                            <span\n                                                                class=\"tutor-input-prepand\"><?php echo esc_html( $currency_symbol ); ?></span>\n                                                                <input type=\"text\" name=\"course_price\"\n                                                                       value=\"<?php echo esc_attr( $course_price->regular_price ); ?>\"\n                                                                       placeholder=\"<?php esc_attr_e( 'Set course price', 'edumall' ); ?>\">\n                                                            </div>\n                                                        </label>\n                                                    </div>\n                                                    <div class=\"tutor-col-auto\">\n                                                        <label class=\"tutor-styled-radio\">\n                                                            <input type=\"radio\" name=\"tutor_course_price_type\"\n                                                                   value=\"free\" <?php checked( $_tutor_course_price_type, 'free' ); ?> >\n                                                            <span><?php esc_html_e( 'Free', 'edumall' ); ?></span>\n                                                        </label>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div> <!--.tutor-frontend-builder-item-scope-->\n                                    <?php } ?>\n\n                                    <div class=\"tutor-frontend-builder-item-scope\">\n                                        <div class=\"tutor-form-group\">\n                                            <label>\n                                                <?php esc_html_e( 'Course Thumbnail', 'edumall' ); ?>\n                                            </label>\n                                            <div\n                                                class=\"tutor-form-field tutor-form-field-course-thumbnail tutor-thumbnail-wrap\">\n                                                <div class=\"tutor-row tutor-align-items-center\">\n                                                    <div class=\"tutor-col-5\">\n                                                        <div class=\"builder-course-thumbnail-img-src\">\n                                                            <?php\n                                                            $builder_course_img_src = tutor()->url . 'assets/images/placeholder-course.jpg';\n                                                            $_thumbnail_url         = get_the_post_thumbnail_url( $course_id );\n                                                            $post_thumbnail_id      = get_post_thumbnail_id( $course_id );\n\n                                                            if ( ! $_thumbnail_url ) {\n                                                                $_thumbnail_url = $builder_course_img_src;\n                                                            }\n                                                            ?>\n                                                            <img src=\"<?php echo esc_url( $_thumbnail_url ); ?>\"\n                                                                 class=\"thumbnail-img\"\n                                                                 data-placeholder-src=\"<?php echo esc_url( $builder_course_img_src ); ?>\">\n                                                            <a href=\"javascript:;\"\n                                                               class=\"tutor-course-thumbnail-delete-btn\"\n                                                               style=\"<?php echo esc_attr( sprintf( 'display: %s;', $post_thumbnail_id ? 'block' : 'none' ) ); ?>\">\n                                                                <i class=\"tutor-icon-line-cross\"></i>\n                                                            </a>\n                                                        </div>\n                                                    </div>\n\n                                                    <div class=\"tutor-col-7\">\n                                                        <div class=\"builder-course-thumbnail-upload-wrap\">\n                                                            <p class=\"builder-course-thumbnail-guide-line\">\n                                                                <?php echo sprintf( __( \"Important Guideline: %1\\$s 700x430 pixels %2\\$s %3\\$s File Support: %1\\$s .jpg, .jpeg, .gif, or .png %2\\$s no text on the image.\", 'edumall' ), \"<strong>\", \"</strong>\", \"<br>\" ); ?>\n                                                            </p>\n                                                            <input type=\"hidden\" id=\"tutor_course_thumbnail_id\"\n                                                                   name=\"tutor_course_thumbnail_id\"\n                                                                   value=\"<?php echo esc_attr( $post_thumbnail_id ); ?>\">\n                                                            <a href=\"javascript:void(0);\"\n                                                               class=\"tutor-course-thumbnail-upload-btn tutor-button bordered-button\"><?php esc_html_e( 'Upload Image', 'edumall' ); ?></a>\n                                                        </div>\n                                                    </div>\n                                                </div>\n\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <?php do_action( 'tutor/dashboard_course_builder_form_field_after', $post ); ?>\n\n                            <div class=\"tutor-form-row tutor-form-submit\">\n                                <div class=\"tutor-form-col-12\">\n                                    <div class=\"tutor-form-group\">\n                                        <div class=\"tutor-form-field tutor-course-builder-btn-group\">\n                                            <button type=\"submit\" class=\"tutor-button btn-save-as-draft\"\n                                                    name=\"course_submit_btn\"\n                                                    value=\"save_course_as_draft\"><?php esc_html_e( 'Save course as draft', 'edumall' ); ?></button>\n                                            <?php if ( $can_publish_course ) :  ?>\n                                                <button class=\"tutor-button tutor-success\" type=\"submit\"\n                                                        name=\"course_submit_btn\"\n                                                        value=\"publish_course\"><?php esc_html_e( 'Publish Course', 'edumall' ) ; ?></button>\n                                            <?php else : ?>\n                                                <button class=\"tutor-button tutor-success\" type=\"submit\"\n                                                        name=\"course_submit_btn\"\n                                                        value=\"submit_for_review\"><?php esc_html_e( 'Submit for Review', 'edumall' );  ?></button>\n                                            <?php endif; ?>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"col-lg-4\">\n                        <div class=\"tutor-course-builder-upload-tips tm-sticky-column\">\n                            <h3 class=\"tutor-course-builder-tips-title\">\n                                <i class=\"far fa-lightbulb-on\"></i><?php esc_html_e( 'Course Upload Tips', 'edumall' ); ?>\n                            </h3>\n                            <ul>\n                                <li><?php esc_html_e( 'Set the Course Price option or make it free.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Standard size for course thumbnail is 700x430.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Video section controls the course overview video.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Course Builder is where you create & organize a course.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Add Topics in the Course Builder section to create lessons, quizzes, and assignments.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Prerequisites refers to the fundamental courses to complete before taking this particular course.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Information from the Additional Data section shows up on the course single page.', 'edumall' ); ?></li>\n                                <li><?php esc_html_e( 'Make Announcements to notify any important notes to all enrolled students at once.', 'edumall' ); ?></li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </form>\n\n\n\n<?php do_action( 'tutor/dashboard_course_builder_after' ); ?>\n\n<?php do_action( 'tutor_load_template_after', 'dashboard.create-course', null ); ?>\n<?php\n    } else {\n        echo '<h2>You are not allowed to edit this post.</h2>';\n    } ?>\n<?php get_tutor_footer( true );\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405726", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Dynamic Sections I'm trying to build a page which has three filters. What I want to achieve is that some sections on the page change depending on what filters the user will choose.\nCan somebody help me out with this? I'm either looking for a plugin (can be paid) or some explanation about how to implement some custom code.\nGOAL: have users choose filters and based on the filters some sections on the page will change.\nUsability: The feature should be implemented on a page for a travel agency. The page will show \"Example trips\". Based on some filters (amount of people traveling, budget, length of trip), the page will have some sections explaining the example trip. When filter are changed (such as length of trip) the sections displaying the example trip have to change and show different content.\nWould love some help. Any idea is welcome!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405728", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Prevent users to delete comments from trash As told in the title, I am looking for a way to prevent users to delete comments from the trash. Only admins should be able to.\nI tested the scripts at:\nFunction to prevent users from trashing comments\nBut it doesn't work, probably since 2013 a few things have changed :)\nThank you for help!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405729", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to check post meta isset or not empty during publish/save post? How to check if a specific post meta isset/!emtpy during updating or publishing a post ( save_post() )?\n\nA: I don't know what you want to do besides checking the meta so i'm gonna give a very basic example.\nfunction bt_check_saved_post_meta ($post_id) {\n    if (!empty(get_post_meta($post_id, 'some_meta', true))) {\n        // do something here\n    }\n}\nadd_action('save_post', 'bt_check_saved_post_meta');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405730", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Cannot use WordPress Application Passwords: \"code\": \"rest_no_route\" \"status\":404 for /wp-json/wp/v2/users/me/application-passwords I am trying to use Application Passwords on Wordpress 5.9 for the development of a client app.\nThe page https://www.example.com/wp-admin/authorize-application.php shows the Application Passwords confirmation prompt, but if I click generate \"Approve the connection\" for the app, an error is shown: \"No Path provides a match between the URL and the requested method.\"\nI also tried to GET the path \"/wp-json/wp/v2/users/me/application-passwords?_locale=user\" that is supposed to answer the request, but it says 404 error.\nThe base path for wp api works well (/wp-json).\nI have installed WordFence and iThemes Security.\nI checked in WordFence and Application Passwords is not disabled, in iThemes Security I cannot find a similar option.\nApplication Passwords seems to be not completely disabled, since the page https://www.example.com/wp-admin/authorize-application.php is visitable and in the profile page I have the (empty) list of Application Passwords...\nI tried to write add_filter( 'wp_is_application_passwords_available', '__return_false' ); in functions.php to see if there would be any changes in the behaviour and, doing so, the page https://www.example.com/wp-admin/authorize-application.php says that Application Passwords is disabled.\nWhat could be the cause of this issue?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405731", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get all comments of author's posts Hello I have multi author website. I want to display all comments of posts created by author in author page. Please help me. I found this code but fatal error\n<?php\n    $args = array(\n        'author' => AUTHOR_ID,\n        'posts_per_page' => 500, //Don't use -1 here\n    );\n    $the_query = new WP_Query( $args );\n    if($the_query->have_posts() ) : ?>\n        <?php while ( $the_query->have_posts() ) : ?>\n            <?php\n            $nested_args = array(\n                'post_id' => get_the_ID()\n            );\n            $comments_query = new WP_Comment_Query;\n            $comments = $comments_query->query( $nested_args );\n            if ( $comments ) {\n                foreach ( $comments as $comment ) {\n                    echo '<p>' . $comment->comment_content . '</p>';\n                }\n            }\n        <?php endwhile; ?>\n    <?php endif; ?>\n<?php wp_reset_query(); ?>\n\n\nA: It looks like there's two problem with the code you're trying to use. The first is AUTHOR_ID. Unless you have this defined somewhere else, then this is going to cause an undefined constant error. The second one is that there should be a closing PHP tag ?> before <?php endwhile; ?>.\nAnother thing is, that doing WP_Query is a bit unnecessary as you can pass the user ID as a parameter to the WP_Comment_Query directly.\nFor example on author.php template you could do this,\n<?php\n$query = new WP_Comment_Query( array(\n    'user_id' => get_queried_object_id()\n) );\n\nforeach ($query->comments as $comment) {\n    echo '<p>' . $comment->comment_content . '</p>';\n}\n?>\n\nEDIT\nTo get comments from the author's posts, use post_author parameter.\n<?php\n$query = new WP_Comment_Query( array(\n    'post_author' => get_queried_object_id()\n) );\n\nforeach ($query->comments as $comment) {\n    echo '<p>' . $comment->comment_content . '</p>';\n}\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405732", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: User with same Mail but a different additional info(like domain) I know this is not the way u should go, but my customers want it so im looking for ways.\nRequirement:\n\n*\n\n*WP with one DB (3 Domains sale the same stuff)\n\n*3 Domains which use this DB  (can be more later), this should work with on fly rewriting over hooks\n\n*user registered should be only able to login in the domain where he is registered, but should be able to register on the other 2 domains with same data.\n\nMy ideas:\nAdd the Domain as user meta\nProblems:\nE-Mail can be use only once on WordPress\nI can't check the domain, for example in own code I would do the following which seems is not work on WordPress because wp use a Select statement which take a email lookup with a limit 1.\nSELECT * from users WHERE email = \u201cmyemail\u201d and password = PASSWORD(\u201cmypw\u201d) and domain = \u201cthedomain where user is\u201d.\n\nMaybe Solutions:\nAdd the domain to the email on fly so user use name@gmx.de and in the db I will add domain1_name@gmx.de, but this brings new problems.\nIn the theory, i should do modification on the login query but this seems not so a good idea.\nThis Question is a little about WooCommerce but the main functions i need comes from Wordpress so i think this is the better place here.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405733", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Users can login to Website from wp-admin prior to confirmation email I have a wordpress website that has an account sign-up/login system.\nWhen a user creates an account from the website's signup page (not the wp-admin page), he has to confirm the email link (in his mail inbox) prior to being able to login.\nHowever, if the user goes to mywebsite.com/wp-admin, he is able to login and access website's resources as a logged in user without having to confirm his email.\nI suppose disabling access to wp-admin is not an option as it will create issues since wp-admin is required for proper functioning of the website.\nAny suggestions would be really appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405734", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get comment images stored as serialized comment meta I want to display images under for each comment but images store in database as serialized a:3:{i:0;i:775;i:1;i:776;i:2;i:777;}\nI wrote this code\n print_r (get_comment_meta( $comment->comment_ID , 'reviews-images', true ));\n\nbut it outputs this *\n\nArray ( [0] => 778 [1] => 779 [2] => 780 [3] => 781 [4] => 782 ) 10\n\n\n*\n\n*\n\nthen I tried this\necho get_comment_meta( $comment->comment_ID, 'reviews-images', true );\n\nnot worked . Please help how can I get image urls instead of this output\n\nA: What you get is fine, it's the image id, now you just need to loop them and output the structure that you want, for example.\nif (!empty($images = get_comment_meta( $comment->comment_ID , 'reviews-images', true ))) {\n    foreach ($images as $image_id) {\n        $image_src = wp_get_attachment_image_src($image_id, 'full');\n\n        // Now you have the image src, $image_src, you can do what ever you want here\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405736", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: CRUD and Frontend show from a custom table without shortcode I just wrote a plugin that creates a database, populates and edits rows from the backend, now what I need to show a list view of those rows with teir respective link to a detail viewo of each one. The shortcode approach I have already done it, but that does not get the purpose of my plugin, as I want it to be available in the Menus configuration, just like Woocommerce endpoints are. How can I do that? Has someone here done something alike?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405738", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Pagination stopped working after assigning custom page template to new page (different slug) I am having a problem with pagination on one of my CPT after assigning the custom page template to a different page with a different slug. It all worked perfectly on the test page I developed it with. Only after the new assignment did I run into this issue for subsequent pages (2,3,etc.). Page 1 still works fine. I did resave the Permalinks in WP after the assignment of the custom page template and cleared and rebuild all caches (WP Rocket, WP Engine, Cloudflare).\nI also tried modifying the CPT by removing 'hierarchical' => true and 'capability_type' => 'page' but that did seem to have any effect either.\nI am sure I am missing clearing something somewhere as it was working perfectly before the template reassignment.\nYou can see the working one here (click on '2' below the pictures): https://totalk9focus.com/test-page/\nYou can see the non-working one here (click on '2' below the pictures): https://totalk9focus.com/client-pictures/\nI hope someone can help me sort this out.\nAttached code sections: Definition of the CPT in functions.php | Query for the pages | Footer section with pagination links\n    register_post_type( 'pictures',\n        array( \n                'labels'            => array(\n                                        'name'          => __( 'Pictures' ),\n                                        'singular_name' => __( 'Picture' )          \n                                    ),\n                '_builtin'          => false,\n                'public'            => true, \n                'show_ui'           => true,\n                'show_in_nav_menus' => false,\n                'menu_position'       => 6,\n                'hierarchical'      => true,\n                'capability_type'   => 'page',\n                'menu_icon'           => ( version_compare( $GLOBALS['wp_version'], '3.8', '>=' ) ) ? 'dashicons-format-image' : '',\n                'rewrite'           => array(\n                    'slug'       => 'client-pictures',\n                    'with_front' => FALSE,\n                ),\n                'supports' => array(\n                        'title',\n                        'editor',\n                        'thumbnail',\n                        'excerpt',\n                        'custom-fields',\n                        'post-formats'\n                        )\n                    ) \n                );\n}\nadd_action('init', 'my_post_type_client_pictures'); ```\n\n**Query for the pages**\n\n``` get_header(); \n\n/* Get Pictures */\n$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n\n$args = array(\n    'post_type' => 'pictures',\n    'post_status' => 'publish',\n    'orderby' => 'publish_date',\n    'order' => 'DESC',\n    'posts_per_page' => 12,\n    'paged' => $paged,\n);\n$arr_posts = new WP_Query( $args ); ```\n\n**Footer section with pagination links**\n\n```                         $total_pages = $arr_posts->max_num_pages;\n\n                        if ($total_pages > 1){\n\n                            $current_page = max(1, get_query_var('paged'));\n\n                            echo paginate_links(array(\n                                'base' => get_pagenum_link(1) . '%_%',\n                                'format' => 'page/%#%/',\n                                'current' => $current_page,\n                                'total' => $total_pages,\n                                'prev_text'    => __('\u00ab prev'),\n                                'next_text'    => __('next \u00bb'),\n                            ));\n                        } ```\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405742", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Getting no Error Log File saved to my local directory, and no debug info displayed in the web browser I have installed WordPress on my Ubuntu Server 20.04 VM (host machine runs Linux Mint 19).  I've able to view wp-admin and the sample website without issue.  I'm using Firefox to access wp-admin, the browser is up to date, and the browser clears the cache/history each time I close it.\nWhen I click Themes in wp-admin, the page opens just fine.  But when I click Add New, a progress bar keeps spinning, and then I get the following message:\n\nAn unexpected error occurred. Something may be wrong with WordPress.org or this server\u2019s configuration.\n\nI found another StackExchange post that suggests adding some lines to the wp-config.php file, so that I could debug my issue.  I've added these lines, saved the file, ran sudo service apache2 restart for good measure, closed the browser, then reopened it.  I didn't get any log info posted in the browser, and I don't see any log files saved in the wp-content directory.\nI also found another StackExchange post that suggested I install the Core Control plugin.  But when I go to Add Plugins in wp-admin, I get the same error message.\nSo I can't add a new WordPress theme, and I can't debug the issue using WordPress tools either.\nPlease know I'm a beginning engineer, with light experience with html/css, python, and bash.  I'd appreciate any help I'm able to get.  Thanks!\n\nA: I may have posted my question too soon!\nI found another web page that suggested adding 198.143.164.251 api.wordpress.org to /etc/hosts.\nI did that, and now I can at add themes and plugins!  And since WordPress isn't giving me any errors now, I can't replicate the issues with the debugger.\nSo it looks like I've answered my own question.  Hopefully others can find my post useful.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405743", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Mini app that shows one unique quote each day. 56 rotating posts rotating for each themed weekday. It works, but I need your advice Let's say I have 365 posts published in 2022. I have 56 posts for each weekday (each weekday has a different theme). Normally, if I were to publish them in order, the 1st Monday post would be published on January 3rd and the second Monday post would be published on January 10th. But I want to reuse these posts and for them to be correctly displayed each year, not just in 2022.\nSo I published batches of posts by weekday. The script below summarizes my data structure:\n$sunday_posts = [0, 1, 2... 56];\n$monday_posts = [57, 58, 59... 102];\n$tuesday_posts = [102, 103, 104... 158];\n\nThe values in this array are the post# and day of year they were published (even though 2022 is not over yet).\nI then have a conditional script for each weekday:\nif(date('D') == \"Sun\") {\n$first_sunday_of_year = gmdate('z', strtotime('first Sunday of january this year'))+1; // sets the anchor, the 1 corrects for 0 start\n$sunday_of_year = (((date('z')+1) - $first_sunday_of_year)/7); // returns 19 as of this SE post\nreturn $sunday_list[$sunday_of_year]; // returns correct post day of year\n}\n\nThis returns the correct day of the year for the post that is needed. For example, every 3rd monday of the year, which is post #59 posted on day 59 of 2022, will show whether it is Monday, 21st of 2023 or Monday, 25th of 2024.\nOkay so this works exactly as I hoped for.\nHowever, I just want to know if anyone can suggest if there is a better way to program this? Any general pointers are greatly appreciated from this newbie.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405745", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: unzip_file not working with the remote file I'm trying to use unzip_file to extract the remote archive with no success. It works only with the local path using get_template_directory() but with a remote zip archive URL I'm getting Incompatible Archive. message.\nHere is the stripped version of my code:\nWP_Filesystem();\nglobal $wp_filesystem;\n\n$source = 'http://downloads.wordpress.org/theme/ona-creative.1.0.0.zip';\n$unzipfile = unzip_file( $source, get_theme_root() );\n\nif ( is_wp_error( $unzipfile ) ) {\n    wp_send_json(\n        array(\n            'done'    => 1,\n            'message' => esc_html__( $unzipfile->get_error_message() . ' There was an error unzipping the file.', 'ona' )\n        )\n    ); \n}\n\n\nA: As @Buttered_Toast and @S\u00e9bastien Serre mentioned I first need to save file to a local directory before unzipping. So here is my final code:\n$source = 'http://downloads.wordpress.org/theme/ona-creative.1.0.0.zip';\n$file = get_theme_root() . '/' . $slug . '.zip';\nfile_put_contents( $file, file_get_contents( $source ));\n$unzipfile = unzip_file( $file, get_theme_root() );\n\n\nA: You should use the built in APIs instead, e.g. here is a snippet from the AJAX handler for the theme admin screen:\n    require_once ABSPATH . 'wp-admin/includes/class-wp-upgrader.php';\n    include_once ABSPATH . 'wp-admin/includes/theme.php';\n \n    $api = themes_api(\n        'theme_information',\n        array(\n            'slug'   => $slug,\n            'fields' => array( 'sections' => false ),\n        )\n    );\n \n    if ( is_wp_error( $api ) ) {\n        $status['errorMessage'] = $api->get_error_message();\n        wp_send_json_error( $status );\n    }\n \n    $skin     = new WP_Ajax_Upgrader_Skin();\n    $upgrader = new Theme_Upgrader( $skin );\n    $result   = $upgrader->install( $api->download_link );\n\nhttps://developer.wordpress.org/reference/functions/wp_ajax_install_theme/\n$slug was the slug of the theme, e.g. ona-creative, you don't have to download and unzip the theme yourself, let WP do the heavy lifting for you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405747", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: make user_id in a shortcode dynamic based on who's logged in I basically have a contact form which generates a PDF output using a third-party plugin. The plugin allows for the use of shortcodes to add content to the final PDF.\nI want to be able to display the avatar image of the currently logged in user so the PDF is customized for them and not just a default look. The shortcode below works great and if I manually change the user_id it will changes the image perfectly to whom ever that ID belongs to.\nHowever I can't seem to find for the shortcode to dynamically change the user_id number to represent who's actually logged in ... or at least i've not understood clearly the route I need to take from other support posts.\n[user_profile_avatar size=\"original\" user_id=\"1\"]\nCan someone kindly guide me how to do this and where I need to place code etc. Would be much appreciated. I have some coding knowledge but still learning. I've tired the plugin developers wordpress support page but they haven't answered anyone's request in months.\n\nA: One option is to register your own shortcode to act as a wrapper for the plugin's shortcode. In the wrapper callback you would then retrieve the current user's ID and pass it to the actual shortcode.\nSimplified example,\nadd_shortcode( 'my_user_profile_avatar', 'my_user_profile_avatar_callback' );\nfunction my_user_profile_avatar_callback( $atts, $content = null ) {\n  // (int) The current user's ID, or 0 if no user is logged in.\n  return do_shortcode(\n    '[user_profile_avatar size=\"original\" user_id=\"' . get_current_user_id() . '\"]'\n  );\n}\n\nN.B. not tested, but should work.\nThis would then be used as [my_user_profile_avatar] wherever shortcodes are accepted.\nIf you can find out the name of the actual shortcode's callback, then using it directly instead of do_shortcode() inside your shortcode's callback would be more efficient. Something along these lines,\nfunction my_user_profile_avatar_callback( $atts ) {\n  // (int) The current user's ID, or 0 if no user is logged in.\n  $atts['user_id'] = get_current_user_id();\n  // dig into the plugin's source code to find the callback's name\n  return original_shortcode_callback_function($atts); // might require more parameters\n}\n\nThe custom shortcode registration can be done in your (child) theme's functions.php file or with a custom plugin.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405750", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Make PHP work with HTML tags I have the required code for what I want\n    <?php if ( is_singular() ) {\n <?php if (get_post_meta(get_the_ID(), 'square_image', true)) { ?> <img src=\"<?php echo get_post_meta($post->ID, 'square_image', true); ?>\"/>  <?php } else { ?> <?php the_post_thumbnail( 'thumbnail' );?> <?php } ?>\n} else {\n  \n}\n    ?>\n\nbut I simply don't know how to make the PHP work along with HTML, and inside another PHP code. Please help me make this code work\nthank you\n\nA: From your code the proper structure would be\nif ( is_singular() ) {\n    if (get_post_meta(get_the_ID(), 'square_image', true)) {\n        echo '<img src=\"' . get_post_meta($post->ID, 'square_image', true) . '\"/>';\n    } else {\n        the_post_thumbnail( 'thumbnail' );\n    }\n}\n\nWe can make it a bit better by creating a variable that will contain the meta data so we don't have to call the same function twice.\nif (is_singular()) {\n    if (!empty($square_image = get_post_meta(get_the_ID(), 'square_image', true))) {\n        echo '<img src=\"' . $square_image . '\"/>';\n    } else {\n        the_post_thumbnail('thumbnail');\n    }\n}\n\nNow because our conditions contain just one line of code we can remove the {}\nif (is_singular()) {\n    if (!empty($square_image = get_post_meta(get_the_ID(), 'square_image', true))) echo '<img src=\"' . $square_image . '\"/>';\n    else the_post_thumbnail('thumbnail');\n}\n\nThe official php documentation goes into details about working with php and html, see https://www.php.net/manual/en/faq.html.php.\nThis might also help, https://www.php.net/manual/en/language.operators.string.php, this goes into detail (not much) about how to concatenate strings\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405751", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can't login to Wordpress admin panel after changing domain to use Wordpress pages as a fallback from React we had our Wordpress page running on example.com.\nBut now, we're developing new React website, which already has some of the webpages ready.\nWe use Vercel to host that React website.\nWe want React/Vercel to host specific pages (which are already developed) and serve the wordpress page as a fallback.\nE.g.:\nReact already has page example.com/pageA ready, so we want that URL to be served directly by Vercel/React.\nOn the other hand, React doesn't has page example.com/pageB ready, so we want to use Wordpress's page as a fallback. We've set routing in our React app and it just asks the fallback domain for the address it missess.\nFor that reason we've created subdomain legacy.example.com which points to old Wordpress webpage and redirected our main example.com domain to Vercel. In the case, when user tries to hit example.com/pageB, the Vercel asks Wordpress under legacy.example.com/pageB address and response with that page at example.com/pageB.\nWe've had some problems with Wordpress as it tried to redirect pages to the same adress (creating redirect loop) but we manage it by adding remove_filter('template_redirect','redirect_canonical');.\nBut, we still have problem when trying to log in into admin panel. After accesing example.com/wp-admin we're getting redirected to https://example.com/wp-login.php?redirect_to=https%3A%2F%2Flegacy.example.coml%2Fwp-admin%2F&reauth=1. Trying to log on that page doesn't work - we're being redirected to the same page and nothing happens.\nHow can I solve that issue when loging?\nAlso - is there a better option than turning off canonical redirects? I'm afraid of some side effects of that. The siteurl and home properties are still set to https://example.com.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405756", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: admin-ajax.php calls fail if referrer is sent with 500 calling admin-ajax.php via jquery ajax calls were failing from my site but postman calls to the same url were successfull.\nAfter some looking at headers it seems that the referer being set is the difference that calls the failure (500).\nWhat would possibly cause admin-ajax.php to care about whether or not a referer is being sent and fail if it is?\nThe error logs just say that memory is running out but why would the referer header change how much memory is being used?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405757", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress how to prevent URL encoding in URL of taxonomy terms Is it possible to prevent WordPress from encoding URL with terms? I have a sample taxonomy term \"iPhone5\uff5eiPhone7\" and when I use it for the search function, it turns to \"iphone5%ef%bd%9eiphone7\n\" which is not usable when getting the posts for the term. is it possible to prevent url encoding?\nthanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405759", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: My authors need to be able to preview their upload images and manipulate and scale I am using a form and that form allows for IMAGE UPLOAD. After submission the form redirects and then they can see the reviewed post - however if the image which they uploaded blindly does not look good needs to be moved and scaled to best advantage how can they do this in the post. When I upload my profile pic to most apps I can place it and move it to best advantage within their mask - I want my users to do the same thing wither in the form itself ( ideally) or in the preview page.  Many thanks\n\nA: i believe one way to do what you want would be to simply add an action=\"post.php\" to your form. so the form redirect user to post.php onsubmit in which you can get the user input through $_POST\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405761", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to stop Gutenberg from outputting inline CSS for specific blocks? I like to know how I can remove these individually.\n<style id='wp-block-separator-inline-css'>\n@charset \"UTF-8\";.wp-block-separator{border-bottom:1px soli ...\n</style>\n\nWP has a feature to add inline JS and (and also CSS I think) to registered scripts/styles. So dequeue should work, but it does not.\nadd_action( 'wp_enqueue_scripts', __NAMESPACE__ . '\\action_wp_enqueue_scripts', 99 );\n\nfunction action_wp_enqueue_scripts() {\n\n    wp_dequeue_style( 'wp-block-navigation' ); // Comes from a file and works \n    wp_dequeue_style( 'wp-block-post-comments-form' ); // Comes from a file and works \n    wp_dequeue_style( 'wp-block-seperator' ); // Does not work\n}\n\nA hint to where exactly I find in the source on how these are handled would also help.\nAnd BTW, I do not understand why these are handled in this stupid HTML polluting way in the first place. This does not seem to be dynamic for the most part, but FSE Themes are spammed with inline CSS for almost all blocks, only a few are loaded from CSS files. This causes the browser to never cache the CSS for blocks, very inefficient.\nAsked the question and made this comment already on Github.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405765", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Setting Parent Page to Post Does anyone know how to achieve different parent pages for posts?\nI've managed to code a Custom Post Type that sits under a specific parent page, but I want the option to change this from post to post.\nExample;\n\n*\n\n*/page-1/custom-post-1/\n\n*/page-1/custom-post-2/\n\n*/page-2/custom-post-3/\n\n*/page-2/custom-post-4/\nThe final result would be URL structure like the above, but all posts sitting on one archive page.\nI know by default this isn't possible as posts are non-hierarchical.\nThanks\n\nA: This should be in a comment, but can't format much in there.\n\n*\n\n*Create a relationship between your CPT and Page. For example, create a custom taxonomy for your CPT and programatically add the pages as terms. Or, you can even create a meta field.\n\n\n*Create a placeholder for the URL while registering the CPT. For example 'rewrite' => array( 'slug' => '%cpttag%'),.\n\n\n*str_replace the placeholder with page slug you get from term/meta using post_type_link.\n\n\n*Flush the permalinks (Just hitting Save on Permalinks Settings page will do it)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405767", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress REST API rest_comment_invalid_author Sorry, you are not allowed to edit 'author' for comments I'm fairly new to Wordpress REST API, but I have an Angular application which needs to take user's input and then create a comment anonymously. To start off, we can get rid of the rest_comment_login_required error message by modifying the Wordpress REST API function located in wp-includes/rest-api/endpoints/class-wp-rest-comments-controller.php file. The following line allows anonymous commenting:\n$allow_anonymous = apply_filters( 'rest_allow_anonymous_comments', true, $request );\n\nIn my Wordpress REST API, sending a GET request to http://localhost/wordpress/wp-json/wp/v2/users/1 returns:\n{\n    \"id\": 1,\n    \"name\": \"root\",\n    \"url\": \"http://localhost/wordpress\",\n    \"description\": \"\",\n    \"link\": \"http://localhost/wordpress/author/root/\",\n    \"slug\": \"root\",\n    \"avatar_urls\": {\n        \"24\": \"http://1.gravatar.com/avatar/d11662ae04f559ce691c5b1b4ff906f7?s=24&d=mm&r=g\",\n        \"48\": \"http://1.gravatar.com/avatar/d11662ae04f559ce691c5b1b4ff906f7?s=48&d=mm&r=g\",\n        \"96\": \"http://1.gravatar.com/avatar/d11662ae04f559ce691c5b1b4ff906f7?s=96&d=mm&r=g\"\n    },\n    \"meta\": [ ],\n    \"_links\": {\n        \"self\": [\n            {\n                    \"href\": \"http://localhost/wordpress/wp-json/wp/v2/users/1\"\n            }\n    ],\n    \"collection\": [\n        {\n            \"href\": \"http://localhost/wordpress/wp-json/wp/v2/users\"\n        }\n    ]\n}\n\nSo I only have one user currently in my database, who is called root.\nIf I simulate a request to the API with Postman and send a POST request to http://localhost/wordpress/wp-json/wp/v2/comments while supplying a raw JSON body thata looks like\n{\n    \"content\": \"Lorem Ipsum is simply dummy text of the printing and typesetting industry\",\n    \"date\": \"2021-08-04T22:24:09\",\n    \"post\": 1,\n    \"author\": 1,\n    \"author_name\": \"root\",\n    \"author_url\": \"http://localhost/wordpress\"\n}\n\nthen I get an error\n{\n    \"code\": \"rest_comment_invalid_author\",\n    \"message\": \"Sorry, you are not allowed to edit 'author' for comments.\",\n    \"data\": {\n        \"status\": 401\n    }\n}\n\nWhat is the meaning of this error and how do I fix this?\n\nA: This is because you are sending unauthenticated anonymous requests, but still specifying an author. If what you were trying to do worked then it would be possible to impersonate any person on your site in a comment by specifying their author ID when creating the request.\nWith this in mind, the error message is quite clear.\nHere you're trying to edit the author property by setting it to 1:\n    \"author\": 1,\n\nAnd here the REST API is seeing this and saying No, you can't do that, you don't have permission:\n    \"code\": \"rest_comment_invalid_author\",\n    \"message\": \"Sorry, you are not allowed to edit 'author' for comments.\",\n\nAnonymous logged out requests cannot edit other users comments or impersonate them.\nSo to fix this, either remove the author ID, or send an authenticated request, authenticated with that same user, or an administrator.\n\nAdditionally, the line you commented out was a filter:\n$allow_anonymous = apply_filters( 'rest_allow_anonymous_comments', true, $request );\n\nInstead of modifying WordPres files, instead hook into the filter to return true in a theme or plugin:\nadd_filter( 'rest_allow_anonymous_comments', '__return_true' );\n\nor\nadd_filter( 'rest_allow_anonymous_comments', '__return_false' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405768", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress video js error this.mediaElement.play is not a function I am using the video.js library in WordPress it causes an error (ERROR: TypeError: this.mediaElement.play is not a function) since I have installed themify builder plugin. Error picture attached. Can anyone help me to get out of this error?\n\n\nA: we can't tell much from this screenshot apart that you've indeed installed video.js (at least part of it).\nthis is a big guess but i would say that the lib tries to get your media element by id, but the id being wrong it doesn't have access to a play method, most i can do to help is to suggest you to refer to the doc.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405772", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Multiple categories assigned to a single product breaking the breadcrumb custom bread crumb not working with multiple categories assigned to a single product, we do not have the categories page, so don't want to show categories in the URL, but need to show the categories navigation on the breadcrumb .\n<?php\n\nfunction bootstrap_breadcrumb($custom_home_icon = false, $custom_post_types = false)\n{\n    wp_reset_query();\n    global $post;\n    $is_custom_post = $custom_post_types ? is_singular($custom_post_types) : false;\n    $post_type      = get_post_type(get_the_ID());\n    if (!is_front_page() && !is_home()) {\n        echo '<ol class=\"d-flex breadcrumb-wrapper\">';\n        echo '<li><a href=\"';\n        echo get_option('home');\n        echo '\">';\n        if ($custom_home_icon) {\n            echo $custom_home_icon;\n        } else {\n            _e('Home', 'star');\n        }\n\n        echo \"</a></li>\";\n        if (has_category()) {\n            echo '<li class=\"active\"><a href=\"' . esc_url(get_permalink(get_page(get_the_category($post->ID)))) . '\">';\n            the_category(', ');\n            echo '</a></li>';\n        }\n        if (is_category() || is_single() || $is_custom_post) {\n            if (is_category()) {\n                echo '<li class=\"active\"><a href=\"' . esc_url(get_permalink(get_page(get_the_category($post->ID)))) . '\">' . get_the_category($post->ID)[0]->name . '</a></li>';\n            }\n\n            if ($is_custom_post) {\n                if (is_singular('projects')) {\n                    $page             = get_field('project_archive', 'option');\n                    $project_category = wp_get_post_terms(get_the_ID(), 'industry', array(\"fields\" => \"all\"));\n                    $industry         = '';\n                    $term_id          = array();\n                    if (sizeof($project_category) > 0) {\n                        $count = 0;\n                        foreach ($project_category as $lat_project) {\n                            $term_id[]   = $lat_project->term_id;\n                            $custom_link = get_field('custom_url', $lat_project->taxonomy . '_' . $lat_project->term_id);\n                            $term_link   = get_term_link($lat_project->slug, 'industry');\n                            if ($custom_link == '') {\n                                $custom_link = $term_link;\n                            }\n                            if ($count == 0) {\n                                $industry = '<a href=\"' . $custom_link . '\">' . $lat_project->name . '</a>';\n                            }\n\n                            $count++;\n                        }\n                    }\n                    echo '<li class=\"active\"><a href=\"' . get_permalink($page) . '\">' . get_post_type_object(get_post_type($post))->label . '</a></li>';\n                    if ($industry != '') {\n                        echo '<li class=\"active\">' . $industry . '</li>';\n                    }\n                } elseif (is_singular('products')) {\n                    $page             = get_field('product_archive', 'option');\n                    $product_category = wp_get_post_terms(get_the_ID(), 'product_category', array(\"fields\" => \"all\"));\n\n                    $prod_cat = '';\n                    $term_id  = array();\n                    if (sizeof($product_category) > 0) {\n                        $count = 0;\n                        foreach ($product_category as $lat_product) {\n                            $term_id[]   = $lat_product->term_id;\n                            $custom_link = get_field('custom_url', $lat_product->taxonomy . '_' . $lat_product->term_id);\n                            //$pageSlug       = basename($custom_link);\n                            $pageIdfromslug = url_to_postid($custom_link);\n                            $current_post   = get_post($pageIdfromslug);\n                            $postParent_id  = $current_post->post_parent;\n                            $postParent     = get_post($postParent_id);\n                            if ($postParent->post_parent > 0) {\n                                $postparent_title = $postParent->post_title;\n                                $postparent_link  = get_permalink($postParent_id);\n                            }\n                            $term_link = get_term_link($lat_product->slug, 'product_category');\n\n                            if ($custom_link == '') {\n                                $custom_link = $term_link;\n                            }\n                            if ($count == 0) {\n                                if ($postparent_title != \"\") {\n                                    $prod_cat = '<a href=\"' . $postparent_link . '\">' . $postparent_title . '</a>';\n                                }\n                                $prod_cat .= '<a href=\"' . $custom_link . '\">' . $lat_product->name . '</a>';\n                            }\n\n                            $count++;\n                        }\n                    }\n                    echo '<li class=\"active\"><a href=\"' . get_permalink($page) . '\">' . get_post_type_object(get_post_type($post))->label . '</a></li>';\n                    if ($prod_cat != '') {\n                        echo '<li class=\"active\">' . $prod_cat . '</li>';\n                    }\n                } elseif (is_singular('resources')) {\n                    $page = get_field('resource_archive', 'option');\n                    echo '<li class=\"active\"><a href=\"' . get_permalink($page) . '\">' . get_post_type_object(get_post_type($post))->label . '</a></li>';\n                } else {\n                    echo '<li class=\"active\"><a href=\"' . get_option('home') . '/' . get_post_type_object(get_post_type($post))->name . '\">' . get_post_type_object(get_post_type($post))->label . '</a></li>';\n                }\n                if ($post->post_parent) {\n                    $home = get_page(get_option('page_on_front'));\n                    for ($i = count($post->ancestors) - 1; $i >= 0; $i--) {\n                        if (($home->ID) != ($post->ancestors[$i])) {\n                            echo '<li><a href=\"';\n                            echo get_permalink($post->ancestors[$i]);\n                            echo '\">';\n                            echo get_the_title($post->ancestors[$i]);\n                            echo \"</a></li>\";\n                        }\n                    }\n                }\n            } elseif ($post_type == 'products') {\n                $page             = get_field('product_archive', 'option');\n                $product_category = wp_get_post_terms(get_the_ID(), 'product_category', array(\"fields\" => \"all\"));\n                $prod_cat         = '';\n                $term_id          = array();\n                if (sizeof($product_category) > 0) {\n                    $count = 0;\n                    foreach ($product_category as $lat_product) {\n                        $term_id[]   = $lat_product->term_id;\n                        $custom_link = get_field('custom_url', $lat_product->taxonomy . '_' . $lat_product->term_id);\n                        //$pageSlug       = basename($custom_link);\n                        $pageIdfromslug = url_to_postid($custom_link);\n                        $current_post   = get_post($pageIdfromslug);\n                        $postParent_id  = $current_post->post_parent;\n                        $postParent     = get_post($postParent_id);\n                        if ($postParent->post_parent > 0) {\n                            $postparent_title = $postParent->post_title;\n                            $postparent_link  = get_permalink($postParent_id);\n                            $postParent_Id2   = $postParent->post_parent;\n                            $postParent2      = get_post($postParent_Id2);\n                            if ($postParent2->post_parent > 0) {\n                                $postParent_title2 = $postParent2->post_title;\n                                $postparent_link2  = get_permalink($postParent_Id2);\n                            }\n                        }\n\n                        $term_link = get_term_link($lat_product->slug, 'product_category');\n                        if ($custom_link == '') {\n                            $custom_link = $term_link;\n                        }\n                        if ($count == 0) {\n                            if ($postParent_title2 != \"\") {\n                                $prod_cat = '<a href=\"' . $postparent_link2 . '\">' . $postParent_title2 . '</a>';\n                            }\n                            if ($postparent_title != \"\") {\n                                $prod_cat .= '<a href=\"' . $postparent_link . '\">' . $postparent_title . '</a>';\n                            }\n\n                            $prod_cat .= '<a href=\"' . $custom_link . '\">' . $lat_product->name . '</a>';\n                        }\n\n                        $count++;\n                    }\n                }\n                echo '<li class=\"active\"><a href=\"' . get_permalink($page) . '\">' . get_post_type_object(get_post_type($post))->label . '</a></li>';\n                if ($prod_cat != '') {\n                    echo '<li class=\"active\">' . $prod_cat . '</li>';\n                }\n            }\n            if (is_single()) {\n                echo '<li class=\"active\">' . get_the_title($post->ID) . '</li>';\n            }\n\n        } elseif (is_page() && $post->post_parent) {\n            $home = get_page(get_option('page_on_front'));\n            for ($i = count($post->ancestors) - 1; $i >= 0; $i--) {\n                if (($home->ID) != ($post->ancestors[$i])) {\n                    echo '<li><a href=\"';\n                    echo get_permalink($post->ancestors[$i]);\n                    echo '\">';\n                    echo get_the_title($post->ancestors[$i]);\n                    echo \"</a></li>\";\n                }\n            }\n            echo '<li class=\"active\">' . get_the_title($post->ID) . '</li>';\n        } elseif (is_page()) {\n            echo '<li class=\"active\">' . get_the_title($post->ID) . '</li>';\n        } elseif (is_404()) {\n            echo '<li class=\"active\">404</li>';\n        }\n        echo '</ol>';\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405775", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Automated Cart Update With Alert Box Each Time New To PHP and, I am currently attempting to create a plug in that creates an alert box every time the quantity in a cart is changed. So far I have successfully implemented updating the cart automatically, but I am having trouble determining how to create an alert box on update each time that references the new cart total. Any advice would be appreciated.\nTLDR: Creating a plug in that will display an alert box when you change the quantity of an item in the cart with the following text:\n\"You just changed the quantity of ABC to 2\", where ABC is the SKU name, and 2 is the current (new) quantity of the item.\n<?php\n/**\n * Plugin Name: Order Check 2\n**/\nadd_action( 'wp_footer', 'cart_update_qty_script', 'persistent_cart_update');\n\nfunction persistent_cart_update() {\n    foreach ( WC()->cart->get_cart() as $cart_item ) {\n        // gets the cart item quantity\n        $quantity           = $cart_item['quantity'];}\n    }\nfunction phpAlert($msg) {\n    echo '<script type=\"text/javascript\">alert(\"' . $msg . '\")</script>';\n}\nfunction cart_update_qty_script() {\n    if (is_cart()) :\n    ?>\n    <script>\n         jQuery('div.woocommerce').on('change', '.qty', function(){\n        jQuery(\"[name='update_cart']\").prop(\"disabled\", false);\n        jQuery(\"[name='update_cart']\").trigger(\"click\"); \n    });\n    \n    </script>\n<?php phpAlert(   \"Your have changed the quantity of sweatshirts to \" .$quantity.\".\");  ?>\n   \n    <?php\n    endif;\n}\n\n?>\n\n\nA: // Display sku in cart\nadd_filter( 'woocommerce_get_item_data', 'func_js_display_custom_item_data_in_cart', 100, 2 );\nfunction func_js_display_custom_item_data_in_cart( $cart_item_data, $cart_item )\n{\n$cart_item_data[] = array(\n'name' => __( 'SKU ', 'woocommerce' ),\n'value' =>  '' . $cart_item['data']->get_sku() . ' ',\n);\nreturn $cart_item_data;\n\n}\nadd_action( 'wp_footer', 'cart_update_qty_script' );\nfunction cart_update_qty_script() {\nif (is_cart()) :\n?>\n\nvar $ = jQuery;\n$('div.woocommerce').on('change', '.product-quantity .quantity input[id^=\"quantity\"]', function()\n{\n        var qty = $(this).val();\n        var sku = $(this).closest('tr.cart_item').find('.product_sku').html();\n        alert(\"Your have changed the quantity of \" + sku + \" to \" + qty + \".\");\n        \n        $(\"[name='update_cart']\").prop(\"disabled\", false);\n        $(\"[name='update_cart']\").trigger(\"click\");\n        \n    });\n\n</script>\n\n<?php\nendif;\n\n}\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405776", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Can you edit WP gutenberg block css without a plugin? I want to add custom css to my gutenberg table block. I want to adjust the css width of the tds. Ive tried selected the \"Fixed Width table cells\" toggle but the table seems to have different widths. Is there a way to do that because all of the plugins I have used dont seem to work. I tried adjusting the css in the theme.css and style.css files in css/dist/block-library folder. Do I need to compile it and that is why I am not seeing the changes?\nin the theme.css folder\n\n.wp-block-table td,\n.wp-block-table th {\n  padding: 0.5em;\n  border: 1px solid;\n  word-break: normal;\n  width:460px; //this is what i added\n}\n\n\nin the style.css folder\n.wp-block-table .has-fixed-layout td,\n.wp-block-table .has-fixed-layout th {\n  word-break: break-word;\n  width:460px; //this\n}\n.wp-block-table.alignleft td,\n.wp-block-table.alignleft th, .wp-block-table.aligncenter td,\n.wp-block-table.aligncenter th, .wp-block-table.alignright td,\n.wp-block-table.alignright th {\n  word-break: break-word;\n  width:460px; //this\n}\n.wp-block-table.is-style-stripes th,\n.wp-block-table.is-style-stripes td {\n  border-color: transparent;\n  width:460px; //this\n}\n\n\nA: One way to achieve this is to add a button to the Table Block in the editor. You create your Table, select the Table block, then click the button and the custom CSS is applied - then Publish.\nMove the code into a file in a new folder and call it from the functions file. Try this example...\nEdit: This has a custom colour - you may need to change that to get it working.\n/assets/custom.php\n    function custom_block_styles() {\n\n        register_block_style( \n            'core/table', \n            array(\n                'name' => 'blue-stripes',\n                'label' => 'Blue Stripes',\n                'inline_style' => '.wp-block-table.is-style-blue-stripes tbody tr:nth-child(2n+1) { background-color: var(--wp--preset--color--pale-blue);}.wp-block-table.is-style-blue-stripes td, .wp-block-table.is-style-blue-stripes th {border-color: transparent;padding: 0 2px;}.wp-block-table.is-style-blue-stripes td:nth-child(n+2) {border-left: 2px solid #eee;}',\n            )\n        );\n    }\n    add_action( 'init', 'custom_block_styles' );\n    \nfunctions.php\nrequire get_template_directory() . '/assets/custom.php';\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405778", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Choose whether to automatically add a taxonomy with the same name as the post I created a custom taxonomy within the blog post. It's called \"FootNotes.\" I would like there to be a checkmark inside in the creation of the post that asks me \"Are there any notes inside this post?\" If I choose \"yes\" it automatically creates within the custom taxonomy this \"note\" with the same name as the published article. Thank you\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405781", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to put search bar & logo in the \"primary navigation\" storefront theme? I'm using storefront theme for my shop, and here's the header\nI wanna put both the logo and search bar in in inside the primary navigation as I explain in screenshot.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405783", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using Ajax to submit a form, and run a SQL Select query based on user input from the form I'm creating a web form on my WordPress powered website. The form is intended to allow the user to enter a ZIP Code (aka postal code). When the user submits the form, the page should query a MySQL table, SELECT the rows which match the search criteria and dispense those values into a table on the same page.\nUnfortunately, I have been unsuccessful thus far.\nPer the example I followed, three components are necessary to query a SQL table from within a WordPress site:\n\n*\n\n*A form, written in PHP, which resides in the .php file for your page template\n\n*A function which actually executes the SQL query, added to your theme's functions.php file\n\n*A segment of Javascript code to tie the above two things together\n\nHere is what I have so far.\nFirst, the form code:\n<form type=\"post\" action=\"\" role=\"form\" id=\"DirectorySearchForm\" class=\"DirectorySerch\">\n    <p style=\"font-size: 16pt;\">Zip Code: <input style=\"font-size: 16pt;\" type=\"text\" name=\"inZip\" width=\"200\" height=\"32\"></p>\n    <input type=\"hidden\" name=\"action\" value=\"DirectorySearch\">\n    <input type=\"submit\" name=\"submit\" value=\"Search\" style=\"font-size: 18pt;\">\n</form>\n<div id=\"search_results\"></div>\n\nSecond, the function in functions.php:\nfunction DirectorySearch() {\n    global $wpdb;\n    echo \"33333\";   \n\n    $inZip = $_POST['inZip'];\n\n    $query = 'SELECT OrgName, Phone FROM directory_organizations WHERE Zip_Codes LIKE %s%';\n\n    $results = $wpdb->get_results( $wpdb->prepare($query, $inZip) );\n    echo $results;\n    die();\n}\nadd_action( 'wp_ajax_DirectorySearch', 'DirectorySearch' );    //If called from admin panel\nadd_action( 'wp_ajax_nopriv_DirectorySearch', 'DirectorySearch' );    //If called by non-user\n\nThird, the javascript sequence to tie the above two together.\n<script type=\"text/javascript\">\n(function($){               \n  // get our references\n  var $form = $('form.DirectorySerch'),\n      $inZip = $('#inZip'),\n      $results = $('#search_results');\n\n// on submit, do the search \n  $form.submit(function(e) {\n    e.preventDefault();\n    do_search();\n  });\n\n  // AJAX search call\n  function do_search() {\n\n    // grab the query value from the search field\n    var search_text = $search_field.val();\n\n    // do a POST ajax call\n    $.ajax({\n      type: \"POST\",\n      url: \"<?php echo admin_url('admin-ajax.php'); ?>\",\n      data: ({\n        action: \"DirectorySearch\",\n        search_text: search_text\n      }),\n      success: function (response){\n        console.log(response);\n        $results.html(response);\n      }     \n    });\n  }\n\n})(jQuery);\n</script>\n\nI'm a beginner, so I borrowed heavily from examples of others trying to accomplish the same thing. However, my web form does not generate a query result.\nCan anyone see what I might be doing wrong, or, alternatively, advise me on how to troubleshoot?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405786", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress server banning IP I am getting a weird problem with a client site. There is an existing WordPress working on it and has been working without any problem.\nI have deployed a mobile application that uses the WordPress API.\nSuppose my laptop and mobile app is connected to the same Internet Box. When using the mobile app, after I am unable to access the website even with my laptop. It seems as if the WordPress server or WordPress instance is banning my IP.\nTo be able to use access the site, I have to restart my Internet Box, after which it gets a new public IP, it is only then I am able to access the WordPress site.\nI am suspecting where there is an option somewhere which bans an IP if it requests too much data.\nAny suggestion to solve this problem?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405788", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to permanently show Word Counter on Create/Edit Page. Wordpress5.9.3 Hi everyone I'm newbie in Wordpress coding so please guide me as a newbie.. I want to show Permanent word counter on Page Create. any help would be really appreciated thanks\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405791", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add additional first page, last page links to the_posts_pagination() Is there a way to add additional first and last page links to the pagination object if it is rendere with the the_posts_pagination() method?\nAt this point I have the following\nthe_posts_pagination(\n              [\n                'screen_reader_text' => ' ',\n                'mid_size'  => 2,\n                'prev_text' => __( 'vorherige', 'bdb' ),\n                'next_text' => __( 'n\u00e4chste', 'bdb' ),\n              ]);\n\nand I would like to after prev_text a first page link if is not the first page and a last page link before next_text if is not the last page\n\nA: paginate_links() is probably what you want after playing a little with the params\n\nA: the_posts_pagination() is an echo wrapper for get_the_posts_pagination(). The getter generates pagination links with paginate_links(), which returns a string with the links separated by a newline character by default.\nThis string is passed to _navigation_markup() to get the complete pagination markup. We can manipulate the paginate_links() output with paginate_links_output filter, before the navigation markup is generated.\nThe filter recieves the default links string and pagination arguments as parameters. From $args you can get the total page count as well as the link format.\nHere's an example implementation where the filtering is limited to the specific use case by first adding the filter and then removing it after calling the pagination function. The custom template function would be used insted of the_posts_pagination() in template files.\nfunction my_pagination_link_url(array $args, int $current, string $text) {\n    // duplicated / modified from https://developer.wordpress.org/reference/functions/paginate_links/\n    $link = str_replace( '%_%', $args['format'], $args['base'] );\n    $link = str_replace( '%#%', $current, $link );\n\n    return sprintf(\n        '<a class=\"page-numbers\" href=\"%s\">%s</a>',\n        $link,\n        $text\n    );\n}\n\nfunction my_first_pagination_link(array $args) {\n  return my_pagination_link_url(\n    $args, 1, 'My first'\n  );\n}\n\nfunction my_last_pagination_link(array $args) {\n  return my_pagination_link_url(\n    $args, $args['total'], 'My last'\n  );\n}\n\n// $args, https://developer.wordpress.org/reference/functions/paginate_links/\nfunction my_add_links_to_pagination( $pagination_html, $args ) {\n    return implode('', [\n        my_first_pagination_link($args),\n        $pagination_html,\n        my_last_pagination_link($args),\n        // ...my everything?\n    ]);\n}\n\nfunction my_the_posts_pagination() {\n  add_filter( 'paginate_links_output', 'my_add_links_to_pagination', 10, 2 );\n\n  the_posts_pagination([\n    'screen_reader_text' => ' ',\n    'mid_size'  => 2,\n    'prev_text' => __( 'vorherige', 'bdb' ),\n    'next_text' => __( 'n\u00e4chste', 'bdb' ),\n  ]);\n\n  remove_filter( 'paginate_links_output', 'my_add_links_to_pagination', 10 );\n}\n\nP.S. Modify the filters and add logic as needed.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405795", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: ACF to select posts not displaying on blog page I am trying to implement a repeater / post object so I can select posts that I want to displaying on the sidebar. I am using this code:\n<?php while ( have_rows('top_posts_repeater')) : the_row(); // loop through the repeater fields ?>\n\n<?php // set up post object\n    $post_object = get_sub_field('selection');\n    if( $post_object ) :\n    $post = $post_object;\n    setup_postdata($post);\n    ?>\n\n<article class=\"your-post\"> \n\n    <?php the_title(); ?>\n    <?php the_post_thumbnail(); ?>\n    <?php // whatever post stuff you want goes here ?>\n\n</article>\n\n<?php wp_reset_postdata(); // IMPORTANT - reset the $post object so the rest of the page works correctly ?>\n\n<?php endif; ?> \n\n<?php endwhile; ?>\n\nThe code works if I insert it on any page but it doesn't work if I insert it in the blog page. What am I missing?\n\nA: a global $post;  before your loops might do the job\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405802", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to see which sites use my installed plugins (wordpress multisite) How can I (easily) determine which of my wordpress sites are using a given plugin, on a Wordpress Multisite install?\nLet's say I have 1,000 wordpress sites on a Wordpress Multisite install. I have 100 plugins.\nFor each plugin, I want to list all of the sites that are using that plugin.\nIn the GUI, I can only see how this can be done in about 1 million clicks. Is there a query I can run against the DB (and maybe cleanup with bash/awk/etc) that will automatically\n\n*\n\n*Get all of the plugins installed\n\n*For each plugin, list all of the sites that use that plugin (by site-id is fine)\n\nWhat's a fast way to determine all of the sites that use each of my installed plugins on Wordpress Multisite?\n\nA: You can list the sites a plugin has been activated on in the shell using WP CLI:\nsites=$(wp site list --field=url)\nfor url in $sites; do\n    if wp plugin is-active \"YOURPLUGINNAME\" --url=\"${url}\" --network; then\n        echo \"${url}\"\n    fi\ndone\n\nIt will print out the URL of each site on its own line that has that plugin activated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405807", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Filter post by current 2 differents users id I'm filtering my custom post type based on author. I want all users to be able to:\n1 - in the list everyone can see the posts created by the admin.\n2 - users can also see their own posts in the list, but not those of other users.\nI can list by admin id only or current user id only, but not both.\nCode:\nfunction list_cpt_by_author_id(){\n    $user = new WP_User(get_current_user_id());\n   \n$authors_id = array(\n    array('author' => \"1\"),\n    array('author' => \"$user\"),\n);\n    \n    $custom_terms = get_terms('custom-tax');\n        foreach($custom_terms as $custom_term) {\n            wp_reset_query();\n            $args = array(\n                'post_type' => 'artigos',\n                'tax_query' => array(array('taxonomy' => 'custom-tax','field' => 'slug','terms' => $custom_term->slug,),),\n                $authors_id,);\n    \n    \n             $loop = new WP_Query($args);\n             $image = get_field( 'cat_imagem', $custom_term );\n    \n             //Taxonomies Loop\n             if($loop->have_posts()) {\n                echo '<h2>'.$custom_term->name.'</h2>';\n                echo '<img src=\"'.$image.'\"/>';\n                \n                //Post loop\n                while($loop->have_posts()) : $loop->the_post();\n                    echo '<a href=\"'.get_permalink().'\">'.get_the_title().'</a><br>';\n                endwhile;\n             }\n            wp_reset_postdata(); // reset global $post;\n        }\n    }\n\nCan anyone give me any tips?\nUPDATE\nThanks to @ali Sh help  I did: 'author' => $adm_u_id .',' . $u_id_c\n$adm_u_id so I can list any future editor ids and $u_id_c to list the userid of the current user.\n\nA: Based on wordpress reference for WP_QUERY you can use author__in to filter by more than one author. It uses an array of user ids. Here is your code with the needed changes:\nfunction list_cpt_by_author_id(){\n    $user = get_current_user_id();\n   \n$authors_id = array(\"1\", $user);\n\n    \n    $custom_terms = get_terms('custom-tax');\n        foreach($custom_terms as $custom_term) {\n            wp_reset_query();\n            $args = array(\n                'post_type' => 'artigos',\n                'tax_query' => array(array('taxonomy' => 'custom-tax','field' => 'slug','terms' => $custom_term->slug,),),\n                'author__in' => $authors_id,\n            );\n    \n    \n             $loop = new WP_Query($args);\n             $image = get_field( 'cat_imagem', $custom_term );\n    \n             //Taxonomies Loop\n             if($loop->have_posts()) {\n                echo '<h2>'.$custom_term->name.'</h2>';\n                echo '<img src=\"'.$image.'\"/>';\n                \n                //Post loop\n                while($loop->have_posts()) : $loop->the_post();\n                    echo '<a href=\"'.get_permalink().'\">'.get_the_title().'</a><br>';\n                endwhile;\n             }\n            wp_reset_postdata(); // reset global $post;\n        }\n    }\n\nP.S. I also found out that you are passing WP_USER object to $authors_id, but you only need the user's id.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405815", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: wordpress fcm plugin not working on scheduled posts correctly I am very new to wordpress/php, I don't fully understand it yet.\nSo I've implemented firebase cloud messaging in a wordpress app and I am able to send push notifications with \"FCM Push Notification from WP\" plugin, and it also works with scheduled posts IF the admin panel is open when the scheduled post is due. Otherwise it will send the notification when I browse to the admin panel. I really don't understand this code fully, but what could I do to make sure it runs even though I am not logged in as admin?\n\n\nAny help would be really appreciated.\nRegards\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405822", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Order by the first array within a meta_query I would like to sort the output of my WP Query. I want the events that are coming up soon to be at the beginning. The events that have already taken place should be at the end. So the first array in my meta_query should be output first, then the second array.\n    $the_query = new WP_Query( \n        array( \n            'post_type'         => 'page',\n            'post_status'       => 'publish',\n            'posts_per_page'    => $posts,\n            'meta_key'          => 'datum-von',\n            'orderby'           => 'meta_value upcoming_events',\n            'order'             => 'ASC',\n            'post__in'          => array(22888,23062,23065,23348),\n            'meta_query'        => array(\n                'relation' => 'OR',\n                'upcoming_events' => array(\n                    'key' => 'datum-von',\n                    'value' => date('Y-m-d'),\n                    'compare' => '>=',\n                    'type' => 'DATE'\n                ),\n                'past_events' => array(\n                    'key' => 'datum-von',\n                    'value' => date('Y-m-d'),\n                    'compare' => '<=',\n                    'type' => 'DATE'\n                )\n            ),\n        )\n    );\n\nDoes anyone have an idea how I can control the sorting? Thanks for reading!\n\nA: You can use get_posts() for both event types and merge them.\n$merged_events = array();\n\n$upcoming = get_posts(array(\n    /* Your upcoming events args here. */\n));\n\n$past = get_posts(array(\n    /* Your past events args here. */\n));\n\n$merged_events = array_merge( $upcoming, $past);\n\nforeach( $merged_events as $merged_event ) {\n    //Your loop\n}\n\n\nA: Thanks for the input! That's how I built my code now. But the \"posts_per_page\" can't be controlled by the arrays now. It will always output all posts.\nadd_shortcode( 'display_events', 'display_events' );\nfunction display_events( $atts ) {\n    \n    extract( shortcode_atts( array (\n        'posts' => -1,\n    ), $atts ) );\n    \n    $args1 = array(\n            'post_type'         => 'page',\n            'post_status'       => 'publish',\n            'posts_per_page'    => $posts,\n            'meta_key'          => 'datum-von',\n            'orderby'           => 'meta_value',\n            'order'             => 'ASC',\n            'post__in'          => array(22888,23062,23065,23348),\n            'meta_query'        => array(\n                array(\n                    'key' => 'datum-von',\n                    'value' => date('Y-m-d'),\n                    'compare' => '>=',\n                    'type' => 'DATE'\n                )\n            )\n    );\n \n    $loop1 = new WP_Query($args1);\n \n    $args2 = array(\n            'post_type'         => 'page',\n            'post_status'       => 'publish',\n            'posts_per_page'    => $posts,\n            'meta_key'          => 'datum-von',\n            'orderby'           => 'meta_value',\n            'order'             => 'ASC',\n            'post__in'          => array(22888,23062,23065,23348),\n            'meta_query'        => array(\n                array(\n                    'key' => 'datum-von',\n                    'value' => date('Y-m-d'),\n                    'compare' => '<=',\n                    'type' => 'DATE'\n                )\n            )\n    );\n \n    $loop2 = new WP_Query($args2);\n\n    $the_query = new WP_Query();\n    $the_query->posts = array_merge($loop1->posts, $loop2->posts);\n    $the_query->post_count = $loop1->post_count + $loop2->post_count;\n\n        while ($the_query->have_posts()) {\n            $the_query->the_post();   \n            \n            // display the data\n            the_title();\n        } else {\n        // no posts found\n        }\n    wp_reset_postdata();\n}\n\n\nAny idea how to limit the posts_per_page in this situation?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405823", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: date_query empty results with custom post type I am trying to use get_posts to return data between certain dates but I always get an empty result even though there is a lot of data. This is for a custom post type.\n$args = array(\n        'post_type' => 'bookings',\n        'fields' => 'ids',\n        'post_status' => 'any',\n        'posts_per_page' => -1,\n        'date_query' => array(\n            array(\n                'after' => '2022-01-01',\n                'before' => '2022-06-01',\n                'inclusive' => true,\n            ),\n        )\n    );\n\n$data = get_posts($args);\ndie(var_dump($data));\n\nI also tried something like the below to get a specific date but still an empty array:\n    'date_query' => array(\n        array(\n            'year'  => 2022,\n            'month' => 01,\n            'day'   => 21,\n        ),\n    )\n\n\nA: Assuming that you're trying to get all posts in the first half of 2022, as opposed to the first 6 days of 2022, then you need to be clearer with your before and after dates.\ndate_query uses strtotime behind the scenes, which will interpret your dates as Jan 1 to Jan 6. You need to either change the dates to the American format of YYYY-DD-MM, or be more specific by using arrays to express your dates instead.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405831", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Cannot get wpdb data (Error in a simple fuction) I'm using Cryto Plugin and want to get coin price data from plugin db.\n\nFor easy practice, I'm trying to get BTC data.\n<?php function get_coin_price($coin_symbol) {\n  global $wpdb;\n\n  $coin_price = $wpdb->get_var($wpdb->prepare(\"SELECT price FROM {$wpdb->prefix}cmc_coins_v2 WHERE symbol = '%s'\", $coin_symbol));\n\n  return $coin_price;\n}?>\n\nAnd if I want to get BTC price, I use this code.\n<?php get_coin_price(BTC); ?>\n\nHowever I'm getting this error  \"Use of undefined constant BTC - assumed 'BTC' (this will throw an Error in a future version of PHP)\"  Is there a problem in data type? or maybe am I not using $wpdb->get_var or wpdb->prepare correctly?\n\nA: What about changing BTC to a string\n<?php get_coin_price('BTC'); ?>\n\nA: should be a comment but can't.\nyour error just says that in <?php get_coin_price(BTC); ?>  BTC is considered a variable but is not defined and compiler assume the variable as a string, it doesn't seems to crash your script, but still should be used like so <?php get_coin_price(\"BTC\"); ?>\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405832", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Updating product image I have been having this problem recently, I want to update quite a few product images on my website with updated versions.\nI save the image with the exact same name and upload via FTP to my server, to my understanding it is either going to replace the current image or create a duplicate( save the image name with a -1 e.g. Ap2018-1). But neither of that happens. Both images are there with the exact same name but the old image is still being used.\n\nA: Propably you replace only original versions of images, but wordpress create a few this same images with different sizes.\nAfter upload your photos you should regenerate thumbnails on wordpress dashboard.\nYou can use for it:\nhttps://pl.wordpress.org/plugins/regenerate-thumbnails/\nor little advanced: https://pl.wordpress.org/plugins/regenerate-thumbnails-advanced/\nWhen you regenerated thumbnails, images should be correctly displayed.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405836", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hook \"wp_trash_post\" executing multiple time in case of bulk trash products I am currently using hook wp_trash_post to trigger my custom API when a WooCommerce Product is trashed.\nThis is working fine for the case of single trash.\n\nBut, in case of Bulk trash this event is executing multiple times. for example if 3 products are selected to trash then this event will trigger 3 times.\n\nI need different event for Bulk Trash which will execute one time but having all of product ids.Hopefully it is clear to understand.\nPlease Help!\n\nA: Custom (database) Queue\nOne way would be to create a custom database table, and write to it the product id, each time a product is trashed via the trashed_post hook.\nThen you can bulk process the collected trashed product ids via e.g. wp-cron and the user will not be affected by that potentially heavy processing.\nWith a real cron (not wp-cron) you could better control the timing/frequency of the processing.\nThis approach should also work if the products are trashed e.g. via wp-cli.\nSimilarly one could remove a product id from the custom table (or flag it) when the untrashed_post hook is fired for products.\nPHP Class and WP Hooks\nOne might also create a PHP class and use it to hook into trashed_post/untrashed_post and collect (e.g. via PHP queue object within the class) all product ids and then at a later hook, process all at once. The user might notice this for heavy processing or slow external API requests, unless it uses some async workarounds or in addition uses the custom database approach mentioned above.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405838", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Ajax callback not work My files is :\nsynergyservice.php\nregister_activation_hook( __FILE__, array( 'Synergy', 'plugin_activation' ) );\nregister_deactivation_hook( __FILE__, array( 'Synergy', 'plugin_deactivation' ) );\n\nif ( is_admin() || ( defined( 'WP_CLI' ) && WP_CLI ) ) {\n    require_once( __DIR__ . '/environments.php' );\n    require_once( SYNERGY__PLUGIN_DIR . 'class.synergyservices.php' );\n    require_once( wp_normalize_path (SYNERGY__PLUGIN_DIR . 'admin/Helpers/class.helper.php' ) );\n\n    add_action( 'init', array( 'Synergy', 'init' ) );\n\n    require_once(  wp_normalize_path(SYNERGY__PLUGIN_DIR . 'admin/Classes/class.synergy-admin.php') );\n    add_action( 'init', array( 'Synergy_admin', 'init' ) );\n}\n\nclass-synergyservice.php\n<?php\n\nclass Synergy{\n\n    private static bool $initiated = false;\n\n    public static function init(): void\n    {\n        if ( ! self::$initiated ) {\n            self::init_hooks();\n        }\n    }\n\n    /**\n     * Initializes WordPress hooks\n     */\n    private static function init_hooks(): void\n    {\n        self::$initiated = true;\n\n        Synergy_admin::init();\n\n    }\n\n\n    /**\n     * Attached to activate_{ plugin_basename( __FILES__ ) } by register_activation_hook()\n     * @static\n     */\n    public static function plugin_activation(): void\n    {\n        if ( version_compare( $GLOBALS['wp_version'], SYNERGY__MINIMUM_WP_VERSION, '<' ) ) {\n\n            load_plugin_textdomain( 'synergy', false, SYNERGY__WP_PLUGIN . '/languages/' );\n\n        } elseif ( ! empty( $_SERVER['SCRIPT_NAME'] ) && false !== strpos( $_SERVER['SCRIPT_NAME'], '/wp-admin/plugins.php' ) ) {\n            add_option( 'Activated_SynergyService', true );\n        }\n    }\n\n    /**\n     * Removes all connection options\n     * @static\n     */\n    public static function plugin_deactivation( ): void\n    {\n\n    }\n\n}\n\nclass-contact.php\n<?php    \nif( !class_exists('Synergy_contact')) {\n    class Synergy_contact {\n\n        private static bool $initiated = false;\n\n        public static function init(): void\n        {\n            if ( ! self::$initiated ) {\n                self::init_hooks();\n            }\n        }\n\n        public static function init_hooks(): void {\n\n            self::$initiated = true;\n            \n            wp_register_script( 'contacts.js', plugin_dir_url( __FILE__ ) . '/../../js/contacts.js', array('jquery'), SYNERGY__VERSION );\n\n            $title_nonce = wp_create_nonce( 'synergy_nonce_form_contact' );\n\n            wp_localize_script(\n                'contacts.js',\n                'ajax_obj_form_contact',\n                array(\n                    'ajax_url' => admin_url( 'admin-ajax.php' ),\n                    'nonce'    => $title_nonce,\n                )\n            );\n\n            wp_enqueue_script( 'contacts.js' );\n\n            add_action('wp_ajax_get_data_from_form', 'get_data_from_form' );\n            add_action('wp_ajax_nopriv_get_data_from_form', 'get_data_from_form');\n\n               // render my view to use script\n\n\n            }\n\n        }\n            public function get_data_from_form(){\n        echo \"a\";\n        wp_die('ub');\n\n    }\n\n}\n\nMy script:\njQuery.ajax({\n    type: \"POST\",\n    url: ajax_obj_form_contact.ajax_url,\n    // _ajax_nonce: ajax_obj_form_contact.nonce,\n    // dataType: \"JSON\",\n    data: {\n        action : 'get_data_from_form',\n    }\n  });\n\nError 404 bad request. Response 0 from wp-admin.\nI see on $GLOBALS['wp_filter'] my hook and found it.\nI guess problem is instance of class, because I try to NOT use auto-instance at end of file class, and wp-admin cannot found method.\nI try run do_action(my_hook) and it's work.\nIs it a bad practice not to instantiate the class at the end of the file?\nAnyone can help me?\nBest regards,\n\nA: The problem is a basic PHP issue, you told WordPress to call a function named get_data_from_form when the wp_ajax_get_data_from_form action happens]\nadd_action('wp_ajax_get_data_from_form', 'get_data_from_form' );\n\nBut no function with that name exists.\nSure you have a class with a function inside it that exists, but that's not the same. Think of it this way, if there was a function get_data_from_form() {} in another file, how would it know the difference between that and the static member function inside your class? What if another class had a function with the same name? PHP doesn't know, and it can't know unless you tell it.\nSo instead, you need to change it from a string that contains the name of a top level function, to a reference to your static class function. E.g. [ 'Foo', 'Bar' ]. I strongly recommend reading the callable type documentation, particularly the examples at:\nhttps://www.php.net/manual/en/language.types.callable.php\n\nIs it a bad practice not to instantiate the class at the end of the file?\n\nIt's good practice not to instantiate the class, but at no point in your code do you ever instantiate it. All your class methods are static, and there is no object oriented code here. Functions in a namespace would have been functionally identical and simpler.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405842", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add wp_add_inline_style into another wp_add_inline_style for better performance function loadOneStylePage(){\n  wp_enqueue_style( 'main-style', get_template_directory_uri() . '/styles/main.css', array(), _S_VERSION );\n  wp_enqueue_style( 'main-style-separate-file', get_template_directory_uri() . '/styles/main.css', array(), _S_VERSION );\n  \n  //i would like to merge the two files?\n  wp_add_inline_style( 'main-style-separate-file', 'main-style' );\n}\nadd_action('wp-enquueue_scripts', 'loadOneStylePage');\n\nIdeally, I would like to put these two together as 1 file. I know i can merely edit the single file and plainly add all the css together but for the sake of creating a custom theme and providing additional options is never bad.\nI know the wp_add_inline_style api merges inline styling but is there a way to merge actual files?\n\nA: No, there\u2019s no function to merge files like that. If you want a single CSS file you need to make a single CSS file.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405848", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Event Organiser - Display Current Event Date for Recurring Events In the event display, if it's a recurring event, the 'current' date (date selected from calendar - not today's date) for the event does not display - only next date/dates.  I need to add a simple line above the Next info that simply says 'Date:' with the current event's date/time being displayed. (Exactly as is displayed for one-time-only events)\nI tried using eo_get_current_occurrence_of but couldn't seem to get to where I needed to get.  I don't see this function being used anywhere, so wondering if it's no longer in use/usable.  No matter, I feel quite incompetent not being able to figure this out.\nCurrently testing on test.napamethodist.org\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405851", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What is the best way to cache pages and queries in WordPress? I have a site with many custom queries. Some take many seconds to load a page. To solve that issue, I have been using a caching plugin. The issue is, my caching plugin does not cache a page until I click it once. I'd prefer to do this entire process without a plugin if possible. If the plugin route is the best way to go, I'd love to know that too.\nI have an idea that this is how it SHOULD work, but I'd love to be corrected if this is impossible or not the best way...\nWhen I upload a new post, I'd like the system to automatically cache all queries associated with the post, and save them to display to the user. If I add a new artist, I'd like their artist page to automatically be cached into the database.\nI'd prefer the user to never have to wait for a query, and instead to only see results of queries, printed.\nThe only 'live' part of the site needs to be the discussion forums and comment sections.\nIs there a way to add to the code something like (on my side)\"When i add a new post, check to see if any queries are affected by this change, if not, run a new query and store the results of this, if so, update the query to include this new information.\"\nThen I want to display to the user only the result of the queries, filtered by the templates I have set up.\nis there a way to persistently cache custom groups of posts together? Like could I run a query called $post_object_1_results ? then instead of the user running the query, I want the information to be pulled ffrom $post_object_1_results AFTER the query is run. Does a persistent version of  wp_cache_set() and wp_cache_get(), exist?\nIs a plugin the best way? Thank you\n\nA: No, there isn't. WordPress does not provide page caching mechanisms, and has no APIs for it. There is no generic way to say example.com/page is now stale and needs recreating. Nor is there any generic way to pre-generate every page short of visiting them all. Every plugin uses a different solution with different APIs and storage mechanisms.\nAs for knowing which parts of the site are stale and need recreating when a post is saved, unfortunately you've ran into a fundamental computer science problem, cache invalidation. When a post gets updated, there are only a handful of places you can know for certain that require cache invalidation/flushing/refreshing:\n\n*\n\n*the posts main page\n\n*its RSS comment feed\n\n*its REST API response\n\nOtherwise the only way to know where else might feature the post to flush it out is to visit the page and generate it. You can proactively try to invalidate its post parent, term archives for terms it features in, but this is a heuristic with no guarantees, and doesn't cover page templates, plugin generated interfaces, or other places such as the homepage. It also assumes your expensive queries completed and were able to generate a page that could be cached to begin with.\n\nThe only 'live' part of the site needs to be the discussion forums and comment sections.\n\nIf your posts change rarely you could empty the entire cache on update, it's expensive but effective. You'd need to research the specific caching solution you're using though. Otherwise bypassing page caching for those parts of the site is a plugin specific endeavour. The solution for say WP Supercache will be completely different to that for WP Rocket or another plugin.\n\nwhat about wp_cache_set() and wp_cache_get(), is this the right kind of thinking?\n\nThis is the object cache, WordPress uses it to make sure it doesn't fetch the same post from the database twice. It's like cooking shows when they pull something from the under the counter and say \"here's something I prepared earlier\".\nThis won't fix your problem though, this cache is in memory only, so it's does not survive between page requests.\nYou can make it persist but it will require server software such as Redis/Memcached/Mongodb/etc and a suitable dropin PHP file to glue the two together. Most hosts do not provide this, and some managed/enterprise hosts provide it but do not give you the ability to configure it.\nEven then, to use it you would need to build a page caching plugin from scratch, which leaves you back where you are at the moment with the Hummingbird plugin with the same questions. Plugins that use these two functions to store full pages already exist, and it's very likely you've already used them yourself without realising.\nAn Alternative\nHTML is cheap and quick to render, it's the queries that are expensive, so why not cache those instead?\n\n*\n\n*cache the queries, especially those using meta_query\n\n*fetching posts is cheap and fast, but figuring out which posts to fetch is expensive, so cache the post IDs, not the HTML\n\n*store the results either in transients, post meta, or if available, a persistent object cache\n\nA Sidenote\nLots of people have these problems and find solutions who have never heard of WordPress, and people have struggled with caching for decades. There is no straightforward answer that can be recommended to you that you should install X, do Y, and Z will happen. Some solutions work very well, but won't work for you, and others will work but have caveats. Do you install something like varnish that sits infront of your server? Rely on a CDN like cloudflare? Do you cache for a very short time so the data is almost current, or permanently until told otherwise? etc etc. It's a game of tradeoffs, how current and recent do you want your data to be. Caching is no substitute for a fast page load, and ideally it's a way to scale your traffic, not the main thing making your pages load quickly/\n\nA: Ignoring some of the unique case details you provided, server-level page caching and object caching is nearly always the most efficient combination in terms of resource usage and scaling.\nSpecifically, LEMP stack is probably the most popular solution:\n\n*\n\n*Nginx FastCGI cache for page caching (caches all of the HTML output by PHP-FPM)\n\n*Redis object cache (you'll need an object-cache.php for WordPress too)\n\n*PHP OPcache keeps getting better and more configurable also\n\n\nIs there a way to add to the code something like (on my side)\"When i\nadd a new post, check to see if any queries are affected by this\nchange, if not, run a new query and store the results of this, if so,\nupdate the query to include this new information.\"\n\nThis is pretty much how object caching works, and WordPress supports it quite well... if your server doesn't have object cache installed, WordPress \"reverts\" to using transients instead, which are like temporary files stored directly in the database... if object cache exists, it will store that data in e.g. Redis instead.\nBut like Tom mentioned, if you have tons of unique queries (or even if you don't) the final output is not going to be cached until those pages are actually visited... you can automate this, which is called warming the cache, but I don't recommend it for most situations because it uses a lot of server resources and might not even prioritize the pages/queries that are the most important per se. In other words, by the time you warm the cache or create a custom scripting solution to do it, and use a bunch of server resources too, was it worth it vs. just letting the first user visit that content and cache it for you instead? Not often...\nIf your website truly has a massive amount of custom queries that are rarely being called twice, getting on a cloud server with NVMe drives and CPU-optimized is going to help a lot, and is quite affordable... many of the major cloud providers offer these now.\nAlternatively, if your site has lots of complex output, and many repeat hits, you could consider an output cache such Varnish which pretty much caches the hell out of the final code... but Varnish can be finicky and frustrating to optimize and manage, and I've seen it conflict with WordPress in some cases.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405852", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Event Organiser - Add text search for Calendar view As it stands, the Calendar View shows filters for Categories and Venues.  I need a 'filter' for text search.  We are looking for ability to search by topic, rather than category, for example - otherwise we have a huge number of categories - one for each topic - that is unwieldy.  (I would like this option for setting up event displays in the sidebar - so I could have sidebars for functional areas tied to particular pages)\nDoes such a thing exist?  How to start to create this?\nTHANK YOU\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405855", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can inactive WordPress plugins still load scripts? I recently deleted a contact form plugin (HubSpot All-In-One Marketing) on a site and the contact forms stopped working.\nCuriously, the forms work when the plugin is installed and INACTIVE, but they do NOT work when the inactive plugin is DELETED.\nThis means that the plugin being present is affecting the site even when it is inactive. How is this possible? How can a contact form work when a plugin is present and inactive, but not when the plugin is deleted? Can an inactive plugin load script files?\nNote: The full form code snippets are being included in the page (not shortcodes or anything else referring to the plugin).\n\nA: Many hypotheses could be made, but the most probable ones are that the theme or a third plugin loads the script if a specific option saved in the database has a certain value. If the plugin is installed but not active that hypothetical option still exists in the database, on the contrary, when you delete the plugin, it will delete that option.\nAnother hypothesis is that you think the plugin is deactivated, but a third plugin filters the option \"active_plugins\" in a mu-plugin, and on the frontend that plugin is active, even if in the page of plugins you see it disabled.\nAnother hypothesis is the script is loaded by a caching plugin, and it was a coincidence that when you deleted the plugin the cache was also deleted.\nYou can do also other suppositions, but without having more details you can only guess.\n\nA: The answer is already in your question:\n\nCuriously, the forms work when the plugin is installed and INACTIVE, but they do NOT work when the inactive plugin is DELETED.\n\n\nNote: The full form code snippets are being included in the page (not shortcodes or anything else referring to the plugin).\n\nThe plugin itself can't interfere with your site when it's deactivated, but that doesn't mean its files aren't accessible. If you're directly referencing JS and CSS files in the plugin from your code snippets then that bypasses activation/deactivation. None of the PHP will run however.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405856", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom field on Quick Edit using select/dropdown - almost working right but not showing currently selected value I'm new to WP plugin programming but have been tasked with the following.\nGOAL:\nCreate a plugin that does all the following:\n\n*\n\n*Set up default chat departments for each domain.\n\n*Create custom field using select dropdown to allow choosing alternate chat department for each page.\n\n*Create custom column in Quick Edit to show selected chat department. Column must be sortable.\n\n*Allow selection of alternate chat department on each page via Quick Edit screen (and optionally via regular edit screen which is currently working perfectly but can be discarded if it makes this easier to fix.)\n\nThrough many tutorials and StackExchange posts, I've managed to hobble together a plugin that actually does all 4 things, but #4 is buggy in the Quick Edit (works fine in page edit.) Here's my thoughts on what I did wrong, but not sure how to do it right:\n\n*\n\n*I named the custom column with the same name as the custom field - not sure if this is right or wrong but it was the only way I got it to pull the data in\n\n\n*I ended up copying the entire custom select code used for the pages onto the Quick Edit screen (I couldn't get it to appear any other way) and this duplication may be causing some of my problems (or other problems I'm not even aware of yet)\nAnd this is what's not working:\n\n*\n\n*In the Quick Edit, the select dropdown always shows Default (which has an empty value) even when the column shows the selected alternate chat department\n\n\n*Trying to work around the above problem, I added another field to show the CURRENT selected chat department. It's not working right - it's showing the first department listed in the column instead. I'm sure this is a scope issue, but I cannot figure out how to fix it.\nI'd prefer the select dropdown in Quick Edit to just show the current selected value (this works in Page Edit), but I'm ok with a separate field. I can't get either to work.\nHere's my entire plugin code, including the jquery that's in a 2nd file:\n<?php\n/**\n * Plugin Name: Chat Dept Routing\n * Description: Add Chat code with department routing\n * Version: 1.0\n * Author: Me\n */\n /**\n * Register meta boxes.\n */\n\n// action to add meta boxes\nadd_action( 'add_meta_boxes', 'cdr1_register_meta_boxes' );\n// action on saving post\nadd_action( 'save_post', 'cht_dept_dropdown_save' );\n\n// function that creates the new metabox that will show on post\nfunction cdr1_register_meta_boxes() {\n    add_meta_box( \n        'chat_dept_dropdown',  // unique id\n        __( 'Chat Department', 'mytheme_textdomain' ),  // metabox title\n        'chat_dept_dropdown_display',  // callback to show the dropdown\n        'page'   // post type\n    );\n}\n\n// chat department dropdown display\n// show the current value of the dropdown\nfunction chat_dept_dropdown_display( $post ) {\n\n  // Use nonce for verification\n  wp_nonce_field( basename( __FILE__ ), 'chat_dept_dropdown_nonce' );\n\n  // get current value\n  $dropdown_value = get_post_meta( get_the_ID(), 'chat_dept_dropdown', true );  \n  $chatdept = get_post_meta( get_the_ID(), 'chat_dept_dropdown', true );\n  ?>\n        <div id=\"chat-dropdown-options\">\n        <p>Choose Chat Dept for This Page:</p>\n    <select name=\"chat_dept_dropdown\" id=\"chat_dept_dropdown\">\n     <option value=\"ChatDept1\" <?php selected( $selected, 'ChatDept1', false ); if ( $chatdept == 'ChatDept1' ) echo 'selected=\"selected\"'; ?>>ChatDept1</option>\n     <option value=\"ChatDept2\" <?php selected( $selected, 'ChatDept2', false ); if ( $chatdept == 'ChatDept2' ) echo 'selected=\"selected\"'; ?>>ChatDept2</option>\n     <option value=\"ChatDept3\" <?php selected( $selected, 'ChatDept3', false ); if ( $chatdept == 'ChatDept3' ) echo 'selected=\"selected\"'; ?>>ChatDept3</option>\n     <option value=\"\" <?php selected( $selected, '', false ); if ( $chatdept == '' ) echo 'selected=\"selected\"'; ?>>Default</option>\n    </select>\n        </div>\n  <?php\n}\n\n// dropdown saving\nfunction cht_dept_dropdown_save( $post_id ) {\n\n    // if doing autosave don't do nothing\n  if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) \n      return;\n\n  // verify nonce\n  if ( !wp_verify_nonce( $_POST['chat_dept_dropdown_nonce'], basename( __FILE__ ) ) )\n      return;\n\n\n  // Check permissions\n  if ( 'page' == $_POST['post_type'] ) \n  {\n    if ( !current_user_can( 'edit_page', $post_id ) )\n        return;\n  }\n  else\n  {\n    if ( !current_user_can( 'edit_post', $post_id ) )\n        return;\n  }\n\n  // save the new value of the dropdown\n  $new_value = $_POST['chat_dept_dropdown'];\n  update_post_meta( $post_id, 'chat_dept_dropdown', $new_value );\n}\n\n// load chat\n\nadd_action('wp_footer', 'load_chat_department');\nfunction load_chat_department() {\n$chatdept = get_post_meta( get_the_ID(), 'chat_dept_dropdown', true );\nswitch ($chatdept) {\n                case \"ChatDept1\":\n                        $dept_dept = \"ChatDept1\";\n                        $message = \"found dept\";\n                break;\n                case \"ChatDept2\":\n                        $dept_dept = \"ChatDept2\";\n                        $message = \"found dept\";\n                break;\n                case \"ChatDept3\":\n                        $dept_dept = \"ChatDept3\";\n                        $message = \"found dept\";\n                break;\n                default:\n                        $dept_dept = \"DefaultChatDept\";\n                        $message = \"dept not found\";\n                break;\n        };\n$current_domain = \"https://\".$_SERVER['HTTP_HOST'];\nswitch ($current_domain) {\n                case \"https://domain1.com\":\n                        $domain_widgetcode = \"widgetcode1\";\n                        $domain_defaultdept = \"ChatDept1\";\n                        $message2 = \"found domain\";\n                break;\n                case \"https://domain2.com\":\n                        $domain_widgetcode = \"widgetcode2\";\n                        $domain_defaultdept = \"ChatDept2\";\n                        $message2 = \"found domain\";\n                break;\n                case \"https://domain3.com\":\n                        $domain_widgetcode = \"widgetcode3\";\n                        $domain_defaultdept = \"ChatDept3\";\n                        $message2 = \"found domain\";\n                break;\n                default:\n                        $message2 = \"domain not found\";\n                break;\n    };\n    \n    if ($message === \"dept not found\" && $message2 === \"found domain\") {\n            $widgetcode = $domain_widgetcode;\n            $dept = $domain_defaultdept;\n    }\n    else if ($message === \"found dept\" && $message2 === \"found domain\") {\n            $widgetcode = $domain_widgetcode;\n            $dept = $chatdept;\n    }\n    else {\n            $widgetcode = \"\";\n            $dept = \"\";\n    }\n// add chat code to footer - currently just echoing variable values to confirm everything is working\necho \"widgetcode: \" . $widgetcode . \"<br/>\";\necho \"department: \" . $dept . \"<br/>\";\necho $message . \" and \" . $message2 . \"<br/>\";\necho $chatdept . \"<br/>\";\necho $_SERVER['HTTP_HOST'];\n}\n\n// Add to admin screen\nadd_filter('manage_pages_columns', 'chat_dept_add_column', 5);\nadd_action('manage_pages_custom_column', 'chat_dept_add_column_values', 5, 2);\n\n// Add new columns to admin screen\nfunction chat_dept_add_column($defaults){\n    // field vs displayed title\n    $defaults['chat_dept_dropdown'] = __('ChatDept');\n    return $defaults;\n}\n\n// Populate the new columns with values\nfunction chat_dept_add_column_values($column_name, $postID){\n    if($column_name === 'chat_dept_dropdown'){\n        echo get_post_meta($postID,'chat_dept_dropdown',TRUE);\n    }\n    else {\n            echo 'None';\n        }\n        \n}\n// Add current dept and dropdown to quick edit\nadd_action( 'quick_edit_custom_box', 'source_custom_edit_box', 10, 2 );\nfunction source_custom_edit_box( $column_name, $post_type ) {\n    global $post;\n        $post = get_post();\n        $get_chat_dept = get_post_meta( $post->ID, 'chat_dept_dropdown', true );\n    switch ( $post_type ) {\n        case 'page':\n\n        if( $column_name === 'chat_dept_dropdown' ):\n        ?>\n        <fieldset class=\"inline-edit-col-right\" id=\"#edit-current-dept\">\n                <label>                 \n                    <span class=\"title\"><strong>Current Dept:</span>\n                    <span class=\"input-text-wrap\"><strong><?php echo $get_chat_dept; ?></strong><br/> </span>\n                </label>\n                <label>\n                    <span class=\"title\"><strong>New Dept:</strong></span>\n                    <span class=\"input-text-wrap\">\n                        <div id=\"copy-chat-dropdown-options\">\n                        <!-- copy the select exactly from div id chat-dropdown-options above -->\n                            <select name=\"chat_dept_dropdown\" id=\"chat_dept_dropdown\">\n                             <option value=\"ChatDept1\" <?php selected( $selected, 'ChatDept1', false ); if ( $chatdept == 'ChatDept1' ) echo 'selected=\"selected\"'; ?>>ChatDept1</option>\n                             <option value=\"ChatDept2\" <?php selected( $selected, 'ChatDept2', false ); if ( $chatdept == 'ChatDept2' ) echo 'selected=\"selected\"'; ?>>ChatDept2</option>\n                             <option value=\"ChatDept3\" <?php selected( $selected, 'ChatDept3', false ); if ( $chatdept == 'ChatDept3' ) echo 'selected=\"selected\"'; ?>>ChatDept3</option>\n                             <option value=\"\" <?php selected( $selected, '', false ); if ( $chatdept == '' ) echo 'selected=\"selected\"'; ?>>Default</option>\n                            </select>\n                        </div>\n                    </span>\n                </label>\n        </fieldset>\n        <?php\n        endif;\n            break;\n        default:\n            break;\n    }\n}\n\nadd_action( 'save_post', 'update_source_custom_edit_box' );\nfunction update_source_custom_edit_box() {\n    if( isset( $_POST ) && isset( $_POST['chat_dept_dropdown'] ) ) { \n        update_post_meta($_POST['post_ID'], 'chat_dept_dropdown', $_POST['chat_dept_dropdown']);\n    }\n    return;\n}\n\n// RETRIEVE FIELDS with JS\nadd_action( 'admin_enqueue_scripts', 'enqueue_admin_scripts_and_styles' ); \nfunction enqueue_admin_scripts_and_styles(){\n    wp_enqueue_script('quick-edit-script', plugin_dir_url(__FILE__) . '/extend-quick-edit.js', array('jquery','inline-edit-post' ));\n}\n\n// make sortable\nfunction manage_chatdept_sortable_columns( $columns )    {\n    $columns['chat_dept_dropdown'] = 'ChatDept';\n    return $columns;\n}\nadd_filter( 'manage_edit-page_sortable_columns', 'manage_chatdept_sortable_columns');\n\nfunction ws_orderby_custom_column( $query ) {\n    global $pagenow;\n\n    if ( ! is_admin() || 'edit.php' != $pagenow || ! $query->is_main_query() || 'post' != $query->get( 'post_type' ) )  {\n        return;\n    }\n\n    $orderby = $query->get( 'orderby' );\n\n    switch ( $orderby ) {\n        case 'chat_dept_dropdown':\n            $query->set( 'meta_key', 'chat_dept_dropdown' );\n            $query->set( 'orderby', 'meta_value' );\n            $query->set( 'order', 'DESC' );\n            $query->set( 'posts_per_page', '-1' );\n            break;\n\n        default:\n            break;\n    }\n\n}\nadd_action( 'pre_get_posts', 'ws_orderby_custom_column' );\n?>\n\nAnd here's the jquery (copied from somewhere and it worked beautifully!)\njQuery(document).ready(function($){\n\n    var $inline_editor = inlineEditPost.edit;\n    inlineEditPost.edit = function(id){\n\n        $inline_editor.apply( this, arguments);\n\n        var post_id = 0;\n        if( typeof(id) == 'object'){\n            post_id = parseInt(this.getId(id));\n        }\n\n        if(post_id != 0){\n            $post_modified_col_value = $('#post-' + post_id).find('.chat_dept_dropdown').text();    \n            $('#edit-' + post_id + ' input[name=chat_dept_dropdown]').val($post_modified_col_value);\n        }\n    }\n\n});\n\nEdit to add: I've just realized the sorting of the column isn't working right either (it appears to be grouping the pages with values together, but I cannot tell how it's being ordered, it's weird.) I'll address this in a separate question later.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405857", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there way to toggle the publish date display? I am interested in changing our WP dashboard so that I can choose whether an individual Post will include the publish date or not. Is there a way to do it without a plug-in and insert code that maybe creates a checkmark or something like that in the Post dashboard that can toggle the publish date display? Thank you in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405862", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Order WP_Query by The Order of an Array in Tax_Query I have a wp_query that uses tax_query to which I pass an array of taxonomy term IDs. I'd like to order my results based on the order of that array but can't get it to work and searching has got me nowhere. Example code below for reference. So this code actually orders the results by tax terms (dumb luck?) but the tax terms aren't in the same order as $term_array. I've tried all the logical options for the 'orderby' parameter but nothing works that I've found.\nI guess I could do a foreach on the $term_array but that seems like it would not be the most performant way to do it. Is there a better way?\nAny ideas?\n$term_array = array(3,5,1,4,2);\n\n$args = array(\n                'post_type'      => 'product',\n                'post_status'    => 'publish',\n                'posts_per_page' => -1,\n                'orderby'        => 'menu_order',\n                'order'          => 'ASC',\n              'tax_query' => array(\n                array(\n                  'taxonomy' => 'product-brands',\n                  'field' => 'term_id',\n                  'terms' => $term_array,\n                  'operator' => 'IN'\n                ), \n                array(\n                  'taxonomy' => 'product_cat',\n                  'field' => 'term_id',\n                  'terms' => $main_product_cats\n                ), \n              ), \n              'post__not_in' => $not_sold,\n            );\n\n      \n            $loop = new WP_Query( $args );\n            \n            if ( $loop->have_posts() ) { ... stuff ... }\n\n\nResults are 1,2,3,4,5 and not the 3,5,1,4,2 order of $term_array\n\nA: You have\n'orderby' => 'menu_order',\n'order' => 'ASC',\n\nthese lines define the order of the posts.\n'terms' => $term_array\n\nit's only define posts that have taxonomy with these is, the order doesn't matter.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405865", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Speed up / Optimize Admin Edit Post Page on Large Websites (50-150k posts, 50 custom fields per post) I'm working with a set of large Wordpress installs with 50-150k posts, each with 40-50 custom fields.  The installs are very basic, with limited plugins (less than 5), and a default Wordpress theme (i.e. twenty twelve, etc.).  The sites are on 1-Core, 2GB RAM, SSD VPS servers.\nThese are all private installs, with no public front-end or web traffic.  Automatic updater, auto-update core, and revisions are all disabled.\nI have no featured images or other media on the edit post page; Only text.  The sites are on Wordpress 5.6 or later (I understand they could be updated to 5.9.3, but doubt that is the issue).\nThe admin edit post page hangs for 25-45 seconds when accessed, and then finally loads.  Is there any way to fix or speed this up on a large, basic wordpress install?  It appears to be a problem in loading a large amount of custom field data, with 50-100k+ posts.\nHere's what I've found:\n\n*\n\n*Most other wp-admin pages such as categories, tags, pages, users, settings, etc. load quickly in a few seconds (3 seconds or less).  The \"All Posts\" page takes a little longer at about 8-10 seconds or so.\n\n*If I don't use the classic editor plugin, and don't enable the custom fields section to load in the new block editor, the edit page will load quickly as well (3 seconds or less).\n\n*Disabling any other (or even all plugins) has no effect.\n\n*I can load the front-end post page, and display all of the custom fields with no problem, under 3 seconds.\n\nAny ideas?  Is there a problem with the core Wordpress backend functions at this scale for post pages with many custom fields?\nThanks!\n\nA: I used the QueryMonitor plugin, as birgire suggested in the comments, and found that a core Wordpress Meta Query is causing the problem.\nThe issue and core Wordpress Meta Query are discussed in depth at CSS Tricks and in another question on Wordpress StackExchange here.\nBasically, there's a query that populates the \"Select\" box for adding a custom field name on the \"Edit Post\" page (see below).\n\nIt goes through the database, and grabs all of the meta keys (or custom field names) in your posts to create a list of previously used keys/names.  This makes it easy to use the Select box to choose a key/name you've already used, rather than typing it over and over.\nApparently, the query is not efficient and causes massive performance issues when scaled to 100K+ posts with lots of custom fields.\nWorkaround\nAt this time, there is no absolute/easy fix I could find.  CSS Tricks and others have more complicated fixes, but I really wanted something simple.  Fortunately, there is an easy workaround StackOverflow user Nic Bug suggested that seems to solve the loading issue for me:\nfunction set_postmeta_choice( $string, $post ) {\n$meta_keys = array();\nforeach(has_meta( $post->ID ) as $meta){\n    $meta_keys[] = $meta[\"meta_key\"];\n}\nreturn $meta_keys;\n}\nadd_filter( 'postmeta_form_keys', 'set_postmeta_choice', 10, 3 );\n\nJust place this at the bottom of the functions.php file in your theme folder.  This shrinks the query down to only find the custom field keys/names used in the current post, rather than all posts.\nSo, it's a tradeoff.  It restores the speed, performance, and loading time, but makes this Select Box less convenient for adding more custom fields.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405867", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Changing copyright year in Footer.php with Custom plugin How to add functionality of adding Textbox in own custom plugin simple page in which user add copyright year in textbox for ex.2022/2023 which will change value in my footer.php.\nAny help appreciated.\nThank you.\n\nA: As Jacob Peattie commented, there isn't a standard way to do this that would work with all themes, but you can add an action to the wp_footer hook (https://developer.wordpress.org/reference/hooks/wp_footer/). This would add some content before the closing body tag. A simple implementation would be as follows:\n<?php\n/*\nPlugin Name: Year Footer\nDescription: Add the current year to the footer.\nAuthor: Tim Ross\nVersion: 1.0.0\nAuthor URI: https://timrosswebdevelopment.com\n*/\n\nfunction year_footer() {\n    echo '<div>&copy; ' . date('Y') . '</div>';\n}\n\nadd_action('wp_footer', 'year_footer', 9);\n\nIf you wanted to add a settings box at the bottom of \"Settings -> Reading\" to make the content editable, then you need some more code (see https://developer.wordpress.org/plugins/settings/using-settings-api/):\n<?php\n/*\nPlugin Name: Year Footer\nDescription: Add the current year to the footer.\nAuthor: Tim Ross\nVersion: 1.0.0\nAuthor URI: https://timrosswebdevelopment.com\n*/\n\nfunction year_footer_settings_init() {\n    // register a new setting for \"reading\" page\n    register_setting('reading', 'year_footer_content');\n\n    // register a new section in the \"reading\" page\n    add_settings_section(\n        'year_footer_settings_section',\n        'Year Footer Settings Section', 'year_footer_settings_section_callback',\n        'reading'\n    );\n\n    // register a new field in the \"year_footer_settings_section\" section, inside the \"reading\" page\n    add_settings_field(\n        'year_footer_settings_field',\n        'Year Footer Setting', 'year_footer_settings_field_callback',\n        'reading',\n        'year_footer_settings_section'\n    );\n}\n\n/**\n * register year_footer_settings_init to the admin_init action hook\n */\nadd_action('admin_init', 'year_footer_settings_init');\n\n/**\n * callback functions\n */\n\n// section content cb\nfunction year_footer_settings_section_callback() {\n    echo '<p>Update the content of the footer.</p>';\n}\n\n// field content cb\nfunction year_footer_settings_field_callback() {\n    // get the value of the setting we've registered with register_setting()\n    $setting = get_option('year_footer_content');\n    // output the field?>\n    <input type=\"text\" name=\"year_footer_content\" value=\"<?php echo isset($setting) ? esc_attr($setting) : ''; ?>\">\n<?php\n}\nfunction year_footer() {\n\n    $year_footer_content = get_option('year_footer_content');\n\n    echo '<div>' . esc_html($year_footer_content) . '</div>';\n}\n\nadd_action('wp_footer', 'year_footer', 9);\n\nIf you need a separate settings page, then you need to create one following the example from the docs\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405871", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add leading zero to current post display I am using the next to show in a loop of posts the current post and the total of posts published.\n$post_query = new WP_Query($args);\n\n$postAmount = wp_count_posts( 'post' )->publish;\n\n<?php echo $post_query->current_post + 1 ?> / <?php echo $postAmount ?>\n\nThis returns 1/20, 2/20, etc\nDoes someone know how to add a leading zero so it shows 01/20, 02/20, etc?\nThanks a lot in advance\n\nA: should work with sprintf('%02d', $post_query->current_post + 1) \n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405874", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: custom tables in wordpress Database? (can i just create them with sql?) i just want to create a custom Table in my WordPress database and i saw many php functions to deal with that my question now is :\ncan i just create them with an sql command and for what do i need to keep an eye on ?\n\nA: Yes, you can.\nWPDB Class is quite beneficial in manipulating the database.\nhttps://developer.wordpress.org/reference/classes/wpdb/\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405875", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom taxonomy throw error 404 So in my homework I was given code example and it works for teacher, but not for me. So from what i understand that I'm creating custom post type and custom taxonomy for it, also there is filter that replaces my %gaming_genre_new% with created category. And it works on custom post type stage, but it breaks when I add taxonomy. I can access for example my archive \"gaming\" and even created with taxonomy \"genres\" in it, but when i want to view particular post, it just throws error 404.\nadd_action( 'init', 'create_taxonomy' );\nfunction create_taxonomy(){\n\n    register_taxonomy( 'gaming_genre_new', [ 'gaming' ], [\n        'label'                 => '', // \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c $labels->name\n        'labels'                => [\n            'name'              => 'Game genres',\n            'singular_name'     => 'Game genre',\n            'search_items'      => 'Search Genres',\n            'all_items'         => 'All Genres',\n            'view_item '        => 'View Genre',\n            'parent_item'       => 'Parent Genre',\n            'parent_item_colon' => 'Parent Genre:',\n            'edit_item'         => 'Edit Genre',\n            'update_item'       => 'Update Genre',\n            'add_new_item'      => 'Add New Genre',\n            'new_item_name'     => 'New Genre Name',\n            'menu_name'         => 'Genre',\n            'back_to_items'     => '\u2190 Back to Genre',\n        ],\n        'description'           => '', // \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0442\u0430\u043a\u0441\u043e\u043d\u043e\u043c\u0438\u0438\n        'public'                => true,\n        // 'publicly_queryable'    => null, // \u0440\u0430\u0432\u0435\u043d \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u0443 public\n        // 'show_in_nav_menus'     => true, // \u0440\u0430\u0432\u0435\u043d \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u0443 public\n        // 'show_ui'               => true, // \u0440\u0430\u0432\u0435\u043d \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u0443 public\n        // 'show_in_menu'          => true, // \u0440\u0430\u0432\u0435\u043d \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u0443 show_ui\n        // 'show_tagcloud'         => true, // \u0440\u0430\u0432\u0435\u043d \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u0443 show_ui\n        // 'show_in_quick_edit'    => null, // \u0440\u0430\u0432\u0435\u043d \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u0443 show_ui\n        'hierarchical'          => true,\n\n        'rewrite'               => array('slug'=>'gaming/%gaming_genre_new%','with_front'=>'false'),\n        //'query_var'             => $taxonomy, // \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430\n        'capabilities'          => array(),\n        'meta_box_cb'           => null, // html \u043c\u0435\u0442\u0430\u0431\u043e\u043a\u0441\u0430. callback: `post_categories_meta_box` \u0438\u043b\u0438 `post_tags_meta_box`. false \u2014 \u043c\u0435\u0442\u0430\u0431\u043e\u043a\u0441 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d.\n        'show_admin_column'     => false, // \u0430\u0432\u0442\u043e-\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043a\u043e\u043b\u043e\u043d\u043a\u0438 \u0442\u0430\u043a\u0441\u044b \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 \u0430\u0441\u0441\u043e\u0446\u0438\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430 \u0437\u0430\u043f\u0438\u0441\u0438. (\u0441 \u0432\u0435\u0440\u0441\u0438\u0438 3.5)\n        'show_in_rest'          => null, // \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 REST API\n        'rest_base'             => null, // $taxonomy\n        // '_builtin'              => false,\n        //'update_count_callback' => '_update_post_term_count',\n    ] );\n}\n\n\n// \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0432\u043e\u0435\u0433\u043e \u0442\u0438\u043f\u0430 \u0437\u0430\u043f\u0438\u0441\u0438 \nadd_action( 'init', 'register_post_types' );\nfunction register_post_types(){\n    register_post_type( 'gaming', [\n        'label'  => null,\n        'labels' => [\n            'name'               => 'Gaming', // \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0434\u043b\u044f \u0442\u0438\u043f\u0430 \u0437\u0430\u043f\u0438\u0441\u0438\n            'singular_name'      => 'Gaming', // \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0434\u043b\u044f \u043e\u0434\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u044d\u0442\u043e\u0433\u043e \u0442\u0438\u043f\u0430\n            'add_new'            => 'Add Gaming Post', // \u0434\u043b\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u043e\u0432\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438\n            'add_new_item'       => 'Adding Gaming Post', // \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0430 \u0443 \u0432\u043d\u043e\u0432\u044c \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0435\u043c\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u0432 \u0430\u0434\u043c\u0438\u043d-\u043f\u0430\u043d\u0435\u043b\u0438.\n            'edit_item'          => 'Edit Gaming Post', // \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0438\u043f\u0430 \u0437\u0430\u043f\u0438\u0441\u0438\n            'new_item'           => 'New Gaming Post', // \u0442\u0435\u043a\u0441\u0442 \u043d\u043e\u0432\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438\n            'view_item'          => 'View Gaming Post', // \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0437\u0430\u043f\u0438\u0441\u0438 \u044d\u0442\u043e\u0433\u043e \u0442\u0438\u043f\u0430.\n            'search_items'       => 'Search Gaming Post', // \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u044d\u0442\u0438\u043c \u0442\u0438\u043f\u0430\u043c \u0437\u0430\u043f\u0438\u0441\u0438\n            'not_found'          => '\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e', // \u0435\u0441\u043b\u0438 \u0432 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0435 \u043f\u043e\u0438\u0441\u043a\u0430 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u0431\u044b\u043b\u043e \u043d\u0430\u0439\u0434\u0435\u043d\u043e\n            'not_found_in_trash' => '\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0435', // \u0435\u0441\u043b\u0438 \u043d\u0435 \u0431\u044b\u043b\u043e \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0435\n            'parent_item_colon'  => '', // \u0434\u043b\u044f \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439 (\u0443 \u0434\u0440\u0435\u0432\u043e\u0432\u0438\u0434\u043d\u044b\u0445 \u0442\u0438\u043f\u043e\u0432)\n            'menu_name'          => 'Gaming', // \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u043d\u044e\n        ],\n        'description'         => '',\n        'public'              => true,\n        // 'publicly_queryable'  => null, // \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 public\n        // 'exclude_from_search' => null, // \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 public\n        // 'show_ui'             => null, // \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 public\n        // 'show_in_nav_menus'   => null, // \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 public\n        'show_in_menu'        => null, // \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u043b\u0438 \u0432 \u043c\u0435\u043d\u044e \u0430\u0434\u043c\u043d\u043a\u0438\n        // 'show_in_admin_bar'   => null, // \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 show_in_menu\n        'show_in_rest'        => null, // \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 REST API. C WP 4.7\n        'rest_base'           => null, // $post_type. C WP 4.7\n        'menu_position'       => 4,\n        'menu_icon'           => null,\n        //'capability_type'   => 'post',\n        //'capabilities'      => 'post', // \u043c\u0430\u0441\u0441\u0438\u0432 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u043f\u0440\u0430\u0432 \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0442\u0438\u043f\u0430 \u0437\u0430\u043f\u0438\u0441\u0438\n        //'map_meta_cap'      => null, // \u0421\u0442\u0430\u0432\u0438\u043c true \u0447\u0442\u043e\u0431\u044b \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0434\u0435\u0444\u043e\u043b\u0442\u043d\u044b\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0440\u0430\u0432\n        'hierarchical'        => true,\n        'supports'            => [ 'title', 'editor', 'author'], // 'title','editor','author','thumbnail','excerpt','trackbacks','custom-fields','comments','revisions','page-attributes','post-formats'\n        'taxonomies'          => ['gaming_genre_new'],\n        'has_archive'         => 'gaming',\n        'rewrite'             => array('slug'=>'gaming/%gaming_genre_new%','with_front' => 'false'),\n        'query_var'           => true,\n    ] );\n}\n\nadd_filter('post_type_link', 'gaming_permalink', 1,2);\nfunction gaming_permalink($permalink,$post){\n    if (strpos( $permalink, '%gaming_genre_new%' ) === false )\n        return $permalink;\n    \n    $terms=get_the_terms($post,'gaming_genre_new');\n    if ( ! is_wp_error( $terms ) && !empty($terms) && is_object($terms[0]))\n    $term_slug=array_pop($terms)->slug;\n    else\n    $term_slug='no-gaming-genre';\n    return str_replace('%gaming_genre_new%',$term_slug,$permalink);\n}\n\nUPD: forgot to mention that i tried: resetting permalinks and flush_rewrite_rules. And that I'm using openserver.\n\nA: Answer was simple: remove %gaming_genre_new% from rewrite for taxonomy, so it looks like this:\n'rewrite'               => array('slug'=>'gaming','with_front'=>'false'),\n\nNow I wonder why original code worked for my friend and for my teacher...\n", "meta": {"language": "ru", "url": "https://wordpress.stackexchange.com/questions/405876", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there any way to render the WordPress Gutenberg core/embed block in PHP by passing in the URL? I'm trying to render the block HTML dynamically by injecting it within a core/query block. The injection is working fine using DOMDocument, but I can't find out how to render the embed HTML. I can use wp_oembed_get for the iframe, but I need the wrapper DIVs, aspect ratio by provider, and so on.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405878", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: save_post_{CPT} not updating the 'sticky_posts' option add_action( \"save_post_{CPT}\", 'update_sticky', 15, 1 );\nfunction update_sticky( $post_id ) {\n\n    $stickies = get_option( 'sticky_posts' );\n    if ( ! in_array( $post_id, $stickies ) ) {\n        $stickies[] = $post_id;\n        update_option( 'test', $stickies);\n        update_option( 'sticky_posts', $stickies );\n    }\n}\n\n\n*\n\n*It does work for test option I created for testing, but it doesn't work for existing sticky_posts option, although everything is the same.\n\n*It does work for both if I hardcode the $post_id, like: $stickies[] = 123;\n\n*Tried it in functions.php file, as well as in the class in which I am registering the CPT, same results - test is working, while sticky_posts is not.\n\n*Tried different action priorities, 5, 10, 15, 99\n\nAny ideas?\n\nA: Most likely what you're are experiencing is that within the edit_post() the updated post is automatically removed from the sticky posts. This happens for users that can publish posts and edit others post's, after the post is updated and the save_post hooks have fired.\nNote that core uses helper functions like stick_post(), unstick_post() and is_sticky() to do this kind of task.\nAs far as I understand the sticky posts feature is only fully implemented for the the built-in post type. So I'm not sure it's a good idea to mix it with other custom post types.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405880", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Google map API Key restrictions does not recognize website IP I created a wordpress website and I use google map API. I would like to add restrictions to prevent troubles. So I get the IP of the website from my hosting services and I also ping it to double check. I added it on the list of authorized IP but I still have an error message (Google Maps JavaScript API error: RefererNotAllowedMapError) and it is impossible to display a card.\nI can't understand what am I missing there.\nTo be precise, it was working fine when I was on local, i was just adding my IP address in the white list.\nAlso, the website works great if I use no restriction.\nAny Ideas? Thank you for your help\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405882", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Remove a component fill from a Block Editor panel I'm aware there is quite a lot of flexibility to add to the various editor components in the block editor using SlotFills this is useful when you want to add functionality. However my question is about removing functionality.\nI'd really like to remove one or more of the components below already added into the PluginPostStatusInfoSlot\nGiven there aren't inbuilt filters or hooks into this at the moment - I'm wondering if I'm missing something React-y here that I can use. jQuery is a no-no.\nHow it's added in the core:\nconst PostStatus = ( { isOpened, onTogglePanel } ) => (\n    <PanelBody\n        className=\"edit-post-post-status\"\n        title={ __( 'Status & visibility' ) }\n        opened={ isOpened }\n        onToggle={ onTogglePanel }\n    >\n        <PluginPostStatusInfo.Slot>\n            { ( fills ) => (\n                <Fragment>\n                    <PostVisibility />\n                    <PostSchedule />\n                    <PostFormat />\n                    <PostSticky />\n                    <PostPendingStatus />\n                    <PostAuthor />\n                    { fills }\n                    <PostTrash />\n                </Fragment>\n            ) }\n        </PluginPostStatusInfo.Slot>\n    </PanelBody>\n);\n\nOther plugins seem to remove the whole panel and rebuild this if they want to remove components - but that doesn't seem future friendly to any WP updates.\nAny and all help appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405884", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: How do I convert a custom menu wp_get_nav_menu_items into Fourth level? how can I turn this function from Two-level into the Fourth level in WordPress? This function can only echo the parent and its child, but I'm trying to make it unlimited or at least 4 levels if it is possible\nA\nB -2\nC -2 \n    -3 -- Not Work\n     -4 -- Not Work\nD -2\nF\n\nthis is my code: it works only till level 2\nfunction wp_get_menu_array($current_menu) {\n    $array_menu = wp_get_nav_menu_items($current_menu);\n    $menu = array();\n    foreach ($array_menu as $m) {\n        if (empty($m->menu_item_parent)) {\n            $menu[$m->ID] = array();\n            $menu[$m->ID]['ID']          =   $m->ID;\n            $menu[$m->ID]['title']       =   $m->title;\n            $menu[$m->ID]['url']         =   $m->url;\n            $menu[$m->ID]['children']    =   array();\n        }\n    }\n    $submenu = array();\n    foreach ($array_menu as $m) {\n        if ($m->menu_item_parent) {\n            $submenu[$m->ID] = array();\n            $submenu[$m->ID]['ID']       =   $m->ID;\n            $submenu[$m->ID]['title']    =   $m->title;\n            $submenu[$m->ID]['url']      =   $m->url;\n            $menu[$m->menu_item_parent]['children'][$m->ID] = $submenu[$m->ID];\n        }\n    }\n    return $menu;\n}\n\n\n$menu_items = wp_get_menu_array('main-menu'); // Then call in your theme\n\n  <nav>\n      <ul>\n        <?php foreach ($menu_items as $item) : ?>\n          <li>\n            <a href=\"<?= $item['url'] ?>\" title=\"<?= $item['title'] ?>\"><?= $item['title'] ?></a>\n            <?php if( !empty($item['children']) ):?>\n            <ul class=\"sub-menu\">\n              <?php foreach($item['children'] as $child): ?>\n                <li class=\"b-main-header__sub-menu__nav-item\">\n                  <a href=\"<?= $child['url'] ?>\" title=\"<?= $child['title'] ?>\"><?= $child['title'] ?></a>\n                </li>\n              <?php endforeach; ?>\n            </ul>\n            <?php endif; ?>\n          </li>\n        <?php endforeach; ?>\n     <ul>\n</nav>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405885", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Force logout ALL users at a certain time I'm wondering if it's possible to logout all users 2 times a day using the function wp_logout() ?\nI see loads of plugins who can logout idled users but we want to log out every single users twice a day at\n2PM and 10PM\nHope someone can help me with this.\n\nA: This should be possible, WordPress provides the WP_Session_Tokens class to manage logged in sessions. Then it's just a matter of connecting it to the cron. The following is a simple plugin file which I think should do it. Add it to the plugins directory and it should start working. *not tested.\n<?php\n/*\nPlugin Name: Logout Users\nDescription: Forces all users to be logged out twice a day.\nAuthor: Tim Ross\nVersion: 1.0.0\nAuthor URI: https://timrosswebdevelopment.com\n*/\n\n/**\n * Create hook and schedule cron job on plugin activation.\n * Schedule recurring cron event.\n */\nfunction logout_users_plugin_activate() {\n    $timestamp2pm = strtotime( '14:00:00' ); // 2:00 PM.\n    $timestamp10pm = strtotime( '22:00:00' ); // 10:00 PM.\n    // check to make sure it's not already scheduled.\n    if ( ! wp_next_scheduled( 'logout_users_plugin_cron_hook' ) ) {\n        wp_schedule_event( $timestamp2pm, 'daily', 'logout_users_plugin_cron_hook' );\n        wp_schedule_event( $timestamp10pm, 'daily', 'logout_users_plugin_cron_hook' );\n        // use wp_schedule_single_event function for non-recurring.\n    }\n}\nregister_activation_hook( __FILE__, 'logout_users_plugin_activate' );\n\n\n/**\n * Unset cron event on plugin deactivation.\n */\nfunction logout_users_plugin_deactivate() {\n    wp_clear_scheduled_hook( 'logout_users_plugin_cron_hook' ); // unschedule event.\n}\nregister_deactivation_hook( __FILE__, 'logout_users_plugin_deactivate' );\n\nfunction logout_all_users() {\n    // Get an instance of WP_User_Meta_Session_Tokens\n    $sessions_manager = WP_Session_Tokens::get_instance();\n    // Remove all the session data for all users.\n    $sessions_manager->drop_sessions();\n}\n\n// hook function logout_users_plugin_cron_hook() to the action logout_users_plugin_cron_hook.\nadd_action( 'logout_users_plugin_cron_hook', 'logout_all_users' );\n\n\nA: Managed to solve this issue myself by deleting the usermeta from the database directly by doing as follows:\n$stmt = $dbh->prepare('DELETE FROM wp_usermeta WHERE meta_key=\\'session_tokens\\'');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405886", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Add static text to post URLs I have 2 pages on my site which include blog posts (real site is pw protected):\nhttps://example.com/blog/\nhttps://example.com/news/\nAll blog and news articles should have a URL that begins with https://example.com/my-blog/.\nExample: https://example.com/my-blog/this-is-the-article-name\nSo, what I need to do, is include \"my-blog\" in the URL before the post name.  I've tried things with permalinks, but that didn't work. I'm really stumped and need help with this!\nThank you.\n\nA: if i good understand your problem, you should to go:\nDashboard -> Settings -> Permalinks and in \"Common Settings\" section select checkbox \"Custom Structure\" and here paste:\n/my-blog/%postname%/\n\nand save changes. Now refresh your page and go to random post and your url should be like:\nhttps://example.com/my-blog/this-is-the-article-name\nGood luck!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405887", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to remove/hide collapse menu for user/subscriber? I want to remove/hide the collapse menu item from the dashboard for user/subscriber role only. I don't want to remove it from the admin dashboard.\nI am the code below to remove it entirely which was posted here previously but I need to make it apply for user/subscriber only.\nCan someone assist?\n<?php\nfunction wpse_remove_collapse() {\n   echo '<style type=\"text/css\">#collapse-menu { display: none; visibility: hidden; }</style>';\n}\nadd_action('admin_head', 'wpse_remove_collapse');\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405889", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I add a tag slug to a category URL to filter posts? I want to add an option to my site to filter posts by one specific tag on the category page and at the same time have a nice URL (no query strings).\nSo something like this:\nhttps://example.com/%category%/ - standard category link (currently)\nhttps://example.com/%category%/%tag%/ - a page like the above, but displaying posts from a specific category AND tag.\nIs this possible? If so, how can I achieve this?\n\nI would also like to note that for posts I have such a slug https://example.com/%category%/%postname%/  and I'm worried that there might be a conflict with this.\n\nA: Ok, I found a solution.\nBy default in WP there is an option to filter categories by tags. E.g. https://example.com/category_name?tag=tag_name. I added a rewrite rule and redirection:\nhttps://developer.wordpress.org/reference/functions/add_rewrite_rule/\nadd_action( 'init', function () {\n    add_rewrite_rule( '([a-z0-9-]+)\\/tag\\/([a-z0-9-]+)\\/?$', 'index.php?category_name=$matches[1]&tag=$matches[2]', 'top' );\n} );\n\nhttps://developer.wordpress.org/reference/hooks/template_redirect/\nadd_action( 'template_redirect', function () {\n    if ( is_category() && is_tag() && ! empty( $_GET['tag'] ) ) {\n        wp_redirect( get_category_link( get_the_category()[0] ) . 'tag/' . get_query_var( 'tag' ) . '/' );\n        exit();\n    }\n} );\n\nOf course it's just such a basic code. It will require additional adjustments, e.g. for SEO.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405895", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add date_query to meta_query array I am building a meta query array and all fields for the user are optional so some might not have any data. But there is also an option which requires a date query. I am still checking to see if this is working but not sure as of yet. Is this correct and if not, what would be the right way to do it? Not sure if there needs to be an OR condition in here somewhere.\n$meta_query = [];\n$date_query = [];\n\nif ( $gender != '' ) {\n    $meta_query[] = [\n        'key' => 'gender',\n        'value' => $gender,\n        'compare' => '='\n    ];\n}\n\nif ( $age != '' ) {\n     $meta_query[] = [\n        'key' => 'age',\n        'value' => $age,\n        'compare' => '='\n    ];\n}\n\nif ( $userDate != 0 ) {\n    $date_query[] = [\n        'year' => $year,\n        'month' => $month\n    ];\n}\n\n$args = [\n    'post_type' => 'person',\n    'fields' => 'ids',\n    'posts_per_page' => -1,\n    'post_status' => 'any',\n    'meta_query' => $meta_query,\n    'date_query' => $date_query\n\n];\n\n$data = get_posts($args);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405897", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Page not visible in 'All pages' after being added through PHP I'm adding some pages pragmatically as a subpage. This all works well on a test website in 1 locale. However, on the live website we have WPML with 2 locales. When adding them there, these pages DO NOT show up in the all pages list.\nAlso accessing their url give a 404. However, when you access the edit mode directly: https://xxxxxxx.nl/wp-admin/post.php?post=3280&action=edit&lang=nl\nThe page 'comes to life' (even without saving) and is visible as sub-page in the 'all pages' page.\nAny idea how to get this working properly upon insertion in the db by PHP? Thanks!\nfunction add_my_custom_page() {\n\n    for( $i=1; $i <= 3; $i++ ) {\n\n        $my_posts = array(\n          'post_title'    => wp_strip_all_tags( \"Video $i\" ),\n          'post_name'     => \"v-$i\",\n          'post_type'     => \"page\",\n          'post_content'  => 'test',\n          'post_status'   => \"publish\",\n          //'post_excerpt'  => \"v-$i\",\n          'post_parent'   => 3269,\n\n          'post_author'   => get_current_user_id(),\n          'page_template' => \"page-full-width.php\",\n        );\n\n    \n\n        // Insert the post into the database\n        wp_insert_post( $my_posts, true );\n        \n    }\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405898", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Archive page of taxonomy returns a 404 error I'm trying to create a template file for a custom taxonomy archive page but I keep getting a 404 error when trying to access that archive page.\nBasically something like: domain.com/quizzes/quiz-levels/\nI managed to create template files for /quizzes/ and /b1-intermediate/ (or whatever the level is), but when I land on \"domain.com/quizzes/quiz-levels/\" I get a 404 error doesn't take any template file.\nWhat I'm aiming for is the following:\n\n*\n\n*domain.com/quizzes/ : To show all the quizzes (Works)\n\n*domain.com/quiz-post-slug/ : To show the quiz post (Works)\n\n*domain.com/quiz-levels/a1-beginner/ : To show quizzes belonging to this level (works)\n\n*domain.com/quiz-levels Or domain.com/quizzes/quiz-levels/ : To show the available levels (Doesn't work).\n\nfunction quiz_custom_post_type() {\n  $args = array(\n          'labels'                => array(\n                                            'name' => 'Quizzes',\n                                            'singular_name' => 'Quiz'\n                                  ),\n          'public'                => true,\n          'has_archive'           => true,\n          'menu_icon'             => 'dashicons-editor-spellcheck',\n          'menu_position'         => 4,\n          'has_archive'           => true,\n          'supports'              => array('title', 'editor', 'thumbnail', 'custom-fields', 'comments'),\n          'show_in_rest'          => true,\n          'rest_base'             => 'quizzes',\n          'rest_controller_class' => 'WP_REST_Posts_Controller'\n          \n  );\n  register_post_type('quizzes', $args);\n}\nadd_action('init', 'quiz_custom_post_type');\n\n\nfunction quiz_levels_taxonomy() {\n\n  $args = array(\n                'labels' => array(\n                                  'name'          => 'Levels',\n                                  'singular_name' => 'Level',\n                                  'add_new_item'  => 'Add New Level'\n                ),\n                'public' => true,\n                'hierarchical' => true,\n                'show_in_rest' => true,\n                'show_admin_column' => true,\n                'rewrite' => array('slug'=>'quiz-levels')\n  );\n  register_taxonomy('levels', array('quizzes'), $args);\n}\nadd_action('init', 'quiz_levels_taxonomy');\n\nThanks in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405899", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress is not creating table in database after activating plugin, I struggled with this a long time! Can anyone help me?\nMy plugin is not creating a database table once activated. The following code is in the main plugin file.\nfunction woocq_activate() {\n\n    global $wpdb;\n\n    $table_name = $wpdb->prefix . 'woocq';\n\n    $sql = \"CREATE TABLE $table_name (\n        id MEDIUMINT(9) NOT NULL AUTO_INCREMENT,\n        name VARCHAR NOT NULL,\n        message TEXT NOT NULL,\n        question_id INT NOT NULL,\n        product_id INT DEFAULT NULL,\n        timestamp BIGINT NOT NULL,\n        PRIMARY KEY  (id)\n    );\";\n\n    require_once ABSPATH . 'wp-admin/includes/upgrade.php';\n    dbDelta( $sql );\n    \n}\nregister_activation_hook( __FILE__, 'woocq_activate' );\n\nThank you in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405902", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How do I get the trackback count of a post in wordpress without writing an SQL query? How do I get the trackback count of a post in wordpress without writing an SQL query?\nI tried searching Brave Search and I couldn't find anything helpful. To fetch the amount of comments a post has, get_comments_number() is the wordpress protocol function for it. But what if I want to fetch the amount of trackbacks a post has?\nAnd also, do I have to be inside \"the loop\" to do this? What if I'm outside the loop?\n\nA: You can specify what kind of comment you want to retrieve using get_comments().\n// Assumes you've set $post_id somewhere.\n$args = array(\n    'type' => 'trackback',\n    'post_id' => $post_id,\n);\n$trackbacks = get_comments( $args );\n$trackback_count = count( $trackbacks );\n\nEdited to add: As Sally CJ points out in the comments, you can do this in just one step:\n// Assumes you've set $post_id somewhere.\n$args = array(\n    'type'    => 'trackback',\n    'post_id' => $post_id,\n    'count'   => true,\n);\n$trackback_count = get_comments( $args );\n\nThis code is untested but it should provide you a starting place.\nAs far as being inside/outside The Loop: The above code should work just fine either way, as long as you've got a way to get the post ID (get_the_ID() should work in The Loop; if you've got a WP_Post object called $my_post, then $my_post->ID should get it for you).\nReferences\n\n*\n\n*get_comments()\n\n*Allowed comment query arguments\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405904", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: add_action and do_action: multiple calls to same callback? I have a setup similar to this:\nfunction get_type_data($val) {\n    // Get the data from the DB where the ID is $val and return it.\n}\nadd_action('my_hook', array($this, 'get_type_data'), 10, 1);\n\nI need to repeat this callback for several results of another callback, which I was thinking of doing like this:\n// Get the types first, then...\nforeach ($type as $val) {\n    add_action('my_hook', array($this, 'get_type_data'), 10, 1);\n    do_action('my_hook', $val);\n}\n\nBut it only does the first one. I then did it as follows:\n// Get the types first, then...\nforeach ($type as $val) {\n    add_action('my_hook_' . $val, array($this, 'get_type_data'), 10, 1);\n    do_action('my_hook_' . $val, $val);\n}\n\nI figured that this would then create sort of a dynamic hook and add the same action to it, but use the new parameter. Again, it only does the first one.\nThen, just as a test, I did it like this:\nadd_action('my_hook_1', array($this, 'get_type_data'), 10, 1);\ndo_action('my_hook_1', 1);\n\nadd_action('my_hook_2', array($this, 'get_type_data'), 10, 1);\ndo_action('my_hook_2', 2);\n\nadd_action('my_hook_3', array($this, 'get_type_data'), 10, 1);\ndo_action('my_hook_3', 3);\n\nAgain, it only did the first one.\nFinally, I did it like this, to see if I can call the same hook with different parameters:\nadd_action('my_hook', array($this, 'get_type_data'), 10, 1);\ndo_action('my_hook', 1);\n\nadd_action('my_hook', array($this, 'get_type_data'), 10, 1);\ndo_action('my_hook', 2);\n\nadd_action('my_hook', array($this, 'get_type_data'), 10, 1);\ndo_action('my_hook', 3);\n\nI also tried with different priority values as the third parameter to add_action. Nothing works for me.\nI failed to find resources indicating how this can be done. Even if it worked, the last two can't be a solution, as the data is dynamic from a web service.\nEdit:\nAs requested by @Sally CJ, a bit more info:\n\n*\n\n*I am trying to run that hook several times for different values.\n\n*I have, let's say two categories (but could be more) that need to run to populate a local database with data from a REST service. I first make a call to the REST service to get the categories back. Then for each of the categories returned, I need to call get_type_data with each category ID and pull all the data from the REST service for that category, and add it to a local database.\n\n*The result set is too large to let multiple users run the rest service on demand, so I am running that via a cron job to return and prep the data (it only changes every hour or so), and then each user can get their subsection of the data on demand from a local database.\n\nLet's say my categories returned are 1 and 2. When doing any of the loops, only data with category_id 1 are returned, similar to:\n// Result from call 1\n[\n    [\n        'category_id' => 1,\n        'name' => 'Sample 1'\n    ],\n    [\n        'category_id' => 1,\n        'name' => 'Sample 2'\n    ]    \n]\n\n// Result from call 2 never happening.\n\nWhere I was expecting results like this:\n// Result from call 1\n[\n    [\n        'category_id' => 1,\n        'name' => 'Sample 1'\n    ],\n    [\n        'category_id' => 1,\n        'name' => 'Sample 2'\n    ]    \n]\n\n// Result from call 2.\n[\n    [\n        'category_id' => 2,\n        'name' => 'Sample 1'\n    ],\n    [\n        'category_id' => 2,\n        'name' => 'Sample 2'\n    ]    \n]\n\nI can confirm the data is available when I swop the statements around (so the second one brings data, and the first one then does not).\nAny ideas?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405907", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Woocommerce - Add additional item if some item wants to be added to the cart? Is there a way for me to force the user to select one from a variety of products into the cart when they try to add a specific item to the cart?\nSo lets say I have a Product like a blank USB and the customer chooses what product/software they would like loaded on the USB. I don't want to turn this in to a variable product as there could be hundreds of option. I don't want a customer to just add this item to the cart and purchase a blank USB. I want the customer to be asked What they would like to be loaded on the USB before purchasing. Basically buying the USB and the software together.\nI was looking into this thread: https://stackoverflow.com/questions/52655141/woocommerce-if-specific-product-is-in-cart-disable-specific-checkout-fields-that\nand I can approach this buy preventing the customer from going through the checkout process if this item is in the cart. However I would like to think there's a better option for me like if they added the USB to the cart, there is a popup or the customer gets directed to another page that loads in options for the customer to choose from to add to the cart.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405908", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Ajax 400 error when used inside a plugin I'm really, really stuck.\nWhen I run this code I get a checkbox displayed. When I click the checkbox, the javascript is run. I get \"test\" in the console, followed by a 400 POST error.\nI can get this to work perfectly if I take it out of the plugin (and remove $this from the ajax actions), but I don't want to do that.\nPlease can someone point me in the right direction!\nThis is the code from my plugin root file\n    require_once BUILDNEWBOAT_PATH . 'includes/BuildNewBoatPlugin.php';\n    $build_boat_plugin = new BuildNewBoatPlugin();\n    $build_boat_plugin->run();\n\nThis is inside the BuildNewBoatPlugin class\n    public function __construct() {\n        add_action( 'wp_enqueue_scripts', array( $this, 'init_plugin' ) );\n        add_action( 'wp_ajax_post_new_boat_form', array( $this, 'post_new_boat_form' ));\n        add_action( 'wp_ajax_nopriv_post_new_boat_form', array( $this, 'post_new_boat_form' ));\n    }\n\n    public function init_plugin() {\n        wp_register_script( 'new_boat_form_script', plugin_dir_url( __FILE__ ) . 'js/new_boat_form.js', array() );\n\n        wp_localize_script( 'new_boat_form_script', 'new_boat_form_script_ajax_object',\n            array(\n                'ajax_url'   => admin_url( 'admin-ajax.php' ),\n                //'ajax_nonce' => wp_create_nonce( 'new_boat_form_ajax_nonce' )\n            )\n        );\n\n        wp_enqueue_script( 'new_boat_form_script');\n\n    }\n\n    public function post_new_boat_form(){\n\n        print_r($_POST);\n        ?>\n        <p>Testing AJAX</p>\n        <?php\n\n        die();\n    }\n\n    public function run(){\n        // displays an html form\n    }\n\nAnd this is my javascript file\n    $(\"#boatFormStep input[type=\\\"radio\\\"]\").on(\"change\",function(){\n\n        console.log(\"test\");\n\n        $.ajax({\n            url: new_boat_form_script_ajax_object.ajax_url,\n            data: {\n                action: 'post_new_boat_form'\n            },\n            method: 'POST',\n            success: function (response) {\n                console.log(\"test\"+response)\n                $(\"#boatFormStep\").html(response);\n            },\n            error: function (error) {\n                console.log(error)\n            }\n        })\n    })\n\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405910", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Let current user know pending posts counts using wp_query I'm working on a query to let a logged-in user know if the user has more than 5 pending posts. Here's what I ended up with:\n// Start the query\n$query = new WP_Query( array(\n    'post_type'      => 'post',\n    'author'         => get_current_user_id(),\n    'post_status'    => 'pending',\n    'posts_per_page' => -1\n));\n\n// Start the loop\nif ( $query->have_posts() ) {\n\n    if ( $query->found_posts >= 5 ) {\n        echo '5 or more pending posts';\n    } else {\n        echo 'Less than 5 pending posts';\n    }\n\n    wp_reset_postdata();\n\n} else {\n    echo 'Nothing found!';\n}\n\nIt seems working. Is there anything missing? Is there anything to correct?\n\nA: As others have already noted in the comments, using \"posts_per_page\" => 5, is better option than \"posts_per_page\" => -1, for your query as it will give you the information you need for your conditional check.\nLimiting what is queried is also something to consider - as honk31 mentioned. Along 'fields' => 'ids' you can also add the following lines to your query.\n\n*\n\n*'no_found_rows' => true - number of total rows not needed in this\ncase\n\n*'update_post_meta_cache' => false - meta not needed in this\ncase\n\n*'update_post_term_cache' => false - terms not needed in this\ncase\n\nThe $query->have_posts() with wp_reset_postdata(); is also a bit unnecessary as you can just use $query->found_posts or ->post_count directly.\nif ( $query->found_posts ) {\n  echo $query->found_posts >= 5 ? '5 or more pending posts' : 'Less than 5 pending posts';\n} else {\n  echo 'Nothing found!';\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405912", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Multisite for multi-language I want to make a WordPress with multiple languages. I have two WordPress sites and I want them to use the same domain name.\nSite 1: http://example.com/en\nSite 2: http://example.com/de\nIs this possible? What information do I need to search for to find a tutorial.\nI don't want to use a plugin like WPML to translate content, I have to use multiple WordPress sites.\n\nA: Just create a standard multisite using the sub-directories option and name your site with the appropriate language slug.\nNormally it would be : mysite.com/subsitename\nYou could just do : mysite.com/en\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405913", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to override Bootstrap css with my child theme css in wordpress? I am trying to load my site's child theme's css after Bootstrap CDN css in wordpress. I tried using these code but it doesn't work. The Bootstrap css is not overriden. What should I do to fix that?\nfunction override_css() {\n    wp_enqueue_style( 'bootstrap.min', 'https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css' );\n    wp_enqueue_style( 'style', get_stylesheet_directory_uri() . '/style.css', array(), '1.0.0', true );\n}\nadd_action( 'wp_enqueue_scripts', 'override_css' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405915", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to Add text value in Automatically in this conditions? **how to input a text value in this  conditions automatically , when user input  text fields  value  **\n**which condition do I apply ? **\ncode was added :\n\n\n\nA: This should work. Untested though.\nI don't know how you get $woocomerce_wookc_text, but since you mentioned CMB, I am taking you are saving it as product meta data\nfunction wpse405916_add_to_cart( $cart_item_key, $product_id ) {\n    \n    //Get the woocomerce_wookc_text value.\n    $woocomerce_wookc_text = get_post_meta( $product_id, 'woocomerce_wookc_text ', true );\n    \n    //Check if the value exists\n    if ( $woocomerce_wookc_text && !empty($woocomerce_wookc_text) ) {\n        //Set the value as integer\n        $woocomerce_wookc_text = (int)$woocomerce_wookc_text;\n        \n        //Add it to cart\n        WC()->cart->add_to_cart($woocomerce_wookc_text);\n    }\n}\nadd_action( 'woocommerce_add_to_cart', 'wpse405916_add_to_cart', 10, 2 );\n\nThis will automatically add the product associated with the id from $woocomerce_wookc_text when the main product is added to cart. There are numerous checks should be added.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405916", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why am I getting the error: Cannot update a component (`Unknown`) while rendering a different component (`Edit`)? I recently upgraded to WordPress 5.9, and I'm now getting the following error in a custom block: Cannot update a component (`Unknown`) while rendering a different component (`Edit`). The code is as below:\nexport default function Edit( props ) {\n\n    const {attributes, setAttributes} = props\n    const {customClass, summaryCount} = attributes\n    const childBlockCount = useSelect(select => select('core/block-editor')).getBlockCount(props.clientId))\n\n    const ALLOWED_BLOCKS = [\n        ...\n    ]\n\n    function Placeholder() {\n        return <div className=\"event-summary-placeholder\"></div>\n    }\n\n    useEffect(() => {\n        if (childBlockCount !== summaryCount)\n            setAttributes({summaryCount: childBlockCount})\n    }, [childBlockCount])\n\n    const blockProps = useBlockProps({})\n\n    const innerBlocksProps = useInnerBlocksProps(blockProps, {\n        allowedBlocks: ALLOWED_BLOCKS,\n        templateLock: false\n    })\n\n    return (\n        <aside className='event-aside column-side'>\n            <dl {...useBlockProps({ className: `${customClass} type-s` })}>\n                {summaryCount === 0 && <Placeholder/>}\n                {innerBlocksProps.children}\n            </dl>\n        </aside>\n    )\n}\n\nMost solutions I've found so far recommend using useEffect in some way, but I'm not sure how that would apply here. What's causing this error?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405919", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: comments_where Hook Is there a similar replacement of the hook posts_where for comments (WP_Comment_Query)?\nI need to modify the where clause for a comments query like it is shown in this tutorial (\u201c4. Sub custom field values\u201d) for posts.\nThe only hook I found is comments_pre_query, but the property $query->meta_query_clauses[ 'where' ] is protected.\n\nA: Yes, a quick search of developer.wordpress.org reveals comment_feed_where.\nNote that this won't work with get_posts unless suppress filters is turned off, and that what you're trying to do is going to be very slow with some unreliability.\nThere is also comment_clauses:\nhttps://developer.wordpress.org/reference/hooks/comments_clauses/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405921", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Creating posts with links from a txt file I have a script which scrapes articles from the web and saves the url to a .txt file. I've created a custom plugin which on activation, loops through the urls and creates a draft post with the content being an embedded article. I'm using the following code in my plugin\n<?php\nregister_activation_hook(__FILE__, 'my_plugin_activate');\nfunction my_plugin_activate(){\n    my_plugin_install_site();\n}\n\nfunction my_plugin_install_site(){\n    global $user_ID;\n    $handle = fopen(\"listOfURLs.txt\", \"r\");\n    if ($handle) {\n        $count = 0;\n        while (($line = fgets($handle)) !== false) {\n            // process the line read.\n            PostCreator('test', 'post', '<iframe src=\"' . trim($line) . '\" class=\"alumni-embeded-page\"></iframe>');\n        }\n        fclose($handle);\n    }\n    // PostCreator( 'test1', 'post', '<iframe src=\"[link]\" class=\"alumni-embeded-page\"></iframe>' );\n    // PostCreator( 'test2', 'post', '<iframe src=\"[link]\" class=\"alumni-embeded-page\"></iframe>' );\n}\n\nfunction PostCreator(\n    $name      = 'AUTO POST',\n    $type      = 'post',\n    $content   = 'DUMMY CONTENT',\n    $category  = array(1,2),\n    $template  = NULL,\n    $author_id = '1',\n    $status    = 'draft'\n) {\n    $post_data = array(\n        'post_title'    => wp_strip_all_tags( $name ),\n        'post_content'  => $content,\n        'post_status'   => $status,\n        'post_type'     => $type,\n        'post_author'   => $author_id,\n        'post_category' => $category,\n        'page_template' => $template\n    );\n    $post_id = wp_insert_post($post_data); \n}\n\nThe listOfURLs.txt file is simply a text file in the same directory with a link to an article on every line. I'm only using 5 links to test at the moment. The problem is currently the script does not create any posts when trying to use the loop. The PostCreator() method did work when I coded the method calls manually(as shown by the comments).\nI'm also getting the following error when activating the plugin. Not sure it's related as it was still displayed when hard coding the method calls.\n\nThe plugin generated 205 characters of unexpected output during activation. If you notice \u201cheaders already sent\u201d messages, problems with syndication feeds or other issues, try deactivating or removing this plugin.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405924", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP query taxonomy optimization Is there any way to speed this query? Noob here.\n SELECT wp_posts.ID\n    FROM wp_posts\n    LEFT JOIN wp_term_relationships\n    ON (wp_posts.ID = wp_term_relationships.object_id)\n    WHERE 1=1\n    AND ( wp_posts.ID NOT IN (\n    SELECT object_id\n    FROM wp_term_relationships\n    WHERE term_taxonomy_id IN (9,11) )\n    AND wp_term_relationships.term_taxonomy_id IN (18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,151,152,169,170,171,172,173,174,175,177,178,179,181,182,183,184,185,187,191,192,195,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,721,724,726,728,729,742,743,744,747,750,758,759,760,781) )\n    AND wp_posts.post_type = 'product'\n    AND ((wp_posts.post_status = 'publish'))\n    GROUP BY wp_posts.ID\n    ORDER BY RAND()\n    LIMIT 0, 6\n\nI'm using query monitor and this is from homepage of site. I think this is reading from Menu, because there is a lot categories and subcategories in there. Any chance I can change this query to load more optimized?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405930", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: php redirect with custom user roles set and working but redirect not working for when users are logged in I have created code to add custom user rules. It works. However when I try to tie in the code for redirecting an already logged in user based on one test role, then it doesn't work. What am I missing in this in order to have it redirect, based on a user's role. Here is the code:\nadd_action('init', 'cloneRoleCompany');\nfunction cloneRoleCompany(){\n    global $wp_roles;\n    if ( ! isset( $wp_roles ) )\n        $wp_roles = new WP_Roles();\n\n    $adm = $wp_roles->get_role('subscriber');\n    //Adding a 'new_role' with all admin caps\n    $wp_roles->add_role('company-admin', 'Company Admin', $adm->capabilities);\n    $wp_roles->add_role('company', 'Company', $adm->capabilities);\n    $wp_roles->add_role('user', 'User', $adm->capabilities);\n}\nfunction redirect_from_front_page() {\n    $redirect_url  = '/user-dashboard';\n    $expected_role = 'user';\n\n    if( is_front_page() ) {\n        return;\n    }\n\n    if( is_user_logged_in() ) {\n        return;\n    }\n    \n\n    $user  = wp_get_current_user();\n    $roles = $user->roles;\n    \n\n    if ( in_array( $expected_role, $roles ) ) {\n        wp_safe_redirect( $redirect_url );\n        exit;\n    }\n}\n\n\nA: If the user is logged-in, the function returns before the redirect code lower in the function.\nif( is_user_logged_in() ) {\n    return;\n}\n\nSince you want the redirect code to run only if the user is logged in, try this:\nif( ! is_user_logged_in() ) {\n    return;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405931", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom Field: how to save array of multiple key-values in WordPress I have this kind of data on my database:\n<wp:postmeta>\n\n    <wp:meta_key>\n        <![CDATA[property_icalendar_import_multi]]>\n    </wp:meta_key>\n    \n    <wp:meta_value> <![CDATA[a:2:{i:0;a:2:{s:4:\"feed\";s:86:\"https://www.example.com/ics-files/property.ics\";s:4:\"name\";s:20:\"IMPORT_1\";}i:1;a:2:{s:4:\"feed\";s:56:\"https://www.example.com/ical/property.ics\";s:4:\"name\";s:16:\"IMPORT_2\";}}]]>\n    </wp:meta_value>\n    \n</wp:postmeta>\n\nAs you can see, on meta_value I have two pairs of serialized data \"name1/feed1\" and \"name2/feed2\".\nI wish to add, via custom fields, more instances to that array \"name3/feed3)\".\nBut I don't know how to do it.\nI was able to retrive the data so far:\n    <?php\n    $property_icalendar_import_multi = get_post_meta($edit_id, 'property_icalendar_import_multi', true);\n\n    if(is_array($property_icalendar_import_multi)){\n            foreach($property_icalendar_import_multi as $key=>$feed_data){\n                print $feed_data['name'];\n                print $feed_data['feed'];\n            }\n\n        }else{\n            esc_html_e('nothing');\n        }\n\n    ?>\n\nMy question is now, how can I update (edit or add) this data with a metabox?\nI know I have to use update_post_meta but I'm not sure how.\nCan someone point me on the right direction?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405938", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress custom menu can't show 3. level submenu I Use a custom walker from my menu in WordPress and my menu doesn't show all levels.\nhttps://soulofcroatia.com/ ->One Day menu item.\nThis is my code in header.php\n<?php\n                wp_nav_menu( array(\n                    'theme_location'  => 'mainmenu',\n                    'menu'            => 'mainmenu',\n                    'container'       => 'ul',\n                    'container_class' => 'collapse navbar-collapse',\n                    'container_id'    => 'navbarCollapse',\n                    'menu_class'      => 'nav-list',\n                    'echo'            => true,\n                    'fallback_cb'     => 'wp_page_menu',\n            'items_wrap'      => '<ul class=\"%2$s\">%3$s</ul>',\n            'depth'           => 3,\n            'walker'          => new Primary_navigation_walker(),\n            ) );\n            ?>\n\nthis is my code in custom-walkers.php\nclass Primary_navigation_walker extends Walker_Nav_Menu {\n    function start_lvl( &$output, $depth = 0, $args = array() ) {\n        $indent  = str_repeat( \"\\t\", $depth );\n        $output .= \"\\n<ul class='submenu-list width-xl'>$indent\\n\";\n    }\n\n    function end_lvl( &$output, $depth = 0, $args = array() ) {\n        $indent  = str_repeat( \"\\t\", $depth );\n        $output .= \"$indent</ul>\\n\";\n    }\n\n    function start_lv2( &$output, $depth = 1, $args = array() ) {\n        $indent  = str_repeat( \"\\t\", $depth );\n        $output .= \"\\n<ul class='submenu-list width-xl sub2'>$indent\\n\";\n    }\n\n    function end_lv2( &$output, $depth = 1, $args = array() ) {\n        $indent  = str_repeat( \"\\t\", $depth );\n        $output .= \"$indent</ul>\\n\";\n    }\n\n    function display_element( $element, &$children_elements, $max_depth, $depth, $args, &$output ) {\n        $id_field = $this->db_fields['id'];\n        if ( is_object( $args[0] ) ) {\n            $args[0]->has_children = ! empty( $children_elements[ $element->$id_field ] );\n        }\n        parent::display_element( $element, $children_elements, $max_depth, $depth, $args, $output );\n    }\n\n    /**\n     * Starts the element output.\n     *\n     * @param string   $output Used to append additional content (passed by reference).\n     * @param WP_Post  $item Menu item data object.\n     * @param int      $depth Depth of menu item. Used for padding.\n     * @param stdClass $args An object of wp_nav_menu() arguments.\n     * @param int      $id Current item ID.\n     *\n     * @see Walker::start_el()\n     *\n     * @since 3.0.0\n     * @since 4.4.0 The {@see 'nav_menu_item_args'} filter was added.\n     */\n    public function start_el( &$output, $item, $depth = 0, $args = null, $id = 0 ) {\n        if ( isset( $args->item_spacing ) && 'discard' === $args->item_spacing ) {\n            $t = '';\n            $n = '';\n        } else {\n            $t = \"\\t\";\n            $n = \"\\n\";\n        }\n        $indent = ( $depth ) ? str_repeat( $t, $depth ) : '';\n\n        if ( $depth == 0 ) {\n            $classes = array( 'nav-item' );\n        } elseif ( $args->has_children && $depth == 1 ) {\n            $classes = array( 'submenu-item sub' );\n        } else {\n            $classes = array( 'submenu-item' );\n        }\n\n        /**\n         * Filters the arguments for a single nav menu item.\n         *\n         * @param stdClass $args An object of wp_nav_menu() arguments.\n         * @param WP_Post $item Menu item data object.\n         * @param int $depth Depth of menu item. Used for padding.\n         *\n         * @since 4.4.0\n         */\n        $args = apply_filters( 'nav_menu_item_args', $args, $item, $depth );\n\n        /**\n         * Filters the CSS classes applied to a menu item's list item element.\n         *\n         * @param string[] $classes Array of the CSS classes that are applied to the menu item's `<li>` element.\n         * @param WP_Post $item The current menu item.\n         * @param stdClass $args An object of wp_nav_menu() arguments.\n         * @param int $depth Depth of menu item. Used for padding.\n         *\n         * @since 3.0.0\n         * @since 4.1.0 The `$depth` parameter was added.\n         */\n        $class_names = join( ' ', apply_filters( 'nav_menu_css_class', array_filter( $classes ), $item, $args, $depth ) );\n        $class_names = $class_names ? ' class=\"' . esc_attr( $class_names ) . '\"' : '';\n\n        /**\n         * Filters the ID applied to a menu item's list item element.\n         *\n         * @param string $menu_id The ID that is applied to the menu item's `<li>` element.\n         * @param WP_Post $item The current menu item.\n         * @param stdClass $args An object of wp_nav_menu() arguments.\n         * @param int $depth Depth of menu item. Used for padding.\n         *\n         * @since 3.0.1\n         * @since 4.1.0 The `$depth` parameter was added.\n         */\n        $id = apply_filters( 'nav_menu_item_id', 'menu-item-' . $item->ID, $item, $args, $depth );\n        $id = $id ? ' id=\"' . esc_attr( $id ) . '\"' : '';\n\n        $output .= $indent . '<li' . $id . $class_names . '>';\n\n        $atts           = array();\n        $atts['title']  = ! empty( $item->attr_title ) ? $item->attr_title : '';\n        $atts['target'] = ! empty( $item->target ) ? $item->target : '';\n        if ( '_blank' === $item->target && empty( $item->xfn ) ) {\n            $atts['rel'] = 'noopener noreferrer';\n        } else {\n            $atts['rel'] = $item->xfn;\n        }\n        $atts['href']         = ! empty( $item->url ) ? $item->url : '';\n        $atts['aria-current'] = $item->current ? 'page' : '';\n\n        /**\n         * Filters the HTML attributes applied to a menu item's anchor element.\n         *\n         * @param array $atts {\n         *     The HTML attributes applied to the menu item's `<a>` element, empty strings are ignored.\n         *\n         * @type string $title Title attribute.\n         * @type string $target Target attribute.\n         * @type string $rel The rel attribute.\n         * @type string $href The href attribute.\n         * @type string $aria_current The aria-current attribute.\n         * }\n         *\n         * @param WP_Post $item The current menu item.\n         * @param stdClass $args An object of wp_nav_menu() arguments.\n         * @param int $depth Depth of menu item. Used for padding.\n         *\n         * @since 3.6.0\n         * @since 4.1.0 The `$depth` parameter was added.\n         */\n        $atts = apply_filters( 'nav_menu_link_attributes', $atts, $item, $args, $depth );\n\n        $attributes = '';\n        foreach ( $atts as $attr => $value ) {\n            if ( is_scalar( $value ) && '' !== $value && false !== $value ) {\n                $value       = ( 'href' === $attr ) ? esc_url( $value ) : esc_attr( $value );\n                $attributes .= ' ' . $attr . '=\"' . $value . '\"';\n            }\n        }\n\n        /** This filter is documented in wp-includes/post-template.php */\n        $title = apply_filters( 'the_title', $item->title, $item->ID );\n\n        /**\n         * Filters a menu item's title.\n         *\n         * @param string $title The menu item's title.\n         * @param WP_Post $item The current menu item.\n         * @param stdClass $args An object of wp_nav_menu() arguments.\n         * @param int $depth Depth of menu item. Used for padding.\n         *\n         * @since 4.4.0\n         */\n        $title = apply_filters( 'nav_menu_item_title', $title, $item, $args, $depth );\n\n        if ( $args->has_children && $depth == 0 ) {\n            $aClasses = 'class=\"nav-link has-submenu js-nav-submenu\"';\n        } elseif ( $args->has_children && $depth == 1 ) {\n            $aClasses = 'class=\"nav-link has-submenu js-nav-submenu sub\"';\n        } elseif ( $depth == 0 ) {\n            $aClasses = 'class=\"nav-link\"';\n        } else {\n            $aClasses = 'class=\"submenu-link\"';\n        }\n\n        $item_output  = $args->before;\n        $item_output .= '<a ' . $attributes . $aClasses . '>';\n        $item_output .= $args->link_before . $title . $args->link_after;\n        $item_output .= '</a>';\n        $item_output .= $args->after;\n\n        /**\n         * Filters a menu item's starting output.\n         *\n         * The menu item's starting output only includes `$args->before`, the opening `<a>`,\n         * the menu item's title, the closing `</a>`, and `$args->after`. Currently, there is\n         * no filter for modifying the opening and closing `<li>` for a menu item.\n         *\n         * @param string $item_output The menu item's starting HTML output.\n         * @param WP_Post $item Menu item data object.\n         * @param int $depth Depth of menu item. Used for padding.\n         * @param stdClass $args An object of wp_nav_menu() arguments.\n         *\n         * @since 3.0.0\n         */\n        $output .= apply_filters( 'walker_nav_menu_start_el', $item_output, $item, $depth, $args );\n    }\n\n    /**\n     * Ends the element output, if needed.\n     *\n     * @param string   $output Used to append additional content (passed by reference).\n     * @param WP_Post  $item Page data object. Not used.\n     * @param int      $depth Depth of page. Not Used.\n     * @param stdClass $args An object of wp_nav_menu() arguments.\n     *\n     * @since 3.0.0\n     *\n     * @see Walker::end_el()\n     */\n    public function end_el( &$output, $item, $depth = 0, $args = null ) {\n        if ( isset( $args->item_spacing ) && 'discard' === $args->item_spacing ) {\n            $t = '';\n            $n = '';\n        } else {\n            $t = \"\\t\";\n            $n = \"\\n\";\n        }\n        $output .= \"</li>{$n}\";\n    }\n}\n\nclass Terms_link_walker extends Walker_Nav_Menu {\n\n    public function start_el( &$output, $item, $depth = 0, $args = null, $id = 0 ) {\n        if ( isset( $args->item_spacing ) && 'discard' === $args->item_spacing ) {\n            $t = '';\n            $n = '';\n        } else {\n            $t = \"\\t\";\n            $n = \"\\n\";\n        }\n        $indent = ( $depth ) ? str_repeat( $t, $depth ) : '';\n\n        $classes   = empty( $item->classes ) ? array() : (array) $item->classes;\n        $classes[] = 'menu-item-' . $item->ID;\n\n        /**\n         * Filters the arguments for a single nav menu item.\n         *\n         * @param stdClass $args An object of wp_nav_menu() arguments.\n         * @param WP_Post $item Menu item data object.\n         * @param int $depth Depth of menu item. Used for padding.\n         *\n         * @since 4.4.0\n         */\n        $args = apply_filters( 'nav_menu_item_args', $args, $item, $depth );\n\n        /**\n         * Filters the CSS classes applied to a menu item's list item element.\n         *\n         * @param string[] $classes Array of the CSS classes that are applied to the menu item's `<li>` element.\n         * @param WP_Post $item The current menu item.\n         * @param stdClass $args An object of wp_nav_menu() arguments.\n         * @param int $depth Depth of menu item. Used for padding.\n         *\n         * @since 3.0.0\n         * @since 4.1.0 The `$depth` parameter was added.\n         */\n        $class_names = join( ' ', apply_filters( 'nav_menu_css_class', array_filter( $classes ), $item, $args, $depth ) );\n        $class_names = $class_names ? ' class=\"' . esc_attr( $class_names ) . '\"' : '';\n\n        $atts           = array();\n        $atts['title']  = ! empty( $item->attr_title ) ? $item->attr_title : '';\n        $atts['target'] = ! empty( $item->target ) ? $item->target : '';\n        if ( '_blank' === $item->target && empty( $item->xfn ) ) {\n            $atts['rel'] = 'noopener noreferrer';\n        } else {\n            $atts['rel'] = $item->xfn;\n        }\n        $atts['href']         = ! empty( $item->url ) ? $item->url : '';\n        $atts['aria-current'] = $item->current ? 'page' : '';\n\n        /**\n         * Filters the HTML attributes applied to a menu item's anchor element.\n         *\n         * @param array $atts {\n         *     The HTML attributes applied to the menu item's `<a>` element, empty strings are ignored.\n         *\n         * @type string $title Title attribute.\n         * @type string $target Target attribute.\n         * @type string $rel The rel attribute.\n         * @type string $href The href attribute.\n         * @type string $aria_current The aria-current attribute.\n         * }\n         *\n         * @param WP_Post $item The current menu item.\n         * @param stdClass $args An object of wp_nav_menu() arguments.\n         * @param int $depth Depth of menu item. Used for padding.\n         *\n         * @since 3.6.0\n         * @since 4.1.0 The `$depth` parameter was added.\n         */\n        $atts = apply_filters( 'nav_menu_link_attributes', $atts, $item, $args, $depth );\n\n        $attributes = '';\n        foreach ( $atts as $attr => $value ) {\n            if ( is_scalar( $value ) && '' !== $value && false !== $value ) {\n                $value       = ( 'href' === $attr ) ? esc_url( $value ) : esc_attr( $value );\n                $attributes .= ' ' . $attr . '=\"' . $value . '\"';\n            }\n        }\n\n        /** This filter is documented in wp-includes/post-template.php */\n        $title = apply_filters( 'the_title', $item->title, $item->ID );\n\n        /**\n         * Filters a menu item's title.\n         *\n         * @param string $title The menu item's title.\n         * @param WP_Post $item The current menu item.\n         * @param stdClass $args An object of wp_nav_menu() arguments.\n         * @param int $depth Depth of menu item. Used for padding.\n         *\n         * @since 4.4.0\n         */\n        $title = apply_filters( 'nav_menu_item_title', $title, $item, $args, $depth );\n\n        $item_output  = $args->before;\n        $item_output .= '<a' . $attributes . 'class=\"terms-link\">';\n        $item_output .= $args->link_before . $title . $args->link_after;\n        $item_output .= '</a>';\n        $item_output .= $args->after;\n\n        /**\n         * Filters a menu item's starting output.\n         *\n         * The menu item's starting output only includes `$args->before`, the opening `<a>`,\n         * the menu item's title, the closing `</a>`, and `$args->after`. Currently, there is\n         * no filter for modifying the opening and closing `<li>` for a menu item.\n         *\n         * @param string $item_output The menu item's starting HTML output.\n         * @param WP_Post $item Menu item data object.\n         * @param int $depth Depth of menu item. Used for padding.\n         * @param stdClass $args An object of wp_nav_menu() arguments.\n         *\n         * @since 3.0.0\n         */\n        $output .= apply_filters( 'walker_nav_menu_start_el', $item_output, $item, $depth, $args );\n    }\n\n    /**\n     * Ends the element output, if needed.\n     *\n     * @param string   $output Used to append additional content (passed by reference).\n     * @param WP_Post  $item Page data object. Not used.\u00ac\n     * @param int      $depth Depth of page. Not Used.\n     * @param stdClass $args An object of wp_nav_menu() arguments.\n     *\n     * @since 3.0.0\n     *\n     * @see Walker::end_el()\n     */\n    public function end_el( &$output, $item, $depth = 0, $args = null ) {\n        if ( isset( $args->item_spacing ) && 'discard' === $args->item_spacing ) {\n            $t = '';\n            $n = '';\n        } else {\n            $t = \"\\t\";\n            $n = \"\\n\";\n        }\n\n        $output .= \"{$n} / \";\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405942", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Related posts by current posts child category I'm trying to use this code to display related posts by the same category as the current post but if the post is in a child category, i need to show related posts by that child category, not the parent unless there's no more posts in the same child category.\n$categories = get_the_category( get_the_ID() );\n\n$args = array (\n    'child_of' => $categories[0], \n    'title_li' => ''\n);\n\n$terms = wp_get_post_terms( get_the_ID(), 'category', $args ); \n\n$terms_ids = [];\n\nforeach ( $terms as $term ) {\n    $terms_ids[] = $term->term_id;\n}\n\n$args = array(\n    'post_type'      => 'posts',\n    'posts_per_page' => 8,\n    'orderby'        => 'rand', \n    'post__not_in'   => array( get_queried_object_id() ),\n    'tax_query'    => array(\n    'relation'     => 'AND',\narray(\n    'taxonomy' => 'brand',\n    'field'    => 'term_id',\n    'terms'    => $terms_ids,\n     ),),  \n);\n        \n$loop = new WP_Query( $args );\n\nI'm not sure if i also need to include the tax_query.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405943", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show Featured Image Dimensions and size frontend with shortcode I was wondering if I can show my featured image Dimensions (W x H in px) and the filesize in mb. In my Wordpress post with a shortcode.\nthank you in advance :)\n\nA: Yes, that is possible. Building upon the answer Nicolai Grossherr gave to Get the size (size in Kb or MB) of an featured image? you could do something like this,\n// e.g. in functions.php\nadd_shortcode( 'my_image_metadata', 'my_image_metadata_callback' );\nfunction my_image_metadata_callback($atts) {\n  $img_meta = wp_get_attachment_metadata( get_post_thumbnail_id() );\n  if ( ! $img_meta ) {\n    return;\n  }\n\n  $upload_dir = wp_upload_dir();\n  $bytes = filesize(\n    $upload_dir[ 'basedir' ] . DIRECTORY_SEPARATOR . $img_meta[ 'file' ]\n  );\n  if ( ! $bytes ) {\n    return;\n  }\n\n  $file_size = size_format( $bytes );\n\n  return sprintf(\n    '<span>\n      <span class=\"dimensions\">%d x %d px</span>\n      <span class=\"filesize\">%s</span>\n    </span>',\n    $img_meta['width'],\n    $img_meta['height'],\n    $file_size ?: ''\n  );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405945", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to disable Page Preview on sidebar in Page Editor in backend of wordpress? I'm trying to update this contact page and it's not letting me click \"update\" because it's forcing me to fill out the form. When I do a test in the required fields, it's giving me an error. Therefore, I am not able to update the page. Is there a way to disable the preview in the sidebar? This is so frustrating!\nSide note - I did not build this site. It's awful.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405949", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenberg add extra attributes to custom format I'm creating a custom format (adding a custom option to the format toolbar) using the following guide: https://developer.wordpress.org/block-editor/how-to-guides/format-api/\nimport { registerFormatType, toggleFormat } from '@wordpress/rich-text';\nimport { RichTextToolbarButton } from '@wordpress/block-editor';\n \nconst MyCustomButton = ( { isActive, onChange, value } ) => {\n    return (\n        <RichTextToolbarButton\n            icon=\"editor-code\"\n            title=\"Sample output\"\n            onClick={ () => {\n                onChange(\n                    toggleFormat( value, {\n                        type: 'my-custom-format/sample-output',\n                    } )\n                );\n            } }\n            isActive={ isActive }\n        />\n    );\n};\n \nregisterFormatType( 'my-custom-format/sample-output', {\n    title: 'Sample output',\n    tagName: 'samp',\n    className: null,\n    edit: MyCustomButton,\n} );\n\nThis creates, for example: Hello <samp>world</samp>\nHow can i add extra attributes to the new format? For example if i want to add a data attribute. I tried:\nregisterFormatType( 'my-custom-format/sample-output', {\n    title: 'Sample output',\n    tagName: 'samp',\n    className: null,\n    'data-custom': 'Some value',\n    edit: MyCustomButton,\n} );\n\nBut data-custom does not show in the HTML output.\n\nA: I was able to add the attribute by passing it in attributes through the registerFormatType settings:\nattributes: {\n   'custom-attr': 'custom-attr'\n},\n\nthen in edit():\ntoggleFormat( value, {\n    attributes: {\n      'custom-attr': 'Hello world'\n    },\n} )\n\nI don't know how exactly it all works together because I could not find detailed explanations in the current documentation.\nAnother great feature would be the ability to add extra HTML markup in custom formats but I could not find any examples. For example:\n<div custom-attr=\"Hello world\"><div class=\"an-extra-div\"></div>Lorem ipsum dolor...</div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405950", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to make a post accessible from multiple post type slugs? I have two custom post types\n\n*\n\n*colors\n\n*shapes\n\nI have a post called \"red\" under the custom post type \"colors\". The default URL for this post would be\n\nexample.com/colors/red\n\nNow I want to make it accessible from the following URL as well\n\nexample.com/shapes/red\n\nThe closest I came with is to add a filter to change_404_template (as I receive a 404 for above url) and forcefully inject the single.php file with some hacky code.\nIs there a way more standard method to do this ?\n\nA: Found the way, For anyone looking for a method in the future I'll mention how I made it work.\nadd_action( 'parse_request', function($query){  \n    $post_type = $post_name = NULL;\n\n    if (isset($query->query_vars['post_type']) && in_array($query->query_vars['post_type'], ['colors', 'shapes'])) {\n        $post_type = $query->query_vars['post_type'];\n        $post_name = $query->query_vars['name'];\n    } elseif (isset($query->query_vars['pagename']) &&  isset($query->request) && isset(explode('/', $query->request)[0]) && in_array(explode('/', $query->request)[0], ['slug-with-no-post-type', 'another-slug-with-no-post-type'])) {\n        $division = explode('/', $query->request)[0];\n        if (isset(explode('/', $query->request)[1])) $post_type = explode('/', $query->request)[1];\n        unset($query->query_vars['pagename']);\n    }\n\n    if($post_type && $post_name){\n        if ($post = get_page_by_path($post_name, 'OBJECT', ['colors', 'shapes'])) {\n            if (isset($post->post_type) && $post->post_type != $post_type) {\n                $query->query_vars['post_type'] = $post->post_type;\n                $query->query_vars['post_type_template'] = $post_type;\n                $query->query_vars['name'] = $post_name;\n            }\n        }\n    }\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405951", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Getting category posts from a certain year Is there a way to get category posts from a certain year?\nI know how to get all posts posted in a certain year -> www.example.com/**year**/\nor with months -> wwx.example.com/year/month (that's how the default archive works)\nIs there a trick to get for wwx.example/year/category/\nThanks!\n\nA: \nIs there a trick to get for wwx.example.com/year/category/\n\nThe main query is open to public query variables like year and cat so without pretty permalinks you could try\nwww.example.com/?year=2022&cat=5\n\nwhere 5 is the category id as an example and with pretty permalinks it would be redirected to\nwww.example.com/2022/?cat=5\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405953", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Modify WooCommerce used to get all orders in dashboard The existing WooCommerce orders table in the wp-admin dashboard orders the results by the date the order was made, but I want to modify the query to order by date and also by the shipping method of the order, where same-day delivery takes priority over standard delivery, etc.\nI'm aware I can use the wc_get_orders() function to get all the orders myself and change the query however I like, but I need this new ordering system to work on the default orders page on the wp-admin dashboard for WooCommerce.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405956", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show posts from a single category by default using wordpress.com I have a blog at wordpress.com on the legacy \"Personal\" plan. I blog about different but related subjects and categorise the posts accordingly. The blog was originally about one subject but, over time, the content diverged. One subject is more generally accessible while the second is more specialized.\nWhen someone visits my blog, can it show posts only from the more general category by default? For example, I could create a new page containing the \"Blog Posts\" block to show blog posts filtered by a category. However, it only shows the title and first 55 words by default. I am happy to code but wordpress.com, even using the code editor, does not make it easy.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405957", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Bulk update status of all posts or pages on a particular path What are the options to capture all posts or pages on a specific path - including multiple levels of parent pages - and update status (published -> draft)?\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405958", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I disable the built-in editor and automatically configure the properties of new pages? I use a Builder plugin on the site. Members are editors and can create their own page. I want to disable Gutenberg so that they can only edit pages with Buldir. I would also disable the properties of the page for them and I would enter it automatically. When I create a new page, I disable comments, the template is Blank Page, do not access the Custom fields. You can practically just add a featured image and title to your page, then click on the Bulder link and edit it. In the page menu, I disabled Editing and Quick Editing, and I also disabled editing the page URL. However, I can't specify the properties of the new page and I have no idea how to disable it without creating a new page with the builder.\nI'm trying to influence the properties of the page with this code:\nfunction my_default_content( $post_content, $post ) {\n    if( $post->post_type )\n    switch( $post->post_type ) {\n        case 'page':\n            $post->comment_status = 'closed';\n            $post_meta->_wp_page_tamplate = 'page-template-blank.php';\n        break;\n    }\n    return $post_content;\n}\nadd_filter( 'default_content', 'my_default_content', 10, 2 );\n\nI could update, but it's too late after editing the page - eg Blank Page template.\nAnd even though I ban Gutenberg in vain, there is still an editing interface :(\nadd_filter( 'use_block_editor_for_post', '__return_false' );\n\nCould you help me?\nThanks\n\n**EDIT:**\nThe WP engine changed completely in this respect around 2019. See Removing panels (meta boxes) in the Block Editor I have to approach the problem differently.\nI was able to disable certain options using the code, but editors can overwrite the author of the page, which I can't disable for now. I also have problems with basic page settings - see e.g. Blank Page above.\nIn addition, I can't disable the Gutenberg textarea input field for editors :(\n\nA: There are a few plugins to disable Gutenberg Editor. Suppose you can use this plugin. WordPress also provides an official plugin to disable Gutenberg and continue with Classic Editor. You can try out this plugin\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405960", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to use category slug with a regular page To make better looking category pages in my sites, I'm looking for a way to show the content of a regular page on the permalink /category/name.\nHow can I achieve that ?\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405961", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add $args to any running wp_query from function.php? Is it possible to add WP_Query arguments from functions.php to any of wp_query running on current page? For example, I want to add $args['order'] to current running wp_query on any pages.\n\nA: Use a pre_get_posts hook to modify the relevant query variables, with conditional tags to target specific pages/queries (and probably return from the callback early on is_admin() so you do not affect dashboard queries).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405962", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to stop execution of a function via add_action hook? I have the following functions:\nfunction test($post_id){\n\ndo_action('test_action',$post_id);\n\necho $post_id;\n\n}\n\nadd_action('test_action',function($post_id){\n\nif ( $post_id == 2 ) //Stop test function execution\n\n}\n\nUsing the function hooked to add_action, how to stop the execution of test() function without adding any code to test(). In the above example, if $post_id == 2 , the echo $post_id; code should not run in test().\n\nA: The usual way to add an action hook is more like this:\n// ... some other code\ndo_action( 'my_action', $post_id );\n\n// ...elsewhere\nadd_action( 'my_action', 'wpse405965_function' );\n/**\n * Function hooked to my_action\n *\n * @param int $post_id The post ID.\n */\nfunction wpse405965_function( $post_id ) {\n    if ( 2 !== $post_id ) {\n        echo $post_id;\n    }\n}\n\nThe way you've wrapped the do_action() inside a function confuses me. It seems extraneous.\nReference\n\n*\n\n*add_action()\n\nA: You have both registered and called action hooks, did you know you could do the same with filters? This answer uses a filter to call a return; statement as the community suggested, to do an early return and stop executing the rest of test function body (echo in your case).\nfunction test($post_id)\n{\n    do_action('test_action', $post_id);\n\n    if ( apply_filters('wpse_405965_stop_execution', false) )\n        return;\n\n    echo $post_id;\n}\n\nadd_action('test_action', function($post_id)\n{\n    if ( $post_id == 2 ) // Stop test function execution\n        add_filter('wpse_405965_stop_execution', '__return_true');\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405965", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: 2 css files? Theme css file gets override by another css file that I can not edit I wasted quite some time already to fix this problem. I somehow have a Wordpress css file that overrides the css of my themes css. See attached image:\n\nAt the top is the css which screws with my design. Below is the color I would actually want within the css file of my theme. I can edit the 2nd css file, but how can I edit the other file?\nBest regards\nJulian\n\nA: Make the CSS rule of style.css win over the rule of the other file.\nTo do so you can add the selector of a parent element of #header, or an !important after the color.\nThese two examples would work:\nbody #header{background-color:#ffe600}\n#header{background-color:#ffe600 !important}\nBetter adding the selector of a parent element, rather than adding an !important.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405966", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there a way to nest taxonomies or custom fields deeper than one level below the post type? In Wordpress we can create a post type which can contain taxonomies (or custom fields). Can these taxonomies (or custom fields) contain anything? For example other taxonomies or something else?\nIf I need a Wordpress model where I've got people who have got pets who have got toys which have got colours... As you can imagine, two different people can have a cat; a toy for a cat can be at the same time a toy for a dog; the black colour can be a feature of many different toys. All the relationships are \"many to many\". Is there a simple way of nesting these seperate data types respectively?\n\nSome clarifications if what's above doesn't explain the idea clearly enough.\nI'd like to display lists on my Wordpress website.\n\n*\n\n*For example a list of people. For each person on the list I'd like to display what's their pet.\n\n*For example a list of pets (or example a cat as one item). For each pet I'd like to display people who have got this pet. For each pet I'd like to display what toys are available for them.\n\n*For example a list of colours. For each colour I'd like to display the toys which are available in the colour.\n\nIn a programming language I'd create 4 classes and each one would have fields where some of fields are realised by one of the classes (for example a pet would be a field of a class \"person\"). In Wordpress it seems that the most appropriate thing so far are custom post types. But I don't know if post types can contain another post type as a feature (a characteristic/ a field/ whatever we call it in WP). In the standard WP the post type \"post\" and the post type \"page\" are not related like this at all as far as I'm concerned.\n\nA: WordPress content is implemented in two foundational structures: Posts represent distinct \"instances\" of content, and Taxonomy Terms aggregate and organize Posts according to their shared qualities. Meanwhile \"custom fields\" - or more specifically Meta-data/\"Meta\" - can be used to add arbitrary data to both Posts and Terms (among other things).\nAnalogous to classical OOP, a Post Type would be similar to a sub-class for content, and individual Posts of that type it's instances. Post meta-data operates similarly to class fields/properties in cases where WordPress's parent Post class does not provide the necessary fields.\nWhile there are many ways in which you could implement the proposed project, the more closely you can adhere to WordPress's core ideology, the more you can take advantage of it's built-in functionality such as automatic routing and archive pages/functions to display associated content.\nI'd consider implementing the following:\n\n*\n\n*Toy is a custom post type\n\n*Color is a custom (non-hierarchical) taxonomy applied to Toys. This way each Color term aggregates Toys with the same color\n\n*Person is a custom post type.\n\n*If pets are just general types of pets rather than specific pets (e.g. \"Spike\"), I'd make Pet another custom taxonomy, which could apply to both the Person and Toys post-types. This way Toys can can be aggregated based on applicable pets, and Persons can be aggregated based on the pets they own.\n\nThe only caveat here is if \"people\" are actual end-users of the site, in which case you might store the term slugs for owned types of pets in User meta instead of creating another post type (effectively creating a new relationship between a user and a Term which WordPress does not support out-of-the-box). This would mean that you'd need to implement a little more logic for Person-related queries in order to query Toys based on the Pet terms stored in a user's meta, but ultimately it wouldn't add too much complexity.\nThe above is probably the most direct solution, but you could certainly extend it in many ways, such as creating a Pet post-type as well in order to provide pet information content, also classifying the Pet post-type with the Pet taxonomy in order to facilitate simple query logic.\nFinally, if you wanted to start adding hierarchies to the above, you could register the Pets taxonomy to be hierarchical such that say Skink is a child term of Reptile. Or register the Toy CPT as hierarchical in order to represent variations of a Toy or some such.\nIn short, I think WordPress supports the basic scenario presented fairly-well out of the box. But you can always craft custom relationships between objects. It's all very flexible - you might simply need to put in some work on modifying URL rewrites, queries, and templates in order to represent it all as you intend.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405967", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Better way to list links with different meta values using same meta key? This works, but I will need it to make 8 different lists on the page, using same meta key but 8 different meta values. Is there a more efficient way to achieve this rather than repeating the same code 8 times?\n<?php \n$posts = get_posts(array(\n    'numberposts'   => -1,\n    'post_type'     => 'page',\n    'meta_key'      => 'my_meta_key',\n    'meta_value'    => 'meta_value_1'\n));\nif( $posts ): ?>\n    <h4>Pages with Meta Value 1:</h4>\n    <ul>\n    <?php foreach( $posts as $post ): \n        setup_postdata( $post );\n        ?>\n        <li>\n            <a href=\"<?php the_permalink(); ?>\"><?php the_title(); ?></a>\n        </li>\n    <?php endforeach; ?>\n    </ul>\n    <?php wp_reset_postdata(); ?>\n<?php endif; ?>\n<?php\n$posts = get_posts(array(\n    'numberposts'   => -1,\n    'post_type'     => 'page',\n    'meta_key'      => 'my_meta_key',\n    'meta_value'    => 'meta_value_2'\n));\nif( $posts ): ?>\n    <h4>Pages with Meta Value 2:</h4>\n    <ul>\n    <?php foreach( $posts as $post ): \n        setup_postdata( $post );\n        ?>\n        <li>\n            <a href=\"<?php the_permalink(); ?>\"><?php the_title(); ?></a>\n        </li>\n    <?php endforeach; ?>\n    </ul>\n    <?php wp_reset_postdata(); ?>\n<?php endif; ?>\n\n\nA: I don't think this is what birgire intended (thank you though!) but this is my revised code after doing some research. Much shorter, and meets my needs, but I'd still like eyes on it just to be sure I'm not doing something stupid. The NOT IN array '' was to only retrieve pages that have a meta_value set for this key - it worked perfectly, but maybe there's a better way to do this?\n<?php \n$posts = get_posts(array(\n    'numberposts'   => 500,\n    'post_type'     => 'page',\n    'meta_key'      => 'my_meta_key',\n    'meta_value' => array(''),\n    'meta_compare' => 'NOT IN',     \n    'orderby'   => 'meta_value',\n    'order'     => 'ASC'\n));\nif( $posts ): ?>\n    <h4>Posts with a Value in my_meta_key:</h4>\n    <table>\n    <?php foreach( $posts as $post ): \n        setup_postdata( $post );\n        ?>\n        <tr>\n            <td><a href=\"<?php the_permalink(); ?>\"><?php the_title(); ?></a></td>\n            <td><?php echo get_post_meta( get_the_ID(), 'my_meta_key', true ); ?></td>\n        </tr>\n    <?php endforeach; ?>\n    </table>\n    <?php wp_reset_postdata(); ?>\n<?php endif; ?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405972", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Can't hide product attributes with css on WooCommerce Product Page I'm having a problem in one site that I am making with wordpress/woocommerce, on product page I want to hide Size and Color from that section, unfortunately I did not succeed.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405974", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: New wordpress keep redirecting to localhost/wp-admin/install.php IN my fresh wordpress install via docker.\nEverytime i hit localhost it gets redirected to http://localhost/wp-admin/install.php\nNow its missing the wp , the url should be http://localhost/wp/wp-admin/install.php\nMy Env variable is like this\nWP_ENV=development\nWP_HOME=http://localhost/wp\nWP_SITEURL=${WP_HOME}/wp\n\nmy apache vhost file is\n<VirtualHost *:80>    \n    ServerName  http://localhost\n    DocumentRoot ${APACHE_DOCUMENT_ROOT}\n    <Directory ${APACHE_DOCUMENT_ROOT}>\n        AllowOverride all\n    </Directory>\n    CustomLog /var/log/apache2/local-access.log \"combined\"\n    ErrorLog /var/log/apache2/local-error.log        \n</VirtualHost>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405985", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display full WordPress post under search form using AJAX Hi I am currently creating a site that shows interactions between different pharmaceutical drugs. I originally started with Live search on JSON Objects Data Using jQuery (originally based on this article: https://www.js-tutorials.com/jquery-tutorials/live-search-json-objects-data-using-jquery/ but modified slightly below) however the client must be able to add constant content and a JSON file was too difficult for them to edit. I am now creating a page for each drug as a WordPress post (and perhaps use a tag to distinguish it for search) and would like people to search for that drug (eg codeine) using ajax. But instead of showing a small description of the search (like all ajax searches i've been able to find), I want to show the whole post\u2019s content on that same page just below the search bar. I'm currently using a builder (DIVI) but happy to do whatever works as long as the output is styled nicely. This was our original code. Any help would be greatly appreciated as I'm not terrifically techy!\nTHIS WAS THE CODE:\n<script src=\"https://code.jquery.com/jquery-1.9.1.min.js\"></script>\n<script> \n$( document ).ready(function() {\n $('#txt-search').keyup(function(){\n var searchField = $(this).val();\n if(searchField === '')  {\n $('#filter-records').html('');\n return;\n }\n var regex = new RegExp(\"^\" + searchField, \"i\");\n var output = '<div class=\"row\">';\n var count = 1;\n\n $.each(data, function(key, val){   \nvar colorClass = 'alertButtonGreen';\n   \nif ((val.id.search(regex) != -1) || (val.id.search(regex) != -1)) {\n\nif (val.warningsColor == 'Red') {\n  colorClass = 'alertButtonRed';\n} else if (val.warningsColor == 'Orange') {\n  colorClass = 'alertButtonOrange';\n}\n   \n output += '<div class=\"contentWrap\">';\n output += '<div class=\"\">';\n output += '<h2>' + val.id + '</h2>';\n output += '<h3>' + val.headingTitle + '</h3>'\n output += '<div class=\"alertButton ' + colorClass + '\">' + val.warningsButton + '</div>'\n output += '<p>' + val.contentText + '</p>';\n output += '<div class=\"superScript\">' + val.superscriptText + '</div>';\n output += '</div>';\n output += '</div>';\n if(count%2 == 0){\n output += '</div><div class=\"row\">'\n }\n count++;\n }\n });\n output += '</div>';\n $('#filter-records').html(output);\n });\n});\n  var data = [\n {\n \"id\": \"Codeine\", \n \"headingTitle\": \"Drug Interactions between Codeine and Alcohol\",\n \"warningsTitle\": \"Interactions between your drugs\",\n \"warningsButton\": \"Major Interaction\",\n \"warningsColor\": \"Red\",\n \"contentText\": \"Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit.\",\n \"interactionsTitle\": \"Drug Interaction Classification\",\n \"moreInfo\": \"Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit\",\n \"superscriptText\": \"<h4>References</h4>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit.\"\n }\n ]\n</script>\n\nAND THIS WAS THE SEARCH BOX:\n<div class=\"searchForm\">\n    <form role=\"form\">\n        <div class=\"form-group\">\n            <label>Search Drug Interactions</label> <input type=\"input\" class=\"form-control input-lg\" id=\"txt-search\" placeholder=\"Enter Drug Name\">\n        </div>  \n    </form>\n        </div>\n    <div id=\"filter-records\"></div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405988", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Forcing page to top of the list when using get_pages I am using get_pages to pull the children pages from a parent and listing them in a similar way to the standard WP loop for pages. This works well using the code referenced below - however.. what I would like to be able to do is to list a page I know the ID for at the top irrespective of its publish date (I am listing the pages in date order). Is this possible? Page ID of the page I want to always be listed first is #196.\nThanks\n<?php\n$ids = array();\n$pages = get_pages(\"child_of=\".$post->ID);\nif ($pages) {\n    foreach ($pages as $page) {\n        $ids[] = $page->ID;\n    }\n}\n$paged = (get_query_var(\"paged\")) ? get_query_var(\"paged\") : 1;\n$args = array(\n    \"paged\" => $paged,\n    \"post__in\" => $ids,\n    \"posts_per_page\" => 100,\n    \"post_type\" => \"page\"\n);\nquery_posts($args);\nif (have_posts()) : while (have_posts()) : the_post(); ?>\n<div class=\"feedItemWrapper wpb_animate_when_almost_visible wpb_fadeInUp fadeInUp\">\n<a href=\"<?php the_permalink(); ?>\" title=\"<?php the_title(); ?>\">\n<?php echo get_the_post_thumbnail( $post_id, 'full', array() ); ?>\n<div class=\"feedItemContentWrapper\">\n<h3><?php the_title(); ?></h3>\n<p><?php the_excerpt(); ?></p>\n<p class=\"date\"><?php echo get_the_date(); ?></p>\n</div>\n</a>\n\n\nA: if the result of query_posts($args) is the array of which you want to modify the order, something like that could possibly work:\n$the_posts = query_posts($args);\n\n$mypost = [];\nfor ($i=0;$i<sizeof($the_posts);$i++){\n    if ($the_posts[$i]['id'] === '196'):\n        $mypost = $the_posts[$i];\n        unset($the_posts[$i]);\n    endif;\n} \n\nif(!empty($mypost)):\n    array_unshift($the_posts,$mypost);\nendif;\n\n//your loop with the new post array\nforeach $the_posts as $post_iteration:\n    setup_postdata($post_iteration);\n\n    the_post_thumbnail()....\nendforeach;\nwp_reset_postdata();\n\n\nA: If you look at your first query to find the IDs you will see that you create a list of $ids in the order that get_pages() returns. Default to this is 'post_title'.\nSo if you pass a sort_column to this query you can get this to return in date order.\n$ids   = array();\n$pages = get_pages(\n    array(\n        'child_of'    => $post->ID,\n        'sort_order'  => 'DESC', // Choose your sort options in your first query args\n        'sort_column' => 'post_date',\n    )\n);\nif ( $pages ) {\n    foreach ( $pages as $page ) {\n        $ids[] = $page->ID;\n    }\n}\n\nThen just inject your chosen post in the begining of that $ids array\n$ids   = array_unshift( $ids, 196 );\n\nNow sort your posts by the order your IDs are in\n$paged = ( get_query_var( 'paged' ) ) ? get_query_var( 'paged' ) : 1;\n$args  = array(\n    'paged'          => $paged,\n    'post__in'       => $ids,\n    'posts_per_page' => 100,\n    'post_type'      => 'page',\n    'orderby'        => 'post__in',\n);\nquery_posts( $args );\nif ( have_posts() ) :\n    while ( have_posts() ) :\n        the_post();\n        // etc \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405993", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: End of blog roll or start of blog roll, _post_link = false / no link Please help, how do you write this\nif next_post_link() = false / no link or end of blog roll :\n do this;\nelse :\n return;\nendif;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405994", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: RSS feed for a custom page template I would like to know if it is possible to have a custom feed based on a page template and how?\nThis is my custom query:\n$my_custom_query = new WP_Query( array('cat' => array (4335, 12488),\n    'posts_type' => 'post',\n    'showposts' => 35,\n    'paged' => $paged,\n    'meta_key' => 'views', \n    'orderby'=> 'meta_value',\n    'order' => 'desc',\n    //'orderby' => 'desc',\n    // BOF EXCLUDES POSTS YOUNGER THEN TODAY -30 DAYS *  \n    'date_query' => array(\n    'column' => 'post_date',\n    //'after' => '2010-01-01',\n    //'before' => date('Y-m-d', strtotime('-30 days')) \n    ),\n    // EOF EXCLUDES POSTS YOUNGER THEN TODAY -30 DAYS \n    //'offset' => '21',\n    'post__not_in' => get_option( 'sticky_posts' ),\n    'meta_query' => array('0' => array('key' => 'videos_na', 'value' => 'true', 'compare' => 'NOT EXISTS'),\n    array('key' => 'master_id', 'value' => 'true', 'compare' => 'NOT EXISTS'),\n    array('key' => 'old_id', 'value' => 'true', 'compare' => 'NOT EXISTS'),\n   )));\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/405997", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how do I turn off whatever causes links to be embedded as URL's site title When I print a url onto my site, it automatically gets wrapped in:\n<blockquote class=\"wp-embedded-content\" data-secret=\"tDj3qpdVAi\"><a href=\"https://www.example.com/\">Example Domain</a></blockquote>\n\neven though all I printed to the page is \"https://www.example.com/\".  What is this mechanism and how can I disable either on a specific page or site-wide?\nWhat I Tried\n\n*\n\n*adding the code here to my functions file: https://crunchify.com/how-to-disable-auto-embed-script-for-wordpress-4-4-wp-embed-min-js/\n\n*adding both snippets of code (separately) from here to my functions file:\nhttps://kinsta.com/knowledgebase/disable-embeds-wordpress/#:~:text=Disable%20Embeds%20in%20WordPress%20With,the%20core%20contributors%20to%20WordPress.\n\n\nA: Print that plain text url as a link:\n<a href=\u201chttps://example.com\u201d>https://example.com</a>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406001", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress: Export/Import Yoast meta title & description to custom taxonomy I want to export the Yoast meta title & description from a custom taxonomy with the WP All Export. Unfortunately there is no direct way with the plugin to do that.\nThere is an extra WP All Export addon for Yoast but it doesn't work for custom taxonomies.\nI tried to use a custom function in the export to get the title and description. But my function doesn't work either. Im not sure why.\nHere's my current function:\nfunction yoast_wpseo_title($value) {\n    \n    $my_yoast_wpseo_title = WPSEO_Taxonomy_Meta::get_term_meta($this->term, $this->term->taxonomy, 'title');\n    if( $my_yoast_wpseo_title ){\n        return $my_yoast_wpseo_title;\n    } else {\n        return '';\n    }\n    \n}\n\nI'm using the function in the function editor within the export. Like this:\n\nIs there anything  that I'm missing? Or isn't it possible that way?\nMaybe there's another option to export these fields (and import them later)?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406005", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Limiting actions only to edit.php page for specific custom post type Excuse me if something like this has been asked before. So, I'm trying to alter the query which displays the posts of a custom post type, but on the admin side, more precisely, the edit.php page. This is my code:\nfunction my_function() {\n    global $pagenow, $typenow;\n    if( 'edit.php' == $pagenow && 'certain-post-type' === $typenow ) {\n      // do something\n    }\n}\nadd_action( 'admin_init', 'my_function' );\n\nThe main problem is not altering the query itself (yet!), but targeting only the edit.php page which lists the custom-post-type posts. It works when I hook onto the admin_init hook, but I understand that admin_init runs on every admin page load, which seems a bit unnecessary. I tried limiting this to fire only on the edit.php page for the custom post type by setting the hook to\nadd_action( 'load-edit.php', 'my_function' );, but this did nothing.\nCouldn't find much documentation on the load-{$pagenow} hook, hopefully the community can steer me in the right direction and tell me what I did wrong?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406006", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why is $_POST empty when saving custom Meta Box? I'm creating a Meta Box in my custom Plugin where the Administrator can select which users can view a certain post based on their roles. When I select the role and save the meta box content by clicking on the Update button, nothing gets saved because both $_POST['metabox_nonce'] and $_POST['membership_level'] are empty. Why is the form not sending any data? Thank you so much for your help.\nThis is my code:\nadd_action( 'add_meta_boxes', array($this, 'add_italianglot_membership_box' )); \n\nadd_action( 'save_post', array( $this, 'italianglot_membership_save_post_meta_box' ), 10, 2 );\n\npublic function add_italianglot_membership_box($post_type) { \n            \n            $post_types = get_post_types( array( 'public' => true ), 'names' );\n            add_meta_box(\n                'italianglot_box_id',                \n                'Italianglot Level',                 \n                array( $this, 'italianglot_membership_box_html' ),\n                $post_type,\n                'side',\n                'default'\n            );\n        \n    }\n    \n    public function italianglot_membership_box_html( $post ) { \n        global $post;\n        wp_nonce_field( basename( __FILE__ ), 'italianglot_metabox_nonce' );\n        ?>\n        <div>Require the below membership tier or higher to view this post.<p></div>\n        <select name=\"ig_membership_level\" id=\"ig_membership_level\" class=\"form-input\">\n            <option value=\"everyone\">Everyone</option>\n            <option value=\"subscriber\">Registered</option>\n            <option value=\"selflearner\">Self Learner</option>\n            <option value=\"basiclearner\">Basic Learner</option>\n            <option value=\"activelearner\">Active Learner</option>\n            <option value=\"advancedlearner\">Advanced Learner</option>\n        </select>\n        <?php\n    }\n\n\n    public function italianglot_membership_save_post_meta_box( $post_id, $post ) { \n        \n        if ( !isset( $_POST['italianglot_metabox_nonce'] ) || !wp_verify_nonce( $_POST['italianglot_metabox_nonce'], basename( __FILE__ ))  ) {\n            $test = $_POST['ig_membership_level'];\n            error_log($test, 1, \"myemail@gmail.com\"); //This is where I test the variable content and it's always empty\n            return $post_id;\n        }\n\n        $post_type = get_post_type_object( $post->post_type );\n\n        if ( !current_user_can( $post_type->cap->edit_post, $post_id ) ) {\n            return $post_id;\n        }\n        \n        if(isset( $_POST['ig_membership_level'] ) ) {\n            $italianglot_level = $_POST['ig_membership_level'];\n        } else {\n            $italianglot_level = \"everyone\";\n        }\n        \n        update_post_meta( $post_id, 'ig_membership_level', $italianglot_level );\n        \n        \n    }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406007", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding /blog in front of single posts (only) I would like to add /blog in front of the url for a single post:\ne.g.\n\n*\n\n*website.com/blog/news-article -> single article\n\n*website.com/blog -> blog archive (showing a list of all blogs etc.)\n\nIve tried adding /blog/%postname% as the permalink structure, however it adds it in front of everything, including some custom post types:\ne.g.\n\n*\n\n*website.com/blog/shops/single-shop-page\n\nHow do I go about adding it in front of posts but nothing else?\nThanks in Advance!\nM\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406008", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: list/consult Taxonomy only for the respective author/creator in dashbboard I'm trying to filter so that only the creators of the respective categories can edit them.\nI created a cat_author meta field and associated it to the taxonomy.\nIn this way, every taxonomy has an author. And I tended to filter with\nadd_filter( 'pre_get_terms', 'filter_cat_by_u_id', 99, 1 );\nfunction filter_cat_by_u_id( $query ) {\n    if ( ! is_admin() ) {\n      return $query;\n    }\n    global $pagenow;    \n    if ( 'edit-tags.php' === $pagenow ) {\n        $meta_query = array(\n            array(\n                'key' => 'cat_author',\n                'value' => get_current_user_id(),\n                'compare' => '='\n            )\n        );\n        $query->set( 'meta_query', $meta_query );\n    }\n    return $query;\n}\n\nBut I'm not getting a good result. Does anyone have any tips?\nUPDATE:\nadd_filter( 'get_terms_args', 'filter_cat_by_u_id' );\nfunction filter_cat_by_u_id( $args ) {\n    global $pagenow;\n\n    if ( is_admin() && 'edit-tags.php' === $pagenow ) {\n        $args['meta_query'] = array( \n            array(\n                'key' => 'cat_author',\n                'value' => get_current_user_id(),\n                'compare' => '='\n            )\n        );\n    }\n\n    return $args;\n}\n\nThanks to Sally I this solution works perfectly fine to filter the list of custom categories in wp-admin/dahsboar.\n\nA: The WP_Term_Query class doesn't have a method named set, and calling $query->set() in my case resulted in a fatal/critical error saying \"Call to undefined method WP_Term_Query::set()\". :/\nBut you can directly modify the query_vars property (i.e. $query->query_vars), like so, to set, unset or override any query variables like meta_query:\n// Use this:\n$query->query_vars['meta_query'] = $meta_query;\n\n// NOT this (which causes a fatal error):\n$query->set( 'meta_query', $meta_query );\n\nOr you could instead use the get_terms_args hook:\nadd_filter( 'get_terms_args', 'filter_cat_by_u_id' );\nfunction filter_cat_by_u_id( $args ) {\n    global $pagenow;\n\n    if ( is_admin() && 'edit-tags.php' === $pagenow ) {\n        $args['meta_query'] = array( your code here );\n    }\n\n    return $args;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406009", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Wordpress change wp_nav_menu walker with a custom one I have a downloaded theme and it where the wp_nav_menu is created it looks something like this:\n<div class=\"nv-nav-wrap\">\n    <div role=\"navigation\" class=\"<?php echo esc_attr( join( ' ', $container_classes ) ); ?>\"\n            aria-label=\"<?php esc_attr_e( 'Primary Menu', 'neve' ); ?>\">\n\n        <?php\n        echo wp_nav_menu(\n            [\n                'theme_location' => 'primary',\n                'menu_id'        => $menu_id,\n                'menu_class'     => 'primary-menu-ul nav-ul' . $additional_menu_class,\n                'container'      => 'ul',\n                'walker'         => '\\Neve\\Views\\Nav_Walker',\n                'fallback_cb'    => '\\Neve\\Views\\Nav_Walker::fallback',\n                'echo'           => false,\n            ]\n        );\n        ?>\n    </div>\n</div>\n\n\nI've created a child theme and I want to change the walker of the wp_nav_menu. How can I do that?\nThe new walker's name is  \"Aria walker Nav menu\" (just for reference)\nI've tried putting this in functions.php in the child theme:\n    wp_nav_menu( array(\n      'theme_location' => 'primary',\n      'container'      => false,\n      'menu_class'     => 'primary-menu-ul nav-ul',\n      'walker'         => new Aria_Walker_Nav_Menu(),\n      'items_wrap'     => '<ul id=\"%1$s\" class=\"%2$s\">%3$s</ul>',\n    ) );\n\nBut it creates a whole new menu. How do I just replace the walker for the original one in the theme\n\nA: In general you'd add child substitutions for the relevant templates if possible, as Tom mentions in the comments.\nAlternately, you can use a wp_nav_menu_args filter hook to swap in your own arguments prior to WordPress retrieving and rendering the menu:\nadd_filter( 'wp_get_nav_menu_args', 'wpse406010_primary_nav_menu_args' );\n\nfunction wpse406010_primary_nav_menu_args( $args ) {\n  if( $args[ 'theme_location' ] !== 'primary' || $args[ 'walker' ] !== '\\Neve\\Views\\Nav_Walker' )\n    return $args;\n\n  $args[ 'container' ]  = false;\n  $args[ 'menu_class' ] = 'primary-menu-ul nav-ul';\n  $args[ 'walker' ]     = new Aria_Walker_Nav_Menu();\n  $args[ 'items_wrap' ] = '<ul id=\"%1$s\" class=\"%2$s\">%3$s</ul>';\n\n  return $args;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406010", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add custom meta to 'pre_get_terms'? I have a custom taxonomy with custom meta. I have added the custom meta values to columns in the admin list page just fine. But if I search for values that are in these columns nothing is found. I'm assuming I need to use pre_get_terms, but am having trouble figuring out how to include the meta in the query.\n\nHere is what I am trying to do to test one of the fields, but results are still negative.\nadd_action( 'pre_get_terms', [$this, 'filter_feedback_stats_admin_columns'] );\npublic function filter_feedback_stats_admin_columns( $query ) {\n    // Get the page\n    global $pagenow;\n    \n    // Only if current post taxonomy or edit page in admin\n    $taxonomy = isset($_GET['taxonomy']) ? $_GET['taxonomy'] : '';\n    if ( !is_admin() || $pagenow !== 'edit-tags.php' || $taxonomy != 'feedback-stats' && !isset($_GET['s'])) {\n        return $query; \n    }\n\n    // Search keyword\n    $s = $_GET['s'];\n    \n    // // store current query vars\n    $query_vars = $query->query_vars;\n    $args = [];\n    \n    // set meta query\n    $args['meta_query'] = [\n        [\n        'key'       => 'access_id',\n        'value'     => $s,\n        'compare'   => 'LIKE'\n        ]\n    ];\n    \n    // Add it\n    $query->query_vars = array_merge( $query_vars, $args );\n}\n\n\nA: Most likely because the query is also searching for a match against the term name/slug, as opposed to \"match either term name or meta field\".\nIf you don't need the search to also look for matches by term name/slug, just unset the search term early on when you apply your meta query:\nadd_action( 'parse_term_query', function ( $wp_term_query ) {\n    $taxonomy = $wp_term_query->query_vars['taxonomy'];\n\n    $search = $wp_term_query->query_vars['search'] ?? '';\n\n    if ( ! $search || $taxonomy !== [ 'feedback-stats' ] ) {\n        return;\n    }\n\n    unset( $wp_term_query->query_vars['search'] );\n\n    $meta_query = [\n        'relation' => 'OR',\n    ];\n\n    $search_meta_keys = [\n        'access_id',\n        // Add your other meta keys\n    ];\n\n    foreach ( $search_meta_keys as $key ) {\n        $meta_query[] = [\n            'key' => $key,\n            'value' => $search,\n            'compare' => 'LIKE',\n        ];\n    }\n\n    $wp_term_query->query_vars['meta_query'] = $meta_query;\n});\n\nIf you do indeed need the search to match either the term name or field(s), there's a bit more work ahead of you as we'll need to hook into the generated SQL of the meta query and create an OR search.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406011", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can you disable typography panels for just the paragraph block? I'm wondering if there is a way to remove the typography and custom color panels from the sidebar for just the paragraph block.\nI've currently written a function that I've added add_theme_support to for the typography panel and custom color picker but it's affecting every block that can utilize those things. Here is said function:\n    public function typography_custom_color_theme_support() {\n        // Disable Custom Color Picker\n        add_theme_support( 'editor-color-palette' );\n        add_theme_support( 'disable-custom-colors' );\n        // Disable Font Size and Custom Font Size Dropdowns\n        add_theme_support( 'editor-font-sizes' );\n        add_theme_support( 'disable-custom-font-sizes' );\n}\n\nIf possible, could I add a conditional to this along the lines of \"if paragraph block is selected run add_theme_support actions?\"\nThank you.\n\nA: yes you can remove those options via theme.json but it has to be done block by block.\nThis might help you (not my course):\nhttps://wpdevelopment.courses/articles/block-editor-typography-settings/#disable-font-size-controls\n\nA: Aug 2022\nUsing theme.json\nThe easier and most convenient way is to use theme.json. use false for all the properties.\nRemove for only paragraph blocks\n{\n    \"version\": 2,\n    \"settings\": {\n        \"blocks\":{\n            \"core/paragraph\":{\n                \"typography\":{\n                    \"customFontSize\": false,\n                    \"lineHeight\": false,\n                    \"dropCap\": false,\n                    \"fontStyle\": false,\n                    \"fontWeight\": false,\n                    \"letterSpacing\": false,\n                    \"textDecoration\": false,\n                    \"textTransform\": false,\n                    \"fontSizes\": [],\n                    \"fontFamilies\": []\n                }\n            }\n        }\n    }\n}\n\nRemove for all\n{\n    \"version\": 2,\n    \"settings\": {\n        \"typography\":{\n            \"customFontSize\": false,\n            \"lineHeight\": false,\n            \"dropCap\": false,\n            \"fontStyle\": false,\n            \"fontWeight\": false,\n            \"letterSpacing\": false,\n            \"textDecoration\": false,\n            \"textTransform\": false,\n            \"fontSizes\": [],\n            \"fontFamilies\": []\n        }\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406014", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How do I include and iframe in a Custom Block? Given the html block tag I can include and iframe from Google My Maps in my post.\nI need to create a block where the client can paste the URL from the embed code and the block render the iframe.\nnote: \"embed code\" does not mean using the embed tag, but that is what the iframe code is called to embed the map on a web page.\nI have attempted with Genesis Custom Blocks but it will not render the iframe.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406015", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: multisite - unable to connect to network administration I install wordpress and set my website as multisite to have many sites\nI certainly make a mistake as I can't access to network administration anymore\nso I can't add a new site or see themes ....\nI don't know where to search and any help will be welcome\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406016", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can i export and import my plugin option Wordpress I am trying to export the plugin options that I created.\nif(!get_option('myplugin_opts') ){\n  add_option('myplugin_opts');\n}\n\nand also I want to know how I could import the options to WordPress for my plugin, thanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406017", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sort users by meta key value even if meta key not present for all users Only some users have a specifice meta_key some_metakey associated with their ID.\nThe following args successfully orders users with a specified role by some_metakey but only those with that meta_key.\nCan anyone point the direction to change the args to include ALL users with a specified role even if they do not have the some_metakey meta_key?\n$args = array(\n    'role__in' => \n    [ \n        'role1', \n        'role2', \n        'role3', \n        'role4' \n    ],\n    'order' => 'DEC', \n    'meta_key' => 'some_metakey',\n    'orderby' => 'meta_value'\n);\n$users = get_users( $args );\n\n\nA: WordPress roles are stored in $wpdb->usermeta with wp_capabilities meta key, however, as a serialized array (see maybe_serialize).\nSo you could actually make a group of meta queries, with OR as the relation, to find users with any role of your 4 defined roles, OR users having a certain meta key and value:\nPlease note that in you change the roles, make sure to calculate the character length for that role, and place that length after s: characters (e.g; for administrator, the meta value search will be s:13:\"administrator\";b:1, and s:10:\"subscriber\";b:1 for subscriber users).\n$args = array(\n    'meta_query' => [ \n        'relation' => 'OR',\n        [\n            'key' => 'wp_capabilities',\n            'value' => 's:5:\"role1\";b:1',\n            'compare' => 'LIKE',\n        ],\n        [\n            'key' => 'wp_capabilities',\n            'value' => 's:5:\"role2\";b:1',\n            'compare' => 'LIKE',\n        ],\n        [\n            'key' => 'wp_capabilities',\n            'value' => 's:5:\"role3\";b:1',\n            'compare' => 'LIKE',\n        ],\n        [\n            'key' => 'wp_capabilities',\n            'value' => 's:5:\"role4\";b:1',\n            'compare' => 'LIKE',\n        ],\n        [\n            'key' => 'some_metakey',\n            'value' => 'YOUR VALUE HERE',\n            'compare' => '=', // or any other comparator, see WP_Meta_Query docs\n        ],\n    ],\n    // 'order' => 'DESC', \n    // 'meta_key' => 'some_metakey',\n    // 'orderby' => 'meta_value'\n);\n\n$users = get_users( $args );\n\nNow for the ordering, that can get difficult - if you do not limit your queries then you could just do a usort order on the result array, otherwise, look into WP_User_Query, they have some hooks to use to manipulate the class state and hence the SQL query.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406019", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: website redirects to homepage for all 404 pages, wp-cron and admin-ajax.php My multisite WP website is redirecting all the 404, wp-cron.php, and admin-ajax.php to the homepage when the user is not logged in.\n.htaccess rules:\nRewriteEngine On\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\n\n# add a trailing slash to /wp-admin\nRewriteRule ^([_0-9a-zA-Z-]+/)?wp-admin$ $1wp-admin/ [R=301,L]\n\nRewriteCond %{REQUEST_FILENAME} -f [OR]\nRewriteCond %{REQUEST_FILENAME} -d\nRewriteRule ^ - [L]\nRewriteRule ^([_0-9a-zA-Z-]+/)?(wp-(content|admin|includes).*) $2 [L]\nRewriteRule ^([_0-9a-zA-Z-]+/)?(.*\\.php)$ $2 [L]\nRewriteRule . index.php [L]\n\nPlease help me fix it.\nThank you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406023", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Assigning a category to a custom post type in Wordpress I am working with custom posts to create a 'document' custom post type and then trying to assign the category during wp_insert_post, have tried using both post_category and tax_input to no success.\nI am registering the custom post as below, keeping in the relevant bits below so it does have $labels defined and a few more $args that I have stripped out.\nMy research has indicated that permissions need to be created in the custom post type before assigning them to a user role. The user is not logged in, which I understand causes some issues, however in this case I have $user_id passed in which provides the ID in the title and to set the author without a problem so I don't think this is where the problem lies.\nAny thoughts on where I am going wrong?\nRegistering the custom post type:\nfunction document_custom_post_type() {\n \nregister_taxonomy('document-category', 'Documents',array(\n    \"hierarchical\" => true,\n    \"label\" => \"Categories\",\n    \"singular_label\" => \"document\",\n    'query_var' => true,\n    'rewrite' => array( 'documents' => 'slug name of new registered taxonomy',\n    'with_front' => false ),\n    'public' => true)\n    );\n          \n    $args = array(\n        'labels'              => $labels,\n        'supports'            => array( 'title', 'author', 'comments' , 'custom-fields', ),\n        'taxonomies'          => array( 'document-category', ),\n        'hierarchical'        => true,\n        'public'              => true,\n        'capabilities'        => array(\n            'manage_terms'    => 'manage_document',\n            'edit_terms'      => 'manage_document',\n            'delete_terms'    => 'manage_document',\n            'assign_terms'    => 'edit_posts'\n        ),\n        'capability_type'     => 'post',\n        'map_meta_cap'    => true,\n    );\n     \n    // Registering Document Custom Post Type\n    register_post_type( 'document', $args );\n \n}\nadd_action( 'init', 'document_custom_post_type', 0 );\n\nThe user role in particular has several caps already, but in this case edit_posts and manage_document are both set to true:\n    $client_role = add_role('Client', __('Client'), array(\n    'read'                       => true,\n    'edit_posts'                 => true,\n\n    'edit_documents'             => true,\n    'edit_others_documents'      => false,\n    'publish_documents'          => true,\n    'read_private_documents'     => false,\n    'manage_document'            => true,\n    'delete_document'           => true,\n    'delete_private_documents'   => true,\n    'delete_published_documents' => true,\n    'delete_others_documents'    => false,\n    'edit_private_documents'     => false,\n    'edit_published_documents'   => true,\n    \n    )); \n\nWhen the user verifies their email, I create two custom post types with some pre-defined settings so the example below is for category ID 6 and category ID 4. All fields except the category works, I've included both versions I've tried in the commented out rows:\nIn functions.php:\n            $user_post = array(\n                'post_title'     => 'Security Questionnaire '.$user_id.'',\n                'post_status'    => 'publish',\n                'post_author'    => $user_id,\n                'post_type'      => 'document',\n                'page_template'  => 'page-templates/document.php',\n                //'post_category'  => array( 4 ),\n                'tax_input' => array( 'document-category' => array(4) ), //ID = 4 is the tag ID for the Security Questionnaires category\n            );\n            $post_id = wp_insert_post( $user_post );\n\nAnd then:\n            $user_post = array(\n                'post_title'     => 'Contract '.$user_id.'',\n                'post_status'    => 'publish',\n                'post_author'    => $user_id,\n                'post_type'      => 'document',\n                'page_template'  => 'page-templates/document.php',\n                //'post_category'  => array( 6 )\n                'tax_input' => array( 'document-category' => array(6) ), //ID = 6 is the tag ID for the Contract category\n            );\n            $post_id = wp_insert_post( $user_post );\n\n            $verified_user = new WP_User( $user_id );\n            $verified_user->set_role( 'client' );\n\nCan anyone see where I am going wrong? It seems like this should be straight forward but have been struggling with it for a while now.\n\nA: Couple things I've spotted:\n\n*\n\n*Your taxonomy registration register_taxonomy( 'document-category', 'Documents'  should be register_taxonomy( 'document-category', 'document'  - the second parameter is the post type name(s), not the post type label.\n\n\n*If you're programmatically inserting posts then forget using tax_input in your wp_insert_post() data args. There's a hard-coded permissions check on the current user and there's nothing you can do to override it:\n    // New-style support for all custom taxonomies.\n    if ( ! empty( $postarr['tax_input'] ) ) {\n        foreach ( $postarr['tax_input'] as $taxonomy => $tags ) {\n            $taxonomy_obj = get_taxonomy( $taxonomy );\n\n            if ( ! $taxonomy_obj ) {\n                /* translators: %s: Taxonomy name. */\n                _doing_it_wrong( __FUNCTION__, sprintf( __( 'Invalid taxonomy: %s.' ), $taxonomy ), '4.4.0' );\n                continue;\n            }\n\n            // array = hierarchical, string = non-hierarchical.\n            if ( is_array( $tags ) ) {\n                $tags = array_filter( $tags );\n            }\n\n            if ( current_user_can( $taxonomy_obj->cap->assign_terms ) ) {\n                wp_set_post_terms( $post_ID, $tags, $taxonomy );\n            }\n        }\n    }\n\nInstead take note from the code above and do it yourself:\n$post_id = wp_insert_post( $user_post );\n\nwp_set_post_terms( $post_id, [ 4 ], 'document-category' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406026", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Implement Search Functionality? <div class=\"col-lg-8\">\n                <div class=\"row\">\n                    <?php\n                    $search_term = get_search_query();\n                    $term = get_term_by('slug', $search_term, 'blog_taxonomy');\n                    $term_name = $term->name;\n                    $args = array(\n                        'post_type' => 'blog',\n                        // 'title' => $search_term,\n                        'tax_query' => array(\n                            array(\n                                'taxonomy' => 'blog_taxonomy',\n                                'field'    => 'slug',\n                                'terms'    => $search_term,\n                                'orderby'   => array(\n                                    'date' => 'DESC',\n                                ),\n                            ),\n                        ),\n                    );\n                    $loop = new WP_Query($args);\n\n                    if ($loop->have_posts()) {\n                        while ($loop->have_posts()) {\n                            $loop->the_post();\n                    ?>\n                            <div class=\"col-lg-6 col-md-6\">\n                                <div class=\"blog-content radius30 cB-shadow cBorder mw-100\">\n                                    <div class=\"blog-img text-center position-relative\">\n                                        <div class=\"date-time position-absolute\">\n                                            <div class=\"date\">\n                                                <h6><?php the_time('j') ?></h6>\n                                            </div>\n                                            <div class=\"month\">\n                                                <p><?php the_time('M') ?></p>\n                                            </div>\n                                        </div>\n                                        <?php if (has_post_thumbnail($post->ID)) : ?>\n                                            <?php $image = wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), 'single-post-thumbnail'); ?>\n                                            <img src=\"<?= $image[0] ?>\" alt=\"\">\n                                        <?php endif; ?>\n                                        <img src=\"<?php echo get_template_directory_uri(); ?>/assets/images/blog/blog-logo.svg\" class=\"blog-logo\" alt=\"\">\n                                    </div>\n                                    <div class=\"blog-text\">\n                                        <h5><?php the_title(); ?></h5>\n                                        <h5><?= $term_name ?></h5>\n                                        <p class=\"p-gray\">\n                                            <?php $content = get_the_excerpt();\n                                            $trimmed_content = wp_trim_words($content, 25); ?>\n                                            <?php echo $trimmed_content; ?>\n                                        </p>\n                                        <div class=\"py-3\">\n                                            <a href=\"<?= the_permalink(); ?>\" class=\"cmn-btn\">Explore more</a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                    <?php wp_reset_postdata();\n                        }\n                    }\n                    ?>\n                </div>\n            </div> \n\nAbove is the code for my search Functionality, where I am using custom post type \"blog\" and custom taxonomy that is \"blog_taxonomy\". I am able to get results only from tax_query or title.\nI want them both searchable, as user either enters taxonomy name or post title in search bar.\nHow to implement both ? tax_queries as well as commented 'title'.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406029", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do you remove header sitewide from mobile only? I'm having trouble hiding my header on mobile devices. My wordpress theme does not have an option to hide it, so I was looking at the theme's header.php file if there was anything I could add to it. Haven't been able to figure out a solution, any ideas?? Thanks\n<?php\n/**\n * The header for our theme\n *\n * This is the template that displays all of the <head> section and everything up until <div id=\"content\">\n *\n * @link https://developer.wordpress.org/themes/basics/template-files/#template-partials\n *\n * @package SacchaOne\n */\n\nif ( ! defined( 'ABSPATH' ) ) {\n    exit; // Exit if accessed directly.\n}\n?>\n<!doctype html>\n<html <?php language_attributes(); ?>>\n<head>\n    <meta charset=\"<?php bloginfo( 'charset' ); ?>\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <link rel=\"profile\" href=\"https://gmpg.org/xfn/11\">\n\n    <?php wp_head(); ?>\n</head>\n\n<body <?php body_class(); ?>>\n<?php\nif ( function_exists( 'wp_body_open' ) ) {\n    wp_body_open();\n} else {\n    do_action( 'wp_body_open' );\n}\n\n/**\n * Hook - sacchaone_header\n *\n * @hooked sacchaone_header - 10\n */\ndo_action( 'sacchaone_header' );\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406033", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Dynamically added custom fields not displayed on WooCommerce email notifications I have a different kind of scenario then the typical custom fields (I suppose). I am not getting custom values (fields) from user in the form rather I have an implementation which adds:\n\n*\n\n*ColorName\n\n*Size\n\n*City\n\nThese are from a custom product flow which adds custom attributes to the cart, here is how I am doing that:\nadd_action('wp_ajax_wdm_add_user_custom_data_options', 'wdm_add_user_custom_data_options_callback');\nadd_action('wp_ajax_nopriv_wdm_add_user_custom_data_options', 'wdm_add_user_custom_data_options_callback');\n\n\nfunction wdm_add_user_custom_data_options_callback()\n{\n    // print_r($_POST);\n    $productIDM = $_POST['product_id'];\n    // case swith\n    switch ($productIDM) {\n        case \"Ace Dura Silk\":\n            $productID = 3254;\n            break;\n        case \"Ace Matt Finish\":\n            $productID = 3232;\n            break;\n        case \"Ace Plastic Emulsion\":\n            $productID = 3276;\n            break;\n        case \"Ace Weather Defender\":\n            $productID = 2991;\n            break;\n        case \"Overall Plasticoat\":\n            $productID = 3112;\n            break;\n      }\n\n    $colorname = $_POST['colorname'];\n    $cityname = $_POST['cityname'];\n    $size = $_POST['size'];\n    $price = $_POST['price'];\n    global $woocommerce;\n    $woocommerce->cart->add_to_cart( $productID, 1 );\n    //   die();\n    // echo 'I am in...';\n    $result = array(\n        'status' => true\n    );\n    echo json_encode($result);\n}\nadd_filter('woocommerce_add_cart_item_data','wdm_add_item_data',1,10);\nfunction wdm_add_item_data($cart_item_data, $product_id) {\n\n    global $woocommerce;\n    $new_value = array();\n    $new_value['_custom_options'] = $_POST['custom_options'];\n\n    if(empty($cart_item_data)) {\n        return $new_value;\n    } else {\n        return array_merge($cart_item_data, $new_value);\n    }\n}\n\nadd_filter('woocommerce_get_cart_item_from_session', 'wdm_get_cart_items_from_session', 1, 3 );\nfunction wdm_get_cart_items_from_session($item,$values,$key) {\n\n    if (array_key_exists( '_custom_options', $values ) ) {\n        $item['_custom_options'] = $values['_custom_options'];\n    }\n\n    return $item;\n}\nadd_filter('woocommerce_cart_item_name','add_usr_custom_session',1,3);\nfunction add_usr_custom_session($product_name, $values, $cart_item_key ) {\n\n    $return_string = $product_name . \"<div class='cart_subitems_custom'><br /><small>\".$values['_custom_options']['colorname'].\"</small><br /><small>\".$values['_custom_options']['cityname'].\"</small><br /><small>\".$values['_custom_options']['size'].\"</small></div>\" ; //. \"<br />\" . print_r($values['_custom_options']);\n    return $return_string;\n\n}\nadd_action('woocommerce_add_order_item_meta','wdm_add_values_to_order_item_meta',1,2);\nfunction wdm_add_values_to_order_item_meta($item_id, $values) {\n    global $woocommerce,$wpdb;\n\n    wc_add_order_item_meta($item_id,'_colorname',$values['_custom_options']['colorname']);\n    wc_add_order_item_meta($item_id,'_cityname',$values['_custom_options']['cityname']);\n    wc_add_order_item_meta($item_id,'_size',$values['_custom_options']['size']);\n\n}\nadd_action( 'woocommerce_before_calculate_totals', 'update_custom_price', 1, 1 );\nfunction update_custom_price( $cart_object ) {\n    foreach ( $cart_object->cart_contents as $cart_item_key => $value ) {       \n        // Version 2.x\n        //$value['data']->price = $value['_custom_options']['custom_price'];\n        // Version 3.x / 4.x\n         if($value['_custom_options']['price'] == null){\n            echo\"\";\n        }else{\n            $value['data']->set_price($value['_custom_options']['price']);\n        }\n    }\n}\n\nI am getting these custom values almost everywhere except Email Notification.\nHere is what normal product order edit shows:\n\nHere is how I am getting the custom product in order edit page:\n\nI have tried all the solution I can possibly find (filter & action hooks) but nothing works for me.\nI have tried first answer from this:\nadd_action( 'woocommerce_checkout_create_order_line_item', 'custom_checkout_create_order_line_item', 20, 4 );\nfunction custom_checkout_create_order_line_item( $item, $cart_item_key, $values, $order ) {\n    if( isset( $values['colorname'] ) )\n        $item->add_meta_data( __('DCM Shade'), $values['_colorname'] );\n}\n\nAlso the common method I found everywhere:\nfunction custom_woocommerce_email_order_meta_fields( $fields, $sent_to_admin, $order ) {\n    // Get meta\n    $color = $order->get_meta( 'colorname', true );\n    \n    // NOT empty\n    if( ! empty( $color ) ) {  \n        $fields['colorname'] = array(\n            'label' => __( 'Shade' ),\n            'value' => $color,\n        );\n    }\n    \n    // Get (other) meta\n    $shipping_email = $order->get_meta( '_cityname', true );\n    \n    // NOT empty\n    if ( ! empty( $shipping_email ) ) { \n        $fields['_cityname'] = array(\n            'label' => __( 'City' ),\n            'value' => $shipping_email,\n        );\n    }\n    \n    return $fields;\n}\nadd_filter( 'woocommerce_email_order_meta_fields', 'custom_woocommerce_email_order_meta_fields', 10, 3 );\n\nBut I can't get the custom fields.\nWhat am I doing wrong can please anyone please guide me.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406034", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there a way to make [Table Of Content] plugin while not using revision data? I have a problem while using TOC plugins 'cause all of TOC plugins use revision data to recognize header tag. I'm using my own metadata (custum field) plugin and the data doens't show on the revision page. It means that the TOC plugins can not recognize my header tag data on the post page. Any great ideas?  This is one of the TOC plugins and you could see the \"get the revision\"\npublic function widget( $args, $instance ) {\n        global $ht_kb_toc_tools, $wp_query;\n\n        if( ! is_singular() )\n            return;\n\n        if ( ! isset( $wp_query ) ) {\n            return;\n        }\n\n\n        if( is_a($ht_kb_toc_tools, 'HT_KB_TOC_Tools') ){\n            if( $ht_kb_toc_tools->ht_block_toc_detected && apply_filters('ht_kb_toc_disable_on_ht_block_toc', true ) ){\n                //early exit if ht-block-toc detected\n                return;    \n            }                \n        }\n\n        extract( $args, EXTR_SKIP );\n\n        $instance = wp_parse_args( $instance, $this->defaults );\n\n        //$post = get_post( $wp_query->post->ID );\n        $post = get_post();\n\n        if( is_preview() ){\n            //get the post revisions\n            $post_revisions = ( wp_get_post_revisions( $post ) );\n\n            if ( !empty( $post_revisions ) ) {\n                //get the latest revision - this should be the current preview\n                $post = current( $post_revisions );\n            }\n        }\n\n        $title = apply_filters( 'widget_title', empty( $instance['title'] ) ? '' : $instance['title'], $instance, $this->id_base );   \n\n        if(is_a($ht_kb_toc_tools, 'HT_KB_TOC_Tools')){\n\n            //extract headings\n            $headings = $ht_kb_toc_tools->ht_kb_toc_extract_headings( do_shortcode( $post->post_content ), true ); \n\n            //don't output widget if no headings are in content\n            if(empty($headings))\n                return;\n\n            echo $before_widget;\n\n            if ( $title )\n                echo $before_title . $title . $after_title;\n\n\n            ?>\n            <nav id=\"navtoc\" role=\"navigation\">\n\n                \n\n            <?php\n            //display items\n            $ht_kb_toc_tools->ht_kb_display_items();\n            ?>\n\n            </nav>\n\n            <?php\n        }\n\n        echo $after_widget;\n\n    } // end widget\n\n\nA: The only reason it's talking about revisions is so the TOC still displays when you preview a post. It's nothing to do with your problem, which is that the TOC plugins are looking at your post content, but you're using page builders that store data in post meta. Unless the TOC plugin was built specifically to work with that page builder it can't see the data.\nOtherwise, there is no general solution to your problem, it is not possible to write an answer that covers all plugins.\nYou will need to find a specific solution for the combination of specific TOC and page builder plugin that you want to use. There is no generic way that works for all of them.\nFor example, the answer for Elementor + Heroic table of contents will not be the same as Elementor + Table of contents plus, or beaver builder + heroic.\nTo find those solutions you will need to ask their support routes or other users in their communities. No one size fits all solution exists.\nAlternatively, switch to a page builder that stores its data in the post content, or provides its own table of contents functionality.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406035", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Migration to WP - Couldn't load image Situation:\nI'm trying to migrate static page made with HTML/CSS/JS into Wordpress. The images won't load. They work in HTML, but when I migrate into PHP there are only alt-descriptions visible. Upon examining it in the Mozilla Dev Tools, there is a correct link to the image that displays the image upon clicking. However, on the migrated WP site there's an error \"Couldn't load image\". Directory seems correct, but image just won't load.\nWhat I tried.\n\n*\n\n*get_theme_file_uri()\n\n<img src=\"<?php echo get_theme_file_uri('/img/landing/landing__cat-headphones--fb.png') ?>\" class=\"d-block mx-lg-auto img-fluid landing__cat-headphones--img\" alt=\"lingcat-headphones\" loading=\"lazy\">\nThis one gets me a working link in the dev tools that I can click and it opens the image correctly. However on the page only alt-desc appears and dev tools displays \"Couldn't load image\".\n\n\n*get_template_directory_uri()\n\n<img src=\"<?php echo esc_url( get_template_directory_uri() . '//img/landing/landing__cat-headphones--fb.png' ); ?>\" class=\"d-block mx-lg-auto img-fluid landing__cat-headphones--img\" alt=\"lingcat-headphones\" loading=\"lazy\">\nThis one does pretty much the same thing like the method above.\n\n\n*Uploading the image into Media library and pasting the code to the src\n\n<img src=\"http://localhost/wp-content/uploads/2022/05/landing__cat-headphones-fb.png\" class=\"d-block mx-lg-auto img-fluid landing__cat-headphones--img\" alt=\"lingcat-headphones\" loading=\"lazy\"> \nAgain, the same thing. I can access the image via dev tools, so I'd assume the dir is correct, but WP just won't display the image.\nWhat else could I do?\n\nA: Due to Jacob Peattie's comment I decided to exam the HTML around rather than beating around the src-bush and it turned out that the  thing was the one causing problems. Once I took the image out of it, it displayed itself properly.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406044", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Bulk update published posts date randomly using wp-cli? I see an option ([--post_date=<post_date>]) in wp-cli, but how can we use wp-cli to update all my published posts date randomly?\nFor example, I want all posts date changed randomly between 01-01-2021 to 01-01-2022, how can I do this using cli?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406045", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How To Save Data From Remote APIs To ACF? I've been attempting to ingest remote data from an api partner into Wordpress. To data I've used wpallimport plugin, but it's quite limited.\nHow would one connect with a remote api and then save the data to a an ACF field either one time or periodically?\nI've test out wp_remote_get($apiUrl); and even created a POC but saving the data to the WP database has not been successful yet.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406046", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: WordPress WooCommerce email notifications going to spam folder I have just built a new WordPress site for a client, and repointed the domain's (mellowmarshfarm.com) DNS records to the new hosting service, Flywheel.\nThe client's custom email address is hosted by a different provider, and the notifications for the site are forwarded from WordPress via fw-mail.com, but they are going to the client's and customers' spam folders. I have tried adding x.fw-mail.com to the mail host's SPF record, but it didn't make a difference:\nv=spf1 ip4:[redacted] include:spf.antispamcloud.com include:x.fw-mail.com +a +mx ~all\n\nWhat else must I do to ensure the emails are associated with the new site and validated?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406050", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress get last inserted user id I want to disable user_login field into my CMS. They are register only their email adress. I think to create secret user login by programmatically. I think for accessibility and manageability also I want to use their ID'.\nFor this I want to know last user's ID. I know the unprofessional way of doing this. A way as below,\n    <?php\n    $args = array(\n        'orderby'      => 'registered',\n        'order'        => 'DESC',\n        'number'       => 1\n    );\n\n    $users = get_users($args);\n\n    $last_user_registered_ID = $users[0]->ID;\n\nBut I was wondering if there is a more professional way.\nIn addition to all this, I am always open to your criticism and different suggestions about the approach to this issue.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406052", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Contact Form 7 Wordpress, checking a few fields, if empty then invalid Could someone help me to solve the problem.\nI would like the system work like bellow.\n\n*\n\n*If both fields are empty = invalid.\n\n*If any of the fields is completed = valid\n\nadd_filter('wpcf7_validate_text', 'or_input_validation_filter', 20, 2);\n\nfunction or_input_validation_filter($result, $tag) {\n\n    if ('your-link' == $tag->name) {\n        $your_link = isset($_POST['your-link']) ? trim($_POST['your-link']) : '';\n        $your_file = isset($_FILES['your-file']) ? trim($_FILES['your-file']['name']) : '';\n        \n        if($your_link == '' && $your_file == '') {\n            $result->invalidate($tag, \"One of the fields has not been completed?\");\n        }\n    }\n    return $result;\n}\n\n\nA: I solved my problem\nadd_filter('wpcf7_validate_text', 'or_input_validation_filter', 20, 2);\n\nfunction or_input_validation_filter($result, $tag) {\n\n    if ('your-link' == $tag->name) {\n        $your_link = isset($_POST['your-link']) ? trim($_POST['your-link']) : '';\n        $your_file = (!empty($_FILES[\"file-image\"][\"name\"])) ? trim($_FILES['file-image']['name']) : '';\n\n        if($your_link == '' && $your_file == '') {\n            $result->invalidate($tag, \"One of the fields has not been completed?\");\n        }\n           \n    }\n    return $result;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406053", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can i filter wordpress users by custom feild? I'm displaying users (authors) on a page. how can I add a filter based on user custom feilds?\n    <?php\n                // THE USER QUERY ARGS\n                $args = [\n                    'role'   => 'author',\n                    'number' => -1,\n                ];\n                // THE USER QUERY\n                $user_query = new WP_User_Query($args);\n\n                // THE TOTAL SUBSCRIBERS NUMBER\n                echo '<h3 class=\"font-weight-bold\">Total Listed Shops: ' . $user_query->get_total() . '</h3>';\n                echo '<hr>';\n\n                // THE USER LOOP\n                if (!empty($user_query->get_results())) {\n                    foreach ($user_query->get_results() as $user) {\n                        // ACF PREFIX & FIELD DATA FROM USER PROFILE\n                        $location = get_user_meta($user->ID, 'yourprefix_location', true);\n                        $city = get_user_meta($user->ID, 'yourprefix_city', true);\n                        $images = get_user_meta($user->ID, 'blog_group', true);\n                        $archive_url = get_author_posts_url($user->ID);\n                        echo '<div class=\"card bg-light p-4\">';\n                        // USER DATA DISPLAY\n                        echo '<h1><a href=\"' . $archive_url . '\" title=\"' . __('View all posts by ', 'pippin') . $user->display_name . '\">' . $user->display_name . '</a></h1>';\n                        // ACF DATA DISPLAY\n                    \n                        echo '<p>ADDITIONAL INFO:</p>';\n                        echo '<p>City: <span class=\"text-danger\">' . $city . '</span></p>';\n                        echo '<p>Location: <span class=\"text-danger\">' . $location . '</span></p>';\n                        echo '<h6>e-mail: <span class=\"text-danger\">' . $user->user_email . '</span></h6>';\n\n                        echo '</div>';\n                        echo '<hr>';\n                    }\n                }\n                ?>\n\n\nA: You can make use of the meta_key and meta_value query arguments.\n$args = [\n    'role'   => 'author',\n    'number' => -1,\n    'meta_key' => 'yourprefix_location',\n    'meta_value' => 'somevalue' \n];\n\nSource: https://developer.wordpress.org/reference/classes/wp_user_query/#custom-field-parameters\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406054", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Changing static text in a theme into variable content that also respects language. Easiest way I bought a Theme which unfortunately has some static content, I managed to hide and remove some via editing and the custom css.\nBut I have a text field above the navigation where it says \"Work Time\" I need a way to write the German and English version of that text somewhere in my WP-Admin panel and tell the theme to load selected language text into that text field.\nI have coded some stuff in php js and mysql so I'm not new to coding but I don't know anything about coding for/in Wordpress. I need a quick solution. What would be the best way to go about it?\nI thought maybe use widgets and their content since with the Polylang Plug-in I can set widget content to specific languages.\nSo i basically need to place a language check there and load the according string.\nWould that be the quickest way? Can anybody point me to a solution?\nhere's the part of the header .php I'm talking about\n<ul class=\"bar\">\n<li class=\"address\"><?php echo esc_html__('Work Time', 'doors') ?></li>\n<li class=\"text_add\"><?php\n    $work_time = doors_get_option('work');\n    if (empty($work_time)) {\n        echo esc_html('');\n    } else {\n        echo esc_html(doors_get_option('work'));\n    }\n    ?></li>\n</ul>\n\nThank you in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406057", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to create a classified section in place of comments_template I am running a site where users can find great information about musical artists and their releases. Each release is a wordpress post. Each artist is a wordpress post. In my single-artist.php and my single-release.php, i use\ncomments_template();\n\nEDIT: here is my comments.php\n\ncomment_form();\n\nif (have_comments()) : \n\n    $wantto= get_comment_meta( $comment_id, 'wantto', true );\n    echo '<ol class=\"post-comments\">';\n            wp_list_comments(array(\n                'style'       => 'ol',\n                'short_ping'  => true,\n            ));\n            echo $wantto;\n          \n    echo '</ol>';\nendif;\n\nIt just shows a text box. Here's an example of a page with a comment form.\nhttps://staging3.recordcollectorsoftheworldunite.com/artist/021-2/\nWhat I'd like to do is create a new field, a dropdown menu, that tags their post. It will have 3 options:\n\n*\n\n*\"WANT TO BUY\"\n\n*\"WANT TO SELL\"\n\n*\"INFO\".\n\nI'd also like to add some fields, depending on which option they choose- if \"WANT TO BUY\", or \"WANT TO SELL\", I'd like to add a price field. If \"WANT TO SELL\", I'd like to add a \"condition of the item\" field.\nI'd like the value they choose to be able to be queried as well, so I can make a page that queries \"Latest items for sale\", etc.\nThis way users can interact with each other around the site. If you want to buy Madonna ticket stubs, dropdown the menu to \"WANT TO BUY\" and tell us what you're looking for. In the same way, you can do that for selling items, and sharing info about the page.\nI'm not married to comments_template(), it's just what I'm using now. Is it best to modify the template for comment form, or use another avenue to make this work?\nI'd prefer to do all this without a store/market plugin. They seem overcomplicated for what i'm looking for. However, if that's the best way to go, let me know and I'll look into that.\nThanks all!\n\nA: It will be a three step process.\n\n*\n\n*You can use comment_form_logged_in_after (for logged in users) and/or comment_form_after_fields (for non-logged in users) actions to add your custom fields.\n\n\n*Save the values as comment meta using update_comment_meta function hooked into comment_post action.\n\n\n*Get the values using get_comment_meta.\nEDIT: 25-05-2022\nTry this..\n/*\n * This will add the fields to the comment form\n*/\nfunction wpse406058_custom_comment_fields() {\n\n    echo '<p class=\"comment-form-wantto\">';\n    echo '<label for=\"wantto\">I Want To</label>';\n    echo '<select id=\"wantto\" name=\"wantto\" class=\"myclass\">';\n        echo '<option value=\"WANT TO BUY\">WANT TO BUY</option>';\n        echo '<option value=\"WANT TO SELL\">WANT TO SELL</option>';\n        echo '<option value=\"INFO\">INFO</option>';\n    echo '</select>';\n\n}\nadd_action( 'comment_form_logged_in_after', 'wpse406058_custom_comment_fields' );\nadd_action( 'comment_form_after_fields', 'wpse406058_custom_comment_fields' );\n\n/*\n * This will field value as comment meta\n*/\nfunction wpse406058_save_custom_field($comment_id) {\n\n    if ( isset($_POST['wantto']) && !empty($_POST['wantto']) ) {\n        $wantto = sanitize_text_field($_POST['wantto']);\n        update_comment_meta( $comment_id, 'wantto', $wantto );\n    }\n    \n}\nadd_action( 'comment_post', 'wpse406058_save_custom_field' );\n\nNow you can get the value using get_comment_meta( $comment_id, 'wantto', true );\nOne option to display the value would be filtering the comment text.\nfunction wpse406058_display_comment_meta( $comment_text ) {\n    \n    $wantto = get_comment_meta( get_comment_ID(), 'wantto', true );\n    \n    if ( isset($wantto) && !empty($wantto) ) {\n    \n        $wanttotext = '<p class=\"wantosec\">' . esc_html($wantto) . '</p>';\n        \n        $comment_text = $wanttotext . $comment_text;\n    }\n    \n    return $comment_text;\n\n}\nadd_filter( 'comment_text', 'wpse406058_display_comment_meta' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406058", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get rid of undefined variable in previous post image I am working on a website on WordPress and I have it set to where the bottom of the post will automatically link to a random previous post with a picture from that previous link but a notice keeps popping up on the bottom. It says there is something wrong with the previous post image url but the website sets this automatically and it works for all my other posts. Since it is undefined should I try to define it in the code and include the url and image url? There is an if statement beforehand that makes this code run if there is a previous post image url and this is using the Mia theme on WordPress\n previous_post_link( '%link', '<div class=\"post-navigation-image\"><img src=\"' . $previous_post_image_url . '\" /></div><div class=\"post-navigation-content\"><div class=\"post-navigation-title\"><span class=\"next-post\">Next Post &gt;</span><h3>%title</h3></div></div>' );\n    echo '</div>';\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406061", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Create membership number for existing/new users I have a membership site with 4000+ users currently on it.\nI am needing to give both new/existing users an automatic ID number.\nits very similar to this: Create Unique ID for user\nHowever, this only works for new users, I need it to work for the current users too. So for instance, user id 3421 would get membership number 3421.\nThis is what I have so far: (pretty much all from above link)\nfunction fb_add_custom_user_profile_fields( $user ) { ?>\n        <h3><?php _e('Extra Profile Information', 'Avada'); ?></h3>\n            <table class=\"form-table\">\n                <tr>\n                    <th>\n                        <label for=\"memnumber\"><?php _e('Membership Number', 'Avada'); ?>\n                        </label>\n                    </th>\n                    <td>\n                    <input type=\"text\" name=\"memnumber\" id=\"memnumber\" value=\"<?php echo esc_attr( get_the_author_meta( 'memnumber', $user->ID ) ); ?>\" class=\"regular-text\" /><br />\n                    </td>\n                </tr>\n            </table>\n        <?php }\n\n    function fb_save_custom_user_profile_fields( $user_id ) {\n        if ( !current_user_can( 'edit_user', $user_id ) )\n            return FALSE;\n        update_usermeta( $user_id, 'memnumber', $_POST['memnumber'] );\n    }\n    add_action( 'show_user_profile', 'fb_add_custom_user_profile_fields' );\n    add_action( 'edit_user_profile', 'fb_add_custom_user_profile_fields' );\n    add_action( 'personal_options_update', 'fb_save_custom_user_profile_fields' );\n    add_action( 'edit_user_profile_update', 'fb_save_custom_user_profile_fields' );\n\n\n\n\n    add_action( 'user_register', 'assignuserid');\n\n    function assignuserid($user_id) {\n    global $wpdb;\n    $latestid=$wpdb->get_var(\"SELECT meta_value from $wpdb->usermeta where meta_key='memnumber' order by meta_value DESC limit 1;\");\n    update_user_meta( $user_id, 'memnumber', $latestid +1 );\n}\n\nAny advice would be appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406067", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Include results with tags relevant to the search keyword with JSON rest API v2 Wordpress doesn't natively search for tags so I need to install WP Extended Search and add post_tags as one of its parameters so whenever I search for keywords natively, posts with that tag will appear.\nHowever, when I tried searching on the wp-json REST API, that post doesn't appear. Here's an example with a post that is tagged with \"technology\".\nWhen I search \"technology \" using this json rest api url, it returns an empty array:\nexample.com/posts?search=technology\nBut if I search natively using this url, the posts tagged with technology appears\nexample.com/wp-json/wp/posts?search=technology\nThe only way the posts will appear is when I put \"technology\" somewhere in the title or in the content but I don't want to put it in the content. How will my posts with tags appear in the results on the REST API when I search for that keyword?\n\nA: WP Extended Search does not work with REST by default since version 2.0.2 This is to achieve maximum compatibility with WordPress and other plugin/themes.\nTo enable the support, pass wpessid in REST request with ID (for specific search setting) or without ID (for global search setting).\ne.g. /wp-json/wp/v2/posts?search=technology&wpessid or /wp-json/wp/v2/posts?search=technology&wpessid=10\nRef: https://wordpress.org/support/topic/search-queries-with-metakey-name-issue-version-2-0-2/#post-14376988\nPS:- I am the author of this plugin. To keep things organized I suggest do not post plugin/theme support questions here. Use relevant support forum to ask plugin/theme related question.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406068", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get_the_terms() returning wrong results inside of loop When I use get_the_terms() inside a loop, the whole thing behaves very strangely. Sometimes the terms are included twice or three times and sometimes a post inside of the loop returns only false.\nI have used get_the_terms() over and over for the last few years without any problems. So i'm quite confused right now.\nIt seems like wp_get_post_terms() and wp_get_post_categories() are getting out the correct data but I would like to know why get_the_terms() is behaving this way inside of a loop.\nCan someone explain that to me?\n\nEdit:\nHere is my code for the category badges.\nBtw: I'm using sage from roots.io so i'm working with blade templates. It happens on custom queries and default main queries (like: index.php, archive.php etc.)\nindex.blade.php\n@if (have_posts())\n\n    @while(have_posts()) @php(the_post())\n\n        @includeFirst(['partials.content-' . get_post_type(), 'partials.content'])\n\n    @endwhile\n\n@endif\n\n\npartials/content.blade.php\n@php\n\n    $post_id = get_the_ID();\n    $terms = get_the_terms( $post_id, 'category' );\n\n@endphp\n\n@if($terms && ! is_wp_error( $terms ))\n    <div class=\"badges\">\n        @foreach($terms as $term)\n            <span class=\"badge\">{!! $term->name !!}</span>\n        @endforeach\n    </div>\n@endif\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406070", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress navigation wont appear with wp_head so im building a custom theme and ive got stuck on the navigation\nif i use wp_head(); it loads bootstrap and my custom style sheet but not the navigation\nif i use get_header(); it loads the navigation but not bootstrap or my custom style sheet\nhere is my functions.php\nfunction register_navwalker(){\n    require_once get_template_directory() . '/inc/class-wp-bootstrap-navwalker.php';\n}\nadd_action( 'after_setup_theme', 'register_navwalker' );\n\nfunction wpbootstrap_enqueue_styles() {\n    wp_enqueue_style( 'bootstrap', 'https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css' );\n    wp_enqueue_style( 'my-style', get_template_directory_uri() . '/style.css');\n    wp_enqueue_script('bootstrap-js', 'https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js', array('jquery'), NULL, true);\n}\nadd_action('wp_enqueue_scripts', 'wpbootstrap_enqueue_styles');\n\nregister_nav_menus(\n    array(\n        'main_menu'=>'Main Menu',\n    )\n);\n\nhere is my navigation code in header.php\n<nav class=\"navbar navbar-expand-md navbar-light bg-light\" role=\"navigation\">\n    <div class=\"container\">\n        <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#bs-example-navbar-collapse-1\" aria-controls=\"bs-example-navbar-collapse-1\" aria-expanded=\"false\" aria-label=\"<?php esc_attr_e( 'Toggle navigation', 'your-theme-slug' ); ?>\">\n        <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <a class=\"navbar-brand\" href=\"#\">Navbar</a>\n            <?php\n            wp_nav_menu( array(\n                'theme_location'    => 'main_menu',\n                'depth'             => 2,\n                'container'         => 'div',\n                'container_class'   => 'collapse navbar-collapse',\n                'container_id'      => 'bs-example-navbar-collapse-1',\n                'menu_class'        => 'nav navbar-nav',\n                'fallback_cb'       => 'WP_Bootstrap_Navwalker::fallback',\n                'walker'            => new WP_Bootstrap_Navwalker(),\n            ) );\n            ?>\n    </div>\n\n\nA: You have to call both wp_head and get_header.\nIn your header.php, place a call to wp_head(); inside the <head> tag, then use get_header() inside your templates.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406071", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to obtain \"wp_rest\" nonce for WP Statistics plugin manually? During my pentest of a client's websites I stumbled upon the WP with vulnerable WP Statistics plugin installed.\nTo exploit this vulnerability, I should send a JSON-API request to endpoint /json-api/wp-statistics/v2/.... The problem is I must send correct _wpnonce along with my request.\nI found a cool explanation here:\nhttps://gist.github.com/Xib3rR4dAr/5dbd58b7f57a5037fe461fba8e696042\nThey recommend to extract the _wpnonce value from the legitimate URLs from the website page source. But I don't see similar URLs anywhere. My guess is that the plugin installed but not correctly used so it doesn't create these links within the pages.\nAs I understand, this plugin uses wp_rest action for nonce and it means that the nonce used is global for the whole JSON REST API. Am I correct here? And if yes, how can I obtain this nonce value manually?\n\nA: \nAs I understand, this plugin uses wp_rest action for nonce and it means that the nonce used is global for the whole JSON REST API. Am I correct here?\n\nYes, it's not the plugin that needs the nonce, it's WordPress itself, and it needs other things too such as cookies from an active login session, and for it to be from a user with the needed role/capabilities.\n\nAnd if yes, how can I obtain this nonce value manually?\n\nYou can't, WP gives it to you, and the nonces are unique to each person. Generating it locally would require that you have the secret key hashes from the wp-config.php file.\nSo you can't steal someone elses nonce, you can't generate it locally.\nBut even if you could, it only helps identify and authenticate that you are a specific user, it won't give you permissions to do things your user can't already do.\nIf You're Already Logged In\nhttps://developer.wordpress.org/rest-api/using-the-rest-api/authentication/\nIf WP itself is localising the nonce then it's available as:\nwpApiSettings.nonce\n\nNote that all the caveats I've mentioned still apply.\n\nHaving said that, I don't think you should be asking how to exploit a WP site here. It should be enough to report to the client that they're running vulnerable software.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406074", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Count posts per taxonomy else change taxonomy if less than x number $taxonomy = $tag->count > 3 ? 'post_tag' : 'category';\n\n$cats_or_tags = $tag->count > 3 ? $tag_ids : $cat_ids;\n\n$args = array(\n    'tax_query' => array(\n     array(\n    'taxonomy'     => $taxonomy,\n    'field'        => 'id',\n    'terms'        => $cats_or_tags\n\nThe first part of this ternary works when checking the count of posts in a specific tag but the 2nd part doesn't.\nIt's supposed to set the taxonomy and terms values if there's more than 3 posts tagged otherwise when less than 4, display posts from categories instead of tags.\n\nA: I'm guessing you are using a tax_query here.\nIf you try to query multiple categories or taxonomies, the terms field expects an array\n$args = array(\n    // other query arguments\n    'tax_query' => array(\n        array(\n            'taxonomy' => $taxonomy,\n            'field'    => 'id',\n            'terms'    => array($cats_or_tags),\n        ),\n    ),\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406078", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I don't think WordPress is loading jquery or bootstrap js I'm building a WordPress theme and I've used the code from https://codeinhouse.com/how-to-create-custom-post-type-slider-in-wordpress-without-plugin/ to build my slider I've also used https://github.com/wp-bootstrap/wp-bootstrap-navwalker I have both jquery and bootstrap both linked to the site they appear in inspect element however they do not seem to be running as my drop down navigation does not work on mobile size and the slider doesn't slide \nfunction wpbootstrap_enqueue_styles() {\n    wp_enqueue_style( 'bootstrap', get_template_directory_uri() . '/css/bootstrap.css' );\n    wp_enqueue_style( 'my-style', get_template_directory_uri() . '/css/style.css');\n    wp_enqueue_script('bootstrap-js', get_template_directory_uri() . '/js/bootstrap.js', array('jquery'), NULL, true);\n    wp_enqueue_script('jquery-js', get_template_directory_uri() . '/js/jquery.js', array('jquery'), NULL, true);\n}\nadd_action('wp_enqueue_scripts', 'wpbootstrap_enqueue_styles');\n\n\nA: WordPress is loading jQuery as default.\nYou basicly telling WordPress to load your jquery-js after the jquery script from WordPress.\nThe Nav_Walker class you are using is related to Bootstrap Version 3.\nWhich Version of Bootstrap are you loading? Without knowing your code, I think I'm guessing that the Boostrap version does not cope with the current markup.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406082", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress stopped generating image thumbnails after changing hosting environment I moved my WP website from shared hosting, to Digital Ocean LEMP stack droplet. I noticed that thumbnails aren't generated any more for new post featured images, I also tried manually  regenarating thumbnails for specific images, it succeeds but nothing generated.\nI tried deactivation of the Force Regenerate Thumbnails plugin and activating it again, but still no luck.\nAny ideas?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406089", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to set up hierarchical relationships without using plugins / meta query I'm running a large database of musical artists and their releases. I inherited the site after it running for a long time. There are currently several different custom post types, created with a Toolset plugin.\nThe post types are hierarchical like this\nArtists | Directors |\nReleases |\nAlbums | Singles | Videos | Misc |\nArtists and Directors are parent to\nReleases, which is a parent to the Version\nAlbums | Singles | Videos | Misc | are the four version types we have.\nIn order to display all this information, I have been using queries that look like this.\n<?php \n$album_args = array(\n   'post_per_page' => -1,\n   'meta_query' => array(\n      array(\n        'key' => 'wpcf-release-type',\n        'value' => 'album',\n      ),    \n    ),\n);\n$album_posts = types_child_posts('release', $album_args);?>\n<div class=\"row row-cols-1   justify-content-center\">\n    <?php foreach ($album_posts as $child_post)  {      ?>\n        <div class=\"col py-1\">\n        <?php include get_template_directory() . '/includes/containers/artist-page-container.php' ;?>\n        </div>\n    <?php } ?>\n\nI cannot find any information on types_child_posts. I know it's from Toolset plugin. I believe I'm learning that this system I'm using is slowing down my pages. An artist like Madonna has so many releases, the page times out.\nThere are some exceptions to the artist area of tis rule- but I'll tackle that later. Let's say for now that\nAn artist has a one->many relationship with releases.\nReleases ALWAYS have a one->many relationship with versions.\nA version is ALWAYS a child of a release.\nWhat is a better way (is there one?) than using this plugin to set up a hierarchical relationship so I don't have to use types_child_posts or Meta_queries?\nThanks\n\n\nA: You should use taxonomies to store your relationships.\nSidenote: A possible answer was to make the releases children of the artists using the classic post_parent field, however a post can only have 1 parent, and the need for a release to also have a director and other relationships eliminates this option.\nTaxonomies\nYou will want to create custom taxonomies for every relationship, focusing on the phrase:\nAn X can have Y's\nWhere X's are things and Y's are groups or things you would filter and search for.\nSo in this case:\n\n*\n\n*Releases can have an artist\n\n*\n\n*an artist taxonomy\n\n\n\n*releases can have a director\n\n*\n\n*a directory taxonomy\n\n\n\nYou will need to create a basic plugin that registers a taxonomy with these names.\nTo register a taxonomy, use register_taxonomy:\nhttps://developer.wordpress.org/reference/functions/register_taxonomy/\nMost people use a generator to get their initial code, e.g. I go to generatewp and fill out the form to get my starting code for a new taxonomy:\nhttps://generatewp.com/taxonomy/\nThe important thing here, is that we're going to use some naming trickery to tie the madonna artist term, to the madonna artist custom post type. So if I have a Lady Gaga artist post, and a release post named The Fame, then I will give \"The Fame\" the lady gaga artist term, because the Lady Gaga artist post has the slug lady gaga too and they match. When I want the artist I fetch the artist post with the same slug, and when I want the artists releases, I ask for all releases with an artist term of the same name.\nThe bonus of this is that the release posts can now have multiple artists, e.g. Lady Gagas duet album with Tony Bennet is no longer an issue for your database, and neither are compilation albums.\nSo let's create a custom taxonomy and call it something like artists ( make sure it's not the same as your post type ), then when we create our release we add a term named madonna, making sure it's identical to the artist posts name/slug.\nThen finally, if we are on the madonna artist posts template, and want to list her releases, we might do this:\n$releases = new WP_Query( [\n    'post_type' => 'release',\n    'artists' => 'madonna'\n] );\nif ( $releases->have_posts() ) {\n    while ( $releases->have_posts() ) {\n        $releases->the_post();\n        the_title(); // prints the release title\n        // etc..\n\nHere we've asked for all posts of type release that are in the artists taxonomy term named madonna. Of course you will want to fetch the slug of the current artist post so that you don't have to manually type this out for every single artist.\nAutomation filters\nOf course typing out madonna and every other artist name twice isn't fun, and what if Madonna changes her name? What if we create a directors taxonomy and they get married or it's revealed they were actually someone else writing under a false name?\nWell we can automate these things using hooks:\n\n*\n\n*when an artist post is saved, if the slug was changed, find the term with the same name and change its slug too\n\n*\n\n*if no term exists, create it\n\n\n\n// when an \"artist\" post is saved, update the artists term\nadd_action( 'save_post_artist', 'update_artist_term', 10, 3 );\nfunction update_artist_term( $post_ID, WP_Post $post, bool $update ) : void {\n    if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) {\n        return;\n    }\n    $term = get_term_by( 'slug', $post->post_name, 'artists' );\n    if ( empty( $term ) || is_wp_error( $term ) ) {\n        // create it!\n        wp_insert_term(\n            $post->post_title,\n            'artists',\n            [\n                'slug' => $post->post_name\n            ]\n        );\n    }\n}\n\nThis code is just an example that creates the term but it's untested and doesn't update the slug\nTemplates\nCurrently you're using PHP code to fetch and display the releases, but if you used taxonomies, WordPress gives you theme templates and archives for free.\nIf you register a taxonomy named artists, and used the madonna example, you'd find that a new post archive that shows releases tagged madonna now exists at example.com/artists/madonna, and that a theme template of taxonomy-artists.php will be used if available, or even taxonomy-artists-madonna.php if you felt Madonna needed special attention.\nDoing the reverse\nIf we're on a release, and we want to list the artists ( the benefit of this approach is a release can have many artists now ), we just need to fetch the names of the terms using wp_get_object_terms:\n$artists_terms = wp_get_object_terms( $post_id, 'artists' );\n\nThen we can grab their names:\n$artist_slugs = wp_list_pluck( $artists_terms, 'slug' );\n\nAnd do a query of the artist post type:\n$artists = new WP_Query( [\n    'post_type' => 'artist',\n    'post_name__in' => $artist_slugs,\n] );\nif ( $artists->have_posts() ) {\n    /// etc.. standard post loop that displays each artist like before\n\nThe Other Post Types\nYou can repeat this entire process for every other item. The most difficult part is migrating all that data over which will be frustrating.\nThe other thing to note:\n\n*\n\n*tax_query can let you do more complex queries on taxonomies, but taxonomies are not free, they're much cheaper and faster than meta_query but they aren't instant\n\n*avoid NOT or not_in parameters at all costs, they're one of the slowest types of query you can do, even slower than meta_query, but not as slow as\n\n*'orderby' => 'RAND', will make your database copy the entire table with all your content into memory, randomly order it, then run the original query you wanted. It's the most expensive, slowest thing you can do, and also the most unnecessary. If you want a random thing just do the random part in PHP. E.g. pick a random date and ask for the first 5 things after that date, much cheaper/faster.\n\n\nAnything you're using to filter that's just a custom field such as release type, or genre, can just be a plain standard custom taxonomy, and this is where you should focus your initial efforts. It's the easiest way to make the biggest improvement.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406090", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why aren't these WordPress options being saved to the database correctly? I have a plugin for editing certain options already stored in the database.  It creates an options page under Settings with a simple form that populates each field with whatever values are stored in the database for the given field.\nWhen the page loads, each of the options loaded into the fields are correct, but if I edit any of the fields and click \"Save changes\", all of the fields on the page are cleared out, in addition to deleting their corresponding values from the database.  Why is this?\n<?php\n/** Plugin name: Client OAuth/REST Configuration\n * Plugin URI: uri\n * Description: description\n * Author: author\n * Author URI: author uri\n * Version: 0.02\n */  \n\n\nfunction register_myplugin_options_settings(){\n    register_setting('myplugin_options_group', 'api_username');\n    register_setting('myplugin_options_group', 'api_password');\n    register_setting('myplugin_options_group', 'client_id');\n    register_setting('myplugin_options_group', 'client_secret');\n    register_setting('myplugin_options_group', 'auth_url');\n    register_setting('myplugin_options_group', 'token_url');\n    register_setting('myplugin_options_group', 'rest_url');\n    register_setting('myplugin_options_group', 'callback_url');\n}\nadd_action( 'admin_init', 'register_myplugin_options_settings' );\n\n\nfunction register_myplugin_options_options_page() {\n    add_options_page('Client OAuth REST Configuration', 'Settings', 'manage_options', 'myplugin', 'myplugin_options_page');\n}\nadd_action('admin_menu', 'register_myplugin_options_options_page');\n\n\nfunction myplugin_options_page() {\n?>\n    <div>\n    <?php screen_icon(); ?>\n    <h2>Oauth/REST Config Setting</h2>\n        <form method=\"post\" action=\"options.php\">\n        <?php settings_fields( 'myplugin_options_group' ); ?>\n        <p>To store the Client Oauth and REST configuration settings in order to access the REST API.</p>\n        <table>\n            <tr valign=\"top\">\n            <th scope=\"row\"><label for=\"myplugin_api_username\">API Login Username</label></th>\n            <td><input type=\"text\" id=\"myplugin_api_username\" name=\"myplugin_api_username\" style=\"width: 145px\" value=\"<?php echo get_option('api_username'); ?>\" /></td>\n        </tr>\n\n        <tr valign=\"top\">\n            <th scope=\"row\"><label for=\"myplugin_api_password\">API Login Password</label></th>\n            <td><input type=\"password\" id=\"myplugin_api_password\" name=\"myplugin_api_password\" style=\"width: 145px\" value=\"<?php echo get_option('api_password'); ?>\" /></td>\n        </tr>\n\n        <tr valign=\"top\">\n            <th scope=\"row\"><label for=\"myplugin_client_id\">OAuth Client ID</label></th>\n            <td><input type=\"text\" id=\"myplugin_client_id\" name=\"myplugin_client_id\" style=\"width: 300px\" value=\"<?php echo get_option('client_id'); ?>\" /></td>\n        </tr>\n\n        <tr valign=\"top\">\n            <th scope=\"row\"><label for=\"myplugin_client_secret\">OAuth Client Secret</label></th>\n            <td><input type=\"password\" id=\"myplugin_client_secret\" name=\"myplugin_client_secret\" style=\"width: 145px\" value=\"<?php echo get_option('client_secret'); ?>\" /></td>\n        </tr>\n\n        <tr valign=\"top\">\n            <th scope=\"row\"><label for=\"myplugin_auth_url\">Login URL</label></th>\n            <td><input type=\"text\" id=\"myplugin_auth_url\" name=\"myplugin_auth_url\" style=\"width: 375px\" value=\"<?php echo get_option('auth_url'); ?>\" /></td>\n        </tr>\n  \n        <tr valign=\"top\">\n            <th scope=\"row\"><label for=\"myplugin_token_url\">OAuth Token URL</label></th>\n            <td><input type=\"text\" id=\"myplugin_token_url\" name=\"myplugin_token_url\" style=\"width: 375px\" value=\"<?php echo get_option('token_url'); ?>\" /></td>\n        </tr>\n\n        <tr valign=\"top\">\n            <th scope=\"row\"><label for=\"myplugin_rest_url\">REST URL</label></th>\n            <td><input type=\"text\" id=\"myplugin_rest_url\" name=\"myplugin_rest_url\" style=\"width: 375px\" value=\"<?php echo get_option('rest_url'); ?>\" /></td>\n        </tr>\n\n        <tr valign=\"top\">\n          <th scope=\"row\"><label for=\"myplugin_callback_url\">Callback URL</label></th>\n          <td><input type=\"text\" id=\"myplugin_callback_url\" name=\"myplugin_callback_url\" style=\"width: 495px\" value=\"<?php echo get_option('callback_url'); ?>\" /></td>\n        </tr>\n        </table>\n        <?php  submit_button(); ?>\n    </form>\n</div>\n<?php\n}?>\n\n\nA: The options are not being saved correctly because you used the wrong input name \u2014 it should match the second parameter for register_setting(). So for example, with register_setting('myplugin_options_group', 'api_username'), the input name should be api_username, but then you used myplugin_api_username.\nAdditionally, it should be noted that screen_icon() has long been deprecated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406096", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why is $wp->request empty in Wordpress 6.0? Trying to obtain the page url with the following code prior to Wordpress 6.0 works, but after update to Wordpress 6.0, $wp->request is coming through as an empty string on all pages.  I have Post name set in permalinks under Common Settings if that matters.\nThe code below no longer works for getting the current url in the browser:\nadd_query_arg($wp->query_vars, $wp->request);\n\nIf there a new way to obtain the current url in the browser with Wordpress 6.0?  I would need to obtain it as early as possible.  The code above worked as is directly within the functions.php file without any hooks.  Is there something similar to this in Wordpress 6.0?\nEDIT:  Tested with a Fresh install of Wordpress 6.0\nThis is also happening after installing a Fresh copy of Wordpress 6.0 in the twentytwentytwo theme functions.php file (placed the following at the top of the file):\nglobal $wp;\n\n$current_url = add_query_arg($wp->query_vars, $wp->request);\n\nerror_log(var_export($current_url, true));\nerror_log(var_export($wp->request, true));\n\nLook at wp-content/debug.log and see that both are empty strings no matter what url you go to on the site, or what your permalink settings are set to.  Obviously, you will need to enable the debug log in wp-config.php first.\nWhat is the correct way in Wordpress to obtain the current page url?\n\nA: \nWhat is the correct way in Wordpress to obtain the current page url?\n\nYou don't, WP has never provided a way to do this, the closest is get_permalink which provides the canonical URL of the current post.\nWhat you've been using is unofficial, and never gave you the actual URL as it only appended the whitelisted query variables that WP_Query accepts.\nInstead, WordPress is just a CMS built in PHP, and PHP has a solution. You can use $_SERVER['REQUEST_URI'] to get the full URL, instead, then parse out only the parts you want.\nE.g.\n$url =  \"//{$_SERVER['HTTP_HOST']}{$_SERVER['REQUEST_URI']}\";\n$path = parse_url( $url, PHP_URL_PATH );\nadd_query_arg( $wp->query_vars, $path );\n\nhttps://www.php.net/manual/en/function.parse-url.php\n\nAdditionally, you might have do_parse_request filters that return false or an equivalent value, or most likely they return nothing at all ( aka null ), causing WP to bypass this. The cause of this is a change in WordPress 6.0 that was announced in April:\nhttps://make.wordpress.org/core/2022/04/27/changes-to-do_parse_request-filter-in-wordpress-6-0/\nHowever this is unlikely to be the cause of your issue.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406097", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to cache the results of a query and display the cached results I have a website centered around music. I have 3 main post types- 'Artist', 'Release', and 'Version'. There are 4 types of 'Version'- album, single, video, misc.\nArtist is parent of Release. (artist has a single -> many relationship with releases)\nRelease is a parent of Version. (Release has a single-> many relationship with version)\nI've established these relationships in the plugin toolset types.\nIn my single-artist page, I have releases displayed in sections. Here's an example of the code to display all albums by an artist.\n<?php \n$album_args = array(\n    'post_per_page' => -1,\n    'tax_query' => array(\n        array(\n            'taxonomy' => 'release-format',\n                        'field' => 'slug',\n            'terms' => 'album',\n            \n        ),  \n    ),\n);\n\n$album_posts = types_child_posts('release', $album_args); \n//This shows only releases belonging to the post_type 'artist' on this page.\n\n// sort alphabetically by firstname and lastname\nusort($album_posts, 'compare_fullname');\n    $url = esc_url( home_url() );\n?>\n<div class=\"row row-cols-1   justify-content-center\">\n    <?php foreach ($album_posts as $child_post)  {      ?>\n    \n    <div class=\"col py-1\">\n        <?php include get_template_directory() . '/includes/containers/artist-page-container.php' ;?>\n        <?php \n        $versionID= $child_post->ID; // this is the album ID\n        $version_count = array(\n            'post_type' => 'album',\n            'post_per_page' => -1,\n            'meta_query' => array(\n                array(\n                    'key' => '_wpcf_belongs_release_id',\n                    'value' => $versionID,\n                )\n            ),\n        );\n//this $version_counter shows all the 'albums' that are children of the 'release'\n    $version_counter = types_child_posts('release', $version_count);\n        \n    $count=0;\n    foreach ($version_counter as $counter_child_post  )  {    \n        $count++;\n    } \n    if ($count==1){\n        echo \"$count version\";\n    }else{\n        echo \"$count versions\";\n    }\n                                \n    ?>\n</div>\n<?php } ?>\n\nSo... In the foreach loop, while it is going through a release- it takes a new dive into all the child posts of this release.\nThis count is VERY slow, when I add this count into each section, it can take 15 seconds or more for a big artist page to load.\nThe amount of versions doesn't change until I upload a new version (not often).\nIs there a way to run this count BEFORE the user ever sees the page? How do I cache the results of this query and just show the user the cached result?\nThanks!\n\nA: A More Efficient Count\nWhen querying for a count without interest in the actual content of a post, WordPress provides a found_posts property on the query containing the total number of matches - so you needn't load every post from the database; you can query for a single post and still retrieve the total count. You can also specify the fields parameter to only return post IDs. Both measures can mitigate a lot of overhead in various scenarios - though it's worth noting that the latter will disable WordPress's internal object caching functionality for the query by default.\nI'm not familiar with the types_child_post() function or it's capabilities, but leveraging WordPress core the above would look as such:\n/**\n * Queries the database for the number of album-type posts associated with a\n * release-type post.\n * \n * @param int $release_id The post ID of a release-type post.\n * @return int The number of albums associated with the release.\n */\nfunction count_album_versions( $release_id ) {\n  $album_versions_query = new WP_Query(\n    [\n      'posts_per_page' => 1,\n      'post_type'      => 'album',\n      'meta_query'     => [\n        [\n          'key'   => '_wpcf_belongs_release_id',\n          'value' => $release_id,\n        ],\n      ],\n    ]\n  );\n\n  return $album_versions_query->found_posts;\n}\n\nWithin your template your count display code would be simplified to:\n<?php foreach ($album_posts as $child_post)  { ?>    \n    <div class=\"col py-1\">\n        <?php include get_template_directory() . '/includes/containers/artist-page-container.php' ;?>\n        <?php\n          $count = count_album_versions( $child_post->ID );\n\n          if ( $count == 1 ){\n            echo \"$count version\";\n          } else {\n            echo \"$count versions\";\n          }\n        ?>\n    </div>\n<?php } ?>\n\n\nBreaking Down a Costly Operation\nThe above alone may be able to achieve your desired performance threshold, but to answer the question more directly, while you could periodically run a task to perform a costly operation and cache the result in a transient or post meta-data (either via WP-Cron or a cronjob), an even more efficient approach in some situations is to just maintain the value whenever it changes. In this case, that would mean storing the number of versions an album has in post meta on the release post, then updating it whenever a version is added or removed.\nIdeally you'd prime the cached values for all relevant posts beforehand, but for convenience and redundancy you can also just perform the costly operation as-necessary - when something tries to retrieve or update the cached value and it's missing.\n/**\n * Retrieves the number of albums associated with a release from a release's\n * post meta-data. Calls on count_album_versions() to query the database\n * and set the count on the release's post meta-data if it is missing.\n *\n * @param int $release_id The post ID of a release-type post.\n * @return int The number of album-type posts associated with the release.\n */\nfunction get_album_version_count( $release_id ) {\n  $count = get_post_meta( $release_id, 'album_version_count', true );\n\n  // If the count in post-meta is 0 or otherwise a set value, return it.\n  if( $count === 0 || !empty( $count ) )\n    return $count;\n\n  // Otherwise, query the database to retrieve the count and update post-meta.\n  $count = count_album_versions( $release_id );\n  update_post_meta( $release_id, 'album_version_count', $count );\n\n  return $count;\n}\n\n/**\n * Modify the album count stored in a release-type post's meta-data by a relative\n * value.\n * \n * @param int $release_id The post ID of a release-type post.\n * @param int $increment Optional. The value to change the count by. Default 1.\n * @return bool True on success, false on failure or no change to the value.\n */\nfunction increment_album_version_count( $release_id, $increment = 1 ) {\n  // Retrieve the current count from post-meta (/run the query to calc it).\n  $count = get_album_version_count( $release_id );\n\n  // Update the value in post-meta by the specified amount.\n  return update_post_meta( $release_id, 'album_version_count', $count + $increment );\n}\n\n/**\n * Handles updating release-type posts' associated album counts when an album-type post changes post status.\n *\n * @param $new_status string The new status of the transitioning post.\n * @param $old_status string The previous status of the transitioning post.\n * @param WP_Post The WP_Post object for the transitioning post.\n */\nfunction update_album_version_count( $new_status, $old_status, $post ) {\n  // If the hook fired for a non-album-type post or the status of the post did\n  // not change, bail early.\n  if( $post->post_type !== 'album' || $new_status === $old_status )\n    return;\n\n  $release_id = get_post_meta( $post->ID, '_wpcf_belongs_release_id', true );\n  if( empty( $release_id ) ) // Bail if this album is not associated with a release.\n    return;\n\n  // If the album transitioned from 'draft' or 'trash' to 'publish', increase\n  // the associated release's album count by 1.\n  if( $new_status === 'publish' && in_array( $old_status, [ 'draft', 'trash' ] ) )\n    increment_album_version_count( $release_id );\n\n  // If the album transitioned from 'publish' to 'draft' or 'trash', decrease\n  // the associated release's album count by 1.\n  if( $old_status === 'publish' && in_array( $new_status, [ 'draft', 'trash' ] ) )\n    increment_album_version_count( $release_id, -1 );\n}\n\nadd_action( 'transition_post_status', 'update_album_version_count', 10, 3 );\n\nI've made some assumptions above - namely that an album actually exists in another status prior to being published and that it will already have the '_wpcf_belongs_release_id' meta-value attached at the time that the status is updated - but the mechanism can be adapted to other scenarios if that is not the case (perhaps by using a wp_after_insert_post hook, for instance).\nAll of the above in place, you have a vastly more efficient counting operation and a get_album_version_count() function to retrieve the count which will only execute the counting operation if absolutely necessary. Outside of that, all of the overhead from the counting operation is broken down into tiny amounts of work performed when an album transitions between 'trash'/'draft' to or from 'publish' status.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406098", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to automatically create a terms based on each post of a post type I am working on a music site which has custom post types- artists, and releases. I have about 3,000 artists, and about 19,000 releases in my database. I'd like to create a new taxonomy term for each of these post types.\nI have created a taxonomy called artists. I'd like to have each post of post_type -> 'artist' become a term in the taxonomy, automatically.\nI'd then like to do the same with releases.\nAnyone have any ideas?\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406102", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Stripping unicode characters out of slug I am trying to strip the following characters out of slugs: \u1e41, \u1e6d, \u1e0d, \u1e47, \u1e45, \u00f1, \u1e37, \u1e43.\nI found this code here (note: I have removed public in order to get it to work)\nadd_action('wp_insert_post_data', __NAMESPACE__ . 'processPermalink');\n/**\n * Processes the permalink so we can remove any characters that may cause a problem when communicating\n * with the API.\n *\n * @param  array $data The array of information about the post.\n * @return array $data The data without the malformed information in the post name for the URL.\n */\nfunction processPermalink($data)\n{\n    if (!in_array($data['post_status'], array('draft', 'pending', 'auto-draft'))) {\n        $data['post_name'] =\n            preg_replace(\n                '/(%ef%b8%8f|\u2122|\u00ae|\u00a9|&trade;|&reg;|&copy;|&#8482;|&#174;|&#169;)/',\n                '',\n                $data['post_name']\n            );\n    }\n    return $data;\n}\n\nI have tried replacing the preg_replace in these three ways, but none of them work (the original code does what it shoudl):\n'/(&#8424;&#8424;&#8424;&#7745;|&#7789;|&#7693;|&#7751;|&#7749;|&#241;|&#7735;|&#7747;)/'\n\n'/(&#x1E41;|&#x1E6D;|&#x1E0D;|&#x1E47;|&#x1E45;|&ntilde;|&#x1E37;|&#x1E43;)/'\n\n'/(\u1e41|\u1e6d|\u1e0d|\u1e47|\u1e45|\u00f1|\u1e37|\u1e43)/'\n\nNone of them successfully strip out the characters.\nEDIT: I don't actually have to accomplish my goal using the above code. I'd be happy to do it some other way, including substituting the bad characters with their non-accented versions.\nAny ideas? Thanks!\n\nA: '/(\u1e41|\u1e6d|\u1e0d|\u1e47|\u1e45|\u00f1|\u1e37|\u1e43)/' is a valid regex to process what you want.\n$string = '/(\u1e41|\u1e6d|\u1e0d|\u1e47|\u1e45|\u00f1|\u1e37|\u1e43)/ is my regex and my chosen string is: \u1e41, \u1e6d, \u1e0d, \u1e47, \u1e45, \u00f1, \u1e37, \u1e43';\n\n\necho preg_replace(\n    '/(\u1e41|\u1e6d|\u1e0d|\u1e47|\u1e45|\u00f1|\u1e37|\u1e43)/',\n    '',\n    $string,\n);\n\n// Returns '/(|||||||)/ is my regex and my chosen string is: , , , , , , , '\n\nEDIT: So the issue is that the slug had already been urlencoded at this point.\nTry this\nadd_filter( 'wp_insert_post_data', 'wpse_406105_process_permalink', 10, 1 );\n/**\n * Processes the permalink so we can remove any characters that may cause a problem when communicating\n * with the API.\n *\n * @param  array $data The array of information about the post.\n * @return array $data The data without the malformed information in the post name for the URL.\n */\nfunction wpse_406105_process_permalink( $data ) {\n    if ( ! in_array( $data['post_status'], array( 'draft', 'pending', 'auto-draft' ) ) ) {\n        $data['post_name'] =\n            preg_replace(\n                '/(%E1%B9%81|%E1%B9%AD|%E1%B8%8D|%E1%B9%87|%E1%B9%85|%C3%B1|%E1%B8%B7|%E1%B9%83)/i',\n\n                '',\n                $data['post_name']\n            );\n    }\n    return $data;\n}\n\nYou don't want a namespace there, you have converted it to make it a procedural function. It's a good idea to make procedural functions fairly uniquely named to avoid conflicts so I have also changed the function from processPermalink().\nIt's also worth noting that these do not function until you have published the post - drafts, auto drafts and pending posts are skipped.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406105", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Blog post is redirecting to home page It wasn't doing this before, and I'm not sure what has caused this to change.\nI have tried:\n\n*\n\n*clearing cache\n\n*changing permalink structure, saving, and setting back again\n\n*unpublishing and republishing\n\nSo far nothing has worked. The blog post shows up on the /blog page, however when I click on the 'read more' link, it redirects to the home page. If I try navigating directly, it will also navigate to the home page.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406107", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to change the author box selection on a post to a custom taxonomy So instead of the author section pulling in 'Users', I need to change it so that the author box displays a selection of the terms from a custom taxonomy I have made.\nIs this possible to change?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406111", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Customize menu link for taxonomy in WP menu I have a Taxonomy that I would like to change the link to in the WP menu. When clicking it goes to the Add Taxonomy page, like normal. What I would like to do is navigate to the Edit Page.\nIn other words, the taxonomy navigates to edit-tags.php (as expected)\n\n/wp-admin/edit-tags.php?taxonomy=news_archive_options&post_type=news\n\nWhat I'd like to do is navigate to the term.php page\n\n/wp-admin/term.php?taxonomy=news_archive_options&tag_ID=10&post_type=news\n\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406112", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there a way to add the list of recent posts into the admin sub menu on hover? If I need to edit a specific post then I need to click the \"All Posts\" link and then find it. It would be nice to click directly on a link from within the popup hover sub menu.\nSomething like this:\n\nDisclaimer: I am going to answer my own question.\n\nA: Yes you can. By hooking into the admin_menu hook you can add sub menu pages, and they will appear\non hover by default. All you have to do is iterate the recent posts and add them one by one.\nadd_action('admin_menu', function () {\n    $args = array(\n        'post_type' => 'post',\n        'post_status' => 'publish',\n        'orderby' => 'post_date',\n        'sort_column' => 'post_date',\n        'sort_order' => 'asc',\n        'posts_per_page' => 10,\n    );\n    $arr = get_posts($args);\n    foreach ($arr as $item) {\n        add_submenu_page(\n            'edit.php',\n            $item->post_name,\n            '\u2022 ' . $item->post_title,\n            'read',\n            'post.php?post=' . $item->ID . '&action=edit',\n            ''\n        );\n    }\n});\n\nUpdate:\nI wrote a plugin for this. It also shows pages and custom post types. Hope that helps.\n\nA: Yes!\nOn the admin menu hook, grab all the post types using get_post_types, then for each type, do a query for posts of that type, and call add_submenu_page with their edit URLs to put them in the menu.\nHere's a more comprehensive alternative to IT Goldmans answer with the following additions:\n\n*\n\n*fixes a performance and caching issue that stopped it working with caching plugins and plugin filters\n\n*works for all post types\n\n*adds a separator and puts them at the end\n\n*edit icons!\n\n*handles posts with no title\n\n*respects the posts_per_page setting and default ordering\n\n*doesn't break custom edit links\n\n\nTo use, copy paste to a new PHP file in the plugins folder:\n<?php\n/**\n * Plugin Name: Basic admin post submenus\n * Plugin Author: Tom J Nowell\n */\n\n// https://wordpress.stackexchange.com/questions/406113/is-there-a-way-to-add-the-list-of-recent-posts-into-the-admin-sub-menu-on-hover\n\n\nadd_action(\n    'admin_menu',\n    function () : void {\n        $types = get_post_types( [\n            'public' => true,\n        ] );\n\n        foreach( $types as $type ) {\n            $parent_url = add_query_arg(\n                [\n                    'post_type' => $type === 'post' ? null : $type\n                ],\n                'edit.php'\n            );\n\n            $args = [\n                'post_type'        => $type,\n                'post_status'      => 'publish',\n                'suppress_filters' => false,\n            ];\n            $posts = get_posts( $args );\n            if ( empty( $posts ) ) {\n                continue;\n            }\n\n            add_submenu_page(\n                $parent_url,\n                'wp-menu-separator',\n                '',\n                'read',\n                '',\n                '',\n                11\n            );\n\n            foreach ( $posts as $post ) {\n                $title = ! empty( $post->post_title ) ? $post->post_title : '<em>' . __( 'Untitled' ) . '</em>'\n                add_submenu_page(\n                    $parent_url,\n                    $post->post_name,\n                    $title . '<span class=\"dashicons dashicons-edit\"></span> ',\n                    'read',\n                    get_edit_post_link( $post->ID ),\n                    '',\n                    11\n                );\n            }\n        }\n    }\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406113", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change Text in Admin Panel How can I change the text Posts to News ? I am developing a Plugin. I am working with Custom Post Types.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406120", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to shutdown wordpress login temporarily How can I disable wordpress login temporarily even for administrator users? is there any solution?\n\nA: You could hook into the wp_authenticate_user filter and return an error.\nSomething like:\nadd_filter( 'wp_authenticate_user', 'wpse_406123_stop_login', -1 );\n\nfunction wpse_406123_stop_login() {\n    $message = new WP_Error( 'login_disabled', __( '<strong>ERROR</strong>: You cannot login at this time' ) );\n    return $message;\n}\n\nYou can then change your security keys -the ones that look like this to something different - that will invalidate all current logins.\n\nA: Here's a way to halt the login by returning an error through the wp_authenticate_user filter:\nadd_filter( 'wp_authenticate_user', function() {\n    return new WP_Error( 'authentication_failed', esc_html__( 'Login disabled.', 'wpse' ) );\n} );\n\nso that you will get a notice about that after trying to login:\n\nBut it will be better if users don't have to login in the first place to get the message. We can add a message like:\nadd_filter( 'login_message', function( $message ) {\n     return sprintf ( \n         '<p class=\"message\">%s</p>', \n         esc_html__( ' Login is disabled!  \u26d4', 'wpse' ) \n     ) . $message;\n} );\n\nThat will show up as:\n\n... or maybe it's better to just hide the form in the first place with e.g.:\nadd_action( 'login_enqueue_scripts', function() {\n    wp_add_inline_style( \n        'login', \n        ' body.login #loginform, \n          body.login #nav,\n          body.login .language-switcher {\n             display:none;\n          }' \n    );\n} );\n\nin addition to the above steps.\nThat will give us:\n\nWe note that to remove the sessions for the current user there's the wp_destroy_all_sessions() function if needed.\n\nA: Wow - lots of great solutions offered....silly me, I just remove the wp-login.php file from the server, and - if as Tom Nowell asks - any currently logged-in users need to be booted out, I change the salt keys in wp-config.php.\nIf you want to be more polite, you could swap the wp-login.php file for one that has just a nice message instead of the login form.\nNo coding necessary, although this is definitely the lazier solution!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406123", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is it possible to get a list of options for a specific options group? When registering options in WordPress, you are required to supply a \"settings group name\" along with the name of the option itself.\n\nregister_setting( string $option_group, string $option_name, array\n$args = array() )\n\nGiven,\nregister_setting($my_settings_group, $my_option_name1);\nregister_setting($my_settings_group, $my_option_name2);\nregister_setting($my_settings_group, $my_option_name3);\n\nIs it possible to then get a list of all options for the specified custom settings group?\nFor example, something appropriate to the pseudocode...\nget_settings_group_options($my_settings_group);\n\nwhich would return either an array of option names, or option names and corresponding option values.\n\narray(\n    'my_option_name1 => 'option_value1', \n    'my_option_name2 => 'option_value2', \n    'my_option_name3 => 'option_value3',\n)\n\n\nIf not, then whats point of specifying the settings group name in the first place?\n\nA: Because the group is not the same as a category or taxonomy. It's used to determine where that settings UI control is displayed in the WP Admin area.\ne.g. the value general is for the general settings admin screen, not because it's a general options group.\nUntil the introduction of the settings endpoint and the REST API, the primary purpose of this function was to let WordPress know about an option so that it would know to save that option, and as a part of the settings GUI API.\nMost commonly it would be combined with a call to add_settings_field, this would tell WP that to add a field for a setting with a callback to display it, and which page it will appear on.\nThen, on that page, would be a do_settings_sections call that's given the page, e.g. 'general', and calls to do_settings_fields that would take a page and a section.\ne.g. adding a setting to the general settings page:\n// Registering the field\nfunction wpdocs_add_option_field_to_general_admin_page() {\n \n    register_setting( 'general', 'Field_Name_To_Add' );\n \n    add_settings_field( \n        'field_id-to-add', \n        'Field Name To Display', \n        'wpdocs_setting_callback_function', //Function to Call\n        'general', \n        'default', \n        array( \n            'id' => 'field_id-to-add', \n            'option_name' => 'Field_Name_To_Add'\n        )\n    );\n}\n \n// Adding options to registered field\nadd_action( 'admin_menu', 'wpdocs_add_option_field_to_general_admin_page' ); // CallBack Function\n \nfunction wpdocs_setting_callback_function( $val ) {\n    $id = $val['id'];\n    $option_name = $val['option_name'];\n    ?>\n    <input \n        type=\"tel\" //this can be any HTML input type: date, number, text etc.\n        name=\"<?php echo esc_attr( $option_name ) ?>\"\n        id=\"<?php echo esc_attr( $id ) ?>\"\n        value=\"<?php echo esc_attr( get_option( $option_name ) ) ?>\" // Displays the value stored in DB\n    /> \n    <?php\n}\n\nNote here that there is no \"group\" of options called general, and it only exists in certain circumstances ( you wouldn't add a settings control on the frontend, only in WP Admin ).\nSo this isn't something you can use to provide structure for options in the database.\nMore recently register_setting has been used to define default values for options, and as a way to expose options in the REST API.\n\nThe closest to what you were hoping for though, is get_registered_settings:\nhttps://developer.wordpress.org/reference/functions/get_registered_settings/\nThis will give you the main registered settings array. You would then need to loop through each setting, filtering out the ones that don't match your desired group.\nNote that this is not a way to get a list of all stored options, as not all options are registered, and it isn't commonplace in most plugins and themes yet. It also won't show transients etc for the same reason.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406128", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: The requested URL was not found only on localhost I have moved WordPress files & database from localhost to live server successfully. However, now when I try to move it back to localhost the links doesn't work, although they should.\nI am using root-relative links in my hrefs as in: href=\"/about-us\"\nI am using the plugin All in One WP Migration.\nHave tried the following:\n\n*\n\n*Multiple .wpress backup files from the plugin,\n\n*Reinstalled XAMPP,\n\n*Several different database names for local WP installation,\n\n*Severeal different usernames for local WP installation,\n\n*Several different theme names for local WP installation,\n\n*Matched database, username and theme name Exactly as live WP installation,\n\nAfter WP migration have tried:\n\n*\n\n*Selecting all the other permalink structures in addition to \"postname\",\n\n*Saving permalink structure twice after WP Migration,\n\n*Cleared cache with Google Inspector,\n\n*And maybe something more.\n\nAll the \"guides\" seem to use this plugin with \"ease\" and none really faces this issue or talks about it so it's quite confusing.\nNote: If I change from \"/about-us\" to \"about-us\" it works but I do not want it this way. Also I want to make this work with this specific plugin.\nThanks!\n//Edits below\nSeems to be an issue with Apache. When comparing .htaccess file content between live and localhost (after migrating site with plugin), this is the result:\nLive site .htaccess content:\n<IfModule mod_rewrite.c>\nRewriteEngine On\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\nRewriteBase /\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /index.php [L]\n</IfModule>\n\nLocal site .htaccess content:\n<IfModule mod_rewrite.c>\nRewriteEngine On\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\nRewriteBase /viktoria-cafe-konditori/\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule . /viktoria-cafe-konditori/index.php [L]\n</IfModule>\n\nI see that there are differences on the RewriteBase line and on the last RewriteRule line.\nI tried to copy all content from live .htaccess to local .htaccess - problem persists.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406129", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Custom quicktags not working after Wordpress 6.0 Custom quicktags not working after Wordpress 6.0\nwp 5.8.x/5.9.x: working --\nwp 6.0: not working\nButtons are not showing here: https://imgur.com/a/T05o0WX\nConsole error: Uncaught ReferenceError: QTags is not defined\nI am using this code.\n    function my_quicktags() {\n\n    if ( wp_script_is( 'quicktags' ) ) {\n    ?>\n    <script type=\"text/javascript\">\n    QTags.addButton( 'eg_php', 'PHP', '<pre><code class=\\\"language-php\\\">', '</code></pre>', 'p', 'PHP Code', 200 );\n    QTags.addButton( 'eg_css', 'CSS', '<pre><code class=\\\"language-css\\\">', '</code></pre>', 'q', 'CSS Code', 201 );\n    QTags.addButton( 'eg_html', 'HTML', '<pre><code class=\\\"language-html\\\">', '</code></pre>', 'r', 'HTML Code', 202 );\n    QTags.addButton( 'eg_callback', 'CSS div', css_callback );\n\n    function css_callback(){\n        var css_class = prompt( 'Class name:', '' );\n\n        if ( css_class && css_class !== '' ) {\n            QTags.insertContent('<div class=\"' + css_class +'\"></div>');\n        }\n    }\n    </script>\n    <?php\n    }\n\n}\nadd_action( 'admin_print_footer_scripts', 'my_quicktags' );\n\n\nA: I had the same problem. I fixed it by using the ep_enqueue_script aproach shown here: https://codex.wordpress.org/Quicktags_API listed under \"A more modern example\".\nIt's the same thing that Tom mentions. Instead of using 'admin_print_fotter_scripts' to write an inline script on the page, the example shows putting the Qtags javascript in a separate JS file, and loading it with 'admin_enqueue_scripts' as the action and calling wp_enqueue_script.\nThe Quicktags_API link above shows both methods, but the inline script method stoped working for me.\n\nA: You can use wp_add_inline_script to add more quicktags, ensuring it only runs when quicktags is used, and runs after it's loaded:\nfunction add_quicktag_paragraph() {\n    wp_add_inline_script(\n        'quicktags',\n        \"QTags.addButton( 'eg_paragraph', 'p', '<p>', '</p>', 'p',     'Paragraph tag', 1 );\"\n);\nadd_action( 'wp_enqueue_scripts', 'add_quicktag_paragraph' );\n\nHere the second parameter of wp_add_inline_script gets put into a <script> tag by WordPress, and it places it so that it shows after quicktags is loaded, not before. I've places a single line of code in my example but you could insert multiple lines instead.\nThis solves several problems the original snippet in the handbook had:\n\n*\n\n*it works on non-admin pages that use quicktags\n\n*it always runs the code after quicktags is loaded, not before.\n\n*no hardcoded script tags\n\n*it's possible to filter and process this because of wp_add_inline_script\n\n*if a plugin removes the quicktags code then this will not show and break\n\n\nAnother alternative is to write a JS file with your quicktags additions, and enqueue it, declaring quicktags as a dependency. This ensures it is always loaded in the correct order.\n\nA: Found a fix.\n    <script type=\"text/javascript\">\n           window.onload=function(){ \n\n\n    }\n</script>\n\nmake sure the JS loads after the page fully loads this will allow the qtags js to work. Had the same issue as you right after I updated to 6.0. This fixed it for me.\n\nA: Another fix..\n   <script type=\"text/javascript\">\n    window.addEventListener('DOMContentLoaded', () => {\n      QTags.addButton( 'test', 'Test', '<test>', '</test>', 'test' );\n    });\n    </script>\n\n\nA: This work for me (more info)\nMy QTags:\nQTags.addButton('codelights', 'CodeLights', btnAction);\n\nI edit to:\nwindow.onload = function() {\n    QTags.addButton('codelights', 'CodeLights', btnAction);\n};\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406131", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is there a way to opt out of or block having the newest core themes installed on update? We generally keep our custom theme in non-auto-update mode and one core WP theme in auto-update mode as an emergency backup as our only 2 themes in the wp-content/themes directory.\nIf we had twentytwenty installed when we launched the site in 2020, that's sufficient for our purposes - we don't need twentytwentyone and twentytwentytwo, etc.\nIt's annoying to have to delete these manually after WP updates add them. Is there any way to block that from happening?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406132", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hook on file upload I need a hook or some way to detect when the window to select the file to upload is opened. I'm talking about the window that opens the browser to select the local files to upload.\nContext:\nOn occasions, WordPress itself or some plugins directly open a window to select the local file to upload, without going through the WordPress library. I have a plugin that gives a custom path when uploading files and I need to launch a popup window just before the user goes to select the file to upload so that they can select the path where it will be saved.\nThe popup with the selector is done, I just need to find the time to launch it, that's the help I need.\nBefore asking this question I did a search but I didn't find anything about it. No hook acting at that time. I thought about detecting it with javascript but I don't know how to do it.\nPlease help\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406133", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Where Do I Find The Astra Default Font Family That All Text Elements Are Inheriting From? I'm working with the Astra theme and I'm looking at my Typography settings in the Customizer. All of the elements (body, H1, H2, etc) have the Font Family set to Inherit. Where do I find the actual font family that these are all inheriting from, in case I want to change this? LMK if you need more information.\n\nA: By default, Astra uses 'system fonts'. To change the defaults, look in Appearance / Customize / Global.\nhttps://wpastra.com/docs/font-selection/\nBest of luck!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406137", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Can't retrieve body params from PUT endpoint using formdata I have one endpoint to create players, which is a PUT request to a certain route. While I was sending parameters via JSON, it was working fine, but now I need to upload a picture with data, so I switched to formdata format.\nThis is the function running in the endpoint:\n    public function put(WP_REST_Request $request)\n    {\n\n        ['foto' => $file] = $request->get_file_params();\n\n        if (!empty($file)) {\n            if (!function_exists('media_handle_upload')) {\n                require_once(ABSPATH . 'wp-admin/includes/image.php');\n                require_once(ABSPATH . 'wp-admin/includes/file.php');\n                require_once(ABSPATH . 'wp-admin/includes/media.php');\n            }\n\n            $attachmentId = media_handle_upload('foto', 0);\n        }\n\n        //Recebe os dados\n        $genero = $request['genero'];\n        $nome = $request['nome'];\n        $apelido = $request['apelido'];\n        $data_nascimento = $request['data-nascimento'];\n        $turma = $request['class_id'];\n        $avatar = $request['avatar'];\n        $id_parent = $request['user_id'];\n\n        //Criar player\n        $playerId = wp_insert_post([\n            'post_type' => 'player'\n            'post_status' => 'publish',\n            'post_title' => '',\n            'post_author' => $id_parent,\n            'meta_input' => [\n                'genero' => $genero,\n                'nome' => $nome,\n                'apelido' => $apelido,\n                'data-nascimento' => $data_nascimento,\n                'avatar' => $avatar,\n            ]\n        ]);\n\n        if (is_wp_error($playerId)) {\n            return $this->error([\n                'status' => 'error',\n                'message' => 'N\u00e3o foi poss\u00edvel criar o jogador'\n            ]);\n        }\n\n        // ...\n        return $this->response([\n            'status' => 'success',\n            'message' => 'player cadastrado',\n            'id' => $playerId,\n            // next row is added for testing purpose\n            'body_params' => $request->get_body_params(),\n\n        ], 201);\n    }\n\nThis runs in rest_api_init hook:\n// ...\n        register_rest_route(\"zw/v1\", \"players\", [\n                    'methods' => \"PUT\",\n                    'callback' => [$playersApi, \"put\"],\n                    'permission_callback' => [$playersApi, 'permissionCallback']\n                ]);\n\nWhen I use PUT method, body_params returns as empty array. Switching to POST method it works as expected. But I would like to keep semantics of the API, so what do I have to do to make PUT request read the body as formdata?\n\nA: This is because PUT requests don't have body parameters, that's not how PUT works. PUT doesn't quite do what you thought it did, and can only be used to upload a file from a client.\nYour endpoint is incompatible with PUT as a request type because you're providing parameters as key value pairs, and that is not possible with PUT:\n\nAccording to the HTML standard, you can not. The only valid values for the method attribute are get and post, corresponding to the GET and POST HTTP methods.  is invalid HTML and will be treated like , i.e. send a GET request.\n\nLikewise:\n\nXHTML 1.x forms only support GET and POST. GET and POST are the only allowed values for the \"method\" attribute.\n\n\n*\n\n*https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form#attr-method\n\n*https://stackoverflow.com/questions/8054165/using-put-method-in-html-form\n\nAs for WordPress, it doesn't handle PUT and treats it as an alias of POST along with PATCH, so while its handling is technically correct, it's only by accident.\nNow this doesn't prevent PHP from using it as a file upload mechanism, but that is the only thing it can be used for:\nhttps://www.php.net/manual/en/features.file-upload.put-method.php\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406138", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to use query parameters, as \"_fields\", to filter data inside an array in the REST API? How to handle this endpoint\n\n/wp-json/wc/v3/products/?_fields=name,meta_data\n\n[\n    {\n        \"name\": \"Test\",\n        \"meta_data\": [\n            {\n                \"id\": 478626,\n                \"key\": \"_wp_page_template\",\n                \"value\": \"default\"\n            },\n\nto achieve this?\n[\n    {\n        \"name\": \"Test\",\n        \"meta_data\": [\n            {\n                \"value\": \"default\"\n            },\n\nI took a look at the documentation, but I didn't find anything relevant.\nSince meta_data is an array, this syntax DOESN'T work:\n\n/wp-json/wc/v3/products/?_fields=name,meta_data.value\n\n\nA: Does this only work with the meta_data object for accessing nested items in an array? I tried it with woo commerce subscription line_items and did not seem to work.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406140", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: ServerSideRender not rendering in block editor, but output is in \"apiFetch\" I'm building a dynamic block. All seems to be working fine, except it isn't actually rendering the block in the editor. It is doing something, because if I inspect the page source in the editor, the content that should be being rendered is on the page, but it's inside of an apiFetch:\n<script id=\"wp-api-fetch-js-after\">\n    ...\n    wp.apiFetch.use(...\"content\":{\"raw\":\" \\\\my html is here \",\"protected\":false,\"block_version\":1},\n    ...\n\nMy edit code looks like this:\n  import ServerSideRender from '@wordpress/server-side-render';\n  import { useBlockProps } from '@wordpress/block-editor';\n  export default function Edit({ props }) {\n    const blockProps = useBlockProps();\n    return (\n      <div {...blockProps}>\n        <ServerSideRender\n          block=\"cwr/testimonial-block\"\n        />\n      </div>\n    );\n  }\n\nNote, I'm not passing any attributes because there's nothing configurable. I also tried changing the import to\nconst { ServerSideRender } = wp.components;\nbut there was no difference.\nInitially, the render function was outputting the desired HTML; however, that resulted in it getting directly inserted after the opening <body> tag on the editor page, and generating an error. Based on a StackOverflow question, I've now changed that so the render function is returning a string. Both methods rendered fine on the front-end.\nCurrent render function:\nfunction cwr_testimonial_render_callback( $block_attributes ) {\n\n    $the_block = '<div class=\"testimonial-wrapper\">No testimonials \"\n        . \"found. Please create some first.\"</div>';\n\n    // code to change the above default to the desired dynamic output\n\n    return $the_block;\n}\n\nAnd registration is set up thusly:\nfunction create_block_cwr_testimonial_block_block_init() {\n    register_block_type( __DIR__ . '/build',\n      array(\n          'render_callback' => 'cwr_testimonial_render_callback',\n      )\n    );\n}\nadd_action( 'init', 'create_block_cwr_testimonial_block_block_init' );\n\nAnd my block.json:\n{\n        \"$schema\": \"https://schemas.wp.org/trunk/block.json\",\n        \"apiVersion\": 2,\n        \"name\": \"cwr/testimonial-block\",\n        \"version\": \"0.99.1\",\n        \"title\": \"Simple Testimonial Block\",\n        \"category\": \"widgets\",\n        \"icon\": \"flag\",\n        \"description\": \"A simple block for a testimonial slider\",\n        \"attributes\": {\n                \"message\": {\n                        \"type\": \"string\",\n                        \"source\": \"text\",\n                        \"selector\": \"div\"\n                }\n        },\n        \"supports\": {\n                \"html\": false\n        },\n        \"textdomain\": \"cwr-testimonial-block\",\n        \"editorScript\": \"file:./index.js\",\n        \"editorStyle\": \"file:./index.css\",\n        \"style\": \"file:./style-index.css\"\n}\n\nWhat am I missing to get it to actually render in the editor?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406142", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to properly replace the_content with the html in a php file? I've built a plugin that needs to overwrite the content on a specific page. It works, but it places all head content within the body, after my own html. Is there a way to fix that?\nadd_filter('the_content', 'overwrite_content');\n \nfunction overwrite_content($content) {\n    if(is_page('Signup')){\n        require_once(plugin_dir_path(__FILE__).'/views/signup.php');\n    } else { \n        return $content;\n    }\n}\n\n\nA: The reason you still see the content appearing after your HTML is because you are not returning anything in the first block of your if() statement. Obviously, you are outputting the HTML in the signup.php file, but you didn't override the original content. You can change your code to something like the following to see if you get the result you want:\nfunction overwrite_content($content) {\n  if (is_page('Signup')) {\n    require_once(plugin_dir_path(__FILE__).'/views/signup.php');\n    $content = '';\n  }\n  return $content;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406144", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: display dynamic WP Site logo on wp-admin using CSS I'm looking for a way to always display the current site logo (as set in customiser) on the wp-admin page in place of the WP logo via CSS. I know how to manually add a custom image (code below is part of the function I use):\n    #login h1 a, .login h1 a {\n          background-image: url(<?php echo get_stylesheet_directory_uri(); ?>/images/logo.png); background-size: contain;\n\nBut I would like to make the entire URL dynamic, so the site logo can be changed in the customiser and automatically update the login page, too.\nAny ideas/solutions?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406148", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Archive product loop does not work with product filters I managed to change product loop to my needs, showing taxonomy and taxonomy desription to products. I would like to have the same result  when I click to product categories or tags or brands in product filters. Instead nothing happens and it returns the basic loop I changed. In other words I want to show the products in this format\ncategory\ncategory desc\nproducts\nand keep this format when I use the product filters\nmy website is\nhttps://gracious-newton.138-201-58-116.plesk.page/shop/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406149", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Next/Previous Product with custom order by price & products inside the product category How to create next/prev buttons that are price sorted and give results inside the product category you are in?\nThis question has been asked multiple times and despite the multiple threads there wasn't an exact answer. Only relatively close ones that didn't do all of the above.\nBelow you will find my answer which works in my tests so far.\n\nA: I managed to modify an existing answer from a closely related thread to achieve this.\nYou can find the answer from the related thread here.\nhttps://wordpress.stackexchange.com/a/365334/185141\nadd_action('woocommerce_before_single_product', 'elron_prev_next_product');\n\n// and if you also want them at the bottom...\nadd_action('woocommerce_after_single_product', 'elron_prev_next_product');\n\nfunction elron_prev_next_product() {\n    \n   global $post;\n    \n   echo '<div class=\"prev-next-buttons\">';\n   $terms = get_the_terms( $product->id, 'product_cat' );  \n   foreach ($terms as $term) {\n   if ($term->ID == $category->cat_ID) {\n   $all_posts = new WP_Query(\n      array(\n         'post_type' => 'product',\n         'meta_key' => '_price', // <-- CHANGE THIS\n         'orderby' => 'meta_value',\n         'order' => 'ASC',\n         'post_status' => 'publish',\n         'posts_per_page' => -1,\n         'tax_query' => array(\n                array(\n                        'taxonomy' => 'product_cat',\n                        'field'      => 'term_id',\n                        'terms'    => $terms[0]->term_id\n                     )\n         )\n      )\n   );\n       break;\n   }\n   }\n   foreach ($all_posts->posts as $key => $value) {\n      if ($value->ID == $post->ID) {\n         $nextID = $all_posts->posts[$key + 1]->ID;\n         $prevID = $all_posts->posts[$key - 1]->ID;\n         break;\n         wp_reset_postdata();\n      }\n   }\n\n   if ($prevID) : ?>\n      <a href=\"<?= get_the_permalink($prevID) ?>\" rel=\"prev\" class=\"prev\" title=\"<?= get_the_title($prevID) ?>\"><?= esc_attr__('Previous product') ?></a>\n   <?php endif; ?>\n   <?php if ($nextID) : ?>\n      <a href=\"<?= get_the_permalink($nextID) ?>\" rel=\"next\" class=\"next\" title=\"<?= get_the_title($nextID) ?>\"><?= esc_attr__('Next product') ?></a>\n   <?php endif; ?>\n   <?php\n\n   echo '</div>';\n}\n\nI know i was searching for a way to make next/prev button on my product pages that were sorted by price and gave products only inside the product category i was on, for a long time, if you did as well give an upvote! :)\nEDIT: You can also limit the query created to output products that aren't outofstock\n$all_posts = new WP_Query(\n      array(\n         'post_type' => 'product',\n         'meta_key' => '_price', // <-- CHANGE THIS\n         'orderby' => 'meta_value',\n         'order' => 'ASC',\n         'post_status' => 'publish',\n         'posts_per_page' => -1,\n         'meta_query' => array(\n            array(\n                'key' => '_stock_status',\n                'value' => 'outofstock',\n                'compare' => '!=',\n            )\n         ),      \n         'tax_query' => array(\n                array(\n                        'taxonomy' => 'product_cat',\n                        'field'      => 'term_id',\n                        'terms'    => $terms[0]->term_id\n                     )\n         )\n      )\n   );\n\nEDIT 2: Although the above code works just fine in all my tests, there are 2 notices generated from wp_debug\nNotice: Undefined variable: product in /public/wp-content/themes/generatepress_child/functions.php on line 2098\n\nNotice: Trying to get property 'id' of non-object in /public/wp-content/themes/generatepress_child/functions.php on line 2098\n\nNotice: Undefined variable: category in /public/wp-content/themes/generatepress_child/functions.php on line 2100\n\nNotice: Trying to get property 'cat_ID' of non-object in /public/wp-content/themes/generatepress_child/functions.php on line 2100\n\n2098 line:    $terms = get_the_terms( $product->id, 'product_cat' ); \n2100 line:    if ($term->ID == $category->cat_ID) {\n\nA: After much trial and error i managed to refine the code above to clear all php notices that were created by the original code and make it work properly cause there were some mistakes in the previous code.\nI am happy to share the solution to next/prev products in your product pages that wont show outofstock products and will be sorted by ASC price while showing results only from inside the product category you are in!\nGive a thumbs up if you found it useful! :)\n//generate_inside_site_container is a theme specific hook, you can use a woocommerce product hook instead and remove if ( is_product() ) {, in the next line\n\nadd_action('generate_inside_site_container', 'japs_prev_next_product', 1000);\nfunction japs_prev_next_product() {\n   if ( is_product() ) {\n   global $post;\n   $terms = get_the_terms( !empty($product->id), 'product_cat' );  \n   foreach ($terms as $term) {\n   if ($term->ID == !empty($category->cat_ID)) {\n   $all_posts = new WP_Query(\n      array(\n         'post_type' => 'product',\n         'meta_key' => '_price', // <-- CHANGE THIS\n         'orderby' => 'meta_value_num',\n         'order' => 'ASC',\n         'post_status' => 'publish',\n         'posts_per_page' => -1,\n         'meta_query' => array(\n            array(\n                'key' => '_stock_status',\n                'value' => 'outofstock',\n                'compare' => '!=',\n            )\n         ),      \n         'tax_query' => array(\n                array(\n                        'taxonomy' => 'product_cat',\n                        'field'      => 'term_id',\n                        'terms'    => $terms[0]->term_id\n                     )\n         )\n      )\n   );\n       if ( $all_posts->post_count <= 1) {\n           return;\n       }\n       break;\n   }\n   }\n   foreach ($all_posts->posts as $key => $value) {\n      if ($value->ID == $post->ID) {\n         $nextID = $all_posts->posts[$key + 1]->ID;\n         $prevID = $all_posts->posts[$key - 1]->ID;\n         break;\n      }\n   }\n   echo '<div>';\n         if ($prevID) : ?>\n            \n            <a href=\"<?= get_the_permalink($prevID) ?>\" rel=\"prev\" class=\"prev\" title=\"<?= get_the_title($prevID) ?>\"><?= esc_attr__('Previous product') ?>\n            </a>\n   <?php endif; ?>\n   <?php if ($nextID) : ?>\n            <a href=\"<?= get_the_permalink($nextID) ?>\" rel=\"next\" class=\"next\" title=\"<?= get_the_title($nextID) ?>\"><?= esc_attr__('Next product') ?>\n            </a>\n   <?php endif; ?>\n   <?php\n\n   echo '</div>';\n   }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406150", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: enqueuing external and internal js and css in wordpress did not work with owl.js animate.css <?php\nfunction cadentic_files () {\n\n    wp_enqueue_script('cadentic_owl_carousel',get_theme_file_uri('js/owl.carousel.min.js'), array('jquery'), time(), true );\n    wp_enqueue_script('cadentic_wow_carousel',get_theme_file_uri('js/wow.min.js'), array('jquery'), time(), true );\n    wp_enqueue_script('cadentic_jquery_carousel',get_theme_file_uri('js/jquery-multitabs.js'), array('jquery'), time(), true );\n    wp_enqueue_script('cadentic_jquery1113_carousel',get_theme_file_uri('js/jquery-1.11.3.min.js'), array('jquery'), time(), true );\n    //wp_enqueue_script('cadentic_bootstrap_carousel',get_theme_file_uri('js/bootstrap.min.js'), array('jquery'), time(), true );\n    \n    wp_enqueue_style('cadentic_font_awesome','https://fonts.googleapis.com/css?family=Roboto:300,400,500,600,700,900', false);\n    \n    wp_enqueue_style('cadentic_font_popins','https://fonts.googleapis.com/css?family=Poppins:100,200,400,300,500,600,700', false);\n    \n    wp_enqueue_style('cadentic_font_confortaa','https://fonts.googleapis.com/css?family=Comfortaa:300,400,700|Josefin+Sans:100i,300,400,700|Raleway:100,200,300,400,500,600,700,800,900', false);\n    \n    wp_enqueue_style('cadentic_main_styles',get_stylesheet_uri(), false);\n    \n    wp_enqueue_style('cadentic_animate_styles',get_theme_file_uri('css/animate.css'), false);\n    wp_enqueue_style('cadentic_owl_styles',get_theme_file_uri('css/owl.theme.default.min.css'), false);\n    //wp_enqueue_style('cadentic_owlcarousel_styles',get_theme_file_uri('css/owl.carousel.min.css'), false);\n    wp_enqueue_style('cadentic_bootstrap_theme_styles',get_theme_file_uri('css/bootstrap-theme.min.css'), false);\n    wp_enqueue_style('cadentic_jquery_styles',get_theme_file_uri('css/jquery-multitabs.css'), false);\n    wp_enqueue_style('cadentic_font_awesome_styles',get_theme_file_uri('css/font-awesome.min.css'), false);\n    wp_enqueue_style('cadentic_main_css_styles',get_theme_file_uri('css/main.css'), false);\n    wp_enqueue_style('cadentic_responsive_css_styles',get_theme_file_uri('responsive.css'), false);\n    wp_enqueue_style( 'bootstrap', '//stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css', false);\n    wp_enqueue_script( 'owl-js', 'https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.carousel.min.js',array('jquery'), time(), true );\n    wp_enqueue_script( 'jq-js', 'https://code.jquery.com/jquery-3.5.0.js', array('jquery'), time(), true );\n    wp_enqueue_style( 'wpdocs-datatables-bootstrap-style', 'https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/css/dataTables.bootstrap4.min.css' );\n    wp_enqueue_style( 'wpdocs-bootstrap-style', 'https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css' );\n   // wp_enqueue_style('jquery')\n\n    \n    \n    \n\n\n    \n}\n if( !defined('THEME_IMG_PATH')){\n\ndefine( 'THEME_IMG_PATH', get_stylesheet_directory_uri() . '/images' );\n}\n}\nadd_action('wp_enqueue_scripts','cadentic_files');\n?>\nthis is my functions.php but some of the js and CSS files are not loading in WordPress 6.0. In footer.php I already have wow. init\n\n                                    //Initiat WOW JS\n                                        new WOW().init();   \n                            });\n                })(jQuery)\n            \n            \n            \n            </script>\n    \n    \n    \n    \n    <?php \n    wp_footer();\n    ?>\n        </body>\n    </html>\n\nI tried all the methods and posted here in SOF mostly it did not work in myside unless I add them in header.php\n<title>Welcome to <?php the_title();?></title>\n        <link href=\"https://fonts.googleapis.com/css?family=Comfortaa:300,400,700|Josefin+Sans:100i,300,400,700|Raleway:100,200,300,400,500,600,700,800,900\" rel=\"stylesheet\">\n        <link href=\"https://fonts.googleapis.com/css?family=Poppins:100,200,400,300,500,600,700\" rel=\"stylesheet\">\n        <link href=\"https://fonts.googleapis.com/css?family=Roboto:300,400,500,600,700,900\" rel=\"stylesheet\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"<?php echo THEME_CSS_PATH; ?>/animate.css\" media=\"all\" />\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"<?php echo THEME_CSS_PATH; ?>/owl.theme.default.min.css\" media=\"all\" />\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"<?php echo THEME_CSS_PATH; ?>/owl.carousel.min.css\" media=\"all\" />\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"<?php echo THEME_CSS_PATH; ?>/bootstrap.min.css\" media=\"all\" />\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"<?php echo THEME_CSS_PATH; ?>/bootstrap-theme.min.css\" media=\"all\" />\n        <link href=\"<?php echo THEME_CSS_PATH; ?>/jquery-multitabs.css\" rel=\"stylesheet\" type=\"text/css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"<?php echo THEME_CSS_PATH; ?>/font-awesome.min.css\" media=\"all\" />\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"<?php echo THEME_MAIN_CSS_PATH; ?>/style.css\" media=\"all\" /> \n        <link rel=\"stylesheet\" type=\"text/css\" href=\"<?php echo THEME_CSS_PATH; ?>/main.css\" media=\"all\" />\n\n\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"<?php echo THEME_MAIN_CSS_PATH; ?>/responsive.css\" media=\"all\" />\n\nif I comment out all enqueue scripts  and add this in function.php\nthe above javascripts path works well :\nif( !defined('THEME_IMG_PATH')){\n  define( 'THEME_IMG_PATH', get_stylesheet_directory_uri() . '/images' );\n }\n      if( !defined('THEME_JS_PATH')){\n  define( 'THEME_JS_PATH', get_stylesheet_directory_uri() . '/js' );\n       if( !defined('THEME_CSS_PATH')){\ndefine( 'THEME_CSS_PATH', get_stylesheet_directory_uri() . '/css' );\n}\n      if( !defined('THEME_MAIN_CSS_PATH')){\ndefine( 'THEME_MAIN_CSS_PATH', get_stylesheet_directory_uri() );\n}\n }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406153", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: returning the currect URL for nested posts I have a posttype called (article) witch have a meta_key called (parents_ids).\nSo the article can be related to multiple articles.\nI want to return the currect URL depending on the parent post\nFor example:\n1-If the user click on the child-article comming from parent-article-1\ni want the url to be example.com/parent-article-1/child-article.\n2-If the user click on the child-article comming from parent-article-2\ni want to return the url example.com/parent-article-2/child-article\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406156", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Clicking Comment \"Reply\" Button only replies to first comment I'm editing my comments.php, and within it I've added a reply button like this:\n<div class=\"reply\">\n      <a rel=\"nofollow\" class=\"comment-reply-link\" \n        href=<?php comment_reply_link(array('reply_text' => 'Reply this comment'), comment_ID()); ?> data-commentid=\"3\" \n          data-postid=\"487\" data-belowelement=\"div-comment-3\" data-respondelement=\"respond\" \n          data-replyto=\"Reply to admin\" aria-label=\"Reply to admin\"> Reply\n      </a>\n</div>\n\nWhen I click on the \"reply\" button under any comment, the comment form pops up beneath the first comment, and only replies to the first one, rather than the one I clicked on. Can anyone explain the errors in this code and describe how to fix it?\nI also tried doing\n<div class=\"reply\">\n  <?php comment_reply_link(); ?>\n</div>\n\nBut the comment_reply_link() returns null, I believe.\nI list the comments like so:\n<?php\nif (have_comments()) : ?>\n    <ol class=\"post-comments\">\n        <?php\n        wp_list_comments(array(\n            'style'       => 'ol',\n            'short_ping'  => true,\n            'callback' => 'better_comments'\n        ));\n        ?>\n    </ol>\n    <?php\nendif;\n\nand have a function better_comments() {...} which includes the above HTML for the reply div.\nHere's the first bit of that function:\n<li class=\"comment byuser comment-author-admin bypostauthor even thread-even depth-1\" id=\"comment-3\" style=\"margin-bottom: 0.7em;\">\n    <div id=\"div-comment-3\" class=\"comment-body\">\n        <div class=\"comment-author vcard\">\n            <a class=\"comment-author-text\">\n                <b><?php echo ucwords(get_comment_author()) ?></b>\n            </a>\n\nThanks.\n\nA: Your comment replies do not work because you're using a custom comment rendering callback function named better_comments, and this function hardcodes the classes IDs and other attributes rather than calling functions such as comment_ID.\nI strongly suggest abandoning this function, and instead opting for the default commenting from a default theme. This way you can start from a known good solution, and add the functionality you want correctly and incrementally.\nAdditionally, lots of the things you want to add do not need a custom comment renderer, e.g. changing the reply link text can be done with filters, as can adding extra links.\nYou might also have forgotten to enqueue the comment reply script:\n    // Threaded comment reply styles.\n    if ( is_singular() && comments_open() && get_option( 'thread_comments' ) ) {\n        wp_enqueue_script( 'comment-reply' );\n    }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406157", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: How to filter comments by comment_meta EDIT: Yay, solved it! I needed to use new WP_Comment_Query( $args ) and set my $args to only include the current post and the meta chosen. Thanks!\nThanks to the wonderful help of the community here, I have created a dropdown menu above my comments section to choose between BUY | SELL | TRADE | TALK.\nEDIT: I've changed my comment.php file. It now filters by comment_meta - YAY! Except, it gets ALL comments with this meta value. How do I constrain it to JUST comments on this page?\nRight now, i have them adding ?cmeta=ALL, etc to the url. I don't like this because it reloads the page. I suppose I'll need some javascript? Is there another way to get buttons to filter the comments below?\nEDIT: got the buttons in the right spot.\nThanks in advance, everyone!\nHere's the code from my functions.php\n\n/*\n * This will add the fields to the comment form\n*/\nfunction wpse406058_custom_comment_fields() {\n\n    echo '<p class=\"comment-form-wantto\">';\n    echo '<label for=\"wantto\">Tag your comment so other users can find your post.<br>I want to</label>';\n    echo '<select id=\"wantto\" name=\"wantto\" class=\"myclass\">';\n        echo '<option value=\"---\">---</option>';\n        echo '<option value=\"BUY\">BUY</option>';\n        echo '<option value=\"SELL\">SELL</option>';\n        echo '<option value=\"TRADE\">TRADE</option>';\n        echo '<option value=\"TALK\">TALK</option>';\n    echo '</select>';\n  \n      \n}\nadd_action( 'comment_form_logged_in_after', 'wpse406058_custom_comment_fields' );\nadd_action( 'comment_form_after_fields', 'wpse406058_custom_comment_fields' );\n\n/*\n * This will field value as comment meta\n*/\nfunction wpse406058_save_custom_field($comment_id) {\n\n    if ( isset($_POST['wantto']) && !empty($_POST['wantto']) ) {\n        $wantto = sanitize_text_field($_POST['wantto']);\n        update_comment_meta( $comment_id, 'wantto', $wantto );\n    }\n    \n}\nadd_action( 'comment_post', 'wpse406058_save_custom_field' );\n\n\nfunction wpse406058_display_comment_meta( $comment_text ) {\n    \n    $wantto = get_comment_meta( get_comment_ID(), 'wantto', true );\n    \n    if ( isset($wantto) && !empty($wantto) ) {\n        \n        $wanttotext = '<p class=\"wantosec\">I want to ' . esc_html($wantto) . '</p>';\n        \n        $comment_text = $wanttotext . $comment_text;\n    }\n   echo '<div class=\"container\">';\n    return $comment_text;\n    echo '</div>';\n}\nadd_filter( 'comment_text', 'wpse406058_display_comment_meta' );\n\nI'm calling it on each page with\n<?php comments_template(); ?> \n\nAnd here's my comments.php\n<?php\ncomment_form();\nif (have_comments()) : ?>\n    <div class=\"container\">\n        <div class=\"btn-group flex\">\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=ALL'\">SHOW ALL</button>\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=BUY'\">BUY</button>\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=SELL'\">SELL</button>\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=TRADE'\">TRADE</button>  \n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=TALK'\">TALK</button>  \n        </div>  \n    </div>\n    <?php\n    if(isset($_GET['cmeta'])){\n        $commentmeta=$_GET['cmeta'];\n        $wantto= get_comment_meta( $comment_id, 'wantto', true );\n            $args = array(\n            'post_id' => get_the_ID(),\n            'meta_query' => array(\n            \n                array(\n                    'key' => 'wantto',\n                    'value' => $commentmeta,\n                ),\n                \n            )\n        );\n        $comment_query = new WP_Comment_Query( $args );\n        $comments = $comment_query->comments;\n            echo '<ol class=\"post-comments\">';\n                wp_list_comments(array(\n                    'style'       => 'ol',\n                    'short_ping'  => true,\n                ));\n                echo $wantto;\n                \n        echo '</ol>';\n        /* much simpler one to style probably\n                        if ( $comments ) {\n                    foreach ( $comments as $comment ) {\n                        echo '<p>' . $comment->comment_content . '</p>';\n                    }\n                } else {\n                    echo 'No comments found.';\n                }\n        */\n    }else{\n\n        $wantto= get_comment_meta( $comment_id, 'wantto', true );\n        echo '<ol class=\"post-comments\">';\n                wp_list_comments(array(\n                    'style'       => 'ol',\n                    'short_ping'  => true,\n                ));\n                echo $wantto;\n                \n        echo '</ol>';\n    }\n    endif;\n    $comment_id=get_comment_ID();\n    echo $wantto;\n    \n?>\n\n\nHere's a screenshot of the buttons below the comment section.\n\n\nA: I needed to use new WP_Comment_Query and set my $args to show only this post, with the meta attached. Hope this helps someone!\n<?php\ncomment_form();\nif (have_comments()) : ?>\n    <div class=\"container\">\n        <div class=\"btn-group flex\">\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=ALL'\">SHOW ALL</button>\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=BUY'\">BUY</button>\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=SELL'\">SELL</button>\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=TRADE'\">TRADE</button>  \n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=TALK'\">TALK</button>  \n        </div>  \n    </div>\n    <?php\n    if(isset($_GET['cmeta'])){\n        $commentmeta=$_GET['cmeta'];\n        $wantto= get_comment_meta( $comment_id, 'wantto', true );\n            $args = array(\n            'post_id' => get_the_ID(),\n            'meta_query' => array(\n            \n                array(\n                    'key' => 'wantto',\n                    'value' => $commentmeta,\n                ),\n                \n            )\n        );\n        $comment_query = new WP_Comment_Query( $args );\n        $comments = $comment_query->comments;\n            echo '<ol class=\"post-comments\">';\n                wp_list_comments(array(\n                    'style'       => 'ol',\n                    'short_ping'  => true,\n                ));\n                echo $wantto;\n                \n        echo '</ol>';\n        /* much simpler one to style probably\n                        if ( $comments ) {\n                    foreach ( $comments as $comment ) {\n                        echo '<p>' . $comment->comment_content . '</p>';\n                    }\n                } else {\n                    echo 'No comments found.';\n                }\n        */\n    }else{\n\n        $wantto= get_comment_meta( $comment_id, 'wantto', true );\n        echo '<ol class=\"post-comments\">';\n                wp_list_comments(array(\n                    'style'       => 'ol',\n                    'short_ping'  => true,\n                ));\n                echo $wantto;\n                \n        echo '</ol>';\n    }\n    endif;\n    $comment_id=get_comment_ID();\n    echo $wantto;\n    \n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406158", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Error message: Response is not a valid JSON response Good morning, I need your help! I have my wordpress and woocommerce website hosted on azure, and when trying to edit a widget I get this error 'invalid JSON...' help!\nI already read all the forums with the different solutions, and nothing works. I already installed the classic editor, save the permalinks, it still doesn't work, it only happens with the widgets, and I only have a problem in azure, because I had it in another hosting and it worked perfectly. :/\n\nA: Chances are you have an error in your code, possibly calling a deprecated or non-existing WordPress function.\nThis has happened to me twice, both times when saving a page in the editor. I systematically commented out functions in functions.php and eventually the error stopped. The offending function was something I scrapped off someone's blog without really understanding it. So, be careful.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406159", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to define a rule in functions.php that ONLY disables the default wp functionality that undesirably changes '&' to '#038;'? I use a quick redirects plugin and it's changing my URLs after the fact and thereby breaking some of my links. I never want wordpress to change & to #038;.\nThere is an unwanted solution to turn off all wp_texturize by placing:\nremove_filter('the_content', 'wptexturize');\n\nI don't want to disable everything, just the & conversion in URLs.\nI can physically modify wp-includes/formatting.php by commenting out this line, but it didn't work:\n$content = preg_replace('/&([^#])(?![a-z1-4]{1,8};)/i', '&#038;$1', $content);\n\nI don't want to do that even if it did work, which it didn't, otherwise I'd have to do it again on every wp upgrade. But actually I tried it and it didn't fix it.\nFor now I added a 301 redirect into htaccess which worked.\nWhat is a permanent line of code to add to functions.php to permanently disable wordpress modifying & to #038;?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406160", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Comment Reply Link Reloading Page Instead of Moving Comment Form In my comments.php, I loop through the comments like this:\nif (have_comments()) : ?>\n    <ol class=\"post-comments\">\n        <?php\n        wp_list_comments(array(\n            'style'       => 'ol',\n            'short_ping'  => true,\n            'callback' => 'better_comments'\n        ));\n        ?>\n    </ol>\n<?php\nendif;\n\nwhere better_comments() is defined as follows:\nfunction better_comments($comment, $args, $depth)\n{\n?>\n    <li class=\"comment byuser comment-author-admin bypostauthor even thread-even depth-1\">\n        <div class=\"comment-body\">\n            <p>hello</p>\n            <p>\n                <?php comment_reply_link(array_merge($args, array('depth' => $depth, 'max_depth' => $args['max_depth']))) ?>\n            </p>\n        </div>\n    </li>\n<?php\n}\n\nThe comment_reply_link call gives me a reply button on my comments, but clicking it reloads the page, and does not move the comments form like it is supposed to. How can I fix this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406164", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Set Button in PluginDocumentSettingPanel Content (Wordpress Gutenberg) I'm trying to create a new panel in the edit-post sidebar (Wordpress Gutenberg), I already managed to set the panel with the title and the text in the content part but I need to add a button there and no I find a way to do it.\nvar registerPlugin = wp.plugins.registerPlugin;\nvar PluginDocumentSettingPanel = wp.editPost.PluginDocumentSettingPanel;\n// var btn = wp.element.createElement( 'button' );\nvar el = wp.element.createElement;\nvar __ = wp.i18n.__;\n\n/* I tried to do it with a function, but it didn't work\n\nfunction setButton() {\n    btn.innerHTML = 'Submit';\n    btn.type = 'submit';\n    btn.name = 'formBtn';\n    btn.onclick = function () {\n        alert( 'Button is clicked');\n    };\n}\n********************************************************/\n\nfunction MyDocumentSettingPlugin() {\n    return el(\n        PluginDocumentSettingPanel,\n        {\n            name: 'my-document-setting-plugin',\n            title: 'My Panel',\n            icon: 'dashicon-name',\n        },\n        __( 'My Document Setting Panel Content', 'text-domain' ),\n        // setButton(),        <---------- I need to add a button here\n    );\n}\n\nregisterPlugin( 'my-document-setting-plugin', {\n    render: MyDocumentSettingPlugin,\n} );\n\nPlease help :/\n\nA: I finally solved it like this:\nvar registerPlugin = wp.plugins.registerPlugin;\nvar PluginDocumentSettingPanel = wp.editPost.PluginDocumentSettingPanel;\nvar Button = wp.components.Button;\nvar el = wp.element.createElement;\nvar __ = wp.i18n.__;\n\nfunction onButtonClick() {\n    alert( 'Button is clicked' );\n}\n\nfunction MyDocumentSettingPlugin() {\n    return el(\n\n        PluginDocumentSettingPanel,\n        {\n            name: 'my-document-setting-plugin',\n            title: 'My Panel',\n            icon: 'dashicon-name',\n        },\n        __( 'My Document Setting Panel Content', 'text-domain' ),\n\n        el(\n            Button,\n            {\n                className: 'myclass',\n                isDefault: true,\n                onClick: onButtonClick,\n            },\n            __( 'Button Text', 'text-domain' ),\n        ),\n\n    );\n}\n\nregisterPlugin( 'my-document-setting-plugin', {\n    render: MyDocumentSettingPlugin,\n} );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406169", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Serialize data before inserting into the DB I need to store some post IDs in the DB in a custom table/field. The IDs will have to be stored in a serialized format. I know that, ie. for the options, serialization is done automatically for add/update functions (add_option(), update_option()). Is there a built-in WP function to serialize data for any other case? Or should I just use serialize()? Similarly, as soon as the data will be retrieved, is there a stock WP function to unserialize it, or will I have to use unserialize()? Thanks in advance for your replies!\n\nA: WP functions...\nSerialize: maybe_serialze\nUnserialize: maybe_unserialize\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406170", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Getting the Image Title (not the post title) I've tried over a dozen variations of getting the title now, with mixed results. I get an error, blank output, or the post title, but not the image title.\nFor reference, here's the complete image code (with my latest attempt) I'm using in posts:\n<?php if ( has_post_thumbnail() ) : ?>\n<a href=\"<?php $src = wp_get_attachment_image_src( get_post_thumbnail_id( $post->ID ), 'full', false ); echo esc_url( $src[0] ); ?>\" title=\"<?php the_title( $attachment_id ); ?>\"><?php the_post_thumbnail( 'full', array( 'itemprop' => 'image' ) ); ?></a>\n<?php endif; ?>\n\nThe specific bit I'm having difficulty with:\n<?php the_title( $attachment_id ); ?>\n\nA: \nThe specific bit I'm having difficulty with:\n<?php the_title( $attachment_id ); ?>\n\n\n\n*\n\n*the_title() doesn't have a post ID parameter, and the first parameter is actually a text/markup to prepend to the title. And note that attachments like images in the WordPress media library have their own posts, where the type (i.e. post_type) is attachment.\n\n\n*the_title() uses the global $post variable which references the current post in the main (WordPress) query. (therefore the function doesn't need a post ID as a parameter)\n\n\n*the_title_attribute() also by default uses the same $post global mentioned above, so that explains the \"when you're viewing the image on a page or post, it adopts their title\" in your comment.\n\n\n*Both the above functions use get_the_title() to get the post title, hence you could use that function to get the title of an image (or any other attachment in the media library) by the image/attachment ID.\nI.e. Use echo get_the_title( $attachment_id ) instead of the_title( $attachment_id ).\nHowever, for use in an HTML attribute like the title attribute, you would want to use the_title_attribute() which sanitizes/escapes the title and works with any posts (regular Posts, Pages, attachments, etc.), but to make the function works for a specific post only, use the post argument and pass a post object, like so, which uses get_post() to get the post object:\n<a href=\"<?php the_post_thumbnail_url( 'full' ); ?>\"\n    title=\"<?php the_title_attribute( array( 'post' => get_post( $attachment_id ) ) );\n?>\"><?php the_post_thumbnail( 'full', array( 'itemprop' => 'image' ) ); ?></a>\n\nBut actually looking at the source, passing a post ID, i.e. the_title_attribute( array( 'post' => $attachment_id ) ), should also work because the value is only used with get_the_title() which accepts either a post ID or object.\nAnd note that I intentionally used the_post_thumbnail_url() in the above code.. because that's a simpler way to display/echo the post thumbnail's URL, for any image sizes like full, thumbnail, custom, etc. :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406173", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce pre_get_posts query variation meta data not working In wordpress I made a simple plugin that adds a function to the pre_get_posts hook.\nI need to be able to search products by their variation sku.\nThe query seems to work as when I var_dump the posts returned by the WP_Query they actually include the correct posts(products). But the search result page doesn't show them and display \"No products were found matching your selection.\" no matter what theme I use.\nThe code I tied:\nfunction awesome_plugin_init() {\n\n    function is_woocommerce_really_activated() {\n        if ( class_exists( 'woocommerce' ) ) { return true; } else { return false; }\n    }\n    \n    if(is_woocommerce_really_activated()) {\n        add_action('pre_get_posts', function( $query ) {\n\n            if ( $query->is_search && is_search() ){\n            \n                $search = $query->get( 's' );\n\n                $query->set( 'meta_key', '_sku' );\n                $query->set( 'meta_value', $search );\n                $query->set( 'meta_compare', 'LIKE' );\n\n            }\n\n            /*  This would return the correct post, yet still doesn't show up in search results:\n                $q = new WP_Query([\n                    'post_type' => ['product', 'product_variation'],\n                    'meta_query' => [\n                        [\n                            'key' => '_sku',\n                            'value' => $search,\n                            'compare' => 'LIKE'\n                        ]\n                    ]\n                ]);\n            */\n\n                \n        });\n    }\n    \n}\nadd_action( 'plugins_loaded', 'awesome_plugin_init' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406174", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Workaround for og:image unsupported webp image type, Yoast SEO? My site Beta Fox uses Yoast SEO plugin to help deal with SEO common practices, however an issue has arisen. In beginning of last year WordPress didn't fully support webp image types, neither Yoast SEO. Things changed near the end of year, but Yoast SEO unbelievably refuses to support webp (the types Google is forcing upon on us to use). The problem is the fact there's no open graph for image attachments in any page of the site, so that means link preview doesn't show any image.\nadd_action('wp_head', 'add_link_prev_img');\n    function add_link_prev_img () {\n        $attachment_id = get_post_thumbnail_id( $post_id ); $image_attributes = wp_get_attachment_image_src( $attachment_id, \"full\" );\n        $fotoo = $image_attributes[0];\n        if (!empty($fotoo) && get_post_mime_type( get_post_thumbnail_id()) == 'image/webp') {\n        <meta property=\"og:image\" content=\"<?php echo $fotoo;?>\"> \n            }\n    }\n\nThe code above was supposed to add the meta tag that is missing in pages/posts of my site, but doesn't work as intended. It causes critical error in the site. Every page needs to show featured image or something similar if available. Please, help!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406175", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do you choose to display specific posts/pages by parent url I have adjacent posts set up correctly but it's displaying all of the posts/pages. I need it to show specific ones. The easiest way would be by parent URL if that's possible as I need to do this multiple times. So www.example.com/sydney/ would be the URL and every page that uses the sydney parent would be displayed and nothing else. It doesn't have to be this way if there is a better/easier way then I am all ears.\n/**\n *  Infinite next and previous post looping in WordPress\n */\n\n// Previous post if present, otherwise the very first post.\n\n$prev_post = get_adjacent_post( false, '', true );\n\nif ( $prev_post ) { // previous post\n    if ( has_post_thumbnail( $prev_post->ID ) ) {\n        $prev_post_image_url = wp_get_attachment_image_url( get_post_thumbnail_id( $prev_post->ID ), 'thumbnail' );\n    } else {\n        $prev_post_image_url = 'https://dummyimage.com/150';\n    } ?>\n\n    <a class=\"prev-post adjacent-post\" href=\"<?php the_permalink( $prev_post->ID ) ?>\">\n        <img src=\"<?php echo $prev_post_image_url; ?>\" alt=\"Previous Post\" />\n        <div>\n            <p class=\"adjacent-label\">&larr; Previous Post</p>\n            <h4 class=\"adjacent-title\"><?php echo get_the_title( $prev_post->ID ); ?></h4>\n        </div>\n    </a>\n<?php } else { // first post\n    $args = array(\n        'posts_per_page' => 1,\n        'no_found_rows' => true,\n        'order' => 'DESC',\n    );\n\n    $first = new WP_Query( $args );\n\n    $first->the_post();\n\n    // first post's image URL\n    if ( has_post_thumbnail() ) {\n        $first_post_image_url = wp_get_attachment_image_url( get_post_thumbnail_id(), 'thumbnail' );\n    } else {\n        $first_post_image_url = 'https://dummyimage.com/150';\n    } ?>\n\n    <a class=\"prev-post adjacent-post\" href=\"<?php the_permalink() ?>\">\n        <img src=\"<?php echo $first_post_image_url; ?>\" alt=\"Previous Post\" />\n        <div>\n            <p class=\"adjacent-label\">&larr; Previous Post</p>\n            <h4 class=\"adjacent-title\"><?php echo get_the_title(); ?></h4>\n        </div>\n    </a>\n    <?php wp_reset_postdata();\n}\n    \n\n// Next post if present, otherwise the very last post.\n\n$next_post = get_adjacent_post( false, '', false );\n\nif ( $next_post ) { // next post\n    if ( has_post_thumbnail( $next_post->ID ) ) {\n        $next_post_image_url = wp_get_attachment_image_url( get_post_thumbnail_id( $next_post->ID ), 'thumbnail' );\n    } else {\n        $next_post_image_url = 'https://dummyimage.com/150';\n    } ?>\n\n    <a class=\"next-post adjacent-post\" href=\"<?php the_permalink( $next_post->ID ) ?>\">\n        <img src=\"<?php echo $next_post_image_url; ?>\" alt=\"Next Post\" />\n        <div>\n            <p class=\"adjacent-label\">Next Post &rarr;</p>\n            <h4 class=\"adjacent-title\"><?php echo get_the_title( $next_post->ID ); ?></h4>\n        </div>\n    </a>\n<?php } else { // last post\n    $args = array(\n        'posts_per_page' => 1,\n        'no_found_rows' => true,\n        'order' => 'ASC',\n    );\n\n    $last = new WP_Query( $args );\n\n    $last->the_post();\n\n    // last post's image URL\n    if ( has_post_thumbnail() ) {\n        $last_post_image_url = wp_get_attachment_image_url( get_post_thumbnail_id(), 'thumbnail' );\n    } else {\n        $last_post_image_url = 'https://dummyimage.com/150';\n    } ?>\n\n    <a class=\"next-post adjacent-post\" href=\"<?php the_permalink() ?>\">\n        <img src=\"<?php echo $last_post_image_url; ?>\" alt=\"Next Post\" />\n        <div>\n            <p class=\"adjacent-label\">Next Post &rarr;</p>\n            <h4 class=\"adjacent-title\"><?php echo get_the_title(); ?></h4>\n        </div>\n    </a>\n    <?php wp_reset_postdata();\n}\n\n\nA: Use the filters available in get_adjacent_post() to add a post parent condition to the WHERE clause:\nfunction wpse_406178_adjacent_post_where_sibling( $where, $in_same_term, $excluded_terms, $taxonomy, $post ) {\n    global $wpdb;\n\n    if ( $post->post_parent ) {\n        $where .= $wpdb->prepare( ' AND p.post_parent = %d', $post->post_parent );\n    }\n\n    return $where;\n}\n\nadd_filter( 'get_next_post_where',     'wpse_406178_adjacent_post_where_sibling', 10, 5 );\nadd_filter( 'get_previous_post_where', 'wpse_406178_adjacent_post_where_sibling', 10, 5 );\n\nAdd it to your functions.php\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406178", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I query for posts using a date stored in post-meta? I\u2019m working on a games release feature for a website I\u2019m building. So far everything is going smooth, but I\u2019m stuck on one area. For the listings on the front end, I want it to look at the \u201crelease_date\u201d field and only display games that have a release date >= that date.\nI feel the code below should work, but it doesn\u2019t return/display anything on the front end. And if I switch it to <=, it displays everything.\nAny help would be greatly appreciated! Below is the query code.\n$releasewindow = date('M j, Y', strtotime(\"-31 days\"));\n    \n    $q = new WP_Query(array(\n        'post_type' => 'game_release',\n        'posts_per_page' => 5,\n        'meta_key'  => 'release_date',\n        'orderby'   => 'release_date',\n        'order' => 'ASC',\n        'meta_query' => array(\n        array(\n            'key'     => 'release_date',\n            'compare' => '>=',\n            'value'   => $releasewindow,\n        )\n    ),\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406180", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change quantity via jQuery and disabile quantity field I have products where I need to disable the quantity field on the product detail pages and dynamically change the quantity based on another value.\nI change the value using this code:\nif (jQuery('body').hasClass('is-adapt-quantity-product')) {\n            jQuery('.wc-pao-addon-custom-textarea').bind('keyup', _.debounce(function(){\n                jQuery(\".qty\").val(parseInt(jQuery(this).val().length));\n            }, 500));\n    }\n\nThis works fine. The quantity changes and if I click on the \"add to cart\" button, I have the quantity in my cart.\nWhen I add this to the js code:\njQuery(\".qty\").attr(\"disabled\", \"disabled\");\n\nThe quantity on the product detail page changes. However when I add the product to the cart, it adds always just the quantity of \"1\".\nDoes anybody know why this happens and how I can prevent this from happening? I want to disable the quantity field, because the field should be changes dynamically...\n\nA: If the input is disabled, it is ignored during form submission. You can try to use readonly attribute.\nAs it says in the docs: The difference between disabled and readonly is that read-only controls can still function and are still focusable, whereas disabled controls can not receive focus and are not submitted with the form and generally do not function as controls until they are enabled.\nReference: https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/readonly\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406181", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to change or add user role after getting post request data about pay? How to change or add user role after getting post request data about pay?\nqiwi2.php file in theme folder:\n<?php\ninclude($_SERVER['DOCUMENT_ROOT'].'/wp-load.php');\n\n$qiwi = [\n    \"public_key\" => \"*\",\n    \"secret_key\" => \"*\",\n    \"successUrl\" => \"https://someurl/\"\n];\n\n$secret_key = $qiwi['secret_key'];\n\n$sha256_hash_header = $_SERVER['HTTP_X_API_SIGNATURE_SHA256']; \n$entity_body = file_get_contents('php://input');\n\n$array_body = json_decode($entity_body, 1);\n\n$amount_currency = $array_body['bill']['amount']['currency'];\n$amount_value = $array_body['bill']['amount']['value'];\n$billId = $array_body['bill']['billId'];\n$siteId = $array_body['bill']['siteId'];\n$status_value = $array_body['bill']['status']['value'];\n$account = $array_body['bill']['customer']['account'];\n\n$invoice_parameters = $amount_currency.\"|\".$amount_value.\"|\".$billId.\"|\".$siteId.\"|\".$status_value.\"|\".$account;\n$invoice_parameters=(string) $invoice_parameters;\n    \n$sha256_hash = hash_hmac('sha256', $invoice_parameters, $secret_key);\n\nif (!empty($sha256_hash_header) && strcmp($sha256_hash_header, $sha256_hash) === 0 && $status_value == 'PAID') {\n\n    $user = get_user_by( 'id', $account);\n    $user->set_role( 'subscriber' );\n\n} else {\n    http_response_code(404);\n    die();\n}\n?>\n\nI try this lines:\n$user = get_user_by( 'id', $account);\n$user->set_role( 'subscriber' );\n\nbut got user role None;\nand I add this line to the beginning of the file for these functions to work:\ninclude($_SERVER['DOCUMENT_ROOT'].'/wp-load.php');\n\nAnd I understand that it's looking something very not right. But don't know how to do it the correct way.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406184", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Format meta_value I have a request to get postmeta records with a specific meta_value.\nglobal $wpdb;\n$result = $wpdb->get_results ( \" SELECT * FROM  $wpdb->postmeta WHERE $wpdb->postmeta.meta_key LIKE 'wpcomplete' \" );\nforeach ( $result as $page ) {\n echo maybe_unserialize($page->meta_value).'<br/>';\n} \n\nresult :\n{\"buttons\":{\"3\":\"1951965-debutant\",\"4\":\"1951965-intermediaire\",\"5\":\"1951965-expert\"},\"course\":\"examen\"}\nI just need to clean the result like that\nbuttons :\n1951965-debutant\n1951965-intermediaire\n1951965-expert\ncourse :\nexamen\n\nA: It seems the meta value is double serialized.\nTry this, it also cleans up your query, untested:\n$results = $wpdb->get_column ( \" SELECT meta_value FROM  $wpdb->postmeta WHERE meta_key LIKE 'wpcomplete' \" );\n\nforeach ( $results as $result ) {\n\n    $item = maybe_unserialize( $result ); \n    if ( is_serialized( $item ) {\n       $item = maybe_unserialize( $item ); \n    }\n    \n    foreach( $item as $obj ) {\n    \n       foreach( $obj->buttons as $key => $value ) {\n           echo $value . '<br>';\n       }\n       \n       foreach( $obj->course as $key => $value ) {\n           echo $value . '<br>';\n       }\n       \n    }\n    \n}\n\nIf you know that the meta_key is exactly 'wpcomplete', then do not use LIKE - it is slow.  Instead, do this: WHERE meta_key = 'wpcomplete'\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406185", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Translate javascript with WordPress built-in localization API for static strings I have been trying to implement the translation to a couple of strings in a .js file but nothing has worked.\nFirst try to do it like I do in php, in the .js file add this variable var __ = wp.i18n.__; and I put the strings like __( 'Hello World', 'text-domain'), but it didn't work.\nAfter looking for information about it, I found a post where they talk about passing the translated strings with wp_localize_script something like that.\n// Localize the script with new data\n$translation_array = array(\n    'some_string' => __( 'Some string to translate', 'plugin-domain' ),\n    'a_value' => '10'\n);\nwp_localize_script( 'some_handle', 'object_name', $translation_array );\n\nI did it and it didn't work either\nBelow I leave my js and php code, please tell me what I'm doing wrong\nPHP\n// Register script\nfunction mediafolders_sidebar_plugin_register() {\n    wp_register_script(\n        'mediafolders-plugin-select-js',\n        MEDIAFOLDERS_PLUGIN_URL . 'assets/js/select.js',\n        array( 'wp-plugins', 'wp-edit-post', 'wp-element' )\n    );\n    $translation_array = array(\n        'textContent' => __( 'Select the folder where you want to save the images or files that you upload to this post.', MEDIAFOLDERS_TEXT_DOMAIN ),\n        'textButton' => __( 'Select Folder', MEDIAFOLDERS_TEXT_DOMAIN ),\n    );\n    wp_localize_script( 'mediafolders-plugin-select-js', 'MediaFolders', $translation_array );\n}\nadd_action( 'init', 'mediafolders_sidebar_plugin_register' );\n\n// Enqueue script\nfunction mediafolders_sidebar_plugin_script_enqueue() {\n    wp_enqueue_script( 'mediafolders-plugin-select-js' );\n}\nadd_action( 'enqueue_block_editor_assets', 'mediafolders_sidebar_plugin_script_enqueue' );\n\nJAVASCRIPT\nwindow.addEventListener( 'load', function() {\n    var registerPlugin = wp.plugins.registerPlugin;\n    var PluginDocumentSettingPanel = wp.editPost.PluginDocumentSettingPanel;\n    var Button = wp.components.Button;\n    var el = wp.element.createElement;\n\n    var MediaFolders = {\n        textContent: 'Select the folder where you want to save the images or files that you upload to this post.',\n        textButton: 'Select Folder',\n    };\n\n    function onButtonClick() {\n        var popup = document.querySelector( '.mediafolders-popup' );\n        popup.classList.add( 'open' );\n    }\n\n    // Create elements for panel on sidebar\n    function MediaFoldersDocumentSetting() {\n        return el(\n\n            PluginDocumentSettingPanel,\n            {\n                name: 'media-folders-lite',\n                title: 'Media Folders Lite',\n                icon: 'open-folder',\n                initialOpen: true,\n            },\n            MediaFolders.textContent,\n            \n            el(\n                Button,\n                {\n                    isDefault: true,\n                    className: 'mediafolders-panel-button',\n                    onClick: onButtonClick,\n                },\n                MediaFolders.textButton,\n            ),\n\n        );\n    }\n\n    registerPlugin( 'media-folders-lite', {\n        render: MediaFoldersDocumentSetting,\n    } );\n\n    // Close the pop up by clicking on the X or Done!\n    var btnClosePopup1 = document.querySelector( '.mediafolders-popup-close' );\n    var btnClosePopup2 = document.querySelector( '.mediafolders-popup-button > button' );\n    if ( btnClosePopup1 ) {\n        btnClosePopup1.addEventListener( 'click', () => {\n            var popup = document.querySelector( '.mediafolders-popup' );\n            popup.classList.remove( 'open' );\n        });\n    }\n    if ( btnClosePopup2 ) {\n        btnClosePopup2.addEventListener( 'click', () => {\n            var popup = document.querySelector( '.mediafolders-popup' );\n            popup.classList.remove( 'open' );\n        });\n    }\n});\n\n\nA: wp_localize_script() defines a variable in the global JS scope - in the case of your code, the object is placed in a globally-scoped variable with the identifier MediaFolders.\nIn your load event callback you are also defining a variable with the identifier MediaFolders scoped to it's encapsulating function body - so when you use the variable further down, your code is referencing the locally scoped variable rather than the global one which wp_localize_script() defined.\nThe solution is to remove your var MediaFolders = {...} definition. Alternately, if you wanted to provide redundant fallbacks, you could also use the spread operator or Object.assign() in order to merge the values from the wp_localize_script() object into some defaults by explicitly referencing the global value as a property on window:\nvar MediaFolders = {\n  textContent: 'Select the folder where you want to save the images or files that you upload to this post.',\n  textButton: 'Select Folder',\n  ...window.MediaFolders\n};\n\nThough, this shouldn't be necessary as it would only protect against the case where wp_localize_script() fails for some reason - which would probably mean you have bigger fish to fry.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406188", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP Default Feed Url Change I would like to change wordpress feed url. After a little research I find this function (check below).\nfunction remove_feed( $feedname ) {\n        global $wp_rewrite;\n\n        if ( in_array( $feedname, $wp_rewrite->feeds ) ) {\n                $wp_rewrite->feeds = array_diff( $wp_rewrite->feeds, array( $feedname ) );\n        }\n\n        $hook = 'do_feed_' . $feedname;\n\n        // Remove default function hook\n        remove_all_actions( $hook );\n        add_action( $hook, $hook );\n\n        return $hook;\n}\n\nBut I don't know how to use this function. Is there any one who can explain it?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406194", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I don't understand why use array inside the add action hook to create custom post type using object oriented way <?php\n/*\nPlugin Name: My Plugin\nPlugin URI: https://my.plugin.com\nDescription: My plugin description\nVersion: 1.0.0\nAuthor: Me\nAuthor URI: https://my.website.com\nLicense: GPL2 (or whatever)\n*/\n\nclass myClass {\n\n    function __construct() {\n\n        add_action( 'init', array( $this, 'create_post_type' ) );\n\n    }\n    function create_post_type() {\n    $name = 'Foos';\n        $singular_name = 'Foo';\n        register_post_type( \n            $name ,\n            array(\n                'labels' => array(\n                    'name'               => _x( $name, 'post type general name' ),\n                    'singular_name'      => _x( $singular_name, 'post type singular name'),\n                    'menu_name'          => _x( $name, 'admin menu' ),\n                    'name_admin_bar'     => _x( $singular_name, 'add new on admin bar' ),\n                    'add_new'            => _x( 'Add New', strtolower( $name ) ),\n                    'add_new_item'       => __( 'Add New ' . $singular_name ),\n                    'new_item'           => __( 'New ' . $singular_name ),\n                    'edit_item'          => __( 'Edit ' . $singular_name ),\n                    'view_item'          => __( 'View ' . $singular_name ),\n                    'all_items'          => __( 'All ' . $name ),\n                    'search_items'       => __( 'Search ' . $name ),\n                    'parent_item_colon'  => __( 'Parent :' . $name ),\n                    'not_found'          => __( 'No ' . strtolower( $name ) . ' found.'),\n                    'not_found_in_trash' => __( 'No ' . strtolower( $name ) . ' found in Trash.' )\n                ),\n                'public'             => true,\n                'has_archive'        => strtolower($taxonomy_name),\n                'hierarchical'       => false,\n                'rewrite'            => array( 'slug' => $name ),\n                'menu_icon'          => 'dashicons-carrot'\n            )\n        );\n\n    }\n\n}\n$my_class = new myClass();\n?>\n\n\nA: This is more a PHP question than a WordPress one. WP's add_action and add_filter functions just accept a PHP type known as \"callables\".\nEssentially, when you want to pass an object instance's method as a callback, you do so using the syntax you see here - an array where the first element is the object instance, and the second element is the name of the method.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406195", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Trying to add array of paths to post permalink Am trying to add custom path to my article posttype\nso my article path will be www.example/parent-post-1/parent-post-2/the-actual-post\ni tried to add this code\n/**\n * @param $post_link\n * @param $id\n * \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430 \u043a \u0441\u0441\u044b\u043b\u043a\u0435\n * @return array|mixed|string|string[]\n */\nfunction wpa_course_post_link($post_link, $id = 0)\n{\n    $post = get_post($id);\n    if ($post instanceof WP_Post) {\n        $parent = get_field('parents', $post->ID) ?: [];\n        $link = '';\n        foreach ($parent as $post) {\n            $link .= $post->post_name . '/';\n        }\n        if ($parent) {\n            $post_link = str_replace('%parents%/', $link, $post_link);\n        }\n    }\n    return $post_link;\n}\n\nadd_filter('post_type_link', 'wpa_course_post_link', 1, 3);\n\n\nits works if the post has only 1 parent post, but if the post has more than 1 parent posts, it shows 404\nmy CPT UI settings.\nCustom rewrite slug -> articles/%parents%\nhow to solve this? thank you\n\nA: You shouldn't need to manually handle this with hooks & custom slug settings - just ensure hierarchical is set to true in your register_post_type arguments.\nYou mention \"CPT UI\" settings, are you referring to the Custom Post Type UI plugin? If so, make sure Hierarchical is set to True in the Settings metabox.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406196", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: AJAX action through direct link I have an existing AJAX action that's already defined by the theme I'm using. The action deletes a search item request, and I'd like to use it as a direct link - like an Unsubscribe link - emailed to the user along with the search results...\nSomething like the following URL: https://domain.tld/wp-admin/admin-ajax.php?action=delete_saved_search_item=&search_item_id=17 but I get a 0 on the screen and a 400 Bad Request in the Headers.\nBasically in the JS it's defined like this:\n            $.post(ajaxurl,\n                {\n                    action: 'delete_saved_search_item',\n                    search_item_id: search_item_id,\n                },\n                function (response) {\n                    response = JSON.parse(response);\n                    if (response.success) {\n                        search_item.remove();\n                    }\n                }\n            );\n\nso I suppose it expects a POST request, not a GET one... Is there any workaround to make this work? Like creating a page with a custom cURL that would imitate the POST form submission? Anyone done something like this? The good thing is I didn't notice any use of nonce, so I suppose this alone makes it easier to handle, doesn't it?\n\nA: Use WordPress' generic POST/GET handler wp-admin/admin-post.php\nDon't let the name confuse you - it accepts both GET/POST, and just like admin-ajax.php it accepts both authorised (admin) and non-authorised (public) requests.\nfunction wpse_406199_custom_action() {\n    // Do something!\n\n    // Maybe redirect back to where they came from?\n    wp_redirect( wp_get_referer() );\n    exit;\n}\n\n// Non-logged-in requests\nadd_action( 'admin_post_nopriv_wpse_406199_custom_action', 'wpse_406199_custom_action' );\n\n// Logged-in requests\nadd_action( 'admin_post_wpse_406199_custom_action', 'wpse_406199_custom_action' );\n\nAnd to get the URL:\n$action_url = admin_url( 'admin-post.php?action=wpse_406199_custom_action' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406199", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Metaboxes inside Tab I am learning WordPress Plugin development. In this regard I have to save some settings along with Custom Post in Admin Panel under a Menu. Can I place metaboxes inside tab for this issue like the below image ?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406202", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Dynamic URL Rewrite for Custom I have a custom post type called Hotels which I woud like to link to using the below url structure:\n/{country}/{state}/{hotel-name}\nI am fetching and inserting posts dynamically, so I do not know the number of countries/states.\nThe Hotel Name is the slug version of the post title.\nI have been banging my head all day trying to get it to work.\nThe below code works to make the links look correct, but then 404s on all posts:\nfunction change_link($permalink, $post)\n{\n    if ($post->post_type == 'hotels') {\n        $country = get_field('location_country', $post->ID);\n        $state = get_field('location_state', $post->ID);\n\n        $permalink = get_home_url() . \"/hotels/\"\n            . (!empty($country) ? slugify($country) . '/' : '')\n            . (!empty($state) ? slugify($state) . '/' : '')\n            . $post->post_name;\n    }\n    return $permalink;\n}\nadd_filter('post_type_link', \"change_link\", 10, 2);\n\nI then tried adding a rewrite rule, but I don't fully understand what it is doing and why it is not working:\nfunction generate_rule($wp_rewrite)\n{\n    add_rewrite_rule(\n        '/hotels/([^/].+?)/([^/].+?)/([^;?]+)',\n        'index.php?post_type=hotels&name=$matches[3]&country=$matches[1]&state=$matches[2]',\n        'top'\n    );\n}\nadd_action('init', 'generate_rule');\n\nWoud be much appreciated if someone can point me in the right direction...\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406210", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Unserialize Custom Field & Save as Multiple Rows in Wordpress Database I have a custom field in post_meta table of wordpress database. It's called 'combined'. I want to seperate the values based on key and save them as multiple rows if there are multiple values for the key.\nMy meta_key:\n\nResult after I run my code:\n\nWhat I want:\n\nMy code:\nadd_action( 'init', function() {\n    if ( 'migrate' !== filter_input( INPUT_GET, 'action' ) ) {\n        return;\n    }\n \n    $query = new WP_Query( [\n        'no_found_rows' => true,\n        'update_post_term_cache' => false,\n        'fields' => 'ids',\n        'posts_per_page' => -1,\n        'post_type'      => 'post',\n        'post_status'    => 'any',\n    ] );\n    if ( ! $query->have_posts() ) {\n        return;\n    }\n \n    while ( $query->have_posts() ) {\n        $query->the_post();\n        \n        $data = get_post_meta( get_the_ID(), 'combined', true );\n        \nforeach($data as $singleData => $value ){\n    \n    update_post_meta( get_the_ID(), $singleData, $value );\n\n\n}\n\n    }\n} );\n\n\nA: I have found the way to get the values as I want them to be in the database. Changing the loop part in the above code with code did the trick.\n$data = get_post_meta( get_the_ID(), 'combined', true );\n        \nforeach($data as $singleData => $value ){\n    $thisArray = $data[$singleData];    \n        foreach ($thisArray as $key2 => $value){\n            add_post_meta( get_the_ID(), $singleData, $thisArray[$key2], $unique = false);\n        }   \n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406214", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Correct Way to Move WordPress to Subdomain and Shop to Stay at root Domain I have a WordPress website with WooCommerce configured. The root domain xyz.com is set to the shop but the blog is at xyz.com/blog. Now I want to move the blog to blog.xyz.com and keep the shop at the root domain.\nWhat would be a best way for this?\nDo I have to install additional WordPress in some other folder? Or is there is an easy way to do it with the current installation.\nThanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406217", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenberg selecting child blocks directly from appender I created a block that uses inner blocks/child blocks. The parent block is named Columns and only child blocks named Column are allowed in it. The Column child block accepts any blocks. The structure looks like this:\n<Columnns>\n  <Column><Any block></Column>\n  <Column><Any block></Column>\n  <Column><Any block> <Another block> <One more block></Column>\n</Columns>\n\nIn the edit function for the child Column block, I am just using an inner blocks appender that allows any blocks to be added in it.\nThe edit function for the parent Columns block:\nedit() {\n\n    const blockProps = useBlockProps();\n\n    const ALLOWED_BLOCKS = [ 'custom/column' ];\n\n    <div {...blockProps}>\n      <InnerBlocks\n        orientation=\"horizontal\"\n        allowedBlocks={ ALLOWED_BLOCKS }\n        templateLock={ false }\n        renderAppender={ InnerBlocks.ButtonBlockAppender }\n      />\n    </div>\n\n }\n\nThe following is created in the editor:\nWhen I click the block appender button (the smaller plus (+) button at the right), a new child block named Column is added:\n\nWhen I click a child block Column, the block selection popup appears:\n\nHow can I make the block selection popup appear when clicking the block appender (the smaller plus button), as well as the Column child block? When I select a block directly from the appender button, I would like to automatically add a child block Column and insert in it whatever block was selected.\nWhy am I trying to achieve this?\nOriginally, 2 steps are required to add a child block named Column and add blocks in it.\n\n*\n\n*Click the appender button to add a new child block Column.\n\n*Click the Column block to add blocks in it.\n\nI would like to reduce that process to 1 step.\n\n*\n\n*Click the appender button, select a block, and it is added to a new child block Column.\n\nWhy am I not doing the following:\nIn the Columns edit function, why not remove the allowedBlocks property from InnerBlocks? By doing so, the block selection popup will appear when clicking the appender and any block can be added.\n\n*\n\n*I need the  child block to be wrapped around all the blocks added in it. Also the Column child block might have its own inspector options.\n\nWhy not use a filter to wrap a div representing Column around any child blocks of the Columns parent block?\n\n*\n\n*I need the child block Column to be its own block because multiple blocks can be added in it, and like I mentioned, it may have its own inspector controls.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406218", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get_object_term_cache duplicate terms after update to wordpress 6 After WordPress update to 6 versions receives an issue. receive duplicated terms on function\necho wp_kses_post(get_the_term_list($product->get_id(), 'product_cat', '', ', ', ''));\nand\necho wp_kses_post( get_the_term_list( $product->get_id(), 'pa_material', '<li class=\"material\">', ', ', '</li>' )) ? : '';\nAll work correctly before the update.\nI found that get_object_term_cache( $post->ID, $taxonomy ); give me duplicated terms\nWhat can cause this issue? Plugin or function change? (unable to find detail WP 6 changelog)\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406219", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Set city as required if country is Singapore I would like to set city checkout field as required if country is Singapore (if we only sell to Singapore, the city field is obligatorily optional).\nThis is what I did so the user can only choose Singapore as the city, but there still is the \"optional\" label, which I want to become required.\nadd_filter( 'woocommerce_checkout_fields', 'custom_checkout_fields', 10, 1 );\nfunction custom_checkout_fields( $fields )\n{\n    $fields['billing']['billing_city']['type'] = 'select';\n    $fields['billing']['billing_city']['options'] = array('Singapore' => 'Singapore');\n\n    $fields['shipping']['shipping_city']['type'] = 'select';\n    $fields['shipping']['shipping_city']['options'] = array('Singapore' => 'Singapore');\n\n    return $fields;\n}\n\nI tried $fields['billing']['billing_city']['required'] = true; but it doesn't work...\nHow can I change \"optional\" to \"required\"?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406220", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to search by slug and old slug in single API I need to search for wordpress posts with input slug or old slug only 1 parameter in single API.\nNow I'm using 2 url:\n1. /wp-json/wp/v2/posts?slug=hello-world\n2. /wp-json/wp/v2/posts?meta_key=_wp_old_slug&meta_value=hello-world\n\nHow can I solve this problem?\nWordpress version: 5.9\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406221", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display category name of custom posts only once in the loop I have a custom post type called \"Projects\" and for it some categories.\nI would like to display the category name of the posts in the loop but only once.\nI am using this but the category is being displayed on top of every post.\nFor example if the 2 posts are in the same cetegory, now I see the category name twice in the same loop.\nHow can I solve it?\nMy code:\n<?php\n  $category = the_category();\n?>\n<h2 style=\"text-transform: uppercase;\">\n<?php\n  if($i == 1) { \n    echo $category[1]->cat_name; \n  }\n  $i++;\n?>\n</h2>     \n\nMany thanks in advance\n\nA: Display category name of custom posts only once in the loop\nWhich page template do you want to display the category name? category page or single page,  I am pretty sure this code will work.\n<?php\n    $category = get_the_category();\n?>\n<h2 style=\"text-transform: uppercase;\">\n<?php\n    foreach ( $category as $key=> $val ){\n        echo $val->cat_name .'<br>';\n    }\n?>\n</h2>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406222", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom Gutenberg Block: How to return plain HTML with save(), without escaping? I'm writing a custom Gutenberg editor block.\nWhen saving the block I can save simple HTML elements, like in the documentation:\nreturn wp.element.createElement('div', blockProps, 'Your block.');\n\nHowever, I need to return some huge and complicated HTML that I cannot produce in that way. To give you an impression:\n<div class=\"wrapper\"><svg class=\"some-svg-image\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 600 600\" xml:space=\"preserve\" aria-labelledby=\"catTitle catDesc\" role=\"img\">...<g>...<path>...</svg></div>\n\nWhen I return this as a string, it will be escaped.\nHow can I prevent escaping for the HTML that I return with the save() method?\n\nA: From the docs:\n\nWhile it is possible to return a string value from save, it will be\nescaped. If the string includes HTML markup, the markup will be shown\non the front of the site verbatim, not as the equivalent HTML node\ncontent. If you must return raw HTML from save, use\nwp.element.RawHTML. As the name implies, this is prone to cross-site\nscripting and therefore is discouraged in favor of a WordPress Element\nhierarchy whenever possible.\n\nIn addition, you can also import the SVG as a component and use it as you would use any other JSX / React, e.g. via svgr.\nreturn (\n    <div className=\"wrapper\">\n        <svg className=\"..\"..>\n        ...\n        </svg>\n    </div>\n);\n\nwould become\nimport MyIcon from '../../assets/myicon.svg';\n\n...\n\nreturn (\n    <div className=\"wrapper\">\n        <MyIcon />\n    </div>\n)\n\n(Here I'm using JSX <div> instead of ...createElement('div', ..) which is basically the same but imo a more readable syntax.)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406223", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Getting text from custom field from customizer So I've created a panel in the customizer section in WordPress to add the phone number to the site.\nIt works fine in the back end but it wont show up in the front end\nhere is my functions.php\n    function home_smart_register_theme_customizer( $wp_customize ) {\n    $wp_customize->add_panel( 'contact_info', array(\n        'priority'       => 10,\n        'theme_supports' => '',\n        'title'          => __( 'Contact Info', 'home_smart' ),\n        'description'    => __( 'Set your current address.', 'home_smart' ),\n    ) );\n    $wp_customize->add_section( 'contact_details_block' , array(\n        'title'    => __('Phone Number','home_smart'),\n        'panel'    => 'contact_info',\n        'priority' => 10\n    ) );\n    $wp_customize->add_setting( 'address_block', array(\n         'default'           => __( 'Default text', 'home_smart' ),\n         'sanitize_callback' => 'sanitize_text'\n    ) );\n    $wp_customize->add_control( new WP_Customize_Control(\n        $wp_customize,\n        'contact_details_block',\n            array(\n                'label'    => __( 'Number', 'home_smart' ),\n                'section'  => 'contact_details_block',\n                'settings' => 'address_block',\n                'type'     => 'text'\n            )\n        )\n    );\n  \n    function sanitize_text( $text ) {\n        return sanitize_text_field( $text );\n    }\n}\nadd_action( 'customize_register', 'home_smart_register_theme_customizer' );\n\nhere is my footer.php\n <p>\n            <?php\n            function add_phone_number(){\n                    echo  get_theme_mod('address_block'); \n            }\n            add_action('home_smart_number', 'add_phone_number'); \n            ?>\n</p>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406227", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Retrieve user roles but exclude default roles I am currently using the wp_roles() function to retrieve all user roles available like this:\n<?php\n  foreach (wp_roles()->get_names() as $role) {\n    echo translate_user_role( $role );\n  }\n?>\n\nHow would I retrieve an array/list of all custom roles that I've created without the default roles (Administrator, Editor, Subscriber, etc) included?\n\nA: So I ended up using a combination of the array_filter function and the in_array function to retrieve all custom roles like this:\n<?php\n\n  function check_roles($userRole) {\n    $default_roles = array('Administrator', 'Editor', 'Author', 'Contributor', 'Subscriber');\n    if (!in_array($userRole, $default_roles)) {\n      return $userRole;\n    }\n  }\n\n  $all_roles = wp_roles()->get_names();\n  $custom_roles = array_filter($all_roles, 'check_roles');\n\n  foreach ($custom_roles as $role) {\n    echo $role;\n  }\n\n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406228", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Update current WP post every 3 minutes I wish to auto update/publish the changes of a post I am editing every 3 minutes. Any idea how can I achieve that?\n\nA: Classic Editor:\nautosave.js file\nsetInterval(function () {document.getElementById(\"publish\").click()}, 300000);\n\nphp function\n// Load js file on specific post type in class editor\nfunction load_js_file_classic_editor( $hook ) {\n\n    global $post;\n\n    if ( $hook == 'post-new.php' || $hook == 'post.php' ) {\n        if ( 'post' === $post->post_type ) {     \n            wp_enqueue_script(  'myautosave', get_stylesheet_directory_uri().'/includes/js/autosave.js' );\n        }\n    }\n}\nadd_action( 'admin_enqueue_scripts', 'load_js_file_classic_editor', 10, 1 );\n\nGutenberg\nsetInterval(function() {\n    wp.data.dispatch( 'core/editor' ).savePost();\n}, 60 * 1000); // 60 * 1000 milsec\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406230", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How using the Meta Box plugin, to filter posts by the value of a post type field? I'm using the Meta Box plugin to create custom post types and fields. There is a record type teachers, and I'm trying to display the lessons associated with him on the page of a certain teacher. The code looks like this:\n$queryArgs = array(\n            'post_type' => 'lessons',\n            'order' => 'ASC',\n            'posts_per_page' => -1,\n            'orderby' => 'meta_value',\n            'meta_key'  => 'lessons_teacher',\n            'compare' => 'LIKE',\n            'meta_query' => [\n                [\n                    'key'  => 'post_name',\n                    'value'   => 'john-smith',\n                ]\n            ]\n        );\n\nand here it is not entirely clear how to compare lessons by the value of [post_name], because the field is an array, i.e. a set of keys - values... and [post_name] is the key to which, in fact, you need to refer..\n\nA: I'm not familiar with the Meta Box plugin or it's capabilities (and please note that third-party products are considered off-topic here!) - but regarding the question in the scope of core WordPress alone...\nFor clarity's sake, I envision the lessons_teacher meta-value to look similar to\n[['post_name' => 'john_smith'], ['post_name' => 'jane_doe']]\n\nSQL - and by extension WordPress's meta-query functionality - is not designed to be used against complex serialized data; SQL has no concept of PHP serialization - it simply treats complex serialized data as a string. While it is possible to work around this limitation to an extent, it should be noted that such a work-around comes with performance implications and a degree of fallibility - the mechanism is not robust and may yield the wrong result depending on the content of the serialized value.\nThe best solution is to store the associated teachers as singular post names in multiple meta data fields with the same name, or otherwise break the complex serialized data down into multiple non-serialized fields.\nThat in mind, the work-around consists of querying against the value which is actually stored in the database rather than it's unserialized PHP representation. The array of associative arrays above would be stored as the string:\na:2:{i:0;a:1:{s:9:\"post_name\";s:10:\"john_smith\";}i:1;a:1:{s:9:\"post_name\";s:8:\"jane_doe\";}}\n\nIn effect, you would want to query for posts which have a meta value for the key lessons_teacher containing the sequence s:9:\"post_name\";s:<post_name length>:\"<post_name>\";\n$teacher_post_name = 'john-smith';\n$teacher_meta_val  = sprintf(\n    's:9:\"post_name\";s:%d:\"%s\";',\n    strlen($teacher_post_name),\n    $teacher_post_name\n);\n$query_args        = [\n  'post_type'      => 'lessons',\n  'posts_per_page' => -1\n  'meta_key'       => 'lessons_teacher',\n  'meta_value'     => $teacher_meta_val,\n  'meta_compare'   => 'LIKE',\n];\n\nNotes:\n\n*\n\n*You could also use a REGEXP comparison operator here - but either one has serious performance implications for the query.\n\n*I've omitted your orderby meta-value argument because it most certainly will not achieve what you'd like - it would order results by the serialized string.\n\n*You could simplify the meta_value to just $teacher_post_name - but that might risk additional false-positives if a teacher post name (or something with the same characters) appears elsewhere in the complex serialized data.\n\nUltimately, I would not ship something containing this code - the additional overhead and risk of failure is too great when simpler and more efficient alternatives are available.\nBy contrast, if you were to store each associated teacher's post_name by itself in it's own lessons_teacher meta-field, the query would would be a simple\n$query_args        = [\n  'post_type'      => 'lessons',\n  'posts_per_page' => -1\n  'meta_key'       => 'lessons_teacher',\n  'meta_value'     => $teacher_post_name,\n];\n\nwith substantially greater performance and virtually no risk of false-positives.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406231", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: registering a global template wordpress 6.0   <?php \n    \n    /*\n    *   Template Name : Amaizing Inner Page 1 Template from me*\n    * @package WordPress\n    * @subpackage CADENTIC\u00ae BUSINESS THEME\n    * @since MY BUSINESS THEME 0.0.1\n        */\n    \n    ?>\n\nif we would these simple lines in a template file we would use it as a global template but now in WordPress 6.0, there is no such attribute that exists in Gutenberg to select a new page template.  I was following a few articles for this wordpress doc clouddera \n\nA: \nbut now in WordPress 6.0, there is no such attribute that exists in Gutenberg to select a new page template.\n\nThis is not true! WP 6.0 did not remove this functionality. In fact in the block editor it is even more prominent and has its own dedicated panel if you scroll up the sidebar:\n\nIf this isn't showing then you should enable it in the block editor settings window:\n\nKeep in mind that the article you've linked to is talking about the classic editor.\nThe final possibility, is that poor/strange formatting has broken the ability to parse your template header.\nE.g. instead of this:\n  <?php \n    \n    /*\n    *   Template Name : Amaizing Inner Page 1 Template from me*\n\nDo this:\n<?php\n/**\n * Template Name: Amazing Inner Page 1 Template from me*\n\nSee the official documentation for page templates for details and examples:\nhttps://developer.wordpress.org/themes/template-files-section/page-template-files/#creating-custom-page-templates-for-global-use\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406232", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenberg default attributes are empty when accessing in edit I'm quite new to Gutenberg and Wordpress and facing some issues with my attribute. When I'm trying to output the attribute data it is returning an empty object. Not quite sure why the default values aren't being applied?\nThanks in advance!\nregisterBlockType(\"mt/product-listing\", {\n  title: \"Product\",\n  icon: \"edit-page\",\n  category: \"design\",\n  attributes: {\n    content: { type: 'string' }\n  }, \n  ...,\n     \n\nAnd when trying to access in edit:\n edit: (props) => {\n    // Accessing props\n    console.log(\"Edit\", props);\n\n\n    return (\n      <div>\n         <Products product={props.attributes} />\n      </div>\n    )\n  },\n\nResulting output:\n{\n    \"name\": \"mt/product\",\n    \"isSelected\": true,\n    \"attributes\": {},\n    \"clientId\": \"xxxxxxxxxx-xxxx-xxxxx\",\n    \"isSelectionEnabled\": true,\n    \"context\": {},\n    \"className\": \"wp-block-mt-product\"\n}\n\n\nA: You aren't defining any defaults in your registerBlockType\n[...]\nattributes: {\n    content: {\n        type: 'string',\n        default: 'I am a string',\n    },\n},\n[...]\n\nWorth noting also that the attributes will only get saved in your final markup once they have a value - it won't save the defaults in the content.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406235", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to use wp_send_json() and output the value with ajax? Hello Wordpress Developers.\nI create my own plugins, and I'm stuck about how to call php functions inside class, into javascript ajax functions.\nFor example we have button with ID name clickme:\n<button id=\"clickMe\">Click Me</button>\n\nAnd then I make a class with functions, example like this:\n<?php\nclass myFunctions{\nfunction a(){\n$test = \"Hello World from wp_send_json()\";\nwp_send_json($test);\n}\n\n}\n?>\n\nand then I want to output the test variable, using ajax. Example like this:\nimport $ from \"jquery\";\n\nclass trigger{\nconstructor(){\n\nthis.button = $(\"#clickme\");\nthis.events();\n\n}\nevents(){\n  this.button.on(\"click\", this.buttonHandler.bind(this));\n\n}\n\nbuttonHandler(){\n\n$.ajax({\n//how to call the Hello World from wp_send_json()?\n\nsuccess: response => {\n//if success, alert the \"Hello World from wp_send_json\";\nalert();\n\n}\n\n});\n\n\n}\n\n\n}\n\nI'm stuck, and I hope I get the help to solve it. Thank you in advance, wordpress Developers!\n\nA: You can follow below steps:\nHTMl Code:\n<button id=\"clickMe\" data-nonce=\"<?php echo esc_attr( wp_create_nonce( 'my-nonce' ) ); ?>\">Click Me</button>\n\nPHP Code: here you need to use wp_ajax hook.\nclass myFunctions{\n\n    public function __construct(){\n        add_action( 'wp_ajax_clickme', [$this, 'ajax_callback']); // for logged in user only\n        add_action( 'wp_ajax_nopriv_clickme', [$this, 'ajax_callback']); // for non logged user only\n    }\n\n    public function ajax_callback() {\n        $test = \"Hello World from wp_send_json()\";\n        if ( ! isset( $_POST['nonce'] ) || ! wp_verify_nonce( $_POST['nonce'], 'my-nonce' ) ) {\n          wp_send_json_error( 'Sorry, your nonce did not verify.' );\n          exit;\n        } else {\n          wp_send_json($test);\n        }\n    }\n}\n\n$run = new myFunctions();\n\nJS Code: for your example, you can ignore nonce, name\nimport $ from \"jquery\";\n\nclass trigger {\n    constructor() {\n        this.button = $(\"#clickme\");\n        this.events();\n    }\n\n    events() {\n        this.button.on(\"click\", this.buttonHandler.bind(this));\n    }\n\n    buttonHandler() {\n        let ajax_url = \"http://yoursite.com/wp-admin/admin-ajax.php\";\n        $.ajax({\n            type: \"post\", // request type get, post\n            url: ajax_url, // this sould be http://yoursite.com/wp-admin/admin-ajax.php url\n            data: {\n                action: \"clickme\", // wp_ajax_$action or wp_ajax_nopriv_$action - Important\n                nonce: $(this).data('nonce'), // must pass wp nonce and verify to protect CSRF - Very Important for Security\n                name: \"Razon\", // your data, you can pass your own data like this - Optional\n            },\n            success: function(response) {\n                console.log(response);\n            }\n        });\n    }\n}\n\nHope that help :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406236", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: str_replace inside specific css files Is it possible to perform str_replace inside an enqueue stylesheet? i can do str_replace on inline style with this function\nfunction replace_text($text) {\n    $text = str_replace('background-image', 'background', $text);\n    return $text;\n}\nadd_filter('the_content', 'replace_text');\n\n\nis it possible to perform the same action inside style.css file ?\n wp-content/plugins/assets/style.css\n\nA: No, because the CSS file isn't loaded in and parsed by PHP\u2014it's just \"printed\" to the browser at the appropriate time.\nYou can, however, add inline styles to an enqueued stylesheet, which you would then be able to manipulate with filters.\nIn the code snippet below, let's assume you're using wp-content/plugins/my-plugin/assets/style.css.\nadd_action( 'wp_enqueue_scripts', 'wpse406238_inline_css' );\nfunction wpse406238_inline_css() {\n    // Define any dependencies here.\n    $dependencies = array();\n    // Set your version number here.\n    $version = '1.0.0';\n    // Define the media for the stylesheet here.\n    $media = 'all';\n    wp_enqueue_style( 'my-handle', plugins_url( '/assets/style.css', __FILE__ ), $dependencies, $version, $media );\n\n    // Add some inline CSS.\n    $inline_css = 'h1 { color: #000; }';\n    // Filter that inline CSS, so others can change it as needed.\n    $inline_css = apply_filters( 'my_plugin_inline_css', $inline_css );\n    // Add the CSS to the rendered page.\n    wp_add_inline_style( 'my-handle', $inline_css ); \n\n}\n\n// ...elsewhere...\nadd_filter( 'my_plugin_inline_css', 'wpse_406238_filter_my_css' );\nfunction wpse_406238_filter_my_css( $css ) {\n    // Green is the new black.\n    $css = str_replace( '#000', '#0f0', $css );\n    return $css;\n}\n\nReferences\n\n*\n\n*wp_enqueue_scripts hook\n\n*wp_enqueue_style()\n\n*plugins_url()\n\n*wp_add_inline_style()\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406238", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Insert Ads After Every X Paragraph PHP I am currently using this code to insert Ads after the 5th paragraph and it works just fine.\n//Insert ads after fifth paragraph\nadd_filter( 'the_content', 'prefix_insert_post_ads' );\nfunction prefix_insert_post_ads( $content ) {\n    $ad_code = '<center>AD CODE</center>';\n    if ( is_single() && ! is_admin() ) {\n        return prefix_insert_after_paragraph( $ad_code, 5, $content );\n    }\n    return $content;\n}\n\n// Parent Function\nfunction prefix_insert_after_paragraph( $insertion, $paragraph_id, $content ) {\n    $closing_p = '</p>';\n    $paragraphs = explode( $closing_p, $content );\n    foreach ($paragraphs as $index => $paragraph) {\n        if ( trim( $paragraph ) ) {\n            $paragraphs[$index] .= $closing_p;\n        }\n        if ( $paragraph_id == $index + 1 ) {\n            $paragraphs[$index] .= $insertion;\n        }\n    }\n    return implode( '', $paragraphs );\n}\n\nBut, I would like the ads to be repeated after every 5 paragraphs, not just once. What do I do?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406239", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I add /blog/ as a prefix to permalink structure for posts, categories & tags? The URL structure I am hoping for is as follows:\n\n*\n\n*All posts: /blog/ and /blog/page/2\n\n*Categories: /blog/%category%/ and /blog/%category%/page/2\n\n*Post: /blog/%category%/%postname%/\n\n*Tags: /blog/%tag%/ and /blog/%tag%/page/2\n\nMy problem is that I am unable to have both my permalink 'custom structure' and 'category/tag base' with the \"blog\" prefix, without having page or pagination 404 errors.\nI am working on a dev site which has no plugins and a custom theme which is not ineterferring. I would like a plugin-free solution which is .htaccess or in functions.php... or no code.\nWordPress 6.0\nThanks in advance for your help.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406241", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: search.php to search only the post title I'm trying to rewrite my search.php to search only for the post titles because I have a ton of posts published to my site (around 400k), which slows down the search speed to about 20s per search.\n<?php get_header();\n$search_term = $_GET['s'];\n$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n$posts = new WP_Query( array(\n        's'     => \"$search_term\",\n        'ep_integrate'   => true,\n        'post_type'      => 'post',\n        'posts_per_page' => 21,           \n        'orderby' => 'date',\n         'order'   => 'DESC',\n         'paged' => $paged,\n    ) );\n?>\n<?php if ($posts->have_posts()) :\n?>\n<main>\n<div class=\"container mt-5\">\n    <h4> Results for\" <?php the_search_query(); ?></h4>\n    <hr style=\"margin-top: 0;\">\n    <div class=\"row clear full-img\"> ...\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406244", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Updating WordPress core with zero downtime - I mean zero I have a critical website which is under version control. When I update the core WordPress files I do so locally, then commit the changes. When I do that the live site (obviously) does not even display a maintenance notice, it simply errors out for a few minutes as the core files are deployed, and presumably are either read part way through, or are temporarily incompatible one to the other.\nI could update from the live admin, and then deploy, which would swap those events around. There would be a maintenance notice, and the file incompatibilities would be minimised.\nSo - question: How could this be accomplished with ZERO downtime? Is there a way? Dual servers with some kind of failover? How do the big companies handle this situation? How can I update the Wordpress core with (literally) zero downtime?\nUpdate: I deploy using a third party SVN provider \"Beanstalk\", who's own FTP seems to be slow incidentally. But in terms of deployment, even if I FTP the files up from local, there is going to be some downtime. Please regard this question as more of a thought experiment. What is the best approach to updating a WordPress site with ZERO downtime?\n\nA: There is no general solution to this problem. Your solution will be specific to your situation, and unusable for many other users, and vice versa. All with their own varying tradeoffs.\nFor example, some hosting companies spin up new instances with the new update, that then replace the old instances, but this is not possible on many hosts. This also glosses over the fact that what that sentence means can vary wildly depending on the technologies used. For example, a new AWS instance is very different from replacing a container. It's also not going to work for people on shared hosts.\nTo find a truly concrete answer you will need to work with your host. If their deployment process is not atomic then that's an issue with that host that you need to work with or work around. How you do that is unique to your host and technology stack. The solution for AWS environments for example only works on AWS.\nOr you may choose to rely on a cache based system, which only works for certain kinds of sites, and requires additional hardware and software. This might work great for a newspaper for example, but it won't work for a membership site, and has other tradeoffs too.\nAnd for some hosts, usually shared hosts accessed directly, it simply cannot be done as there is no way to bulk update files in one single atomic step. The best they can hope for is a maintenance mode or holding page.\nEither way, it's highly dependent on your hosting platform, tech stack, budget, the type of site you have, and commercial needs. If you constrain this question down to your specific tech stack, there may be a canonical solution, but it would only apply to users in your specific use case. E.g., there is definitely solutions for AWS/EC2, but it only applies to that particular technology stack.\n\nA: Assuming you have ssh access.\nThe \"poor man's solution\" would be to create a directory with the new code, e.g. new_code and run\nmv code_dir code_dir_old && ln -s new_code code_dir\n\nWhich would rename the code_dir directory to code_dir_old and immediatly after that create a symlink from your prepared new new_code directory to code_dir.\nIf you expect database migrations, that only add columns (not remove) then you could run these before making the change.\n\nA: Thomas' answer is good, but repeating it will result in strangely nested directories. I'd like to expand on it to give a full recipe on the poor man's solution using ssh (and also scripts):\nOne often-used pattern (for a Linux developer) is to create separate directories for each version:\nwordpress-5.9.2/\nwordpress-5.9.3/\nwordpress-6.0/\n\nand then create one symbolic link to access the \"currently active\" version (which your web server should use as base directory, a.k.a. document root):\nln -s -T -f wordpress-5.9.3 wordpress\n\nThis gives you the following directory listing:\nwordpress-5.9.2/\nwordpress-5.9.3/\nwordpress-6.0/\nwordpress -> wordpress-5.9.3\n\nSwitching between versions then is one command\u2014and you can easily switch back in case of errors:\nln -s -T -f wordpress-6.0 wordpress\n\n\n*\n\n*-T tells ln to always use the behaviour as if the target was a file, avoiding putting the symbolic link inside a directory if the target is a symbolic link pointing to a directory.\n\n*-f overwrites the target if it already exists (instead of throwing an error).\n\n*-s just says that it should be a symbolic link instead of a hard link.\n\n\nA: The first step is to use a load balancer. You should have one in any case for any critical site, and have two \"application\" servers behind it even if you do not expect major traffic spikes, just to have a failover in case of one of the servers failing.\nWhen the time to upgrade comes, you get the server being upgraded off the load balancer, upgrade it (wpcli or direct administrator access via some specific IP address or domain which bypasses the balancer). Once upgraded, you add it back to the balancer and upgrade the other the other application server.\nThis is not a zero effort solution as it requires some planning regarding image storage, cache clearing and keeping the same DB structure while there is a version mismatch between the application servers.\nAs someone who had done it, I know it is not \"rocket science\", but you need to ask yourself if just getting the site offline for an hour (probably much less) every 4 months is such a bad thing that it is worth complicating your site's infrastructure. Do you really need a load balancer just for that reason?\nNote regarding deploying from Git or SVN. You should write a script getting WordPress into maintenance mode. Fixing a corrupted DB because some part of the code was on version X while the other was on X+1 can cost you much more than you lose because the site is down for a minute.\n\nA: On my WP host which is a typical VPS where I have root access, I run WP using the official Docker image (wordpress:fpm) and an Nginx in front of it. WP files (wp-content) are bind-mounted from the host so I can easily manage them.\nFor a typical WP upgrade, I pull a new Docker image. Then I get rid of the old container and spin up a new one with otherwise identical configuration (networking in particular). This leads to a visible downtime of ~1sec. If I were to achieve zero downtime, I'd spin up the new container alongside the running one, update Nginx config and nginx -s reload, let Nginx finish existing connections while new connections are routed to the new PHP FPM container, and only after that do I destroy the old container.\n\nA: personally, I use cache as solution to this\nw3 total cache -> page cache activated\nsolves downtime issues.\nbut of course, this solution is not perfect for every type of wp site.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406252", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: Logging in to the frontend works correctly but not for WP-Admin On my private page, I want the website to be shown only to logedin people. So if a person comes to the site, the first is displayed custom template login form. When the person log-in, the home page is displayed.\nI have this redirect done with the following code:\nadd_action( 'template_redirect', function() {\n  if ( ! is_user_logged_in() && ! is_page( array( 'prijava', 'pozabljeno-geslo' ) ) ) {\n    wp_redirect( esc_url( home_url( '/prijava/' ) ) );\n    exit;\n  }\n});\n\nAnd the log in form using Ajax and the following code:\n//add this within functions.php\nfunction ajax_login_init(){\n\n    wp_register_script('ajax-login-script', get_stylesheet_directory_uri() . '/assets/js/ajax-login.js', array('jquery') ); \n    wp_enqueue_script('ajax-login-script');\n\n    wp_localize_script( 'ajax-login-script', 'ajax_login_object', array( \n        'ajaxurl' => admin_url( 'admin-ajax.php' ),\n        'redirecturl' => home_url(),\n        'loadingmessage' => __('Po\u0161iljanje podatkov o uporabniku, po\u010dakajte ...')\n    ));\n\n    // Enable the user with no privileges to run ajax_login() in AJAX\n    add_action( 'wp_ajax_nopriv_ajaxlogin', 'ajax_login' );\n}\n\n// Execute the action only if the user isn't logged in\nif (!is_user_logged_in()) {\n    add_action('init', 'ajax_login_init');\n}\n\n\nfunction ajax_login(){\n\n    // First check the nonce, if it fails the function will break\n    check_ajax_referer( 'ajax-login-nonce', 'security' );\n\n    // Nonce is checked, get the POST data and sign user on\n    $info = array();\n    $info['user_login'] = $_POST['username'];\n    $info['user_password'] = $_POST['password'];\n    $info['remember'] = $_POST['rememberme'];\n\n    $user_signon = wp_signon( $info, false );\n    if ( is_wp_error($user_signon) ){\n        echo json_encode(array('loggedin'=>false, 'message'=>__('Napa\u010dno uporabni\u0161ko ime ali geslo.')));\n    } else {\n        echo json_encode(array('loggedin'=>true, 'message'=>__('Prijava uspe\u0161na, preusmerjanje...')));\n    }\n\n    die();\n}\n\nEverything works normally for \"normal\" users. For administrators who need to access the WP-ADMIN page, it redirect  them to the wp-login.php page, but why if they are already logged in, because otherwise the first home page would not show them?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406253", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I create network with different domains? I have heard similar questions posed but not exactly what I am looking for.\nIs it possible to create a multisite with different domains and sub.doamins?\nFor example, can I create a network that allows me to create build:\nSiteName1.com is a BuddyPress video community.\nDomainName2.net is an online shop that sells products.\nTheDomain3.co is a web design & hosting company that creates and manages other websites.\nUsers must be able to create subsites of their own like (username.TheDomain3.co) Also if they upgrate their site then username.com would replace username.TheDomain3.co\nAlso website4.uk would be a central affiliation centre that would like all the others together and offer people referral commission on sales and views.\nI know all this is possible through MultiSite:  but my question is this:  Can I build this network so that each site has its own unique domain and if the user logs into DomainName2.net and adds a product to his/her basket I would need the user to still be logged in when they visit website4.uk and see the product in their basket.\nI would like to make sure basket, history, activity, accounts/profiles/channels are synced throughout the website.\nA perfect example of what I want my site to be like is ThemeForest.net if you add a theme to your basket and then visit codecanyon.net you can see the shared basket of the multi sites.\n\nA: Even if this plugin isn't updated, I use it and it works like a charm:\nhttps://wordpress.org/plugins/wordpress-mu-domain-mapping/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406256", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to allow certain PHP functions when using sanitize_callback in the word press customizer Hi I am making my own theme in WordPress and setting up some customizer options and I have one for the text in my footer but I would like to still use <? echo date('Y');?>  in the footer to dynamically change the date so I don't have to keep going in and doing it manually but the sanitizer call-back obviously blocks it is there a way to still be able use that php function in the sanitizer\nhere is my code what I'm using\ncustomizer.php\n\n$wp_customize-> add_setting('set_copyright', array(\n'type' => 'theme_mod',\n'default' => \"Copyright &copy; <?php echo date('Y'); ?> . All Rights Reserved\",\n'sanitize_callback' => 'esc_attr'\n));\n\n $wp_customize-> add_control('ctrl_copyright', array(\n'label' => 'Copyright Information',\n'description' => 'Enter your copyright info',\n'section' => 'sec_footer',\n'settings' => 'set_copyright',\n'type' => 'text',\n\n));\n\n/////\n footer.php\n\n <footer class=\"main-footer\">\n<div class=\"copy pt-3 pb-3\">\n    <div class=\"container\">\n        <div class=\"row\">\n            <div class=\"col text-center \">\n                <p class=\"small m-0\"><?php echo do_shortcode( get_theme_mod( 'set_copyright', \"Copyright &copy; <?php echo date('Y'); ?> . All Rights Reserved\") ) ; ?></p>\n            </div>\n        </div>\n    </div>\n</div>\n\n\nA: This sort of theme mod is only capable of conveying a string into the markup regardless of any sanitization callback - any PHP included within the string will never be interpreted by the PHP engine, short of running the output through eval() which would be extremely dangerous and likely result in the theme failing review for any marketplace.\nIn this case, since you're running the mod value through shortcodes anyway, I think it would be easiest and provide the best end-user experience to just include a shortcode which outputs the current year, or as a wrapper around the wp_date() function:\nfunction wpse406257_date( $atts, $content ) {\n  $atts = shortcode_atts( [\n    'format'   => 'F j, Y',\n    'timezone' => null,\n  ], $atts, 'date' );\n\n  $timestamp = !empty( $content ) ? strtotime( $content ) : null;\n\n  return wp_date( $atts['format'], $timestamp, $atts['timezone'] );\n}\n\nadd_shortcode( 'date', 'wpse406257_date' );\n\n//...\n'default' => 'Copyright &copy; [date format=\"Y\"] . All Rights Reserved'\n//...\n\nYou could achieve a similar effect without shortcodes by running the string output through str_replace() and swapping out custom placeholders such as {year}.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406257", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress 6.0 class-wp-widget.php fatal errors in PHP 8.1.6 /wp-includes/class-wp-widget.php gives me an error for one blog, but not the other, and both have the same version of class-wp-widget.php which makes no sense to me.\n\nPHP Fatal error:  Uncaught ArgumentCountError: Too few arguments to\nfunction WP_Widget::__construct(), 0 passed in\n/home/www/stackexchange.com/wp-includes/class-wp-widget-factory.php on\nline 61 and at least 2 expected in\n/home/www/stackexchange.com/wp-includes/class-wp-widget.php:162\n\nReading the code, it appears class-wp-widget.php is the root of the problem, but I could be wrong.\nMy other (working) blog on the same server has this same file and I don't get the error.\nYou can see the broken WordPress function here https://developer.wordpress.org/reference/classes/wp_widget/__construct/\nIs there a way to \"turn off\" widgets to deactivate this broken WordPress code?\nUpdate: thanks @bosco for the idea, looking at the Stack trace helped...\nStack trace:\n#0 /home/www/example.com/wp-includes/class-wp-widget-factory.php(61): WP_Widget->__construct()\n#1 /home/www/example.com/wp-includes/widgets.php(115): WP_Widget_Factory->register()\n#2 /home/www/example.com/wp-content/themes/theme1516/includes/register-widgets.php(22): register_widget()\n#3 /home/www/example.com/wp-includes/class-wp-hook.php(307): load_my_widgets()\n#4 /home/www/example.com/wp-includes/class-wp-hook.php(331): WP_Hook->apply_filters()\n#5 /home/www/example.com/wp-includes/plugin.php(476): WP_Hook->do_action()\n#6 /home/www/example.com/wp-includes/widgets.php(1854)\n\nSince \"register-widgets.php\" is the only non-core code here, and because I assume @bosco's comment is correct, I commented out the old widgets and that at least removed the \"white screen of death\" meanwhile the homepage looks wonky, will probably just cut/paste the HTML from the PHP 7.x site.\n\nA: In case you couldn\u2019t revert to PHP older than 8.1 or fix the widget registration (and you trust your 10+ years old theme), you can update the line 61 of wp-includes/class-wp-widget-factory.php this way :\n$this->widgets[ $widget ] = new $widget( $widget, $widget );\n\nThis may fix the widget registration.\n\nA: For anyone still having this issue, you can try to go\nwordpress/wp-includes/class-wp-widget-factory.php on line 61 make this change to fix the issue without changing any other code:\nChange this: $this->widgets[ $widget ] = new $widget();\nTo: $this->widgets[ $widget ] = new $widget( $widget, $widget );\nEverything should work as expected now.\n\nA: I suspect the cause is a custom widget that has been built incorrectly. Take a look at this example from the Codex:\nclass My_Widget extends WP_Widget {\n\n    /**\n     * Sets up the widgets name etc\n     */\n    public function __construct() {\n        $widget_ops = array( \n            'classname' => 'my_widget',\n            'description' => 'My Widget is awesome',\n        );\n        parent::__construct( 'my_widget', 'My Widget', $widget_ops );\n    }\n\nWhat a lot of poorly built plugins do is this:\nclass My_Widget extends WP_Widget {\n\n    /**\n     * Sets up the widgets name etc\n     */\n    public function __construct() {\n        parent::__construct();\n    }\n\nOr they fail to include a __construct method at all! Passing no parameters or not having a constructor is incorrect. Past versions of PHP may have substituted these values for null or undefined, resolving to ''`, but I would still have expected this to become a problem before upgrading to 8.1, and it would certainly have appeared in the error log as a notice.\nSo identify which plugin or theme is responsible for this, either with stack traces, or a process of elimination, perhaps even by doing a search of the codebase with a tool.\nIf this is in code that you maintain such as a custom theme or plugin, you can resolve the issue by implementing the Widget API correctly as the Codex and the devhub handbooks instruct. Specifically, by providing the first two parameters.\nIf you're not interested in fixing the widgets, you can also remove them from your site completely.\n\nIn the meantime, downgrade to 8.0 for a little while. Both 8.0 and 8.1 are currently supported versions of PHP and receiving updates. WordPress has yet to build official support for 8.0, and 8.1 is a very recent release ( early 2022 ), so it's unsurprising you encountered compatibility issues and clashes with 3rd party code when you upgraded.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406260", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Remove 'type / to choose a block' placeholder I'd like to remove the placeholder in an empty block 'type / to choose a block'.\nI often have empty spaces in my drafts as I'm writing and this placeholder clutters everything. I'd just like it empty. Is there a way to remove it with a filter?\n\nA: add_filter( 'write_your_story', function ( $string, $post ){ return ' '; }, 10,2);\n\nAlso answered at: https://wordpress.org/support/topic/remove-type-to-choose-a-block-block-placeholder/\nDocs: https://developer.wordpress.org/reference/hooks/write_your_story/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406262", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using Product variations as product addons This is more a question for advice than a bug or problem. I'm building a Woocommerce based plugin and I was looking to at way of using the core woocommerce/ wordpress as best as possible without the need for dependencies.\nMy question for advice centres around using variations also as product addons as I'm trying to develop the functionality of being able to\n\n*\n\n*Offer \"checkbox\" type variations\n\n*Allow selection of multiple variations per attribute that is used for the variations\n\n*Still have the variations add the value if any to a base price\n\nI think this way because \"variable product\" variations already have the features needed for a product addon without needing a product addons plugin. All I need to do is improve the options for attribute types and facilitate multiple variation value selection per variation attribute.\nDo you think this is a good principle concept?\n\nA: Discussions on WooCommerce is off-topic here, but can't resist myself answering. I faced a similar issue couple of months back and my solution was something like this.\n\n*\n\n*Remove the default add to cart form and variation choices in single variable product page. You can use JS or modify the template.\n\n\n*Add custom form with checkboxes and quantity input for each variation\n\n\n*Add those checked variations programmatically using woocommerce_add_to_cart hook.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406264", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: add_submenu_page() issue I am trying to add a Menu in WordPress Admin Panel. I am using below code.\nThis code is working.\nadd_submenu_page('weather_info', 'Weather Information', 'Weathers', 'manage_options', 'weathers', [$this, 'weathers']);\n\nBut below code is not working. I am facing error Warning: call_user_func_array() expects parameter 1 to be a valid callback, function 'edit.php?post_type=weather' not found or invalid function name .\nadd_submenu_page('weather_info', 'Weather Information', 'Weathers', 'manage_options', 'weathers', 'edit.php?post_type=weather');\n\n\nA: edit.php?post_type=weather isn't a valid PHP function name.\nIf you're trying to set the menu up as a submenu of your custom post screens, I think edit.php?post_type=weather\u2014the $parent_slug\u2014should be the first parameter, not the last. ie,\nadd_submenu_page(\n  'edit.php?post_type=weather',\n  'Weather Information',\n  'Weathers',\n  'manage_options',\n  'weathers',\n  [$this, 'weathers']\n);\n\nReferences\n\n*\n\n*add_submenu_page()\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406265", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Links to previous/next month archives On the month archive page (using the date.php template), how can I add links for the previous month and next month? For example, viewing January 2022 (/2022/01), I'd like a link to December 2021 (/2021/12) and a link to February 2022 (/2022/02).\n\nA: Got it working! It's not pretty but it's functioning.\n$Y = get_the_time( 'Y' );\n$M = get_the_time( 'm' );\n\n$earlier_post = get_posts( [\n    'date_query' => [\n        'before' => [\n            'year'  => $Y,\n            'month' => $M,\n            'day'   => 1,\n        ],\n    ],\n    'orderby'             => 'date',\n    'order'               => 'DESC',\n    'posts_per_page'      => 1,\n    'ignore_sticky_posts' => 1\n] );\n\n$prev_label = get_the_time( 'F', $earlier_post[0] ) . ' ' . get_the_time( 'Y', $earlier_post[0] );\n\nif ( ! empty( $earlier_post ) ) {\n    $previous_month_link = home_url( get_the_time( 'Y', $earlier_post[0] ) . '/' . zeroise( get_the_time( 'm', $earlier_post[0] ), 2 ) );\n    echo '<div class=\"nav-prev\"><a href=\"' . $previous_month_link . '\"><span class=\"nav-title\">' . $prev_label . '</span></a></div>';\n}\n\n$next_post = get_posts( [\n    'date_query' => [\n        'after' => [\n            'year'  => $Y,\n            'month' => $M,\n            'day'   => date( 't', mktime( 23, 59, 59, $M, 1, $Y ) ),\n        ],\n    ],\n    'orderby'             => 'date',\n    'order'               => 'ASC',\n    'posts_per_page'      => 1,\n    'ignore_sticky_posts' => 1\n] );\n\n$next_label = get_the_time( 'F', $next_post[0] ) . ' ' . get_the_time( 'Y', $next_post[0] );\n\nif ( ! empty( $next_post ) ) {\n    $next_month_link = home_url( get_the_time( 'Y', $next_post[0] ) . '/' . zeroise( get_the_time( 'm', $next_post[0] ), 2 ) );\n    echo '<div class=\"nav-next\"><a href=\"' . $next_month_link . '\"><span class=\"nav-title\">' . $next_label . '</span></a></div>';\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406266", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Create a Dropdown Selector and Redirect for a Custom Taxonomy in WordPress? I'm trying to create a dropdown selector on my CPT and CT archive page for a custom taxonomy called \"location\".\nI've managed to get the form to submit, however, it does not direct me to the archive page, rather it directs me to a URL that looks something like this\n\nhttps://example.com/?location=11\n\nI'm wanting the destination URL to be this:\n\nhttps://example.com/location/term-name\n\nBare with me as I have no background in Computer Science / IT so I'm learning on my own.\nBelow is my shortcode to insert it into my website. I have taken portions of this code from WordPress' Category Dropdown Selector and modified it for my Custom Taxonomy.\nfunction insert_location(){\n    ob_start();\n?>\n<form action=\"https://example.com\" method=\"get\">\n    <label class=\"screen-reader-text\" for=\"location\">Locations</label>\n    <select name=\"location\" id=\"location\" class=\"postform\">\n        <?php\n           $tax_terms = get_terms('location', array('hide_empty' => '0'));      \n           foreach ( $tax_terms as $tax_term ):  \n              echo '<option value=\"-1\">Select a Location</option>\n                    <option class=\"level-0\" value=\"'.$tax_term->term_id.'\">'.$tax_term->name.'</option>';   \n           endforeach;\n        ?>\n    </select> \n</form>\n<script type=\"text/javascript\">  \n/* <![CDATA[ */\n(function() {\n    var dropdown = document.getElementById( \"location\" );\n    function onLocChange() {\n        if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {\n            dropdown.parentNode.submit();\n        }\n    }\n    dropdown.onchange = onLocChange;\n})();\n/* ]]> */\n</script>\n<?php\n    return ob_get_clean();\n}\nadd_shortcode('location_filter','insert_location');\n\nAny assistance would be greatly appreciated in helping me to create a dropdown selector that takes visitors to the correct URL, thanks!\n\nA: Never mind!\nI managed to come up with a solution.\nfunction insert_location(){\n    ob_start();\n?>\n    <select name=\"location\" id=\"location\" class=\"postform\">\n        <?php\n           $tax_terms = get_terms('location', array('hide_empty' => '0'));      \n           foreach ( $tax_terms as $tax_term ):  \n              echo '<option value=\"-1\">Select a Location</option><option class=\"level-0\" value=\"'.get_term_link($tax_term).'\">'.$tax_term->name.'</option>';   \n           endforeach;\n        ?>\n    </select> \n<script type=\"text/javascript\">\n    \n/* <![CDATA[ */\n(function() {\n    var dropdown = document.getElementById( \"location\" );\n    function onLocChange() {\n        if ( dropdown.options[ dropdown.selectedIndex ].value != \"-1\" ) {\n            window.location.href = dropdown.options[ dropdown.selectedIndex ].value;\n        }\n    }\n    dropdown.onchange = onLocChange;\n})();\n/* ]]> */\n</script>\n<?php\n    return ob_get_clean();\n}\nadd_shortcode('location_filter','insert_location');\n\nInstead of using the Term ID, I have replaced it with\n.get_term_link($tax_term).\n\nAnd rather than submitting with a form, I have chosen to use the following line of code.\nwindow.location.href = dropdown.options[ dropdown.selectedIndex ].value;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406267", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Bulk-add featured images in posts with no featured image I have a site with loads of posts (news items). Some posts don't have featured images yet. Adding the images to those posts (few hundreds) is a tedious task. We basically want to add 1 and the same image to all the posts without a featured image.\nIs there a way to do this in bulk? Like ADD 'this image' to ALL 'posts' (not pages) WHERE 'featured_image' is empty. I really hope there's a plugin for that. Can't find it though.\n\nA: you can use this plugins as you like :\nhttps://wordpress.org/plugins/default-featured-image/\nhttps://wordpress.org/plugins/auto-post-thumbnail/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406280", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Compare ACF date field (if exists) and post date and order DESC I have an ACF date field (same format as post date) and in my Query I want it to be compared to the publish date of the post:\n\n*\n\n*If erstelldatum is not empty use erstelldatum for order\n\n*If erstelldatum is empty use publish date for order instead\n\n*Order descending\n\nMy code is working so far but the order isn`t right. It lists all posts with erstelldatum first followed by those without. I want them to be ordered descending by the above logic.\nAlso the posts without the ACF field are ordered in a strange way... descending down to 2010 followed by a sudden 2021 and descending from it again.\nHelp is highly appreciated!\nif ( get_query_var('paged') ) {\n    $paged = get_query_var('paged');\n} elseif ( get_query_var('page') ) { // 'page' is used instead of 'paged' on Static Front Page\n    $paged = get_query_var('page');\n} else {\n    $paged = 1;\n}\n  \n$custom_query_args = array(\n    'post_type'     => array( 'post' ),\n    'order'         => 'DESC',\n    'orderby'       => array( 'erstelldatum' => 'DESC', 'date' => 'DESC' ),\n    'posts_per_page' => get_option('posts_per_page'),\n    'paged' => $paged,\n    'meta_query' => array(\n        array(\n            'relation' => 'OR',\n            array(\n                'key'     => 'erstelldatum',\n                'compare' => 'EXISTS',\n            ),\n            array(\n                'key'     => 'erstelldatum',\n                'compare' => 'NOT EXISTS',\n            )\n        )\n\n    ),\n);\n$custom_query = new WP_Query( $custom_query_args );```\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406282", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Should I include colon in my msgid in PO file? Which of the below is recommended when creating msgid a PO file?\nmsgid \"Available Balance:\"\nor\nmsgid \"Available Balance\"\n\nA: The use of each depends on your choice. If, for example, the text is in front of a field, I think it is better to use the symbol:\nIn general, you should see if it really needs it or not. You do not have to use it or not. In the text you sent, the first option is more appropriate because the intention is to display a value in front of or below this text\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406287", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Add email addresses to already registered users my website users register with phone number OTP. That's why they have no email address in their accounts. Today I need email address in user accounts. I use this code to add email address for new user registrations.\nadd_action(\"user_register\", function ($user_id) {\n    $user = get_userdata($user_id);\n    if (empty($user->data->user_email)) {\n        $args = array(\n            \"ID\"         => $user->id,\n            \"user_email\" => uniqid() . \"@example.com\",\n        );\n        wp_update_user( $args );\n    }\n});\nadd_filter( 'bnfw_trigger_insert_post', '__return_true' );\n\nBut I have about 3000 users that need email address in their accounts if empty . How can I do this automatically . Can make above code to work for already registered user.\nand above code generate email like this    62961a20c7f2a@exmaple.com .how can use \"username\" instead of uniqid()\nmy new code according to answer\n      // The Query\n$user_query = new WP_User_Query( ['number' => 3500, 'paged' => 1] );\n\n// if users were found\nif ( ! empty( $user_query->get_results() ) ) {\n    // then for each user\n    foreach ( $user_query->get_results() as $user ) {\n        // if it already has an email, skip it\n        if ( ! empty( $user->user_email ) ) {\n            continue;\n        }\n\n        // otherwise, add an email here...\n         $args = array(\n            \"ID\"         => $user->id,\n            \"user_email\" => $user->user_login . \"@example.com\",\n        );\n        wp_update_user( $args );\n    }\n} else {\n    echo 'No users found.';\n}\n\n\nA: Doing This For a Single User In The user_register Filter\nInstead of using get_userdata in your filter, fetch the user itself as a WP_User object via get_user_by:\n$user = get_user_by( 'id', $user_id );\n\nThis gives you access to all of the fields of WP_User directly, e.g.:\necho $user->user_login;\n\nWhich you can then plug into your code\nDoing this for all the other users\nYou should use WP_User_Query to fetch an array of users that do not have emails ( assuming the email is an empty string ). This would not happen inside your filter and is a separate independent piece of code.\nhttps://developer.wordpress.org/reference/classes/wp_user_query/\nHere's an example from the docs that loops through every user with a blank email and displays their name:\n// The Query\n$user_query = new WP_User_Query( [] );\n\n// if users were found\nif ( ! empty( $user_query->get_results() ) ) {\n    // then for each user\n    foreach ( $user_query->get_results() as $user ) {\n        // if it already has an email, skip it\n        if ( ! empty( $user->user_email ) ) {\n            continue;\n        }\n\n        // otherwise, add an email here...\n    }\n} else {\n    echo 'No users found.';\n}\n\nYou can remove the echo and replace it with your check that tests the email is empty and updates the user.\nNote that since you have a lot of users, you may need to set 'number' => 200, 'paged' => 1, in the WP_User_Query arguments, and re-run the loop several times with paged set to higher numbers. This is to avoid running out of memory.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406288", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: why my must use plugins (mu-plugins) not work at localhost? I have my local WordPress setup I create folder named mu-plugins in wp-content/plugins/mu-plugins and in mu-plugins directory I create one file and write a simple code for test my mu-plugins not work it give no response.\nAny One know what shouuld ? (it work fine in live hosting setup)\n\nA: It does not work because that's not the mu-plugins folder.\nThe mu-plugins folder goes in the wp-content folder at wp-content/mu-plugins.\nNote that mu-plugins is not the same as plugin folder, but rather a place that you can put arbitrary PHP files that are all loaded. Files in subfolders are not loaded, and files are not scanned for plugin headers. E.g. if you copy a plugin folder into wp-content/mu-plugins it will not run as it's in a sub-folder.\n\nAny One know what shouuld ? (it work fine in live hosting setup)\n\nPossibly because your host uses a non-standard custom location that serves the same purpose. It's very likely that there is a wp-content/mu-plugins folder on your host that contains host specific code, and that host specific code is then implementing a custom folder so that clients can still use mu-plugins.\nFor example, sites hosted on WPVIP Go don't have an mu-plugins folder because their Go platform code lives there. Instead customers use client-mu-plugins for the same purpose, but that wouldn't work on other hosts. Your host probably does the same.\nAs a result, when you copy your site to a new host, be that a competing hosting service, or a local hosting environment, it no longer works because it's a non-standard location.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406296", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp_delete_comment takes two tries to delete - then deletes all comments I'm trying to add a button to my comments that allows a user to delete them.\nI have a form declared like so:\n<form method=\"post\">\n  <input type=\"submit\" name=\"btn-delete\" value=\"try-delete\">\n</form>\n\nand above it the following php:\n<?php\n  if (isset($_POST[\"btn-delete\"])) {\n    wp_delete_comment(get_comment_ID(), true);\n  }\n?>\n\nNote this is in my comments.php, and I use the standard API for looping through the comments.\nWhen I click on the button (from the input tag), it reloads the page and does nothing. If I click it again, it deletes all of the comments on the page, rather than just the one comment. How can I fix this?\nThanks in advance.\n\nA: The Insecure Way\nYou need to change your form so that it includes the ID of the comment you want to delete, e.g.:\n<form method=\"post\">\n  <input type=\"hidden\" name=\"comment_id\" value=\"<?php echo get_comment_ID(); ?>\" />\n  <input type=\"submit\" name=\"btn-delete\" value=\"try-delete\"/>\n</form>\n\nWithout this, you have no idea which comment the user wanted to delete.\nThen, you need to move the code that deletes the comment to a hook in functions.php e.g.:\nadd_action( 'init', 'i_am_not_safe_to_use' );\nfunction i_am_not_safe_to_use() {\n    if ( is_admin() ) {\n        return;\n    }\n\n    // only run if we're deleting a comment\n    if ( empty( $_POST['btn-delete'] ) || empty( $_POST['comment_id'] ) ) {\n        return;\n    }\n\n    // TODO, security checks\n\n    // delete the comment\n    $comment_id = intval( $_POST['comment_id'] );\n    wp_delete_comment( $comment_id, true );\n}\n\nThis will work however it is insecure! Now anybody can delete any comment they want by submitting the form!!!\nSecurity\nThe code needs to also do the following:\n\n*\n\n*check that the user has the necessary capability required to delete that comment\n\n*add a nonce to the form\n\n*check the nonce in the hook\n\nAt a minimum, you need this check:\nif ( current_user_can( 'moderate_comments' ) || current_user_can( 'edit_comment', $comment_id ) ) {\n    // then the user has permission to delete the comment\n} else {\n    wp_die( 'sneaky hackers! You are not allowed to delete this comment' );\n}\n\nThe REST API\nIf you send an authenticated DELETE request to the comments REST API at yoursite.com/wp-json/wp/v2/comments/<COMMENT ID GOES HERE> then refresh the page, your comment will be gone.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406298", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom WooCommerce rewrite rules with comma delimiter I'm trying to troubleshoot a wide-scale problem.\nI'd like to rewrite default WooCommerce permalinks for categories, to delimiter as commas.\nLet's take an example:\n\n*\n\n*Brand\n\n*\n\n*Model\n\n*\n\n*Generation\n\n*\n\n*Engine\n\n*\n\n*Product\n\n\n\n\n\n\n\n\n\nThe permalink structure I'd like to have:\n\n*\n\n*/chip-tuning-Ford\n\n*\n\n*/chip-tuning-Ford-Focus\n\n*\n\n*/chip-tuning-Ford-MK3-FL\n\n*\n\n*/chip-tuning-Ford-MK3-FL-1.5TDCi-75kW\n\n*\n\n*/chip-tuning-Ford-MK3-FL-1.5TDCi-75kW-Basic-Box\n\n\n\n\n\n\n\n\n\nI did this via generate_rewrite_rules action, but currently, we have about 4000 categories and 9000 products, so each combination takes a lot of time and space. All rewrite rules by WP default are saved into one field on the DB, so it makes the website very slow.\nAlso, I tried dynamic rules, but it works fine for 1-3 levels and if category names don't have an additional delimiter - replaced by space.\nThe general problem is how to write a dynamic rewrite rule to match a certain category and product. The generator is already written, need a way to save / store / handle it.\nFYI. Categories and products are created via Rest API.\nThanks for your advice!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406299", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Trigger wp-embed via JavaScript to refresh iframe preview? I'm running WordPress 6.0 and using the Block Editor to enable content editors to paste links that generate the embed/iframe preview, as described here.\nI've noticed from time to time (i.e. erratically) the embed script doesn't seem to run, and the link remains as static text without converting into the iframe preview.\nI'm also using Swup.js to handle page transitions throughout the site, and I'm wondering if wp-embed has a method of some kind that I can hook into to force the script to run and/or refresh the iframe preview?\nIf one exists, I could simply run the function by hooking into a Swup event, as described here. Thanks for any insight!\n*Edit: I should add that the links in question are just URLs to other web sites- not social links, YouTube, etc.\n\nA: Unfortunately WP Embed isn't responsible for converting links into iframes.\nThe conversion of links and [embed] shortcodes into iframes is implemented by OEmbed and that happens via OEmbed APIs on the_content filter in PHP, not javascript.\nIt's much more likely that your transitioning to pages that use raw post content rather than processed/rendered content, e.g. templates that incorrectly use echo get_the_content(); or echo $post->post_content; to display their data, or use the raw content from the REST API. This is because those methods don't pass the content through the_content filter which converts links to OEmbeds, processes shortcodes, and renders server rendered blocks etc\nWP Embed deals with iframes that already exist and helps with handling embed height. It already has DOM event listeners for when new DOMContent is loaded.\nTriggering WP Embed is not your problem or the solution you are looking for, and your problem has nothing to do with WP Embed. You will need to look elsewhere to diagnose what is happening.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406303", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add php code to wp_print_scripts? Is there a way to add inline php code to the editor using wp_print_scripts? I'm trying to find a way to display text from a php string into a value of input of a block.\nHere's my code:\nfunction shapeSpace_print_scripts() { \n?>\n<?php $block_yt_url = 'test';?>\n<script>\n    jQuery(document).ready(function ($) {\n        let $yt_url = false;\n        $(document).on( \"click\", '#yt_run .acf-button-group', function() {\n            $(\".editor-post-publish-button__button\").hide();\n            $(\".acf-block-body div div.acf-block-fields.acf-fields div.acf-field.acf-field-text.acf-field-6260f423f1666\").css({'height':'inherit','padding':'16px 20px','overflow':'inherit'});\n            $(\".acf-block-body div div.acf-block-fields.acf-fields div.acf-field.acf-field-text.acf-field-6260f423f1666\").val(<?php echo $block_yt_url;?>);\n            $('#yt_url .acf-input input').keyup(function(e) {\n            if(e.keyCode == 13) {\n                $yt_url = true;\n            };\n            if(e.keyCode == 46) {\n                $yt_url = true;\n            };\n            if(e.keyCode == 8) {\n                $yt_url = true;\n            };\n            checkStatus();\n            });   \n        });\n        function checkStatus(){\n            if($yt_url) {\n                $(\".editor-post-publish-button__button\").show();\n            }\n        }\n    });\n</script>\n<?php\n}\nadd_action('wp_print_scripts', 'shapeSpace_print_scripts');\n\n\nA: You can use admin_footer or admin_head like below. This code only run on admin. You can also use for frontend by using wp_head or wp_footer\nfunction shapeSpace_print_scripts() { \n    $block_yt_url = 'test'; ?>\n    <script>\n        jQuery(document).ready(function ($) {\n            let $yt_url = false;\n            $(document).on( \"click\", '#yt_run .acf-button-group', function() {\n                $(\".editor-post-publish-button__button\").hide();\n                $(\".acf-block-body div div.acf-block-fields.acf-fields div.acf-field.acf-field-text.acf-field-6260f423f1666\").css({'height':'inherit','padding':'16px 20px','overflow':'inherit'});\n                $(\".acf-block-body div div.acf-block-fields.acf-fields div.acf-field.acf-field-text.acf-field-6260f423f1666\").val(<?php echo $block_yt_url; ?>);\n                $('#yt_url .acf-input input').keyup(function(e) {\n                if(e.keyCode == 13) {\n                    $yt_url = true;\n                };\n                if(e.keyCode == 46) {\n                    $yt_url = true;\n                };\n                if(e.keyCode == 8) {\n                    $yt_url = true;\n                };\n                checkStatus();\n                });   \n            });\n            function checkStatus(){\n                if($yt_url) {\n                    $(\".editor-post-publish-button__button\").show();\n                }\n            }\n        });\n    </script>\n    <?php\n}\nadd_action('admin_footer', 'shapeSpace_print_scripts');\n\nIf you want it will only load on specific post type editor screen you can add condition like below, I added it for page edit screen only:\nif (isset($_GET['post'])) {\n    $post_id = $_GET['post'];\n    $post_type = get_post_type($post_id);\n    if ($post_type !== 'page') {\n        return;\n    }\n}\n\nThis above code is just for idea how you can specifically execute your JS on post type editor.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406304", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: setcookie on WordPress Page Template I am having an issue with setcookie.\nI need to set a cookie on a page action (form).\nI have tried on the template file, but not working.\nthen find out if I set it from functions.php with init hook, it's working.\nthen I put condition like\nif(is_page_template('mytemplate.php')){...\n\nthen it's not working.\nhow can I do that?\nhere is my code.\nadd_action( 'init', 'hello_my_cookie' );\n\nfunction hello_my_cookie() {\n    if(is_page_template('mytemplate.php')){\n        if(isset($_POST['GGmyCookie'])){\n            setcookie( 'myCookie','Hello Cookie!', time()+3600);\n            \n        }\n    }\n    \n}\n\n\nA: This fails because the init hook is far too early to call is_page_template. Conditionals such as this function use the main query to decide their value, but WordPress hasn't created the main query yet.\nThe earliest hook you can safely do this is template_redirect.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406305", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP Search Form Query: Add Author's posts into search query As the title suggests, I'm looking for WordPress advice relative to leveraging the standard searchform.php functionality to additionally query the author field when performing searches. I've tried various different means to do this without any success, and so I'm coming to quite the headache. Below are the template files used:\nsearchform.php\n<?php\n/**\n * Template for displaying search forms in Twenty Seventeen\n *\n * @package WordPress\n * @subpackage Twenty_Seventeen\n * @since 1.0\n * @version 1.0\n */\n\n?>\n\n<?php $unique_id = esc_attr( uniqid( 'search-form-' ) ); ?>\n\n<div class=\"global-search\">\n  <form role=\"search\" method=\"get\" class=\"search-form\" action=\"<?php echo esc_url( home_url( '/' ) ); ?>\">\n    <label for=\"<?php echo $unique_id; ?>\">\n      <span class=\"screen-reader-text sr-only\"><?php echo _x( 'Search for:', 'label', 'sdwp' ); ?></span>\n    </label>\n    <input type=\"search\" id=\"<?php echo $unique_id; ?>\" class=\"search-field\" value=\"<?php echo get_search_query(); ?>\" name=\"s\" />\n    <button type=\"submit\" class=\"search-btn\"><i class=\"fas fa-search\"></i><span class=\"screen-reader-text sr-only\"><?php echo _x( 'Search', 'submit button', 'sdwp' ); ?></span></button>\n  </form>\n</div>\n\nfunctions.php - the bit of code I've written up after much reiteration\nfunction add_author_to_query( $query ) {\n\n  //do not run on admin side\n  if( is_admin() ) return;\n\n  if ( $query->is_main_query() && $query->is_search() ) {\n\n    $submitted_data = get_search_query();\n\n    // Get all users who may match the submitted data\n    $users = new WP_User_Query( array(\n      'search' => $submitted_data,\n      'search_columns' => array( 'user_login', 'user_nicename')\n    ) );\n    $authors = $users->get_results();\n\n    foreach($authors as $author) {\n      $author_ids[] = $author->ID;\n    }\n\n    if( ! empty( $authors ) ) {\n        $query->set('post_type', array( 'post', 'article', 'page', 'bio', 'author', 'article_type'));\n        $query->set( 'author__in', $author_ids );\n        // $query->set( 'author__in', $authors );\n    }\n}\nadd_action( 'pre_get_posts', 'add_author_to_query' );\n\n\nA: For anyone else that stumbles upon this, @admcfajn posted a comment to my question which solved my problem. Below is the code block found in the commented link, attributed to \"danielbachhuber\" github user:\n/**\n * Include posts from authors in the search results where\n * either their display name or user login matches the query string\n *\n */\nfunction db_filter_authors_search( $posts_search ) {\n\n    // Don't modify the query at all if we're not on the search template or if the LIKE is empty\n    if ( !is_search() || empty( $posts_search ) ) return $posts_search;\n\n    global $wpdb;\n\n    // Get all of the users of the blog and see if the search query matches either the display name or the user login\n    add_filter( 'pre_user_query', 'db_filter_user_query' );\n\n    $search = sanitize_text_field( get_query_var( 's' ) );\n\n    $args = array(\n        'count_total' => false,\n        'search' => sprintf( '*%s*', $search ),\n        'search_fields' => array(\n            'display_name',\n            'user_login',\n        ),\n        'fields' => 'ID',\n    );\n\n    $matching_users = get_users( $args );\n\n    remove_filter( 'pre_user_query', 'db_filter_user_query' );\n\n    // Don't modify the query if there aren't any matching users\n    if ( empty( $matching_users ) ) return $posts_search;\n\n    // Take a slightly different approach than core where we want all of the posts from these authors\n    $posts_search = str_replace( ')))', \")) OR ( {$wpdb->posts}.post_author IN (\" . implode( ',', array_map( 'absint', $matching_users ) ) . \")))\", $posts_search );\n    return $posts_search;\n}\nadd_filter( 'posts_search', 'db_filter_authors_search' );\n\n/**\n * Modify get_users() to search display_name instead of user_nicename. Helper function used inside of db_filter_authors_search()\n */\nfunction db_filter_user_query( &$user_query ) {\n\n    if ( is_object( $user_query ) )\n        $user_query->query_where = str_replace( \"user_nicename LIKE\", \"display_name LIKE\", $user_query->query_where );\n    return $user_query;\n}\n\n** minor adjustments have been made by me, in the form of spacing and consolidating lines, to make the code more legible.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406310", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Proxy External API request in PHP from Edit.js in Block Plugin I'm working with a third-party API that has optional filters on their API. I'm creating a block where the user has two select elements in Edit.js that are displayed on the backend of the block. They can select filters, specialty, and location, these values are then stored in attributes.\nOnce a user changes a select, I want to fire off a PHP request using these attributes passed to the PHP function that uses wp_remote_get() to build the proxy and dump the data into the rest point.\nI have the Edit.js function setup but am unsure how to call the PHP function from the Edit.js file with the passed block attributes.\n\nA: Okay, I figured it out!\nFirst, I created a rest endpoint in PHP.\nhttps://github.com/bbuilds/ih-top-nurses-block/blob/main/inc/rest.php#L11\nThe rest point has optional parameters using regex and then in the register_rest_route() callback builds a fetch URL depending on the parameters passed to the WP-REST endpoint.\nIt then fires to the external API wp_remote_get($fetch_url) and dumps the data into the REST endpoint.\nhttps://github.com/bbuilds/ih-top-nurses-block/blob/main/src/edit.js#L77\nThen in my block edit function, I set up the internal rest API call using apiFetch from \"@wordpress/api-fetch\" using a similar buildFetch API.\nFull repo: https://github.com/bbuilds/ih-top-nurses-block\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406311", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get product categories and add them to a custom taxonomy I'm working on a WooCommerce webshop.\nI have divided all my products into categories. Example:\nClothing:\n-Tshirts\n-Jeans\n-Etc.\nLikewise, all brands are also divided into categories. Example:\nBrands\n-Brand1\n-Brand2\n-Etc.\nI want to copy or mirror the category and sub-categories of \"Brands\" to a custom taxonomy.\nSo when I have a product in the \"Brand 1\" category, then this product must be automatically entered into a custom taxonoy with the same name: \"Brand 1\"\nThe products in woocommerce are created by an API from a POS system.\nThe reason why Brands is created in categories is that the API from the POS system can only use \"categories\" in wordpress and not custom taxonomies or attributes.\nIt's not optimal to use multiple parent categories as I use an Ajax filter (YITH WooCommerce Ajax Product Filter) to filter my products.\nSo in general, the category \"Brands\" should somehow be mirrored to a custom taxonomy of the same name or something similar.\nIs that even possible? And does anyone know how to achieve this? Or does anyone have a better idea?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406314", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: For some time, some of my pages do not display the content anymore. Any idea where this could be coming from? I recently worked on this website : https://semaine.com/\nBut since some time the content of the pages https://semaine.com/classroom/ and https://semaine.com/cinema/ are not displayed anymore.\nThe pages load, the navbar and the footer are there but not the content.\nIt works locally on my computer with MAMP but not online.\nI tried several things like disabling various plugins, re-generating links, restoring the theme from my local version, ...\nHere is the content of the cinema.php file:\n<?php \n/**\n\u00a0* Template Name: cinema\n * description: cinema\n\u00a0*/\n?> \n\n<?php get_header(); ?>\n\n<?php \n\n  if($_GET && $_GET['categories']){\n\n      $cat = $_GET['categories'];\n\n    }\n\n      // args\n      $args = array(\n        // 'numberposts' => -1,\n        'posts_per_page'=> -1,\n        'post_type'   => 'tastemakers_people',\n        'category_name'  => $cat,\n        'order'       => 'DESC',\n      );\n\n// query\n$the_query = new WP_Query( $args );\n\n?>\n\n<div class=\"tastemakers_video\">\n\n <div class=\"tastemakers_people_header styleBB\" style=\"display:none;\">\n <a class=\"header_all\" href=\"<?php echo site_url(); ?>/cinema/\">all/</a><a class=\"header_art\" href=\"<?php echo site_url(); ?>/cinema/?categories=art\">art/</a><a class=\"header_music\" href=\"<?php echo site_url(); ?>/cinema/?categories=music\">music/</a><a class=\"header_philosopy\" href=\"<?php echo site_url(); ?>/cinema/?categories=philosophy\">think/</a><a class=\"header_fashion\" href=\"<?php echo site_url(); ?>/cinema/?categories=fashion\">fashion/</a><a class=\"header_healthrx\" href=\"<?php echo site_url(); ?>/cinema/?categories=healthrx\">healthRx/</a><a class=\"header_cinema\" href=\"<?php echo site_url(); ?>/cinema/?categories=cinema\">cinema/</a><a class=\"header_food\" href=\"<?php echo site_url(); ?>/cinema/?categories=food\">food/</a><a class=\"header_business\" href=\"<?php echo site_url(); ?>/cinema/?categories=business\">business/</a><a class=\"header_lovesex\" href=\"<?php echo site_url(); ?>/cinema/?categories=love&sex\">love&sex/</a>\n\n  </div>\n\n  <?php\n    wp_nav_menu( array( \n      'theme_location' => 'menu-sub-nav-cinema', \n      'container_class' => 'sub-nav' \n      )\n    ); \n  ?>\n\u00a0\n\n <div class=\"cinema\">\n\n  \n\n  <?php if( $the_query->have_posts() ): ?>\n      <?php while( $the_query->have_posts() ) : $the_query->the_post(); ?>\n      \n        <?php if( get_field('watch_copy') ): ?>\n        \n            <!-- <?php the_field('watch_copy'); ?> -->\n            <div class=\"tastemaker_video_holder\">\n            <div class=\"video_intro\"><?php the_field('watch_intro'); ?></div>\n          \n               <div class=\"video\">\n\n\n               <div class=\"video_holder\"><iframe width=\"100%\" height=\"100%\" src=\"https://www.youtube.com/embed/<?php the_field('watch_copy'); ?>\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe></div>\n\n              </div>\n            </div>\n\n          \n\n      <?php endif; ?>\n\n     <?php endwhile; ?>  \n\n     </div>  \n\n   <?php else: \n\n    echo '<div class=\"error\">Sorry. There is no content for this category</div>';\n\n\n    ?>\n\n    <?php endif; ?>\n \n\n</div>\n\n<?php get_footer(); ?>\n\nHere is a part of the error_log file :\n[26-May-2022 19:17:18 UTC] WordPress database error Commands out of sync; you can't run this command now for query SHOW FULL COLUMNS FROM `wp_options` made by shutdown_action_hook, do_action('shutdown'), WP_Hook->do_action, WP_Hook->apply_filters, Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\Autoloader::Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\{closure}, Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\Plugins_Handler->cache_plugins, set_transient, update_option\n[28-May-2022 08:00:54 UTC] WordPress database error Commands out of sync; you can't run this command now for query UPDATE `wp_options` SET `option_value` = 'a:0:{}' WHERE `option_name` = '_transient_jetpack_autoloader_plugin_paths' made by shutdown_action_hook, do_action('shutdown'), WP_Hook->do_action, WP_Hook->apply_filters, Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\Autoloader::Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\{closure}, Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\Plugins_Handler->cache_plugins, set_transient, update_option\n[28-May-2022 08:02:13 UTC] WordPress database error Commands out of sync; you can't run this command now for query SHOW FULL COLUMNS FROM `wp_options` made by shutdown_action_hook, do_action('shutdown'), WP_Hook->do_action, WP_Hook->apply_filters, Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\Autoloader::Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\{closure}, Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\Plugins_Handler->cache_plugins, set_transient, update_option\n[28-May-2022 08:04:11 UTC] WordPress database error Commands out of sync; you can't run this command now for query UPDATE `wp_options` SET `option_value` = 'a:1:{i:0;s:29:\\\"{{WP_PLUGIN_DIR}}/woocommerce\\\";}' WHERE `option_name` = '_transient_jetpack_autoloader_plugin_paths' made by shutdown_action_hook, do_action('shutdown'), WP_Hook->do_action, WP_Hook->apply_filters, Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\Autoloader::Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\{closure}, Automattic\\Jetpack\\Autoloader\\jpdb897b9c8e0c5079b17448f17a52683a\\Plugins_Handler->cache_plugins, set_transient, update_option\n[31-May-2022 10:34:43 UTC] PHP Notice:  ID was called <strong>incorrectly</strong>. Product properties should not be accessed directly. Backtrace: require('wp-blog-header.php'), require_once('wp-includes/template-loader.php'), include('/plugins/woocommerce/templates/single-product.php'), wc_get_template_part, load_template, require('/plugins/woocommerce/templates/content-single-product.php'), do_action('woocommerce_single_product_summary'), WP_Hook->do_action, WP_Hook->apply_filters, add_progress, WC_Abstract_Legacy_Product->__get, wc_doing_it_wrong Please see <a href=\"https://wordpress.org/support/article/debugging-in-wordpress/\">Debugging in WordPress</a> for more information. (This message was added in version 3.0.) in /home/semainec/public_html/wp-includes/functions.php on line 5229\n[31-May-2022 10:34:43 UTC] PHP Notice:  product_type was called <strong>incorrectly</strong>. Product properties should not be accessed directly. Backtrace: require('wp-blog-header.php'), require_once('wp-includes/template-loader.php'), include('/plugins/woocommerce/templates/single-product.php'), wc_get_template_part, load_template, require('/plugins/woocommerce/templates/content-single-product.php'), do_action('woocommerce_single_product_summary'), WP_Hook->do_action, WP_Hook->apply_filters, woocommerce_template_single_add_to_cart, do_action('woocommerce_external_add_to_cart'), WP_Hook->do_action, WP_Hook->apply_filters, woocommerce_external_add_to_cart, WC_Product_External->single_add_to_cart_text, apply_filters('woocommerce_product_single_add_to_cart_text'), WP_Hook->apply_filters, {closure}, WC_Abstract_Legacy_Product->__get, wc_doing_it_wrong Please see <a href=\"https://wordpress.org/support/article/debugging-in-wordpress/\">Debugging in WordPress</a> for more information. (This message was added in version 3.0.) in /home/semainec/public_html/wp-includes/functions.php on line 5229\n[31-May-2022 10:34:43 UTC] PHP Notice:  product_type was called <strong>incorrectly</strong>. Product properties should not be accessed directly. Backtrace: require('wp-blog-header.php'), require_once('wp-includes/template-loader.php'), include('/plugins/woocommerce/templates/single-product.php'), wc_get_template_part, load_template, require('/plugins/woocommerce/templates/content-single-product.php'), do_action('woocommerce_single_product_summary'), WP_Hook->do_action, WP_Hook->apply_filters, woocommerce_template_single_add_to_cart, do_action('woocommerce_external_add_to_cart'), WP_Hook->do_action, WP_Hook->apply_filters, woocommerce_external_add_to_cart, wc_get_template, include('/themes/Blank-Theme/woocommerce/single-product/add-to-cart/external.php'), do_action('woocommerce_before_add_to_cart_button'), WP_Hook->do_action, WP_Hook->apply_filters, WC_Points_Rewards_Product->render_product_message, apply_filters('wc_points_rewards_single_product_message'), WP_Hook->apply_filters, {closure}, WC_Abstract_Legacy_Product->__get, wc_doing_it_wrong Plea in /home/semainec/public_html/wp-includes/functions.php on line 5229\n[31-May-2022 10:35:58 UTC] PHP Notice:  wpdb::prepare was called <strong>incorrectly</strong>. The query only expected one placeholder, but an array of multiple placeholders was sent. Please see <a href=\"https://wordpress.org/support/article/debugging-in-wordpress/\">Debugging in WordPress</a> for more information. (This message was added in version 4.9.0.) in /home/semainec/public_html/wp-includes/functions.php on line 5229\n\n\nA: I found, it was really simple.\nIt was simply my pages that did not load the template by default. The cinema page was not loading cinema.php, I simply renamed cinema.php to page-cinema.php and it works again.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406315", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to host your WordPress theme on github and make my theme updatable for my client I'm currently developing an WordPress theme for a client of mine. I want it to be hosted on GitHub, so my client can update the theme whenever I release a new update of the theme.\nThe problem is that I don't know how to host a theme on GitHub and have a private key saved in the code somewhere, without anyone can see it.\nCan someone help me out? Thanks in advance!\n\nA: You can use WP Pushar to update the theme from github. It will give you synchronize button in the dashboard to synchronize it with github repo.\nHere is overview video you can use WP Pusher with your site.\nHere is article that explaining how you can update theme from github using WP Pusher. Also watch that video to understand it more clearly. Video\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406320", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress: redirecting to my old public ip I started to develop my own wordpress site, that I hosted locally. I am using Apache for hosting and mariaDB for DB. I accessed the site through my public ip, that in my case was was xxx.xxx.1.163. I could also access my site thorugh 127.0.0.1. I set the wordpress site up and everything worked fine.\nPROBLEM\nUntil I moved from one place to another with my computer. Now I can not access my site anymore. I have been struggling with the problem for 2 days now. Now my public ip is xxx.xxx.1.110. Problems that occur, when I try to access site:\nAccsessing through browser\n\n*\n\n*When i try to access through 127.0.0.1, then it automatically redirects me to xxx.xxx.1.163, although I have erased all the Firefox\ncache, history and cookies.\n\n\n*When i try to access through xxx.xxx.1.110, then it also redirects me to xxx.xxx.1.163\nI have tried the same in Chrome also. Results are the same.\nWhat I have tried and outlined:\nApache working fine -\nWhen I have only apache's index.html file in /var/www/html directory, then I am able to access the default Apache page through 127.0.0.1 and through my current public ip xxx.xxx.1.110. Like this everything seems fine.\nOriginal wordpress - When I move original wordpress files to /var/www/html directory, then then from 127.0.0.1 and xxx.xxx.1.110 the wordpress first setup page appears. Like this everything seems also to be fine.\nWhen I try to set up the wordpress, with the same database connection that i had the last one, then it thorws error and says \"Wordpress already installed\". And now, when I try to connect to 127.0.0.1 or xxx.xxx.1.110 then it automatically redirects me to my old public ip xxx.xxx.1.163\nWhen I move my own wordpress project(the project that I had before and was working) to the /var/www/html folder, then the same thing happens. I keep getting redirected to xxx.xxx.1.163\nMY IDEA OF SOLUTION\nMy idea is that i would probably have to make some changes in my wordpress database and maybe in my wordpress conf files. But I have no idea where I should change and what I should change. I have looked it up also but I have found very different answers.\nIf somebody could tell me, if I am moving in correct direction or what exactly should I change, then I would be very thankful.\n\nA: UPDATE\nFound and Fixed the problem. The thing was that yes all the sources in wordpress database pointed to old public ip xxx.xxx.1.163. Which had to be changed.\nThe things that had to be changed was:\n\n*\n\n*In wp_options\n\n\n*\n\n*Change siteurl\n\n\n*Change home url\n\n\n*In wp_posts\n\n\n*\n\n*replace all the old public ip with new public ip\n\nFor me as newbie the easiest way to do this was using GUI, for example phpmyAdmin\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406331", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I add  tags to entire comments, not just their text Thanks to some wonderful help here at stack exchange, I have built a comment section with a dropdown menu that adds comment_meta to the comments.\nI currently have a working filter that uses GET to trigger an if statement to query based on this comment_meta info. The thing I don't like is that it refreshes the page each time you click a button. I'm looking for a way to filter without having the page refresh. I think I need Javascript for this.\nI've set up two sets of buttons. The top row is my GET buttons, which work, but refresh the page. The bottom row are my javascript buttons. I can get them to filter the text WITHIN the comments, but I'd like them to filter the entire contents instead.\nFor instance, if you go to Madonna's page (https://staging3.recordcollectorsoftheworldunite.com/artist/madonna/), and scroll down to the comments, they don't even show up until you press 'show all'. Once you press \"Show All\" it looks right, but again when you filter, it only filters the comments.\nI've added 3 photos to the bottom of this post.\n-First photo is when the page loads, how all the comments are hidden- I'd like \"ALL\" to automatically be selected when the page loads. I tried <button class='button active'> but that must not be the right way to say it.\n-Second photo is when \"SHOW ALL\" is clicked\n-Third photo is when \"BUY\" is clicked.\nHere's my comments.php\n<?php\ncomment_form();\nif (have_comments()) : ?>\n    <div class=\"container\">\n        <div class=\"btn-group flex\">\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=ALL'\">SHOW ALL</button>\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=BUY'\">BUY</button>\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=SELL'\">SELL</button>\n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=TRADE'\">TRADE</button>  \n            <button type=\"button\" onclick=\"window.location.href='<?php echo the_permalink();?>/?cmeta=TALK'\">TALK</button>  \n        </div>  \n    </div>\n    <hr>\n    <div class=\"container\">\n        <div class=\"btn-group flex\">\n            <button class=\"button active\" onclick=\"filterSelection('all')\"> Show all</button>\n            <button class=\"button\" onclick=\"filterSelection('BUY')\"> BUY</button>\n            <button class=\"button\" onclick=\"filterSelection('SELL')\"> SELL</button>\n            <button class=\"button\" onclick=\"filterSelection('TRADE')\"> TRADE</button>\n            <button class=\"button\" onclick=\"filterSelection('TALK')\"> TALK</button>\n        </div>  \n    </div>\n    <style>\n    .filterDiv {\n    \n    display: none;\n    }\n\n    .show {\n    display: block;\n    }\n\n    .container {\n    margin-top: 20px;\n    overflow: hidden;\n    }\n\n    </style>\n    <script>\n    filterSelection(\"all\")\n    function filterSelection(c) {\n    var x, i;\n    x = document.getElementsByClassName(\"filterDiv\");\n    if (c == \"all\") c = \"\";\n    // Add the \"show\" class (display:block) to the filtered elements, and remove the \"show\" class from the elements that are not selected\n    for (i = 0; i < x.length; i++) {\n        w3RemoveClass(x[i], \"show\");\n        if (x[i].className.indexOf(c) > -1) w3AddClass(x[i], \"show\");\n    }\n    }\n\n    // Show filtered elements\n    function w3AddClass(element, name) {\n    var i, arr1, arr2;\n    arr1 = element.className.split(\" \");\n    arr2 = name.split(\" \");\n    for (i = 0; i < arr2.length; i++) {\n        if (arr1.indexOf(arr2[i]) == -1) {\n        element.className += \" \" + arr2[i];\n        }\n    }\n    }\n\n    // Hide elements that are not selected\n    function w3RemoveClass(element, name) {\n    var i, arr1, arr2;\n    arr1 = element.className.split(\" \");\n    arr2 = name.split(\" \");\n    for (i = 0; i < arr2.length; i++) {\n        while (arr1.indexOf(arr2[i]) > -1) {\n        arr1.splice(arr1.indexOf(arr2[i]), 1);\n        }\n    }\n    element.className = arr1.join(\" \");\n    }\n\n    // Add active class to the current control button (highlight it)\n    var btnContainer = document.getElementById(\"myBtnContainer\");\n    var btns = btnContainer.getElementsByClassName(\"btn\");\n    for (var i = 0; i < btns.length; i++) {\n    btns[i].addEventListener(\"click\", function() {\n        var current = document.getElementsByClassName(\"active\");\n        current[0].className = current[0].className.replace(\" active\", \"\");\n        this.className += \" active\";\n    });\n    }\n    </script>\n    <?php\n    if(isset($_GET['cmeta'])){\n    \n        $commentmeta=$_GET['cmeta'];\n        if($commentmeta=='ALL'){\n            $wantto= get_comment_meta( $comment_id, 'wantto', true );\n            $args = array(\n            'post_id' => get_the_ID(),\n            \n        );\n        }else{\n            $wantto= get_comment_meta( $comment_id, 'wantto', true );\n            $args = array(\n            'post_id' => get_the_ID(),\n            'meta_query' => array(\n            \n                array(\n                    'key' => 'wantto',\n                    'value' => $commentmeta,\n                ),\n                \n            )\n        );\n        }\n        $comment_query = new WP_Comment_Query( $args );\n        $comments = $comment_query->comments;\n            echo '<ol class=\"post-comments\">';\n                wp_list_comments(array(\n                    'style'       => 'ol',\n                    'short_ping'  => true,\n                ));\n                echo $wantto;\n                \n        echo '</ol>';\n        /* much simpler one to style probably\n                        if ( $comments ) {\n                    foreach ( $comments as $comment ) {\n                        echo '<p>' . $comment->comment_content . '</p>';\n                    }\n                } else {\n                    echo 'No comments found.';\n                }\n        */\n    }else{\n\n        $wantto= get_comment_meta( $comment_id, 'wantto', true );\n        echo '<ol class=\"post-comments\">';\n                wp_list_comments(array(\n                    'style'       => 'ol',\n                    'short_ping'  => true,\n                ));\n                echo $wantto;\n                \n        echo '</ol>';\n    }\nendif;\n    $comment_id=get_comment_ID();\n    echo $wantto;\n    \n?>\n\nHere's the section from my functions.php that adds the dropdown menu, and filters by type. I've added the filterDiv tag in the second function of this part. Where I have it now only filters the text, I'd like it to filter the entire comment itself.\n\n/*\n * This will add the fields to the comment form\n*/\nfunction wpse406058_custom_comment_fields() {\n\n    echo '<p class=\"comment-form-wantto\">';\n    echo '<label for=\"wantto\">Tag your comment so other users can find your post.<br>I want to</label>';\n    echo '<select id=\"wantto\" name=\"wantto\" class=\"myclass\">';\n        echo '<option value=\"---\">---</option>';\n        echo '<option value=\"BUY\">BUY</option>';\n        echo '<option value=\"SELL\">SELL</option>';\n        echo '<option value=\"TRADE\">TRADE</option>';\n        echo '<option value=\"TALK\">TALK</option>';\n    echo '</select>';\n  \n      \n}\nadd_action( 'comment_form_logged_in_after', 'wpse406058_custom_comment_fields' );\nadd_action( 'comment_form_after_fields', 'wpse406058_custom_comment_fields' );\n\n/*\n * This will field value as comment meta\n*/\nfunction wpse406058_save_custom_field($comment_id) {\n\n    if ( isset($_POST['wantto']) && !empty($_POST['wantto']) ) {\n        $wantto = sanitize_text_field($_POST['wantto']);\n        update_comment_meta( $comment_id, 'wantto', $wantto );\n        \n    }\n    \n}\nadd_action( 'comment_post', 'wpse406058_save_custom_field' );\n\n\nfunction wpse406058_display_comment_meta( $comment_text ) {\n    \n    $wantto = get_comment_meta( get_comment_ID(), 'wantto', true );\n  \n    if ( isset($wantto) && !empty($wantto) ) {\n        \n        $wanttotext = '<p class=\"wantosec\">I want to ' . esc_html($wantto) . '</p>';\n        ?><div class=\"filterDiv <?php echo $wantto;?>\"><?php\n        $comment_text = $wanttotext . $comment_text;\n    }\n   echo '<div class=\"container\">';\n    return $comment_text;\n    echo '</div>';\n    echo '</div>';\n}\nadd_filter( 'comment_text', 'wpse406058_display_comment_meta' );\n\n\n\n\n\nA: Currently your comment markup looks similar to the following:\n<li class=\"comment byuser comment-author-rcotwunite odd alt thread-odd thread-alt depth-1\" id=\"comment-7902\">\n  <div id=\"div-comment-7902\" class=\"comment-body\">\n    <div class=\"comment-author vcard\"><!-- ... --></div>\n    <div class=\"comment-meta commentmetadata\"><!-- ... --></div>\n    <div class=\"filterDiv SELL show\">\n      <div class=\"container\">\n        <p class=\"wantosec\">I want to SELL</p>\n        <p>SUP YALL im here to sell some stuff</p>\n        <div class=\"reply\"><!-- ... --></div>\n      </div>\n    </div>\n  </div>\n</li>\n\nAnd the JS which is targeting elements to show/hide:\nfunction filterSelection(c) {\n  var x, i;\n  x = document.getElementsByClassName(\"filterDiv\");\n\n  if (c == \"all\") c = \"\";\n  \n  // Add the \"show\" class (display:block) to the filtered elements, and remove the \"show\" class from the elements that are not selected\n  for (i = 0; i < x.length; i++) {\n    w3RemoveClass(x[i], \"show\");\n    if (x[i].className.indexOf(c) > -1) w3AddClass(x[i], \"show\");\n  }\n}\n\nSo the issue is that the class you're using to target elements to show/hide is only applied to a descendant child of the element which represents the full comment (the <li> encapsulating the whole entry, here).\n\nJS DOM Traversal\nOne solution to targeting that encapsulating <li> instead would be to keep the markup as it is and use the properties on DOM elements to traverse up to the ancestral <li> (though this isn't terribly efficient):\nfunction filterSelection(c) {\n  var x, i;\n  x = document.getElementsByClassName(\"filterDiv\");\n\n  if (c == \"all\") c = \"\";\n  \n  // Add the \"show\" class (display:block) to the filtered elements, and remove the \"show\" class from the elements that are not selected\n  for (i = 0; i < x.length; i++) {\n    w3RemoveClass(x[i].parentElement.parentElement, \"show\");\n    if (x[i].parentElement.parentElement.className.indexOf(c) > -1) \n      w3AddClass(x[i].parentElement.parentElement, \"show\");\n  }\n}\n\n\nCustomize Comment Markup\nBut perhaps a better solution is to use wp_list_comments()'s callback argument to specify a function to customize each comment's generated markup and apply your HTML classes derived from comment meta-data to the entire comment container instead of just the body.\nThe best way to start might be to simply copy the function body over from the Walker_Comment::comment() method, which is otherwise responsible for rendering comment markup. And then we'll tweak it to add a couple classes to the containing element if your comment meta exists (I've added PHP comments to designate my modifications):\n// functions.php\n\nfunction wpse406332_render_comment( $comment, $args, $depth ) {\n  if ( 'div' === $args['style'] ) {\n        $tag       = 'div';\n        $add_below = 'comment';\n    } else {\n        $tag       = 'li';\n        $add_below = 'div-comment';\n    }\n \n    $commenter          = wp_get_current_commenter();\n    $show_pending_links = isset( $commenter['comment_author'] ) && $commenter['comment_author'];\n\n    // Set up an array to contain classes to be applied to the `<li>`.\n    $classes = [];\n\n    if( $this->has_children )\n      array_push( $classes, 'parent' );\n\n    // Check for trade meta\n    $wantto = get_comment_meta( get_comment_ID(), 'wantto', true );\n\n    // If trade meta is set, add \"filterDiv\" and trade type to class list.\n    if ( isset($wantto) && !empty($wantto) )\n      array_push( $classes, 'filterDiv', $wantto );\n \n    if ( $commenter['comment_author_email'] ) {\n        $moderation_note = __( 'Your comment is awaiting moderation.' );\n    } else {\n        $moderation_note = __( 'Your comment is awaiting moderation. This is a preview; your comment will be visible after it has been approved.' );\n    }\n    ?>\n\n    // Finally, add our modified class list to the comment container.\n    <<?php echo $tag; ?> <?php comment_class( $classes, $comment ); ?> id=\"comment-<?php comment_ID(); ?>\">\n    <?php if ( 'div' !== $args['style'] ) : ?>\n    <div id=\"div-comment-<?php comment_ID(); ?>\" class=\"comment-body\">\n    <?php endif; ?>\n    <div class=\"comment-author vcard\">\n        <?php\n        if ( 0 != $args['avatar_size'] ) {\n            echo get_avatar( $comment, $args['avatar_size'] );\n        }\n        ?>\n        <?php\n        $comment_author = get_comment_author_link( $comment );\n \n        if ( '0' == $comment->comment_approved && ! $show_pending_links ) {\n            $comment_author = get_comment_author( $comment );\n        }\n \n        printf(\n            /* translators: %s: Comment author link. */\n            __( '%s <span class=\"says\">says:</span>' ),\n            sprintf( '<cite class=\"fn\">%s</cite>', $comment_author )\n        );\n        ?>\n    </div>\n    <?php if ( '0' == $comment->comment_approved ) : ?>\n    <em class=\"comment-awaiting-moderation\"><?php echo $moderation_note; ?></em>\n    <br />\n    <?php endif; ?>\n \n    <div class=\"comment-meta commentmetadata\">\n        <?php\n        printf(\n            '<a href=\"%s\">%s</a>',\n            esc_url( get_comment_link( $comment, $args ) ),\n            sprintf(\n                /* translators: 1: Comment date, 2: Comment time. */\n                __( '%1$s at %2$s' ),\n                get_comment_date( '', $comment ),\n                get_comment_time()\n            )\n        );\n \n        edit_comment_link( __( '(Edit)' ), ' &nbsp;&nbsp;', '' );\n        ?>\n    </div>\n \n    <?php\n    comment_text(\n        $comment,\n        array_merge(\n            $args,\n            array(\n                'add_below' => $add_below,\n                'depth'     => $depth,\n                'max_depth' => $args['max_depth'],\n            )\n        )\n    );\n    ?>\n \n    <?php\n    comment_reply_link(\n        array_merge(\n            $args,\n            array(\n                'add_below' => $add_below,\n                'depth'     => $depth,\n                'max_depth' => $args['max_depth'],\n                'before'    => '<div class=\"reply\">',\n                'after'     => '</div>',\n            )\n        )\n    );\n    ?>\n \n    <?php if ( 'div' !== $args['style'] ) : ?>\n    </div>\n    <?php endif; ?>\n    <?php\n}\n\nNow modify your wp_comment_list() calls to use the modified render function instead of Walker_Comment's (you'll also want to remove the code which adds those classes to the comment text container from your wpse406058_display_comment_meta() function):\n// template file\n\n// ...\nwp_list_comments(array(\n  'style'       => 'ol',\n  'short_ping'  => true,\n  'callback'    => 'wpse406332_render_comment',\n));\n// ...\n\n\nWrap-Up\nThis is by no means an exhaustive list of possibilities. Another solution which wouldn't include modifying the comment markup would be to build a mapping of trade types to <li> elements on page load (using that DOM traversal technique from above), then just referring to those arrays when you need to show/hide comments.\nAll in all I think customizing the comment markup is the most robust solution, and one which can enable you to further tweak the display for your unique comments use-case (though if your modifications eventually lead to a massive departure from the intent of a simple comment, you might at some point consider using a dedicated post-type for the purpose).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406332", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress cron job running more than once I developed a plugin to read some XML files and publish their itens as post but for some reason, sometimes, it is duplicating posts. Basically that is what I have:\n// function one is scheduled (hourly) and unscheduled on plugin activation and deactivation hooks\nregister_activation_hook(__FILE__, 'function_one_activation');\nregister_deactivation_hook(__FILE__, 'function_one_deactivate');\n\nfunction function_one_activation() {\n    if (!wp_next_scheduled('function_one_cron')) {\n        wp_schedule_event(time(), 'hourly', 'function_one_cron');\n    }\n}\n\nfunction function_one_deactivate() {\n    $timestamp = wp_next_scheduled('function_one_cron');\n    wp_unschedule_event($timestamp, 'function_one_cron');\n}\n\nadd_action('function_one_cron', 'one');\nadd_action('function_two_cron', 'two');\nadd_action('function_three_cron', 'three');\n\nfunction one() {\n    // download XML files using CURL and save on server\n    // schedule cron to run function two after 60 seconds\n    if(!wp_next_scheduled('function_two_cron')) {\n        wp_schedule_single_event(time() + 60, 'function_two_cron');\n    }\n}\n\nfunction two() {\n    // get an array from DB of posts saved from XML files\n    // get and run each file and check if item is new (is not on array above) and save it as post, if already posted remove it ID from array\n    // save the \"new\" array\n    // schedule cron to run function three after 60 seconds\n    if(!wp_next_scheduled('function_three_cron')) {\n        wp_schedule_single_event(time() + 60, 'function_three_cron');\n    }\n}\n\nfunction three() {\n    // get the remain ID from array above and delete posts\n}\n\nDoes anyone know what I am missing that makes it runs twice sometimes or how can I prevent it to happens?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406336", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Does WordPress being under GPL actually necessitate that the tools created for it (plugins, themes) must also be under GPL? Is so, then why? I'm confused about this idea that because WordPress is under GPL, the plugins and themes all have to be under GPL as well. My understanding of GPL includes that you can't distribute something that is partially GPL and partially proprietary; but if you distribute a proprietary plugin, shouldn't it be fine for a user to use that plugin within their GPL copy of WordPress? The problem should only arise if the user tries to distribute their WordPress installation along with the proprietary plugin, because now they are distributing something that violates GPL. Hosting a website that uses both GPL and proprietary content does not violate the GPL license as hosting a site is not usually interpreted as distribution of its content (clearly, copyrights still apply).\nIf WordPress won't allow you to add a plugin to https://wordpress.org/plugins/ that isn't GPL, that's fine. But there isn't anything wrong with sharing a proprietary plugin elsewhere, right?\nMaybe if your proprietary plugin calls a WordPress function, say, wp_get_current_user(), then someone could claim that your plugin violates GPL because it references something from GPL while being itself proprietary? I'm not sure of this, but it's the best explanation I've thought of.\nIn refutation to the suggestion in my last paragraph, here is an analogous situation: https://askubuntu.com/questions/346514/is-steam-for-linux-an-open-source-application-does-it-deserve-to-be-on-linux. Linux is under GPL; Steam for Linux is not. Like what I had been suggesting in the case of WordPress plugins, it's up to the user whether they will use it.\n\nA: The official WP line is that if you want to share sell or distribute your plugin/theme, then the PHP code must be GPL compatible. This is because GPL is a copyleft licence. The WP project, maintainers, and governance follow the same interpretation of this that the FSF and others do, the same interpretation being used to sue the TV maker Vizio in court for not distributing source despite using opensource libraries.\nSome people may disagree with this interpretation, but that is a legal subject and beyond the scope of this site. I am not a lawyer and it is for the judge in that case to set the precedent.\nYour other points though, are covered by the FAQ on the GNU website:\nhttps://www.gnu.org/licenses/gpl-faq.html\nThe GPL does not prevent you from selling themes and plugins, and going non-GPL does not prevent piracy or provide other protections ( and it's questionable that a \"proprietary\" licence would even be valid or enforceable ). The biggest businesses in the WP ecosystem still make plenty of money with GPL source code.\nWhat I can say is that:\n\n*\n\n*Your plugin will never be allowed on wordpress.org\n\n*Other marketplaces will probably not host you\n\n*Other plugin businesses in the WP ecosystem will not want to do business with you, limiting your ability to promote and cross-sell\n\n*Applications to speak or volunteer at official WordPress conferences will be blocked\n\n*Sponsoring official WordPress events will be impossible\n\n*Many prominent community members will see it as a hostile and unnecessary step\n\n*Many large agencies will avoid your product\n\n*Larger enterprise businesses will have compliance issues around this\n\n*Some hosts may refuse to allow your code\n\n*Many will consider it a sign of shady practices\n\n*Some businesses that have made a point of not using GPL compatible licenses have had... not so pleasant interactions with the BDFL\n\nIf despite this, you still wish to pursue a proprietary licence that is not compatible with the GPL, and distribute this, you should seek legal advice from a lawyer specialising in these matters. You shouldn't be asking for legal advice online.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406337", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: Query multiple post types, but different order for each I have a query which searches 2 post types as below:\n$args = array(\n    'post_type'              => ['post', 'promotion'],\n    'posts_per_page'         => 12,\n    'paged'                  => $paged,\n    's'                      => isset($_GET['search']) ? $_GET['search'] : '',\n);\n\nThis orders them by default, by published date.\nI need to add a third post type events. This however needs to be sorted by a custom field event_date asc and to disregard those which the event_date is in the past. Does anyone have any suggestions on how this could be done? While keeping the pagination and search.\nThanks in advance\nF\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406338", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress 6.0 upgrade caused my custom function to stop working Not working on WordPress 6.0:\nhttps://thealliance.health/for-providers/resources/provider-news-archives/\nWorking dev site on WordPress 5.9.3: https://ccahdev.wpengine.com/for-providers/resources/provider-news-archives/\nHere is the function if somebody can spot what may have been deprecated:\nfunction wpb_postsbycategory2022() {\n\n$posts = get_posts( array(\n    'category_name' => 'Provider News',\n    'nopaging'  => true,\n    'orderby'   => 'date',\n    'order'     => 'DESC', // it's DESC; not DSC\n    // There's no use setting posts_per_page when nopaging is enabled.\n    // Because posts_per_page will be ignored when nopaging is enabled.\n) );\n\n$_year_year = '';   // previous years value\n$_year_mon = '';   // previous year-month value\n$_has_grp = false; // TRUE if a group was opened\n$_has_grpy = false; // TRUE if a group was opened\n    \n    \nforeach ( $posts as $post ) {\n    setup_postdata( $post );\n\n    $time = strtotime( $post->post_date );\n    $year = date( 'Y', $time );\n    $mon = date( 'F', $time );\n    $year_mon = \"$year-$mon\";\n    $year_year = \"$year\";\n    \n    // Open a new group for year.\n    if ( $year_year !== $_year_year ) {\n        // Close previous group, if any.\n        if ( $_has_grpy ) {\n            echo '</div><!-- .year -->';\n        }\n        $_has_grpy = true;\n\n        echo \"<div class='year' id='year$year'>\";\n        echo \"<h2>$year</h2>\";\n    }\n    \n    \n    if ( $year_mon !== $_year_mon) {\n        // Close previous group, if any.\n        $_has_grp = true;\n\n        echo '<div class=\"month\">';\n        echo \"<span>$mon</span>\";\n    }\n\n// Display post title.\nif ( $title = get_the_title() ) {\n    echo \"<div><a href='/?p={$post->ID}'>{$post->post_title}</a></div>\";\n    }   \n    \n    if ( $year_mon !== $_year_mon) {\n        // Close previous group, if any.\n            echo '</div><!-- .month -->';\n    }\n    \n    $_year_mon = $year_mon;\n    $_year_year = $year_year;\n}\n\n// Close the last group, if any.\n// \n    \nif ( $_has_grpy ) {\n    echo '</div>';\n}\n    \n    \n/* Restore original Post Data */\n    \n$output_string = ob_get_contents();\nob_end_clean();\nreturn $output_string;\n    \nwp_reset_postdata();\n}\n// Add a shortcode\nadd_shortcode('categoryposts2022', 'wpb_postsbycategory2022');\n\nThank you for any assistance!\n\nA: Can't see anything deprecated, but I have spotted these:\n\n*\n\n*category_name expects (confusingly) the category slug, so the value should (most likely) be provider-news and not Provider News\n\n\n*If you're using setup_postdata it's best to also manually set the global $post too to ensure interoperability of template functions - just put global $post; inside the start of your wpb_postsbycategory2022 function.\n\n\n*The line wp_reset_postdata() is after a return statement at the end of the function, so it will never be called! Move the return $output_string; line to the very end of your function.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406342", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to replace username with email address in users table I have a custom built site that does not use usernames and everything requires use of their email address.  The username is auto generated and looks bad in the table.\nI know there are filters and actions to work with custom columns within the users table but I have been looking for a way to replace the username with the email address.\nI know I can unset the username using manage_users_columns filter but I then loose the row actions.\nIs there a way to accomplish this without rewriting wordpress core functions?\nEdit - Clarification:  I am looking to replace the username column in the users.php table.\n\nA: It seems that the username column content is hardcoded in single_row() of WP_Users_List_Table and there isn't a filter you can use to change it.\nA hacky way is to enqueue some javascript on the users view and have the script change the content.\nOr take the rocky road by duplicating the code that handles the row actions in single_row(), and replace the default column with a custom one showing the email and the actions.\nOr just brute force the email as the username with wp_pre_insert_user_data filter.\n\nA: function wpse406344_replace_usernames() {\n    \n    //Get all the users\n    $users = get_users();\n    \n    //Loop through them and update user_login table\n    foreach( $users as $user ) {\n        wp_insert_user(array(\n            'ID' => $user->ID,\n            'user_login' => $user->user_email,\n        ));\n    }\n    \n}\nadd_action( 'init', 'wpse406344_replace_usernames' );\n\nYou need to run this only once. After successful execution, remove this. Also note, this will only update existing users. If you want to set username for future registrations, you can use the user_register hook.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406344", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get authors who have added the post in the specific custom post type I have a custom post called event and I have to show all the authors who have added the post. I have tried the below code but I am getting all the users on the page.\nFor example. There are 4 users called A, B, C, and D on the website and A and B added the post.\nNow I have to get only A and B  users but below code getting all the users like A,B,C,D\nAny idea how to get the user to add the post in the event post type.\n$users = get_users( array( 'fields' => array( 'ID','display_name' ),'order' => 'ASC', 'who' =>'authors' ));\n\n    foreach ($users as $user){\n    $userid=$user->ID;\n    //echo  $post_count = count_user_posts($userid);\n    echo '<li><a href=\"'.esc_url(get_author_posts_url($userid)).'\">'.$user->display_name.'</a></li>';\n         }\n\n\nA: When you say \"who have added the post\", are you meaning all users who have written at least 1 post of the event post type? If so, you can get all the authors of all events like so:\n$event_posts = get_posts([\n    'post_type' => 'event', // Or whatever your event post type is\n    'numberposts' => -1,\n]);\n\n// Get all the author (user) IDs of all events\n$event_author_ids = wp_list_pluck( $event_posts, 'post_author' );\n\n// Now get all the user objects\n$users = get_users([\n    'include' => $event_author_ids,\n]);\n\nAlternatively, if you are meaning the author of the current event post, there can only ever be one author per-post, and you can just use the author template tags whilst in the loop.\necho get_the_author_link();\n// Get author <a /> HTML\n\necho get_the_author_meta( $prop );\n// Get author property e.g. display_name, user_email, first_name etc.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406346", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: excude a specidic category from showing in the \"relative posts\" I have a post slider on the homepage that shows a specific category (slider).\nThe thing is that I do not want this category to appear on other pages (except homepage) because I have  \"relevant posts\" at the bottom of every blog category post and it is mixing it up.\nAny suggestions?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406350", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add nonce tag to inline script for CSP Is it possible to add nonce tag to inline scripts for wordpress sites using ?\nI have used a filter script_loader_tag + function for adding tags before but it adds nonce tag only to  with src tag. Unfortunately I cant add nonce tag to inline javascript automatically :(\nSo I need a script for some filter which would add nonce tag automatically to  tag.\n\nA: You can use the script_loader_tag filter:\nfunction wpse_406351_script_tag_nonce( $tag, $handle ) {\n    if ( $handle === 'id_of_script' /* handle used in wp_enqueue_script/wp_register_script */ ) {\n        $nonce = wp_create_nonce(); // Or whatever your nonce value should be\n\n        $tag = str_replace( '<script ', \"<script nonce='$nonce' \", $tag );\n    }\n\n    return $tag;\n}\n\nadd_filter( 'script_loader_tag', 'wpse_406351_script_tag_nonce', 10, 2 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406351", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Restrict Custom Post Type per role in Dashboard I would like to set up some restrictions on how some roles can access given posts to edit in Dashboard.\nI have a custom post type affiliates having 2 nested levels.\nCustom Role User Editor should be able to edit under a level all posts but the normal editor should have access just on items defined by a custom field relation user - post_id\nIs there an easy way to implement this\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406352", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Online wc-blocks-style.css rendering instead of the hosted wc-blocks-style.css On my archive page is a sidebar which has a style I want to edit. On my local machine, the style is in wc-blocks-style.css. I edited it successfully and it renders fine. However, after deployment of the website to CPanel, the style is being rendered from an online wc-blocks-style.css. The style link is as follows:\n<link rel='stylesheet' id='wc-blocks-style-css'  href='https://c0.wp.com/p/woocommerce/6.5.1/packages/woocommerce-blocks/build/wc-blocks-style.css' media='all' />. All other Woocommerce styles are also loaded from this online repository.\nMy question is, how do I make my page render the hosted wc-blocks-style.css instead of loading from that online repository? I tried looking for the header file so I can edit it there but couldn't locate where the archive product's header is.\nKindly help. Thanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406356", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Make the home page's slug visible in the browser's URL bar Is it possible to show the WordPress home page slug visible in the URL bar? I mean when someone visits my WordPress website home page rather than displaying (considering that my website URL is website.com) \"website.com\" it must shows \"website.com/home-slug\" in the browser URL bar.\nNote:\n\n*\n\n*I am using a static page as the home page and my permalink uses \"post-name\".\n\n*I am not looking for a way to hide the home slug but a way to make it\nvisible in the browser URL bar every time someone visits the website\nor clicks on the home page link on the website.\n\nExample: leviatanscans.com\nSorry for my bad English.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406359", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp_nav_menu displaying all pages As the title says, I'm using wp_nav_menu in header.php to load in the audience, secondary, and main menus and when I do, every menu contains every page - or at least many more pages than I selected for the menus.\nI'm having the hardest time trying to make this work for some reason, so any help is appreciated. Here's the code to register the menus in functions.php:\n// WordPress Menu Locations\nfunction diviecommerce_setup() {\nregister_nav_menus(array(\n    'primary' => esc_html__( 'Main Menu', 'diviecommerce' ),\n    'audience' => esc_html__( 'Audience', 'diviecommerce' ),\n    'secondary' => esc_html__( 'Secondary', 'diviecommerce' ),\n    'footer ' => esc_html__( 'Footer', 'diviecommerce' ),\n));\n}\nadd_action('after_setup_theme', 'diviecommerce_setup');\n\nAnd here's the code in the template:\n<div class=\"top\">\n    <?php wp_nav_menu( array('theme_location' => 'audience', 'container_class' => 'audience' ) ); ?>\n    <div class=\"header-right\">\n        <?php wp_nav_menu( array('theme_location' => 'secondary', 'container_class' => 'account-cart' ) ); ?>\n        <?php et_show_cart_total(); ?>\n    </div>\n    </div>\n    <nav><?php wp_nav_menu( array('theme_location' => 'primary', 'container_class' => 'main' ) ); ?></nav>\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406360", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Getting featured image with PHP and not javascript from wordpress api _embed Not having access to the functions file, I can't add the function to add the featured image to the API so I need to use wp-json/wp/v2/posts?_embed.\nWith javascript I believe it is ._embedded['wp:featuredmedia']['0'].source_url so I tried with php after using wp_remote_get, $post->_embedded['wp:featuredmedia'][0]->source_url but the error I am getting is :\n\nCannot use object of type stdClass as array\n\n\nA: One approach is to cast the objects as arrays. I recently had to do this in a project where I retrieved a list of articles and needed to display the featured image. There may be alternate ways to handle this issue, but I've found it to be reliable. Here is some relevant code from the project.\n<?php\n  foreach ($articles as $index => $article) {\n    $article = (array)($article);\n    $embedded = (array)$article['_embedded'];\n    $featuredMedia = (array) $embedded['wp:featuredmedia'][0];\n    $mediaDetails = (array) $featuredMedia['media_details'];\n    $sizes = (array) $mediaDetails['sizes'];\n    $mediumLarge = (array) $sizes['medium_large'];\n\n    $article_content = \"\n      <div class='col-xs-12 col-md-$count'>\n        <a href='\" . $article['link'] . \"'>\"\n          . \n          \"<img src='\" . $mediumLarge['source_url'] .  \"'/>\".\n          \"<p>\" . $article['title']->rendered . \"</p>\n        </a>\n      </div>\n      \";\n    echo $article_content;\n  }\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406361", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add new users to \"add new user\" page on admin's dashboard I understand there's a lot of similar questions, but all of them show how to update the wp_usermeta table in the database, whereas I want to use wp_update_user() to update a particular field (nickname <-> user_nicename) in the wp_users table. Here is my snippet, (which I have collected from other similar questions) it appends the new field to the \"add new user\" page, but it doesn't save the information in the database with wp_update_user().\nP.S.: I also would like to say, as a note, that I can fully grasp the function to append a new field, but I'm completely in the dark about the other one, to save the field, as I can't really understand how the id is captured when you press submit (I just copied and pasted the novo_gravar function and tried to change update_user_meta() with wp_update_user())\n<?php\nadd_action( 'user_new_form', 'novo_campo' );\n\nfunction novo_campo()\n{\n?>    \n\n<table class=\"form-table\">\n    <tbody>\n    <tr class=\"form-field\">\n        <th scope=\"row\"><label for=\"cpf\">CPF </label></th>\n        <td><input name=\"cpf\" type=\"text\" id=\"cpf\" value=\"\"></td>\n    </tr>    \n    </tbody>\n</table>\n\n<?php   \n}\n\n//  process the extra fields for new user form\nadd_action( 'user_register', 'novo_gravar');\nfunction novo_gravar($user_id)\n{\n    \n    wp_update_user(     \n                     array( 'ID' => $user_id,\n                            'user_nicename' => $_POST['cpf'])\n                   );\n    \n}\n\n\nA: Check out the source of wp-admin/user-new.php. You'll see WP uses the function edit_user to create the user in the database.\nIf you inspect the source of edit_user(), you'll see the best candidate is a hook called user_profile_update_errors. We can use that with something like:\n\nfunction wpse_406364_save_nicename( $errors, $update, $user ) {\n    if ( ! $update ) {\n        $user->user_nicename = sanitize_text_field( filter_input( INPUT_POST, 'cpf' ) );\n    }\n}\n\nadd_action( 'user_profile_update_errors', 'wpse_406364_save_nicename', 10, 3 );\n\nThat will set the user_nicename user field to the value of the cpf POST input, and only on user creation.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406364", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Restrict editing of post type to list stored in user meta What is the right action to invoke before a custom post type is getting edited in dashboard and contains the argument the post id? The url /wp-admin/post.php?post=282&action=edit&classic-editor\nhere is what I try\n    $userId = get_current_user_id();\n    $affiliate = get_field('field_627ff399b5ef6', 'user_' . $userId);\n\n    $this->currentAffiliate = $affiliate;\n\n    $subPages = get_children([\n        'post_parent' => $affiliate[0]->ID,\n        'post_type' => 'affiliate',\n    ]);\n\n    $pageIds = collect($subPages)->pluck('ID')->push($affiliate[0]->ID)->toArray();\n\nif edit page ID is not in $pageIds redirect to the not allowed screen\n\nA: Ideally access controls would be implemented via WordPress's Roles and Capabilities system. But in highly-granular cases such as limiting access to a single post to a few users, the map_meta_cap filter can be used to shim in additional restrictions.\nIn this case, when WordPress is testing an edit_post capability for a user/post combination, we can deny access based on your custom meta field:\nfunction wpse406371_restrict_affiliate_page_edit( $caps, $cap, $user_id, $args ) {\n  if( $cap !== 'edit_post' )\n    return $caps;\n\n  $post_id = $args[0];\n\n  if( get_post_type( $post_id ) !== 'affiliate' )\n    return $caps;\n\n  $affiliate = get_field( 'field_627ff399b5ef6', 'user_' . $user_id );\n\n  if( empty( $affiliate ) )\n    return $caps;\n\n  $affiliate_page_id = $affiliate[0]->ID;\n\n  if( $post_id == $affiliate_page_id )\n    return $caps;\n\n  $affiliate_child_page_ids = get_children([\n    'post_type'   => 'affiliate',\n    'post_parent' => $affiliate_page_id,\n    'fields'      => 'ids',\n  ]);\n\n  if( !in_array( $post_id, $affiliate_child_page_ids ) )\n    $caps[] = 'do_not_allow';\n\n  return $caps;\n}\n\nadd_filter( 'map_meta_cap', 'wpse406371_restrict_affiliate_page_edit', 10, 4 );\n\nThe above will be executed whenever WordPress tests a user's capabilities for an action. In the cases that the capability check is not for editing a post, the post is not an affiliate-type, or the user does not have field_627ff399b5ef6 meta-data, the check will return the unmodified capabilities early in order to mitigate additional work.\nChecking if the post being edited is the parent affiliate post is performed early in order to skip the post query if possible.\nI've also added the 'fields' => 'ids' argument to the child page query to save on overhead by only retrieving post IDs instead of querying full rows - but I still feel this could be an overly-expensive operation on a capabilities check. You might consider caching the post IDs in user meta sometime in the future should you determine that the query adds notable overhead.\nFinally, if the current post's ID is not present in the queried ID list, the function adds the do_not_allow capability which will natively deny the user access. This will effect all core methods of editing a post - the Quick Edit form, via REST API, etc.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406371", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Get Posts, Including Private Ones? Currently in one of my php files, I retrieve all of the public posts like this:\n$posts = get_posts(array(\n    'posts_per_page' => -1,\n    'post_type' => 'post'\n));\n\nHowever, this only returns public posts, and I would like to store all posts, both public and private, in the $posts variable. How can I accomplish this?\n\nA: Set the post_status argument to an array of desired post status strings, or to the string any to query regardless of status entirely:\n$posts = get_posts(array(\n    'posts_per_page' => -1,\n    'post_type'      => 'post',\n    'post_status'    => array( 'publish', 'private' ),\n));\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406373", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress backend is loading as a list So my backend is loading as just a bullet list, front end seems to be working fine. I'm not sure what made this happen. I've checked WordPress Integrity and it says it's fine. I've Reinstalled WordPress Core but it does nothing. Debugging shows nothing wrong. I've deactivated everything that does nothing to fix it. please help I can't seem to find any solutions for this problem as I can't find anyone else that has had this problem...\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406375", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: delete duplicates wp_postmeta I'm looking to cleanup wp_postmeta. I've found dozens of duplicate entries.\nI've spend about 8 hours looking through topics and trying code and plugins to no avail.\nThe most useful article on the subject I found is this.\nHowever the article is from 5 years ago and I'm not sure that the suggested code leaves at least 1 entry from each duplicate. Also the plugin that is suggested (Cleanup Duplicate Meta) is exactly what I need, but it hasn't been updated for 7 years. The plugin tells me there are over a million duplicates, but when I click to clean it up, nothing happens.\nCan someone confirm that\nDELETE FROM `wp_postmeta` WHERE `meta_id` NOT IN (SELECT * FROM (SELECT MAX(`pm`.`meta_id`) FROM `wp_postmeta` pm GROUP BY `pm`.`post_id`, `pm`.`meta_key`) x)\n\nwill delete the duplicates but leave at least 1 entry of each?\n\n\nA: This should do it:\nDELETE t1 FROM wp_postmeta t1, wp_postmeta t2 \nWHERE t1.meta_id > t2.meta_id \nAND t1.meta_key = t2.meta_key \nAND t1.post_id = t2.post_id\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406381", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to output child block attributes on a parent block I have a custom Gutenberg block that contains a list of InnerBlocks (all the same known block), and I am trying to output the title attribute from each of those blocks in a list on the parent block.\nI'm trying to get values from the innerblocks and add them to an array attribute on the parent block,\nThis is a simplified version of the parent block edit.js\nconst Edit = ( props ) => {\n    const { attributes: { childValuesArray }, setAttributes } = props;\n    const blockProps = useBlockProps();\n    const ALLOWED_BLOCKS = [ 'custom/child-block' ];\n\n    const { clientId } = props;\n    const { select } = wp.data;\n    const parentBlock = select( 'core/block-editor' ).getBlocksByClientId( clientId )[ 0 ];\n    const childBlocks = parentBlock.innerBlocks;\n\n    childBlocks.map(block => {\n        childValuesArray.push( block.attributes.title, block.clientId );\n    });\n    props.setAttributes({ 'childValuesArray': childValuesArray });\n\n    return (\n        <div { ...blockProps }>\n            <div className=\"block-content\">\n                <InnerBlocks allowedBlocks={ ALLOWED_BLOCKS } />\n            </div>\n            <aside>\n                {\n                    childValuesArray.map( (block, index) => {\n                        return (\n                            <p id={ block.clientId }>\n                                { block.title }\n                            </p>\n                        )\n                    })\n                }\n            </aside>\n        </div>\n    );\n};\n\nexport default Edit;\n\nThe issue I'm having is that the code to grab the child block values runs continuously, so the array of values keeps getting bigger.\nResearch suggests that I should maybe be using withDispatch to avoid the code running every time, but the documentation is rather brief, and I haven't been able to work out how to do this correctly.\nIs withDispatch the right approach here? If so, how do I go about using it? If not, what's a better approach?\n\nA: \nIt's worth a mention that storing child block attributes in the parent block's attributes is a bit of a bizarre practice in isolation - ideally blocks should be completely independent of one-another. But if some functionality necessitates that a parent block access a child block's attributes, it would likely have a much smaller potential for headaches down the road to just read the attributes from the child blocks as necessary rather than duplicating the data into parent block attributes.\n\nIn short, you need to create a subscription which will re-render the component when changes occur in editor state by using either the useSelect() hook or the withSelect() HOC factory (I've written a brief introduction to the concepts behind these functions over here).\nWhile a subscription to getBlocksByClientId( parent_block_client_id ) would be perfectly functional as the parent block's state becomes \"dirty\" when any change is made is made to a child block, I think a getBlocks( parent_block_client_id ) selector is a little cleaner as you don't have to traverse down to the innerBlocks array, and additionally the subscription won't trigger a re-render when any modification is made to the parent block.\nIn order to reduce overhead, it would be a good practice to place your logic which updates your attributes in a useEffect() hook with a dependency on the child block list such that it only occurs when the child blocks change.\nimport { useBlockProps, InnerBlocks } from '@wordpress/block-editor';\nimport { useSelect } from '@wordpress/data';\nimport { useEffect } from '@wordpress/element';\n\nconst Edit = ( { attributes, clientId, setAttributes, ...props } ) => {\n  const { child_values } = attributes;\n  const child_blocks = useSelect(\n    select => select( 'core/block-editor' ).getBlocks( clientId )\n  );\n\n  useEffect(\n    () => {\n      const child_values = child_blocks.map(\n        ( { clientId, attributes: { title } } ) => ( { clientId, title } )\n      );\n      setAttributes( { child_values } );\n    },\n    [ child_blocks ]\n  );\n\n  return (\n    <div {...useBlockProps()}>\n      <div className=\"block-content\">\n        <InnerBlocks />\n      </div>\n      <aside>\n      {child_values.map( ( { clientId, title }, index ) => (\n        <p id={ clientId } key={ index }>{title}</p>\n      ))}\n      </aside>\n    </div>\n  );\n}\n\nexport default Edit;\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406384", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: How to save template data into wp_post table (post_content column) Is there a way to save template data into wp_post table? \nI made a custom template that automatically makes tables and some sentences with the meta-data that users insert in.\nI wanted to make users choose a template and write in a standardized format with custom field.\n\nUsers can now just put some text on my custom field (bottom of my post edit page) and click the template on the sidebar, then the contents show on the post page!\nAnd part of my code on single.php (post page) is this and this is working perfectly.\n<?php the_content();    \n                    if ( is_page_template('hkb-templates/coin-info-template.php') ) { \n                    hkb_get_template_part( 'coin-info-template' );\n                    }\n                    else {\n                    }\n                ?>\n\nHowever, I noticed that with this code, table of content plugin doesn't work :( . I realized TOC plugin checks the contents inside of wp_post table (post_content column) but my template does not save the data into SQL database. It just make contents displayed on the post page. So my content is invisible to TOC plugin. Any suggestions or ideas to solve this problem? Please help me.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406388", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Run the edit function of parent block when something changes in InnerBlocks I have a Gutenberg block with a couple of inner blocks (using InnerBlocks from @wordpress/block-editor).\nIn the edit function, I pull the attributes of all inner blocks and put them in an array.\nThere is one case when it doesn't work.\nIf I create a new inner block in WordPress admin, then change some settings inside this block, then not clicking anywhere else, click the \"Update\" button, the attributes of the last inner block will not be pulled because between changing settings inside this block and clicking \"Update\" the edit function of the parent block didn't run.\nIs there any way to trigger the edit function of the parent block in case of changing any attribute in any of the inner blocks?\nHere is how the edit function of the parent block looks now:\n\nimport { InnerBlocks } from '@wordpress/block-editor'\nimport { select } from '@wordpress/data'\nimport { __ } from '@wordpress/i18n'\n\nconst EditWrapperBlock = ({\n    setAttributes,\n    attributes,\n    clientId\n  }) => {\n\n  const {\n    innerBlocks\n  } = attributes\n\n  const parentBlock = select( 'core/block-editor' ).getBlocksByClientId( clientId )[ 0 ];\n  const childBlocks = parentBlock ? parentBlock.innerBlocks : [];\n  const newInnerBlocks = []\n  childBlocks.forEach(element => {\n    const postType = element.name.slice(element.name.indexOf('/') + 1)\n    const childBlockAttributes = {postType, ...element.attributes}\n    newInnerBlocks.push(childBlockAttributes)\n  });\n\n  if (innerBlocks\n      && childBlocks\n      && childBlocks.length > 0\n      && (innerBlocks.length !== childBlocks.length || JSON.stringify(innerBlocks) !== JSON.stringify(newInnerBlocks))) {\n    setAttributes({ innerBlocks: newInnerBlocks })\n  }\n\n\n  return (\n    <>\n      <div className='wrapper-editor'>\n        <InnerBlocks\n          allowedBlocks={[\n            'blocks/block1',\n            'blocks/block2',\n            'blocks/block3',\n          ]}\n          template={[\n            ['blocks/block']\n          ]}\n        />\n      </div>\n    </>\n  )\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406390", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Do I have to use load_plugin_textdomain() or is there any default folder for languages? When I develop a plugin, do I always have to use:\nload_plugin_textdomain('whatever', '', 'whatever/languages');\n\nOr is there any setup, so that I put my translations into a specific folder with a specific name and they get loaded by default with the domain being the plugin slug?\nReason is, I don't like to use that second deprecated paramenter. I prefer to omit the whole call to the function if a default setup exists.\n\nA: Yes but it is not useful if you plan to bundle your language files with your plugin:\nhttps://developer.wordpress.org/reference/functions/load_plugin_textdomain/\n\nIf the path is not given then it will be the root of the plugin directory.\n\nSo it will look in wp-content/plugins\nThe third parameter is only used if you want to use a subfolder.\nLikewise, if a file exists at wp-content/languages/plugins/ that matches your text domain and locale then it will be loaded.\n\nAlthough, you can just pass false as the second parameter, the only reason it's throwing deprecation warnings is because you've passed ''.\nSo pass false for the second parameter, and use the 3rd parameter. The two parameters behave differently so changing the second parameters behaviour would have been a break in backwards compatibility. So a 3rd parameter was added and the second was deprecated. This doesn't mean you need to avoid the function, just pass false ( passing false is not deprecated ).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406391", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: 404 in gutenberg autosave of a Custom Post Type with custom rest_namespace I'm having some troubles with CPTs defined with custom rest_namespace at register_post_type. I keep getting an 404 error at the console. The error shows that the namespace is not being changed in autosave route.\nWP default namespace: wp/v2\nCustom namespace defined: ek/v1\nI dug into the core classes to find how Wordpress handle custom namespace.\nThe WP_REST_Autosaves_Controler define the namespace using get_post_type_object at the __construct method:\n...\n$post_type_object = get_post_type_object( $parent_post_type );\n....\n$this->namespace = ! empty( $post_type_object->rest_namespace ) ? $post_type_object->rest_namespace : 'wp/v2';\n...\n\nIf I do a discovery request at the ek/v1 I can see the endpoints registered correctly:\n\"/ek/v1/releases/(?P<parent>[\\\\d]+)/autosaves/(?P<id>[\\\\d]+)\"\n\nBut in the console this error pops up:\nGET http://localhost:8888/wp-json/wp/v2/releases/70/autosaves?context=edit&_locale=user 404 (Not Found)\n\nSo, why the default namespace persist if I did all right?\nWould it be some javascript function of wordpress that would be doing the request on the incorrect route? What function? How to fix it?\n\n\nA: \nSo, why the default namespace persist if I did all right? Would it be some javascript function of wordpress that would be doing the request on the incorrect route? What function? How to fix it?\n\nIf the endpoint works then you changed it correctly, but if you've flushed rewrite rules/permalinks, and it still isn't working, then you need to raise a bug with the Gutenberg github, or the official WP Trac.\nNote that this is assuming you're only trying to change the REST API endpoint of a single custom post type, and doing it via register_post_type and the rest_namespace parameter with WP 5.9/6 or higher.\nOtherwise, it looks based on this code that you have found a WordPress/Gutenberg bug with retrieving autosaves:\nhttps://github.com/WordPress/gutenberg/blob/c0df23894233e851f3fe734358831ad560a18448/packages/core-data/src/resolvers.js#L332\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406393", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Display if author page is author page of current user in my multi author website I have a button that users can upload their avatars. I need to display this button in author page. I can do it. I added this button to author page. The problem is that author can see this button in other author's page too . That's why I need to display this button in author page of current user. I am so sorry I have no any reference code. I have no any idea how to do it. please help. Thank you for you attention.\nhow to code that if current author page belongs to current user\n\nA: The is_author() conditional can be used to check if the query is targeting an author's page. By passing one or more User IDs/nicenames into it, it will check for specific author pages. So to check if the current author page is for the current user, it can be passed the return value from get_current_user_id():\nif ( is_user_logged_in() && is_author( get_current_user_id() ) ){\n  echo \"belongs to current user \";\n}\nelse {\n  echo \"not belongs to current user\";\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406398", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can I do in-page changes binding events/triggers to actions in WordPress? I've been coder for decades but I need to setup some microsites super-fast. I chose WordPress as the platform and I'm complete newbie to WordPress.\nThe behaviour I need I know can do it programming. But the question is if this can be done \"zero-code\" in WordPress:\nQuestion\nCan I bind in-page \"triggers\" to \"actions\" natively in WordPress?\nExamples\n\n*\n\n*Whenever a user scrolls more than 80%, a new button is added.\n\n*Whenever a user watches an embedded video hosted in YouTube in full, a disabled button becomes active.\n\n*Whenever a user clicks a checkbox (say: [ ] I am older than 70) a new relevant section is displayed (ie: a full section with multiple blocks, texts and photos saying: \"In this activity you'll have to take in account...\")\n\n*Whenever a user stays more than 3 mins scrolling up and down (ie: active window) but not taking action, make a popup appear.\n\n*Whenever a user focus out the page, change a CSS to highlight some section.\n\n*etc.\n\n\nA: \nCan I bind in-page \"triggers\" to \"actions\" natively in WordPress?\n\nYes - depending on what you mean by \"natively.\" Whether implemented in a theme or a plugin, using blocks or shortcodes or neither, all of these things are perfectly possible and have been done using WordPress.\n\nBut the question is if this can be done \"zero-code\" in WordPress\n\nYes and no.\nAll of the functionality you have described is general front-end interactivity, and WordPress core is not really responsible for such things. It provides the systems on which to create nearly any functionality and end-user experience, but does not provide some bloated \"standard library\" of every imaginable behavior from which to build every front-end experience by itself. This is the responsibility of themes and plugins - to extend and tailor a WordPress installation to fit a specific project's needs.\nMore than likely you could achieve all of the listed effects without code if you put the legwork into finding appropriate extensions. The realm of what's possible in WordPress thanks to extensions was already fairly substantial, and the new Block and Site Editor functionality is rapidly expanding that realm even further (but both are still in active primary development - it will take a while for their ecosystems to catch up).\nGiven the simplicity of the features described, if you are comfortable working with JS/PHP/HTML (and brownie points for React), spending a little time learning to use a few of WordPress's foundational APIs could well pay dividends - coding those features from scratch may well prove faster than finding themes or plugins to satisfy them.\n\nBasic CSS/JS Loader Plugin Example\nTo get started with plugin development, you'll want to refer to the Plugin Developer Handbook and the Theme Developer Handbook. There's sort of some cross-over in scope between the two as both leverage the same core APIs to achieve their goals - so if something you're looking for isn't in one it may well be in the other. The Code Reference can assist with more general documentation on functions and \"hooks\" (callbacks attached to \"actions\"/\"filters\" - general lifecycle events and events providing points to modify values before they are used, respectively).\nBelow is an example of a super-basic plugin to load some frontend assets. Placed in it's own directory within wp-content/plugins it will be available for activation in the Plugins screen on the dashboard.\n<?php\n/**\n * Plugin Name: WPSE406402\n */\n\nfunction wpse406402_enqueue_scripts() {\n  // Enqueue a local JS file to be loaded on every page.\n  wp_enqueue_script(\n    'wpse406402-global',                            // A handle to identify this script.\n    plugins_url( '/assets/js/index.js', __FILE__ ), // The URL to the script.\n    [ 'jquery' ]                                    // Script dependency handles - WordPress will make sure this script loads after these.\n  );\n\n  // Use conditionals to enqueue a JS file only on the home/front page.\n  if( is_home() || is_front_page() ) {\n    wp_enqueue_script( 'wpse406402-home', plugins_url( '/assets/js/home.js', __FILE__ ), [ 'wpse406402-global' ] );\n  }\n}\n\n// When WordPress fires the `wp_enqueue_scripts` \"action\" (event), execute the callable to enqueue our scripts.\nadd_action( 'wp_enqueue_scripts', 'wpse406402_enqueue_scripts' );\n\nfunction wpse406402_enqueue_styles() {\n  // More or less the same procedure as for scripts!\n  wp_enqueue_style( 'wpse406402-global', plugins_url( '/assets/css/index.css' ) );\n}\n\n// Counter-intuitively, style files are also enqueued on the `wp_enqeue_scripts` action.\nadd_action( 'wp_enqueue_scripts', 'wpse406402_enqueue_styles' );\n\nAs a footnote, wp_enqueue_script() also accepts a version number used for caching and a boolean to load the script in the footer instead of <head>, and wp_enqueue_style() accepts a version number as well. For cache-busting in development, I like to create an enqueue function wrapper which will use the modified time of the file as a version number if WP_DEBUG is enabled, or a constant plugin version number if not - a small convenience which saves a lot of hard-refreshing.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406402", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I want to display latest post in marquee <?php\n/*\nPlugin Name: Breaking News\n*/\n\nfunction rif_breaking_news(){\n        \n        \n?>\n<div class=\"breaking_news_box\" style=\"background: none repeat scroll 0 0 #2E8B57;bottom: 0;color: #CCCCCC;direction: ltr;height: 32px;left: 0;min-width: 600px;position: fixed;width: 100%;z-index: 99935;\" id=\"breaking_news\">     \n    <b class=\"breaking_head\">Latest News:</b>\n    <ul style=\"margin:4px;\">\n\n        \n        <marquee \n        behavior=\"scroll\" direction=\"left\" scrollamount=\"3\" scrolldelay=\"60\" onmouseover=\"this.stop()\" onmouseout=\"this.start()\">\n        <?php $latest = get_posts('numberposts=5'.'&offset='.'&cat=13'); foreach( $latest as $post ): ?>\n        \n        <a href=\"<?php the_permalink(); ?>\"><?php the_title(); ?></a> &nbsp; &nbsp;\n        <?php endforeach; ?>\n    </marquee>\n    \n    </ul>\n</div>\n\n<?php\n}\nadd_action('wp_footer','rif_breaking_news');\nfunction rif_css_fileLink(){\necho '<link rel=\"stylesheet\" type=\"text/css\" href=\"'.plugin_dir_url(__FILE__).'css/style.css\" >';\n}\nadd_action('wp_head','rif_css_fileLink');\n?>\n\n\nA: You are using a local loop, so template functions won't behave as expected without a $post parameter:\n<marquee>\n    <?php $latest = get_posts('numberposts=5&cat=13'); foreach( $latest as $_post ) : ?>\n    \n        <a href=\"<?php the_permalink( $_post ); ?>\"><?= get_the_title( $_post ); ?></a> &nbsp; &nbsp;\n\n    <?php endforeach; ?>\n</marquee>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406405", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there CSS to expand the gallery limit on Index Pages? On a wordpress index page, I am only allowed to add 12 galleries. I would like to add many more. Is there a way that I can expand the gallery limit allowed on index pages?\nIf this is not possible, is there a way that I can add multiple index pages to a folder page?\nThank you for any help\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406409", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Changing url of author page I have author page on my website: https://inwestujfinanse.pl/author/admin/ when I try to change it normally in https://inwestujfinanse.pl/wp-admin/profile.php nothing happens. Is there any way I can change it in the database or something? I don't want to install any additional plugin. Please help me.\n\nA: Yes, if you really want to just change it directly in the database, you are looking for the user_nicename field (column) in the users table.\nThis is the value that WP uses for author archive URLs.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406410", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How Add Code in Page Index Custom Template? I want to display a code in a Custom Page (Index-sitemap) created in the theme folder.\nBut when I use the following code it just shows up on the Homepage.\nif(is_home() && ! is_front_page()) { echo 'code'; }\n\nShow in Home and also in index-sitemap\nif(! is_home() && ! is_front_page()) { echo 'code'; }\n\nNot Showing in Home but also not showing in index-sitemap\nif(is_page(index-sitemap) && ! is_front_page()) { echo 'code'; } \n\nnot Showing too.\nif(is_page(index-sitemap) && is_front_page()) { echo 'code'; }\n\nShowing in home and page Sitemap-Index. I want it to appear only in the sitemap-index not on the homepage how do I do that.\nCause I've used only is_page(slug) or is_page(id) too but it shows up on homepage too.\nHere is my Website, https://www.cilacap.info/indeks-berita\nPlease help.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406411", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Replace post title based on conditions So I would like to replace the entire title of posts in WordPress bases on user behaviuor and role. Please note that I would like to replace the entire post title and not the prepend or append text to it.\nEach post has a 'default' title, which is the title of the post, like \"Make No.1245/12.02.2022 on model 2376/2021\". The alternative title would be \"Make No.*******/********.2022 on model *******/2021\" basically replacing certain parts of the title with asterisks, essentially hiding it.\nIf the user is logged in AND has role 'subscriber' THEN he/she sees the default post title.\nIf the user is visitor (not logged in) OR is logged in but his role is 'pending' THEN he sees the alternative post title.\n\nA: You can use the_title filter to modify the post_title prior to printing on the screen.\nadd_filter(\"the_title\", function($title, $id)){\n  $user = wp_get_current_user();\n  if((!is_user_logged_in() || in_array(\"pending\", $user->roles)) && \"post\" === get_post_type($id)){\n    $title = \"Custom title\";\n  }\n  return $title;\n}, 10, 2);\n\nsource: https://developer.wordpress.org/reference/hooks/the_title/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406413", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to set category correctly for a custom post created by a remote API call? \n*\n\n*I'm using a plugin - \"cleverness-to-do-list\" (https://wordpress.org/plugins/cleverness-to-do-list/#description ).\n\n*I'm aware that the plugin is closed, but I've updated it at my end and gotten it working with my self-hosted Wordpress edition (version 6).\n\n*I'm trying to create a setup where a remote server calls a webpage on my server and POSTs some data.\n\n*That custom PHP webpage is configured to create a new ToDo item (which is placed in the posts table). It does that fine except for setting the category correctly.\n\nApologies - am new to Wordpress development, so might be missing something obvious here... How can I create a post and set the category correctly?\nThe relevant portions of the code:\n`\n    define( 'WP_USE_THEMES', false );\n    require_once( $_SERVER[ 'DOCUMENT_ROOT' ] . '/wp-load.php' );\n    require_once( $_SERVER[ 'DOCUMENT_ROOT' ] . '/wp-admin/includes/post.php' );\n    ...\n    ...\n    $a2zq3_cat_name = 'Category-name'; \n    $a2zq3_cat_id = get_cat_ID($a2zq3_cat_name);\n    $a2zq3_category = get_category_by_slug( $a2zq3_cat_name ); // tried the solution proposed at: https://wordpress.stackexchange.com/a/47423/93042\n    \n    $a2z3_entry_post = array(\n    'post_type'        => 'todo',\n    'post_title'       => $a2z3_entry_POSTTITLE,\n    'post_content'     => $a2z3_entry_POSTCONTENT,\n    'post_status'      => 'publish',\n    'post_author'      => 1, // the admin is the author\n    'comment_status'   => 'closed',\n    'ping_status'      => 'closed',\n    'post_category' => array( $a2zq3_category->term_id )\n);\n\n    // this works\n$a2z3_entry_post_id = wp_insert_post( $a2z3_entry_post, true, false );\n\n    // these work as well\nadd_post_meta( $a2z3_entry_post_id, '_status', 0, true );\nadd_post_meta( $a2z3_entry_post_id, '_priority', 1, true );\nadd_post_meta( $a2z3_entry_post_id, '_assign', -1, true );\nadd_post_meta( $a2z3_entry_post_id, '_deadline', '', true );\nadd_post_meta( $a2z3_entry_post_id, '_progress', 0, true );\n\n// these did NOT work, a2zq3_cat_id is the category id (number), a2zq3_cat_name is the category name (string). Both are defined correctly.\n    wp_set_object_terms( $a2z3_entry_post_id, $a2zq3_cat_id, 'todocategories');\n\n    wp_set_object_terms( $a2z3_entry_post_id, $a2zq3_cat_id, $a2zq3_cat_name);\n\n    wp_set_object_terms( $a2z3_entry_post_id, $a2zq3_cat_id, 0);\n\n    wp_update_term( $a2zq3_cat_id, 'todocategories', array( 'name' => $a2zq3_cat_name ) );\n\n    do_action( 'add_term_relationship', $a2z3_entry_post_id, $a2zq3_cat_id, 0);`\n\n\nA: Functions like get_cat_ID and get_category_by_slug only work for core post categories (taxonomy category) - you are dealing with a custom taxonomy todocategories.\nI see you have $a2zq3_cat_name = 'Category-name'; hardcoded near the top, so I assume you're not assigning the todocategories from POST data.\nIn which case just use wp_set_object_terms() like so.\nwp_set_object_terms( $a2z3_entry_post_id, [ 'the-category-slug' ], 'todocategories' );\n\n... where the-category-slug is the slug of the todo category you're trying to assign.\nAlways make sure to check the documentation for WordPress functions before you try using them.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406416", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Setting a default variation for each product on the child theme functions.php file I'm trying to set a default variation for each product so I wouldn't need to set it manually on each product separately through the admin panel. I tried to insert the code below but it doesn't work. I'm using Variation Swatcher for WooCommerce plugin as well but from analyzing the DB it shouldn't cause the issue. My code:\nfunction setting_product_default_attributes() {\n      global $product;\n      if (!count($default_attributes = get_post_meta($product->get_id(), '_default_attributes'))) {\n        $new_defaults = array();\n        $product_attributes = $product->get_attributes();\n        if (count($product_attributes)) {\n          foreach ($product_attributes as $key => $attributes) {\n            $values = explode(',', $product->get_attribute($key));\n            if (isset($values[0]) && !isset($default_attributes[$key])) {\n              $new_defaults[$key] = sanitize_key($values[0]);\n            }\n          }\n          update_post_meta($product->get_id(), '_default_attributes', $new_defaults);\n        }\n      }\n}\nadd_action('woocommerce_before_single_product', 'setting_product_default_attributes');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406421", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to customize maintenance mode notification in wordpress? I am installing and activating the SeeProd plugin. but it did not work. I need to another simple method to  customize maintenance mode notification.\n\nA: If you set up your WordPress website on maintenance mode manually before installing any updates, you can avoid displaying the default maintenance mode notification simply.\nFurthermore, you can perform the below steps to customize the maintenance mode notification correctly again.\n\n*\n\n*Activate the SeeProd plugin.\n\n*Go to Settings and then go to the Coming Soon Pro page.\n\n*Enable maintenance mode option checkbox.\n\n*Click on the Edit Coming Soon/Maintenance Page button.\n\n*It will open the SeeProd theme customizer.\n\n*Open the SeeProd theme customizer.\n\n*Select a theme and customize the theme.\n\n*Then you can create a beautiful maintenance mode page for the website.\n\nYou can create a maintenance page on the site without using a plugin. Then it will not require to set up the website in maintenance mode at every time updated.\n\n\n*You can do it simply by creating a new file and referred to as maintenance.php on the desktop.\n\n*Then you can paste below code inside it.\n\n*Upload that file to WordPress site\u2019s wp-content directory. Then WordPress will display this created page during maintenance mode. As well as you can use CSS to style the page as your requirement\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406423", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I create 'future' and 'past' parameter for restAPI by filtering the CPT custom date field by greater than / less than current datetime? add_filter( 'rest_events_query', 'filter_events_by_date_field', 999, 2 );\nfunction filter_events_by_date_field( $args, $request ) {\nif ( ! isset( $request['filter_date'] )  ) {\nreturn $args;\n}\n$filter_date = sanitize_text_field( $request['filter_date'] );\n$datetime = current_time('mysql');\nif( $filter_date == 'future' ) {\n    $filter_date_meta_query = array(\n        'key' => 'date',\n        'value' => $datetime,\n        'type' => 'DATETIME',\n        'compare' => '>='\n    );\n} else {\n    $filter_date_meta_query = array(\n        'key' => 'date',\n        'value' => $datetime,\n        'type' => 'DATETIME',\n        'compare' => '<'\n    );\n}\n\n\nif ( isset( $args['meta_query'] ) ) {\n    $args['meta_query']['relation'] = 'AND';\n    $args['meta_query'][] = $filter_date_meta_query;\n} else {\n    $args['meta_query'] = array();\n    $args['meta_query'][] = $filter_date_meta_query;\n}\n\n// $args['meta_key'] = 'date';\n// $args['orderby'] = 'meta_value_num';\n// $args['order'] = 'ASC';\n\nreturn $args;\n\n}\nSorry guys i have no coding experience would be great if someone can help. thanks!!!!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406425", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to re-house images in uploads/YYYY/MM My media items are not stored in YYYY/MM subfolders of uploads. Instead, I had cooked up some scheme to ingest posts, but seem to have declined/neglected to organise them that way.\nSo, I've got a combination of one big uploads folder containing thousands of files, plus some specific subfolders in uploads, like logos, people, icons. That's because not everything is related to a post.\nBut the images that do relate to posts... well, they are disorganised. I think I wish I had used date folders - at least, for post images. Now I'm 9,000+ in.\nThe question...\nIs there any option for automatically organising these in YYYY/MM subfolders as they should have been? Anything that will, for example:\n\n*\n\n*spin through the library\n\n*if image is associated, check post\n\n*get YYYY and MM of post\n\n*reorganise image in corresponding folder\n\n?\nSome of my images relate to ACF fields.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406426", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I make a request in my browser to search the CPT taxonomy? How do I make a request in my browser to search the CPT taxonomy?\nCustom post type \"portfolio\"\nTaxonomy \"portfolio_entries\"\nTag \"new\"\nThe request in the browser of the form site.ru/?s=&post_type=portfolio&taxonomy=portfolio_entries&field=slug&terms=new\nIt does not work, please help me make a correct request. Thanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406427", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP_Query get posts in custom database table I have a custom database table like this:\n\nHow can I get the 5 posts of custom post type whose ID appears most times? Thank you!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406429", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP Container Displaying Only on First Page of Archive I have the following code for a two-column container:\n<div class=\"rh_content rh_content_above_footer  rh_page__content\">\n            \n<div class=\"wp-container-3 wp-block-columns\">\n<div class=\"wp-container-1 wp-block-column\">\n<h2 style=\"font-size: 19px;color: #36a8fc;\">Trouvez \u00e0 Altea l\u2019appartement r\u00e9pondant \u00e0 tous vos crit\u00e8res</h2>\n\n\n\n<p>Souhaitez-vous une, deux ou trois chambres&nbsp;? Plut\u00f4t vue sur l\u2019extraordinaire arri\u00e8re-pays, ou sur la mer&nbsp;? Votre r\u00eave, c\u2019est plut\u00f4t terrasse ou jardin privatif&nbsp;? Et c\u00f4t\u00e9 architecture&nbsp;? Votre pr\u00e9f\u00e9rence va-t-elle vers le style m\u00e9diterran\u00e9en typique, ou vers une architecture r\u00e9solument moderne&nbsp;? Comme vous le voyez, de nombreux choix sont possibles.</p>\n\n\n\n<p>Notre objectif est de vous aider \u00e0 trouver le bien qui vous correspond, qui vous rendra heureux, quels que soient vos crit\u00e8res. Nos appartements en vente \u00e0 Altea sont pr\u00e9sent\u00e9s ci-dessus&nbsp;; vous pouvez \u00e9galement nous contacter directement, et nous nous ferons une joie de vous pr\u00e9senter une s\u00e9lection sur mesure de biens en fonction de vos besoins.</p>\n</div>\n\n\n\n<div class=\"wp-container-2 wp-block-column\">\n<h2 style=\"font-size: 19px;color: #36a8fc;\">Investissement limit\u00e9, plaisir sans limite</h2>\n\n\n\n<p>Devenir propri\u00e9taire d\u2019un appartement \u00e0 Altea n\u2019a jamais \u00e9t\u00e9 aussi simple. Il vous suffit de choisir parmi nos nombreux appartements en vente \u00e0 Altea, sur l\u2019une des plus belles c\u00f4tes espagnoles.</p>\n\n\n\n<p>De taille raisonnable, votre appartement vous permettra de profiter des joies d\u2019Altea, de sa r\u00e9gion et du soleil toujours au rendez-vous pour un&nbsp;<strong>tarif abordable</strong>. Les appartements que nous vous proposons font partie de r\u00e9sidences agr\u00e9ables, dot\u00e9es d\u2019espaces communs comme les jardins, la piscine, les aires de jeux\u2026 Cela permet de rencontrer vos voisins et de partager des moments de convivialit\u00e9.</p>\n</div>\n</div>\n        </div>\n\nI want to display it only on the first page of the pagination of a custom-type of a theme.\nI found this:\nhttps://codex.wordpress.org/Category_Templates#Text_Displaying_Only_on_First_Page_of_Archive\nBut I don't know what to do with it, where to put it or how to apply it.\nI am completely new with programming, touching code.\nCould someone tell me in understandable words, what can I do?\n", "meta": {"language": "fr", "url": "https://wordpress.stackexchange.com/questions/406433", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Alias to theme folder for local development I am locally developing a parent theme and child themes simultaneously (perhaps not best practice, but...). It looks something like this:\nparent.local\n  /wp-content/themes/parent-theme/\n\nchild1.local\n  /wp-content/themes/parent-theme/\n  /wp-content/themes/child1-theme/\n\nchild2.local\n  /wp-content/themes/parent-theme/\n  /wp-content/themes/child2-theme/\n\nRather than copying the parent theme to each local site, I want to be able to work on the parent theme in one place and keep it updated for the child sites as well. I have tried creating an alias (on Mac) to the parent theme folder under each child site, but Wordpress says the parent theme is not installed.\nIs there another way to do this? I feel like I'm missing something obvious, but any help is appreciated.\n\nA: Got it\u2014needed to use a symlink rather than an alias.\ncd ~/child1.local/wp-content/themes/\nln -s ~/parent.local/wp-content/themes/parent/ parent\n\nFigured it out with help from this article.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406438", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Sub menu is not working properly I am learning WordPress Plugin Development. My code is like below.\npublic function admin_menu()\n{\nadd_menu_page('News Information', 'News Info', 'manage_options', 'news_info', [$this, 'api_key_page'], 'dashicons-info-outline', 30);\nadd_submenu_page('news_info', 'News Information', 'API Key', 'manage_options', 'news_info_page', [$this, 'api_key_page']);\nadd_submenu_page('news_info', 'News Information', 'News', 'manage_options', 'edit.php?post_type=news');\nremove_submenu_page('news_info', 'news_info');\n} \n\nBut sub menu is not kept open.\nhttps://youtu.be/NUM3GuLU_F0\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406439", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Shortcode to get URL Parameters $_GET['name'] redirects for no reason at all Need some help in understanding how does WordPress Redirects work. While working with shortcode:\nadd_shortcode('name', 'get_name');\n\nfunction get_name() {\n\n   return $_GET['name'];\n\n}\n\nThe page which was supposed to be running on:\nhttps://localhost:8000/?page_id=2&name=test123 gets redirected to\nhttp://localhost:8000/?page_id=2 for no reason at all.\nI seem to have uninstalled and removed each and every plugin from the page I'm not able to understand how to diagnose it. Do we have any kind of log or something in wordpress to understand the cause of redirect? Also, how to make it work and visible?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406440", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Change displayed \"page name\" to distinguish multiple pages with the same title I have multiple thank-you pages, depending of if they completed an action in full or just partially.\nBut the title \"\u00a1Hey, felicidades! \u2764\ufe0f\" is set the same to both pages (the only change is inside).\n\nHow can I set that it reads like this?\n\u00a1Hey, felicidades! \u2764\ufe0f full\n\u00a1Hey, felicidades! \u2764\ufe0f partial\n\n(or any other way to distinguish them without having to enter into the page itself)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406442", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display list of Custom Post I created Custom Post Type News. I would like to show the list of Custom Post News at a sub menu of News Info. How can I do that ?\n\nMy custom post type registration code is like below\npublic function register_custom_post_type () {\n\n        $supports = array('title');\n\n        $labels = array(\n            'name' => _x('Newss', 'plural'),\n            'singular_name' => _x('News', 'singular'),\n            'name_admin_bar' => _x('News', 'admin bar'),\n            'add_new' => _x('Add New', 'add new'),\n            'add_new_item' => __('Add New News'),\n            'new_item' => __('New News'),\n            'edit_item' => __('Edit News'),\n            'view_item' => __('View News'),\n            'all_items' => __('All Newss'),\n            'search_items' => __('Search News'),\n            'not_found' => __('No News Found.'),\n        );\n\n        $args = array(\n            'supports' => $supports,\n            'labels' => $labels,\n            'public' => true,\n            'description' => 'News Information',\n            'has_archive' => true,\n            'exclude_from_search' => false,\n            'show_in_menu' => 'edit.php?post_type=news'\n        );\n\n        register_post_type('news', $args);\n    }\n\nMy Menu code is like below\npublic function admin_menu()\n{\n    add_menu_page(\u2018News Information\u2019, \u2018News Info\u2019, \u2018manage_options\u2019, \u2018news_info\u2019, [$this, \u2018api_key_page\u2019], \u2018dashicons-info-outline\u2019, 30);\n    add_submenu_page(\u2018news_info\u2019, \u2018News Information\u2019, \u2018API Key\u2019, \u2018manage_options\u2019, \u2018news_info_page\u2019, [$this, \u2018api_key_page\u2019]);\n    add_submenu_page(\u2018news_info\u2019, \u2018News Information\u2019, \u2018News\u2019, \u2018manage_options\u2019, \u2018edit.php?post_type=news\u2019);\n    remove_submenu_page(\u2018news_info\u2019, \u2018news_info\u2019);\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406443", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change Dashboard URL from wp-admin to wp-admin/index.php Can anyone get me the solution to change WordPress Dashboard URL from wp-admin to wp-admin/index.php? I am getting a timeout error to access the Dashboard by using this URL https://my-site-url/wp-admin but I can access fine with this URL https://my-site-url/wp-admin and that's why I would like to change the Dashboard access URL.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406445", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why wp_remote_get() fetches certain web pages while it doesn't work for my localhost? Why I'm not able to parse csv files (or equivalently open them) using WordPress shortcode?\nProblem: I wish to use a shortcode to Parse Contents of a csv file and display its contents effectively. But the problem is that for some reason, the file doesn't opens/shows up despite different turn arounds. The server logs say that the GET request to the file was successful.\nMy Shortcode:\nfunction wpb_demo_shortcode() { \n    if (($open = fopen(\"http://localhost:8000/a.csv\", \"r\")) !== FALSE) \n  {\n  \n    while (($data = fgetcsv($open, 1000, \",\")) !== FALSE) \n    {        \n      $array[] = $data; \n    }\n  \n    fclose($open);\n  }\n  echo \"<pre>\";\n  //To display array data\n  var_dump($array);\n  echo \"</pre>\";\n}\nadd_shortcode('website-url-name', 'wpb_demo_shortcode');\n\nThere are similar questions around: Why is file_get_contents returning page source?\nAgain the solution returns no different. It's showing a blank pop up for me. I don't even know what's the problem with WordPress because regular plain PHP script is able to render it successfully.\nKindly enlighten the mistake here.\nEDIT: I just found that instead of using localhost:8000, I used https://pippinsplugins.com/edd-api/products and it works like a magic. I don't know why it is not able to get files files from my localhost. Very weird.\nsome ss regarding shortcode being called and output.\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406446", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress (pagenow link) in ajaxurl change after i change plugin language i'm working in plugin, and when i change the plugin language the URL of ajax url is change\nso how i can fix it? Or what should i use inested?\nhere is example:\nBefore Change plugin language:\n    <title>Style Settings &lsaquo;</title>\n    <script type=\"text/javascript\">\n    addLoadEvent = function(func){if(typeof jQuery!=='undefined')jQuery(function(){func();});else if(typeof wpOnload!=='function'){wpOnload=func;}else{var oldonload=wpOnload;wpOnload=function(){oldonload();func();}}};\n    var ajaxurl = '/wp-admin/admin-ajax.php',\n        pagenow = 'sobex-tech_page_sobex-tech-style',\n        typenow = '',\n        adminpage = 'sobex-tech_page_sobex-tech-style',\n        thousandsSeparator = ',',\n        decimalPoint = ',',\n        isRtl = 1;\n    </script>\n\nafter Change:\n<title>\u062a\u0646\u0638\u06cc\u0645\u0627\u062a \u0627\u0633\u062a\u0627\u06cc\u0644 &lsaquo;</title>\n<script type=\"text/javascript\">\naddLoadEvent = function(func){if(typeof jQuery!=='undefined')jQuery(function(){func();});else if(typeof wpOnload!=='function'){wpOnload=func;}else{var oldonload=wpOnload;wpOnload=function(){oldonload();func();}}};\nvar ajaxurl = '/wp-admin/admin-ajax.php',\n    pagenow = '%d8%b3%d8%a7%d8%a8%da%a9%d8%b3-%d8%aa%da%a9_page_sobex-tech-style',\n    typenow = '',\n    adminpage = '-d8-b3-d8-a7-d8-a8-da-a9-d8-b3--d8-aa-da-a9_page_sobex-tech-style',\n    thousandsSeparator = ',',\n    decimalPoint = ',',\n    isRtl = 1;\n</script>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406448", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Keep source page URL parameters on custom link menu item I am using the WPML language plugin with the current language setting attached as a URL parameter.\nI have some menu items that point to specific sections on a page using a custom link with an anchor. When clicking this link, the language parameter of the source page is not preserved.\nIs there any way to change this behavior, ideally without hard-coding page slugs or menu item IDs into a filter?\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406449", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Customise Grouped Product display in Woocommerce with custom column I am trying to display the grouped product where i need to display REF and SKU/Part Number in the table as shown in the screenshot from another website i have seen. By default it only shows the quantity, Title/Desc and Price column only. ALso the Column label is not displayed by default. Please help me\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406457", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress multiple admin notices on post update/add I am working on post integrations with a third party system. So, when an admin create/update a postm, we use wp_insert_post hook and composer a xml feed and push it to third party system. and it comes back with some response, now we want to show that response in post notice along with default notice (Post Updated/Created etc)\nadd_action('wp_insert_post', array($this, 'ourcustomfunction'), 12);\nfunction ourcustomfunction(){\n//send xml to 3rd party system and json response from them.\n\n   add_action('admin_notice', 'custom_notice');\n}\nfunction custom_notice(){\necho '<div class=\"notice error-notice\">CUSTOM NOTICE TEXT</div>';\n}\n\nWhen I debug, it does not go to custom_notice function...\nAny help will be appreciated.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406458", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get localize of a loaded javascript I am writing a cache code to combine JS files\nI add JS files in a single file and then dequeue the script using wp_dequeue_script\nBut the problem is wp_dequeue_script will dequeue extra inline data (Localize) and remove those codes (Like Ajax calls)\nHow can I get localize of a loaded javascript (extra inline data of a script)?\nOr is there any way to prevent dequeue extra inline data of a script?\nI use $wp_scripts->registered and $wp_scripts->to_do\nThank you\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406461", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get Custom Field Name ( Label or Key ) Not Value I have the custom field value but i also need the name or what some call the label or key to print on the frontend.\nget_post_meta('get_the_ID(), 'key', true );\n\nHow to get the name or key instead of the value?\nI'm NOT using ACF as i know they have a plugin specific function for this, i am only using WordPress custom fields.\nI don't want to use this ACF function\nget_field_object\n\nI want to use a WordPress function which does the same thing so the output will be :\nname : value\n\nI have the value from get_post_meta but how do i get the name?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406465", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Confirmation required on users email change This kind of issue was already discussed here, but the question is 10 yo and none of the answers work, obviously.\nBasically, Wordpress already have the function written in /wp-includes/user.php, which is send_confirmation_on_profile_email(), but for some reason it's not an \"option\" in the settings, or am I missing something?\nAs far as I know, the confirmation sent to change the profile email is an 'admin-only' thing.\nIs there any way to make it work for users too? I'm using Wordpress update 6\nThanks in advance\n\nA: \nAs far as I know, the confirmation sent to change the profile email is an 'admin-only' thing. Is there any way to make it work for users too? I'm using Wordpress update 6\n\nAs far as I understand, this was additionally implemented, in ticket #16470 few years ago, for all single site users that try to change their own email address.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406468", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do you manage your pages or functions that require logged-in users? I'm having more functions and pages that require my users to be logged-in.\nBelow is what I have in each of my functions, kind of a hassle to keep repeating this code.\n$user_id = get_current_user_id();\n\n//If user is not logged in...\nif ( $user_id == 0 ) {\n    nocache_headers();\n    wp_redirect( wp_login_url() ); \n    exit();\n}\n\nAnd for pages, I use Content Control plugin.\nI wonder how you manage yours and perhaps you can offer a more simplified solution to ensure the user is logged in while accessing.\nUPDATE: I use the above instead of is_user_logged_in() cos most times I need to access $user_id.\n\nA: I tend to use template_redirect action to check, if a user has access to certain content, e.g. a page. To me, it is the most logical and straightforward place to handle the checking. As per the docs, https://developer.wordpress.org/reference/hooks/template_redirect/, the action,\n\nFires before determining which template to load.\n\nAlso the WP object has been already set up and the current user is known, so checking the user and the content is easy.\nTo mark something as restricted content, I might use a page template, a custom taxonomy, or just plain post meta - depending on the use case and how lazy I'm feeling at that moment.\nI might do something like this,\nadd_action( 'template_redirect', 'my_maybe_protected_content' );\nfunction my_maybe_protected_content() : void {\n  \n  // optional conditions..\n  if ( ! is_page() ) {\n    return;\n  }\n  \n  // current post id\n  // use get_queried_object(), if post object is needed\n  $post_id = get_queried_object_id();\n  \n  // check for protected content\n  if ( ! my_is_protected_content($post_id) ) {\n    return;\n  }\n  \n  // access and/or auth chcecks\n  if ( \n    ! is_user_logged_in() || \n    ! my_user_has_access(\n      wp_get_current_user(), $post_id\n    )\n  ) {\n    my_redirect_user();\n  }\n}\n\nfunction my_is_protected_content(int $post_id) : bool {\n  \n  // option 1 - determine from template\n  if ( 'path/to/page-template.php' === get_page_template_slug( $post_id ) ) {\n    return true;\n  }\n  \n  // option 2 - use a custom taxonomy\n  if ( has_term( 'is_protected_content', 'my_utility_taxonomy', $post_id ) ) {\n    return true;\n  }\n  \n  // option 3 - check from post meta\n  $protected_by_meta_flag = get_post_meta( $post_id, 'my_protected_content_meta_key', true );\n  if ( $protected_by_meta_flag ) {\n    return true;\n  }\n  \n  // default...\n  return false;\n  \n}\n\nfunction my_user_has_access(WP_User $user, int $post_id) : bool {\n  // some fancy logic...\n  return true;\n}\n\nfunction my_redirect_user() {\n  nocache_headers();\n  wp_redirect( wp_login_url() ); \n  exit();\n}\n\nThe code would go into functions.php, an additional PHP file required in functions.php, or a custom plugin.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406470", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress search shows protected content I have noticed many times that WordPress search results reveal protected/locked content. Is it a security issue or do search results show the webpage as viewed by the admin?\nSometimes, the content of some password protected pages is also visible in wordpress search results (using ?s=)\nHowever, it's only the summary/preview of the webpage and not the entire content\nIs it a security issue (related to login plugins? or cached pages?) or does it have to do with misconfiguration of wordpress settings?\nOn some websites, it shows protected content while on other websites it shows a summary of the content on that page (which is password protected)\nHow do you fix this problem?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406473", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to change an existing wordpress page rewrite rule? I'm new here and I don't have mach coding experience.\nI've created a new page layout the data there is taken from a text file and the name of the file is passed in a parameter so for example the url looks like this:\nhttp://localhost/<parentpage slug>/<sub page slug>/?mytextpage=test\n\nmy question is how, where and what should I change in the existing rewrite rules so my new urls would look like this:\nhttp://localhost/<parentpage slug>/<sub page slug>/mytextpage/test/\n\nI was able to find questions here about how to create new rewrite rules for custom pages but not on how to change the existing wordpress rules.\nThanks for the help.\nUPDATE\nI used the following code and i was able to get to the target page but the parameter \"test\" didn't pass.\nadd_filter( 'query_vars', 'wpa543_query_vars' );\nfunction wpa543_query_vars( $query_vars )\n{\n $query_vars[] = 'd';\n return $query_vars;\n}\n\n    add_action( 'init', 'wpa543_init' );\n    function wpa543_init()\n    {\n     add_rewrite_rule(\n        'class/([^/]+)/?',\n        'index.php?page_id=5&d=$matches[1]',\n        'top' );\n     flush_rewrite_rules();\n    } \n\nwhat need to be changed in the code so it will pass the parameter?\nalso this code gives me only a partial solution because I still don't know how to pass the parent page slug and the sub page slug\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406475", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Child Theme style.css changes aren't showing. Parent \"style-less.css\" over rides it, and won't update I'm using a child theme with a style.css file and none of the updates are showing on the live site.\n\n*\n\n*When I view the child theme style.css file via \"view page source\" the changes show in the code.\n\n*The changes don't show in \"developer tools\". Not even as being overwritten. They just don't exist.\n\n*The site only shows CSS code from a \"style-less.css\" file.\n\n*If I add the code via the Admin Panel (Appearance > Customize > Additional CSS) the changes work.\n\nI don't believe this is a caching issue, because I've cleared server and browser caches. I've also went back and looked at changes I made 6+ months ago, and we still have the same issue.\nWhat do I need to do so that my child themes style.css changes are reflected on the live site?\n\nA: You must enqueue your child theme's stylesheet from the child theme's functions.php file, as you would any other stylesheet. Specifying the parent theme's stylesheet handle as a dependency is a good measure to ensure the proper load order.\nfunction wpse406477_enqueue_child_styles() {\n  wp_enqueue_style( 'mychild-style', get_stylesheet_uri(), [ 'parent-style' ] );\n}\n\nadd_action( 'wp_enqueue_scripts', 'wpse406477_enqueue_child_styles' );\n\nNote that compatibility with traditional mechanisms to override parent components from child themes varies from theme to theme. If your parent theme is not one of the default twenty* themes, you may need to refer to your theme's documentation or inquire in the theme's official support channels for the proper means to extend it with a child theme.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406477", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Authenticate rest API except for contact-form-7 I have a contact-form plugin that requires access to the rest api. My original settings were to disallow access to rest api except for administrators and editors.\nHowever, to allow the contact-form to work I need to remove rest api authentication for contact-form hence I modified the authentication code such that authentication will not be required if request url includes the following string <wp-json/contact-form-7> [this string is part of the request url address, the full address is https://mywebsite.com/wp-json/contact-form-7/v1/contact-forms/18047]\nMy question is whether this is a flawed method from a security stand point and if it is, is there a recommended alternative.\nAppreciating your feedback\nadd_filter('rest_authentication_errors', function ($errors) {\n    if (!is_wp_error($errors)) { // do nothing if there's already an error\n        if ($can_access = is_user_logged_in()) {\n            $roles = (array)wp_get_current_user()->roles;\n            $can_access = in_array('administrator', $roles); // allows only the Administrator role\n            $can_access2 = in_array('editor', $roles); // allows only the editor role\n        }\n        \n        #*** Checking if url is for contact-form\n        global $wp;\n        $url_home22=home_url( $wp->request );\n\n        if (strpos($url_home22, 'wp-json/contact-form-7')) {\n            $contact_form=True;\n        }else{\n            $contact_form=False;\n        }\n\n        #*** If user is admin or editor or if url is contact form then allow access to api, otherwise, deny access\n\n        if (!$can_access and !$can_access2 and $contact_form==False) {\n            return new WP_Error('user_not_allowed',\n                'Sorry, you are not allowed to access the REST API.',\n                array('status' => rest_authorization_required_code())\n            );\n        }\n        \n    }\n\n    return $errors;\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406480", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Fetch data from two custom post types and create multidimensional array for output to html table I have two CPT (brochures and brochures_so). In both CPT i use ACF field (key = jaar)\nbrochures\n\n\n\n\nJaar (ACF field)\nVakgebied (Custom taxonomy)\n\n\n\n\n2021\nWiskunde\n\n\n2022\nPAV\n\n\n2022\nFrans\n\n\n\n\nbrochures_so\n\n\n\n\nJaar (ACF field)\nVakgebied (Custom taxonomy)\n\n\n\n\n2022\nNederlands\n\n\n2019\nMens en maatschappij\n\n\n\n\nMy output for both CPT must be like this\nhtml table\n\n\n\n\nJaar (ACF field)\nBrochure\nBrochure_so\n\n\n\n\n2022\nPAV\nNederlands\n\n\n2022\nFrans\n\n\n\n2021\nWiskunde\n\n\n\n2019\nMens en maatschappij\n\n\n\n\n\nSo when in both CPT (brochures and brochures_so) the 'jaar' matches and fill the cells \"brochures\" and \"brochures_so\" in html table.\nIn my code i try to create a multidimensional array to combine the data from both CPT.\n$query_cpt = new WP_Query(array(\n    'post_type' => array('brochures', 'brochures_so'),\n    'post_status'    => array('publish'),\n    'posts_per_page' => -1,\n    'orderby' => 'jaar',\n    'meta_key' => 'jaar',\n    'order' => 'desc',\n));\n\nif ($query_cpt->have_posts()) {\n\n    $brochures = [];\n    $brochures_so = [];\n\n    while ($query_cpt->have_posts()) {\n        $query_cpt->the_post();\n\n        if (get_post_type() === 'brochures') {\n            $jaar = get_field('jaar', get_the_ID());\n            $vakgebied = strip_tags(get_the_term_list(get_the_ID(), 'leer_vakgebied'));\n            $brochures[][$jaar][\"brochure\"] = [\"vakgebied\" => $vakgebied];\n        }\n\n        if (get_post_type() === 'brochures_so') {\n            $jaar = get_field('jaar', get_the_ID());\n            $vakgebied_sec = strip_tags(get_the_term_list(get_the_ID(), 'leer_vakgebied_so'));\n            $onderwijsniveau = get_field('onderwijsniveau', get_the_ID());\n            $brochures_so[][$jaar][\"brochure_so\"] = [\"vakgebied\" => $vakgebied_sec, \"onderwijsniveau\" => $onderwijsniveau];\n        }\n\n    }\n\n    /* This multidimensional array works */\n\n    $peilingen_test = [\n        [2022 => [\"brochure_so\" => [\"vakgebied\" => \"vak\", \"onderwijsniveau\" => \"niveau\"], \"brochure\" => [\"vakgebied\" => \"brochureonderwijs\"]]],\n        [2022 => [\"brochure_so\" => [\"vakgebied\" => \"vak\", \"onderwijsniveau\" => \"niveau\"], \"brochure\" => [\"vakgebied\" => \"brochureonderwijs\"]]],\n        [2021 => [\"brochure_so\" => [\"vakgebied\" => \"vak\", \"onderwijsniveau\" => \"niveau\"], \"brochure\" => [\"vakgebied\" => \"\"]]],\n    ];                  \n\n    echo \"<table><thead><tr><th>Jaar</th><th>Brochure</th><th>Brochure_so</th></tr></thead><tbody>\";\n    foreach ($peilingen_test as $peiling) {\n        foreach ($peiling as $jaar => $peil) {\n            echo \"<tr><td>\" . $jaar . \"</td>\";\n            echo \"<td>\" . $peil[\"brochure\"][\"vakgebied\"] . \"</td>\";\n            echo \"<td>\" . $peil[\"brochure_so\"][\"vakgebied\"] . \" | \" . $peil[\"brochure_so\"][\"onderwijsniveau\"] . \"</td>\";\n            echo \"</tr>\";\n        }\n    }\n    echo \"</tbody></table>\";\n\n    wp_reset_postdata();\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406484", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom plugin settings link doesn't append current class to menu item when visited? Why? So I've created a custom setting link on my plugin listing, that takes the user to the plugin settings. However, it doesn't seem to be working as I would expect it to and I'm not sure why. \nTo clarify, the link is added, and it does redirect. So the basic functionality is as I would expect. It's a visual error, I.e indication to the user which page they are on in the admin sidebar menu.\n\nExpected Behaviour:\n\n*\n\n*User clicks settings link.\n\n*User is taken to 'wp-admin/admin.php?page=apwb_settings' page.\n\n*Side bar menu <li> and <a> has class=\"current\" appended.\n\nActual Behavior:\n\n*\n\n*User clicks settings link.\n\n*User is taken to 'wp-admin/admin.php?page=apwb_settings' page.\n\n*Side bar menu <li> and <a> remains unchanged.\n\n\nMy Registered Setting...\n/** \n * Register the settings page.\n * \n * @package     apwb/postal-pricing\n * @since       1.0.0\n*/\nfunction apwb_settings_page() {\n    add_options_page(\n        __( 'Postal Pricing Settings', 'postal-pricing' ),\n        __( 'Postal Pricing Settings', 'postal-pricing' ),\n        'manage_options',\n        'apwb_settings',\n        function() {\n            ?>\n            <div id=\"apwb-settings\"></div>\n            <?php\n        },\n    );\n}\nadd_action( 'admin_menu', __NAMESPACE__ . '\\apwb_settings_page' );\n\nMy plugin links amendment...\n/** \n * Add settings link to plugin listing.\n * \n * @package     apwb/postal-pricing\n * @since       1.0.0\n*/\nfunction apwb_settings_link( $links ) : array {\n    $label = esc_html__( 'Settings', 'postal-pricing' );\n    $slug  = 'apwb_settings';\n    $admin_url = admin_url('admin.php?page=' . $slug);\n\n    array_unshift( \n        $links, \n        \"<a href='$admin_url'>$label</a>\" \n    );\n\n    return $links;\n}\nadd_filter( 'plugin_action_links_' . plugin_basename( __FILE__ ), __NAMESPACE__ . '\\apwb_settings_link' );\n\nMy Question...\nHow does WordPress typically handle this behavior? Is it something I can hook into? Or will I have to write a custom solution? (I really don't want to add more js if I can help it.)\n\nA: I noticed your apwb_settings_page() function is adding the \"Postal Pricing Settings\" submenu using add_options_page(), and the documentation stated that: (bold formatting added by me)\n\n\n*\n\n*This function is a simple wrapper for a call to  add_submenu_page(), passing the received arguments and specifying \u2018options-general.php\u2018 as the  $parent_slug  argument. This means the new options page will be added as a sub menu to the Settings menu.\n\n\nAnd that also means, in your apwb_settings_link() function, $admin_url (or your settings link) should actually link to or use options-general.php and not admin.php:\n\n*\n\n*Incorrect: $admin_url = admin_url('admin.php?page=' . $slug);\n\n\n*Correct: $admin_url = admin_url('options-general.php?page=' . $slug);\n\n\n*Even better: Use menu_page_url(), e.g. $admin_url = menu_page_url( $slug, false );\nThe \"Incorrect\" above will actually load the correct \"Postal Pricing Settings\" admin page, but the \"Postal Pricing Settings\" submenu (under the \"Settings\" menu) will not be highlighted because the parent file is not options-general.php. So actually, you just needed to ensure your setting link uses the correct admin page URL. :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406486", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What is the \"correct\" way to add hooks or similar PHP behavior to a blocktheme? I'm building a new site and I wanted to build my theme from scratch. However, the WordPress ecosystem is moving more towards blocks and blockthemes. As far as I can tell, it is possible to put hooks (do_action(), apply_filters()) into a block theme, but it seems like I'd be making a weird hybrid. I don't want to only use HTML (including CSS and JS) when I build some of the pages; I really want to have places that I can hook PHP commands into. It's probably more correct to say that I have to use PHP for many of the site features and hooks are a great way to do it.\nI haven't seen any hooks inside of blockthemes, so is there a good convention to follow for putting them in one? Or are blockthemes meant to avoid hooks altogether, in favor of blocks and shortcodes? Let's say that I wanted to have a banner at the top of the home page, but underneath the header that changes according to the user roles and current date (I've done that before by hooking into the top of the theme page). What is the best way to implement that in a block theme?\n\nA: I'm not the most experienced in block themes, but from what I've seen of them so far I feel pretty confident in saying that the functionality you describe should be implemented as a block. But it's wrong to say that absolutely everything needs to be HTML and JS. There is still a place for PHP.\n\nLet's say that I wanted to have a banner at the top of the home page,\nbut underneath the header that changes according to the user roles and\ncurrent date (I've done that before by hooking into the top of the\ntheme page).\n\nIn this case the banner should be a custom block that can be added to any block area of a block theme. Twenty Twenty-Two has a Header area that might be appropriate, for example.\nSuch a block should render some kind of preview in the editor with JS, for performance reasons, but when you register the block you can define it as a dynamic block with a render_callback where you can use PHP logic to render the contents of the block on the front end. That callback would check the user role or date to determine what it renders.\nRegarding hooks, those are definitely still relevant, and are still used for all sorts of things. They're just not particularly relevant for adding markup into themes, but since there was never any standardisation of hooks for themes they were never a great way to do this to begin with.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406487", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to manipulate the content within wp_head I am looking to create a plugin which will allow me to update content within the wp_head function. I have the below code which is fine in allowing me to add new content during the wp_head load event;\n<?php\nfunction manipulate_head() {\n    ?>\n        <title>This is a second title</title>\n    <?php\n}\n\nadd_action('wp_head', 'manipulate_head');\n\nHowever it does not allow me to remove or replace something that is already within the <head> tags on the page.\nAn example would be to update the <meta name=\"description\"> tag in the  section of the website. The website could have a <meta name=\"description\"> in which case we need to update the content, otherwise we need to add a new one.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406489", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Wordpress 6.x / PHP 8.x deprecated warnings in development environment The problem:\nI want to run Wordpress 6.x with PHP 8.x in development mode - meaning define('WP_DEBUG', true); but Wordpress 6.x partial support for PHP 8.x throws a lot of deprecated warnings which do a lot of mess on the screen and also mess with cookies and REST API.\nSetting error_reporting(E_ALL & ~E_DEPRECATED & ~E_USER_DEPRECATED); in php.ini or wp-config.php does not solve the problem because Wordpress overwrites this setting when you set define('WP_DEBUG', true); which you want normally have for the  development.\nThe solution is no straight forward and I couldn't find fast, either on Stack or anywhere else so below I will answer my own question and solve the problem for others.\n\nA: change the line that sets error_reporting in wp-includes/load.php, probably around line 450:\nif ( WP_DEBUG ) {\n    error_reporting( E_ALL);\n\njust add the  & ~E_DEPRECATED bit so it becomes:\nif ( WP_DEBUG ) {\n    error_reporting( E_ALL & ~E_DEPRECATED );\n\n[wordpress rant] - why would they not put something like this in the config file? In my (painful) experience of writing plugins & child themes for wordpress it's impossible to use debug mode not because of problems in my code but deprecated code in literally dozens of files throughout the codebase, ALWAYS. This renders WP_DEBUG useless. And don't get me started about how simple it would be to implement by default the multi-environment support I always have to hack into the wp-config.php file (I assume everyone else probably does this too) :-( [rant over(!!)]\n\nA: The key to the solution is enable_wp_debug_mode_checks filter but to use it you have to do something special.\nAs the documentation says:\n\nThis filter runs before it can be used by plugins. It is designed for\nnon-web runtimes. Returning false causes the WP_DEBUG and related\nconstants to not be checked and the default PHP values for errors will\nbe used unless you take care to update them yourself.\nTo use this filter you must define a $wp_filter global before\nWordPress loads, usually in wp-config.php.\n\nThen when you disable this default error reporting overwrite - you can set your own.\nSo the final solution looks like this:\ndefine('WP_DEBUG', true);\n\nif (WP_DEBUG) {\n  define('WP_DEBUG_LOG', true);\n  define('WP_DEBUG_DISPLAY', true);\n\n  // disable friendly non informative error messages\n  define('WP_DISABLE_FATAL_ERROR_HANDLER', true);\n\n  $GLOBALS['wp_filter'] = [\n    'enable_wp_debug_mode_checks' => [\n      10 => [[\n        'accepted_args' => 0,\n        'function'      => function() { return false; },\n      ]],\n    ],\n  ];\n}\n\nerror_reporting(E_ALL & ~E_DEPRECATED & ~E_USER_DEPRECATED);\n\nUnfortunately it turns off automatically also deprecated messages from your own code, but what can you do until Wordpress solves its deprecated code fragments.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406490", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Why is the file not uploading to the server? On wordpress page i am using inline vue, because form is too complex.\nlet formData = new FormData();\nformData.append(\"action\", \"topcare\");\nformData.append(\"nonce\", true_object.nonce);\nformData.append(\"administration_desc\", this.controls.administration_desc);\nformData.append(\"administrator_file\", this.controls.fileList[0]);\n\nfetch(url, {\n        method: 'POST',\n        body: formData,\n    })\n    .then(res => res.json())\n    .then(res => {\n        this.formSuccess = true;\n        this.formWasSent = true;\n        this.loading = false;\n        console.log(JSON.stringify(res, null, 4));\n        setTimeout(() => {\n            this.formSuccess = false;\n        }, 2000)\n    }).catch(error => {\n        this.formSuccess = false;\n        this.formWasSent = true;\n        this.loading = false;\n        console.log(JSON.stringify(error, null, 4));\n    })\n\nAs i understood, i don't need to set Conte-type: multipart-form-data in fetch, because it will be set automaticaly.\nServer php file:\n<?php\nfunction true_localize_example()\n{\n    wp_enqueue_script('truescript', get_template_directory_uri() . '/vue/topcare/ajax.js', [], null, false);\n    wp_localize_script('truescript', 'true_object', array(\n        'ajax_url' => admin_url('admin-ajax.php'),\n        'nonce'    => wp_create_nonce('feedback-nonce'),\n    ));\n}\nadd_action('wp_enqueue_scripts', 'true_localize_example');\nadd_action('wp_ajax_topcare', 'ajax_form');\nadd_action('wp_ajax_nopriv_topcare', 'ajax_form');\nfunction ajax_form()\n{\n    if (!wp_verify_nonce($_POST['nonce'], 'feedback-nonce')) {\n        wp_die('Data was recieved from another address');\n    }\n    if (!empty($_POST['checkField'])) {\n        wp_die('This is a spam');\n    }\n\n    die(json_encode(array('type' => 'files', 'text' => $_FILES))\n    \n\nAnd $_FILES is empty.\nWhy?\nThanks in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406495", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Url Rewriting a dynamic wordpress page with parameters I am struggling a bit with how to rewrite a WordPress URL.\nI have two custom post types that I gave these url structures:\nmysite.com/erika-mustermann/\nmysite.com/offer/shoe-repair/?bername=Erika-Mustermann&angname=shoe-repair&id=2177\n\nThe goal is to have the shoe-repair URL like this:\nmysite.com/erika-mustermann/shoe-repair\n\nMy Problem is that there is not only /erika-mustermann/ but several other urls like /peter-parker/. But there is only one page with /shoe-repair/ (they only differ through the page parameters I've added in the template). I don't want to make a new shoe repair page for every name, I just want custom links like:\nmysite.com/erika-mustermann/shoe-repair\nmysite.com/peter-parker/shoe-repair\n\nI tried several rewrite rules but I don't get anywhere. Here I thought that would rewrite the offer-page to mysite.com/offer/shoe-repair/erika-mustermann or mysite.com/offer/shoe-repair/peter-parker. But that doesn't work and only leads to an archive page\nadd_rewrite_rule( \n    '^offer/([^/]*)/([^/]*)/?',\n    'index.php?bername=$matches[2]',\n    'top'\n  );\n\nadd_filter('query_vars', 'foo_my_query_vars');\nfunction foo_my_query_vars($vars){\n    $vars[] = 'bername';\n   \n    return $vars;\n}\n\nThanks a lot for your help!\n\nA:  '^offer/([^/]*)/([^/]*)/?',\n\nWhy do you have a question mark here at the end, that doesn't do anything here.\nYou also need to add_rewrite_tag otherwise it will never work.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406496", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is it possible to create custom links inside a template? I'm creating a template for a custom post type with the URL structure of\nTEMPLATE ONE\nmysite.com/firstname1-lastname1/\nmysite.com/firstname2-lastname2/\n... etc\n\nI also have pages from a custom post type that I want to link to from the first CPT with a custom URL.\nTEMPLATE TWO\nmysite.com/offers/offer1/\nmysite.com/offers/offer2/\netc ...\n\nBasically I want to link from a TEMPLATE ONE page to a TEMPLATE TWO page but change the link into mysite.com/firstname1-lastname1/offer1. Each offer page exist only once while there are several name pages that need a custom link to the offer page. Is that even possible?\nThe end result should be this:\nmysite.com/offers/offer1/  -> mysite.com/firstname1-lastname1/offer1\nmysite.com/offers/offer1/ -> mysite.com/firstname2-lastname2/offer1\n\nmysite.com/offers/offer2/  -> mysite.com/firstname1-lastname1/offer2\nmysite.com/offers/offer2/ -> mysite.com/firstname2-lastname2/offer2\netc...\n\nSomeone told me that I maybe can render TEMPLATE 2 into TEMPLATE 1 on a link click. But I don't know how. They suggested https://developer.wordpress.org/reference/hooks/template_include/ But how would I even get the content of the TEMPLATE TWO pages with that?\nDoes anyone has any hints, ideas?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406504", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Pagination in single.php I have a problem with the pagination on a single.php page.\nThe idea is to have a list of my created posts (the excert, the title and a link to the post) on the post page (single.php) that shares the same category with the one that I'm viewing.\nI have a custom loop that filters the category and the maximum number of posts to show per page, but the next page doesn't exist (even manually writing the: www.example.com/my-post/page/2, /?page=2/ or /2/). It redirects me to www.example.com/my-post/\nIf I manually change the $page variable, the posts listed change to the next ones that should be shown.\nAny idea why the links in the single.php don't work as in a page template?\nHere is the code of my custom wp_query and the pagination (I know its a bit awkward, but on my other page Template works perfectly :\nthe_content(); // The post edited in the WP editor //\n\n$number_of_posts = get_field('number_of_posts');\n\n$arg = array(\n'post_type'   => 'post',            \n'showposts'   => -1,    \n'post_status' => 'any',\n'cat'         => $actual_cat_id,    \n); \n\n$count_query = new WP_Query($arg);  \n$total_post = $count_query->post_count;\n$total_pages = ceil($total_post/$number_of_posts); \n\nif (get_query_var('paged') == null) {   \n$page= 1;                           \n} else {\n$page = get_query_var('paged');     \n}\n                                        \n$arguments = array(     \n 'post_type'    => 'post',  \n 'post__not_in' => array($actual_post_id),  \n 'showposts'    => $number_of_posts,            \n 'paged'       => $page,    \n 'orderby'     => 'date',               \n 'order'       => 'DESC',                   \n 'post_status'  => 'any',                   \n 'cat'         => $actual_cat_id,   \n);\n\n$paged = $page;\n\n$my_query = new WP_Query($arguments);\n\nwhile...\n\n// THE LOOP (with the excert and the title for each post) //\n\n...endwhile\n\nwp_reset_postdata();\n\n// PGINATION WITH ARROWS //\nif ($total_pages == 1) { \n\n <div>\n  <span> &lt;&lt; </span>\n  <span> &lt; </span>\n  <span> PAG <?php echo $paged.\"/\". $total_pages; ?> </span>\n  <span> &gt; </span>\n  <span> &gt;&gt; </span>\n </div>\n\n } elseif ($paged == 1) {\n  $paged_siguiente = $paged+1; \n  <div>\n    <span> &lt;&lt; </span>\n    <span> &lt; </span>\n    <span> PAG <?php echo $paged.\"/\". $total_pages; ?> </span>\n    <a href=\"?paged=<?php echo $paged_siguiente; ?>\"> <span> &gt; </span> </a>\n    <a href=\"?paged=<?php echo $total_pages; ?>\"> <span> &gt;&gt; </span> </a> \n  </div>\n\n } elseif ($paged>1 && $paged<$total_pages) {\n  $paged_siguiente = $paged+1;\n  $paged_atras = $paged-1;\n\n   <div>\n    <a href=\"?paged=1\"> <span> &lt;&lt; </span> </a>\n    <a href=\"?paged=<?php echo $paged_atras; ?>\"> <span> &lt; </span> </a>\n    <span> PAG <?php echo $paged.\"/\". $total_pages; ?> </span>\n    <a href=\"?paged=<?php echo $paged_siguiente; ?>\"> <span> &gt; </span> </a>\n    <a href=\"?paged=<?php echo $total_pages; ?>\"> <span> &gt;&gt; </span> </a>\n   </div> \n} elseif ($paged == $total_pages) { \n $paged_atras = $paged-1; \n\n <div>\n    <a href=\"?paged=1\"> <span> &lt;&lt; </span> </a>\n    <a href=\"?paged=<?php echo $paged_atras; ?>\"> <span> &lt; </span> </a>\n    <span> PAG <?php echo $paged.\"/\". $total_pages; ?> </span>\n    <span> &gt; </span>\n    <span> &gt;&gt; </span>\n </div> \n} \n\n\nA: Custom loops do not produce pagination like that.\nYou have two options:\n\n*\n\n*Use custom archive page and provide custom php template for that (i.e. archive-my_name.php), in this custom template you could provide all other necessary content. Then you could use standard built-in pagination functions https://developer.wordpress.org/themes/functionality/pagination/\n\n*Continue in the direction you started, with single.php, but you would need to provide your own pagination, together with rewrites for custom pages. Again, https://developer.wordpress.org/themes/functionality/pagination/#methods-for-displaying-pagination-links provides starting point for that.\n\nI advise using option 1. as easier.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406505", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disable gzip on WordPress I can see WordPress enables Gzip compression on the site\nI disabled all plugins to ensure that no plugin enabled that\nAnd also I created a simple php script and it doesn't enable gzip by default by Web Server\nSo I think WordPress enable Gzip in it's code\nHow can I prevent WordPress to enable Gzip?\n\nA: *\n\n*Check .htaccess on /home/ and /homr/public_html/ (For example of site root), Probably there are some codes there to add gzip to the web server\n\n*a web server can enable the gzip as default\n\n*check php.ini file for zlib.output_compression value, It should be off\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406507", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there a way to migrate via wordpress dashboard? I have a website on aws lightsail that I can no longer ssh into. I can login via wordpress but for some reason ssh is no longer working.\nIs there a way to export my wordpress instance via the wordpress dashboard?\n\nA: You can give a try to a Backup WordPress plugin. They usually create a zip file with all files and DB.\nThen you can download it and install it where you need to migrate too.\nhttps://wordpress.org/plugins/search/backup/\nYou can also find some tools like https://wordpress.org/plugins/file-manager-advanced/ & https://wordpress.org/plugins/wp-phpmyadmin-extension/ which can help you\nHope it will help\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406508", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Popover in a LinkControl style I created an TextControl inside Popover component, which opens when block toolbar button is pressed. It works fine, with one annoying problem. When user types in TextControl, React redraw of component is triggered and annoying Popover animation happens on each typed character. This does not happen in LinkControl component, which also has Popover as top component. How to achieve this, I could not figure it out from the Gutenberg code? In my excerpt from the code, you'll see that I tried to prevent re-rendering with ref, but without success. I could set animate prop on Popover to be disabled upon text is entered in Textcontrol, but his is not how LinkControl works.\n...\n    const [isInputDialogVisible, setIsInputDialogVisible] = useState(false);\n    // attempt to prevent re-rendering\n    const focusOnMount = useRef( 'firstElement' );\n    const InputNameDialog = () =>\n        <Popover\n            onClose={() => { setIsInputDialogVisible(false) }}\n            focusOnMount={focusOnMount.current}\n        >\n            <TextControl\n                className='name-attribute'\n                label={ _x('Control name', 'Popup control name', 'namespace') }\n                help={ _x('This is title of field', 'Popup help text', 'namespace') }\n                value={ attributes.nameAutoSet ? '' : attributes.name }\n                onChange={ (name) => setName({ name }) }\n            />\n        </Popover>\n\n...\n            <BlockControls group=\"block\">\n                <ToolbarButton\n                    onClick={() => { setIsInputDialogVisible(true) }}\n                    icon=\"nametag\"\n                >\n                    { isInputDialogVisible && <InputNameDialog /> }\n                </ToolbarButton>\n            </BlockControls>\n...\n\nSo, my question is how to set up the code so it works as LinkControl, preventing redrawing of the component when text is entered in TextControl?\n\nA: It seems I'll have to answer my question myself :)\nThe solution that I found is using uncontrolled form input component (substituting <TextControl>, or more precisely, I opted to use __experimentalInputControl, with prop isPressEnterToChange={ true }, which only updates control on pressing Enter. I did not inspect the code, but I believe firmly that it is uncontrolled and that uncontrolled <input /> would work as well. This is because uncontrolled component does not trigger react re-render and controlling of the component is given to the browser.\n        <InputControl\n            // use this in order to have uncontrolled control - otherwise updates trigger popover refresh\n            isPressEnterToChange={ true }\n            className='name-attribute'\n            label={ _x('Control name', 'Popup control name', 'block-form') }\n            value={ nameAutoSet ? '' : name }\n            onChange={ (name) => { setName( name ); closePopover() } }\n            suffix={\n                <Button\n                    icon={keyboardReturn}\n                    onClick={closePopover}\n                />\n            }\n        />\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406509", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: WooCommerce - I want to add functionality of one plugin to another plugin -- best approach? We have a WooCommerce plugin that tracks our customers.  We want to add the functionality allowing our Customer Reps to schedule an appointment with a different plugin.  The idea is to allow someone looking at the customer detail screen and if they decide the customer needs more attention, schedule a meeting (using another plugin.)\nI'm new to WP/Woo (but not to application development) and am looking for best practices.  So:\nCustomer List -> Customer Detail\nFrom Customer Detail -> a button that initiates a popup allowing the CSR to schedule a follow-up.\nI have a message into the author of the customer plugin but have not heard back yet.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406511", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to change format jpg to webp? i have about 3750 thumbnails that i have converted to webp (without plugin), how do i change the file name, file type and file url in the media library at once, without having to re-upload one by one. how do i change it in mysql, sorry i don't know how because i don't have basic programming.\n\nExample :\nFile name: image.jpg change to File name: image.webp\nFile type: image/jpeg change to File type: image/webp\nFile url: sitecom/wp-content/uploads/2022/06/image.jpg change to File url: sitecom/wp-content/uploads/2022/06/image.webp\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406512", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Plugin URL in JS In my plugin I need to include a localization JSON resource for an external library I'll be using. The localization for the particular library gets invoked like this:\n$('#table-id').DataTable( {\n    language: {\n        url: 'http://domain.tld/wp-content/plugins/my-plugin-name/assets/js/i18n/fr_FR.json'\n    }\n} );\n\nHow do I get in JS this http://domain.tld/wp-content/plugins/my-plugin-name/ though, so that I don't have to hardcode it?\nIn PHP it's easy as I've even assigned it to a constant. But in JS?\nEdit: Of course I can echo the URL within the JS script, but is this actually the proper way to do it?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406513", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Woocommerce order status payment I have some issue with Woocommerce client already do the payment, but then i see as order pending payment, but this should be in order status processing thats the default settings\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406514", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Indenting within a blockquote I\u2019m trying to further indent text within blockquotes, but I\u2019m not sure how to do that. It\u2019s not letting me add bullet points or other forms of indentation.\nSpecifically, I'd like the sentences starting with A/B/C to be indented more on this page:\nIs there any way to do this?\nThanks :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406516", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Embedding Password Protected (Private) \"Blog Posts\" BLOCK that shows Images and Excerpts on Password Protected Page (not the home page) My request is almost identical to that of the\nPrivate Post BUT Public excerpt on Homepage thread (similar use), with exception to this request being about a page that isn't set as the home page (regular page; not a post). I have the Premium WordPress account.\nI have created a private password-protected page (not the homepage) with a URL of /aggregator then I created a private post and gave it a unique category.\nWhen I go to embed the Blog Posts block and select the category, a message of \"Sorry, no posts were found.\" is displayed while drafting, with nothing displayed when previewed (or published). Because private blog posts are excluded. (I have a plugin that allows me to exclude certain categories or tags from the homepage; so I'm covered there).\nI'd like a password-protected private page with the password-protected private posts previewed (image with excerpts) on the password-protected private page, then once the title or \"Read More\" is clicked, a password prompt will be displayed to read the full content. I could not find a plugin that achieves this.\nI am using a child theme for Morden. My permalinks for posts are set to /%author%/%postname%/\nIf you need more information, please let me know. Thank you so much for any and all help and or direction you can provide.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406521", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Getting Shortcode Attributes befor content is displayed by the template This regards getting the shortcode attributes to be used in a function called after the shortcode is defined, in a template.  The page that uses that template has the shortcode plus attributes, as in [mycontactform email = \"fred@example.com\", bcc = \"mary@domain.com\"]\nThe shortcode attributes will be used in a form that is displayed in the page where the [mycontactform] is entered.\nThe process should:\n\n*\n\n*define/set the shortcode with the add_shortcode filter\n\n*get the shortcode attributes, if any. The attributes are optional, and are user-supplied (there are no default attribute values).\n\n*include an 'includes.php' function file that contains functions to process the form, including using the shortcode attributes as parameters in the functions.\n\n*the template code starts, building the page, inserting the code that is built by the shortcode.\n\n*the template finishes.\n\nMy issue is probably one of timing. The shortcode is defined before the template, with a\nadd_shortcode( 'mycontactform', 'do_mycontactform ' );\nThe do_mycontactform function contains code that builds the contact form, including using the shortcode parameters inside the form (as hidden input fields, for example). So if the shortcode has attributes, use those attributes in various includes.php function as needed.\nSo the shortcode attributes need to be used in the code that processes the shortcode.\nPsuedocode for the mycontactform function (that processes the shortcode)\nfunction do_mycontactform () {\n    // get the attributes in the shortcode from the page content if any are\n         set in the shortcode (attributes are optional)\n    // if there are attributes, set them as constants to be used elsewhere; \n         with a loop like \n    if (has_shortcode($post->post_content, \"mycontactform\")) {\n        // loop through the attributes, setting constants}\n    // build the form, including the input field that is \n          based on the shortcode attributes (which should now be constants)\n    // display the form, using functions as needed from \n          the includes.php that was included at the top of the template\n\nI need to use those attributes as constants because those constant variables need to be used in multiple includes.php functions.\nI'm having issues getting the shortcode attributes before the page is built by the template. I think it's a timing issue with the extraction of the attributes done too 'late' to be used by the shortcode function. I've searched through the shortcode API, but haven't found anything that works.\nI tried shortcode_atts(), but I don't need to set shortcode attribute defaults, I just need to get those attributes into constances.\nHow can I get the timing right on the above psuedocode so that attributes from the shortcode can be set as constants, with the constants used inside includes.php functions?\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406526", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add class to all img if they have a certain ACF field I have an ACF field for image attachments so the user can choose 'rounded border' or 'square border'. How can I apply a class to all images depending on the value of that ACF field?\nI can do it if the image is hardcoded into the template, but when it's part of a WYSIWYG editor I don't know how to target it and get the attachment meta data.\nHere's how I do it on hardcoded images:\n<?php\n$attachments = get_sub_field('images');\nforeach($attachments as $attachment){\n  $corners = get_field('rounded_corners', $attachment['ID']);\n?>\n<img class=\"<?php echo $corners; ?>\">\n<?php endforeach; ?>\n\nDoes anyone know how I can apply something similar to any WYSIWYG images?\nI found the following from another answer, but I'm not sure how to query the ACF field...\nfunction add_responsive_class($content)\n{\n    $content = mb_convert_encoding($content, 'HTML-ENTITIES', \"UTF-8\");\n    if (!empty($content)) {\n        $document = new DOMDocument();\n        libxml_use_internal_errors(true);\n        $document->loadHTML(utf8_decode($content));\n\n        $imgs = $document->getElementsByTagName('img');\n        foreach ($imgs as $img) {\n          /* I'd want something here to look for $img['ID'] and then the ACF... */\n          $img->setAttribute('class', 'img-fluid');\n        }\n\n        $html = $document->saveHTML();\n        return $html;\n    }\n}\nadd_filter('the_content', 'add_responsive_class');\n\nAny help is greatly appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406534", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Link a button to woofunnels model How can I link command button of woocommerce menu cart to a woofunnels page I searched a lot but I didn't found the solution please may you help me to solve this issue\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406535", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there a plugin for automatically adding a word or symbol after a trigger word? I.e. Like a search and replace but more like search and add? I have a client whose business is now trademarked and would like the TM symbol to appear after the business name.\nI could go in and manually add it to every instance the business name appears, but I'm wondering if there's a plugin that could find the business name and automatically add the TM symbol after each instance.\nAny other suggestions, other than plugins are welcome, but I think a plugin would be easiest - just hope it exists!\n\nA: This would run a find-and-replace on displaying the title and content field:\nfunction wpse_406537_search_replace( $content ) {\n    $company_name = 'The Company';\n\n    $company_name_regex = preg_quote( $company_name, '/' );\n\n    // Best-guess attempt at replacing company name that doesn't yet have \u2122\ufe0f\n    // e.g. The Company[space]\n    // e.g. The Company.\n    // e.g. The Company,\n    // e.g. The Company[end of string]\n    $content = preg_replace(\n        \"/$company_name_regex( |\\.|,|\\$)/i\",\n        \"$company_name\u2122\ufe0f\",\n        $content\n    );\n\n    return $content;\n}\n\nadd_filter( 'the_content', 'wpse_406537_search_replace' );\nadd_filter( 'the_title', 'wpse_406537_search_replace' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406537", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp_insert_post_data: Limit number of Page but Post get affected I want to limit Page creation to be 3, without interfering other post type like Post. I'm using below function:\n  function set_post_to_draft_page_only( $data, $postarr ) {\n    if($data['post_type'] == 'page') {\n\n      if( wp_count_posts('page')->publish > 2 ) {\n        $data['post_status'] = 'draft';\n      }\n      return $data;\n    }\n  }\n  add_filter( 'wp_insert_post_data', 'set_post_to_draft_page_only', 99, 2 );\n\nThe function above works for Page but it will interfere Post (Add New Post will show error). So I added return $data; to exclude Post:\n  function set_post_to_draft_page_only( $data, $postarr ) {\n    if($data['post_type'] == 'page') {\n\n      if( wp_count_posts('page')->publish > 2 ) {\n        $data['post_status'] = 'draft';\n      }\n      return $data;\n    }\n    if($data['post_type'] == 'post') {          // without this part, Add New Post will show error\n      return $data;\n    }\n  }\n  add_filter( 'wp_insert_post_data', 'set_post_to_draft_page_only', 99, 2 );\n\nThis is not good way because if I added more post type, I need to manually add more exception.\nSo what is the better way to only limit Page creation without interfering other post type?\n\nA: I would suggest one slight change to your logic as follows:\nfunction set_post_to_draft_page_only( $data, $postarr ) {\n    if($data['post_type'] == 'page') {\n\n      if( wp_count_posts('page')->publish > 2 ) {\n        $data['post_status'] = 'draft';\n      }\n    }\n    return $data;\n  }\n  add_filter( 'wp_insert_post_data', 'set_post_to_draft_page_only', 99, 2 );\n\nYou were not returning $data if post type was anything other than 'page'.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406538", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to fix the Post Preview Button (CPT & map_meta_cap) I'm trying to create a custom post type that can be edited by users with a custom role (as well as administrators, editors and authors).\nAlthought the idea for the users with this custom role is for them to not be able to create, delete or view the CPT list via admin. They should only be able to edit non-private CPTs assigned to them by administrators, editors or authors.\nSetup:\nregister a custom post type with\n'capability_type' => [ 'cpt', 'cpts' ]\n'capabilities'    => [ 'create_posts' => 'create_cpts' ]\n'map_meta_cap'    => true\n\nand a post meta cpt_administrator containing the ID of the user to which the post has been assigned;\nadd a custom role cpt_administrator with only these capabilities:\n'read',\n'edit_published_cpts',\n'upload_files',\n\nand add a filter for map_meta_cap to remove the capability edit_others_cpts from the current post if the meta cpt_administrator corresponds to the ID of the current user.\nEverything is working well except for the Preview button (both on the classic and and on the block editor)\nOn the Block Editor the \"Preview\" dropdown is missing the \"Preview in new tab\" button.\nThis button appears only if I grant edit_cpts to cpt_administrator, which I don't want to do in order to avoid the user to view the CPT list via admin.\nOn the Classic Editor: the \"Preview\" button doesn't redirect properly if left-clicked (it sends to /wp-admin/post.php without query parameters).\nAlthough it works if mousewheel-clicked (opened in a new tab)\nI was considering to report this behaviour on Trac, but first I would have like to know if there was any workaround for that, although I didn't found any filter I can hook to in order to fix this behaviour.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406539", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Dynamic page generation upon purchase of a product I'm working on a custom plugin but I need some ideas on how to implement a sub-task of the plugin in the most efficient way.\nSo the user will be purchasing in Woo a ticket to participate in a quiz. Once they pay, they will be getting a confirmation email (like what is happening now with any normal purchase), where a link will also be included, of the page to take the quiz. The quiz itself will have a number of multiple choice questions, and its page will have to be accessible only by the person who purchased a participation ticket.\nWhat is the most efficient way to do that? Apart from the checks (whether the user is logged in and has purchased a ticket)? I wouldn't like a solution where I will have to manually insert a Page, and then create/insert a shortcode to use in that page. Ideally I'd appreciate an example of a totally dynamically created page (with the appropriate rewrite rules)! Thank you!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406540", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Filter nav menu items HTML tags and wrap inner text with span I am using the following filter to select <a> tags from a specific menu that have no attributes (href, class, etc.) and replace them with <button> tags.\nadd_filter( 'wp_nav_menu_items', 'filter_empty_anchor_items', 10, 2 );\nfunction filter_empty_anchor_items( $items, $args ) {\n  if( $args->theme_location == 'want-to-navigation')  {\n    $pattern = '/<a>(.*?)<\\/a>/s';\n    $items = preg_replace($pattern, '<button>$1</button>', $items );\n  }\n  return $items;\n}\n\nThe filter itself is working, but I need to adjust the regular expression or run a second pass of a separate regular expression to select the text within the <button> tag and wrap it with a <span> tag.\nThe following wp_nav_menu code is being used to display the menu with a <svg> attached to the link_after argument.\n$args = array(\n  \"theme_location\" => \"want-to-navigation\",\n  \"menu_id\" => \"want-to-navigation\",\n  \"container\" => \"false\",\n  \"container_id\" => \"want-to\",\n  \"container_class\" => \"quicklinks\",\n  \"link_after\" => '<svg viewBox=\"0 0 448 512\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"m432 256c0 17.69-14.33 32.01-32 32.01h-144v144c0 17.69-14.33 31.99-32 31.99s-32-14.3-32-31.99v-144h-144c-17.67 0-32-14.32-32-32.01s14.33-31.99 32-31.99h144v-144c0-17.69 14.33-32.01 32-32.01s32 14.32 32 32.01v144h144c17.7-.01 32 14.29 32 31.99z\"/></svg>',\n);\necho wp_nav_menu( $args );\n\nAn example: Select <button>Select this text and wrap with span<svg></svg></button>\n\nA: Just use link_before in your wp_nav_menu $args and add opening/closing span tags:\n$args = [\n    'link_before' => '<span>',\n    /* Add closing </span> to link_after */\n    'link_after' => '</span><svg>...</svg>',\n\n    // Other args\n];\n\n\nA: Here is my solution with assistance from TheDeadMedic.\nI added the <svg> code to the replacement value in the preg_replace function, then added the opening and closing <span> tags to the link_before and link_after arguments in the theme template file.\nNav menu items filter\nadd_filter( 'wp_nav_menu_items', 'filter_empty_anchor_items', 10, 2 );\nfunction filter_empty_anchor_items( $items, $args ) {\n  if( $args->theme_location == 'want-to-navigation') {\n    $pattern = '/<a>(.*?)<\\/a>/s';\n    $replacement = '<button>$1<svg viewBox=\"0 0 448 512\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"m432 256c0 17.69-14.33 32.01-32 32.01h-144v144c0 17.69-14.33 31.99-32 31.99s-32-14.3-32-31.99v-144h-144c-17.67 0-32-14.32-32-32.01s14.33-31.99 32-31.99h144v-144c0-17.69 14.33-32.01 32-32.01s32 14.32 32 32.01v144h144c17.7-.01 32 14.29 32 31.99z\"/></svg></button>';\n    $items = preg_replace($pattern, $replacement, $items );\n  }\n  return $items;\n}\n\nNav menu output\n$args = array(\n  \"theme_location\" => \"want-to-navigation\",\n  \"menu_id\" => \"want-to-navigation\",\n  \"container\" => \"false\",\n  \"container_id\" => \"want-to\",\n  \"container_class\" => \"quicklinks\",\n  \"link_before\" => '<span>',\n  \"link_after\" => '</span>',\n);\n\nI hope this is helpful to others needing to achieve something similar.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406541", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change permalinks for posts & for custom post types I need to change blog post permalink to /post/post-title & I want to remove \"custom-post-type\" slug from the custom post type so that /custom-post-title will be shown.\nThese two doesn't work with each other, I can either remove custom-post-slug with rewrite or I can add post to blog-post with permalink in settings. I even tried PHP codes to do same, but didn't work.\nHow can I get desired output? Already tried rewrite slug for CPT & with_front=false.\n\nA: with_front=false is the key, but WordPress also seems to like to hard-cache the settings you originally register a CPT with. Try unregister_post_type() above the CPT registration so it's completely removed and immediately added again from scratch with the with_front setting.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406542", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Choose which plugin to run based on user? I would like to know if there is way to only activate plugins (my own custom plugins) for specific users?\nIs there a way to do this using PHP myself and determine which plugin loads based on either user ID or role (or any other factor really).\nIf this isn't possible, is it possible within the plugin itself to determine which plugin files are loaded again based on the user or role?\nI have tried this before in the main plugin file that includes all of my plugin files, but it seems to break the site when I do something like:\nif(get_current_user_ID() == 9) {\n\ninclude_once(dirname(__FILE__).\"/MyPluginFiles/Directoryone/Controller.php\");\n\n} else {\n\ninclude_once(dirname(__FILE__).\"/MyPluginFilesAlternate/Directoryone/Controller.php\");\n\n}\n\nSo is there some other way to accomplish this?  I wanting to roll out the new plugin, but make it selectable so that people can choose the old experience or the new experience and this would be an easy way to do that I would think.\n\nA: Before loading plugins WP retrieves the list of active and valid plugins with the function wp_get_active_and_valid_plugins. The array of plugins is retrieved in this line:\n$active_plugins = (array) get_option( 'active_plugins', array() );\n\nAs you can see, this involves a call to get_option, which has a filter to manipulate the result. So if you could build a filter like this:\nadd_filter ('option_active_plugins','wpse406546_filter_plugins') {\n  // remove the plugin from the array\n  }\n\nNote that you cannot do something depending on user at this stage, because the current user has not been authenticated yet (see hook order). Also, you must place this filter in a must use plugin, because it must be loaded before WP starts loading the regular plugins.\nFurther on in the loading process, at the init hook, the user is known and you can build an action there to load the plugin depending on current user.\nBeware that there may be unexpected complications if you use this on plugins that you did not develop yourself, because late loading may make the plugin miss a hook. For instance, if you load a plugin at init and the plugin uses the after_setup_theme hook, that will be too late.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406546", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do a I add an attribute to  element (when using block theme)? I have a WordPress website that is using the Twenty Twenty-Two block theme (more specifically, a child theme of it). I want to edit the <html> root HTML element to add an attribute. I want this line of code:\n<html lang=\"en-US\">\n\n... to change into this line of code:\n<html lang=\"en-US\" foo=\"bar\">\n\nSince this a block theme, there is no header.php file to edit. How do I do this?\n\nA: It's possible to use the language_attributes filter as before since the template canvas in FSE contains:\n<html <?php language_attributes(); ?>>\n\nAdd this code to the appropriate place in your theme or plugin:\n<?php\nadd_filter( 'language_attributes', function($lang_attributes) {\n    return \"$lang_attributes foo=\\\"bar\\\"\";\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406556", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: What VSCode extensions are there for working with block themes? I recently took another dive into Wordpress block themes by looking at the TwentyTwentyTwo theme. I'm noticing that all templating seems to take place either in PHP strings or HTML files chalked full of ugly HTML comments.\n\n\nI'm not seeing any tools out there for syntax highlighting and/or formatting for block themes.\nAre WP block theme developers just developing themes in strings and html comments or am I missing something?\n\nA: It's missing some very new blocks (for example templates, template parts), but there is the autocompleter for block grammar.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406558", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: How to set the meta description of a WooCommerce product as its primary category description? I asked Yoast SEO support about this as I'm using their plugin, but they don't have this feature:\nInstead of having to set a meta description for each WooCommerce product I sell, I'd like to set it automatically to the description of the product's category (or primary category, if it has several).\nI found some code to retrieve the product's category description (https://stackoverflow.com/questions/19249756/how-to-display-woocommerce-category-description), but I don't know how to set it as this product's meta description.\nCan you please help? :)\nThank you very much.\n\nA: Use the wpseo_metadesc filter:\nfunction wpse_406559_product_meta_description_from_category( $description ) {\n    if ( ! is_singular( 'product' ) || $description ) {\n        // Bail early if not single product, or custom meta description is already set\n        return $description;\n    }\n\n    $product_cats = get_the_terms( get_queried_object_id(), 'product_cat' );\n\n    // Get first product category\n    $product_cat = is_array( $product_cats ) ? current( $product_cats ) : null;\n\n    if ( $product_cat ) {\n        // Get Yoast SEO term meta\n        $meta = get_option( 'wpseo_taxonomy_meta' );\n\n        // Try to get Yoast SEO meta description for this product category\n        $description = $meta['product_cat'][ $product_cat->term_id ]['wpseo_desc'] ?? null;\n\n        if ( ! $description ) {\n            // Fallback to default product category description field\n            $description = wp_strip_all_tags( $product_cat->description );\n        }\n    }\n\n    return $description;\n}\n\nadd_filter( 'wpseo_metadesc', 'wpse_406559_product_meta_description_from_category' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406559", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Create page (not the post type) dynamically I'm working on a custom plugin where the user/customer will be purchasing a ticket (it'll be a woo product) to take a quiz and win some prize...\nSo suppose the URL of a product/quiz would be like mydomain.tld/product/play-and-win-samsung-galaxy-s22\nWhen the user purchases a ticket to participate in the quiz, I want to redirect them to a page like mydomain.tld/product/play-and-win-samsung-galaxy-s22/play where they will actually take the quiz. Needless to say that in that page the necessary checks will be taking place (like whether the user is logged in and has purchased a ticket)...\nSo how can I create such a dynamic page (not a PT Page), that's dynamic? By dynamic I mean, it'll be 100% programmatically created. No shortcodes attached to a PT Page, nothing. Just pure code... How do we start such a task? Thank you for any suggestions.\n\nA: You need to register a 'rewrite endpoint' using add_rewrite_endpoint():\n<?php\nadd_action(\n    'init',\n    function() {\n        add_rewrite_endpoint( 'play', EP_PERMALINK );\n    }\n);\n\nNow, after flushing permalinks, in whatever template or code you're using for your products you can check this to determine whether the /play version of the URL is being accessed:\n<?php\nif ( false !== get_query_var( 'play', false ) ) {\n    // True for mydomain.tld/product/play-and-win-samsung-galaxy-s22/play\n} else {\n    // True for mydomain.tld/product/play-and-win-samsung-galaxy-s22\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406560", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sanitizing URL in a WordPress plugin I am trying to get the current page url which require the use of $_SERVER[\"REQUEST_URI\"]. \nThe point is how do I need to sanitize the returned URL? \nI tried to use sanitize_url( string $url, string[] $protocols = null ) on the $pageURL variable but this returned \"https\" only as a result.  Using sanitize_url on $_SERVER[\"REQUEST_URI\"] directly made the website goes critical error.\nWhat am I doing wrong here?\nThis is my current code \"which is working\" but not sanitized:\n$pageURL = 'http';\nif( isset($_SERVER[\"HTTPS\"]) ) {\n    if ($_SERVER[\"HTTPS\"] == \"on\") {$pageURL .= \"s\";}\n}\n$pageURL .= \"://\";\nif ($_SERVER[\"SERVER_PORT\"] != \"80\") {\n    $pageURL .= esc_html($_SERVER[\"SERVER_NAME\"].\":\".$_SERVER[\"SERVER_PORT\"].htmlspecialchars\n    ($_SERVER[\"REQUEST_URI\"]));\n} else {\n    $pageURL .= esc_html($_SERVER[\"SERVER_NAME\"].htmlspecialchars($_SERVER[\"REQUEST_URI\"]));\n}\n\n\n\n    $parse = parse_url($pageURL);\n    \n    \nif($parse !== false)\n{\n    return esc_url($pageURL);\n}\nelse{ __return_false();}\n\nContext: This function will be called in the frontend using a short code to get the page URL\n\nA: Good on you for trying to do this properly - but... how about this?\nglobal $wp;\necho esc_url( home_url( $wp->request ) );\n\n\nEDIT:\nVersions of your above code have been written all over the internet - see this SO question with 000s of votes. rather UN-intuitively it's not a super simple thing to do as the client can set some of these themselves, so you're right to want to sanitize.\nSanitization is just the removal of anything you're not expecting in your string... You're expecting a URL - so only allow valid URL characters through. If you don't need to echo out query strings - well then you could also remove everything that's not in your page names or site structure. The point is - you decide - there isn't a function that just does sanitize_this() your job is to work out exactly what the limit is for allowing data through. Maybe one of these work? Look at what is permitted through and decide what's right in that use case.\nGenerally you should only need to sanitize once and escape once to avoid over complication and if you're encoding you don't want to double encode - you could actually be making your code less secure as other functions could be looking for strings such as '<script>' in \"decoded\" strings and only seeing %3Cscript%3E meanwhile your JavaScript decodes and outputs later on. You see what I mean?\nMy point above about using wp is that it's already there for you. Re-writing these functions is asking for mistakes, security implications and odd error conditions and dealing with common PHP issues using your own custom functions is naive at best and arrogant at worse - professionals have already done this for you - why do you want to do it again?\nRegarding the critical issue you mention - sanitize_url( $_SERVER['REQUEST_URI'] ); is valid markup - sanitize_url() is a WordPress function and will need WordPress to have been loaded to work. Check your logs for the exact cause.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406567", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change product_base programmatically I'm building a plugin that will be introducing and managing/handling a new product type (like Simple, Variable, etc), and I want to also change the product_base permalink from product to that new product type, ie. property.\nBut in the sense of building a whole plugin to handle all that, I also want to change the default product_base array key stored in woocommerce_permalinks.\nThe problem is I'm not sure what's the best place to hook my code to... If I hook it in init it'll be executed on every page load, so that's a total waste of resources... What's the best place to hook it? My code isn't something exotic, just a simple:\n if( $permalinks = get_option( 'woocommerce_permalinks' ) ) {\n    $permalinks['product_base'] = 'property';\n    update_option( 'woocommerce_permalinks', $permalinks );\n    flush_rewrite_rules();\n }\n\n\nA: Use your plugin activation hook to make the change. That will only run once, when your plugin is first activated, allowing the user to overwrite that change later (if they want to).\nregister_activation_hook( __FILE__, function () {\n    if ( $permalinks = get_option( 'woocommerce_permalinks' ) ) {\n        $permalinks['product_base'] = 'property';\n        update_option( 'woocommerce_permalinks', $permalinks );\n        flush_rewrite_rules();\n    }\n});\n\nIf you want to always force the permalink settings, use the underlying WordPress hook pre_update_option_$option_name:\nfunction wpse_406568_woocommerce_permalinks( $permalinks ) {\n    $permalinks['product_base'] = 'property';\n\n    return $permalinks;\n}\n\nadd_filter( 'pre_update_option_woocommerce_permalinks', 'wpse_406568_woocommerce_permalinks' );\n\n...that will always override whatever setting the user used for product base when saving their WC permalink settings.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406568", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Redirect Page ID, based on logged-in User Role I am trying to accomplish the following in WordPress via the functions.php file.\nIf user is \"This Role\" \n& If \"Page ID#\" is being visited \nthen \"Redirect\" to this \"Page ID#\"\nI have found many, many examples online that seem to work for others, but I have yet to have any work for me! :(\nAt this point, I think it's something I'm doing wrong :(\nSome notes:\nI already have limitations set so that none of the pages show unless a user is logged in.\nThe page that users get to after logging in is the Home \"Front Page\".\nI have tried the following code so far:\n'global $current_user, $wpdb;\n$role = $wpdb->prefix . 'capabilities';\n$current_user->role = array_keys($current_user->$role);\n$role = $current_user->role[0]; //user role\n$page_title = $post->post_title; //get title  f page\nif($role=='Test_Role' &&  $page_title==\"Browse Equipment\") // compare\n{ \n     wp_redirect('http://www.google.com'); //navigate if so\n}'\n\nAlso:\nfunction redirect_user_role()\n{ \n    if (( 'role' == $user_role ) && is_page(31440))\n    { \n        wp_redirect('https://www.google.com/');\n        exit;\n    } \n}\nadd_action('template_redirect', 'redirect_user_role');\n\nAlso:\nfunction wpse381872_login_redirect( $redirect_to, $request, $user ) {\n    // turn the request url into a post-id\n    $request_id = url_to_postid( $request );\n    if ( isset( $user->roles ) && is_array( $user->roles ) ) {\n        // check for subscribers logging in via 31440\n        if ( 31440 === request_id && in_array( 'Test_Role', $user->roles ) ) {\n            $redirect_to = 'https://www.google.com';\n        }\n    }\n    return $redirect_to;\n}\nadd_filter( 'login_redirect', 'wpse381872_login_redirect', 10, 3 );\n\nAlso:\nadd_action('template_redirect', 'redirect_user_role');  \nfunction redirect_user_role()\n{\n    global $current_user, $wpdb;\n    $role = $wpdb->prefix . 'capabilities';\n    $current_user->role = array_keys($current_user->$role);\n    $role = $current_user->role[0]; //user role\n    if($role=='Test_Role'  &&  is_page(31440))\n    {\n        wp_redirect('http://www.google.com');\n    }\n}\n\nWhat am I missing?\nAny guidance would be super appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406572", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: add_image_size function not working In functions.php i have,\nfunction university_features() {\nadd_theme_support('title-tag');\nadd_theme_support('post-thumbnails');\nadd_image_size('professorLandscape', 400, 260, true);\nadd_image_size('professorPortrait', 480, 650, true);\nadd_image_size('pageBanner', 1500, 350, true);\n}\nadd_action('after_setup_theme', 'university_features');\n\nIn single-professor.php, I have:\n<div class=\"one-third\">\n    <?php the_post_thumbnail('professorPotrait'); ?>\n </div>\n\nBut the image size doesn't change. But, if I put the default size of \"thumbnail\" or any of the others like this:\n    <div class=\"one-third\">\n      <?php the_post_thumbnail('thumbnail'); ?>\n    </div>\n\nit works. What could be the issue? I'm working on localhost.\n\nA: All images before you added new image size will not be resized. You must regenerate all thumbnails. There are lots of thumbnail regeneration plugins that you can use.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406574", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why the wp_localize_script() does not work correct in my case? ( /wp-admin/admin-ajax.php 400 (Bad Request) ) Hi I use the next environment for adding the script and style to my WordPress theme:\nfunction theme_scripts() {\n\n\n// Load the html5 IE.\nwp_enqueue_script('iceers-html5', ' \nhttps://cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.min.js', array(), '');\nwp_script_add_data('iceers-html5', 'conditional', 'lt IE 9');\n\n\nwp_enqueue_style(\n    'styles',\n    get_stylesheet_directory_uri() . '/css/main.min.css'\n);\nwp_enqueue_style(\n    'style',\n    get_stylesheet_directory_uri() . '/style.css'\n);\n\n\n$localize_arr = array(\n    'home_url' => home_url(),\n    'home_path' => get_stylesheet_directory_uri(),\n    'ajax_url' => admin_url('admin-ajax.php'),\n    'nonce' => wp_create_nonce('view-nonce')\n);\n\nwp_enqueue_script( 'scripts', get_template_directory_uri() . '/js/scripts.min.js', array('jquery'), false, true);\n\nwp_localize_script( 'scripts', 'wp_helper', $localize_arr );\n\n\n }\n\n add_action( 'wp_enqueue_scripts', 'theme_scripts' );\n\nBut when I try to create ajax request. There is error in console: POST domain.test/wp-admin/admin-ajax.php 400 (Bad Request) Here is the chunk of code where I try to try do the ajax request:\n      $.ajax({\n            url: wp_helper.ajax_url,\n            data: data,\n            type: 'POST',\n            success: function (data) {\n                $wrapper.removeClass('processing');\n                if (data) {\n                    $('#design-row').append(data);\n                    wp_helper.current_page++;\n                    console.log(wp_helper.current_page);\n                    console.log(wp_helper.max_page);\n                    if (wp_helper.current_page == wp_helper.max_page) {\n                        $container.remove();\n                    }\n                }\n            }\n          });\n\nI can not solve it myself. For my opinion it should work but it does not, and I tried but can not find the error. Please help me to figure out in this situation.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406583", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I reset $wp_query in a function? I'm using a function in my functions.php that finds a specific post in a custom post type depending on a slug. I was wondering if I need to reset $wp_query because I use $wp_query = $posts and $wp_query->set_404() ?\nMy problem is, that I'm not 100% sure where to put wp_reset_postdata() (and if I need to put it here). If I put it before the last \"}\" wouldn't the \"exit\" statement in the error handling prevent the function to get there?\nadd_action('parse_request', 'parse_requests', 0);\nfunction parse_requests() {\n    global $wp, $wp_query;\n    if(isset($wp->query_vars['angebot'])) {\n        // find the angebot post\n        $posts = new WP_Query( array(\n            'post_type' => 'angebote',\n            'name' => $wp->query_vars['angebot'],\n            'post_status' => 'publish'\n        ));\n        if(!empty($posts) ) {\n            // set the global query or set your own variable\n            $wp_query = $posts;\n            \n        } else {\n            // handle error\n            $wp_query->set_404();\n            status_header(404);\n            locate_template('404.php', true);\n            exit;\n        }\n    }\n}\n\n\nA: There's nothing to reset here. wp_reset_postdata() is only required if you're using $posts->the_post() or otherwise modifying the global $post variable.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406584", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disable send password change email to user wordpress I create custom registration for registration process. In here first step I used email for register user. Once user verify his email he can continue his registration process. Once user enter his email i'm insert user data to the db and once user continue his registration process he can enter his password.\nHow ever once he enter new password and click register button password change email working. I want to stop password change email at this point. any idea ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406586", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp_options not returning value for logged out users? I have saved my custom plugin settings inside wp_options table, but when I try to access them using \"get_option\" function it returns me undefined for logout users, but when I logged in it returns me the accurate value saved in the table, anyone can help me why is that happening or is it the default behavior?\nthis is how I am adding the option in wp_options table:\n add_option('token_limit' , $token_limit);\n\nand this is how I am accessing it:\n $token_limit = get_option('token_limit');\n\n\nA: I suspect wp-includes/option.php is not being loaded in your environment. You must have the whole WordPress environment loaded to use get_option(). So e.g. per\ninclude_once 'wp-load.php';\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406587", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Orginization Login for Wordpress I am trying to set up a log in system for my website. My main issue is that there is an already established login system I am required to use. Basically, I need my page to redirect to my organizations login page where the user would log in, and the organizations api would send my website the information I need to handle the user on my side (user name, email, id, ect.). I am very new to wordpress and I am not sure how easy that would be to implement, as all of the guides I found basically assume that you will be using wordpress to login.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406588", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Exclude taxonomy Query if post_type How can I define in pre_get_posts hook on custom post type to not execute the query on a taxonomy.\nI have the following\nif (!empty($newsType) && $newsType == 'press') {\n    //if $newsType exclude the taxonomy query and get just the post_type\n    $taxQuery = [\n        [\n            'taxonomy' => 'news_type',\n            'operator' => 'NOT IN',\n        ]\n    ];\n\n    $this->query->set('post_type', ['press']);\n    $this->query->set( 'tax_query', $taxQuery );\n\n} else {\n    $this->query->set('post_type', ['news', 'press']);\n}\n\n$newsType is the $_GETvariable from request\nIf I do the following\nunset($this->query->query_vars['news_type']); the query will break with\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406589", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Role capabilities issue I need some help with capabilities for a CPT.\nI register a new CPT with a capability type 'agenda'. To do this I use the code below in the register array\n'capability_type'   => 'agenda',\n\nAfter that I added two new roles\nadd_role('owner', 'Eigenaar', \n    array(\n        'read'                  => true,\n        'publish_agendas'       => true,\n        'edit_agenda'           => true,\n        'edit_agendas'          => true,\n        'delete_agenda'         => true,\n        'delete_others_agendas' => true,\n        'delete_others_agenda'  => true\n    )\n);\n\nadd_role('employee', 'Personeel', \n    array(\n        'read' => true,\n        'publish_agendas'       => true,\n        'edit_agenda'           => true,\n        'edit_agendas'          => true,\n        'delete_agenda'         => true\n    )\n);\n\nThe issue what I have\nThe employee can delete and edit also the agenda from the owner and this is not the intention.\nThe employee must be only allowed to edit and delete the own agenda post.\nThe owner had more capabilities and is allowed to edit and delete agenda posts from the employee.\nWho can help me in the right direction?\n\nA: I solved the issue!\nIf you create a new CPT with the function register_post_type\nYou have to add this line in the array with arguments\n'map_meta_cap' => true,\n\nNow you can set capabilities to a role like below\nadd_role('owner', 'Eigenaar', \n    array(\n        'read'                  => true,\n        'publish_agendas'       => true,\n        'edit_agenda'           => true,\n        'edit_agendas'          => true,\n        'delete_agenda'         => true,\n        'delete_others_agendas' => true,\n        'delete_others_agenda'  => true\n    )\n);\n\nadd_role('employee', 'Personeel', \n    array(\n        'read'                  => true,\n        'publish_agendas'       => true,\n        'edit_agenda'           => true,\n        'edit_agendas'          => true,\n        'delete_agenda'         => true,\n        'delete_others_agendas' => false,\n        'delete_others_agenda'  => false\n    )\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406593", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: complex get_posts() query to select child pages I have pages on 2 levels under the main deparments page like below.\nDepartments\n--Department 1 \n-----Course 1 \n-----Course 2 \n--Department 1 \n-----Course 3 \n-----Course 4 \n--Department 3 \n--Department 4 \n\nOn the Departments page I want to list all course pages, not department pages Except for Department 3 and 4 because they dont have and course pages below them.\nHow do I achieve this exactly? This is what I have so far...\n$childpages = get_posts( \n\narray(\n\n'post_type' => 'page',\n'posts_per_page' => -1,\n'child_of'    => $post->post_parent,\n//'post__in' => array(354, 351),    //NOT WORKING   \n'post_parent__not_in' => array($post->ID),      \n'post_status' => 'publish',\n)\n);\n\nreturn $childpages;\n\nThis returns all course pages but not the Department 3 and 4 pages.  I tried to use post__in with those post IDs but this returned nothing.\n\nA: You need a loop for this to handle the condition:\n/** list for course and childless department pages */\n$course_and_childless_department_pages = array();\n\n/** get department pages */\n$department_pages = get_children( array(\n    'post_parent' => $post->ID,\n    'post_type'   => 'page',\n    'post_status' => 'publish',\n) );\n\nforeach ( $department_pages as $department_page ) {\n\n    /** get course pages (for department page) */\n    $course_pages_for_department_page = get_children( array(\n        'post_parent' => $department_page->ID,\n        'post_type'   => 'page',\n        'post_status' => 'publish',\n    ) );\n\n    if ( empty( $course_pages_for_department_page ) ) {\n        /** add empty department page to list */\n        $course_and_childless_department_pages[] = $department_page;\n    } else {\n        /** add course pages to list */\n        $course_and_childless_department_pages = array_merge( $course_and_childless_department_pages, $course_pages_for_department_page );\n    }\n}\n\nreturn $course_and_childless_department_pages;\n\nYou wrote that you are on the Departments page, so the value of $post is the Departments page.\n$course_and_childless_department_pages array will contain all the pages in WP_Post format.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406597", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Call Specific .PHP file on add_submenu_page selection in Plugin Development? I want to structure my Plugin folder & file system in a way, where in add_submenu_page when I will click on my sub menu link it will call separate .php file where i will car specific function which will do their job.\nThis is my Code.\n// If this file is called directly, abort.\nif ( ! defined( 'WPINC' ) ) {\n    die;\n}\n\n/* Adding Plugin Menu to WordPress Dashboard */\nadd_action('admin_menu', 'myfunction_admin_menu');\n\n\n/** Admin Menu **/\nfunction myfunction_admin_menu()\n{\n    \n  // Double check user capabilities\n  if ( !current_user_can('manage_options') ) {\n      return;\n  }\n    \n    // Adding main menu in administrative area.\n\n    add_menu_page('Digital', 'Menu', 'manage_options', 'myfunction', 'myfunction_settings_page', plugins_url('digisol/assets/images/myfunction.png'), 100 );\n    add_submenu_page('myfunction', 'Option 1', 'Option 1', 'manage_options', 'mydifferentfile.php');\n    \n    }\n\n\nfunction myfunction_settings_page()\n{\n    // Double check user capabilities\n    if ( !current_user_can('manage_options') ) {\n      return;\n    }\n    ?>\n    <div class=\"wrap\">\n      <h1><?php esc_html_e( get_admin_page_title() ); ?></h1>\n      <p><?php esc_html_e( 'Some content.', 'myfunction' ); ?></p>\n    </div>\n    <?php\n}\n\nWhere my submenu myfunction will call mydifferentfile.php file from plugin's includes folder.\nIn that file I want Store Some information (Insert/Update/Delete/Display) Operations in specific table of database.\nSo How can I implement it.?\nThank you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406598", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: embed via wp_embed_register_handler only works in front-end I'm trying to create a small plugin that would allow to embed videos from our Kaltura instance. As we are using Kaltura Application Framework (KAF) normal oEmbed is not working :(.\nI have the following code:\nadd_action('plugins_loaded', \n    function() {\n        wp_embed_register_handler(\n            'kalturaplay',\n            '#https://our\\.kaltura\\.site/id/([A-Z0-9_]+)#i',\n            'kaltura_play_embed_handler',\n            100\n        );\n    }\n);\n\nThen I took the iframe embed code and just added in the id:\nfunction kaltura_play_embed_handler( $matches, $attr, $url, $rawattr ) {\n    $embed = '<iframe src=\"https://our.kaltura.kaf.server/and/some/extra/stuff?\n\u2026\nentry_id=' . esc_attr($matches[1]) \u2026\n\nwidth=\"608\" height=\"402\" frameborder=\"0\" allow=\"autoplay *; fullscreen *; encrypted-media *\"></iframe>';  \n    return $embed;\n} \n\nThis works perfectly on the front end, but on the backend nothing shows up. When inspecting the HTML-code in the backend I can see that if I compare to a working embed (like YouTube) I have in the working example something like\niframe\n   body\n     div\n       iframe (with the real embed)\n\nBut my non-working code looks like\niframe\n   body\n      div\n\nand here the div is empty?! So no second iframe! I.e. it seams like WordPress can't load the iframe into the iframe as needed on the backend but on the front end when it only needs the inner iframe it works.\nAny suggestions?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406600", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress not showing manually uploaded files in Uploads folder on Media Library I'm having a script on my wordpress site that uploads file to my site directory at wp-content/uploads while .mp3 is the file extension uploaded by that script.\nThis script worked successfully but when I login to wordpress to visit the media library I couldn't find the files right there.\nPlease is there a permanent way to fix this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406605", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get all user posts from two post types in wp_query When I add 'author' I only get results from \"post\" but no results are received from the \"my_post_type_name\"\nMy code:\n$args = array(\n    'author'        =>  $user_id,\n    'post_type'      => array('my_post_type_name', 'post'),\n);\n$wp_query = new WP_Query( $args );\n\nIs it possible? Or do I need two query?\n\nA: Ye. It is possible with single query.\nWordPress is allowed to fetch posts from different post type. For example, consider the default post types \"post\" and \"page\"\nTo fetch user posts from \"post\" and \"page\", we can use the following query.\n$wp_query = new WP_Query(array(\n    'author' => $user_id,\n    'post_type' => array('post', 'page'),\n    'posts_per_page' => -1\n        )\n);\n\nI have used posts_per_page as -1 to fetch all posts. This is working in a default WordPress install.\nRefer WP_Query for more details.\n\nA: problem solved!\nThe code works great,\nThe problem was that the \"polylang\" plugin filtered out undefined post typs.\nWhen I turned off the plugin all the author's posts appeared\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406607", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add fetchpriority parameter to images in the media library? I want to add a custom field called fetchpriority to the images in the media gallery. This parameter should be added to the image when it is inserted in a post.\nEx: I have an image called logo.png. This is uploaded to the media gallery. I edit the image and put high in the value. Now when the image is inserted in the post, it looks like <img src=\"logo.png\" fetchpriority=\"high\">\nHow do we achieve this? This is a valuable addition to achieving a good LCP score in the PageSpeed Insights.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406610", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Get wordpress installation folder I'm writing a rewrite rule, accompanied by two additional rewrite tags, which (the tags) must apply only on a specific page. In the past, when I had to do something similar, I had done it like this:\nadd_action('init', 'publications_rewrite_rule', 10, 0);\nfunction publications_rewrite_rule()\n{\n    if (preg_match('/^\\/publications\\//', $_SERVER['REQUEST_URI'])) {\n        add_rewrite_tag('%date%', '([^&]+)');\n        add_rewrite_tag('%publication%', '([^&]+)');\n    }\n\n    add_rewrite_rule('publications/([0-9]{4})/([0-9]{2})/([0-9]{2})/?$', 'index.php?page_id=370577&date=$matches[1]$matches[2]$matches[3]', 'top');\n    add_rewrite_rule('publications/([0-9]{4})/([0-9]{2})/([0-9]{2})/([^/]+)/?$', 'index.php?page_id=370577&date=$matches[1]$matches[2]$matches[3]&publication=$matches[4]', 'top');\n}\n\nIn my current project though, WP installation is in a folder, ie. mydomain.tld/wordpress/, so preg_match() won't match the beginning of $_SERVER['REQUEST_URI'] to the page's slug ^\\/quiz\\/. I know I can hardcode WP's installation folder in the pattern, ie. ^\\/wordpress\\/quiz\\/ but I'd like to get it programmatically, so that it works in future projects as well...\nSo how do I get the whole path of the active WP installation? If it's not one folder, like /wordpress/, I want to get the whole path, like /folder1/folder2/, etc, so that I can prepend it to my search pattern and do it the right/safe way...\n\nA: You don't need to do this. As long as your site URL in Settings is set to mydomain.tld/wordpress you don't need to include /wordpress in your rewrite rules.\nIf you look at the rewrite_rules option in the wp_options table you'll see that none of the default rules are using it, because it's not required.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406615", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to get sentence values from wordpress shortcode parameter? I've set up a shortcode that gets sentence value from parameter, but it only returns the first word of the sentence. I've assumed that the shortcode recognizes values after whitespaces, but when I use double quotes, it breaks the shortcode. is there any workaround on this? thanks in advance.\nhere is my code:\nfunction summary_items( $atts , $content = null) {\n\n    $defaults = shortcode_atts( array(\n        'item' => '------',\n    ), $atts );\n\n    $output = '<li>'. esc_attr($defaults['item']) .'</li>';\n    return $output;\n\n}\n\nadd_shortcode( 'summary_items', 'summary_items' );\n\nI use it like this:\n[summary_items item=this is a test] //this outputs \"this\" only.\n[summary_items item=\"this is a test\"] // breaks the shortcode\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406617", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add Support to show Fullwidth Featured Image of Custom Post Types in Wordpress.? I had created custom post type called \"Case Studies\" for my Website.\nNow whenever I am trying share any Post from Case Studies in LinkedIn it showing me preview as small thumb image along with Title in side by side but when I share Blog Post or Page in LinkedIn it shows me full width Image and Title in Below so I can add support to show Image as full width preview for all social media platforms.\nHere is my Case Study code in functions.php\n/* Case Studies Section */\nadd_action( 'init', 'cptui_register_my_cpts_case_studies' );\nfunction cptui_register_my_cpts_case_studies() {\n    $labels = array(\n        \"name\" => \"Case Studies\",\n        \"singular_name\" => \"Case Study\",\n        );\n\n    $args = array(\n        \"labels\" => $labels,\n        \"description\" => \"Create Case Studies Here\",\n        \"public\" => true,\n        \"show_ui\" => true,\n        \"show_in_rest\" => false,\n        \"has_archive\" => false,\n        \"show_in_menu\" => true,\n        \"exclude_from_search\" => false,\n        \"capability_type\" => \"post\",\n        \"map_meta_cap\" => true,\n        \"hierarchical\" => false,\n        \"rewrite\" => false,\n        \"query_var\" => true,\n        \"menu_position\" => 5,       \n        \"supports\" => array( \"title\", \"editor\", \"excerpt\", \"custom-fields\", \"thumbnail\" ),      \n        \"taxonomies\" => array( \"division\", \"cstags\" ),      \n    );\n    register_post_type( \"case_studies\", $args );\n}\n\nadd_action( 'init', 'cptui_register_my_taxes_division' );\nfunction cptui_register_my_taxes_division() {\n\n    $labels = array(\n        \"name\" => \"Division\",\n        \"label\" => \"Division\",\n        );\n\n    $args = array(\n        \"labels\" => $labels,\n        \"hierarchical\" => true,\n        \"label\" => \"Division\",\n        \"show_ui\" => true,\n        \"query_var\" => true,\n        \"rewrite\" => array( 'slug' => 'case-studies', 'with_front' => true ),\n        \"show_admin_column\" => false,\n    );\n    register_taxonomy( \"division\", array( \"case_studies\" ), $args );\n}\n\n\nadd_action( 'init', 'cptui_register_my_taxes_cstags' );\nfunction cptui_register_my_taxes_cstags() {\n\n    $labels = array(\n        \"name\" => \"CSTags\",\n        \"label\" => \"CSTags\",\n        );\n\n    $args = array(\n        \"labels\" => $labels,\n        \"hierarchical\" => true,\n        \"public\" => true,\n        \"publicly_queryable\" => true,\n        \"label\" => \"CSTags\",\n        \"show_ui\" => true,\n        \"query_var\" => true,\n        \"hierarchical\" => false,\n        'rewrite'   => array('slug' => '', 'with_front' => false ),\n        \"show_admin_column\" => false,\n    );\n    register_taxonomy( \"cstags\", array( \"case_studies\" ), $args );\n}\n\nI had allready added add_theme_support('post-thumbnails'); in my functions.php for theme support so why Case Study - Custom Post type is not showing full width preview and page/blog posts are showing.\nfor reference you can check following URLs.\nBlog Post : https://www.hitechdigital.com/dev/blog/how-digital-quantity-take-offs-and-cost-estimation-benefit-millwork-developers-beta/\nCase Study : https://www.hitechdigital.com/dev/blog/how-digital-quantity-take-offs-and-cost-estimation-benefit-millwork-developers-beta/\nAny help is most appreciated.\nThank you.\n\nA: This happens when the image does not have a specific width/height.\nThe image you try to load in your custom-post-type is too small (379x354px). So LinkedIn, Facebook or others will use the layout with the smaller image.\nFacebook says:\nImages that are at least 470\u00d7246 pixels will display as a rectangle with the title and description below. Images that are smaller than 470\u00d7246 pixels will display as a square with the title and description to the right.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406620", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Reset postdata not working on WP_Query in functions.php I'm running a WP_Query in my functions.php, so I can easily access some ACF-fields in my code without having to run that query on every page.\nHowever, the loop changes the post ID to the CPT I'm calling with the WP_Query. This is of course known behavior, so normally I'd just add a wp_reset_postdata() to my query to continue with the page's or post's original ID.\nHowever, no matter where I reset the postdata in my query, it doesn't get reset. A temporary, not so pretty, solution I have found is adding wp_reset_postdata(); after I call the function in my page-file. This fixes it, but isn't very pretty and partially beats the purpose of using the function.\nHere's my function:\nfunction get_root_project_value( $meta_key ) {\n    $args = array(\n      'post_type'         => 'slug',\n      'posts_per_page'    => -1,\n      'meta_query'    => array(\n        array(\n            'key'       => 'project_is_root_project',\n            'value'     => '1',\n        ),\n      )\n    );\n    $project = new WP_Query( $args );\n\n    if ( $project->have_posts() ) {\n        while ( $project->have_posts() ) { $project->the_post();\n            \n            if($meta_key) {\n                $meta_value = get_field($meta_key, get_the_id());\n\n                if($meta_value) {\n                    return $meta_value;\n                } else {\n                    return false;\n                }\n            }\n        }\n        \n        wp_reset_postdata();            \n    } else {\n        return false;\n    }\n\n}\n\nAnd this is how I use it in my code:\n$longitude = get_root_project_value('project_longitude');\nThis will set my current page's ID to the root_project ID, so to reset that (since the wp_reset_postdata() in the function doesn't do that), I add wp_reset_postdata(); just after I set $longitude.\nIs there a way to reset the postdata in the function, instead on every single page I use the function?\n\nA: You don't need to modify the global current post, just use the get_posts() function instead of WP_Query().\nfunction get_root_project_value( $meta_key ) {\n    if ( empty( $meta_key ) ){\n        return false;\n    }\n\n    $args = array(\n        'post_type'      => 'slug',\n        'meta_query'     => array(\n            array(\n                'key'   => 'project_is_root_project',\n                'value' => '1',\n            ),\n        ),\n        'posts_per_page' => 1,      // If you want only one result, set to 1 instead of -1\n        'fields'         => 'ids',  // To get only ids. No need more\n    );\n    $project_ids = get_posts( $args );\n    if ( !empty($project_ids) ){\n        foreach ( $project_ids as $project_id ) {\n            return get_field( $meta_key, $project_id );\n        }\n    }\n    return false;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406622", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress function not defined in AJAX call I need to send some data to my user meta with ajax and when I click on my link where the function start, I got a fatal error caused by undefined function. But when i try my function with a form to send data its work (Sorry for my English i'm native french)\nMy Ajax code :\nfunction share() {\n    alert('bg');\n\n\n    $.ajax({\n        type: 'REQUEST',\n        url:\n            '/wp-content/plugins/novastan_features/features/Limite_of_share/limite.php',\n        dataType: 'json',\n        timeout: 5000,\n    }).done(function (data) {\n        console.log(data);\n    });\n\n    add_action('in_admin_footer', 'add_this_script_footer');\n}\n\nMy link code : \nMy function code :\n$user_id = get_current_user_id();\n$limit = 'ShareLimit';\n\n\nif ( isset( $_REQUEST['limit'] ) ) {\n    if ( get_current_user_id() ) {\n        if ( rcp_user_has_active_membership() ) {\n            if ( get_user_meta( $user_id, $limit, true ) >= 0 ) {\n                if ( get_user_meta( $user_id, $limit, true ) <= 5 ) {\n                    $val = get_user_meta( $user_id, $limit, true ) + 1;\n                    // si elle existe je les enleve\n                    update_user_meta( $user_id, $limit, $val );\n                } else {\n                    echo '<div>' . '<p>Vous avez atteint le nombre de partage autoris\u00e9</p>' . '</div>';\n                }\n            }\n        }\n    }\n    die();\n}\n\nadd_action( 'wp_ajax_share', 'share' );\n\nmy error when it s use `\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406625", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Menu for taxonomies and posts belongs to taxonomy I am currently looking for a solution to the following problem:\nI have a Custom Post Type named \"docs\" and for it a taxonomy \"docs_category\".\nNote: The taxonomy is hierarchical.\nI am now want a dynamic menu for my taxonomies and post related to it.\nSo for example i have \"Blue\" and \"Red\" as a Taxonomy Value.\nAnd Post \"Post1\" which is related to \"Blue\".\nAnd Post \"Post2\" which is realted to \"Blue\".\nAnd Post \"Post3\" which is related to \"Red\".\nI now want my Menu to look like:\n\n*\n*Blue\n*\n*Post1\n*Post2\n\n*\n*Red\n*\n*Post3\nOf course i can build this with the basic menu but if im adding a new Taxonomy Value and new Post i always need to add them manually to the menu. But i want them to add dynamically to the menu. Also i want all post which are not linked to any taxonomy to just display at the first level. Is there any way to handle that?\n\nA: This is quite simple to implement. Get all taxonomies via get_terms() and get the related posts with a custom WP_Query and tax_query.\n// get all terms\n$terms = get_terms( 'docs_category', array(\n    'hide_empty' => true,\n    'parent' => 0,\n) );\n\nif( !empty( $terms ) && !is_wp_error( $terms ) ):\n\n    foreach ( $terms as $term ):\n\n        // fetch current term_id\n        $current_term_id = $term->term_id;\n\n        // get posts by term_id\n        $args = array(\n            'post_type' => 'docs',\n            'post_status' => 'publish',\n            'posts_per_page' => 3,\n            'tax_query' => array(\n                array(\n                    'taxonomy' => 'docs_category',\n                    'field' => 'term_id', // Or 'term_id' or 'name'\n                    'terms' => $term->term_id, // A slug term\n                    'operator' => 'IN',\n                )\n            )\n        );\n\n        $the_query = new WP_Query($args);\n\n        if($the_query->have_posts()):\n\n            while($the_query->have_posts()): the_post();\n\n                // Do your stuff here...\n\n            endwhile;\n            wp_reset_postdata();\n        endif;\n\n    endforeach;\n\nendif;\n\n\nEdit: Sorry i skipped the topic with the posts without taxonomy. But you certaintly get a feel for how it works. You could create another WP_Query and an array of all available taxonomies and use a tax_query with an operator 'NOT IN'.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406626", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: change wordpress pagination url after doing the request I'm working with Wordpress pagination,\nI want to modify the returned URL when I click on a pagination link (number 2 for example in the pagination),\nat the moment I get: https://magicpallet.com/blog-2/page/2/\nThis pagination is used inside a plugin (blog posts in WP-tabs), so I want to modify this URL after the request is sent, to: https://magicpallet.com/blog-2/,\ni need to redirect the URL after request to the link above, because i'm using the shortcode inside menu tabs, and so i need the initial URL of the page so the tabs keeps working and returning its content...\nI'm trying to use hooks to do this, but so far I haven't come across the right one that allows me to do what I mentioned above, i tried paginate_links() , but it changed the request URL all together at the request moment and so i don't receive the result i want.\ni want to only change the URL without changing the data that i receive from the pagination's link i'm clicking on.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406630", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display custom product option in admin order details I'm trying to display the custom product option in admin order panel.\nI was able to pass all the data until the order is completed, but in the admin panel the data is returned is empty array.\nI share the code\nadd_action('woocommerce_checkout_create_order_line_item', 'save_order_item_product_fitting_color', 10, 4 );\nfunction save_order_item_product_fitting_color( $item, $cart_item_key, $cart_item, $order ) {\n    \n        //$item->update_meta_data( 'orderSpec', $cart_item['orderSpec'] );\n         // The WC_Product instance Object\n         $product = $item->get_product();\n    \n         // Get value\n         $cart_item = $product->get_meta( 'orderSpec' );\n         \n         // NOT empty\n         if ( ! empty ( $cart_item ) ) {\n             $item->update_meta_data( 'orderSpec', $cart_item );\n         }\n\n    \n}\n\n// Add header\nfunction action_woocommerce_admin_order_item_headers( $order ) {\n    // Set the column name\n    $column_name = __( 'Specifiche', 'woocommerce' );\n    \n    // Display the column name\n    echo '<th  class=\"my-class\">' . $column_name . '</th>';\n}\nadd_action( 'woocommerce_admin_order_item_headers', 'action_woocommerce_admin_order_item_headers', 10, 1 );\n\n\n\n//Add content\nfunction action_woocommerce_admin_order_item_values( $product, $item, $item_id ) {\n    // Only for \"line_item\" items type, to avoid errors\n    if ( ! $item->is_type('line_item') ) return;\n\n    // Get value\n    $cart_item = $item->get_meta( 'orderSpec' );\n    \n    \n\n    // NOT empty\n    if ( ! empty ( $cart_item ) ) {\n        echo '<td>';\n         foreach($cart_item as $key => $value){ \n            \n        echo '<strong>'.$key.'</strong> : '.$value;\n    \n    } \n    echo '</td>';\n    } else {\n        echo '<td>Meta not found!</td>';        \n    }\n}\nadd_action( 'woocommerce_admin_order_item_values', 'action_woocommerce_admin_order_item_values', 10, 3 );\n\nThanks for your help\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406635", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to remove js ui library added by default by wordpress I am trying to remove some script files added by wordpress. However, the code I wrote does not work. Where am I doing wrong? Can you show me the way?\nI looked at many sources. But I couldn't find an answer for the ui. I have used the wp_dequeue_script function many times. But it doesn't work for Wordpress.\nchild theme function.php\nadd_action( 'wp_enqueue_scripts', 'a_remove_some_js'); \nfunction a_remove_some_js() { \n     //wp_dequeue_script( 'jquery-ui-core-js');\n    //wp_dequeue_script( 'jquery-ui-tooltip-js');\n    wp_dequeue_script( 'jquery-ui-core');\n    wp_dequeue_script( 'jquery-ui-tooltip');\n}\n\n\nA: The related library is registered with a function called wp_default_scripts.\nFile location (for Wordpress 6.0): ...wp-includes/script-loader.php\nremove to remove the relevant script; The add function is used to add a new script.\n/**\n * Assigns default styles to $styles object.\n *\n * Nothing is returned, because the $styles parameter is passed by reference.\n * Meaning that whatever object is passed will be updated without having to\n * reassign the variable that was passed back to the same value. This saves\n * memory.\n *\n * Adding default styles is not the only task, it also assigns the base_url\n * property, the default version, and text direction for the object.\n *\n * @since 2.6.0\n *\n * @global array $editor_styles\n *\n * @param WP_Styles $styles\n */\n\n\nadd_action( 'wp_default_scripts', 'remove_js_ui_library' );\nfunction remove_js_ui_library( &$scripts){\n    if(!is_admin()){\n        $scripts->remove( 'jquery-ui-core');\n}\n\n}\n\nA: It is add_action, not a filter hook - @ddisdevelpgelis\nYou added it as a filter hook in below code\nadd_filter( 'wp_default_scripts', 'remove_js_ui_library' );\nfunction remove_js_ui_library( &$scripts){\n    if(!is_admin()){\n        $scripts->remove( 'jquery-ui-core');\n    }\n}\n\nMy changes to the above code :\nadd_action( 'wp_default_scripts', 'remove_js_ui_library' );\nfunction remove_js_ui_library( &$scripts){\n    if(!is_admin()){\n        $scripts->remove( 'jquery-ui-core');\n    }\n}\n\nCheckout this link for more information - wp_default_scripts\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406640", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show excerpt and not full post in Twenty Seventeen Help a non-coder out! I tried using child theme configurator, and have successful created a theme child, but it doesn't appear to contain the same code as the parent theme. And all the answers to a similar question I find on the web have a code which I can not find on my version of the theme. This could be due to the fact that they were asked years ago, and the code might be different in the version I have but I am not sure.\nWould appreciate help!\n\n\n\nA: You can do this with just a couple of files, no need for a plugin.\nOn your computer...\n\n*\n\n*Create a folder twentyseventeen-excerpt\n\n*Add the file style.css:\n\n/**\n * Theme Name:  Twenty Seventeen Excerpt\n * Template:    twentyseventeen\n * Version:     1.0\n * Theme URI:   https://wordpress.stackexchange.com/q/406641/1685\n * Author:      the WordPress team\n * Author URI:  https://wordpress.org/\n * Description: Twenty Seventeen with excerpts.\n */\n\n/* Load the core Twenty Seventeen styles */\n@import '../twentyseventeen/style.css';\n\n\n\n*Add the file template-parts/post/content.php:\n\n<?php\n\nif ( is_singular() ) {\n    // Load the default version of this file from Twenty Seventeen\n    include TEMPLATEPATH . '/template-parts/post/content.php';\n} else {\n    // For archive pages (i.e. not singular post pages) load the excerpt content instead\n    get_template_part( 'template-parts/post/content-excerpt' );\n}\n\n\n\n*ZIP the twentyseventeen-excerpt folder and upload it using Appearances > Themes > Add New > Upload Theme\n\n*Activate the newly uploaded theme \"Twenty Seventeen Excerpt\"\n\nFor ease-of-use I have created the final ZIP that you can download in case you are unable to do the above steps yourself.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406641", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hide categories that are not used in the post type I have a situation where I need to display categories on the Archive Page of CPTs, but if the category is not used anywhere in the CPT, it needs to be excluded from the list.\nFor example, I have a CPT for \"Books\" and \"Movies\". I created a post inside the Books CPT and attached it to the \"Horror\" category. I also created another post in the \"Books\" CPT and removed all the categories from it.\nNow, when I add the below code to the archive page, it will show the \"Horror\" category in the \"Books\" Archive page as well as on the \"Movies\" Archive page.\n<?PHP\n$categories = get_categories(\n      array(\n      'orderby' => 'name',\n      'order'   => 'ASC'\n      )\n);\nforeach ($categories as $category) {\n    echo '<li class=\"filter-tab-list archive__filterizr-btn\" data-filter=\"' . $category->term_id . '\"> ' . $category->name . ' </li>';\n}\n?>\n\nIs there any way I can exclude the empty category from the \"Movies\" archive page?\nThanks in advance :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406642", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: When are Shortcode Attributes Available in Template I have a template that adds a shortcode. The add_shortcode is at the top of the template, before any template output. Note that any attributes for the shortcode are optional. I don't care if they exist or not. I will just test for the attribute values and do something if they exist.\nWhen are the shortcode attributes available for use in the template? Psuedocode example ($atts are the shortcode's attributes array):\n// template header is here\n// add the shortcode\nadd_shortcode(\"mycode\", \"myshortcodefunction\");\n\n// is $atts available here? Because they are need by the next \n//   included function\ninclude('someotherfunction.php');  // edited to add this line\n\n\nfunction myshortcodefunction() {\n   echo \"a shortcode processed here \";\n   echo \"and here are the attributes:<br>\";\n   print_r($atts);\n   return;\n  }\n\n// is $atts available here?\n\n// template code here\n// show the page content in the loop\nthe_post();\n\n// is $atts available here?\n\n// end of template\n\n// is $atts available here?\n\nIn which of those 'spots' in the template page code does $atts contain the shortcode parameters?  And how do I use those parameters outside of the add_shortcode function?\nCan I create a constant that contains $atts?\n// ending template stuff\nAdded\nThe overall intent of my project is to use the attributes in an 'included' function that is loaded after the add_shortcode statement. That included function does a lot of work, including displaying text (a form), and using the shortcode attributes in other parts of that included function.\nSo, I need access to the shortcode attributes before the content (and it's shortcode) is processed.... in the first \"is $atts available here\" after the add_shortcode.\nI've also changed the pseudocode above to show where that included function is placed - directly after the add_shortcode.\n\nA: \nI need access to the shortcode attributes before the content (and\nit's shortcode) is processed.... in the first \"is $atts available\nhere\" after the add_shortcode\n\nIn that case, you can manually parse the shortcode and retrieve its attributes (if any) like so, which uses get_shortcode_regex() and shortcode_parse_atts():\n$content = 'before blah2 [foo bar=\"baz\" num=\"123\"] after';\n\npreg_match( '/' . get_shortcode_regex() . '/s', $content, $matches );\n$atts = isset( $matches[3] ) ? shortcode_parse_atts( $matches[3] ) : '';\n\nvar_dump( $atts );\n/* Output:\narray(2) {\n  [\"bar\"]=>\n  string(3) \"baz\"\n  [\"num\"]=>\n  string(3) \"123\"\n}\n*/\n\n\n*\n\n*Note that the above will only retrieve the attributes of the first shortcode found in $content. So use that code only if you're sure the content would never contain any other shortcodes..\n\nOr you can try this function which parses all shortcodes of a certain tag and return an array of attributes:\nfunction my_shortcode_parse_atts( $text, $tag ) {\n    $all_atts = array();\n\n    preg_match_all( '/' . get_shortcode_regex() . '/s', $text, $matches );\n\n    // If the shortcode ($tag) is found in $text, we parse the attributes.\n    if ( isset( $matches[3] ) ) {\n        // $matches[3] is the attributes string like ' bar=\"baz\" num=\"123\"'\n        foreach ( $matches[3] as $i => $s ) {\n            if ( $tag === $matches[2][ $i ] ) {\n                $all_atts[] = shortcode_parse_atts( $s );\n            }\n        }\n    }\n\n    return $all_atts;\n}\n\n\n*\n\n*Sample usage and output:\n$content  = 'before [foo] blah2 [foo bar=\"baz\" num=\"123\"] after';\n$all_atts = my_shortcode_parse_atts( $content, 'foo' );\n\nvar_dump( $all_atts );\n/* Output:\narray(2) {\n  [0]=>\n  string(0) \"\"\n  [1]=>\n  array(2) {\n    [\"bar\"]=>\n    string(3) \"baz\"\n    [\"num\"]=>\n    string(3) \"123\"\n  }\n}\n*/\n\nNote: In the above $content, there are 2 instances of the foo shortcode; one without any attributes, and the other with 2 attributes.\nAlso, I used a dummy text, so it's up to you on how to get the actual $content's value..\n\nA: The answer from @SallyCJ got me started on the solution that worked best for me. It uses some of her code. There are references to other resources that helped out.\nfunction my_get_shortcode_atts($shortcode_id) {\n/* given the $shortcode_id you are looking for, find it in the content\n     before the loop \n   returns an array of the $atts element from the content\n     the array will be empty if there are no attributes for the shortcode\n*/\n\n\n// get the content before the loop \n// (see https://wordpress.stackexchange.com/a/377671/29416 )\nglobal $post;\n$pageID =  $post->ID;\n$fst_content = get_the_content(null, false, $pageID);\n\n// extract shortcode attributes \n// (from  https://wordpress.stackexchange.com/a/172285/29416\npreg_match_all( '/' . get_shortcode_regex() . '/s', $fst_content , $matches );\n    $shortcode_atts = array();\n    if( isset( $matches[2] ) )\n    {\n        foreach( (array) $matches[2] as $key => $value )\n        {\n            if( $shortcode_id === $value )\n                $shortcode_atts[] = shortcode_parse_atts( $matches[3][$key] );\n        }\n    }\n    if (! count($shortcode_atts)) {  // this returns false if shortcode not found\n        return array();\n        }\n// 0th element is the attributes, so we get just that; \n// if there is more than one, you may need to adjust this part\n$shortcode_atts = $shortcode_atts[0];\ndefine(\"SHORTCODE_ATTS\", $shortcode_atts);  // so I can use the $atts anywhere\nreturn $shortcode_atts;\n}\n\nOnce I have the attributes, I can use this in my 'big function file' to set some constants:\n    if (function_exists('get_bloginfo')) {  \n       // get_bloginfo function won't exist in non-WP environment\n       // you can use other WP-unique functions if you wish\n    // get shortcode atts into an array, otherwise false\n    $atts = my_get_shortcode_atts(\"my_shortcode_name\");\n    // do whatever you want with the atts\n    //    you may want to test for no shortcode attributes ($atts will be false)\n    //    in my case, I'll use the constant defined to do things\n    }\n\nNow I can use my 'big functions file' in non-WP environments, as well as with shortcodes in a WP post/page. And the SHORTCODE_ATTS constant is used to do things based on the attributes (if any) found in the shortcode.\nSince this is the solution that worked for me, it will be marked as such. But an upvote given on @SallyCJ's answer because it helped me with the above solution.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406644", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Random 404 errors using Buddypress I\u2019m currently running Buddypress with Woocommerce activated (Dokan as well.)\nFrom time to time, much more when there\u2019s heavier traffic, there will be random 404 errors on different parts of my website. I heard it has something to do with flush rewrite rules or something.\nI\u2019m not too good at these kinds of things, I was wondering if anyone heard of something similar happening. I read that it happens when people also use LearnDash with Buddypress, and I saw a specific fix to be put in functions.php for that, I was wondering if something can be applied to my situation.\nHere\u2019s the question that\u2019s similar:\nIntermittent 404 errors, rewrite rules, and BBPress\n\nA: To answer your question, if you are not using the LearnDash plugin then you should not add the code that is in the accepted answer of the link you have there.\nThat code essentially is adding a filter named learndash_flush_rewrite_rules which appears to be specific to that plugin. If you don't have it enabled, it will most likely never run.\nI took a look on some tickets and found this BP ticket which may get you started with a different solution.\nOne person had their issue fixed adding the following to functions.php:\nadd_action('delete_option_rewrite_rules', function($option){\n   global $wp_rewrite;\n   $wp_rewrite->use_verbose_page_rules = true;\n}, 10);\n\nDefinitely test that on a non-prod server before using, not sure why it worked for them, and it was 6 years ago.\nLastly, this is definitely a difficult error to troubleshoot. I'd recommend that you start debugging by logging all your 404 errors and perhaps try to recreate the bug while debugging is turned on. An idea to not disrupt production might be to have a bunch of puppeteer scripts all going to a staging version of your site and log the errors that way.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406646", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to stop media_sideload_image from running when deleting a post? I have a code that downloads an image and saves it to the media library when you save a post that uses a certain block. The code runs perfect but downloads the image again if you delete the post. How do you prevent media_sideload_image` from running when you delete a post?\nMy code :\nfunction post_extra_save( $post_id, $post){\nglobal $pagenow;\nif ($pagenow == 'post.php') { // if creating a new post\n    if ( has_blocks( $post->post_content ) ) {\n        $blocks = parse_blocks( $post->post_content );\n        foreach ( $blocks as $block ) {\n            if ( $block['blockName'] === 'acf/opby-link' ) { // if block is used\n                static $updated = false;\n                // If title has already been set once, bail.\n                if ( $updated ) {\n                    return;\n                }\n                // Since we're updating this post's title, set this\n                // variable to true to ensure it doesn't happen again.\n                $updated = true;    \n                require_once(ABSPATH . 'wp-admin/includes/media.php');\n                require_once(ABSPATH . 'wp-admin/includes/file.php');\n                require_once(ABSPATH . 'wp-admin/includes/image.php');\n                $url     = \"https://cdn.pixabay.com/photo/2022/04/08/21/04/buildings-7120297_1280.jpg\";\n                media_sideload_image($url, $post_id, null, 'id');\n            }// End if check opby-video.\n        }\n    }\n}\n}\nadd_action( 'save_post', 'post_extra_save', 10, 2 );\n\n\nA: I believe you can just check if the post status is trash, and if so, don't run the rest of your code. E.g. (PS: I intentionally used strict comparison, i.e. using === as in $pagenow === 'post.php')\nfunction post_extra_save( $post_id, $post ) {\n    global $pagenow;\n    if ($pagenow === 'post.php' && 'trash' !== $post->post_status) {\n        ... your code.\n    }\n}\n\nAlternatively, run your code only if the post status is publish or that it's in one of a whitelisted/allowed statuses list. E.g.\nfunction post_extra_save( $post_id, $post ) {\n    global $pagenow;\n\n    $allowed_statuses = array( 'publish', 'private' ); // list of allowed post statuses\n\n    if ($pagenow === 'post.php' && in_array( $post->post_status, $allowed_statuses )) {\n        ... your code.\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406648", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress login set cookie that survive browser exit (wp_signon function) I've read all the relevant question here on StackExchange and I haven't found a solution.\nHere's the problem: I use a plugin to use Google OAUTH to login in Wordpress. All working correctly, but I can't set the \"remember me\" option to true because the OAUTH login doesn't use this option.\nSo, the login cookie can't survive the browser session, and I must login again everytime the browser's close.\nSo, I've found that the WP Core function wp_signon (in wp-includes/user.php) assume that \"remember me\" is false by default; so I've tried to invert the logic directly in core, inverting true with false and viceversa;\nif ( ! empty( $credentials['remember'] ) ) {\n        $credentials['remember'] = false;\n    } else {\n        $credentials['remember'] = true;\n    }\n\ndoing so, i can login using OAUTH and the login cookie survives the browser session for 14 days.\nNow, what's the correct way to permanently enable this behaviour? On the next update the Wp Core files will be overwritten...\nThanks for any advice.\n\nA: Without knowing what Google OAuth plugin you're using (and how it internally signs a user in), the only way is to override the pluggable function wp_set_auth_cookie, setting $remember to always true:\nif ( ! function_exists( 'wp_set_auth_cookie' ) ) :\n    /**\n     * Sets the authentication cookies based on user ID.\n     *\n     * The $remember parameter increases the time that the cookie will be kept. The\n     * default the cookie is kept without remembering is two days. When $remember is\n     * set, the cookies will be kept for 14 days or two weeks.\n     *\n     * @since 2.5.0\n     * @since 4.3.0 Added the `$token` parameter.\n     *\n     * @param int         $user_id  User ID.\n     * @param bool        $remember Whether to remember the user.\n     * @param bool|string $secure   Whether the auth cookie should only be sent over HTTPS. Default is an empty\n     *                              string which means the value of `is_ssl()` will be used.\n     * @param string      $token    Optional. User's session token to use for this cookie.\n     */\n    function wp_set_auth_cookie( $user_id, $remember = false, $secure = '', $token = '' ) {\n\n        /**\n         * Force $remember \n         */\n        $remember = true;\n\n        if ( $remember ) {\n            /**\n             * Filters the duration of the authentication cookie expiration period.\n             *\n             * @since 2.8.0\n             *\n             * @param int  $length   Duration of the expiration period in seconds.\n             * @param int  $user_id  User ID.\n             * @param bool $remember Whether to remember the user login. Default false.\n             */\n            $expiration = time() + apply_filters( 'auth_cookie_expiration', 14 * DAY_IN_SECONDS, $user_id, $remember );\n\n            /*\n             * Ensure the browser will continue to send the cookie after the expiration time is reached.\n             * Needed for the login grace period in wp_validate_auth_cookie().\n             */\n            $expire = $expiration + ( 12 * HOUR_IN_SECONDS );\n        } else {\n            /** This filter is documented in wp-includes/pluggable.php */\n            $expiration = time() + apply_filters( 'auth_cookie_expiration', 2 * DAY_IN_SECONDS, $user_id, $remember );\n            $expire     = 0;\n        }\n\n        if ( '' === $secure ) {\n            $secure = is_ssl();\n        }\n\n        // Front-end cookie is secure when the auth cookie is secure and the site's home URL uses HTTPS.\n        $secure_logged_in_cookie = $secure && 'https' === parse_url( get_option( 'home' ), PHP_URL_SCHEME );\n\n        /**\n         * Filters whether the auth cookie should only be sent over HTTPS.\n         *\n         * @since 3.1.0\n         *\n         * @param bool $secure  Whether the cookie should only be sent over HTTPS.\n         * @param int  $user_id User ID.\n         */\n        $secure = apply_filters( 'secure_auth_cookie', $secure, $user_id );\n\n        /**\n         * Filters whether the logged in cookie should only be sent over HTTPS.\n         *\n         * @since 3.1.0\n         *\n         * @param bool $secure_logged_in_cookie Whether the logged in cookie should only be sent over HTTPS.\n         * @param int  $user_id                 User ID.\n         * @param bool $secure                  Whether the auth cookie should only be sent over HTTPS.\n         */\n        $secure_logged_in_cookie = apply_filters( 'secure_logged_in_cookie', $secure_logged_in_cookie, $user_id, $secure );\n\n        if ( $secure ) {\n            $auth_cookie_name = SECURE_AUTH_COOKIE;\n            $scheme           = 'secure_auth';\n        } else {\n            $auth_cookie_name = AUTH_COOKIE;\n            $scheme           = 'auth';\n        }\n\n        if ( '' === $token ) {\n            $manager = WP_Session_Tokens::get_instance( $user_id );\n            $token   = $manager->create( $expiration );\n        }\n\n        $auth_cookie      = wp_generate_auth_cookie( $user_id, $expiration, $scheme, $token );\n        $logged_in_cookie = wp_generate_auth_cookie( $user_id, $expiration, 'logged_in', $token );\n\n        /**\n         * Fires immediately before the authentication cookie is set.\n         *\n         * @since 2.5.0\n         * @since 4.9.0 The `$token` parameter was added.\n         *\n         * @param string $auth_cookie Authentication cookie value.\n         * @param int    $expire      The time the login grace period expires as a UNIX timestamp.\n         *                            Default is 12 hours past the cookie's expiration time.\n         * @param int    $expiration  The time when the authentication cookie expires as a UNIX timestamp.\n         *                            Default is 14 days from now.\n         * @param int    $user_id     User ID.\n         * @param string $scheme      Authentication scheme. Values include 'auth' or 'secure_auth'.\n         * @param string $token       User's session token to use for this cookie.\n         */\n        do_action( 'set_auth_cookie', $auth_cookie, $expire, $expiration, $user_id, $scheme, $token );\n\n        /**\n         * Fires immediately before the logged-in authentication cookie is set.\n         *\n         * @since 2.6.0\n         * @since 4.9.0 The `$token` parameter was added.\n         *\n         * @param string $logged_in_cookie The logged-in cookie value.\n         * @param int    $expire           The time the login grace period expires as a UNIX timestamp.\n         *                                 Default is 12 hours past the cookie's expiration time.\n         * @param int    $expiration       The time when the logged-in authentication cookie expires as a UNIX timestamp.\n         *                                 Default is 14 days from now.\n         * @param int    $user_id          User ID.\n         * @param string $scheme           Authentication scheme. Default 'logged_in'.\n         * @param string $token            User's session token to use for this cookie.\n         */\n        do_action( 'set_logged_in_cookie', $logged_in_cookie, $expire, $expiration, $user_id, 'logged_in', $token );\n\n        /**\n         * Allows preventing auth cookies from actually being sent to the client.\n         *\n         * @since 4.7.4\n         *\n         * @param bool $send Whether to send auth cookies to the client.\n         */\n        if ( ! apply_filters( 'send_auth_cookies', true ) ) {\n            return;\n        }\n\n        setcookie( $auth_cookie_name, $auth_cookie, $expire, PLUGINS_COOKIE_PATH, COOKIE_DOMAIN, $secure, true );\n        setcookie( $auth_cookie_name, $auth_cookie, $expire, ADMIN_COOKIE_PATH, COOKIE_DOMAIN, $secure, true );\n        setcookie( LOGGED_IN_COOKIE, $logged_in_cookie, $expire, COOKIEPATH, COOKIE_DOMAIN, $secure_logged_in_cookie, true );\n        if ( COOKIEPATH != SITECOOKIEPATH ) {\n            setcookie( LOGGED_IN_COOKIE, $logged_in_cookie, $expire, SITECOOKIEPATH, COOKIE_DOMAIN, $secure_logged_in_cookie, true );\n        }\n    }\nendif;\n\nI'd recommend putting this in a MU plugin, for example wp-content/mu-plugins/always-remember.php\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406649", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get single item from cURL plugin API call inside bash I'm trying to get only the last_updated date from a plugin through an API call in a bash script.\nI'm trying to use cURL but that's giving me some issues. On the browser I can get to to plugin like this:\nhttps://api.wordpress.org/plugins/info/1.2/?action=plugin_information&request[slug]=custom-comment-links\nLooked over here but this seems more geared towards PHP:\nhttps://dd32.id.au/projects/wordpressorg-plugin-information-api-docs/\nhttps://codex.wordpress.org/WordPress.org_API#Plugins\n\nA: Since it seems the API is closed source and there may not be a way to get only a single option then the only other option is parsing the response.\nI hear jq is the way to go for parsing JSON within the shell, but I don't want to add dependencies and grep seems to have done the job:\ncurl -v -d 'action=plugin_information&request[slug]=custom-comment-links' https://api.wordpress.org/plugins/info/1.1/ --stderr - | grep -o '\"last_updated\":\"[^\"]*' | grep -o '[^\"]*$'\nYou can replace last_updated with anything you'd like :)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406651", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Where can I get a full list of wordpress errors in plain text? When a wordpress error pops up, it's in the code, now I can find scattered errors tutorials all over the internet, but is there specific list somewhere?\nLike:\n\n*\n\n*error x\n\n*syntax error y\n\netc...\nSomething clean in plain text I want to explore every possible wordpress errors, learn them and offer repair services.\n\nA: Enable debug logging in wp-config.php:\ndefine( 'WP_DEBUG', true ); // Enable debugging\n\n// Default logging path is wp-content/debug.log\ndefine( 'WP_DEBUG_LOG', true /* or custom path e.g. '/path/to/debug.log' */ );\n\ndefine( 'WP_DEBUG_DISPLAY', true /* or false if you want to just log the errors */ );\n\nThat will capture and store all errors (either from core PHP, or generated by WordPress).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406654", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "-1"}}
{"text": "Q: Remove the preview link box since 6.0 update Since the new update 6.0, Wordpress now create (sometimes) a preview box when I add a link into the editor.\nIs there any way to remove this functionality ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406659", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display List of All Taxomony Terms of A Post I have created a Taxonomy named \u201cGenre\u201d.\nIn one of my posts, I added the following categories to its \u201cGenre\u201d\n\n*\n\n*Funny\n\n*Action\n\n*Adventure\n\nHow can I display Funny, Action, and Adventure under the title of my post, like this:\nhttps://i.imgur.com/GyTDJoR.png\nOr is there a way to display this in my article via shortcode?\nThank you a lot!\n\nA: Use the template tag the_terms( $post_id, $taxonomy, $before = '', $sep = ', ', $after = '' )\nFor example:\n<?php the_terms( get_the_ID(), 'genre', 'Genres: ', ' ' ) ?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406664", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Optimal WP Web App Backend for mobile app development I'm having a web app built on wordpress, and am needing to build a mobile app with it. The probably most important aspect of this is that I'll need to transform all of my AJAX request-responses to the usual JSON-format, to be easily compatible with other APIs / Frameworks used to build mobile apps.\nMost of this is done with wordpresses' native REST API, except regarding my custom post types. These all have a standardized structure; sth like:\n<div class=\"post-content-wrapper\">\n  <p class=\"post-info-1\">First Info</p>\n  <p class=\"post-inof-2\">Second Info</p>\n</div>\n\nWhat I'm thus thinking of is the transformation of this post content into JSON, something like:\n{\n  'info_1':'First Info',\n  'info_2':'Second Info'\n}\n\nAnd then render everything on the client-side (e.g. for web using HTML templates and native Js (I want to refrain from frameworks if not absolutely needed), and for respective other solutions of mobile app frameworks).\nIn theory, both the wp_posts table's post_content field (which is where wp post contents are stored), as well as the wp_postmeta table's meta_value field (which is where meta values of wp posts are stored) are of type longtext; meaning they could easily both hold JSON (I'm using MariaDB, so LONGTEXT is treated equally as JSON).\nAs this does not seem to be a default possibility in WP, I wondered if it could actually be a problem for some reason to store post contents / post meta values in the JSON format.\nCould anyone think of a reason why it could be bad practice?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406665", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress combined with a basic MYSQL table thanks in advance for any feedback to help me find a solution.\n== Context ==\nI have my website made in wordpress, in which I have a list of cars that must come from another table in MYSQL (because that list is loaded from a different system in wordpress)\nCurrently what I do is insert a shortcode on a page that queries that table and displays the list of cars.\nThen when clicking on car specifically the user is directed to another page and in the URL I send a variable that is car_code\nOn the next page I have another shortcode that takes the variable $_GET['car_code']\nand consult in this table the details of the car to expand the information to the user\n== Questions ==\nThis works fine, but I think there must be a better way to do it and I'd like some help if possible:\nI am currently having difficulties because:\n\n*\n\n*To do SEO, each cart is not indexed by Google independently because it does not have independent URLs. This could be solved with something from the modrewrite I suppose.\n\n\n*I don't have each cart individually in my wordpress to make changes to each cart if I want (This seems to be little necessary)\n== Solution Approaches ==\nI am thinking of possible solutions, among them the following\n\n*\n\n*Every time a cart is published in the cart table, create a custom post type in my wordpress.\n\n\n*Having the possibility of creating custom post ype on the fly, that is, tricking wordpress into believing that a custom posttype exists only for programming but that it is false.\nWhat other ideas can you give me, a different or better way to handle this situation?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406671", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Woocommerce checkout required field error I added some custom fields on my checkout, but having problems with them.\nFor example, when i do a breakdown and just add this field:\nadd_filter( 'woocommerce_checkout_fields' , 'custom_override_checkout_fields' );\n    function custom_override_checkout_fields( $fields ) {\n        $fields['billing']['billing_custom_field'] = array(\n        'label'     => __('Test Field', 'woocommerce'),\n        'placeholder'   => _x('Phone', 'placeholder', 'woocommerce'),\n        'required'  => true,\n        'class'     => array('form-row-wide'),\n        'clear'     => true\n     );\n     return $fields;\n}\n\nIf i don't fill it in, I get an error on top and the color becomes red.\nWhen i do fill it in, the color is not red, but on top i keep getting an error and the checkout doesn't go to next step.\nI've come across this problem when using different checkout editor field plugins. Then i deactivated them together with all my other plugins and tried this simple breakdown.\nSomeone know what's causing this problem?\nI'm using DIVI as theme, but that never mattered on other sites.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406674", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Get $_POST & $_REQUEST values before adding/updating post I've done this many times before, but it stopped working and I can't figure out why and haven't found a way to re-accomplish the same task.\nGOAL: intercept submitted values from $_POST/$_REQUEST before saving/updating post in DB. Specifically for processing both default WP meta/tax as well as custom meta/tax.\nQUESTION: How do I get the $_POST/$_REQUEST data for ALL fields when a post is created or updated in WordPress. Everything that USED TO WORK no longer does. I'd like $_POST & $_REQUEST data so that I can process front-end form submissions, admin panel submissions, and quick edits.\n\nHOOKS TRIED:\nHooks 'pre_post_update' SHOULD work, but always returns empty array, or the generic a:1:{s:7:\"_locale\";s:4:\"user\";} that are part of the wp-admin URL query string.\nHook 'post_updated' is after submission and does give old/new values, but only for default WP meta/tax, not custom meta/tax, and it's after processing so no $_POST or $_REQUEST data.\nHook 'save_post' is after saving, so not suitable for the task.\n\nDUMP VARS:\nFor every single one of these hooks, I'm saving a dump for each of these:\n$post_id\n$post_data\n$_POST\n$_GET\n$_REQUEST\n'php://input'\n\n\nSAMPLE CODE TRIED:\npre_post_update hook:\nfunction PPU_intercept_post_save($post_id, $post_data){\n    // passed vars first\n    file_put_contents('vardump.txt', serialize($post_id));\n    file_put_contents('vardump.txt', PHP_EOL.serialize($post_data), FILE_APPEND);\n    // rest data second\n    $json_data = json_decode(file_get_contents('php://input'), true);\n    file_put_contents('vardump.txt', PHP_EOL.serialize($json_data), FILE_APPEND);\n    // server vars last\n    file_put_contents('vardump.txt', PHP_EOL.serialize($_POST), FILE_APPEND);\n    file_put_contents('vardump.txt', PHP_EOL.serialize($_GET), FILE_APPEND);\n    file_put_contents('vardump.txt', PHP_EOL.serialize($_REQUEST), FILE_APPEND);\n}\nadd_action( 'pre_post_update', 'PPU_intercept_post_save', 10, 2 );\n\nresult:\n// post_id\ni:118;\n// post_data\na:21:{s:11:\"post_author\";s:1:\"1\";s:9:\"post_date\";s:19:\"2022-06-08 15:45:49\";s:13:\"post_date_gmt\";s:19:\"2022-06-08 20:45:49\";s:12:\"post_content\";s:821:\"SENSITIVE_REMOVED\";s:21:\"post_content_filtered\";s:0:\"\";s:10:\"post_title\";s:21:\"SENSITIVE_REMOVED\";s:12:\"post_excerpt\";s:0:\"\";s:11:\"post_status\";s:7:\"publish\";s:9:\"post_type\";s:13:\"SENSITIVE_REMOVED\";s:14:\"comment_status\";s:4:\"open\";s:11:\"ping_status\";s:6:\"closed\";s:13:\"post_password\";s:0:\"\";s:9:\"post_name\";s:21:\"SENSITIVE_REMOVED\";s:7:\"to_ping\";s:0:\"\";s:6:\"pinged\";s:0:\"\";s:13:\"post_modified\";s:19:\"2022-06-11 12:45:20\";s:17:\"post_modified_gmt\";s:19:\"2022-06-11 17:45:20\";s:11:\"post_parent\";i:0;s:10:\"menu_order\";i:0;s:14:\"post_mime_type\";s:0:\"\";s:4:\"guid\";s:59:\"SENSITIVE_REMOVED&#038;p=118\";}\n// rest data\na:2:{s:2:\"id\";i:118;s:7:\"content\";s:821:\"SENSITIVE_REMOVED\";}\n// POST\na:0:{}\n// GET\na:1:{s:7:\"_locale\";s:4:\"user\";}\n// REQUEST\na:1:{s:7:\"_locale\";s:4:\"user\";}\n\n\nsave_post hook:\nfunction SP_intercept_post_save( $post_id, $post_data, $update ) {\n    // passed vars first\n    file_put_contents('vardump.txt', serialize($post_id));\n    file_put_contents('vardump.txt', PHP_EOL.serialize($post_data), FILE_APPEND);\n    file_put_contents('vardump.txt', PHP_EOL.serialize($update), FILE_APPEND);\n    // rest data second\n    $json_data = json_decode(file_get_contents('php://input'), true);\n    file_put_contents('vardump.txt', PHP_EOL.serialize($json_data), FILE_APPEND);\n    // server vars last\n    file_put_contents('vardump.txt', PHP_EOL.serialize($_POST), FILE_APPEND);\n    file_put_contents('vardump.txt', PHP_EOL.serialize($_GET), FILE_APPEND);\n    file_put_contents('vardump.txt', PHP_EOL.serialize($_REQUEST), FILE_APPEND);\n}\nadd_action( 'save_post', 'SP_intercept_post_save', 10, 3 );\n\nresult:\n// post_id\ni:118;\n// post_data\nO:7:\"WP_Post\":24:{s:2:\"ID\";i:118;s:11:\"post_author\";s:1:\"1\";s:9:\"post_date\";s:19:\"2022-06-08 15:45:49\";s:13:\"post_date_gmt\";s:19:\"2022-06-08 20:45:49\";s:12:\"post_content\";s:821:\"SENSITIVE_REMOVED\";s:10:\"post_title\";s:21:\"SENSITIVE_REMOVED\";s:12:\"post_excerpt\";s:0:\"\";s:11:\"post_status\";s:7:\"publish\";s:14:\"comment_status\";s:4:\"open\";s:11:\"ping_status\";s:6:\"closed\";s:13:\"post_password\";s:0:\"\";s:9:\"post_name\";s:21:\"SENSITIVE_REMOVED\";s:7:\"to_ping\";s:0:\"\";s:6:\"pinged\";s:0:\"\";s:13:\"post_modified\";s:19:\"2022-06-11 13:04:34\";s:17:\"post_modified_gmt\";s:19:\"2022-06-11 18:04:34\";s:21:\"post_content_filtered\";s:0:\"\";s:11:\"post_parent\";i:0;s:4:\"guid\";s:59:\"SENSITIVE_REMOVED&#038;p=118\";s:10:\"menu_order\";i:0;s:9:\"post_type\";s:13:\"SENSITIVE_REMOVED\";s:14:\"post_mime_type\";s:0:\"\";s:13:\"comment_count\";s:1:\"0\";s:6:\"filter\";s:3:\"raw\";}\n// update\nb:1;\n// rest data\na:2:{s:2:\"id\";i:118;s:7:\"content\";s:821:\"SENSITIVE_REMOVED\";}\n// POST\na:0:{}\n// GET\na:1:{s:7:\"_locale\";s:4:\"user\";}\n// REQUEST\na:1:{s:7:\"_locale\";s:4:\"user\";}\n\n\npost_updated hook:\nfunction PU_intercept_post_save($post_id, $post_after, $post_before){\n    // passed vars first\n    file_put_contents('vardump.txt', serialize($post_id));\n    file_put_contents('vardump.txt', PHP_EOL.serialize($post_after), FILE_APPEND);\n    file_put_contents('vardump.txt', PHP_EOL.serialize($post_before), FILE_APPEND);\n    // rest data second\n    $json_data = json_decode(file_get_contents('php://input'), true);\n    file_put_contents('vardump.txt', PHP_EOL.serialize($json_data), FILE_APPEND);\n    // server vars last\n    file_put_contents('vardump.txt', PHP_EOL.serialize($_POST), FILE_APPEND);\n    file_put_contents('vardump.txt', PHP_EOL.serialize($_GET), FILE_APPEND);\n    file_put_contents('vardump.txt', PHP_EOL.serialize($_REQUEST), FILE_APPEND);\n}\nadd_action( 'post_updated', 'PU_intercept_post_save', 10, 3 );\n\nresult:\n// post_id\ni:118;\n// post_after\nO:7:\"WP_Post\":24:{s:2:\"ID\";i:118;s:11:\"post_author\";s:1:\"1\";s:9:\"post_date\";s:19:\"2022-06-08 15:45:49\";s:13:\"post_date_gmt\";s:19:\"2022-06-08 20:45:49\";s:12:\"post_content\";s:821:\"SENSITIVE_REMOVED\";s:10:\"post_title\";s:21:\"SENSITIVE_REMOVED\";s:12:\"post_excerpt\";s:0:\"\";s:11:\"post_status\";s:7:\"publish\";s:14:\"comment_status\";s:4:\"open\";s:11:\"ping_status\";s:6:\"closed\";s:13:\"post_password\";s:0:\"\";s:9:\"post_name\";s:21:\"SENSITIVE_REMOVED\";s:7:\"to_ping\";s:0:\"\";s:6:\"pinged\";s:0:\"\";s:13:\"post_modified\";s:19:\"2022-06-11 13:14:58\";s:17:\"post_modified_gmt\";s:19:\"2022-06-11 18:14:58\";s:21:\"post_content_filtered\";s:0:\"\";s:11:\"post_parent\";i:0;s:4:\"guid\";s:59:\"SENSITIVE_REMOVED&#038;p=118\";s:10:\"menu_order\";i:0;s:9:\"post_type\";s:13:\"SENSITIVE_REMOVED\";s:14:\"post_mime_type\";s:0:\"\";s:13:\"comment_count\";s:1:\"0\";s:6:\"filter\";s:3:\"raw\";}\n// post_before\nO:7:\"WP_Post\":24:{s:2:\"ID\";i:118;s:11:\"post_author\";s:1:\"1\";s:9:\"post_date\";s:19:\"2022-06-08 15:45:49\";s:13:\"post_date_gmt\";s:19:\"2022-06-08 20:45:49\";s:12:\"post_content\";s:821:\"SENSITIVE_REMOVED\";s:10:\"post_title\";s:21:\"SENSITIVE_REMOVED\";s:12:\"post_excerpt\";s:0:\"\";s:11:\"post_status\";s:7:\"publish\";s:14:\"comment_status\";s:4:\"open\";s:11:\"ping_status\";s:6:\"closed\";s:13:\"post_password\";s:0:\"\";s:9:\"post_name\";s:21:\"SENSITIVE_REMOVED\";s:7:\"to_ping\";s:0:\"\";s:6:\"pinged\";s:0:\"\";s:13:\"post_modified\";s:19:\"2022-06-11 13:04:34\";s:17:\"post_modified_gmt\";s:19:\"2022-06-11 18:04:34\";s:21:\"post_content_filtered\";s:0:\"\";s:11:\"post_parent\";i:0;s:4:\"guid\";s:59:\"SENSITIVE_REMOVED&#038;p=118\";s:10:\"menu_order\";i:0;s:9:\"post_type\";s:13:\"SENSITIVE_REMOVED\";s:14:\"post_mime_type\";s:0:\"\";s:13:\"comment_count\";s:1:\"0\";s:6:\"filter\";s:3:\"raw\";}\n// rest data\na:2:{s:2:\"id\";i:118;s:7:\"content\";s:821:\"SENSITIVE_REMOVED\";}\n// POST\na:0:{}\n// GET\na:1:{s:7:\"_locale\";s:4:\"user\";}\n// REQUEST\na:1:{s:7:\"_locale\";s:4:\"user\";}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406675", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Change pemalink for one single post without redirect For posts I'm using 'Custom Structure' from 'Permalink Settings'\nhttps://example.com/vocabulary-of-%postname%\nBut only for one post I'd like to make permalink without prefix: https://example.com/%postname%\nI tried to use plugins, but It looks like that they just create a new url and redirect to the original (for example when I create a message in Telegram with https://example.com/%postname%, above message the original link appears https://example.com/vocabulary-of-%postname%).\nThis post has specific category (others) so it can be used to solve the problem\nI see the solution in adding some piece of code but I don't have php\\html skills to create it by myself. Or using a plugin that will actually change permalink.\nWill appreciate any of your suggestions\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406676", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to safely escape data that contains HTML attributes I am not looking for esc_attr(), which escapes data to be used within attributes.\nI am looking for a function that outputs one or more HTML attributes within an HTML tag.\nFor example:\n<div <?php echo escape_me('class=\"whatever\"'); ?> >hey</div>\n\nWhat should I use?\n\nA: wp_kses\nYou could use wp_kses to define specific html-tag/attribute combinations to be permitted in the escaped output.\n$allowed_html = [\n  'div' => [\n    'class' => [],\n  ],\n];\n\necho wp_kses( '<div class=\"whatever\">hey</div>', $allowed_html );\n\nwp_kses_post\nYou could use wp_kses_post. It's a pretty heavy function to use for such a purpose, but it is a valid way to escape your output.\n<div <?php echo wp_kses_post('class=\"whatever\"'); ?> >hey</div>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406677", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How do I make Dynamic Student Admission Form? We have a college where 3000 students are admitted every year. I would like to make an admission form.\nThe question is, I will import the student data such as name, registration number, and subject in advance, if the student inputs his registration number in the form, his information will be filled automatically.\nIs it possible? If possible, how?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406682", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to remove alphabetical order of category in WordPress? As you see in the image (momin khan momin ) is subcategory of (poetry by poet) category. But sub category is not showing exact after its parent category. categories & sub categories are arranged alphabetically.  i have tried different plugin but they can reorder category at widget area. however i am using category and sub category meta after the post title. i want to remove alphabetical order restriction after post title meta section.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406684", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Style internal links based on the tags of the linked post When I internally link to one post in the body of another, I\u2019d like the link to be styled based on the tags that the linked post belongs to.\nFor example, say I have tags \u201cgood\u201d and \u201cbad\u201d. When I link to a post that\u2019s tagged \u201cgood\u201d, I want the link to be highlighted in green. When I link a post tagged \u201cbad\u201d, I want the link highlighted in red. I want to do this without having to check the tags of every post I link to and manually add a css class to the link each time in order to style it. If I change the tags of a post, I'd like any internal links to that post to update their style to match.\nIs there any way to retrieve the tags of a linked post at some point when the linking page is loading, in order to add a css class or otherwise alter the style of the displayed link?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406686", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Set redirect for need login Hello, I have this code so when I place the [need_login] shortcode on a page, it redirects users who are not logged in to a Login page. The problem with this is the that it redirects them to the default WordPress page. How can I add the url of the page I want them to be redirected to.\n\nfunction shortcode_needLogin() {\n    if (!is_user_logged_in()) {\n        auth_redirect();\n    }\n}\n\n\nA: Use wp_redirect() instead of auth_redirect() - make sure to call exit() right after wp_redirect(). Check out the codex for more info on wp_redirect.\n\nA: Great question.  As ScottM mentioned, you want to use wp_redirect() rather than auth_redirect.  Then within the (), you'll want to specify your target.\nIt always makes the most sense to me when I can see real code, so I'd encourage you to look at Redirect user to original url after login? - there are multiple methods / code options, each shown there.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406687", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenberg JavaScript error I'm trying to get into Gutenberg Block Theme development and immediatly ran into an issue:\nI am enquing a JavaScript file, because I want to add custom attributes to the existing blocks:\nadd_action( 'enqueue_block_editor_assets', function() {\n    wp_enqueue_script('awp-gutenberg-filters', get_template_directory_uri() . '/inc/js/gutenberg-filters.js', ['wp-edit-post']);\n} );\n\nThen, in my JavaScript file, I have this stuff:\nconst { createHigherOrderComponent } = wp.compose;\nconst { Fragment } = wp.element;\nconst { InspectorControls } = wp.editor;\nconst { PanelBody, SelectControl } = wp.components;\n\n/**\n * Create HOC to add spacing control to inspector controls of block.\n */\nconst withSpacingControl = createHigherOrderComponent( ( BlockEdit ) => {\n    return ( props ) => {\n        // Do nothing if it's another block than our defined ones.\n        if ( ! enableSpacingControlOnBlocks.includes( props.name ) ) {\n            return (\n                <BlockEdit { ...props } />\n            );\n        }\n\n        const { spacing } = props.attributes;\n\n        // add has-spacing-xy class to block\n        if ( spacing ) {\n            props.attributes.className = `has-spacing-${ spacing }`;\n        }\n\n        return (\n            <Fragment>\n                <BlockEdit { ...props } />\n                <InspectorControls>\n                    <PanelBody\n                        title={ __( 'My Spacing Control' ) }\n                        initialOpen={ true }\n                    >\n                        <SelectControl\n                            label={ __( 'Spacing' ) }\n                            value={ spacing }\n                            options={ spacingControlOptions }\n                            onChange={ ( selectedSpacingOption ) => {\n                                props.setAttributes( {\n                                    spacing: selectedSpacingOption,\n                                } );\n                            } }\n                        />\n                    </PanelBody>\n                </InspectorControls>\n            </Fragment>\n        );\n    };\n}, 'withSpacingControl' );\n\naddFilter( 'editor.BlockEdit', 'extend-block-example/with-spacing-control', withSpacingControl );\n\nBut I immediatly get this error in the console log on the line after the return, that says:\nUncaught SyntaxError: expected expression, got '<'\nWhat am I doing wrong?\n\nA: The syntax where you return elements in tags like <Fragment> is called JSX. Browsers do not support JSX, it\u2019s just a syntax for easier development. You\u2019ll need a build process to compile it into regular Javascript. Most documentation and tutorials cover this. For example, the official docs: https://developer.wordpress.org/block-editor/how-to-guides/platform/custom-block-editor/#code-syntax\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406689", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Where are the layout defaults in Twenty Twenty Two coming from? When I'm editing the template for a Single Post using the Twenty Twenty Two theme, there's a layout option for the post content block that says it will inherit the default layout. Where is that default coming from? Is that a site-wide default or a theme default?\nHere's a screenshot that shows what I'm talking about:\n\n\nA: \nthere's a layout option for the post content block that says it will inherit the default layout. Where is that default coming from?\n\nIn block themes, the default layout settings (contentSize and wideSize) can be found in the theme.json file in the root theme folder, e.g. at wp-content/themes/twentytwentytwo/theme.json in Twenty Twenty-Two. See source on GitHub for WordPress v5.9.3 & Twenty Twenty-Two v1.1\nAnd if the layout option does not exist in the theme.json file, i.e. settings.layout is not defined, then the \"Layout\" panel (in the Block Settings sidebar) will not include the toggle labeled \"Inherit default layout\".\n\nA: It's not specific to Twenty Twenty Two - the post content block layout option allows you to override the default width defined by the active theme.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406690", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Access NEW/UPDATED post values in save_post() callback function I want to run a \"background\" function when a custom post type is saved (updated or created) using the NEW/UPDATED post values. The \"background\" function updates a taxonomy, based on a custom field in the custom post type.\nHow do I access the NEW/UPDATED post values? I'm obviously doing something dumb here but I've been at it two hours with no progress.\nI thought save_post() was fired after the dbase updated but I only get \"old\" values.\nFor the avoidance of doubt, I am def calling the functions correctly:\nfunction custom_post_type_callback($post_id) {\n  //obvs the background function isn't defined here my actual code\n  my_background_function($post_id){\n     $my_variable = get_post($post_id); // <- this is always the \"old\" values\n  };\n}\n\nadd_action( 'save_post_custom_post_type', 'custom_post_type_callback' );\n\nIt works perfectly if I save the post AGAIN.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406695", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Prevent Buddypress Rewrite Rules on Non-Buddypress pages/posts (Edit: Like one of the links below mentioned, it has to do with the order in which the Matching Rule is called, the more engagement/traffic/activity a BP page gets, the more the rewrite rule is called on other pages, if there's something you can give me that keeps the original order for nonbuddypress pages, or removes the rewrite rule all together for nonbuddypress pages, that'll solve the problem I believe)\nI\u2019m currently running Buddypress with Woocommerce activated (Dokan as well.)\nFrom time to time, much more when there\u2019s heavier traffic, there will be random 404 errors on different parts of my website. I heard it has something to do with flush rewrite rules or something.\nI\u2019m not too good at these kinds of things, I was wondering if anyone heard of something similar happening. I read that it happens when people also use LearnDash with Buddypress, and I saw a specific fix to be put in functions.php for that, I was wondering if something can be applied to my situation.\nHere\u2019s are just a few questions that are similar (this is a problem a lot of people have been having for years, almost a decade of people asking):\nIntermittent 404 errors, rewrite rules, and BBPress\nhttps://buddypress.org/support/topic/buddypress-iis-and-randomreoccurring-404-errors/\nhttps://buddypress.org/support/topic/getting-404-after-visiting-activity-stream-in-buddypress/\n--\nI uploaded a query monitor and found that on pages that get those 404 errors, there\u2019s a different \u201cMatched Rule\u201d when the page is requested. When it\u2019s not working it\u2019s [^/]+)(?:/([0-9]+))?/?$, when it is working it\u2019s (.?.+?) (?:/([0-9]+))?/?$\nI tried implementing the code in the below link, replacing my failed matched rule with theirs in the code, but I got critical errors. I\u2019m wondering if the code is correct in my instance, and I added it to the class-wp file right after $rewrite = $wp_rewrite->wp_rewrite_rules(); (I don\u2019t know what he means by \u201cin the parse function request\u201d), so I\u2019m wondering if the place I placed it is correct as well:\nif(isset($rewrite['([^/]+)(?:/([0-9]+))?/?$']))\n        {\n            $temp = $rewrite[^/]+)(?:/([0-9]+))?/?$'];\n            unset($rewrite['([^/]+)(?:/([0-9]+))?/?$']);\n            $rewrite['([^/]+)(?:/([0-9]+))?/?$'] = $temp;\n        }\n\nhttps://buddypress.org/support/topic/getting-404-after-visiting-activity-stream-in-buddypress/\n--\nIf no one knows what to do about this, is there any way at all to prevent Buddypress Rewrite Rules on Non-Buddypress pages/posts? Like some type of functions.php code?\n--\nOr frankly, I think this code below might work, I think I may have just written it the wrong way, is the code below correct?\nif(isset($rewrite['([^/]+)(?:/([0-9]+))?/?$']))\n        {\n            $temp = $rewrite[^/]+)(?:/([0-9]+))?/?$'];\n            unset($rewrite['([^/]+)(?:/([0-9]+))?/?$']);\n            $rewrite['([^/]+)(?:/([0-9]+))?/?$'] = $temp;\n        }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406697", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to WP_Query posts order by parent title? How do I return a posts from WP_Query ordered by their parent's title?\nI know how to do it in the way where I return ALL posts and then change the order afterwards with array sorting. But I wanna know if there is a way to more quickly get this directly in the WP_Query. So that it goes faster with pagination.\nIf it's possible to do this directly with SQL and $wpdb->query() then that is also an option. But I just don't know how to do. Have tried to search on the forum and google for how to do this but can't find the answer.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406698", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: When request has multiple matching rewrite rules, and matched rule returns 404 - iterate to next rewrite rule If my pages have multiple rewrite rules, and the first rule matched returns a 404 error, how can I make it so that the next rewrite rule is attempted first before the 404 error is shown\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406704", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to conditionally add Custom Post Type to Front Page I am using the following code to show my custom post types on my front page along with the default post type:\n// allows the products to show up on the main page\nfunction add_custom_post_type_to_query( $query ) {\n    if ( ! is_admin()  &&  $query->is_main_query() ) {\n       if ( $query->is_date() ||  $query->is_home()  ) {\n\n           $query->set( 'post_type', array('post', 'product') );\n\n       }\n    }\n}\nadd_action( 'pre_get_posts', 'add_custom_post_type_to_query' );\n\nHow would I modify this code to only show/add custom post types of product where the custom field called show_on_front_page  which is a boolean (ACF checkbox) is set to true (checked)?\n\nA: I believe that if all your products have the custom meta field show_on_front_page with some containing '1' and some containing '0' or some such, AND your regular posts do not have that field, then something like below should work:\n//...\n$query->set('post_type', array('post', 'product'));\n//add this\n        $meta_key = 'show_on_front_page';\n        $query->set('meta_query',\n                array(\n                    'relation' => 'OR',\n                    array(\n                        'key' => $meta_key,\n                        'value' => '1',\n                        'compare' => '='\n                    ),\n                    array(\n                        'key' => $meta_key,\n                        'compare' => 'NOT EXISTS'\n                    )\n                )\n        );\n//...\n\nCaveat: If some of the products don't have the meta field set to anything they will show as well.\nSee https://developer.wordpress.org/reference/classes/wp_meta_query/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406705", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Compile a blocks src directory and main index.js entry file and output to different build dirs? I have one entry file containing global libs and scripts for the site at /src/index.js and a directory in my theme root at namespace-blocks containing dirs for each block with block.json's and index.js's in each directory. Can I use wp-scripts without extending it with a webpack config to compile both into separate directories?\nUsing npm i concurrently i'm able to do this and just output each build to separate build directories in my theme root like build and build-blocks but this isn't ideal.\nCurrently my NPM scripts look like this:\n  \"scripts\": {\n    \"start\": \"concurrently --kill-others \\\"npm run start:custom-directories\\\" \\\"npm run start:custom\\\"\",\n    \"start:custom-directories\": \"wp-scripts start --webpack-copy-php --webpack-src-dir=diesel-blocks --output-path=build-blocks\",\n    \"start:custom\": \"wp-scripts start src/index.js --output-path=build\"\n  },\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406706", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Append a code when at the current page in wp_list_pages() I'm using wp_list_pages() to show pages and subpages in a tree view and I need to add a \"read more\" as a sub-item right after the current page.\nExample:\nWe are at the \"Page tree\"\n\n*\n\n*Page one\n\n*Page two\n\n*Page tree READ MORE\n\n*Page four\n\n*Page five\n\nI'm not sure if this is achieved with hooks or walker, any suggestion would be appreciate!\nCode I'm using:\nfunction dkc_list_subpgm() { \n\nglobal $post; \n\nif (is_singular('pgm') && $post->post_parent )  \n      $childpages = \n      wp_list_pages(  array(\n      'post_type' => 'pgm',\n      'sort_column' => 'menu_order',\n      'title_li' => '',\n      'child_of' => $post->post_parent ,\n      'echo' =>'0'            \n        ));\nelse\n      $childpages = \n      wp_list_pages(  array(\n      'post_type' => 'pgm',\n      'sort_column' => 'menu_order',\n      'title_li' => '',\n      'child_of' => $post->ID,\n      'echo' =>'0' \n        ));\n\nif ( $childpages ) {\n\n$string = '<ul class=\"wpb_page_list\">' . $childpages . '</ul>';\n}\n\nreturn $string;\n\n}\n\nadd_shortcode('dkc_childpages', 'dkc_list_subpgm');\n\n\nA: I would use a custom walker and then extend the Walker_Page::start_el() method, like so:\n// Based on Walker_Page for WordPress v6.0\n// @link https://github.com/WordPress/wordpress-develop/blob/6.0/src/wp-includes/class-walker-page.php#L105-L219\n\nclass My_Walker_Page extends Walker_Page {\n    public function start_el( &$output, $data_object, $depth = 0, $args = array(), $current_object_id = 0 ) {\n        /* This checks if the current page in the list is the current page you're on.\n         * - $current_object_id is the ID of the current page you're on\n         * - $data_object->ID is the ID of the current page in the list\n         */\n        $is_current_page = ( (int) $current_object_id === (int) $data_object->ID );\n\n        // This one adds the \"read more\" inside the link, i.e. before the </a> tag.\n        if ( $is_current_page ) {\n            $args['link_after'] .= ' READ MORE 1 (inside \"a\")';\n        }\n\n        // Call the parent method to build the (complete) <li ...><a ...>...</a> part.\n        parent::start_el( $output, $data_object, $depth, $args, $current_object_id );\n\n        // This one adds the \"read more\" outside the link, i.e. after the </a> tag,\n        // but still inside the same or current LI element.\n        if ( $is_current_page ) {\n            $output .= ' READ MORE 2 (outside \"a\")';\n        }\n    }\n}\n\nThings to note:\n\n*\n\n*You could instead use a conditional tag such as is_page( $data_object->ID ) or is_single( $data_object->ID ), but using the above (int) $current_object_id === (int) $data_object->ID is easier because it works regardless the post type.\n\n\n*Just choose one of the if ( $is_current_page ) { ... } blocks above, or use both if you want to.. :)\nAnd then pass an instance of the above class to wp_list_pages() (via the walker argument), e.g.\n// NOTE: It's up to you on how to load the PHP FILE which defines the My_Walker_Page\n// class, but for example, require_once __DIR__ . '/includes/class-my-walker-page.php';\n\nwp_list_pages( array(\n    'walker' => new My_Walker_Page(),\n) );\n\nAdditional Notes\n\n*\n\n*Your dkc_list_subpgm() code could be simplified like so where I used just one wp_list_pages() instead of two:\nfunction dkc_list_subpgm() {\n\n    global $post;\n\n    $child_of = $post->ID;\n    if ( is_singular( 'pgm' ) && $post->post_parent ) {\n        $child_of = $post->post_parent;\n    }\n\n    $childpages = wp_list_pages( array(\n        'post_type'   => 'pgm',\n        'sort_column' => 'menu_order',\n        'title_li'    => '',\n        'child_of'    => $child_of,\n        'echo'        => 0, // just use 0 (without quotes) and not '0'\n        'walker'      => new My_Walker_Page(),\n    ) );\n\n    if ( $childpages ) {\n        return '<ul class=\"wpb_page_list\">' . $childpages . '</ul>';\n    }\n\n    return '';\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406708", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: how to test if an open graph image has been set Our content mostly has Open Graph information set. I think this is done by Yoast SEO. Do you think this is correct?\nThere are quite a few (~1200) URLs that have no Open Graph image set.\nI am thinking I can write a functions.php action to check to see if the Open Graph image has been set, and if not, supply a fallback OG image.\nHow would I check to see if an OG image has not been set?\nHelp appreciated.\n\nA: Yoast SEO has a provision for a default social image through\nYoast SEO > Social > Facebook > Default image.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406710", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show/hide posts and categories based on user meta I've added additional input fields to the user profiles with Advanced Custom Fields (for example \"type of customer\"). How is it possible to hide posts and categories for users with specific values within the custom fields? For example if a user has the customer type is set to \u201cCloud\u201d they should only be able to see FAQ entries of the category \u201cCloud\u201d and be permitted to access other categories.\nI only found plugins to hide posts based on the user role, but I am searching for a more flexible way, because type of customer won't be the only additional field.\n\nA: You should check the pre_get_posts() filter hook.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406712", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Delete a repeated part of post title in WordPress All of my posts have the words\n(With Table)\nat the end of post title.\nI want to delete this part in every post title but can't do it manually because there are 10,000+ posts\nI tried Better Search Replace plugin but it tells me I have 21,000 matches whereas I only have 12275 posts in my WordPress (there are no draft, pending or trash posts)\nIs there any easy way to do this bulk change by using some code or plugin? I will take backup before trying a solution.\n\nA: if you have access to your database, as every posts are registered in the (wp_/ or whatever is your prefix )posts , you can probably do it via sql\nsomething like\nupdate wp_posts\nSET post_title = substring(post_title,1, CHAR_LENGTH(post_title) - 10))\nWHERE post_title like '%With Table'\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406713", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add properties to term object A typical WP_Term Object, for category might look like this;\nWP_Term Object\n(\n  [term_id] => 5\n  [name] => News and Views\n  [slug] => news-and-views\n  [term_group] => 0\n  [term_taxonomy_id] => 5\n  [taxonomy] => category\n  [description] => \n  [parent] => 0\n  [count] => 22\n  [filter] => raw\n  [term_order] => 1\n  [cat_ID] => 5\n  [category_count] => 22\n  [category_description] => \n  [cat_name] => News and Views\n  [category_nicename] => news-and-views\n  [category_parent] => 0\n)\n\nIt would be very desirable to have a singular name. Is there a way to extend the WP_Term class with a hook to add singular_name property?\nI realise that it is possible with ACF but this is not really meta data\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406714", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Link back to (paged) archive and find the correct page in my single.php i want to add a \"back-to-overview\"-button which leads to the posts archive. But if my post is located in, lets say, page 7 of the archive, i want my back-button link to this page 7.\nHow can i find out, on which page my post is located?\nI think i could achieve this by querying all posts and then calculate the position, but - as wordpress has a function or hook for nearly everything - i wonder if there is better (and more performant) way.\n\nA: There's no built-in function for what you're after - plus have you also considered what if a user visited your post from a date-based or category archive? You might find using the HTTP referer is more suitable:\n<a href=\"<?= esc_url( wp_get_referer() ?: home_url() ) ?>\">Back to overview</a>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406715", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to combine wordpress_logged_in cookies in one cookie? I'm trying to optimize my server to consume less resources as possible and increase overall performance. In my site I don't see a need to recompute same requests for users or guests every time. The site is powered by nginx, I enabled fastcgi_cache rules:\nfastcgi_cache_path /etc/nginx/cache levels=1:2 keys_zone=MYAPP:250m inactive=60m;\nfastcgi_cache_key \"$scheme$request_method$host$request_uri\";\n\nlocation ~ \\.php$ {\n...\n                fastcgi_cache MYAPP;\n\n                fastcgi_cache_valid  200 301 302 15m;\n                fastcgi_cache_use_stale error timeout updating invalid_header http_500 http_503;\n                fastcgi_cache_min_uses 1;\n                fastcgi_cache_lock on;\n                fastcgi_cache_bypass $skip_cache;\n                fastcgi_no_cache $skip_cache;\n                add_header X-FastCGI-Cache $upstream_cache_status;\n        }\n\nI need to also efficiently cache dynamic and static assets for logged in users too, to optimize my systems further. The idea is to combine ever wordpress_logged_in cookies in singleton cookie, for example cookie_memberships. And pass that HTTP parameter in fastcgi_cache_key \u201c$scheme$request_method$host$request_uri$cookie_memberships\u201d; rule. How can I do that with PHP?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406718", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Wp-script package stop to work My problem:\nI use the wp-scripts node packages to create a gutenberg plugin. My configuration worked well for one or two weeks and soudainely it stop to work.\nMy package.json files is:\n{\n    \"name\": \"wf-g\",\n    \"version\": \"0.1.0\",\n    \"description\": \"Example static block scaffolded with Create Block tool.\",\n    \"author\": \"The WordPress Contributors\",\n    \"license\": \"GPL-2.0-or-later\",\n    \"main\": \"build/index.js\",\n    \"scripts\": {\n        \"build\": \"wp-scripts build\",\n        \"format\": \"wp-scripts format\",\n        \"lint:css\": \"wp-scripts lint-style\",\n        \"lint:js\": \"wp-scripts lint-js\",\n        \"packages-update\": \"wp-scripts packages-update\",\n        \"plugin-zip\": \"wp-scripts plugin-zip\",\n        \"start\": \"wp-scripts start\",\n        \"css\": \"node-sass --source-map true --output-style compressed -w src/scss/style.scss -o css/ \",\n\n        \"dev\": \"concurrently --kill-others \\\"npm run start\\\" \\\"npm run css\\\"\"\n\n    },\n    \"devDependencies\": {\n        \"@wordpress/scripts\": \"^23.0.0\",\n        \"concurrently\": \"^7.1.0\"\n    },\n    \"dependencies\": {\n        \"node-sass\": \"^7.0.1\"\n    }\n}\n\nI used to run the script dev with npm run dev command. Css script continue to work but the start script doesn't work anymore.\nI work with Visual Studio Code and the terminal display this :\nPS D:\\Developpement\\Sites - Local\\Gutenberg-Dev\\app\\public\\wp-content\\plugins\\webformation-gut> npm run dev\n\n> wf-g@0.1.0 dev\n> concurrently --kill-others \"npm run start\" \"npm run css\"\n\n[1]\n[1] > wf-g@0.1.0 css\n[1] > node-sass --source-map true --output-style compressed -w src/scss/style.scss -o css/\n[1]\n[0]\n[0] > wf-g@0.1.0 start\n[0] > wp-scripts start\n[0]\n\nWhat I tried:\nI try to run start script directly nothing... build script nothing.\nI try to delete the node_modules folder and the package-lock.json... and try again npm install --only=dev. Nothing append.\nDoes anyone can help me ?\nThanks\n\nA: Finally i found the problem !\nThere was a problem in the scss file which stop the building script. I had no error message.\nI think that the problem was that i used a sass variable which was too long.\n\nA: It seems you are doing it unnecessarily complicated. You can use @wordpress/create-block to scaffold basic block and go from there. I never used concurrently, but my guess is that [1] pattern is from entering npm cli mode instead of starting the command. I understand you are trying to speed build process, by separating javascript and scss building steps and running them concurrently, but be aware that in standard @wordpress/scripts configuration, webpack is configured to process both javascript and scss, so you should modify webpack config. I also suggest updating @wordpress/scripts to the latest version.\nMy guess is that your run configuration does not work because environment variable path to wp-scripts is not set properly. Try installing @wordpress/create-block and see if that works. You can start modifying from there.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406719", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom taxonomy permalink without term, redirection to CPT slug I have set up a custom taxonomy categorie and i have the associated CPT devis.\nMy permalinks :\nhttps://www.website.com/categories >> Go to CPT archive\nhttps://www.website.com/categorie/OneOfmyTerm >> Go to the term archive\nI would like to auto redirect https://www.website.com/categorie/ (with or without trailing slash) to https://www.website.com/categories\nif ( ! function_exists( 'custom_taxonomy' ) ) {\n    \n        // Register Custom Taxonomy\n        function custom_taxonomy() {\n        \n            $labels = array(\n                'name'                       => _x( 'Cat\u00e9gories de travaux', 'Taxonomy General Name', 'text_domain' ),\n                'singular_name'              => _x( 'Cat\u00e9gorie de travaux', 'Taxonomy Singular Name', 'text_domain' ),\n                'menu_name'                  => __( 'Cat\u00e9gories de travaux', 'text_domain' ),\n                'all_items'                  => __( 'Toutes les cat\u00e9gories', 'text_domain' ),\n                'parent_item'                => __( 'Parent Item', 'text_domain' ),\n                'parent_item_colon'          => __( 'Parent Item:', 'text_domain' ),\n                'new_item_name'              => __( 'Nouvelle cat\u00e9gorie', 'text_domain' ),\n                'add_new_item'               => __( 'Ajouter cat\u00e9gorie', 'text_domain' ),\n                'edit_item'                  => __( 'Modifier cat\u00e9gorie', 'text_domain' ),\n                'update_item'                => __( 'Modifier', 'text_domain' ),\n                'view_item'                  => __( 'Voir', 'text_domain' ),\n                'separate_items_with_commas' => __( 'Separate items with commas', 'text_domain' ),\n                'add_or_remove_items'        => __( 'Add or remove items', 'text_domain' ),\n                'choose_from_most_used'      => __( 'Choose from the most used', 'text_domain' ),\n                'popular_items'              => __( 'Popular Items', 'text_domain' ),\n                'search_items'               => __( 'Search Items', 'text_domain' ),\n                'not_found'                  => __( 'Not Found', 'text_domain' ),\n                'no_terms'                   => __( 'No items', 'text_domain' ),\n                'items_list'                 => __( 'Items list', 'text_domain' ),\n                'items_list_navigation'      => __( 'Items list navigation', 'text_domain' ),\n            );\n            $args = array(\n                'labels'                     => $labels,\n                'hierarchical'               => true,           \n                'public'                     => true,\n                'show_ui'                    => true,\n                'show_admin_column'          => true,                       \n                'show_in_nav_menus'          => true,\n                'show_tagcloud'              => true,\n                'show_in_rest'               => true,\n            );\n            register_taxonomy( 'categorie', array( 'devis' ), $args );\n        \n        }\n        add_action( 'init', 'custom_taxonomy', 0 );\n        \n        }\n\nThanks for reading.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406720", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Changing custom type name hides the posts I created a custom post type. Plugin used is Custom Post Types & Custom Taxonomies plugin which does the job very good.\nAnd added some posts to it.\nBut when I modify the name of the newly created custom post type, the posts no more show.\nI tried a plugin called pTypeConverter but I wish I didn't. It's outdated & not even getting deleted.\nWhat I finally did is this query:\nUPDATE `wp_posts`\nSET \n    `post_type` = REPLACE(`post_type`,'custompost1','student-portal'),\n    `guid` = REPLACE(`guid`,'<from old url>','<to new url>')\nWHERE `post_type` = 'custompost1'\n\nNow the posts show at the new post type but all the Metabox galleries I created with MetaBox.io aren't visible any more in the new custom post type.\nWhy doesn't WordPress follow the id as foreign key for example, why the name? And what to do to retrieve all posts as they already were but with the new custom post type (alongside their Meta Boxes).\n\nA: I think what you're saying is that you're changing the name of the posttype (CPT) itself not the posts within that post type.\nIf that IS the case then WordPress is performing exactly as it should.  That plugin is creating a CPT \"custompost1\" and then you are adding posts (1,2,3,etc) with that post type.\nThen you instructed the plugin to no longer show the post type \"custompost1\" when you changed it to \"student-portal\". That plugin isn't also changing all the actual posts you created. It's simply telling WordPress that the old post type is no longer valid (as it's no longer referencing it) but the new one what should be used.\nYou can do this in a couple ways, but the easiest for you would be to tell the plugin to create both CPTs (temporarily).  Then get another plugin that changes posts from one type to another.  There are many of these plugins (search post type switcher in the repository).\nNow open the original posts \"custompost1\" list, select all of them in the admin section and simply change them to \"student-portal\" CPT.\nAfter that is complete you should see all the posts now under the \"student-portal\" CPT list.\nAll that's left is to delete the post type switcher plugin and then remove the CPT \"custompost1\" from the plugin you used to create it.\nUPDATE\nTo edit all posts you can click the check box above all of the posts in the column header (pic attached).\nThen choose Bulk edit right above that(just above the red circle in my photo), then click apply.  just below that an options panel will open.  You can choose the post type there and then click apply.\nIf you have more than 20 posts, go to screen options in the top right and you'll see an option to show more than 20 posts per page.  Do this before you change them all and you can do it in one shot.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406721", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Block to accept and send email to specific domains I have a problem with my blog because a lot of emails are sent to one of these emails (different account some domain):\n\n*\n    \n*gemmasmith.co.uk\n\n*jenniferlawrence.uk\n\n*b-mail.online\n\n*katykahn.co.uk\n\n*sarahconner.co.uk\n\n*marymarshall.co.uk\n\nI don't understand why the blog is sending all those emails. So, I tried to block the registration for those domains. First, I added in the function.php of the theme the following code\n// prevent user registration in wordpress from specific domain\nfunction wpcs_disable_email_domain ( $errors, $sanitized_user_login, $user_email ) {\n    list( $email_user, $email_domain ) = explode( '@', $user_email );\n    if ( strpos($email_domain, 'b-mail.online') != false || \n         strpos($email_domain, 'dynainbox.com') != false || \n         strpos($email_domain, 'gemmasmith.co.uk') != false ||\n         strpos($email_domain, 'marymarshall.co.uk') != false ||\n         strpos($email_domain, 'katykahn.co.uk') != false || \n         strpos($email_domain, 'roastedtastyfood.com') != false\n    ) {\n        $errors->add( 'email_error', __( '<strong>ERROR</strong>: Domain not allowed.', 'my_domain' ) );\n    }\n    return $errors;\n}\nadd_filter( 'registration_errors', 'wpcs_disable_email_domain', 10, 3 );\n\nbut the emails are still sending. Then, I tried different plug-in like Ban Hammer or WP Security. Nothing.\nCould you help me to understand how to block all those emails to these domains?\n\nA: strpos will return 0 for a positive match at the start of a string, so your condition != false will evaluate as false - in other words...\n$email_domain = 'b-mail.online';\n\nif ( strpos( $email_domain, 'b-mail.online' ) != false ) {\n    // Will never reach here\n}\n\n...this is because != is known as a loose comparison, and 0 == false. You could use a strict comparison e.g. !== false but in this case you don't even need strpos since you're checking fully-qualified domain names. Just do something like:\n$blocked_domains = [\n    'b-mail.online',\n    // Other domain names\n];\n\nif ( in_array( $email_domain, $blocked_domains, true ) ) {\n    $errors->add( 'email_error', '<strong>ERROR</strong>: Domain not allowed.' );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406726", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is it possible to save crop to a different size of the image when in image editor? In Image editor, where one can crop and rotate images, there is an option to save changes only to thumbnail, or to all sizes, or to all sizes except thumbnail.\nIs there a way I can save them in another size? e.g. large or whatever\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406730", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Edit Ecommerce filters URL, h1, h2 , Title I'm working in a Real Estate Website with filters for location, price.\nI'm trying to edit URL permalinks, H1, H2 to make more SEO Friendly.\nFor example I would like to change https://www.realestatebuyandrent.com/houses/?region=252 to https://www.realestatebuyandrent.com/houses/queensland and improve the Title, Meta description, h1, so on.\nI tried to edit this URL with filters with Yoast SEO but it's not possible. How I could change that?\nThanks you\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406731", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How Can i import plugin option? hey guys i'm trying to import my plugin option into wordpress with php\nbut i can't find any tutorial or describe about this section\ni have this example:\nmy option name:\n\nget_option('meow');\n\nwhat i have in this option are\n'cats'=> '2',\n'food' => array('tona','fish'),\n\nso how can i use\n\nupdate_option\n\nto import this values?\ni tried this way but it's not working\nupdate_option('meow', 'cats','5');\n\n\nA: Just pass the array as the second argument to update_option - WordPress will serialize the value before storing it in the database, and automatically unserialize it when you read it:\nupdate_option( 'meow', array(\n    'cats' => '2',\n    'food' => array( 'tona', 'fish' ),\n) );\n\n$meow = get_option( 'meow' );\n\nprint_r( $meow );\n\n// Array\n// (\n//     [cats] => 2\n//     [food] => Array\n//         (\n//             [0] => tona\n//             [1] => fish\n//         )\n// )\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406733", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Share reusable blocks between network sites How can I share reusable blocks from the main site to all subfolder sites?\nBackground:\nI am in the planning stages of a WordPress multisite where I plan to write a custom theme from scratch and use the block editor for page layouts. The page is for an organization that has multiple locations, one main national site and a subfolder site for each location. This is needed to restrict editors to their own location. The page will rely heavily on reusable blocks and block patterns. Block patterns I will code into the theme.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406737", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Can someone explain me why apply_filters() is called here? I needed to make a function that is called once on CRUD operations on posts and articles. Then I came on this function: I'm not asking about purge_zone_once(), because I've removed the code in that function. I'm asking why does the author use this: $purge_actions = (array) apply_filters(xx, $yy) which returns exactly the same $yy without touching it:\nfunction register_purge_actions() {\n\n    // use `my_plugin_purge_actions` filter to alter default purge actions\n    $purge_actions = (array) apply_filters(\n        'my_plugin_purge_actions',\n        array(\n            'publish_phone', 'save_post', 'edit_post', 'delete_post',\n            'wp_trash_post', 'clean_post_cache',\n            'trackback_post', 'pingback_post', 'comment_post',\n            'edit_comment', 'delete_comment', 'wp_set_comment_status',\n            'switch_theme', 'wp_update_nav_menu', 'edit_user_profile_update'\n        )\n    );\n\n    foreach ($purge_actions as $action) {\n        if ( did_action( $action ) ) {\n            purge_zone_once();\n        } else {\n            add_action( $action, array( $this, 'purge_zone_once' ) );\n        }\n    }\n}\nfunction purge_zone_once() {\n    //blabla\n}\n\nI dont know how (and why) it \"alters default purge actions\" - like it's written in the comment. My own code works without the code apply_filters() at the beginning.\nI dont understand the point of the code apply_filters() at the beginning, which returns the same array (!).\nThis is the nginx cache purge plugin, which seems well coded, so I guess there's something important here but I dont see it.\n\nA: It's not doing anything on its own - the original author is offering you the ability to change these hard-coded actions without needing to edit the source code itself.\nImagine you just edited the array right there. Then a plugin update comes along, the file is overwritten, and your custom changes are lost.\nUsing a filter, the original author has allowed you to \"plug\" into their code from elsewhere, and now the two can co-exist without you losing your changes anytime the original plugin gets an update.\nIn fact, whether a plugin is actually ever updated or not (perhaps it's a private plugin and not hosted on the WordPress plugin repo), it's good practice to utilise filters & actions - it's the very heart of WordPress' \"pluggable\" architecture.\nIt seems like you've found this code online and are repurposing it to use directly yourself? In which case I can see why the filter could appear redundant, but I hope my answer sheds some light on why you might often see filters & actions in the wild.\nUpdate: Using the above code as an example, you could (from your own plugin or theme) add an additional action to $purge_actions like so:\nadd_filter( 'my_plugin_purge_actions', function ( $actions ) {\n    $actions[] = 'my_custom_action';\n\n    return $actions;\n});\n\nLearn more about WordPress hooks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406740", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: date format of custom date variable So i have this wp product query to get some products. and i want to sort by date, but i want to change the date format of this variable to yyyy-mm-dd. How should i go about doing this? Thanks in advance.\nThis is the product query:\n$args = array(\n    'post_type'      => 'product',\n    'posts_per_page' => 20,\n    'orderby'   => 'meta_value',\n    'meta_key'  => 'pa_review_date',\n );\n\nis there a way do format the date in this query or can this be done in a php function where i change the format of all the review_date?\nEDIT:\nto be clear: The current date format is fine, but to be able to sort by that date in the product query i want to change the format. in the product data itself the date needs to stay what it is now. only when sorting the products by the date i want the correct format. not in the frontend. i dont know if this is possible without changing all the dates in the backend first..\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406741", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sql query does not work well I have a problem with a SQL query in wordpress.\nI create a query that return product_ID of products that have one or more attribute.\n\nI have highlighted my problem. I want to displya the product that have all attribute, instead with OR the function return products they have at least one of the attributes.\nBut if I change OR with AND the function return all product.\nI'm probably wrong anything.\nI share all code:\nadd_action('wp_ajax_nopriv_filter_woocommerce_product', 'filter_woocommerce_product');\nfunction filter_woocommerce_product() {\n    global $wpdb;\n    $filtri_selezionati = $_REQUEST['selected'];\n    $sql = \"SELECT distinct(p.`id`) AS 'Product_ID'\n                FROM   `wp_posts` AS p\n                    INNER JOIN `wp_term_relationships` AS tr\n                            ON p.`id` = tr.`object_id`\n                    INNER JOIN `wp_term_taxonomy` AS tt\n                            ON tr.`term_taxonomy_id` = tt.`term_id`\n                            AND tt.`taxonomy` LIKE 'pa_%'\n                    INNER JOIN `wp_terms` AS t\n                            ON tr.`term_taxonomy_id` = t.`term_id`\n                WHERE  p.`post_type` = 'product'\n                    AND p.`post_status` = 'publish' AND \";\n    $where = '';\n    if(!empty($filtri_selezionati)){\n        unset($_SESSION['filtri_attivi']);\n        foreach ($filtri_selezionati as $key => $value) {\n            if($key == 0){\n                $explode_value = explode('_',$value);\n                $_SESSION['filtri_attivi'][] = $value;\n                $where .= '(tt.taxonomy=\"pa_'.$explode_value[0].'\" AND t.name = \"'.$explode_value[1].'\") ';\n            } else {\n                $explode_value = explode('_',$value);\n                $_SESSION['filtri_attivi'][] = $value;\n                $where .= ' OR (tt.taxonomy=\"pa_'.$explode_value[0].'\" AND t.name = \"'.$explode_value[1].'\")';\n            }\n        }\n        error_log($sql.$where);\n        $product_filtering = $wpdb->get_results($wpdb->prepare($sql.$where));\n    }\n    unset($_SESSION['product_filter']);\n    if(empty($product_filtering)){\n        $_SESSION['product_filter'] = [];   \n    } else{\n        foreach($product_filtering as $product){\n            $_SESSION['product_filter'][] = $product->Product_ID;\n        }\n    }\n    $response['success'] =  1;\n    wp_send_json($response);\n    wp_die();\n\n    \n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406742", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change image data durgin upload I try to change image filename and image meta during upload to media library.\nI have a problem with create unique filename hence, a bad slug is generated.\nAlso, during upload, file uploaded by this function is moving to wrong folder(2022/05 instead of 2022/06).\nMy function:\nfunction changeImgDataDurinUpload( $post_ID ) {\n\n    if ( is_product() ):\n\n        $post_id = $_REQUEST['post_id'] ?? false;\n        $product = wc_get_product( $post_id );\n\n        if ( $product ) {\n            $productSku = str_replace( '/', '', $product->get_sku() );\n        } else {\n            $productSku = '';\n        }\n\n        if ( $post_id ) {\n            $imageFileName = get_the_title( $post_id ) . '-' . $productSku;\n            $imageTitle    = get_the_title( $post_id ) . '-' . $productSku;\n        } else {\n            $imageFileName = get_post( $post_ID )->post_title;\n            $imageTitle    = get_post( $post_ID )->post_title;\n        }\n\n        $imageFileName = preg_replace( '#[ -]+#', '-', $imageFileName );\n\n\n        // Sanitize the title:  remove hyphens, underscores & extra spaces:\n        $imageTitle = preg_replace( '%\\s*[-_\\s]+\\s*%', ' ', $imageTitle );\n\n        // Sanitize the title:  capitalize first letter of every word (other letters lower case):\n        $imageTitle = ucwords( strtolower( $imageTitle ) );\n        $imageTitle = wp_unique_filename( 'wp-content/uploads/2022/06', '$imageTitle' );\n\n\n        // Create an array with the image meta (Title, Caption, Description) to be updated\n        // Note:  comment out the Excerpt/Caption or Content/Description lines if not needed\n        $my_image_meta = array(\n            'ID'           => $post_ID,            // Specify the image (ID) to be updated\n            'post_title'   => $imageTitle,     // Set image Title to sanitized title\n            'post_excerpt' => $imageTitle,     // Set image Caption (Excerpt) to sanitized title\n            'post_content' => $imageTitle,     // Set image Description (Content) to sanitized title\n        );\n\n\n        $file        = get_attached_file( $post_ID );\n        $path        = pathinfo( $file );\n        $newfilename = wp_unique_filename( $path['dirname'], $imageFileName );\n        $newfile     = $path['dirname'] . \"/\" . $newfilename . \".\" . $path['extension'];\n\n        rename( $file, $newfile );\n        update_attached_file( $post_ID, $newfile );\n\n\n        // Set the image Alt-Text\n        update_post_meta( $post_ID, '_wp_attachment_image_alt', $imageTitle );\n\n        // Set the image meta (e.g. Title, Excerpt, Content)\n        wp_update_post( $my_image_meta );\n\n    endif;\n\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406746", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Remove Body Classes I need to remove specific body classes added as a comma separated delimited list to a custom field input field like this\nwp-custom-logo, single-post, postid-28, single-format-standard, logged-in, admin-bar\n\nUsing this code only allows me to remove 1 class\nadd_filter('body_class', function (array $classes) {\n\nif ( ! is_singular(array( 'post', 'page' ) ) ) {\n    return;\n}\n\n$body_classes = get_post_meta( get_the_ID(), '_remove_body_classes', true );\n\nunset( $classes[array_search($body_classes, $classes)] );\n\nreturn $classes;\n\n});\n\nThis code works when trying to remove 1 class on single posts but doesn't work when using a comma delimited list and also doesn't work on single pages.\n\nA: One (untested) suggestion is to replace:\nunset( $classes[array_search($body_classes, $classes)] );\n\nwith\n$classes = array_diff( $classes, wp_parse_slug_list( $body_classes ) );\n\nassuming the classes survive sanitize_title from wp_parse_slug_list(). It should also be alright with empty arrays.\nWe also note that wp_parse_slug_list() is using wp_parse_list() to parse the comma separated string.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406747", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to send woocommerce emails in multiple languages I am relatively new to wordpress and I have been stuck on this issue for about 4 days.\nI am trying to make it so that emails sent by woocommerce when order is completed are sent in the language set by the user on the website. I am using polylang to have my site available in multiple languages\nI am trying to achieve this by changing the woocommerce email template.\nI tried using get_locale(), but that always returned the default polylang language, i tried pll_current_language but that also didnt work. I tried a lot of other things aswell.\nI am almost sure what i am trying to do should be possilbe and i am asking if anybody could help me solving this issue. Thank you in advance\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406749", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Loop and $post I decided to take a closer look at how WP works and ran into this question. I see that when WP is loaded, the wp() function is triggered, which will parse the request and get data from the database in the global $post variable, there will already be data. At the same time, WP recommends always using Loop, which will send the same request to the database again. I do not quite understand what is the point in this case of WP Loop. Which for example on the page/post just do the same thing?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406750", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is there a JavaScript equivalent of get_post_field? I recently installed @wordpress/hooks so that I could use applyFilters on the react side of my plugin, but I'm looking for something for get_post_field as well. I haven't seen it in any of the NPM packages that I've found. Is there anything out there?\n\nA: The @wordpress/hooks package only gives you a JS-like equivalent to the PHP-based hook system in WordPress - they are entirely separate, and don't bring any native WP PHP functions to the table.\nWhat you need (most likely) is an AJAX request to the WordPress REST API.\nSpecifically, the GET posts endpoint, which by default is:\nhttps://example.com/wp-json/wp/v2/posts/<post_id>\n\nThat will retrieve a JSON object representation of the post. An example JS function using fetch might look like:\nasync function get_post_field( post_id, field ) {\n    const restUrl = document.querySelector( 'link[rel=\"https://api.w.org/\"]' ).getAttribute( 'href' );\n\n    const response = await fetch( `${restUrl}wp/v2/posts/${post_id}` );\n\n    const post = await response.json();\n\n    let value = await post[ field ];\n\n    if ( value.rendered !== undefined ) {\n        value = value.rendered;\n    }\n\n    return value;\n}\n\nconst title = await get_post_field( post_id, 'title' );\n\nThis code assumes you're running it in the context of a default WordPress page (since it grabs the base REST API URL from the <link rel=\"https://api.w.org/\" /> tag added in the <head />.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406751", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: wp_schedule_single_event is set correctly but sometimes not fired I have a strange issue with my plugin. I have custom statuses in WooCommerce.\nMy plugin changes order status after 15 min after order creation.\nHere's code of the plugin class\nThis code works almost in 99% cases, but sometimes the cron job is not fired. Please read comments in the code. I'm sure that the event is scheduled but not fired in some cases. I have no idea how to find what is the cause.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406752", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: 404 error comes up when I go to wp-admin after first installation I just installed wordpress for the first time. When I go to mywebsite.com/wp-admin a 404 website error comes up. I went through the routine of changing the plugins and themes names although I never entered my wordpress dashboard anyway. Domains by Godaddy hosting by Hostgator. I changed the DNS to match the hostgator DNS. Uninstall and reinstall wordpress, nothing happened. What do I do?\n\nA: Two issues seem likely:\n\n*\n\n*Your DNS changes haven't propagated yet.  It takes awhile for the DNS change to spread across the internet.  Give it 1-2 hours and try again.  [Hostgator recommends pointing your name servers to them.]\n\n*If the issue remains, then check how your domain was entered into the quick installer.  It's possible that an extra / is causing the whole thing to fail.\n\nIf neither of these is the culprit, then I'd suggest you contact their support team at https://helpchat.hostgator.com\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406753", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: WordPress default gallery pagination when in page (is_page)? It seems I have found the way to make WordPress default gallery pagination to work and to have control over URL forming: Pagination with WordPress default gallery? But when gallery call is in post.\nWhen gallery call is in page, it works only if URL is like this: domain.com/pagename/page/2/, domain.com/pagename/page/3/ etc. Trying to have a different URL ends up in stopping it to work.\nThe part of code handling pagination in functions.php:\n// Pagination Setup\n$current = (get_query_var('paged')) ? get_query_var( 'paged' ) : 1;\n$per_page = 3;\n$offset = ($current-1) * $per_page;\n$big = 999999999;\n$total = sizeof($attachments);\n$total_pages = round($total/$per_page);\nif( $total_pages < ( $total/$per_page ) ){\n    $total_pages = $total_pages+1;\n}\n\n// Pagination output\n$output .= paginate_links( array(\n    'base' => str_replace($big,'%#%',esc_url(get_pagenum_link($big))),\n    'format' => '?paged=%#%',\n    'current' => $current,\n    'total' => $total_pages,\n    'prev_text'    => __('&laquo;'),\n    'next_text'    => __('&raquo;')\n) );\n\nAs long as I keep URL like this domain.com/pagename/page/2/ , other ways for 'base' also work:\n'base' => get_permalink( $post->post_parent ) . '%_%',\n'format' => 'page/%#%/',\n\nAnd like this:\n'base' => get_pagenum_link( 1 ) . '%_%',\n'format' => 'page/%#%/',\n\nBut when I try some other URL scheme:\n'base' => get_permalink( $post->post_parent ) . '%_%',\n'format' => 'paging-%#%',\n\npagination stops working.\nThe filter with rewrite tag and rule:\nadd_filter('init', 'post_gallery_add_rewrite_tag_rule_2022');\nfunction post_gallery_add_rewrite_tag_rule_2022() {\n    add_rewrite_tag('%current%','(.+)');\n    add_rewrite_rule('(.+)/paging-/?([0-9]{1,})/?$', 'index.php?name=$matches[1]&paged=$matches[2]', 'top');\n}\n\nIt seems like add_rewrite_rule is not functioning when gallery call is in page? Or what? Any ideas?\n\nA: Probably because in your rewrite rule index.php?name=$matches[1]&paged=$matches[2], name is a query var for post slugs - if you want to match pages you need pagename.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406759", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Restrict posts to customers with complete WooCommerce orders only I have a couple of custom post types (zoom meetings)  that I need to be only accessed by users who have \"completed\" orders in the backend. Any workaround on this? Can't find it anywhere.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406761", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Build Clickable Link Using Multiple Attributes I am trying to build a function for WordPress (running Elementor, if that matters) that will concatenate 3 items to build a URL, then display that URL in a link that will open in a new window.   The start and end of the URL are both static text, and the middle comes from another function via shortcode.  I plan to add this to the site in a snippet.\nHere is what I have so far.  As you will see, I don't have anything in the heart of the function, which is the \"Build URL\" section, and I'm not sure if the other sections are done right either.  Other than that, it's pretty much complete ;-)\n// Function content\nfunction item_link( $atts ) {\n\n    // Only run on pages tied to a single product\n    global $post, $product;\n\n    // Get the item data from the shortcode\n    $URLslug = do_shortcode( '[contractAddress]' );\n\n    // Set pre- and post- text for URL\n    $PREtext = 'https://finance.yahoo.com/quote/';\n    $POSTtext = '/history';\n\n    // Build URL\n    // This should create clickable link with URL equal to $PREtext + $URLslug + $POSTtext\n    // Link text should be 'Click here to view results'\n    // Link should open in new window\n\n}\n\n// Assign function to shortcode \nadd_shortcode('See In New Window', 'item_link');\n\nAny help greatly appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406769", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get_children() Archive Template This is my first attempt at coding & I have come unstuck with the wp_query loop integration.\nI just want to build a template for a page that will check for children and list their respective Thumbnail and Title as links (see below example)\n\nI have added the below code into functions.php (hope this is best practice)\n$childPages = get_children( array(\n  'post_parent' => get_the_ID(),\n  'post_type' => 'page',\n  'post_status' => 'publish',\n  'orderby' => array(\n    'menu_order' => 'ASC',\n    'title' => 'ASC'\n  )\n));\n\nI am really having trouble grasping the loop on my childTemplate.php! I have respectively placed the following code in this template:\n<?php\n/**\n* Template Name: Child Archive\n*\n* @package WordPress\n\n*/\n\n\n  // Custom query.\n  $query = new WP_Query( $childPages);\n   \n\n    if (sizeof($childPages))\n        <div class=\"row\">\n          foreach ($childPages as $page)\n            <div class=\"col-12 col-sm-6 mb-4\">\n          <a href=\"get_page_link($page)\"><img src=\"get_the_post_thumbnail_url($page)\" alt=\"$page->post_title\"     class=\"img-fluid mb-2\"></a>\n              <h2 class=\"text-center\"><a href=\"get_page_link($page)\">$page->post_title</a></h2>\n            </div>\n          endforeach\n    endif\n\n\n  // Restore original post data.\n  wp_reset_postdata();\n   \n?>\n\nWould be awesome if somebody could review my coding attempt, and steer me in the right direction to grasping the wp_query + Loop part of the solution. I have been reading up on it but still struggling.\nMany thanks in advance\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406770", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: want to show CMB2 metabox on woocommerce product data tab Try to show CMB2 generated metabox on newly created woocommerce product data tab instead of woocommerce_wp_text_input text field function, also added an image that indicate what i want to achive.\n\nHere is the code that generate tab on product data section\n\nadd_filter( 'woocommerce_product_data_tabs', 'add_gift_wrapper_tab_product_data' );\nfunction add_gift_wrapper_tab_product_data( $product_data_tabs ) {\n    $product_data_tabs['gift-wrapper'] = array(\n        'label' => __( 'Gift Wrapper', 'woocommerce' ),\n        'target' => 'gift_wrapper_product_data',\n        'class'     => array( 'show_if_simple' ),\n    );\n    return $product_data_tabs;\n}\n\n\nadd_action('woocommerce_product_data_panels', 'woocom_custom_product_data_fields');\nfunction woocom_custom_product_data_fields() {\n    global $post;\n    \n    ?> <div id = 'gift_wrapper_product_data'\n    class = 'panel woocommerce_options_panel' > <?php\n        ?> <div class = 'options_group' > <?php\n            <!-- want to load CMB2 generated metabox on here -->\n\n        ?> </div>\n    </div><?php\n}\n\n/*Here is the CMB2 metabox code Generate CMB2 repeater metabox code */\n\nadd_action( 'cmb2_admin_init', 'ndp_metabox_function' );\n\nfunction ndp_metabox_function() {\n\n$prefix = '_ndp_';\n\n$gift_wrapper = new_cmb2_box( array(\n    'id'            => 'metabox_gift_tab_id',\n    'title'         => __( 'Add Gift Wrapper Details', 'cmb2' ),\n    'object_types'  => array('product'), // Post type\n    'context'       => 'normal',\n    'priority'      => 'high',\n    'show_names'    => true\n) );\n\n$gift_wrapper_section=$gift_wrapper->add_field( array(\n'id'          =>  $prefix.'repeat_gift_group',\n'type'        => 'group',\n'description' => __( 'Generates field for gift details info', 'cmb2' ),\n'repeatable'  => true, // use false if you want non-repeatable group\n'options'     => array(\n    'group_title'   => __( 'Entry Gift Item {#}', 'cmb2' ), // since version 1.1.4, {#} gets replaced by row number\n    'add_button'    => __( 'Add Gift Details', 'cmb2' ),\n    'remove_button' => __( 'Remove Gift Details', 'cmb2' ),\n    'sortable'      => true, // beta\n    // 'closed'     => true, // true to have the groups closed by default\n),\n) );\n\n$gift_wrapper->add_group_field( $gift_wrapper_section, array(\n'name' => 'Gift Wrapper Image',\n'desc' => '',\n'id'         => $prefix . 'gift_wrapper_image',\n'type' => 'file',\n'preview_size' => array( 150, 150 ), // Default: array( 50, 50 )\n'query_args' => array( 'type' => 'image' ), // Only images attachment\n// Optional, override default text strings\n'text' => array(\n    'add_upload_files_text' => 'Upload Gift Wrapper Image', // default: \"Add or Upload Files\"\n    'remove_image_text' => 'Remove Gift Wrapper Image', // default: \"Remove Image\"\n    'file_text' => 'File:', // default: \"File:\"\n    //'file_download_text' => 'Replacement', // default: \"Download\"\n    'remove_text' => 'Remove', // default: \"Remove\"\n    ),\n) );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406771", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: $wpdb->get_results(...) with $wpdb->prepare(...) returns empty array despite correct query My MySQL query is correct, but $wpdb->get_results(...) produces an empty array. Here's my code:\n$key = 'user-input-key';\n$value = 'user-input-value';\n$value = '%' . $value . '%';\n$query = \"SELECT * FROM {$wpdb->prefix}postmeta WHERE meta_key=%s AND meta_value LIKE %s\";\n$prepared_query = $wpdb->prepare($query, array($key,$value));\n$query = $wpdb->get_results($prepared_query);\n// result: array()\n\nI found the following Q&A that looked similar but did not address this exact problem:\n\n*\n\n*$wpdb->get_results(...) returns empty array despite correct\nquery (where $wpdb->prepare() was not used)\n\n*$wpdb->prepare returns empty array (where $wpdb->prepare() did\nnot contain LIKE)\n\nAs well as many other cases of empty results, none of which was quite what I needed.\nBelow is the solution I found.\n\nA: This string, meta_value LIKE '%user-input-value%'\", contains percentage wilcards (%) that indicate that we're looking for a row where meta_value column contains user-input-value as part of its value.\n$wpdb->prepare converts them into hashes, and the MySQL server gets something like this: meta_value LIKE '{399038939300d2c307c53b29a166ee90101da7b2aba7978a898694010bf1bfe6}user-input-value{399038939300d2c307c53b29a166ee90101da7b2aba7978a898694010bf1bfe6}'. Naturally, I was getting no results!\nThe wpdb::prepare page reads, 'Literal percentage signs (%) in the query string must be written as %%. Percentage wildcards (for example, to use in LIKE syntax) must be passed via a substitution argument containing the complete LIKE string, these cannot be inserted directly in the query string. Also see wpdb::esc_like().'\nSo, the LIKE part must be prepared like this (example from the wpdb::esc_like() page):\n$wild = '%';\n$find = 'only 43% of planets';\n$like = $wild . $wpdb->esc_like( $find ) . $wild;\n$sql  = $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE post_content LIKE %s\", $like );\n\nWhere $wpdb->esc_like() should go before $wpdb->prepare().\nAnd if one wants to replace percentage wildcard placeholders manually, they should use $wpdb->remove_placeholder_escape() after $wpdb->prepare().\nI ended up with this code, which worked:\n$key = 'user-input-key';\n$value = 'user-input-value';\n$value = '%' . $wpdb->esc_like($value) . '%';\n$query = \"SELECT * FROM {$wpdb->prefix}postmeta WHERE meta_key=%s AND meta_value LIKE %s\";\n$prepared_query = $wpdb->prepare($query, array($key,$value));\n$prepared_query = $wpdb->remove_placeholder_escape($prepared_query);\n$query = $wpdb->get_results($prepared_query);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406772", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: manage_shop_order_posts_custom_column() hook is Not working In Functions.php file in my WordPress active theme As I added the manage_shop_order_posts_custom_column() hook in the functions.php file But the custom column post data not showing on the shop_order page.\nmanage_edit-shop_order_columns Filter is working fine. But the manage_shop_order_posts_custom_column hook is Not working Can you please help. I don't Find the reason also Don't show Any Errors.\nBelow Is my Code:\n//ADDING 2 NEW COLUMNS WITH THEIR TITLES (keeping \"Total\" and \"Actions\" columns at the end)\nadd_filter( 'manage_edit-shop_order_columns', 'custom_shop_order_column2', 20 );\nfunction custom_shop_order_column2($columns)\n{\n    $reordered_columns = array();\n    // Inserting columns to a specific location\n    foreach( $columns as $key => $column){\n        $reordered_columns[$key] = $column;\n        if( $key ==  'order_status' ){\n            // Inserting after \"Status\" column\n            $reordered_columns['my-column1'] = __( 'Title1','theme_domain');\n            $reordered_columns['my-column2'] = __( 'Title2','theme_domain');\n        }\n    }\n    return $reordered_columns;\n}\n// Adding custom fields meta data for each new column (example)\nadd_action( 'manage_shop_order_posts_custom_column' , 'custom_orders_list_column_content2',  100, 2 );\nfunction custom_orders_list_column_content2( $column, $post_id )\n{\n    switch ( $column )\n    {\n        case 'my-column1' :\n            // Get custom post meta data\n            $my_var_one = get_post_meta( $post_id, '_the_meta_key1', true );\n            if(!empty($my_var_one))\n                echo $my_var_one;\n            // Testing (to be removed) - Empty value case\n            else\n                echo '<small>(<em>no value</em>)</small>';\n            break;\n        case 'my-column2' :\n            // Get custom post meta data\n            $my_var_two = get_post_meta( $post_id, '_the_meta_key2', true );\n            if(!empty($my_var_two))\n                echo $my_var_two;\n            // Testing (to be removed) - Empty value case\n            else\n                echo '<small>(<em>no value</em>)</small>';\n            break;\n    }\n}\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406775", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Post incorrectly excluded when using \"category__in\"? I have a wp_query using the following arguments. While I have the 'category__in' line commented out, I get all 3 results I should. Shown below with the IDs of the categories they belong to. Category 1413 is present for all 3 posts.\n$args = array(\n    'post_type' => 'clinic',\n    'post__in' => array(20706, 25986, 26275),\n    // 'category__in' => array( 1413, 1416 )\n    );\n\n$clinics = new WP_Query( $args );\n\n\nWhen I add the 'category__in' line post 20706 isn't returned, despite being in category 1413.\n\nI can't figure out why this post is being excluded. Is there another way to limit results to posts with either category 1413 or 1416 which might return post 20706 as well as the other two?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406778", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to make an admin plugin menu page go full screen? I'm building a plugin that contains a simple editor for a particular file format.  This will only be accessible in the admin menu's for the plugin, no frontend access.  I've started looking at the actual editor layout and it needs some more real estate on the admin side, so I want to hide the admin menu panels.  It would also be cleaner and reduce any unnecessary clutter, like the Gutenberg editor, or the customise theme page.  Here's a few options that I'm thinking of:\n\n*\n\n*I could make the editor completely full screen and have a \"back to WordPress\" button to go back to admin screen\n\n*It could work equally well to hide the left admin menu and leave in the top bar, although this would be a waste of space on mobile.\n\nAre there any built in WordPress functions that hide the admin menu?  I think my preferred way to add the editor is to use the add_submenu_page() so that it has it's own page in the menu.  However I don't know if there are any standard methods to hide the default admin menu panels on a particular page?\nOtherwise I could create the editor in it's own standalone file that the user visits but then I'll have to add a lot of WordPress functions such as checking that the user is logged in, and providing standard WordPress functionality.\nI want all the code to be contained within the plugin, so I don't want to edit any pages in wp-admin.\n\nA: Per the comments, it doesn't seem there is anything built in for this.  I included this code in my page to hide the admin menus:\n<style>\n    #adminmenumain, #wpadminbar {\n        display: none;\n    }\n</style>\n\nYou'll have to muck about with CSS to get your page right.  But it seems to work ok.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406779", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: bp-custom.php is not working on a WordPress multisite environment. how to fix it? I'm using the youzify plugin. It has an option: if you want to add a custom code, you need to create a file named bp-custom.php in the WordPress plugin root folder. And youzify provides some code on their GitHub page. But it worked on only regular sites, not a multisite environment.\nHow can I fix it? Can anyone help me to modify those codes? I tried to insert those codes using the snippets plugin, but it showed \"Cannot redeclare function yzc_redirect_bp_directories_to_login_page\"\n<?php\n// Enable Page Login Popup\nfunction yzc_add_login_page_attribute( $atts, $item, $args ) {\n  \n    if ( is_user_logged_in() ) {\n        return $atts;\n    }\n\n    // Get Login Page ID.\n    $login_page_id = 50;\n\n    // Add Attribute.\n    if ( $item->ID == $login_page_id ) {\n        $atts['data-show-youzify-login'] = 'true';\n    }\n\n    return $atts;\n}\n\nadd_filter( 'nav_menu_link_attributes', 'yzc_add_login_page_attribute', 999, 3 );\n\n\n\n\n\n/**\n* Redirect Buddypress Directories To Login Page For Non Logged in Users.\n*/\nfunction yzc_redirect_bp_directories_to_login_page() {\n\n    if ( ! is_user_logged_in() && ( bp_is_groups_directory() || bp_is_members_directory() ) ) {\n        \n        // Get Buddypress Pages;\n        $bp_pages = get_option( 'bp-pages' );\n        \n        // Get Redirection Url\n        $redirect_url = youzify_get_login_page_url();\n        \n        wp_redirect( $redirect_url );\n        exit();\n    }\n}\n\nadd_action( 'template_redirect', 'yzc_redirect_bp_directories_to_login_page' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406782", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Merge 2 product attribute terms I have 2 similar product attributes and would like add the meta data(terms) to the other.\nSo I would like to make a php function that :\n\n*\n\n*get list of all the terms from attribute 'reviewed_by'\n\n*updates the newly created 'review_names' by adding all the terms from 'reviewed_by'\n\nThe function right now(only trying to get term list right now):\nfunction merge_product_attribute(){ \n\n    $taxonomy = 'pa_reviewed_by';\n    $terms    = get_terms( array('taxonomy' => $taxonomy, 'hide_empty' => false) );\n    $term_list = array();\n\n    // Loop through the terms for 'pa_reviewed_by' taxonomy\n    foreach ( $terms as $term ) {\n        $term_name = $term->name; // name\n        array_push($term_list, $term_name)\n    }\n}\n\nRight now when i try to log out the $term_name no values are found for some reason.\nAnything im missing here? Thanks in advance\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406784", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to set value selected using select2 jquery plugin In my file, i have small html bellow:\n<div class=\"dropdown-mul-2\">\n        <select style=\"display:none;\"  name=\"dom767_options[all_posts][]\" id=\"mul-2\" multiple placeholder=\"Select\">\n            <!-- Data will be loading by ajax call -->\n        </select>\n    </div>\n\nHere is my jquery code\njQuery(window).load(function($) {\n        // Ajax Header Advertise Post Request\n        jQuery(document).ready(function() {\n            jQuery.ajax({\n                type: 'POST',\n                url: '<?php echo admin_url('admin-ajax.php');?>',\n                dataType: \"html\", // add data type\n                data: { action : 'get_ajax_posts' },\n                success: function( response ) {\n                        console.log(response);\n                        jQuery(\"#mul-2\").html(response);\n                        jQuery(\"#mul-2\").val(response.ID).trigger('change');\n        \n                }\n            });\n\n             // Changing post type color\n             jQuery('#select2-mul-2-results li.select2-results__option').each(function($) {\n                var txt = jQuery(this).text();\n                // console.log(txt);\n                if (txt.indexOf('Events') > -1) {\n                    jQuery(this).html(jQuery(this).html().split(\"Events\").join(\"<span class='event'>Events</span>\"));\n                    jQuery(\".event\").css(\"color\", \"red\");\n                } else if(txt.indexOf('Jobs') > -1) {\n                    jQuery(this).html(jQuery(this).html().split(\"Jobs\").join(\"<span class='jobs'>Jobs</span>\"));\n                    jQuery(\".jobs\").css(\"color\", \"purple\");\n                } else if(txt.indexOf('Directory listings') > -1) {\n                    jQuery(this).html(jQuery(this).html().split(\"Directory listings\").join(\"<span class='d-listings'>Directory listings</span>\"));\n                    jQuery(\".d-listings\").css(\"color\", \"blue\");\n                } else if(txt.indexOf('Announcement') > -1) {\n                    jQuery(this).html(jQuery(this).html().split(\"Announcement\").join(\"<span class='announcement'>Announcement</span>\"));\n                    jQuery(\".announcement\").css(\"color\", \"orange\");\n                }\n\n            });\n\n            // Pagination with scroll infinity\n            jQuery.fn.select2.amd.require(\n            ['select2/data/array', 'select2/utils'],\n            function (ArrayData, Utils) {\n                function CustomData($element, options) {\n                    CustomData.__super__.constructor.call(this, $element, options);\n                }\n                \n                function contains(str1, str2) {\n                    return new RegExp(str2, \"i\").test(str1);\n                }\n\n                Utils.Extend(CustomData, ArrayData);\n                \n                CustomData.prototype.query = function (params, callback) {\n                    if (!(\"page\" in params)) {\n                        params.page = 1;\n                    }\n                    var pageSize = 10;\n                    var results = this.$element.children().map(function(i, elem) {\n                        if (contains(elem.innerText, params.term)) {\n                            return {\n                                id:[elem.innerText, i].join(\"\"),\n                                text:elem.innerText\n                            };\n                        }\n                    });\n                    callback({\n                        results:results.slice((params.page - 1) * pageSize, params.page * pageSize),\n                        pagination:{\n                            more:results.length >= params.page * pageSize\n                        }\n                    });\n                };\n\n                jQuery(\"#mul-2\").select2({\n                    ajax:{},\n                    allowClear:true,\n                    width:\"element\",\n                    multiple:true,\n                    dataAdapter:CustomData,\n                });\n            });\n        });        \n    });\n\nAnd My function.php file code is below:\n// Advertisement post loading function\nfunction get_ajax_posts() {\n    // you can use WP_Query, query_posts() or get_posts() here - it doesn't matter\n    $args = array(\n        'post_type'         => array( 'ajde_events', 'jobs', 'w2dc_listing', 'announcement' ),\n        'orderby'           => 'ID',\n        'post_status'       => 'publish',\n        'order'             => 'DESC',\n        'posts_per_page'    => 100 // this will retrive all the post that is published \n        );\n        $result = new WP_Query( $args );\n\n\n        if ( $result-> have_posts() ) : \n\n        while ( $result->have_posts() ) : $result->the_post();\n            $current_id = get_the_ID();\n        ?>\n            <option value=\"<?php echo get_the_ID(); ?>\"\n        <?php\n        if ( !empty( dom767_get_option( 'all_posts' ) ) ) {\n                foreach ( dom767_get_option( 'all_posts' ) as $headerpost ) \n                {\n                    echo $headerpost == $current_id ? 'selected' : '';\n                }\n        }\n        ?>> <?php the_title(); ?>\n        <?php \n        $post_type = get_post_type( get_the_ID() );\n\n        switch ($post_type){\n            case 'ajde_events':\n                $posttypeName = '<span class=\"events\">Events</span>';\n                break;\n            case 'jobs':\n                $posttypeName = '<span class=\"job\">Jobs</span>';\n                break;\n            case 'w2dc_listing':\n                $posttypeName = '<span class=\"d-listing\">Directory listings</span>';\n                break;\n            case 'announcement':\n                $posttypeName = '<span class=\"announcement\">Announcement</span>';\n                break;  \n        }\n\n        echo '- '.$posttypeName;\n\n        ?>\n        </option>  \n        \n        <?php endwhile;\n        // print_r(dom767_get_option( 'all_posts' ));\n        $cctitle = get_post_field( dom767_get_option( 'all_posts' ) );\n        print_r(dom767_get_option( 'all_posts' ));\n        endif; \n\n        wp_reset_postdata();    \n}\n// Fire AJAX action for both logged in and non-logged in users\nadd_action('wp_ajax_get_ajax_posts', 'get_ajax_posts');\nadd_action('wp_ajax_nopriv_get_ajax_posts', 'get_ajax_posts');\n\n**So now, what i trying to achieve, all is working fine, but when i save data using the select2 field, the data isn't set selected after reloading the page, Thanks for the advance **\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406785", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Codeless random token generation to pass into multiple tracking links in a single page load In domain my-nice-company.com (my WordPress) I want to include traking transparent images to some-tracker.org/1x1-transparent.png and some-other-tracker.info/track/pixel.jpg\nI want to pass-in a parameter to both images to represent that they both are \"the same page load\". For example:\nsome-tracker.org/1x1-transparent.png?token=123\nsome-other-tracker.info/track/pixel.jpg?token=123\n\nI want to generate a random token at each page load so the next load it could be:\nsome-tracker.org/1x1-transparent.png?token=xyz\nsome-other-tracker.info/track/pixel.jpg?token=xyz\n\nLater, outside the wordpress, I can match the data at some-tracker.org and some-other-tracker.info and know those two queries represented the same page load by matching the token.\nAny way to do that code-less? (ie: natively, via third-parte open-source plugins, etc.)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406787", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can I make a Customizer dropdown-pages list include private pages? I'm using the following code to add a field to the Customizer where the user can select a page from the available pages on the site:\n$wp_customize->add_control( 'resources_page', array(\n    'type' => 'dropdown-pages',\n    'section' => 'key_page_locations',\n    'label' => 'Resources page',\n    'description' => 'A page for private resources'\n) );\n\nThe theme then uses this field's value in various places to show links to the Resources page. But the Resources page is (intentionally) private, so it doesn't show in the dropdown-pages list. Can I force the list to allow a private page to be selected here?\nThanks!\n\nA: Unfortunately there doesn't seem any way to hook into the underlying get_pages call that the control dropdown-pages uses, so you'll have to build your own set of choices (that includes private pages) and use the standard select control type instead:\nif ( ! class_exists( 'WPSE_406789_Walker_Page_Options' ) ) {\n    class WPSE_406789_Walker_Page_Options extends Walker_Page {\n        public $choices = [];\n\n        public function start_el( &$output, $data_object, $depth = 0, $args = [], $current_object_id = 0 ) {\n            $pad = str_repeat( '&nbsp;', $depth * 3 );\n\n            $this->choices[ $data_object->ID ] = $pad . get_the_title( $data_object );\n        }\n    }\n}\n\n$walker = new WPSE_406789_Walker_Page_Options();\n\n$pages = get_pages([\n    'post_status' => [\n        'publish',\n        'private',\n    ],\n]);\n\n$walker->walk( $pages, 0, [], 0 );\n\n$wp_customize->add_control( 'resources_page', [\n    'type' => 'select',\n    'choices' => $walker->choices,\n    'section' => 'key_page_locations',\n    'label' => 'Resources page',\n    'description' => 'A page for private resources',\n]);\n\nI've used a custom walker here so that you still get the &nbsp; padding that the default wp_dropdown_pages generates to visualise the page hierarchy.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406789", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Retrieve Data from Custom Endpoint i created a custom webhook endpoint to receive data from moosend. The idea is to get the email address of a new subscriber and create a new customized coupon in woocommerce. I created an automation on moosend which triggers the webhook successfully. The coupon is created but i cant figure out how to get the email address of the new subscriber from the data which is being sent. As far as I understand, the data is being sent via this schema:\nhttp://cdn.stat-track.com/send-to-webhook-context-schema.js\nThis is my approach so far (i tried different methods but none has worked )\n    add_action('rest_api_init', function () {\n  register_rest_route('webhook', 'newMoosendSubscriber', array(\n    'methods' => ['POST'],\n    'callback' => 'createDiscountCouponForNewSubscriberME',\n  ));\n});\n\n/**GENERATE COUPON */\n\nfunction createDiscountCouponForNewSubscriberME(WP_REST_Request $request)\n{\n  // create coupon\n  $email = $request[\"properties\"][\"Event\"][\"ContactContext\"][\"properties\"][\"EmailAddress\"];\n\n  $coupon_code = 'welcome-' . $email;\n  $amount = '10'; // Amount\n  $discount_type = 'percent'; // Type: fixed_cart, percent, fixed_product, percent_product\n\n  $coupon = array(\n    'post_title' => $coupon_code,\n    'post_content' => '',\n    'post_status' => 'publish',\n    'post_author' => 1,\n    'post_type' => 'shop_coupon'\n  );\n\n  $new_coupon_id = wp_insert_post($coupon);\n  //$exclude_products = array('61707', '61688', '61684', '61679', '61399');\n\n  // Add meta\n  update_post_meta($new_coupon_id, 'discount_type', $discount_type);\n  update_post_meta($new_coupon_id, 'coupon_amount', $amount);\n  update_post_meta($new_coupon_id, 'individual_use', 'yes');\n  update_post_meta($new_coupon_id, 'product_ids', '');\n  update_post_meta($new_coupon_id, 'exclude_product_ids', '61707, 61688, 61684, 61679, 61399');\n  update_post_meta($new_coupon_id, 'usage_limit', '1');\n  update_post_meta($new_coupon_id, 'expiry_date', '');\n  update_post_meta($new_coupon_id, 'apply_before_tax', 'yes');\n  update_post_meta($new_coupon_id, 'free_shipping', 'no');\n\n  return \"ok\";\n}\n\nEDIT: I found the solution myself: to create a php array out of the json body of the http request, the function get_json_params() is the answer. To read the emailaddress from this array i had to use this:\n  $requestArr = $request->get_json_params();\n  $emailAddress = $request[\"Event\"][\"ContactContext\"][\"EmailAddress\"];\n\n\nA: As you said \"Coupon is created in WooCommerce end\", we can confirm that custom endpoint \"webhook\" is working finely.\nThe issue is regrading to retrieve Email Address from the response. The moosend schema body is consist of JSON Object. So you have to decode the response to array first.\nTry to change your code as following code. It will convert JSON Objects into PHP Array and then retrieve Email Address from the Array\n$requestArr = json_decode($request, true);\n$email = $requestArr[\"properties\"][\"Event\"][\"ContactContext\"][\"properties\"][\"EmailAddress\"];\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406790", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Redirect Buddypress Directories To Login Page For Non Logged in Users How to Redirect Buddypress Directories To Login Page For Non Logged in Users?\nI'm also using the Yuzify plugin. It gives a code for it, but it's not working on multisite. Can anyone modify this code or provide me with a new code for it?\n/**\n* Redirect Buddypress Directories To Login Page For Non Logged in Users.\n*/\nfunction yzc_redirect_bp_directories_to_login_page() {\n\n    if ( ! is_user_logged_in() && ( bp_is_groups_directory() || bp_is_members_directory() ) ) {\n        \n        // Get Buddypress Pages;\n        $bp_pages = get_option( 'bp-pages' );\n        \n        // Get Redirection Url\n        $redirect_url = youzify_get_login_page_url();\n        \n        wp_redirect( $redirect_url );\n        exit();\n    }\n}\n\nadd_action( 'template_redirect', 'yzc_redirect_bp_directories_to_login_page' );\n\nThank you.\n\nA: Try this:\n/**\n* Redirect Buddypress Directories To Login Page For Non Logged in Users.\n*/\nfunction yzc_redirect_bp_directories_to_login_page() {\n   if (is_main_site()) {\n    if( !is_user_logged_in() && (is_page( 'members' )|| is_page( 'groups' )  || bp_is_group() || bp_is_user()  ) ) { \n         // Get Redirection Url\n         if ( function_exists( 'youzify_get_login_page_url' )) {\n            $redirect_url = youzify_get_login_page_url();\n        }\n        else {\n            $redirect_url=wp_login_url( get_permalink() );\n        }\n        \n        wp_redirect( $redirect_url );\n        exit(); \n    }\n  }\n} \n\nadd_action( 'template_redirect', 'yzc_redirect_bp_directories_to_login_page' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406791", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: The WordPress wp_posts data table We have a problem with our wp_posts table and are uncertain as to how to fix it.\nWe recently migrated a site of about 13K users and about 5K posts. The apache log is collecting errors that read like this:\n'PHP message: WordPress database error Can't find FULLTEXT index matching the column list for query SELECT DISTINCT  wp_posts.ID  FROM wp_posts....' and so on.\nAdvice I got here on StackExchange was to add the fulltext index. So I tried to do that, but mysql would not let me. I tried:\nALTER TABLE wp_posts\nADD FULLTEXT(post_title, post_content);\nThe error is:  Invalid default value for 'post_date'\nSo, I tried to change the default value for post_date using phpMyAdmin, but when I do, it gives the following error:\nInvalid default value for 'post_date_gmt'\nI note that the ALTER statement is also used by the OPTIMIZE mysql command and it produces the same errors.\nThe default values, by the way, for both post_date and post_date_gmt is 0000-00-00 00:00:00.\nI further tried setting the sqlvars to exclude date restrictions and that had no effect.\nI want to add that fulltext index. Any ideas on how I can do this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406794", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Search using ACF repeater I created a repeater containing Q&A and I would like to develop a search field that looks inside the ACF Q&A repeater for the related result.\nCould anyone help me where should I start?\nThank you so much\n\nA: You can filter ACF repeater field sub fields on the front end using some jQuery. See basic example below.\nSee live working demo here: https://jsfiddle.net/joshmoto/ns73z05b/\nSee comments in jQuery so you know what is happening.\n// faq filter input on keyup event\n$('#faq').on('keyup', 'INPUT[type=\"search\"]', function(event) {\n\n  // get our elements\n  let $faq = $(event.delegateTarget);\n  \n  // get the search filter value\n  let search = $(this).val().replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n  \n  // get the repeater list in faq object\n  let $repeater = $('.repeater', $faq);\n  \n  // items visible counter\n  let itemsVisible = 0;\n\n  // return false early if we dont have a list\n  if ($repeater.length < 1) return false;\n\n  // loop through each item in the repeater list\n  $(\"LI:not('.filter-no-results')\", $repeater).each(function(key, item) {\n\n    // store our q and a text\n    let text = $(this).text();\n\n    // check if the item is visible using regular expression match\n    let itemVisible = text.match(new RegExp(search, 'i'));\n\n    // remove these classes\n    $(item).removeClass('filter-visible filter-hidden');\n\n    // check if we have a match\n    $(item).addClass('filter-' + (itemVisible ? 'visible' : 'hidden'));\n\n    // if item is visible, increment our count\n    if (itemVisible) ++itemsVisible;\n\n  });\n\n  // check if we have no items visible then show hide no results message\n  if (itemsVisible === 0) {\n    $('LI.filter-no-results', $repeater).show();\n  } else {\n    $('LI.filter-no-results', $repeater).hide();\n  }\n\n});\n\n<?php \n\n// Check faq repeater field rows exists.\nif( have_rows('faq') ): ?>\n\n<div id=\"faq\">\n\n    <input type=\"search\" placeholder=\"Filter FAQ\" />\n    \n    <ul class=\"repeater\">\n    \n        <?php // Loop through questions and answers.\n        while( have_rows('faq') ) : the_row(); ?>\n\n            <li>\n                <div data-question><?=get_sub_field('question')?></div>\n                <div data-answer><?=get_sub_field('answer')?></div>\n            </li>\n\n        <?php // End loop.\n        endwhile; ?>\n    \n        <li class=\"filter-no-results\">\n            No results found in repeater fields.\n        </li>\n\n    </ul>\n\n</div>\n\n<?php // end.\nendif; ?>\n\n#faq {\n  padding: 1rem;\n}\n\nINPUT[type=\"search\"] {\n  margin-bottom: 1rem;\n}\n\n.repeater LI {\n  margin-bottom: 1rem;\n}\n\n[data-question]::before {\n  content: 'Q. ';\n  font-weight: bold;\n}\n\n[data-answer]::before {\n  content: 'A. ';\n  font-weight: bold;\n}\n\n.filter-visible {\n  display: block;\n}\n\n.filter-hidden {\n  display: none;\n}\n\n.filter-no-results {\n  display: none;\n}\n\n\nHere is another slightly more adapted version where it highlights your searched text by wrapping matched text with a <mark> tag.\nhttps://jsfiddle.net/joshmoto/hg5eqn8f/1/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406797", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there a better way to to make async API calls using the @wordpress/data module? Before posting here, I posted this to both reddit (it was removed as spam for some reason) and the gutenberg github discussions but didn't get any response. If there's a better place for me to ask, please let me know before downvoting.\nI am working on understanding the @wordpress/data module. One of the tasks I set myself was to create a demo app that would (essentially) have two parts:\n\n*\n\n*a button a user could click on\n\n*a list where articles would be displayed that are fetched from an external API\n\nThe list of articles would start out empty. Then when the user clicks the button, the list is populated. The project works, but I'm not sure I've written the functionality in the most efficient way and could use a double check. For reference, I used the official docs and Darren Ethier's series of articles on the subject.\nAfter registering a working block, I wrote this small react app (I've merged everything into one file here for simplicity). I have a working example on codesandbox.\nI have the following questions that hopefully you all can help me understand better\n\n*\n\n*I understand that in the ArticleList component, useSelect starts with articles as an empty array from state and then updates when state changes. However, why is it not necessary to pass state into the getArticles selector?\n\n*In the getArticles resolver, is it correct to use the hasFinishedResolution selector? This seemed to be the only way I could get the DEFAULT_STATE to update in the way I wanted.\n\n*I would've thought that I should use some kind of dispatch on the click handler for the button. However, I couldn't seem to create an action creator that made sense (to me) which would work. Is using a select method in a click handler like this valid or an anti-pattern?\n\nThanks for any help you can give me!\nimport { render } from '@wordpress/element'\n\nimport { createReduxStore, register, useSelect, dispatch, select, } from '@wordpress/data'\n\nconst DEFAULT_STATE = {\n  articles: [],\n}\n\nconst actions = {\n  fetchFromAPI(path) {\n    return {\n      type: 'FETCH_FROM_API',\n      path\n    }\n  },\n  setArticles(articles) {\n    return {\n      type: 'SET_ARTICLES',\n      payload: articles\n    }\n  }\n}\n\nconst store = createReduxStore('my/data-demo', {\n\n  // these are action creators. they return an action object with a type and arbitrary state data\n  // they help the app maintain an immutable state\n  // they are determined by the dispatch method calls\n  actions,\n\n  controls: {\n    FETCH_FROM_API: async (action) => {\n      return await fetch(action.path).then(res => res.json()).catch(err => console.log({ err }))\n    },\n  },\n\n  selectors: {\n    // the state is implied. it doesn't need to be passed when the selector is called\n    getArticles(state) {\n      return state.articles\n    }\n  },\n\n  resolvers: {\n    /**\n     * \n     * You can pass an arbitrary number of arguments here.\n     * The first will always be the state. After that, you can use anything\n     * The other arguments _do not_ need to be represented in the selector function. However, that selector must return state\n     * \n     * See here for info on hasFinishedResolution - https://unfoldingneurons.com/2020/wordpress-data-store-properties-resolvers\n     * \n     * @param {*} state \n     * @param {*} test \n     * @returns \n     */\n    *getArticles(state, test) {\n      const path = 'https://today.uconn.edu/wp-rest/wp/v2/posts'\n      const articles = yield actions.fetchFromAPI(path)\n\n      // wait for the resolver to finish before yielding\n      const hasFinishedResolving = select('my/data-demo').hasFinishedResolution('getArticles')\n\n      if (hasFinishedResolving) {\n        yield actions.setArticles(articles)\n      }\n\n      return\n    }\n  },\n\n  // the reducer function returns new immutable copies of the state\n  // there should be no mutations\n  // once the dispatch method is called, the reducer determines how to create a new state object\n  reducer: (state = DEFAULT_STATE, action) => {\n    switch (action.type) {\n      case 'SET_ARTICLES': {\n        return {\n          ...state,\n          articles: action.payload\n        }\n      }\n      case 'FETCH_FROM_API':\n        return {\n          ...state,\n          path: action.payload,\n        }\n      // if there is no matching action return the state\n      default:\n        return state\n    }\n  }\n})\n\nregister(store)\n\nconst ArticleList = ({ state, ...props }) => {\n\n  const { articles } = state\n\n  // selected articles will update when the state changes from the button click\n  const selectedArticles = useSelect((select) => {\n    // don't pass the state here...\n    return select('my/data-demo').getArticles()\n  }, [ articles ])\n\n  return (\n    <>\n      <h1>Latest Articles</h1>\n      {\n        selectedArticles && (\n          <ul>\n            {\n              selectedArticles.map((article, index) => {\n                return <li key={index}>{article.title.rendered}</li>\n              })\n            }\n          </ul>\n        )\n      }\n    </>\n  )\n}\n\nconst App = () => {\n  return (\n    <>\n      <div>\n          <button\n            onClick={() => select('my/data-demo').getArticles(DEFAULT_STATE) }\n          >GET Articles</button>\n          <ArticleList state={DEFAULT_STATE} />\n      </div>\n    </>\n  )\n}\n\nrender(<App />, document.querySelector('#app'))\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406798", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: wp_get_post_categories not work currently on loop.php I'd like to design the category page for them. on this page, we have to show the last category of each post beside each post title.\nSo I want to display the last category from each post, on the categories pages.\nthe important point for me is that I want to remove a specific category with all children from the result.\nI put the below code on loop.php\n<?php echo get_last_category()?>\n\nand the function is:\nfunction get_last_category($class = '')\n{\n\n  $current_post_id = get_the_ID();\n  $args = array(\n        'orderby' => 'term_order',\n        'exclude_tree' => [2621],\n        'hide_empty' => 0,\n        'fields' => 'all'\n    );\n\n    $terms = wp_get_post_categories($current_post_id,$args);\n\nif ($terms==null){echo 1;} // for test\n    $cat = array();\n    foreach ($terms as $term) {\n        $cat[] = '<a class=\"' . $class . '\" href=\"' . \n esc_attr(esc_url(get_category_link($term->term_id))) . '\">' . $term->name .\n            '</a>';\n    }\n\n    return end($cat);\n\n}\n\nthe problem is if I have 50 posts on one of the categories page. it just shows me the category's name for the first post.\nfor other posts, it returns null!\n**OUTPUT**:\n\nPost tile 1[category name]\nPost title 2[1]\nPost title 3[1]\nPost title 4[1]\nPost title 5[1]\nPost title 6[1]\n.\n.\n.\n\nI realy dont know why wp_get_post_categories() return null after first time!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406799", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to change request URL? My website has a plugin that makes requests to url mydomain.com/wp-json/...\nIf url contains ?lang=en request goes to mydomain.com/wp-json/?lang=en/... and drops 404 error\n\n\"No route was found matching the URL and request method\".\n\nHow can I change url of ongoing request through functions.php? Even if page's URL contains ?lang=en plugins should make requests to urls without ?lang=en\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406800", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Snippet to Format Elementor Text Box Throws Error I am trying to add a snippet to a WordPress site running Elementor with the Code Snippets plugin.  The goal is to add an underline to any hyperlinked text in an Elementor Text Editor widget (which this widget does not do natively for some inexplicable reason).  But when I try to save my snippet, I get the following error:\n\nDon't Panic\nThe code snippet you are trying to save produced a fatal\nerror on line 0:\nException thrown without a stack frame The previous version of the\nsnippet is unchanged, and the rest of this site should be functioning\nnormally as before.\nPlease use the back button in your browser to return to the previous\npage and try to fix the code error. If you prefer, you can close this\npage and discard the changes you just made. No changes will be made to\nthis site.\n\nWe have lots of snippets running on this site, so I this doesn't seem like a plugin-level issue.  I am sure I have a mistake in my code snippet.  See below for the complete snippet (this is NOT an excerpt).  Any suggestions?  Thanks.\n.elementor-text-editor a {\ntext-decoration: underline;\ntext-decoration-style: solid;\n}\n.elementor-text-editor a:hover {\ntext-decoration: underline;\ntext-decoration-style: solid;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406801", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: can't unzip file i'm created import and export function,\nThe Export function download zip file to my computer\nThe Import function when trys to extract zip file it's fails and can't open zip file.\nwhen i create the zip file withiout php and upload it to import function, it works, but the file of export function is not.\nhere is my code:\nExport\n$zip = new ZipArchive;\n          $zip_name = 'test.zip';\n          if ($zip->open($zip_name, ZipArchive::CREATE) === TRUE)\n          {\n             \n              $zip->addFile('1.csv', 'folder/1.csv');\n        \n\n              $zip->addFromString('folder/1.csv', 'first string to write');\n\n              // All files are added, so close the zip file.\n              $zip->close();\n\n              header('Content-type: application/zip');\n              header('Content-disposition: filename=\"' . $zip_name . '\"');\n              header(\"Content-length: \" . filesize($zip_name));\n              readfile($zip_name);\n              exit();\n          }\n    \n\nImport :\n  function rmdir_recursive($dir) {\n    foreach(scandir($dir) as $file) {\n       if ('.' === $file || '..' === $file) continue;\n       if (is_dir(\"$dir/$file\")) rmdir_recursive(\"$dir/$file\");\n       else unlink(\"$dir/$file\");\n   }\n\n   rmdir($dir);\n}\n\n  if(isset($_POST))  \n  {  \n\n    if($_FILES[\"file\"][\"name\"]) {\n      $filename = $_FILES[\"file\"][\"name\"];\n      $source = $_FILES[\"file\"][\"tmp_name\"];\n      $type = $_FILES[\"file\"][\"type\"];\n      echo $type;\n      $name = explode(\".\", $filename);\n      $accepted_types = array('application/zip', 'application/x-zip-compressed', \n      'multipart/x-zip', 'application/x-compressed');\n      foreach($accepted_types as $mime_type) {\n          if($mime_type == $type) {\n              $okay = true;\n              break;\n          } \n      }\n  \n      $continue = strtolower($name[1]) == 'zip' ? true : false;\n      if(!$continue) {\n          echo \"The file you are trying to upload is not a .zip file. Please try again.\";\n      }\n  \n    /* PHP current path */\n    $path = dirname(__FILE__).'/packages/';  // absolute path to the directory where zipper.php is in\n    $filenoext = basename ($filename, '.zip');  // absolute path to the directory where zipper.php is in (lowercase)\n    $filenoext = basename ($filenoext, '.ZIP');  // absolute path to the directory where zipper.php is in (when uppercase)\n    \n    $targetdir = $path . $filenoext; // target directory\n    $targetzip = $path . $filename; // target zip file\n\n    /* create directory if not exists', otherwise overwrite */\n    /* target directory is same as filename without extension */\n  \n    if (is_dir($targetdir))  rmdir_recursive ( $targetdir);\n  \n  \n    mkdir($targetdir, 0777);\n    /* here it is really happening */\n      \n      if(move_uploaded_file($source, $targetzip)) {\n          $zip = new ZipArchive;          // create object\n          $res = $zip->open($targetzip);   // open archive\n          if($res===TRUE) {\n            $zip->extractTo($targetdir);        // extract contents to destination directory\n            $zip->close();  \n            echo 'extraced successed';      \n          }else{\n            echo 'extraced failed';\n          }\n          echo \"Your .zip file was uploaded and unpacked.\";\n      } else {    \n          echo \"There was a problem with the upload. Please try again.\";\n      }\n  }\n\n}  \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406802", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Whitelist Author of Private Post Does anyone know of a way to whitelist the author of a private post so they never have to enter their password to access their own post on the frontend? If they are logged into the site, there must be a way to remove the requirement to enter the password.\n\nA: You can use the post_password_required filter.\nfunction wpse406803_whitelist_author( $required, $post ) {\n    \n    //Check if current user is the post author\n    if ( $post->post_author == get_current_user_id() ) {\n        return false;\n    }\n    \n}\nadd_filter( 'post_password_required', 'wpse406803_whitelist_author', 10, 2 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406803", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: How to make a Product page without ordering and database I am learning Wordpress currently so far I know how to design the webpage, but what I want to do next is to make a product page without ordering. What I want is the following:\n\n*\n\n*List all my products and if one clicks on a product it will show the detail page of that product\n\n*The products can be added to a list and then there will be a contact form which will take the list and send it to me in a pdf or excel (but at first enough if only names are sent via email) so I can answer it with the asked question.\n\nI sadly could not find any starting point I do not even know if there is such a plugin, if not can I make one myself? I know javascript so I think I could Programm it myself but would prefer if there is some plugin I can use due to time issues.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406805", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: I found this code to be very useful, how can I change it to a text that display \"Product versions and period of last update\" rather than a button? /**\n* Show a Live Demo button on single product page\n*/\nfunction isa_before_add_to_cart_form() {\n    global $product;\n    $url = get_post_meta( $product->get_id(), '_isa_wc_product_demo_url', true );\n    if ( $url ) {\n        echo '<p><a href=\"' . esc_url( $url ) . '\" id=\"livedemo\" class=\"button\"  target=\"_blank\" rel=\"noopener\">' .\n        __( 'View Demo', 'textdomain') .\n        '</a><p>';\n    }\n}\nadd_action('woocommerce_before_add_to_cart_button','isa_before_add_to_cart_form',5);\n \n/**\n * Display the Demo URL field in the Product Data metabox\n */\nfunction isa_wc_product_add_demo_url_field() {\n    echo '<div class=\"options_group\">';\n    woocommerce_wp_text_input( \n        array( \n            'id'          => '_isa_wc_product_demo_url',\n            'label'       => __( 'Demo URL', 'textdomain' ), \n            'placeholder' => '',\n            'desc_tip'    => 'true',\n                'description' => __( 'Set a URL that will be displayed on the product page to link to a demo of this product. Full URL starting with \"https://\"', 'textdomain' )\n        )\n    );\n    echo '</div>';\n}\nadd_action( 'woocommerce_product_options_general_product_data', 'isa_wc_product_add_demo_url_field' );\n \n/**\n * Save the Demo URL field value when the produc is saved\n */\nfunction isa_wc_product_save_demo_url_value( $post_id ) {\n    $val = trim( get_post_meta( $post_id, '_isa_wc_product_demo_url', true ) );\n    $new = sanitize_text_field( $_POST['_isa_wc_product_demo_url'] );\n    if ( $val != $new ) {\n        update_post_meta( $post_id, '_isa_wc_product_demo_url', $new );\n    }\n}\nadd_action( 'woocommerce_process_product_meta', 'isa_wc_product_save_demo_url_value' ); \n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406806", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: reCaptcha doesnt appear in comment (manual or plugin) I tried the following:\n\n*\n\n*https://www.quora.com/How-can-I-insert-Captcha-code-in-WordPress-theme-without-using-any-plugin\n\n*https://codeforgeek.com/add-google-recaptcha-wordpress/\n\n*https://pluginsforwp.com/blog/add-recaptcha-to-wordpress-comments/\nBut I can't get comments with recaptcha. I also tried also \"reCaptcha by BestWebSoft\" and nothing appears.\nI am using News Talk Theme (child theme - active) https://wordpress.org/themes/news-talk/ that is from NewsUp theme (parent theme).\nI tried \"reCaptcha by BestWebSoft\" with other themes (https://themesinfo.com/rehub-vendor-wordpress-magazine-theme-bmke/2/) and it works. But some also don't work for other theme https://themegrill.com/themes/colormag/. So maybe it is a theme issue?\nSo far, I've only tried with adding the code in the parent theme because the child does not have a single.php file. Is this the right way? Or how should I do it?\nHere is a screenshot of my comment, there is no reCaptcha\n\n\nA: As I see you are using reCaptcha v3 as the examples you try and it will not appear until the user score is under the minimum you added into the configuration but it is still working and checking the user score before he submits your form.\nanyway if you configured the plugin correctly you may see the reCaptcha sticky button at the bottom right corner of your website\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406808", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: TranslatePress | secondary language category/sub-category not working correctly ```/%category%/%postname%/``` I'm using TranslatePress and using slug translate. now I'm having an issue with the single post URL, not redirecting correctly.\nmy actual URL looks domain.com/fr/category/subcategory/postname \npermalink format /%category%/%postname%/ working only default language. \nI have tried with /%category%/%category%/%postname%/ then all worked but URL category and subcategory were duplicated. domain.com/fr/category/subcategory/category/subcategory/postname\nThen I tried /%category%/./%postname%/ this format. It works to show the category page in translated page. but not allowed to open a single post :(\ndoes anyone have a solution for this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406809", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to redirect non logged in mobile users to page on same site? I have seen many like this question (like How to redirect non-logged in users to a specific page?) but none have worked.\nthis is basically what I've come up with but it doesn't work all the time and has a refresh loop afterwards.\nif ((screen.width <= 800) && (document.location=\"https://example.com/\")) {\n    window.location.replace = \"https:example.com/m-home-page/\";\n    window.location.reload();\n}\n\nThis is a php I was testing as well which redirected the blog page to the home page for some reason. (from https://stackoverflow.com/questions/39438523/how-to-redirect-logged-out-users-to-different-page-in-wordpress)\n<?php\nif(is_user_logged_in())\n{\nwp_redirect( home_url('/m-home-pages') ); // This will redirect to the home page which we have created.\nexit;\n}\nelse\n{\nwp_redirect( home_url() );// this will redirect to the site main home page.\nexit; \n}\n?>\n\n\nA: Going by the js you provided you can just do this\nif ((screen.width <= 800) && (document.location=\"https://example.com/\")) {\n    location.href = \"https:example.com/m-home-page/\";\n}\n\nYou could also do this more dynamically using async request but if this solution is enough for you atm then go with it first.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406810", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress rewrite rule doesn't work unless post category is explicitly called in regex I'm struggling to understand why WordPress is doing what it's doing in this situation, and I'm hoping someone can explain to me why the rewrite rule doesn't work unless I explicitly call a category name in the regex.\nWorking:\nadd_rewrite_rule( '^specific_cat_name/(.*)/damage-report/([^/]+)/?$','index.php?damage-reports=$matches[2]','top' );\n\nNOT working:\nadd_rewrite_rule( '^(.*)/(.*)/damage-report/([^/]+)/?$','index.php?damage-reports=$matches[2]','top' );\n\nI need this rewrite rule to work in multiple categories, however, when I use the standard, match anything regex string (.*) the main query on the child post page changes from the post name of the intended post to the parent post name, while still querying the child post's custom post type, thus resulting in a 404.\nI've also tried\nadd_rewrite_rule( '^(cat-1-name)|(cat-2-name)/(.*)/damage-report/([^/]+)/?$','index.php?damage-reports=$matches[2]','top' );\n\nwhich changes the main query to look for pages and landing pages.\nURL parsing code, incorporates ACF for parent post information, modified from another stack exchange question:\nadd_filter( 'post_type_link', function( $link, $post ) {\n    if ( is_object( $post ) && 'multiple'||'custom'||'post'||'types'||'to'||'check' == get_post_type( $post ) ) {\n        if( get_field('serial_number',$post) ) {\n            $parent = get_post( get_field('serial_number',$post));\n            $parent_cat = wp_get_post_categories($parent->ID)[0];\n            if( !empty($parent->post_name) ) {\n                $link = str_replace( '%serial-number%', $parent->post_name, $link );\n                $link = str_replace( '%wildcard%', strtolower(get_cat_name($parent_cat)),$link);\n                return $link;\n            }\n        }\n    }\n    return $link;\n}, 10, 2 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406811", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is there any way to get all meta and standard columns for any WordPress object after searching based on meta key and value I have a scenario where I have a meta key and value and a WordPress object name, I want to search based on the meta key and value and retrieve all details stored in db, for example if this is for a user I want the data from wp_users and wp_usermeta, same goes for other objects that have a object and an objectmeta table.\nFor search I have been using the query classes WP_Query, WP_User_Query, and other related classes. I get the standard attributes from there, but to get the meta attributes I still need to call another function.\nI am wondering if there exists a method where this can be done, as a last resort I can always go and write inner join queries on my own.\nAny leads on this are appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406812", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Font styling in embedded Twitter feed Apologies if I have missed the answer to what would seem an embarrassingly simple question!\nI have just added a Twitter timeline to the footer of my Wordpress site, https://www.logicmatters.net, using the Twitter-provided html code\n<a class=\"twitter-timeline\" data-width=\"auto\" data-height=\"300\" data-chrome=\"nofooter noheader noborders transparent\" href=\"https://twitter.com/PeterSmith?ref_src=XXXXXX\">Tweets by PeterSmith</a> <script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\" ></script>\nAs you will see the tweets are displayed with black font colour. Is it possible either to add to this html, or add a CSS snippet using the governing Astra theme's CSS snippets panel, which will control at least the tweet's font colour (both for the tweet text and the tweet header)?\nIdeally I'd like to control the font selection too.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406814", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: get value from 'terms' table so I feel like I am missing something very obvious, but I need to get a value from the database table 'terms', and it seems get_terms fetches from taxonomy table. I've tried get_term_by as well but to no avail.\nI could simply build a regular request and get the data needed, no worries. But I feel like I must be missing something obvious, as it has to be a regular occurance among wordpress users to fetch data from that table.\n/Regards\nSonny\n\nA: get_terms does indeed fetch from the terms table, but it does also use a join on the taxonomy table, since you need to specify which taxonomies you want terms for in your get_terms query.\nIf you want to get all terms, you could use something like:\n$all_terms = get_terms([\n    'taxonomy' => get_taxonomies(),\n    'hide_empty' => false,\n]);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406816", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to data add to table when update post wordpress? when we clicked! Can you help me? I can get data in post_meta. But, When I enter to edit post. I want this to happen when I click.\nWhat should I do?\nadd_action( 'updated_post_meta', 'fn_data_product_save' );\nfunction fn_data_product_save(){\n    $get_id = get_the_ID();\n    $product = get_post_meta( $get_id, '_stock_status', true );\n    if ($product) { \n      update_post_meta($get_id, '_mail_send_instock', $get_id);\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406818", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to use nimble-API and Display data? I want to get the contact resources displayed by doing Nimble API, but I do not know how these resources are displayed.\nHow can I change the JSON code in PHP?\n[this is the link I check but can not understand how to use it and where?]\nhttps://nimble.readthedocs.io/en/latest/responses/#contact-resources\nHow can I check the code in postman?\nCan anyone suggest me?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406819", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Make unique url to unlock a post Hi I try to make unique url\nThis link will unlock a prenium post if a prenium account send to him this link .\nI dont find goo documentation to start so if you have any advice or doc (Sorry for my english i'm not a native english speaker ) Thx for the reading\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406820", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Change my URL from https://www.domain.com to https://domain.com I have migrated my site to Godaddy and Installed WordPress, but it get installed on https://www.domain.com on previous hosting it was simply on https://doamin.com.\nNow I am having problem as some pages & resources gives 404 not found error unless I write \"www\" at the start of the URL.\nI have tried to install a clone of my WordPress on https://domain.com but when I visit it still give 404 error unless I write www at start.\nI think I haven't setup the DNS record accurately.\nPlease can someone help me change the URL.\nHere is the current website link:\nhttps://www.diamondpaints.com/\nI want to move it to:\nhttps://diamondpaints.com/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406821", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: A function to add arguments to a taxonomy I use a plugin that adds the taxonomy \"Vendors\" - but not with arguments I need to be able to use a layout designer (Avada-> Layouts) and assign that layout to all \"vendors\"\nI have figured out that if I add the arguments\n        'show_in_rest' => true,\n        'query_var'    => true,\n\nto the plugin taxonomy registration it does the trick. But I need some help doing this with a function that doesn't get overwritten at an update of the plugin. (for functions.php)\nOriginal code for registration of taxonomy is:\n    public function register_post_taxonomy() {\n\n        $permalinks = get_option('dc_vendors_permalinks');\n\n        $taxonomyname = empty($permalinks['vendor_shop_base']) ? __('Vendor', 'dc-woocommerce-multi-vendor') : $permalinks['vendor_shop_base'];\n\n        $labels = array(\n\n            'name' => apply_filters('wcmp_vendor_taxonomy_name', $taxonomyname),\n\n            'singular_name' => __('Vendor', 'dc-woocommerce-multi-vendor'),\n\n            'menu_name' => __('Vendors', 'dc-woocommerce-multi-vendor'),\n\n            'search_items' => __('Search Vendors', 'dc-woocommerce-multi-vendor'),\n\n            'all_items' => __('All Vendors', 'dc-woocommerce-multi-vendor'),\n\n            'parent_item' => __('Parent Vendor', 'dc-woocommerce-multi-vendor'),\n\n            'parent_item_colon' => __('Parent Vendor:', 'dc-woocommerce-multi-vendor'),\n\n            'view_item' => __('View Vendor', 'dc-woocommerce-multi-vendor'),\n\n            'edit_item' => __('Edit Vendor', 'dc-woocommerce-multi-vendor'),\n\n            'update_item' => __('Update Vendor', 'dc-woocommerce-multi-vendor'),\n\n            'add_new_item' => __('Add New Vendor', 'dc-woocommerce-multi-vendor'),\n\n            'new_item_name' => __('New Vendor Name', 'dc-woocommerce-multi-vendor'),\n\n            'popular_items' => __('Popular Vendors', 'dc-woocommerce-multi-vendor'),\n\n            'separate_items_with_commas' => __('Separate vendors with commas', 'dc-woocommerce-multi-vendor'),\n\n            'add_or_remove_items' => __('Add or remove vendors', 'dc-woocommerce-multi-vendor'),\n\n            'choose_from_most_used' => __('Choose from most used vendors', 'dc-woocommerce-multi-vendor'),\n\n            'not_found' => __('No vendors found', 'dc-woocommerce-multi-vendor'),\n\n        );\n\n\n\n        $vendor_slug = apply_filters('wcmp_vendor_slug', $this->taxonomy_slug);\n\n\n\n        $args = array(\n\n            'public' => true,\n\n            'hierarchical' => false,\n\n            'rewrite' => array('slug' => $vendor_slug),\n\n            'show_admin_column' => true,\n\n            'show_ui' => true,\n\n            'labels' => $labels\n\n        );\n\n        register_taxonomy($this->taxonomy_name, 'product', $args);\n\n    }\n\n\nA: Use the filter register_taxonomy_args to manipulate the arguments used for registering the taxonomy just before it is registered:\nfunction wpse_406824_vendor_taxonomy_args( $args, $name ) {\n    if ( $name === 'dc_vendor_shop' ) {\n        $args['show_in_rest'] = true;\n        $args['query_var']    = true;\n        $args['show_ui']      = true;\n    }\n\n    return $args;\n}\n\nadd_filter( 'register_taxonomy_args', 'wpse_406824_vendor_taxonomy_args', 10, 2 );\n\nYou'll need to place this code in a MU plugin or in a custom plugin that's loaded before the marketplace one (I just checked the source of it and they incorrectly register the taxonomy when the plugin loads, instead of on the init hook -  the code above needs to already be loaded in order for it take effect).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406824", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to change wordpress RSS to be in a specific format? I am working with an old system that takes in very specific format for RSS. The one thing that doesn't work is the featured image. I need the image to be in a\n<image>\n<url></url>\n</image>\n\nform but on Wordpress the image always shows in .\nAny help here please?\nThanks!\n\nA: You can use the action rss2_item (and rss_item for RSS 0.92) to output the required tags:\nfunction wpse_406826_rss_featured_image() {\n    $src = get_the_post_thumbnail_url( null, 'medium' /* or whatever size you need */ );\n\n    if ( $src ) {\n        echo \"<image><url>$src</url></image>\";\n    }\n}\n\nadd_action( 'rss2_item', 'wpse_406826_rss_featured_image' );\nadd_action( 'rss_item',  'wpse_406826_rss_featured_image' );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406826", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hook before user is created and make some custom validation I try to hook in user creation process in admin dashboard /wp/wp-admin/user-new.php to make some custom validation on data with the following hook, but the hook is not executed on form submit. What goes wrong in this case?\nWhat I want, I have a custom ACF relation field which should be mandatory only if the selected role is editor. So I want to parse the request and check against the rules. If it fails than do not create the user return the custom error message.\nadd_action( 'register_post', function($user_login, $user_email, $errors) {\n    var_dump('test');\n    die;\n\n    $userIsValid = ValidateUser::make($errors);\n\n    if(!$userIsValid) {\n        $errors->add( 'bad_email_domain', '<strong>ERROR</strong>: errors' );\n    }\n});\n\n\nA: You need to add , 10, 3 after your closure to set the hook priority and (more importantly) the number of accepted arguments - otherwise $user_email and $errors will not be passed.\nadd_action( 'register_post', function ( $user_login, $user_email, $errors ) {\n    $userIsValid = ValidateUser::make($errors);\n\n    if(!$userIsValid) {\n        $errors->add( 'bad_email_domain', '<strong>ERROR</strong>: errors' );\n    }\n}, 10, 3 );\n\nUpdate: The register_post hook only fires inside register_new_user(), which is only used for user registration via the WordPress login page.\nTo handle errors within the admin (i.e. Users > Add New) use the user_profile_update_errors hook instead.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406830", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Multisite cookies are being shared across domains unwanted Setup\nI have a multisite that consists of 4 domains .com .de .co.uk and .fr each has its own sub directory and none of them are linked to each other in any way apart from theme code.\nProblem\neach has its own GTM wrapper and all third-party tracking scripts are being added to their respective site correctly.\nWhen checking each site's cookies in inspector/application/cookies you get the correct cookies:\n\n*\n\n*Browse .de cookies are fine\n\n*Browse .co.uk cookies are fine\n\n*Browse .fr cookies are fine\n\nif I now browse .com and then go back to .de .co.uk or .fr\ni now get the respective sites cookies say .co.uk and .coms cookies in inspector/application/cookies\nThis only happens when going from the .com to any of the other domains .de .co.uk or .fr  don't pass their cookies to the .com\nHas anyone seen this a situation where one site in a multi-site is passing tracking cookies to another\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406831", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: User filter posts by year I am looking to add a filter to a page so users can select the year and view only posts from that year. Something similar to the filter on this page: https://www.economist.com/weeklyedition/archive\nA solution that works with elementor would be ideal.\n\nA: Here is a solution I came up with. There are several ways to make this work. Please feel free to reply with any suggestions.\n\n*\n\n*Create a shortcode to generate the select drop down menu in your theme/functions.php file. The drop down menu form element has javascript to redirect the user to /?Year=value for whatever year was selected.\n\n<?php\n\n/*\n *\n * Create a Year select drop down menu\n * Usage: [year_select min_year=\"2000\" max_year=\"2022\"]\n *\n */\nfunction year_select_shortcode( $atts = array() ) {\n        // set up default parameters\n        extract(shortcode_atts(array(\n                'min_year' => '2000',\n                'max_year' => date(\"Y\"),\n                'base_dir' => '/custom_archive/'\n        ), $atts));\n\n        // Convert arguments to integers, make sure they fit in acceptable ranges\n        $min_year = (int)$min_year;\n        $max_year = (int)$max_year;\n        $select_year = (int)$_GET['Year'];\n\n        if ( $min_year < 1980 ) $min_year = 1980;\n        if ( $max_year > date(\"Y\") ) $max_year = date(\"Y\");\n        if ( $select_year < $min_year or $select_year > $max_year) $select_year = 0;\n\n        // select drop down has some javascript to re-direct the user\n        $output .= '<select name=\"Year\" id=\"Year\" onchange=\"if (this.value) window.location.href=this.value\">\\n';\n        $output .= '<option value=\"' . $base_dir . '\"';\n        if ( $select_year == 0 ) $output .= ' selected=\"selected\"';\n        $output .= '>All</option>\\n';\n\n        // Loop through year range and add a select option\n        for ( $i = $max_year; $i >= $min_year; $i-- ) {\n                $output .= '<option value=\"' . $base_dir . '?Year=' . $i . '\"';\n                if ( $i == $select_year ) $output .= ' selected=\"selected\"';\n                $output .= '>' . $i . '</option>\\n';\n        }\n        $output .= '</select>';\n        return $output;\n}\nadd_shortcode( 'year_select', 'year_select_shortcode');\n\n?>\n\n\n\n*Add to functions.php a custom query to work with the data from the select short code defined above. The query will look for the $_GET['Year'] variable, and filter out the posts that pertain to that year. For my purposes, the year variable is compared against a custom date field so need to build a meta query.\n\n<?php\n\nadd_action( 'elementor/query/custom_archive_query', function( $query ) {\n        // Make sure input year is in the right range\n        $select_year = (int)$_GET['Year'];\n        if ( $select_year < 1980 ) $select_year = 0;\n        if ( $select_year > date(\"Y\") ) $select_year = date(\"Y\");\n\n        // Get current meta Query\n        $meta_query = $query->get( 'meta_query' );\n        // If there is no meta query when this filter runs, it should be initialized as an empty array.\n        if ( ! $meta_query ) {\n                $meta_query = [];\n        }\n\n        // Restrict to cartoon post types\n        $query->set( 'post_type', 'custom_archive' );\n\n        // Append our meta query\n        if($select_year > 0){\n                $meta_query[] = [\n                        'key' => 'custom_archive',\n                        'value' => $select_year,\n                        'compare' => 'like',\n                ];\n                $query->set( 'meta_query', $meta_query);\n        }\n        wp_reset_postdata();\n});\n?>\n\n\n\n*Enter custom_archive_query into the elementor posts Query ID field and voila: the user selects a date from the drop down menu, gets re-directed to a url with a $_GET['Year'] parameter set which gets built into the posts query.\n\nHope this helps someone else.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406833", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can export gallery but can't import it Wp all import I have a store with WordPress and alidropship plugin no woocommerce , I tried to update some galley images with CSV file but I can't do it because alidropship gallery images are different than woocommerce gallery\nthe strange thing is that I can export the gallery with wp all export but when trying to import the same file I get only featured image changed no galley images\nSO the issue is how can I update the gallery by CSV file in a store with alidropship and WordPress no woocommerce ?\nAnd how can I export gallery with wp all export but can't import it with wp all import in WordPress alidropship store?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406834", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Enqueue Script in WordPress How to enqueue script in WordPress ?\nWhen I am using below code script enqueue properly.\nwp_enqueue_script( 'adc-handlebars', get_template_directory_uri() . '/vendors/handlebars/handlebars.min.js', array(), '1.2.1', false );\n\nBut when I am using below code script is not enqueue.\nwp_enqueue_script('adc-order-information', get_template_directory_uri().'/js/order_information.js', array(), '2.10.0', true);\n\n\nA: Your first snippet sets $in_footer to false so the the script will be added to the <head /> of your document.\nThe second snippet sets $in_footer to true and so it will be added at the bottom of your document (usually just before </body>, but it depends on where wp_footer() is called in your theme).\nRead more about wp_enqueue_script()\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406835", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Count the number of custom posts per user I am using JetEngine, and the users can create CCTs (custom content types), that have a single post CPT\nI know already how to count the number of posts by the user, I am using shortcode for that\nfunction total_user_post_shortcode() {\n    $current_user = wp_get_current_user();\n    if ( 0 != $current_user->ID ) {\n        echo $user_post_count = count_user_posts( $current_user->ID );\n    }\n}\n\nadd_shortcode('total-user-posts', 'total_user_post_shortcode');\n\nBut I want to specify just a certain type of custom post, not all of them.\nHow should I change the code?\nThanks\n\nA: Use the second parameter $post_type:\ncount_user_posts( $current_user->ID, 'my_post_type' );\n\nMore information on count_user_posts()\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406836", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Having Issue on Redirecting With Session in WordPress I am trying to create a simple login system in WordPress using core PHP but I am getting this error message\n\nWarning: Cannot modify header information - headers already sent by\n(output started at\n/www/www/www/wp-content/themes/mytheme/header.php:20)\nin\n/www/www/www/wp-content/themes/mytheme/page-solutions.php\non line 9\n\nIn the header.php template I have\n<?php\nsession_start();\n/**\n * The header.\n *\n */\n?>\n<!doctype html>\n<html lang=\"en\">\n<head>\n...\n\nand in the page-solutions.php page\n<?php\n/**\n * Template Name: Solutions\n *\n */\nget_header();\n\nif(!isset($_SESSION[\"loggedin\"]) || $_SESSION[\"loggedin\"] !== true){\nheader(\"location: home\");\nexit;\n}\n\nAs you can see I am trying to redirect not logged users to front-page.php which I called it Home but I am getting error on header(\"location: home\"); Can you please let me know how to fix this?\n\nA: header can't be used once the headers have been sent, the moment you output anything such as a tag, or even a blank space, PHP will send out the headers telling the browser to expect a HTML document.\nIn order to send a HTTP header to redirect, you need to do it before this happens. This means you cannot do this after get_header() is called, you have to do it before that call, and before any other HTML output. Generally, this is not something that works well inside templates.\nOther notes:\n\n*\n\n*you should be using the WordPress function to do this wp_safe_redirect\n\n*if you're redirecting to the homepage you shouldn't be using home, pass /home to go to example.com/home or use home_url() instead to retrieve the URL of the homepage\n\n*PHP sessions will not work on many WordPress hosts, and there are major security issues that require special handling. They're also incompatible with many caching systems. You also can't use it to bypass cookie legislation as PHP sessions use a cookie to identify which session belongs to the visitor. So use cookie based logins instead.\n\n*You should use the built in user management instead of reinventing it\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406840", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Problem with data collection in tables I have the following to do. I am migrating web content from a joomla to a WordPress, and the problem that I present is that the joomla has a collection of data in tables that is not compatible with WordPress, when I use the wordpress hook\nwp_insert_post\nIt does not save the field with the data that I need to convert to another collection to be able to save them with their respective accents.\nI hope you understand me.\nI have the following\n$id = wp_insert_post(array(\n\u2018post_title\u2019 => utf8_encode($hello[\u2018title\u2019]),\n\u2018post_content\u2019 => utf8_encode($metadesc.\u2019 \u2018.$hello[\u2018fulltext\u2019]),\n\u2018post_date\u2019 => $hello[\u2018created\u2019],\n'post_author' => '1',\n'post_type'=>'post',\n'post_status' => 'publish',\n'comment_status' => 'open',\n\u2018post_name\u2019 => utf8_decode($hello[\u2018alias\u2019]),\n));\n\npost_content is where I need to save the information with my respective tildes.\nBut it doesn't save them, the result is blank, the operation doesn't return anything, and the apache or php log doesn't tell me anything.\nthe data comes with this collection utf8_general_ci and in wordpress it is in utf8mb4_unicode_520_ci\nTry to do it with Laravel by hand, but it's the same.\nI can show the information on the web with their respective accents, but I need to save it in the database with accents and others.\nI hope you can give me an idea of \u200b\u200bwhat to investigate about it\nCheers\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406841", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: \"Can't update in WordPress\" WordPress changes can't showing.\nWordPress version: 5.5.3\nNode version: 14.19.3\nPHP version: PHP 7.4.29\nnpm version: 6.14.17\nThere is a website under development in WordPress.\nI edited the page in page editing window and click  the \"Update\" button but I can't update it.\nI tried this:\n\n*\n\n*deactivated all plugins\n\n*tried to change the theme\n\n*cleared browser cache\n\nbut still can't do it.\nUpdate button is active state always.\nAfter editing the page, click the \"Update\" button and you will see a notice saying \"Please add at least 1 contributor.\" Click \"OK\".\nAfter that, the \"Update\" button is still active.\nHowever, the contents of sql in the database are not changed, and even if you click \"Preview Changes\", you cannot see the changed contents.\nIf you exit the page editing window and go back to the editing window, the contents of the page are in the state before editing, and a comment saying \"The backup copy of this article is different from the version below in the browser\" is displayed.\nNow when I click the \"Restore the backup\" button, return to the state before the update.\nI've searched the internet and tried various things, but still can't solve the problem.\nI hope someone can help me. Thank you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406843", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: remove specificly the last  tag in all posts How to remove the last line of content in all of my WordPress posts, which always have its\nown tag <p>...</p>?\nEx:\n    <p>content I want to keep</p> \n    <p>line I want to remove<p/>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406847", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to add Internationalization in WordPress using Javascript/React? I am trying to follow this article https://developer.wordpress.org/block-editor/how-to-guides/internationalization/ in order to translate my block.\nI created my block using https://developer.wordpress.org/block-editor/getting-started/create-block/ script.\nThen in my gutenpride.php, I added this code.\nfunction myguten_set_script_translations()\n{\n    wp_register_script('myguten-script', plugins_url('/temp.js', __FILE__), ['wp-blocks', 'wp-i18n', 'wp-element'], filemtime(__DIR__ . '/temp.js'));\n\n    wp_set_script_translations('myguten-script', 'myguten', plugin_dir_path(__FILE__) . 'languages');\n\n    wp_localize_script('myguten-script', 'myguten', [\n        'plugin_url' => plugins_url('/', __FILE__),\n    ]);\n\n    wp_enqueue_script('myguten-script');\n}\nadd_action('init', 'myguten_set_script_translations');\n\nAs you can see, I am registering a temp.js file and giving it all the required dependencies.\nThe temp.js file works and is running.\nAs instructed by the translation article I added two files in my language folder\n1. myguten-co.po\n2. myguten.pot\n\nThen I created the JSON file for myguten-co.po and changed the site language to Esperanto.\nBut when I see the block or add the new block yet I do not get the translated label.\nIs there anything I am missing?\n\nA: I see that you do not use register_block_type in PHP, which is now recommended way to register block. I am assuming you register block in the front-end ( I am not familiar with create-block ), and instead that I inspect create-block, would you share your front end code where you also have translation functions? It could be for a various reasons that this does not function, one of more frequent being using incorrect text domain. Also, for better workflow I recommend using wp-cli and wp i18n make-json.\nEdit\nUse wp i18n make-json to create Jed-formatted JSON files. This is the reason why your code did not work. You only created .pot and .po files, but you have to supply .json files, since javascript loads them. See examples at bottom of this page.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406848", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Contact form - problem with displaying message about sent mail I'm trying to develop a contact form for a language school website that runs on Wordpress.\nDisclaimer: I'm about 6 months into coding, so please forgive me for being new to this. I'm developing my own theme and I wanted to limit usage of plugins to bare minimum for safety reasons - I prefer to learn how to write stuff myself instead on relying on updates of a third-party plus the courses I follow on Wordpress dev listed it as a good practice to avoid unnecessary plugins.\nThe problem is listed below in bold.\nWhat I want to achieve:\n\n*\n\n*Simple contact form that takes following info: name, email, course, phone (optional) and a message.\n\n*Validate the form if user provided correct info - I can't make the\nuser provide valid info, but at least I want to lock number into\nnumbers only range and check if email is correct.\n\n*Check if user is human (Captcha).\n\n*Send the email to my address and provide a copy to the sender.\n\n*Inform the user whether the action was a success or a failure.\n\nWhat I succeeded with:\n\n*\n\n*Mail gets sent.\n\n*Captacha seems to be working and filtering out attempts that do not click on it.\n\nWhat 'kinda works':\n\n*\n\n*The PHP doesn't seem to validate the form. I used HTML type and require instead, but I've read that solution is not ideal. I tried to use JS to write some functions that would prevent unwanted input, but I couldn't get it to work properly. I decided to ask the question first in case it might be a dead end. JS seems to be working on my Wordpress as I'm using Bootstrap and some custom JS for certain features so I'm pretty sure the code gets executed, but I wanted to ask first if that's the correct way of approach it before I invest my time in it.\n\nWhat I have a problem with:\nIt is imperative to me that the user gets feedback from the page whether the email has been sent or not for obvious business-client communication reasons. I tried two solutions found on SO:\n\n*\n\n*Injecting JS alert into PHP's echo inside conditional (JS doesn't get executed)\n\n*Using header method to redirect into thank-you.page that informs about success or error.page that\ninforms about a failure and recommends another avenue of contact\n\nWhat went wrong: the second solution got executed properly, the user gets redirected to site.com/thank-you or site.com/error, however the browser crashes due to 'too many redirects'.\nI tried googling, I tried different solutions from tutorials. What would be your recommendation?\nMy code:\n<?php \n$nameErr = $emailErr = $courseErr = $phoneErr = \"\";\n$name = $email = $course = $comment = $phone = \"\";\n$thank_you = wp_redirect( '\"'.home_url().'/thank-you\"', 301 );\n$error = wp_redirect( '\"'.home_url().'/error', 301 );\n\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    if (empty($_POST[\"name\"])) {\n      $nameErr = \"Give name\";\n    } else {\n      $name = test_input($_POST[\"name\"]);\n      // check if name only contains letters and whitespace\n      if (!preg_match(\"/^[a-zA-Z-' ]*$/\",$name)) {\n        $nameErr = \"Only letters allowed\";\n      }\n    }\n    \n    if (empty($_POST[\"email\"])) {\n      $emailErr = \"Need email\";\n    } else {\n      $email = test_input($_POST[\"email\"]);\n      // check if e-mail address is well-formed\n      if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n        $emailErr = \"Email incorrect\";\n      }\n    }\n  \nif (empty($_POST[\"phone\"])) {\n  $phone = \"\";\n} else {\n  $phone = test_input($_POST[\"phone\"]);\n  // check if URL address syntax is valid (this regular expression also allows dashes in the URL)\n  if (!is_numeric($number)) {\n    $phoneErr = \"Bad number\";\n  }\n}\n\nif (empty($_POST[\"comment\"])) {\n  $comment = \"\";\n} else {\n  $comment = test_input($_POST[\"comment\"]);\n}\n\nif (empty($_POST[\"course\"])) {\n  $courseErr = \"Pick course\";\n} else {\n  $course = test_input($_POST[\"course\"]);\n}\n  }\n function test_input($data) {\n    $data = trim($data);\n    $data = stripslashes($data);\n    $data = htmlspecialchars($data);\n    return $data;\n  }\n    if(!empty($_POST['g-recaptcha-response']))\n    {\n          $secret = 'mySecretKey';\n          $verifyResponse = file_get_contents('https://www.google.com/recaptcha/api/siteverify?secret='.$secret.'&response='.$_POST['g-recaptcha-response']);\n          $responseData = json_decode($verifyResponse);\nif($responseData->success)\n              $message = \"g-recaptcha verified successfully\";\n              if(isset($_POST['submit'])){\n                $to = \"myEmail@mail.org\"; // this is your Email address\n                $from = $_POST['email']; // this is the sender's Email address\n                $name = $_POST['name'];\n                $course = $_POST['course'];\n                $phone = $_POST['phone'];\n                $comment = \"Form submission\";\n                $comment2 = \"Copy of your form submission\";\n                $message =  \"Name:\" . $name . \"Interested in \" . $course. \" Number\" . $phone . \" \" . \" Wrote\" . \"\\n\\n\" . $_POST['comment'];\n                $message2 = \"Copy \" . $name .\"\\n\\n\" . \"Interested in:\" . $course . \"\\n\\n\" . $_POST['comment'];\n                $headers = \"From:\" . $from;\n                $headers2 = \"From:\" . $to;\n                mail($to,$comment,$message,$headers);\n                mail($from,$comment2,$message2,$headers2);\n                 // sends a copy of the message to the sender\n                 header($thank_you);\n                // This redirects to page thanking for contact.\n                }\n          else \n          header($error);\n// This redirects to page informing about failure.\n              $message = \"couldn't verify Captcha. Email not sent.\";\n         echo '<script type=\"text/javascript\">mailNotSent();</script>';\n     }\n?>\n<section id=\"contact\" class=\"contact\">\n    <div class=\"container pseudonest\">\n        <div class=\"pseudonest contact__head--nest\">\n            <h1 class=\"display-5 lh-1 mb-2 contact__head--pseudocircle contact__head--header mx-auto\">Enroll now</h1>\n        </div>\n        <div class=\"container m-auto\">\n             <div class=\"d-flex justify-content-center contact__form\">\n                <div class=\"col-md-7 col-lg-8\">\n                    <form action=\"\" method=\"post\">\n                        <form class=\"needs-validation\" novalidate>\n                            <div class=\"row g-3\">\n                                <div class=\"col\">\n                                    <label for=\"name\" id=\"nameHeader\" class=\"form-label\">Name</label>\n                                    <input type=\"text\" class=\"form-control radio__margin\" id=\"name\" name=\"name\"\n                                        placeholder=\"\" value=\"<?php echo $name;?>\" required>\n                                    <div class=\"invalid-feedback\">\n                                        <?php echo $nameErr;?>\n                                    </div>\n                                    <label for=\"email\" class=\"form-label\">Email</label></label>\n                                    <input type=\"email\" class=\"form-control radio__margin\" id=\"email\" name=\"email\"\n                                        placeholder=\"you@example.com\" value=\"<?php echo $email;?>\" required>\n                                    <div class=\"invalid-feedback\">\n                                        <?php echo $emailErr;?>\n                                    </div>\n                                    <label for=\"phone\" class=\"form-label\">Phone</label></label>\n                                    <input type=\"number\" class=\"form-control radio__margin\" id=\"phone\" name=\"phone\"\n                                        pattern=\"[0-9]+\" placeholder=\"+48 111 222 333\" value=\"<?php echo $phone;?>\">\n                                    <div class=\"invalid-feedback\">\n                                        <?php echo $phoneErr;?>\n                                    </div>\n                                </div>\n                                <div class=\"col radio__col\">\n                                    <label for=\"firstName\" class=\"form-label\">Course?</label>\n                                    <div class=\"row radio__section\">\n                                        <label class=\"radio__container\">English\n                                            <input type=\"radio\" name=\"course\"\n                                                <?php if (isset($course) && $course==\"English\") echo \"checked\";?>\n                                                value=\"English\">\n                                            <span class=\"radio__checkmark\"></span>\n                                        </label>\n                                        <label class=\"radio__container\">\n                                            <input type=\"radio\" name=\"course\"\n                                                <?php if (isset($course) && $course==\"Polish\") echo \"checked\";?>\n                                                value=\"Polish\">\n                                            <span class=\"radio__checkmark\"></span>Polish\n                                        </label>\n                                        <label class=\"radio__container\">\n                                            <input type=\"radio\" name=\"course\"\n                                                <?php if (isset($course) && $course==\"Italian\") echo \"checked\";?>\n                                                value=\"Italian\">\n                                            <span class=\"radio__checkmark\"></span>Italian\n                                        </label>\n                                        <span class=\"error\"> <?php echo $courseErr;?></span>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"col-12 mb-5\">\n                                <label for=\"email-content\" class=\"form-label\">Content</label>\n                                <div class=\"input-group has-validation\">\n                                    <textarea class=\"form-control\" rows=\"5\" name=\"comment\"\n                                        cols=\"30\"><?php echo $comment;?></textarea>\n                                    <div class=\"invalid-feedback\">\n                                    </div>\n                                </div>\n                            </div>\n                            <form id=\"frmContact\" action=\"varify_captcha.php\" method=\"POST\" novalidate=\"novalidate\">\n                                <div class=\"g-recaptcha my-3\" data-sitekey=\"mySiteKey\">\n                                </div>\n                                <input type=\"submit\" name=\"submit\" value=\"Send\" id=\"submit\"\n                                    class=\"btn btn-primary contact__form--btn\">\n                                <div id=\"fakeSubmit\" class=\"btn btn-primary contact__form--btn hidden\">Fill the form\n                                </div>\n                            </form>\n                        </form>\n                </div>\n            </div>\n</section>\n\n\nA: I understand your hesitation about using 3rd party plugins, but form handling is a primary candidate to offload to one. That's coming from someone who always tries to build bespoke.\nThere is a reason why several well-established WP form plugins exist - forms are tedious to build & handle manually, prone to errors & unwittingly introducing security vulnerabilities. There are so many elements to consider & cater for.\nIf you still wish to pursue your own form building, I would strongly suggest using an existing PHP framework or library  (I can't recommend one personally but you can check out a bunch on packagist).\nIt'll mean you can code your forms more expressively & less verbosely, focusing on what the form is rather than dealing with all the repetitive & tedious mechanics of standard form processing.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406850", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: sort metabox columns in listing Single Hello WordPress community!\nI modified an existing meta box which is page_attributes. I grafted it to the articles and it allows me to give an order to the posts. I want to add the column to the postslistings in the Wordpress backoffice. I used the Admin columns plugin and the column displays fine. I want the ability to sort items in ascending or descending order of value. But it does not work. Here is my code\nfunction eloi_order_column_register_sortable( $columns ) {\n    $columns['62a9d32255c290'] = 'Ordre affichage'; // CSS ID generate by Admin columns plugins\n     \n    return $columns;\n}\nadd_filter( 'manage_edit-post_sortable_columns', 'eloi_order_column_register_sortable' );\n\nfunction order_column_orderby( $vars ) {\n   if ( isset( $vars['orderby'] ) && '62a9d32255c290' == $vars['orderby'] ) {\n        $vars = array_merge( $vars, array(\n                'meta_key' => 'pageparentdiv', // meta box id : view file wp-includes/meta-box.php line 1522 \n                'orderby' => 'meta_value',\n                'order' => 'DESC'\n        ) );\n    }\n     \n    return $vars;\n}\nadd_filter( 'request', 'order_column_orderby' );\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406851", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: imporing HTML+javascript from REST API i got a new task - move my front to VueJs,\nso now i have to return forms through API's\nhere is an example of my Endpoint:\nreturn do_shortcode(get_field('ninja_form_shortcode', $document->ID));\n\nThe issue is that on the front end, am re\u0441iving an escaped Javascript code\nlike this (this is a litle part):\n\"add_submit\\\":0,\\\"currency\\\":\\\"\\\",\\\"repeatable_fieldsets\\\":\\\"\\\",\\\"unique_field_error\\\":\n\nam asuming thats why my form is not rendering\nany ideas?\nEDIT:\ni was wrong, the script tag is not running at all.\nthe question now i think is- how to run a fetched script tag?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406852", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Publish button now showing content after saving I am working on a theme, which when I build a new header (which is a post) and hit publish, it hides/deletes all elements (looks like a css code that somehow,  hides elements on the front). When I preview the page, I see a white page. but when I inspect element it, I can actually see the codes running there.\nthis is a 2 weeks, FRUSTRATING bug actually.\nany idea? code? thoughts is more than welcome\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406854", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Cookies set by a plugin in wordpress for tracking We have our companies website on a wordpress-multisite-installation with some plugins:\n\n*\n\n*All-in-One WP Migration\n\n*All-in-One WP Migration Multisite Extension\n\n*Better Search Replace\n\n*HTTP2 push content\n\n*Polylang\n\n*Security Headers\n\n*Themify Updater\n\n*WP-Optimize - Clean, Compress, Cache\n\nOne of this plugins seem to set the following cookies, mainly used for tracking and marketing. These cookies are only get set at some point when logged into wordpress.\nhttps://cookiedatabase.org/service/rudderstack/\nOf course we want to get rid of them. Though I cant figure out which plugin seems to cause the cookies. So far I tried the following:\n\n*\n\n*searching all files on the server for the cookie-name and \"rudder\" with the result of them appearing in the backup-files of  All-in-One WP Migration and All-in-One WP Migration Multisite Extension\n\n*clicking through wordpress to find the place where they are set (included Firefox-Extensions uBlock and Ghostery) but it is not consistent and I am not sure if All-in-One-Plugins are truly the culprit\n\n*this: https://stackoverflow.com/questions/30946617/determining-origin-of-cookie-which-javascript-or-tracking-pixel without specific results.\n\nDeactivating every plugin one by one could lead to the culprit but since the setting of these cookies seems to be not consistent, I am not sure.\nDoes somebody know where these cookies originate from?\nWhat would you do to get rid of the cookies?\nThanks for the help in advance.\n\nA: Solved:\nThe database contained tables of tested plugins containing that cookies. Removing the old tables removes the cookies from the browser.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406857", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Implement editor' CSS on the custom themes I have a custom theme. I develop it and I have custom CSS library.\nBut I have make text color red in the WP' editor. But into frontend these attributes don't appear. How can I find WordPress' old and new editor' CSS codes?\n<div class=\"has-vivid-red-color has-text-color\">..</div>\n\n\nFor Example: Above code snippet is new editor.\n\nI mean, I can include them into my main CSS file.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406860", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress bulk category select when publishing post Often I need to attach post to all categories and I have about 200 categories. When I need to select all categories while publishing post , I select categories one by one. How can I add select all toggle above category list. I need this not only for categories but also for custom taxonomy and tags \n\nA: The default function that renders the categories meta box is post_categories_meta_box - it doesn't have any internal hooks we can use to inject our own HTML, so let's create our own meta box handler and just use the function internally:\nfunction wpse_406861_post_categories_meta_box( $post, $args ) {\n    post_categories_meta_box( $post, $args );\n\n    echo <<<HTML\n<label>\n    <input type=\"checkbox\" onchange=\"this.parentElement.parentElement.querySelectorAll('.categorychecklist input[type=checkbox]').forEach(checkbox => checkbox.checked = this.checked);\" />\n    Select all\n</label>\nHTML;\n}\n\nThis just adds a simple checkbox at the bottom of the default meta box, with a bit of JS that toggles all the term checkboxes inside it.\nAnd to set this as the default meta box handler for all hierarchical taxonomies, we can use the hook register_taxonomy_args to override the arguments passed to any register_taxonomy call:\nadd_filter( 'register_taxonomy_args', function ( $args ) {\n    if ( ! empty( $args['hierarchical'] ) && empty( $args['meta_box_cb'] ) ) {\n        $args['meta_box_cb'] = 'wpse_406861_post_categories_meta_box';\n    }\n\n    return $args;\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406861", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress get_media_embedded  test text\n\n<div class=\"video\">\n    \n    <?php\n\n        $media = get_media_embedded_in_content( apply_filters( 'the_content', get_the_content() ));\n        \n        print_r($media);\n\n        \n    ;?>\n\n</div>\n\n<div class=\"uitgelichttitel\">\n    <?php the_title();?>\n</div> \n\nthat's my code\n\nFinally shows me the video, but I am getting this on the front-end:\nArray ( [0] =>  )\nWhy?\nChanging print_r($media) to print($media) removes the video.\nInfo about the file\nThis is the entire file. It's called content-video.php. WordPress automatically attached this file to the post format. When it loops through the posts it immediately checks the post format and if it is post format then it fetches the file accordingly. In this case that's content-video.php.\nExtra about me\nI apologize if this is a no brainer. Have been trying to learn how all of this works for a while now, including plenty of hours today, probably going to be working on figuring this out until the night. Figured maybe I could get someone to tell me what's up in easier terms, there's already a lot that I am trying to get a grasp on. Thank you. I am new to Wordpress theme development, new to PHP and new to JS.\nThe Goal\nPull the embed video from the post content to display on a different page.\nBest Attempt\nWhat I have thus far, which I am still trying to wrap my head around.\nThe Fix\nProvided by TheDeadMedic:\nChange \"print_r\" to \"print current\"\nLoads of gratitude for the help! I finished my registration so that I can contribute to StackExchange in the future.\n\nA: Because print_r prints a readable version of your variable $media, which will be an array as per the documentation for get_media_embedded_in_content().\nYou see Array ( [0] => [youtube embed] ) in your browser because it's rendering the HTML of the array element - if you check the source code of your page you would see something like:\nArray (\n    [0] => <iframe src=\"...\" />\n)\n\nBut to answer your problem, you should print (or echo) with current()  to get the \"current\" element in an array, which in this case will be the HTML for the first found media element (if one exists):\nprint current( $media );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406862", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to Enable Ascending or Descending In WordPress Default Built-in Loop Can someone please let me know how we can add Order functionality to WordPress Built-in Loop?\n<?php \nif (have_posts()) { \n    while (have_posts()) { \n        the_post(); \n        // Post Content here \n    } // end while\n} // end if\n?>\n\nI know this is doable in WP_Query like\n$args = array(\n    'orderby' => 'title',\n    'order'   => 'DESC',\n);\n$query = new WP_Query( $args );\n\nbut how we can do this is default loop?\n\nA: Use the parse_query hook to override the default main query:\nadd_action( 'parse_query', function ( WP_Query $wp_query ) {\n    /**\n     * Only apply our custom ordering when:\n     * - We're not in the admin\n     * - It's an archive (i.e. not singular)\n     * - It's the main query (won't affect custom WP_Query)\n     */\n    if ( ! is_admin() && ! $wp_query->is_singular() && $wp_query->is_main_query() ) {\n        $wp_query->set( 'orderby', 'title' );\n        $wp_query->set( 'order', 'DESC' );\n    }\n});\n\nThis needs to live in a plugin or your theme's functions.php.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406867", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wp_get_global_settings is not updated on save_post hook I'm trying to get theme color values and write a .scss file upon updating the theme colors (or other theme settings) in the full site editor (site-editor.php).\nadd_action( 'wp_after_insert_post', function( $post_id, $post ) {\n\n    if ( $post->post_type !== 'wp_global_styles' ) {\n\n        return;\n\n    }\n\n    error_log( 'Writing scss for post ' . $post_id );\n    error_log( $post->post_content );\n\n    //Now write the scss\n    write_theme_color_scss();\n\n\n\n}, 100 , 2 );\n\nfunction write_theme_color_scss( ) {\n\n    $theme_colors = wp_get_global_settings( ['color', 'palette', 'theme' ] );\n\n    $scss_vars = [];\n\n    if (!empty($theme_colors)) {\n\n        foreach ($theme_colors as $color) {\n\n            $scss_vars[] = sprintf(\"$%s: %s;\", $color['slug'], $color['color']);\n    \n        }\n    }\n\n    $scss = implode(\"\\r\", $scss_vars);\n\n    $filename = get_stylesheet_directory() . '/assets/src/css/_theme-colors.scss';\n\n    return file_force_contents($filename, $scss);\n\n\n}\n\n\nUpon using both save_post (with a late priority) and wp_after_insert_post, I'm getting values from \"one update ago.\"\nI'm guessing something is cached in the database and isn't refreshed until the next save_post is run? Anybody have any ideas on how I can get the most current set of theme settings?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406869", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Safest way to create a custom permalink I'm building a plugin for woocommerce where a user can purchase tickets for participating in a quiz.\nBTW, the URL of the dev environment I'm building the plugin in is localhost/lottery (keep that info in mind).\nAdditionally, product_base of get_option( 'woocommerce_permalinks' ) is also set to lottery (keep that info in mind also)...\nAnd finally suppose that a product (a participation ticket) is named simply lottery.\nSo in this extreme scenario get_permalink( <of that product> ) would return localhost/lottery/lottery/lottery...\nAlso, I have setup a rewrite rule to return the quiz linked to a participation ticket. The rewrite rule is this:\nadd_rewrite_rule( 'quiz/(.+?)/?$', 'index.php?page_id=' . wc_get_page_id( 'mcq_quiz' ) . '&lottery_name=$matches[1]', 'top' );\n\nSo for a product with permalink localhost/lottery/lottery/play-and-win-a-samsung-galaxy, the quiz attached to it will be localhost/lottery/quiz/play-and-win-a-samsung-galaxy\nSo what's the safest way to get that quiz permalink? my initial idea was to do a get_permalink(of-the-lottery) and then do a str_replace() of /lottery/ by /quiz/... But which occurrence? At first I had thought the last occurrence was safe enough. But in the extreme scenario where the product would be named lottery, the last one is wrong...\nCould I simply synthesize it by using this piece of code:\nsite_url() . '/' . get_post_field( 'post_name', wc_get_page_id( 'mcq_quiz' ) ) . '/' . get_post_field( 'post_name', $product->get_id() );\n\nwhere\n\n*\n\n*site_url() returns the http://localhost/lottery part\n\n*get_post_field( 'post_name', wc_get_page_id( 'mcq_quiz' ) ) returns the quiz part\n\n*get_post_field( 'post_name', $product->get_id() ) returns the product's (ticket's) slug part\n\nIt seems to do the job but I'm afraid I may be missing some strange scenario (like the ones described above) where this would produce a wrong permalink...\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406870", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress redirect to new domain name I would like to redirect my WordPress website to a new domain but I want to do it correctly with .htaccess file. I want to redirect only the brands page, products pages, product categories, product tags and the images. What should I should put in the .htaccess file?\n\n\nThere is also another issue. I am using GTRANSLATE to have my site in multiple languages. and they are using the same bases. For example https://website1.example/es/p/xxxxxxxxxx for products.\nI want to do this in order not to hurt my SEO.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406873", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Fetching custom post type without knowing post type (REST API) How can I fetch posts from a custom post type without actually including the post type in the query url?\nThe data I'm provided doesn't have a reference to the post type, so all I get is the post ID. I've tried querying without the post type and I just get\n{\"code\":\"rest_no_route\",\"message\":\"No route was found matching the URL and request method.\",\"data\":{\"status\":404}}\n\n\nA: You could create a generic REST API endpoint that just accepted a post ID. I've used the default WP_REST_Posts_Controller to handle some standard checks and format the response:\nadd_action( 'rest_api_init', function () {\n\n    register_rest_route( 'wpse/406874', 'post_data/(?P<id>\\d+)', [\n        'methods' => WP_REST_Server::READABLE,\n        'permission_callback' => '__return_true',\n        'callback' => function ( WP_REST_Request $request ) {\n            $id = (int) $request['id'];\n\n            $post = get_post( $id );\n\n            $post_type = get_post_type( $post );\n\n            $valid_post_types = get_post_types([\n                'public' => true,\n                'show_in_rest' => true,\n            ]);\n\n            if ( ! in_array( $post_type, $valid_post_types ) ) {\n                return new WP_Error( 'rest_post_invalid_id', __( 'Invalid post ID.' ), [ 'status' => 404 ] );\n            }\n\n            $controller = new WP_REST_Posts_Controller( $post_type );\n\n            $check = $controller->get_item_permissions_check( $request );\n\n            if ( $check !== true ) {\n                return $check;\n            }\n\n            return $controller->get_item( $request );\n        }\n    ]);\n\n});\n\nThis would mean any post of any public post type (& with show_in_rest => true) would be queryable via:\nhttps://example.com/wp-json/wpse/406874/post_data/<id>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406874", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I get reusable blocks via frontend REST API? I'm using /wp-json/wp/v2/blocks to request all blocks on the frontend, but I just get a response of [] even though I've made a reusable block in admin.\nI suspect that what I mean by block and what Wordpress 6 means are different things, but I've not found the REST API documentation helpful in this regard - perhaps I'm too deep for definitions to be provided.\nWhy I'm doing this\nIn WP6, there are reusable blocks. These seem ideal to be pulled down via AJAX so that pages can be otherwise statically cached. Perhaps there's a better way to handle FPC hole-punching but I've not found it, and with a JSON REST API this seems ideal.\n\nA: \nHow do I get reusable blocks via frontend REST API?\n\nWe need to be logged in as a user and additionally add the wp_rest nonce to the block rest endpoint request, either via the _wpnonce POST/GET parameter or via the X-WP-Nonce header.\nSee e.g. the docs for more information on the authentication.\nEDIT: As pointed out in comment, to do what questioner is trying to achieve you would need to create a custom endpoint without authentication as the existing block endpoint checks permission of current user.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406876", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Custom reduce stock code affecting date_modified - How to bypass? I have a stock reduction script that works perfectly. The only problem is, when a purchase is made and the stock is reduced, the date_modified meta is updated. This causes problems for other scripts I have, as the post isn't actually updated - just the stock.\nHow can I achieve the same result with this code, without it actually updating the date_modified meta? (ie: only update date_modified when the product itself is manually updated).\n// ---------------------------------------------------------------------------------------- //\n// --------------------------  REDUCE WEIGHT BASED ON WEIGHT FIELD  ----------------------- //\n// ---------------------------------------------------------------------------------------- //\n\n// reduce stock based on 'pa_weight' attribute\nadd_filter( 'woocommerce_order_item_quantity', 'filter_order_item_quantity', 10, 3 ); \nfunction filter_order_item_quantity( $quantity, $order, $item )  \n{\n    $product   = $item->get_product();\n    $term_name = $product->get_attribute('pa_weight');\n\n    // 'pa_weight' - keep only the numbers\n    $quantity = preg_replace('/[^0-9.]+/', '', $term_name);\n\n    // new quantity\n    if( is_numeric ( $quantity ) && $quantity != 0 )\n        $quantity *= $quantity;\n\n    return $quantity;\n}\n\n\n/**\n * Order change stock reduction fix.\n * \n * @param $prevent\n * @param $item\n * @param $item_quantity\n * @return bool|mixed\n */\nfunction custom_stock_reduction_order_change( $prevent, $item, $item_quantity ) {\n    $stock_reduced   = wc_stock_amount( $item->get_meta( '_reduced_stock', true ) );\n    $stock_reduction = filter_order_item_quantity( $item->get_quantity(), null, $item );\n\n    if ( $stock_reduction == $stock_reduced ) {\n        $prevent = true;\n    }\n\n    return $prevent;\n}\nadd_filter( 'woocommerce_prevent_adjust_line_item_product_stock', 'custom_stock_reduction_order_change', 10, 3 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406880", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Check if user has comment on current post Hello I have multiauthor website and I need to create a condition to check if defined user ( no current user ) has comment on current post.\nHere is my code but I can not complete this\n$userid = \"444\"; //this is the user that I need to Check if has comments on current post\n\n$commenters = array(\"444\", \"544\", \"245\", \"453\", \"773\", \"990\"); //here I need to get array of users ids who have comment in current post and check if user with the id 444 exist in this array\nif(in_array($userid, $commenters)){ \n    echo \" user with the id 444 have comment in current article\";\n}\nelse {\n    echo \"user with the id 444 have no comment in current article\";\n}\n\nmy problem is that how can I  get array of users ids who have comment in current post or do you have any better alternative to code. Thanks for your attention\n\nA: \nI need to create a condition to check if defined user ( no current\nuser ) has comment on current post\n\nFor that purpose, you can just use get_comments() like so:\n$post_id = get_the_ID(); // or just set a specific post ID\n$user_id = 444;\n\n// Get the total number of comments by the above user on the above post only.\n$comment_count = get_comments( array(\n    'post_id' => $post_id,\n    'user_id' => $user_id,\n    'count'   => true,\n) );\n\nif ( $comment_count ) {\n    echo \"user $user_id has <b>$comment_count comments</b> on post $post_id\";\n} else {\n    echo \"user $user_id has not commented on post $post_id\";\n}\n\n\nhow can I get array of users ids who have comment in current post\n\nJust like the above example, you can also use get_comments() like so:\n$comments = get_comments( array(\n    'post_id' => $post_id,\n) );\n\n// Get the users who have commented on the above post and store their ID, if any,\n// in $commenters.\n$commenters = array();\nforeach ( $comments as $comm ) {\n    if ( $comm->user_id && ! in_array( $comm->user_id, $commenters ) ) {\n        $commenters[] = $comm->user_id;\n    }\n}\n\nif ( in_array( $user_id, $commenters ) ) {\n    .. your code here.\n} else ...\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406883", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Allow login only for one account from one device Hi All i hope all you are ok .\ni am working on a membership website , and i want to prevent user from shared there paid account to other people , meaning that the registered account attached to ip so no one can use this account in other device .\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406885", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disabling direct access to images using .htaccess I have installed Wordpress in a subdirectory of a subdomain. I am using the following rewrite rule to direct all urls to this subdirectory.\nRewriteCond %{HTTP_HOST} ^(www\\.)?mysubdomain.mydomain\\.\nRewriteRule ^(.*)$ /wp/$1 [L]\n\nThis is working fine!\nNow, I want to only allow logged in users to be able to access the 'wp-content/uploads/' folder. I am using the solution explained here: https://gist.github.com/hakre/1552239\nI have added the following rewrite rule to my .htaccess (above the previous rewrite rule):\nRewriteRule ^wp-content/uploads/(.*)$ dl-file.php?file=$1 [QSA,L]\n\nThis, however, only works for 50%. When I am logged in and I try to access an image with a path like '.../wp-contents/uploads/image.jpg', I get redirected to the log-in page. Just as how it should happen. However, since I installed Wordpress in a subdirectory, the image path actually is '.../wp/wp-contents/uploads/image.jpg'. When I am not logged in and try to access an image with this path, the image opens normally. I am not being redirected to the log-in page.\nI have tried adding 'wp' to a rewrite rule, like:\nRewriteRule ^wp/wp-content/uploads/(.*)$ dl-file.php?file=$1 [QSA,L] \n\nBut to no success. I am sure I am missing something in my .htaccess file. Any ideas how to ensure that images are no longer accessible for non logged-in users would be much appreciated.\n\nA: \nI have added the following rewrite rule to my .htaccess (above the previous rewrite rule):\n\nRewriteRule ^wp-content/uploads/(.*)$ dl-file.php?file=$1 [QSA,L]\n\n\nYou presumably have another .htaccess file in the /wp subdirectory that contains the main WordPress directives (ie. # BEGIN WordPress etc.).\nYou should be adding the above rule to the /wp/.htaccess file, not the one in the root.\nWhen accessing a URL of the form /wp/... the mod_rewrite directives in the root .htaccess file are completely overridden by the mod_rewrite directives in /wp/.htaccess (by default). The mod_rewrite directives in the root .htaccess file are not even processed, since mod_rewrite directives are not inherited by default.\nThe dl-file.php script should then be in the root of the WordPress installation, not in the document root.\n\nAside:\n\nHowever, since I installed Wordpress in a subdirectory, the image path actually is .../wp/wp-contents/uploads/image.jpg.\n\nAlthough this would imply you have a mismatch of URLs... some containing the /wp subdirectory and some (your static assets) not.\nThe first rule you posted rewrites requests to the /wp subdirectory for any request where it is omitted. (The .htaccess file in the /wp subdirectory ensures it does not rewrite requests that already contain /wp.)\nYou should either:\n\n*\n\n*Include /wp in all your URLs\n\n\n*Omit /wp from all your URLs.\nYou currently appear to have a mixture of both.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406886", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Website working fine when logged in but not working fine when we logged out I am a developer and for 7 days I am facing this problem and I can't find where exactly the problem is\nWhat I tried:\nDeactivate WP Rocket Plugin\nClear Cache from WP ENGINE\nbut I am still facing the same error\nhttps://hive.com/pricing-v2-0/\nThis is the link\nWhen I visit this link while Logged in its works OK when I click\nThe \"Complete feature list\" Button takes me to the Complete Featured list but when I check on Private Window it doesn't take me to complete featured list items it takes me to the top of the page and I have to scroll down.\nPage Builder I am using Elementor\nTheme I am using Sage Theme\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406887", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Navbar affect loading all products I am currently working on an eCommerce website. I am using a jetsmart filter for product categories and displays the active filter. Added a product category navbar menu on the footer. When I click the menu item, it will redirect me to the shop page, but when I deselect the active filter, the page won\u2019t show all the products but remain in the selected category. Is there any possibility of showing all products?\nNote There\u2019s no problem with the filtering, just the navbar item.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406888", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress programatically inserted post not showing in authors profile I have inserted a post programmatically in a wordpress\nWhen viewing the post on the authors' page, there is no post from the post that I have inserted programmatically, but when manually updating the post, it's then working and showing properly. What will the cause and how to solve this any guide?\nCode in my plugin:\nadd_action('wp_ajax_insert_data_to_post_type_func', 'insert_data_to_post_type_func');\n\nfunction insert_data_to_post_type_func(){\n    global $wpdb;\n    $table_name = $wpdb->prefix . 'ebay_listings';\n    $select_query =  $wpdb->get_results(\"SELECT * FROM $table_name LIMIT 1\");\n    $user_id_get = $_POST['userID'];\n    foreach ($select_query as $sq) {\n        \n        $heading = $sq->title;\n        $x = json_decode($heading);\n\n        $des = $sq->long_desctiption;\n        $y = json_decode($des);\n        $z = json_decode($sq->add_id);\n        $imgs = json_decode($sq->image_URL);\n        $date = json_decode($sq->date);\n        $location = json_decode($sq->location);\n        $list_items = json_decode($sq->list_items);\n        $price = json_decode($sq->price);\n\n        foreach ($x as $tx) {\n            $title[] = $tx;\n        }\n        foreach ($y as $lng_des) {\n            $description[] = $lng_des;\n        }\n\n        foreach ($z as $add) {\n            $add_id[] = $add;\n        }\n        foreach ($date as $dt) {\n            $eb_date[] = $dt;\n        }\n        foreach ($location as $loc) {\n            $locality[] = $loc;\n        }\n        foreach ($list_items as $lit) {\n            $listings[] = $lit;\n        }\n        foreach ($price as $p) {\n            $pricing[] = $p;\n        }\n        $i = -1;\n      \n        foreach ($imgs as $sd) {\n          \n            $i++;\n            $image_name = basename($sd);\n           \n            $advert_posts = array(\n                'post_author' => $user_id_get,\n                'post_type' => 'advert',\n                'post_title' => $title[$i],\n                'post_content' => $description[$i] . $listings[$i],\n                'post_status' => 'publish',\n            );\n            $post_id = wp_insert_post($advert_posts);\n            $category_id = 877;\n            $taxonomy = 'advert-category';\n            wp_set_object_terms( $post_id, array( $category_id ), $taxonomy , true );\n            add_post_meta( $post_id , 'advert_sale_price' , $pricing[$i]);\n            add_post_meta( $post_id , 'advert_type' , 1);\n            add_post_meta( $post_id , 'advert_negotiable' , 1);\n            add_post_meta( $post_id , 'advert_location' , $locality[$i]);\n            \n            var_dump( get_post_field( 'post_author', $post_id ), $user_id_get);\n            \n            $upload = wp_upload_bits($image_name, null, file_get_contents($sd, FILE_USE_INCLUDE_PATH));\n            $imageFile = $upload['file'];\n            $wpFileType = wp_check_filetype($imageFile, null);\n          \n            // rwmb_set_meta( $post_id, 'advert_gallery', $imageFile, $args = [] );\n            $attachment = array(\n                'post_mime_type' => $wpFileType['type'],  // file type\n                'post_title' => sanitize_file_name($imageFile),  // sanitize and use image name as file name\n                'post_content' => '',  // could use the image description here as the content\n                'post_status' => 'inherit'\n            );\n            $attachmentId = wp_insert_attachment($attachment, $imageFile, $post_id);\n\n            // insert and return attachment metadata\n            $attachmentData = wp_generate_attachment_metadata($attachmentId, $imageFile);\n\n            // update and return attachment metadata\n            wp_update_attachment_metadata($attachmentId, $attachmentData);\n            // finally, associate attachment id to post id\n            $success = set_post_thumbnail($post_id, $attachmentId);\n            add_post_meta( $post_id , 'advert_gallery' , set_post_thumbnail($post_id, $attachmentId));\n            \n            if ($success) {\n                echo 'Data and images have been inserted';\n            } else {\n                echo 'Something went wrong';\n            }\n        }\n        wp_die();\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406890", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Theme Menu vs Native Menu I installed\n\n*\n\n*the Blocksy Theme\n\n*a Starter Site from Blocksy\n\nNow, that starter site already comes with a Menu, like this:\n\nBut when I navigate to the native Customizer and go to Menus, it says there are no menus yet:\n\nWhat is the relationship between native Wordpress Customizer Menues and Theme Menues? Which one am I supposed to edit? Should I create a new Menu here even though there is already one? I just wanted to edit the existing one ... but there exists none, or does there ... or what ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406893", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP-Cli Error When Mapping Multisite Subdomain I have a multisite located at example.com  which has a subsite located at subsite.example.com.\nI followed the official Wordpress.org documentation to map subsite.example.com to otherexample.com\nhttps://wordpress.org/support/article/wordpress-multisite-domain-mapping/\nThe public site maps perfectly to otherexample.com  (all links work correctly).\nHowever, in order to access the Admin Dashboard for subsite.example.com, I must add define('COOKIE_DOMAIN', $_SERVER['HTTP_HOST']);  to my wp-config.php\nAfter adding define('COOKIE_DOMAIN', $_SERVER['HTTP_HOST']);  to my wp-config.php, wp-cli starts to throw a bug bug that is nearly a decade old:\nPHP Notice:  Undefined index: HTTP_HOST in phar:///usr/local/bin/wp/vendor/wp-cli/wp-cli/php/WP_CLI/Runner.php(1277) : eval()'d code on line 106\n\nI found this github thread from 2013 that has several workarounds, but I would like to know if there is a more recent / efficient solution to problem?\nhttps://github.com/wp-cli/wp-cli/issues/730\nseems odd to apply solutions that are nearly a decade old..\nAny tips?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406894", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Xamp installed local wordpress not allowing to publish or install plugin I installed wordpress locally with xamp on my pc (Macbook pro Apple silicon 2021), yesterday I could normaly install a plugin (starter template) but today if I try to install a plugin it says at first \"update failed\" on the button where it should usually say activate but when I reload the page it is installed and I can click on activate but it does not activate it. When trying to install I am getting the following message:\nInstallation failed: Hello World!{\"success\":true,\"data\":{\"install\":\"plugin\",\"slug\":\"jetpack\",\"pluginName\":\"Jetpack &#8211; WP Security, Backup, Speed, &amp; Growth\",\"debug\":[\"Downloading installation package from https:\\/\\/downloads.wordpress.org\\/plugin\\/jetpack.11.0.zip&#8230;\",\"The authenticity of jetpack.11.0.zip could not be verified as no signature was found.\",\"Unpacking the package&#8230;\",\"Installing the plugin&#8230;\",\"Plugin installed successfully.\"],\"activateUrl\":\"http:\\/\\/localhost\\/wordpress\\/wp-admin\\/plugins.php?_wpnonce=0ec70b4569&action=activate&plugin=jetpack\\/jetpack.php\"}}\n\nAnd when I try to publish a page I am getting that the response is not a valid json.\nI tried to do sudo chmod 777 to the htdocs page but it did not help, I set in my wp-config the following:\n/** In order to install plugins */\n define( 'FS_METHOD', 'direct' );\n\nThis had worked yesterday but not today anymore, I am using the latest version of Xamp and wordpress\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406898", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding custom form within add_shortcode I'm adding a custom form within a shortcode, but whenever I paste the shortcode in the page editor the form posts automatically and redirects to /wp-admin/admin-post.php with a blank screen.\nI'm using the admin_post hook to submit the form.\nBut when I add the form using the_content hook it works perfect. The only problem with this method is that I don't have full control of where to add the form in the page.\nWhat am I doing wrong?\n// ADD THE SHORTCODE FORM\nadd_shortcode('get_job_card_form', 'vision_get_job_card_form');\nfunction vision_get_job_card_form()\n{\n    $formHtml = '<form action=\"' . admin_url('admin-post.php') . '\" method=\"POST\">';\n    $formHtml .= wp_nonce_field('get_job_card', 'get_job_card_nonce');\n    $formHtml .= ' <input type=\"hidden\" name=\"action\" value=\"get_job_card\" />';\n    $formHtml .= '<button name=\"getJobCard\" type=\"submit\" class=\"et_pb_button et_pb_button_2 et_pb_bg_layout_light\">Get Job Card</button>';\n    $formHtml .= '</form>';\n    return $formHtml;\n}\n\n// ADMIN POST HOOK\nadd_action('admin_post_nopriv_get_job_card', 'get_job_card');\nadd_action('admin_post_get_job_card', 'get_job_card');\nfunction get_job_card()\n{\n    include get_stylesheet_directory() . '/vision/data/vision-get-job-card.php';\n    die();\n}\n\n\nA: \nwhenever I paste the shortcode in the page editor the form posts\nautomatically and redirects to /wp-admin/admin-post.php with a blank\nscreen\n\nI don't know what editor is that (), and I'm not sure if this will fix the above issue, but I noticed your function is using wp_nonce_field() which by default displays/echo the output, so because you're doing $formHtml .= wp_nonce_field(...), then you need to disable the echo because otherwise you'd run into issues like invalid REST API's JSON response which then causes the block/Gutenberg editor to fail in saving the post.\n// set the 4th parameter to false\n$formHtml .= wp_nonce_field('get_job_card', 'get_job_card_nonce', true, false);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406899", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: AWS usage queries 1.We are hosting multiple Wordpress websites on Aurora database. We develop the sites in a subdomain and when go live we just rename the subdomain to the actual domain and make the necessary changes in the database. But, whenever we launch the sites, we get a lot of database connections (we run the show full processlist command) and our Aurora database server goes down. When we change the domain name to some other domain, it works fine. When we disable the Elementor (Wordpress rag and drop builder) builder's header template, it works fine. When it's still a subdomain it does not cause any issues. Query monitor do not show any suspicious queries and \"show full processlist\" show 1000+ queries in either \"sleep\" or \"cleaning up\" or \"cleaned up\" state but does not kill them.\n2.We have an ec2 image (It also have information to add the EFS volume in a predefined path when it boots) that we use to create additonal ec2 instances and add those instances to load balancer group manually. Can we use that image (12 GB) with AWS autoscaling and increase/decrease ec2 instances depending on server load ? How long it might take for a new instance to boot up if server load increases ? Can we turn on/off the autoscaling without affecting the base set of ec2 instances ?\n3.We have 2 ec2 instances running 50 WP Single sites and multisites with horizontal scaling. Our architecture involves load balancer, redis cache, Aurora DB (2 cpu to 4 cpu scaling) and EFS (uploads). What ec2 instance type you propose and why ? Should we use high ec2 types like M series or should we use t2/t3 instance types but increase the ec2 instances from 2 to 4 (horizontal scaling) ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406901", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: RSS: fetch_feed caching with different caching delay per feed? I have seen that the filter wp_feed_cache_transient_lifetime can be used to set the cache period for fetch_feed.  But this seems to set it globally for all feeds.  Is there a way to have a different cache period per feed?\nThis is useful in my case where I have multiple feeds for quite different purposes.  some feeds are clearly being refreshed very quickly, while I don't expect others to be updated more than once per month.\nThe issue with these RSS feeds is if they are not cached properly they slow down the page noticeably.\n\nA: You can use the second parameter passed to the wp_feed_cache_transient_lifetime filter which, in the context of fetch_feed(), is the URL of the feed:\nadd_filter( 'wp_feed_cache_transient_lifetime', function ( $time, $url ) {\n    if ( $url === 'https://example.com/rss' )  {\n        $time = MONTH_IN_SECONDS;\n    }\n\n    return $time;\n}, 10, 2 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406904", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Custom Add To Cart Button with AJAX i made a custom add to cart button but i cant load it with ajax here is the code.\ni added this code into my functions.php\n// Add \"Add To Cart\" button  //\nadd_action('woocommerce_after_shop_loop_item', 'add_a_custom_button2', 13 );\nfunction add_a_custom_button2() {\n    global $product;\n\n    // Not for variable and grouped products that doesn't have an \"add to cart\" button\n    if( $product->is_type('variable') || $product->is_type('grouped') ) return;\n\n    // Output the custom button linked to the product\n    echo '<div style=\"margin-bottom:10px;\">\n        <a class=\"customviewaddtocartbutton\" href=\"' . esc_attr( $product->add_to_cart_url() ) . '\">' . __('Add To Cart') . '</a>\n    </div>';\n}\n\ncan anyone help me please, Thank You <3\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406908", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Exclude Woocommerce Product Category From Sitemap Am trying to exclude 2 specific product categories from default WordPress sitemap.\nAny help how to archive this?\nadd_filter(\n 'wp_sitemaps_posts_query_args',\n function( $args, $post_type ) {\n     if ( 'product_cat' !== $post_type ) {\n         return $args;\n     }\n\n     $args['product_cat__not_in'] = isset( $args['product_cat__not_in'] ) ? $args['product_cat__not_in'] : array();\n     $args['product_cat__not_in'][] = 2053;\n     $args['product_cat__not_in'][] = 924;\n     return $args;\n },\n 10,\n 2\n);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406910", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Serving Images from subdomain in wordpress This is my current image url\nhttps://example.com/wp-content/uploads/2022/06/sample.png served via cloudflare\nuploads folder is in my wordpress installation\nI am syncing the uploads folder to Backblaze B2 bucket and have cloudflare url static.example.com pointing to backblaze bucket and i  have url rewrite rule to access the image via https://static.example.com/2022/06/sample.png\nNow i want to serve the images from static.example.com but want to keep managing the media via wordpress locally so i will have full copy both locally as well as backblaze B2 but all images will be served by backblaze B2.\nI am not sure which setting i have to change in wordpress\nThe only reason i am making 2 copies is because wordpress keeps the good job of making multiple copies of images and nice media manager to select images\n\nA: You can fetch images (All types of media Items) that are hosted somewhere with a plugin External Media without Import\nBy using this plugin you don't require to upload media items to your wp site locally because you can fetch them directly from other sources. I used this app before and it's work excellent for me. Thank You\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406911", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Gutenberg block - remove setting for core/file I want to remove this setting from the core block \"file\":\n\nI've tried to do this in theme.json\n{\n\"version\": 2,\n\"settings\": {\n    \"blocks\": {\n        \"core/file\": {\n            \"showDownloadButton\": false\n        }\n    }\n}\n\n}\nBut it doesn't work. Anybody know how to accomplish this? I feel like the documentation for all things Gutenberg is a bit lackluster? Or maybe I'm just bad at finding what I want.\n\nA: Not sure if you were able to get this working, but i did this using the\nregister_block_type_args filter in our functions.php\n function show_download_button( $settings, $blockname ) {\n    \n        // Check for block type.\n        if ( $blockname !== 'core/file' ) {\n    \n            return $settings;\n        }\n    \n        $downloadbutton = [\n            'type'    => 'boolean',\n            'default' => false,\n        ];\n    \n        $settings['attributes']['showDownloadButton'] = $downloadbutton;\n    \n        return $settings;\n    }\n    \n    \n    add_filter( 'register_block_type_args', 'show_download_button', 10, 2 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406912", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: User media folder for each users on registration i need to create a \"user folder\" in media library for user registration using usermeta field, for example \"billing_company\".. so, my purpose is to procect file url inside that folder from unlogged users and logged users with different usermeta field/email..\nsomeone please can help me with snippet?\nthanks you\nfunction create_user_dir($user_id) {\n$user_info = get_userdata( $user_id );\n\n$upload_dir = wp_upload_dir();\n$user_dir = $upload_dir['basedir'] . '/user_dirs/' . $user_info->billing_company;\n\nwp_mkdir_p($user_dir); }\n add_action( 'user_register', 'create_user_dir');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406913", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to allow slash(/) on page url Suppose, a url of my wordpress website page is domain.com/journal-submission. How to change the url like domain.com/journal/submission.\nWhen I rename the permalink, give slash(/) instead of dash(-) it's not changing anything. I just want to change some of my page url keeping the same permalink settings.\nNow the permalink is set to post-name [https://theiacs.org/sample-post/].\n\nA: You can set the slug to submission then create a parent page named journal\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406917", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Unable to locate inline CSS causing parts of page to be blank Large parts on a live Wordpress page shows blank because a piece of inline CSS has opacity set to 0. Unfortunately I am unable to find where this inline CSS lives.\n<div class=\"grve-element grve-text vc_custom_1655582827387\">\n    <div class=\"ptsTableFrontedShell\">\n    <!-- Style to display all tables correct-->\n    <!-- this block will be remove in frontend.tables.editor.block.base after init -->\n    <div class=\"ptsPreDisplayStyle\">\n        <style>\n            .ptsBlock {\n                opacity: 0;\n                visibility: hidden;\n            }\n        </style>\n\nvc_custom refers to Visual Composer which apparently now is WPBakery. Given that information I looked into the Row, Column and Text Block settings when editing the page with WPBakery but couldn't find any custom CSS.\nRegarding ID 1655582827387, I have no clue where to start searching for this ID. Lastly, it's unclear to me where the class ptsBlock comes from.\n\nA: Finding inline CSS can be a right pain.\nIn your case, the problem is visibility: hidden; which means nothing is going to show up. You could add your own custom CSS and override it with the !important rule.\nSo, for example, you could put this somewhere in the header. Most themes have a custom CSS section in the customize menu - that might be best.\n .ptsBlock {\n      opacity: 1 !important;\n      visibility: visible !important;\n }\n\nThis works by raising the priority of your CSS over the CSS that does not have the rule.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406918", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is there a way to create folders restricted to specific users to open? I am working on a business website where users can purchase downloadable report packages. These reports come with multiple files (4 total) for the user to download after they purchase. There is a page on the site where these documents are supposed to show up for them to download after they purchase them. As of right now, I have had to individually code the restricted user access to each of the included 4 files separately. I have been doing this by adding all of the users' user_ids to a \"user_id = ...\" code and specifying the file with \"wpdm_package id = ...\". And I have to do this 4 times for each different file. Basically, I want to know if there is a way to restrict access to an entire folder that contains all 4 files inside of it. Thank you!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406919", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to change CPT single post slug I need to automatic change slug for all CPT posts. I want it written backwards.\nFor example:\n\n*\n\n*Post title: My super post 1\n\n*Default post title slug: my-super-post-1\n\n*Post title slug after automatic change: 1-tsop-repus-ym\n\nI know it's unusual. How can I achieve this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406921", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Admin ajax error 400 when passing select value to populate another select This is my first attempt to write a plugin and I get an error 400 when trying to use admin-ajax.php. I've looked through some topics both here and in the WordPress support forum, but cannot figure it out.\nWhat I am trying to do is dependant drop-down select. I.e. you chose an option from select #1, then it has to be passed via ajax to populate the second dropdown. To make it simple (for now), everything is on my \"frontend\" file.\nHere is my code:\n\n        <div class=\"row\">\n            <select class=\"cat-select\" name=\"lvl1\" id=\"lvl1\">\n                <option value=\"\">-- select category --</option>\n                <?php\n                foreach ($this->getTopLevelCategories() as $category) {\n                    print '<option value=\"' . $category->term_id . '\">' . $category->name . ' (' . $category->count . ')</option>';\n                }\n                ?>\n            </select>\n        </div>\n\n        <script type=\"text/javascript\">\n            jQuery(document).ready(function () {\n                jQuery('#lvl1').change(function () {\n                    var lvl1Val = jQuery('#lvl1').val();\n                    jQuery('#lvl2').empty();\n                    jQuery.ajax({\n                        url: \"<?php bloginfo('wpurl'); ?>/wp-admin/admin-ajax.php\",\n                        method: 'POST',\n                        data: {\n                            'action':'getLVl2',\n                            'lvl1' : document.getElementById('lvl1').value\n                        },\n                        success: function(response, status) {\n                            jQuery('#lvl2').append(response);\n                            alert(response);\n                            console.log(response);\n                        },\n                        error: function(errorThrown){\n                            console.log(errorThrown);\n                        }\n                    });\n                });\n            });\n        </script>\n\n        <div class=\"row\">\n            <select class=\"cat-select\" name=\"lvl2\" id=\"lvl2\">\n                <option value=\"\" disabled selected>-- select category lvl2 --</option>\n            </select>\n        </div>\n\n        <?php\n\n        function getLVl2()\n        {\n            if (isset($_POST['lvl1'])) :\n\n                $parent = $_POST['lvl1'];\n\n                $option = '<option value=\"' . $parent . '\">';\n                $option .= $parent;\n                $option .= '</option>';\n\n                echo $option;\n\n                wp_die();\n\n            endif;\n        }\n\n        add_action('wp_ajax_getLVl2', 'getLVl2');\n        add_action('wp_ajax_nopriv_getLVl2', 'getLVl2');\n        ?>\n\n\nNote:\n\n*\n\n*The code in the function will be changed. What I am trying to do is output the value of the option selected from the first dropdown just to see that it works.\n\n*The function and the script will be moved to their places to \"keep the code clean\"\n\n\nA: This may not definitively answer the question, but I hope this helps you in finding the most appropriate solution. And actually, I've tried the super simple plugin at the bottom with your HTML and JS, and everything worked fine for me.\n\nThis is my first attempt to write a plugin and I get an error 400 when trying to use admin-ajax.php\n\nThese are the common reasons why would admin-ajax.php return a 400 error (or a HTTP status of \"400 Bad Request\") and then display a 0:\n\n*\n\n*Your AJAX action was never registered or it's registered late.\n\n\n*Your JS script or AJAX request did not include the correct action value, i.e. the part after wp_ajax_ and wp_ajax_nopriv_.\n\n\n*The current user is not logged-in and your AJAX action was registered only for logged-in users.\nOr the other way round \u2014 the user is logged-in, but your AJAX action was only for non logged-in users.\nAnd in your case, where the AJAX action is getLVl2, the 400 error was likely due to reason #1 above, because your JS is sending the correct action and it's also registered for both logged-in and non logged-in users, i.e. you hooked on both wp_ajax_getLVl2 and wp_ajax_nopriv_getLVl2.\nSo you'd just need to ensure you are calling add_action() at the right time, e.g. in the main plugin file like so (which should be located at wp-content/plugins/my-plugin/my-plugin.php):\n<?php\n/*\n * Plugin Name: My Plugin\n */\n\nfunction getLVl2() {\n//  echo 'test';\n    echo '<option>test</option>';\n    wp_die();\n}\nadd_action( 'wp_ajax_getLVl2', 'getLVl2' );        // for logged-in users\nadd_action( 'wp_ajax_nopriv_getLVl2', 'getLVl2' ); // for non logged-in users\n\nNow try, using your browser, visiting https://example.com/wp-admin/admin-ajax.php?action=getLVl2 and check if the test is displayed on the page.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406924", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Get uploaded attachment width & height and attachment ID after upload them I will explain my requirement here. Im trying to redirect window to wordpress image editor once image is uploaded via wordpress image upload window. also this redirection should only happen if image size is over 5MB or image width and heigh is over 3999px.\nIt seems there is no filters/hooks available which fire right after image is uploaded. but I found possible way to fire a javascript using \"wp-plupload.js\"\n    wp.Uploader.queue.on('reset', function() { \n    alert('Upload Complete!');\n});\n\nCurrently this alert is coming up when image upload is completed.\nWhat I need to know is, is there a way where I can get the attachment ID and check attachment size?\nReally appreciate the help in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406926", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Button and Countdown overlapping mobile menu Trying to get around an issue for some time now but can't figure out why the youtube play button and countdown are above my mobile navigation.\nTried z-index but can't find anything else that might help.\nEdit: Found the issue. for some reason the z-index for the main body wasnt set.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406927", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Checking page before applying image restrictions while uploading so users can upload images on my website and I want to put some restrictions on these images while they are uploading. The catch is that these image restriction can only apply on one page, being the edit product page and also the user has to be a vendor.\nI already tried checking by template and ID of the page but this page lives below a parent page and that did not work, meaning that the function could not check the current page.\nI currently have the code below but now it is rejecting all images and not displaying the correct message, just a general message that uploading the image failed. Anyone that can help me out?\nfunction resize_image_resolution($file) {\nif (is_user_wcmp_vendor(get_current_user_id()) && isset($_SERVER['REQUEST_URI']) && false !== strpos( $_SERVER['REQUEST_URI'], 'edit-product' ) ) {\n    $image = getimagesize($file['tmp_name']);\n    $minimum = array(\n        'width' => '1080', //set your minimum\n        'height' => '1080'\n    );\n    $maximum = array(\n        'width' => '12000', //set your maximum\n        'height' => '12000'\n    );\n    $image_width = $image[0];\n    $image_height = $image[1];\n\n    $too_small = \"Image dimensions are too small.\";\n    $too_large = \"Image dimensions are too large.\";\n\n    if ( $image_width < $minimum['width'] || $image_height < $minimum['height'] ) {\n        $file['error'] = $too_small;\n        return $file;\n    } elseif ( $image_width > $maximum['width'] || $image_height > $maximum['height'] ) {\n        $file['error'] = $too_large;\n        return $file;\n    } else {\n        return $file;\n    }\n  }\n} \nadd_filter('wp_handle_upload_prefilter', 'resize_image_resolution')\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406931", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Connect a membership plugin to an external database I'm looking for a way to connect a WP membership plugin to an external database.\nWe have a magazine (print) with paid and free subscriptions and we have a website which anyone can view. The idea is to make a part of the website only available to those who have a paid subscription for the magazine.\nThe subscribers for the magazine are in an external database. So every time somebody logs in and wants to view a 'members only' article, the plugin should go to the external database and check if the person in question has a paid subscription.\nIf the answer is yes, the article is shown, if the answer is no, then a possibility to subscribe is offered.\nAny help in pointing me in the right direction would be appreciated. Please bear in mind that I'm no database expert. I'm hoping that there's a plugin out there that can do the job.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406935", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Theme Customizer performance drops when adding a lot of settings I maintain a plugin in which we currently add ~730 settings to the Theme Customizer. We use a few custom controls for panels, sections and settings and loading the preview is a very painful experience since the page can take between 15 and 60 seconds to load, depending on the server. When using the refresh transport method, changing a setting will cause another wait for 3-10 seconds, again depending on the server. Thats why for one thing I plan to migrate to the postMessage transpor method.\nHowever, this seems to be a bit abnormal in general to me so I created a very simple plugin that only adds 750 text field settings and even this super simple thing will drastically increase the loading time of the theme customizer:\n<?php\n/*\nPlugin Name: Test\n*/\n\nadd_action('customize_register', function ($wp_customize) {\n    $panels = 5;\n    $sections = 5;\n    $settings = 30;\n    for ($i = 1; $i <= $panels; $i++) {\n        $wp_customize->add_panel(\"test_{$i}\", array(\n            'title' => \"test_{$i}\",\n            'description' => 'Lorem Ipsum',\n        ));\n    \n        for ($j = 1; $j <= $sections; $j++) {\n            $wp_customize->add_section(\"test_{$i}_{$j}\", array(\n                'title' => \"test_{$i}_{$j}\",\n                'panel' => \"test_{$i}\",\n            )); \n\n            for ($k = 1; $k <= $settings; $k++) {\n                $wp_customize->add_setting(\"test_{$i}_{$j}_{$k}\", [\n                    'type' => 'option',\n                    'capability' => 'manage_options',\n                    'default' => 'test',\n                ]);\n            \n                $wp_customize->add_control(new \\WP_Customize_Upload_Control($wp_customize, \"test_{$i}_{$j}_{$k}\", [\n                    'type' => 'text',\n                    'section' => \"test_{$i}_{$j}\",\n                    'settings' => \"test_{$i}_{$j}_{$k}\",\n                    'label' => \"Test {$i}_{$j}_{$k}\",\n                    'description' => 'Lorem Ipsum',\n                ]));\n            }\n        }\n    }\n});\n\nNow I'm wondering if I'm doing something wrong or if this is simply how WordPress implements it. Maybe the Theme Customizer is not made to have hundreds or even thousands of settings in it.\nHas anybody any idea on how to improve the loading speed of the customizer using the code above as a baseline?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406936", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Settings API unable to save settings So I can't seem to get the Settings API to save a field properly, I feel like I've followed ever single step, but I'm having no luck, so I wanted to reach out and see if someone might be able to spot anything that I might be doing wrong.\nWhenever I input something in the field and I click on \"Save Settings\", it just refreshes and nothing get written to the database nor does it input anything into the field.\nThis is how the form looks on the backend:\n\nThis the output of the form:\n\nThis is the code:\nclass FH_Pardot_Settings\n{\n    private static string $option_group = 'pardot_settings';\n    private static string $page = 'pardot';\n\n    /**\n     * Fields for Settings API\n     *\n     * @var array\n     */\n    private static array $fields = [\n        'client_id' => '',\n        'submit' => ''\n    ];\n\n    public function __construct()\n    {\n        if (is_admin()) {\n            add_action('admin_init', [$this, 'admin_init']);\n            add_action('admin_menu', [$this, 'admin_menu']);\n        }\n    }\n\n    public function admin_menu()\n    {\n        $title = __('Pardot', 'pardot');\n        add_options_page(\n                $title,\n                $title,\n                'manage_options',\n                self::$page,\n                [$this, 'settings_page']\n        );\n    }\n\n    /**\n     * Register API Credentials Settings\n     */\n    public function admin_init(): void\n    {\n        self::$fields = [\n            'client_id' => [__('Consumer Key', 'pardot'), ''],\n            'submit' => '',\n        ];\n        register_setting(\n                self::$option_group,\n                self::$option_group,\n        );\n        add_settings_section(\n                self::$option_group,\n                __('Pardot Settings', 'pardot'),\n                [$this, 'user_account_section'],\n                self::$page\n        );\n\n        foreach (self::$fields as $name => $array) {\n            $title = $array[0] ?? null;\n            $class = $array[1] ?? null;\n            add_settings_field(\n                    $name,\n                    $title,\n                    [$this, \"{$name}_field\"],\n                    self::$page,\n                    self::$option_group,\n                    $class\n            );\n        }\n    }\n\n    public function user_account_section(): void\n    {\n        $msg = __('Use the below section to input settings for the Pardot API', 'pardot');\n        echo \"<span id=\\\"instructions\\\">{$msg}</span>\";\n    }\n\n    public function settings_page()\n    {\n        $html = <<<HTML\n                <form action=\"options.php\" method=\"post\">\n                HTML;\n        echo $html;\n\n        settings_fields(self::$option_group);\n        do_settings_sections(self::$page);\n\n        echo \"</form>\";\n    }\n\n    private function get_html_name($field_name)\n    {\n        return self::$option_group . \"[{$field_name}]\";\n    }\n\n    public function client_id_field()\n    {\n        $client_id = get_option('pardot_client_id');\n        $html_name = $this->get_html_name('pardot_client_id');\n        $msg = __('Input the consumer key', 'pardot');\n        $html = <<<HTML\n                <div id=\"client-id-wrap\">\n                    <input type=\"text\" size=\"30\" id=\"pardot_client_id\" name=\"pardot_client_id\" value=\"{$client_id}\" />\n                    <p>{$msg}</p>\n                </div>\n                HTML;\n        echo $html;\n    }\n\n    public function submit_field()\n    {\n        $value = __('Save Settings', 'pardot');\n        $html = <<<HTML\n                <input type=\"submit\" class=\"button-primary\" name=\"save\" value=\"{$value}\" />\n                HTML;\n        echo $html;\n    }\n}\n\nnew FH_Pardot_Settings();\n\n\nA: The <input> generated by your client_id_field() function is using the wrong name which is pardot_client_id, and by \"wrong\", I mean there's no database option registered with that name and the one you've registered is named pardot_settings.\n\n*\n\n*The database option is the second parameter for register_setting().\n\n\n*And it should be used in the name attribute of form fields like <input> and <select>, e.g. <input name=\"DATABASE OPTION NAME\">.\nSo looking at your class, you should have used <input type=\"text\" size=\"30\" id=\"pardot_client_id\" name=\"{$html_name}\" value=\"{$client_id}\" /> there.\nAnd then get the saved option like so:\n// Get all settings in the option array.\n$options = (array) get_option( self::$option_group );\n\n// Get the pardot_client_id setting.\n$client_id = $options['pardot_client_id'] ?? '';\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406937", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to save HTML data into SQL post_content column I have a custom template file containing some HTML tags and get_post_meta function. I want to insert the HTML data into post_content column. Is there a wordpress function or SQL function to save into post_content column? I couldn't find a good anwswer on the internet.\n This is my custom template file.\n<?php\n    // the post name is cryto name.\n    $cryto_name = get_the_title();\n\n    // Cryto Variables from SQL table\n    $ccf_company = get_post_meta( get_the_ID(), 'ccf_company', true );\n    $ccf_jurisdiction = get_post_meta( get_the_ID(), 'ccf_jurisdiction', true );\n    $ccf_symbol = get_post_meta( get_the_ID(), 'ccf_symbol', true );\n    $ccf_maximum_supply = get_post_meta( get_the_ID(), 'ccf_maximum_supply', true );\n\n?>\n\n<h2>Features of <?php echo $cryto_name ?></h2>\n\n<figure class=\"ht-post__content table\">\n    <table>\n        <thead>\n            <tr>\n                <th>Features</th>\n                <th class=\"has-text-align-center\" data-align=\"center\"><?php echo $cryto_name ?> (<?php echo $ccf_symbol ?>)</th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr>\n                <td>Developer</td>\n                <td class=\"has-text-align-center\" data-align=\"center\"><?php echo $ccf_company ?></td>\n            </tr>\n            <tr>\n                <td>Country</td>\n                <td class=\"has-text-align-center\" data-align=\"center\"><?php echo $ccf_jurisdiction ?></td>\n            </tr>\n            <tr>\n                <td>Symbol</td>\n                <td class=\"has-text-align-center\" data-align=\"center\"><?php echo $ccf_symbol ?></td>\n            </tr>\n            <tr>\n                <td>Max Supply</td>\n                <td class=\"has-text-align-center\" data-align=\"center\"><?php echo check_max_supply($db_coin_max_supply, $ccf_symbol) ?></td>\n            </tr>\n    </table>\n</figure>\n\nI already made a sql table and this template is working. However, I'm trying to save this HTML output into post_content column.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406940", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Plugin- How to Insert Html&JS code in specific Page and specific Div I have some Html& js code relating to this dropbox button by WordPress plugin\n1- I want to insert the button in a specifc page for example I have sample page and Sec Page I want to specifiy the page because it's in all the pages\n2- When I install the plugin always appears in the beginning of the website so How to make it in a spcific div for example in the page I'll select\n\nI'm using add_action() function it works but as I mentioned appears in every page and in the beginning\n    function hook_html()\n    {\n    ?>\n\n\n <script type=\"text/javascript\" src=\"https://www.dropbox.com/static/api/2/dropins.js\" id=\"dropboxjs\"\n     data-app-key=\"XXXXXXX\"></script>\n\n\n <div id=\"dropboxContainer\">hellodrooppp</div>\n\n...............\n  }\n\n  add_action('wp_head', 'hook_html');\n\n\nA: As you want to insert the button on only one/few specific pages you can simply create a shortcode[Reference] and insert it on specific page/pages.\nYour code will be something like:\nfunction hook_html(){\n     //function body\n}\nadd_shortcode( 'dropbox_button', 'hook_html' );\n\nAnd then just edit the specific pages and add the shortcode [dropbox_button] to them, you can also choose to add this in any section of the page that you want.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406941", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Convert GMT time to local time in Gutenberg Block Editor I'm wondering if I can use any of the functions listed in the @wordpress/date package to convert a GMT date to a date in the user's locale.\nFor example, this GMT datetime 2023-06-20 17:46:00 would be 2023-06-20 19:46:00 in Europe/Vienna (GMT+2), the timezone I configured in Settings/General.\nConverting the latter to the first is fairly simple via gmdate('Y-m-d H:i:s','2023-06-20 19:46:00'), but is there a WordPressy way to do it vice versa instead of having to use moment?\n\nA: \nI'm wondering if I can use any of the functions listed in the\n@wordpress/date\npackage to convert a GMT date to a date in the user's locale.\n\nYes, you can use the dateI18n() function.\nHowever, the source date (i.e. the 2nd parameter for the above function) by default uses the time zone of the user's device, so the source date should include the time zone even if it's UTC/GMT (+00:00). Secondly, the date should be a valid RFC2822 or ISO date as documented here, e.g. an ISO 8601 date like 2023-06-20T17:46:00Z.\nAnd for UTC dates, you could simply make use of the moment.utc() function, e.g. moment.utc( '2023-06-20 17:46:00' ).\nSo here are some examples on using dateI18n(), that were tried & tested working with WordPress v6.0 and the Europe/Vienna time zone or UTC +02:00:\n\n*\n\n*Example 1 \u2014 Convert from UTC to whatever the site's time zone or UTC offset:\nconst date1 = dateI18n( 'Y-m-d H:i:s P', moment.utc( '2023-06-20 17:46:00' ) );\n// Sample output: 2023-06-20 19:46:00 +02:00\n\nconst date2 = dateI18n( 'l, F d, Y @ H:i:s P', moment.utc( '2023-06-20 17:46:00' ) );\n/* Sample output based on the user's/site's locale:\n * English  - Tuesday, June 20, 2023 @ 19:46:00 +02:00\n * Italiano - marted\u00ec, Giugno 20, 2023 @ 19:46:00 +02:00\n * Korean   - \ud654\uc694\uc77c, 6\uc6d4 20, 2023 @ 19:46:00 +02:00\n */\n\n\n\n*Example 2 \u2014 Convert from a specific UTC offset (e.g. +03:00) to whatever the site's time zone or UTC offset:\nconst date1 = dateI18n( 'Y-m-d H:i:s P', '2023-06-20T17:46:00+03:00' );\n// Sample output: 2023-06-20 16:46:00 +02:00\n\n\n\n*Example 3 \u2014 Convert from UTC to a specific UTC offset (e.g. -04:00) or time zone (e.g. America/New_York):\nconst date1 = dateI18n( 'Y-m-d H:i:s P', moment.utc( '2023-06-20 17:46:00' ), '-04:00' );\nconst date2 = dateI18n( 'Y-m-d H:i:s P', moment.utc( '2023-06-20 17:46:00' ), 'America/New_York' );\n// Sample output of date1 and date2 above: 2023-06-20 21:46:00 +04:00\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406945", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Hide Status Option From WordPress Publish Metabox and Rename Published on: I want to hide Status option on publishbox and rename Published on to Date Created for Custom post post_type like you see in red on the below picture.\n\n\nA: Both those strings seem to be located in wp-admin/includes/meta-boxes.php. They don't have any filters attached to them, so they're not meant to be (easily) altered by your code.\nHowever, both those strings are internationalized (ie, run through a translation function) to allow WordPress's interface to be translated into languages other than English. The i18n functions\u2014__() and _e()\u2014both use translate(), which provides a filter, gettext, that you can use to control what is displayed.\nCaveats:\n\n*\n\n*This may adversely affect the translatability of your plugin.\n\n*If WordPress ever changes the strings used in these locations, your filter will no longer work.\n\nWith that in mind, this code should be a good starting point.\nadd_filter( 'gettext', 'wpse406946_change_meta_strings', 10, 3 );\n\n/**\n * Change the \"Published On:\" string and remove the \"status: \" line from \n * my CPT's meta box.\n *\n * @param  string $translation The translated string.\n * @param  string $text        The original string.\n * @param  string $domain      The current text domain.\n * @return string              The filtered translated text.\n */\nfunction wpse406946_change_meta_strings( $translation, $text, $domain ) {\n    // Checks for the custom post type.\n    if ( 'my_post_type' === get_post_type() && 'default' === $domain ) {\n        // Unhooks the filter to prevent infinite loops.\n        remove_filter( 'gettext', 'wpse406946_change_meta_strings', 10, 3 );\n        if ( 'Published on: %s' === $text ) {\n            $translation = __( 'Created on: $%s', $domain );\n        }\n        // The \"Status: Published\" message is actually 2 parts.\n        // This should catch both.\n        if ( 'Status:' === $text || 'Published' === $text ) {\n            $translation = '';\n        }\n\n        // Rehooks the filter.\n        add_filter( 'gettext', 'wpse406946_change_meta_strings', 10, 3 );\n    }\n\n    return $translation;\n}\n\nReferences\n\n*\n\n*__()\n\n*_e()\n\n*gettext filter\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406946", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Single Parent post having children's posts I wanna create Custom Post which can have unlimited child posts.\nBut problem is when I am on child post and I want to let child post know that there is another next child post of same parent.\nHere is diagram of what I want to create.\n/custom-post-book/ \n    custom-post-book/chapter-1/\n    NextButton(custom-post-book/chapter-2)\n\nThis is my first time posting sorry for wrong english.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406949", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: phpmailer reply to message id using AddCustomHeader trying to reply a message by using phpmailer class\n,i added custom header\n$mail->AddCustomHeader('References',$messageid);\n$mail->AddCustomHeader('In-Reply-To',$messageid);\n\nmessage send with the insert headers but it's creating a new message not replying to the original one\nSO how can i force it to reply the original message with RE:\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406953", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to let users upload their custom cover image I have a dashboard for users (one page using elementor and buddyboss to change stuff like name profile pic etc). I want users to be able to upload a custom cover image. I found some code that almost works\n<input type=\"file\" id=\"image-input\" accept=\"image/jpeg, image/png, image/jpg\">\n<div id=\"display-image\"></div>\n\n<style>\n#display-image{\n  width: 400px;\n  height: 225px;\n  border: 1px solid black;\n  background-position: center;\n  background-size: cover;\n}\n</style>\n\n<script>\nconst image_input = document.querySelector(\"#image-input\");\n\nimage_input.addEventListener(\"change\", function() {\n  const reader = new FileReader();\n  reader.addEventListener(\"load\", () => {\n    const uploaded_image = reader.result;\n    document.querySelector(\"#display-image\").style.backgroundImage = `url(${uploaded_image})`;\n  });\n  reader.readAsDataURL(this.files[0]);\n});\n</script>\n\nThe issue is that it doesn't save so you have to put the image in every time the page reloads. There might also be an issue of changing the whole page instead of per user but I can't test that right now\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406954", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Modifying request $_COOKIE I have setup some conditional logic within a WP theme to display certain sections based a cookie value.\nI am trying now add some logic to override that cookie value in the request itself, based on a URL parameter.\nThe point being, that if the cookie exists, the normal conditional logic follows, but if the URL parameter exists, then the cookie should be changed BEFORE WP processes anything (but also ideally, before the server processes it*)\nQ1: I currently have a working solution for WP, but I think it is using some bad practice (directly modifying superglobals) and I'd like to know if there is a better approach.\nQ2: I would also like to know if there is a way to catch the request much earlier, like perhaps some way to do this in htaccess, so that LS Cache can serve the correct cached version based on a cookie cache vary.....\nI am using Litespeed and will setup a vary cache based on the cookie, but I dont think this will work with my current solution as I'm only changing the cookie once it gets to WP - I believe Litespeed would have already served the cached version.\nThis is what I'm currently doing - pretty simple.\nadd_filter('parse_request', 'maybe_set_dynamic_state_cookie');\n\nfunction maybe_set_dynamic_state_cookie() {\n\n    if (isset($_GET['state'])) {\n\n        $valid_states = array('QLD', 'NSW', 'VIC', 'SA', 'WA', 'NT', 'ACT', 'TAS');\n\n        $state = strtoupper( $_GET['state'] );\n\n        if(in_array($state, $valid_states) ) {\n            $_COOKIE['dynamicDataState'] = $state;\n        }\n    \n    }\n}\n\nSo the server may receive for example the following request:\n:method: GET\n:path: /students/?state=vic\n:scheme: https\ncookie: dynamicDataState=NSW\n...\n\nwhere URL parameter is different from submitted cookie. In this case, before anything happens it should be updated to:\n:method: GET\n:path: /students/?state=vic\n:scheme: https\ncookie: dynamicDataState=VIC\n...\n\nThis is what currently occurs with the above function, but only once WP gets to it... I think LSChache would have already served the dynamicDataState=NSW cached version.\nIt is of less importance to the question here, but I am also doing the following to update the response headers so the users browser is updated to match the modified request change.\nadd_action( 'init', 'set_dynamic_state_cookie' );\n\nfunction set_dynamic_state_cookie() {\n    if (isset($_GET['state'])) {\n\n\n\n        $valid_states = array('QLD', 'NSW', 'VIC', 'SA', 'WA', 'NT', 'ACT', 'TAS');\n\n        $state = strtoupper( $_GET['state'] );\n\n        $name = 'dynamicDataState';\n\n        if(in_array($state, $valid_states) ) { \n            setcookie( $name, $state, time() + 3600, \"/\", COOKIE_DOMAIN );\n        }\n       \n    }\n}\n\nUPDATE\nI've got bit further with this and worked out that I can in fact use an htacess rewrite rule to change the cookie. ...I think it's working with LSCache and the conditional logic...\nI'm sure it could be written more cleanly though and I still need to get a response header cookie sent back...\nRewriteEngine on\nRewriteCond %{QUERY_STRING} state=qld\nRewriteRule ^(.*)$ - [CO=dynamicDataState:QLD:/:3600]\nRewriteCond %{QUERY_STRING} state=new\nRewriteRule ^(.*)$ - [CO=dynamicDataState:NSW:/:3600]\nRewriteCond %{QUERY_STRING} state=vic\nRewriteRule ^(.*)$ - [CO=dynamicDataState:VIC:/:3600]\nRewriteCond %{QUERY_STRING} state=wa\nRewriteRule ^(.*)$ - [CO=dynamicDataState:WA:/:3600]\nRewriteCond %{QUERY_STRING} state=sa\nRewriteRule ^(.*)$ - [CO=dynamicDataState:SA:/:3600]\nRewriteCond %{QUERY_STRING} state=tas\nRewriteRule ^(.*)$ - [CO=dynamicDataState:TAS:/:3600]\nRewriteCond %{QUERY_STRING} state=nt\nRewriteRule ^(.*)$ - [CO=dynamicDataState:NT:/:3600]\nRewriteCond %{QUERY_STRING} state=act\nRewriteRule ^(.*)$ - [CO=dynamicDataState:ACT:/:3600]\n\nTo add some more info:\n\n*\n\n*Users are initially using a drop down select to choose a 'state', this triggers a script that adds the cookie initially and then reloads the page so they see their state specific information on that page and the rest of the site.\n\n*I have a cache vary setup for this cookie in LSCache so the correct pages are served to users with the cookie set.\n\n*Once the page is cached, then WP is completely bypassed so any logic I put in there to change the cookie based on URL doesnt work, nor does sending a new cookie back in the response header\n\n*The above starting point for my htacess solution seems to work so far, but does not send a new cookie header response back so the user still has the old cookie in their browser. I need to resolve this?\n\nSo new questions:\nIs there a cleaner, more concise way to write the above rewrite?\nIs there a way to also conditionally send a response header back even when a cached page is served?\n...OR is there a bette way in general to achieve this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406955", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: delete_user_meta from a foreach results page I have a real estate site.  On property pages users can save homes as a favorite.  The property gets added to the user meta data.  I can successfully add and delete entries from the single property page with no issues.\nI have \"view favorites\" page that displays all saved homes. I'd like users to be able to remove saved homes from this page.  My issues is the homes are being displayed in a foreach and if you choose to remove one home...all homes end up being removed.  I'm sure my issue is that the foreach is looping the delete_user_meta function but I can't figure out how to set it up correctly.\nEach property has an array of entries (bed / bath / price / etc).  I'm assuming I need to POST the array and use the posted array in the delete function but I can't figure it out.\nMy code:\n<?php\n$user_id = get_current_user_id(); //Get current user ID\nglobal $current_user; wp_get_current_user();\n$user_id = $current_user->ID;\n$meta = get_user_meta($user_id, 'savedhome');\n?>\n<div class=\"row\"> <!--defines and displays each result successfully-->\n<?php foreach ($meta as $key => $value) { ?>\n    <?php\n        foreach($value as $k1 => $v1) {\n\n        if ($k1 == 'Beds'){\n        $k1beds = $v1;\n        }// end if beds\n        \n        if ($k1 == 'Baths'){\n        $k1bath = $v1;\n        }// end if baths\n        \n        if ($k1 == 'Price'){\n        $k1price = $v1;\n        }// end if Price \n        }//end foreach value as k1 v1\n    ?>\n        <div class=\"favprice\">\n        <?php echo \"$$k1price\";?>\n        </div>\n        <div class=\"favbed\">\n        <?php echo \"$k1beds\";?>\n        </div>\n        <div class=\"favbath\">\n        <?php echo \"$k1bath\";?>\n        </div>\n </div><!-- close row --> \n<?php\necho '<pre>' , var_dump($value) , '</pre>';  //displays correct array for each home \n\nif(isset($_POST[\"Remove\"])){\n    delete_user_meta($user_id, 'pluginlink', $value);\n}//end if \n\n//Below will determine if home exists in user meta and display the correct save/delete button\n$meta = get_user_meta($user_id, 'savedhome'); \nif(array_search($k1price, array_column($meta, 'Price')) !== false) {\n    $savebutton = \"display: none;\";\n    $deletebutton = \"display: block;\";\n}\nelse {\n    $savebutton = \"display: block;\";\n    $deletebutton = \"display: none;\";\n}\n?>\n<div class=\"buttondisplay\" style=\" <?php echo $savebutton; ?> \">\n    <form method=\"post\" enctype=\"multipart/form-data\">\n        <button type=\"submit\" name=\"submit\" style=\"background-color: #fff; padding-left:3px;\" ><i class=\"fa fa-heart-o\" aria-hidden=\"true\" ></i></button>\n    </form>\n</div><!-- end save button -->\n<div class=\"deletebutton\" style=\" <?php echo $deletebutton; ?> \">\n    <form method=\"post\" enctype=\"multipart/form-data\" >\n            <button type=\"submit\" name=\"Remove\" value=\"<?php echo $k1mlsid; ?>\" style=\"background-color: #fff; padding-left:3px;\"><i class=\"fa fa-heart\" aria-hidden=\"true\" ><?php echo $loginouttext; ?></i></button>\n    </form>\n</div><!-- end delete button -->\n<?php } //end foreach meta as key value\n?>\n\n\nA: This is such a convoluted way of doing this. You should separate the delete_user_meta call from the foreach entirely and put type=\"hidden\" inputs in the form with the rest of the data you need.\nif(isset($_POST[\"Remove\"])){\n    delete_user_meta(get_current_user_id(), 'pluginlink', $_POST[\"value\"]);\n}//end if \n\nForm\n<form method=\"post\" enctype=\"multipart/form-data\" >\n  <button type=\"submit\" name=\"Remove\" value=\"<?php echo $k1mlsid; ?>\" style=\"background-color: #fff; padding-left:3px;\"><i class=\"fa fa-heart\" aria-hidden=\"true\" ><?php echo $loginouttext; ?></i></button>\n  <input type=\"hidden\" name=\"value\" value=\"<?php echo $value; ?>\">\n</form>\n\nAnother way of tackling this would be to not use forms at all. Instead you use a link, like <a class=\"deletebutton\" href=\"/?user-updates=remove&value=data\">. Then you create a script to handle these queries.\nif (isset($_GET['user-updates']) && $_GET['user-updates'] == 'remove') {\n  delete_user_meta(get_current_user_id(), 'pluginlink', $_GET[\"remove\"]);\n}\n\nIt does the same thing with way less code, easier CSS, and easier AJAX in the future if you decide to add QOL improvements.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406956", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Offer Download Links for Product Images For a B2B shop, I would like to give customers the possibility to easily download product images.\nTo do this, I would like to display links for the product-specific images directly on the product pages.\nInserting the download links manually is not an option, as there are several hundred products with 3-4 images each.\nIs there a plugin or code snippet that can meet this requirement?\nA php codesnippet that returns the product specific image url's for example would be very useful.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406961", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Allow / show post comments in category pages Is there any way to allow the users of a website to write comments (and also see the already published comments) on one post when it's displayed in a category page?\nI'm not looking to let the category itself to be commented. I want the specific post to be commented without having to leave the category page.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406962", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hide Published text from custom post types column Is it possible to hide the 'Published' word only on custom post types column? as in image and just leave the date and time?\n\n\nA: WordPress has a filter for that..\nfunction wpse406965_remove_status( $status, $post, $column_name, $mode ) {\n    \n    //Get the post type. Replace YOUR_CPT with your CPT slug.\n    if ( $post->post_type == 'YOUR_CPT' ) {\n        return false;\n    }\n    return $status;\n}\nadd_filter( 'post_date_column_status', 'wpse406965_remove_status', 10, 4);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406965", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: custom post type, hide or disable the status line in publish meta box I have been adding a post type to my theme, how do I hide/disable the status line (All of it) as in image\n\n\nA: WordPress doesn't provide any filter/hook to override the existing HTML in post submit metabox. So, either you remove the entire metabox and add your own (which will be overkill in your case) or just hide it using CSS or remove that element using JS.\nfunction wpse406970_remove_publishing_actions() {\n    global $typenow;\n    if ( $typenow == 'YOUR_CPT' ) { ?>\n        <style>\n            .misc-pub-post-status {\n                display: none !important;\n            }\n        </style>\n        <script>\n            jQuery(document).ready(function($){\n                $('.misc-pub-post-status').remove();\n            });\n        </script>   \n    <?php }\n}\nadd_action( 'admin_head', 'wpse406970_remove_publishing_actions', 999 );  \n\nI recommend using both approaches as only JS might show a spalsh of the element before removing.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406970", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to remove slug from front page? I recently got the role of admin for my organization's website. Site is using WordPress 6.0, with plain permalink settings. I decided to change to pretty permalink.\nAfter changing to them, the homepage can't be accessed through the usual domain, domain.com/myorg, putting the error ERR_TOO_MANY_REDIRECTS. The homepage must be accessed with its slug, domain.com/myorg/home. I've read some fixes in other forums and I have made sure that the WordPress Address and Site Address are the same without any uppercase (domain.com/myorg)\nI want to keep the pretty permalinks while accessing the homepage directly from the domain, without its slug.\nThank you in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406972", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: First Image not loading on Mobile Version of Website I'm helping a friend with their website and I have came across a weird error. When the website is loaded on a mobile phone, the first image displayed does not show up. If you clink on the blank area, it activates the link that is connected with the picture. When the phone is rotated into Landscape mode though, the image shows up and shows up again back in Vertical mode. So in short, the first image doesn't show up in Mobile version when the website is loaded on the vertical version of a mobile phone. Here's the link to the site.\nhttps://bytessab.com\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406974", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Insert Custom Field Value I want to insert custom post type with it's custom fields values\nI have found this method to insert custom post type but with no custom fields\nwp_insert_post( array $postarr, bool $wp_error = false, bool $fire_after_hooks = true )\n\nBut the problem is on how to insert custom field values (that exists)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406978", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Prevent Wordpress from setting src on image added in Customiser I'm trying to apply custom data-src and srcset attributes to images added in Customiser. The page is static with no loop and I have so far hard coded the data-src attribute with <?php echo wp_get_attachment_url( get_theme_mod( 'hero_img' ) ); ?> so it will take the url of the image selected by the user.\nI presume adding srcset and sizes attributes could be done similarly, however I can't figure out how to unset the src attribute so that I can populate this using the value of data-src instead (for lazy loading). I've searched everywhere for an answer but all the solutions to similar problems involve the_content() or filters I don't have access to without a loop.\nSurely there has to be an easier way to get responsive images and custom attributes working with a static site that has customiser fields to change media?\nAny help would be massively appreciated, I'm probably going about this all wrong.\nMany Thanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406980", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I return only IDs from the `posts` REST endpoint? I have the following code:\nconst FORMS = document.querySelectorAll(\".search-form\");\n\nFORMS.forEach((form) => {\n    const INPUT  = form.querySelector(\".search-form__input\");\n    const BUTTON = form.querySelector(\".search-form__button\");\n\n    BUTTON.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n\n        wp.apiRequest({\n            path: \"wp/v2/posts\",\n            data: {\n                search: INPUT.value,\n            },\n        }).then(data => {\n            console.log(data);\n        });\n\n    }, { passive: false });\n});\n\nWP_Query allows you to specify \"fields\" => \"ids\" to return only the post IDs. I only need the IDs from this request, so in order to cut down on database queries, I'd like to apply this same setting to the request. Is there a way to specify this in the REST API? I've tried setting fields: \"ids\", in the data property, but that doesn't have any effect.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406981", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using menus to link to sections on the home page I have many menu items linking to sections (anchors) on pages. They are working fine on every page except the home page. ON the home page, the first time you click on a menu item it works, but the 2nd time, it goes to a different page.\nSee about.tap2open.com.  Under home, you'll see residents, visitors, and communities. If you click on any one, it works. But if you click again, it goes to a different page on the site.\nI'm guessing it has to do with the homepage being about.tap2Open.com without a page name. The homepage is simply called about.tap2open.com. I'm wondering if I rename the page if that would fix it. I'm afraid of breaking something else though!\n\nA: Are you saying you named your homepage the same as your url?  Don't do that.\nI'm more curious about what code you put in your menus to attach the anchors though.  You should have separate menus for pages if you are doing anchors on them. Your link should be #anchor. This way the page doesn't reload when you click it.\nIf you want to link from another page to your homepage anchor it should be /#anchor NOT https://about.tap2open.com/#anchor so you don't have to do any restructuring later.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406983", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP HTML Templates - Any way to get bloginfo() or the path to the theme folder? So in our new architecture for themes, we want to use Gutenberg themes with html templates.\nProblem is, when we need to call anything from the theme folder, we have to use the full URL. So if the folder name would be to change for any reason (and we might change it) well, every image loaded from the template breaks.\nIn PHP, you can simply run the function bloginfo() to get that. But is there the same thing in HTML templates?\nExample:\n<!-- wp:template-part {\"slug\":\"top\",\"tagName\":\"div\",\"align\":\"full\",\"className\":\"l-top\",\"layout\":{\"inherit\":true}} /-->\n<!-- wp:template-part {\"slug\":\"header\",\"tagName\":\"header\",\"align\":\"full\",\"className\":\"l-header\",\"layout\":{\"inherit\":true}} /-->\n<!-- wp:group {\"tagName\":\"main\",\"align\":\"full\", \"className\":\"l-main t-page\", \"layout\":{\"inherit\":true}} -->\n<main class=\"wp-block-group alignfull l-main t-page\">\n\n    <!-- wp:cover {\n        \"url\":\"/wp-content/themes/base-theme/assets/img/default-cover.jpg\",\n        \"dimRatio\":0,\n        \"isDark\":false,\n        \"align\":\"full\",\n    } -->\n    <div class=\"wp-block-cover alignfull is-light is-style-title-banner\">\n        <span aria-hidden=\"true\" class=\"wp-block-cover__background has-background-dim-0 has-background-dim\"></span>\n        <img class=\"wp-block-cover__image-background\" alt=\"\" src=\"/wp-content/themes/base-theme/assets/img/default-cover.jpg\" data-object-fit=\"cover\"/>\n        <div class=\"wp-block-cover__inner-container\">\n            <!-- wp:post-title {\"level\":1} /-->\n        </div>\n    </div>\n    <!-- /wp:cover -->\n    <!-- wp:yoast-seo/breadcrumbs /-->\n    <!-- wp:post-content {\"className\":\"wp-container__inner\",\"layout\":{\"inherit\":true}} /-->\n\n</main>\n<!-- /wp:group -->\n<!-- wp:template-part {\"slug\":\"footer\",\"tagName\":\"footer\",\"align\":\"full\",\"layout\":{\"inherit\":true}} /-->\n\n\nA: At the time of writing this isn't possible, twentytwentytwo works around this by registering patterns in a subfolder then using a pattern block.\nThis way they can define patterns in PHP then use the functions. This is how they show the bird in the header and include localised strings.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406985", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Have mu-plugin remove meta box ONLY if it isn't already removed in functions.php I have a mu-plugin that removes a branded \"Welcome to X\" dashboard meta box placed there by the hosting company I work for. It works fine mostly.\nHowever, some of our agency clients are already removing it in functions.php, which is now causing a fatal error when the mu-plugin removes it and then functions.php tries again.\nThe error I'm getting is:\n Cannot redeclare remove_specific_widget() (previously declared in /srv/htdocs/wp-content/mu-plugins/whitelabel-dashboard.php:24) in /srv/htdocs/wp-content/themes/twentytwentytwo/functions.php on line 70\n\nI've added a check to see if the function already exists (in functions.php), which should have the mu-plugin only run when it isn't found in functions.php. But it is only working on sites that do have the code in functions.php, and not on sites that do not.\nIt's been about a decade since I looked at any code, so feel free to point and laugh. I suspect the answer is obvious and I'm just missing it.\n$test_info returns true (1) in the echo statement on both the test site with removal code in functions.php and on the site without removal code.\nWill function_exists() just not work in this case? Is there an alternative, or should I do it myself? (Best I could come up with was to grab functions.php contents to a string, check for the function name with strpos() since some sites don't run PHP 8 so str_contains() isn't an option. Then use that check where I'm using function_exists() right now.)\nThe mu-plugin is:\n\n$test_info = function_exists('remove_x_widget') === false;\necho($test_info);\necho('Is this thing on?');\n\n// remove the \"Welcome to X\" widget box from dashboard\nfunction remove_x_widget_with_plugin() {  // must be different name than identical function used in functions.php so function_exists() isn't accidentally triggered\n        remove_meta_box( 'x_dashboard_widget', 'dashboard', 'normal' );\n}\n\n// if x widget is active, remove it\nfunction remove_widget_if_active() {\n        if (function_exists('remove_x_widget') === false) {\n            add_action('wp_dashboard_setup', 'remove_x_widget_with_plugin' );\n    }\n}\n\n\nadd_action('wp_dashboard_setup', 'remove_widget_if_active');\n?>```\n\n\nA: Hmm, a lazy workaround\u2014as long as you're not running PHP < 5.3.0\u2014might be to use a namespace in your mu-plugins file.\nSomething like this might do the trick:\n<?php\nnamespace Arglebargle;\n\n\\add_action( 'wp_dashboard_setup', 'Arglebarle\\remove_x_widget' );\n\nfunction remove_x_widget() {\n    // If the meta box has already been removed, it shouldn't be an\n    // issue to 'remove' it again.\n    \\remove_meta_box( 'x_dashboard_widget', 'dashboard', 'normal' );\n}\n\nThis code is untested. I hope it provides a good starting point.\n\nA: function_exists won't work in an MU plugin because MU plugins are loaded before regular plugins, so the functions won't exist. The function_exists() check would need to be in the themes.\nBut you're overthinking the issue. The problem is not that the metabox has already been removed. That wouldn't cause an error. The problem is simply that you're using the same name for the function that does it. Therefore the solution is simply to use a unique name for the function. Better yet, just use an anonymous callback, which makes a conflict is impossible:\nadd_action(\n    'wp_dashboard_setup',\n    function() {\n        remove_meta_box( 'x_dashboard_widget', 'dashboard', 'normal' );\n    },\n    999\n);\n\nThe other thing I've done is use a high priority on the hook, which should ensure that the meta box is removed only after it's been added.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406989", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What snippet do I need to type to show my ACF field show up on my theme? I've been trying all kinds of things but I can't get it to work cuz my Theme single.php looks different that usual.\nI made a field in ACF named Region and then enter for example USA which I need to show up in my post meta, like the edited screenshot below:\n\n\nAnd ofc all works fine at the back-end but I can't figure out what to type and where to place it in my single.php to show up on the front-end.\nThis is what my single.php looks like:\n\nNow I tried to copy their style like the ;title'=> etc, tried to paste the snippet from ACF but nothing is working which most likely is because I screwed up and it's probably easy for someone that has more exp with ACF but it's hard for me. I need to this on several other websites with different values so if someone get point me in the right direction I will use it a lot and would be very grateful.\nCheers!\n\nA: You had to use this code\nget_field( \"region\" );\n\nthis will get you the region value of current post\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406990", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Cannot output plugin twice with shortcode With my first plugin, I had some issues that got solved with the help of users here. Now I am facing another issue: I want to be able to output the plugin content (drop-down select form) twice on the same page. However, only the first time it is shown and the second is blank.\nI've read in some topics here and there, that I cannot have the same ids for content on the same page. So what I've tried is:\n\n*\n\n*Added option for a second shortcode that points to another PHP file, where the content of the second file is exactly the same as the original one. Both shortcodes work despite the fact, that there are duplicate ids in the content\n\n\n*Tried with both shortcodes to point to the same PHP file - again only the first one worked\n\n\n*Tried to make the one shortcode with arguments - again only the first one works.\n\n\n*As the select fields are dependent on each other and my ajax needs the elements IDs and I know I can fetch them by class, I've tried to remove ALL the IDs from the HTML output, but yet again only the first placement worked.\nSo, to summarize, having 2 shortcodes is not a big pain, but I prefer to be able to use one shortcode and be able to place it twice (or more) on the same page.\nAny ideas on how to do this?\nHere is some code:\nThe HTML:\n<div class=\"hpcdd-selector-box\" id=\"<?php echo $this->getWidgetId(); ?>\">\n        <div class=\"block-content\" id=\"hpcdd-form\">\n\n            <form method=\"post\">\n\n                <div class=\"row\">\n                    <select class=\"hpcdd-select\" name=\"lvl1\" id=\"lvl1\">\n                        <option value=\"\"><?php echo __('Select Main Category', 'hpcdd') ?></option>\n                        <?php\n                        foreach ($this->getTopLevelCategories() as $category) {\n                            print '<option value=\"' . $category->term_id . '\">' . $category->name . ' (' . $category->count . ')</option>';\n                        }\n                        ?>\n                    </select>\n                </div>\n\n                <div class=\"row\">\n                    <select class=\"hpcdd-select\" name=\"lvl2\" id=\"lvl2\">\n                        <option value=\"\"><?php echo __('Select First Subcategory', 'hpcdd') ?></option>\n                    </select>\n                </div>\n\n                <?php if (get_option('hpcdd_levels_setting') == 3 || get_option('hpcdd_levels_setting') == 4) { ?>\n                    <div class=\"row\">\n                        <select class=\"hpcdd-select\" name=\"lvl3\" id=\"lvl3\">\n                            <option value=\"\"><?php echo __('Select Second Subcategory', 'hpcdd') ?></option>\n                        </select>\n                    </div>\n                <?php } ?>\n\n                <?php if (get_option('hpcdd_levels_setting') == 4) { ?>\n                    <div class=\"row\">\n                        <select class=\"hpcdd-select\" name=\"lvl4\" id=\"lvl4\">\n                            <option value=\"\"><?php echo __('Select Third Subcategory', 'hpcdd') ?></option>\n                        </select>\n                    </div>\n                <?php } ?>\n\n                <div class=\"hpcdd-button\">\n                    <button type=\"submit\" name=\"submit\" title=\"<?php echo __('Show Products', 'hpcdd') ?>\"\n                            class=\"button hpcdd-submit\">\n                        <span><?php echo __('Show Products', 'hpcdd') ?></span>\n                    </button>\n                </div>\n\n                <img id=\"loader\" class=\"loader\" src=\"<?php print plugins_url('/', __DIR__) . 'img/loader.gif' ?>\" hidden/>\n\n            </form>\n\n        </div>\n    </div>\n\nThe class file:\nprivate function define_public_hooks()\n{\n\n    // Some code here //\n\n\n    add_shortcode('hpcdd_category_selector', array($this, 'show_selector_by_shortcode'));\n    add_shortcode('hpcdd_category_selector_mobile', array($this, 'show_selector_by_shortcode_mobile'));\n\n    add_action('init', array($this, 'hpcdd_shortcodes_init'));\n\n}\n\n//Code to create shortcode with arguments\n/**\n * Central location to create all shortcodes.\n */\npublic function hpcdd_shortcodes_init()\n{\n    add_shortcode('hpcdd_show_selector', array($this, 'hpcdd_shortcode'));\n}\n\npublic function hpcdd_shortcode($atts = [])\n{\n    // normalize attribute keys, lowercase\n    $atts = array_change_key_case((array)$atts, CASE_LOWER);\n\n    // override default attributes with user attributes\n    $hpcdd_atts = shortcode_atts(\n        array(\n            'name' => 'hpcddtest',\n            'id' => '',\n        ), $atts\n    );\n\n    return $this->getContent($hpcdd_atts['name'], $hpcdd_atts['id']);\n}\n\npublic function getContent($name, $id)\n{\n    $this->setWidgetId($name . '_' . $id);\n\n    ob_start();\n\n    $this->toHtml();\n\n    return ob_get_clean();\n}\n\n//Code for shortcode [hpcdd_category_selector]\npublic function show_selector_by_shortcode()\n{\n    $this->setWidgetId(rand(1, 99999));\n\n    ob_start();\n\n    $this->toHtml();\n\n    return ob_get_clean();\n}\n\n/**\n *\n */\npublic function toHtml()\n{\n    include_once plugin_dir_path(dirname(__FILE__)) . 'public/partials/hpcdd-public-display.php';\n}\n\n//Code for shortcode [hpcdd_category_selector_mobile]\npublic function show_selector_by_shortcode_mobile()\n{\n    $this->setWidgetId(rand(1, 99999));\n\n    ob_start();\n\n    $this->toHtmlMobile();\n\n    return ob_get_clean();\n}\n\n\n/**\n *\n */\npublic function toHtmlMobile()\n{\n    include_once plugin_dir_path(dirname(__FILE__)) . 'public/partials/hpcdd-public-display-mobile.php';\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406995", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Disable autosave with `function.php` for custom post wordpress? I need disable auto save with function.php in wordpress. What should I do? Thanks\n\nA: There are a few methods to disable autosave/revisions.\nDisabling autosave:\n\n*\n\n*Using action and dequeuing the .js that is responsible for autosave, this goes into functions.php, located in the current theme directory.\n\nfunction bt_disable_autosave () {\n    wp_deregister_script('autosave');\n}\nadd_action('admin_init', 'bt_disable_autosave');\n\n\n\n*Using a constant to set the interval so high (one day) it will never happen unless you leave the browser open for that long, this goes into the wp-config.php, located in the root of the wordpress install.\n\ndefine('AUTOSAVE_INTERVAL', 86400);\n\n\nDisabling/limiting revisions:\n\n*\n\n*Limiting revisions using a constant, this goes into the wp-config.php, located in the root of your wordpress install.\n\ndefine('WP_POST_REVISIONS', 3);\n\n\n\n*Disabling revisions, this is the same as the above, you just set it to 0 instead.\n\ndefine('WP_POST_REVISIONS', 0);\n// or\ndefine('WP_POST_REVISIONS', false);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/406998", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Phone Field Check (use numbers, spaces and pluses) I'm a newbie in PHP, I use this PHP code that works like a charm. It's a custom form that sends to Woocommerce different fields. I want to add a \"preg_match\" check for each of those fields so the user can only enter:\n    $address = array(\n        'first_name' => $first_name,\n        'last_name'  => $last_name,\n        'company'    => '',\n        'email'      => $email,\n        'phone'      => $phone,\n        'address_1'  => $street,\n        'city'       => $city,\n        'state'      => '',\n        'postcode'   => $postcode,\n        'country'    => $country,\n    );\n\nIn the telephone field: numbers, \"+\", spaces; (22 burns absolute)\nIn the postcode field: postcodes are contained in a custom post type \"Structures\" with their titles as values. Just those qualities. How would I do that?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407001", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display Sibling WooCommerce Product Categories on Archive Page To the lovely people of StackExchange,\nI've created the following code to list WooCommerce categories on category archive pages, and it's mostly working as I'd like.\nHowever, I'd like to modify it so that sibling categories are shown on the deepest category. I was just wondering if any of you might have any thoughts on the best way to go about this?\n$parentid = get_queried_object_id();\n                     \n                    $args = array(\n                        \n                        'parent' => $parentid,\n                        'hide_empty' => true\n                        \n                    );\n                     \n                    $terms = get_terms( 'product_cat', $args );\n                    \n                    $number = sizeof ($terms);\n                     \n                    if ( $terms ) {\n                        \n                    echo '<div class=\"product-cat-list\">';\n                    \n                        if ( $number > 12 ) {\n                            \n                        echo '<div class=\"product-cat-list__outer\">';\n                            \n                        }\n                        \n                        echo '<h3>Find your ideal item</h3>';\n                        \n                        echo '<ul class=\"product-cats\">';\n                     \n                        foreach ( $terms as $term ) {\n                            \n                            echo '<li class=\"category\">';                 \n                                          \n                                echo '<a href=\"' .  esc_url( get_term_link( $term ) ) . '\" class=\"' . $term->slug . '\">';\n                                    echo $term->name;\n                                echo '</a>';\n                             \n                            echo '</li>';\n                            \n                        }\n                                             \n                        echo '</ul>';\n                        \n                        if ( $number > 12 ) {\n                            \n                        echo '</div>';\n                                \n                        echo '<div class=\"product-cat-list__expander\">';\n                        \n                            echo '<a href=\"#\" class=\"read-more categories-expander\">Show All</a>';\n                        \n                        echo '</div>';\n                            \n                        }\n                        \n                    echo '</div>';\n                        \n                    }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407005", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Problem with Web-Alias and WooCommerce I have a site with a WooCommerce shop that works just great. I have another domain for which I have setup a Web-Alias pointing to that shop.\nIt also works great until I put something in the cart. Then it says that item is placed in the cart but the cart is still empty!\nI have updated everything, cleared the cache, checked with the webhost but ended up with nothing.\nAny idea what may cause this?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407007", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Seperate plugin and theme files I am in desperate need of help, regarding the following issue:\nI need to establish an API Connection to Salesforce, so that a user can search and retrieve certain data out of Salesforce.\nI thought, that a plugin would be the best choice, so that the functionality is not dependent on a certain theme.\nHere comes my issue:\nI want the search form to be added via short-code, so that it can be reused. So far so good.\nThen I gave the form an action attribute to call another php file, which retrieves the entered data to search for, and list the search results.\nNow when I call that second file, I get the error Call to undefined function get_header().\nBut I need the header of the selected theme to be displayed on that page, so that the whole website has the same look and feel.\nIt seems, as if I am going horribly wrong with my approach.\nMy file structure looks as follows:\n    wp-content\n              --themes\n                 -- myTheme\n\n              --plugins\n                 --myPlugin\n                      --views\n                         --page-results.php\n\nAnd this is how I add the shortcode for the form to be displayed:\n   /**\n * RETURN THE SEARCH FORM\n * @return string\n */\nfunction add_search_form() {\n\n\n\n    $html = '\n    <div class=\"col-sm-6 col-md-offset-3 d-flex justify-content-center text-center form-column\">\n\n    <form class=\"wdv_search_form w-75 mt-3\" method=\"get\" action=\"wp-content/plugins/myPlugin/views/page-results.php\">\n        <div class=\"mb-2\">\n            <input type=\"text\" class=\"form-control text-center\" id=\"searchByLocation\"\n                   placeholder=\"City\">\n        </div>\n        <div class=\"mb-2\">\n            <input type=\"text\" class=\"form-control text-center\" id=\"searchByName\"\n                   placeholder=\"Name\">\n        </div>\n        <div class=\"mb-2\">\n            <select name=\"countryChoice\" class=\"text-center\">\n                <option value=\"EN\">England</option>\n            </select>\n        </div>\n\n        <button type=\"submit\" class=\"btn btn-transparent text-light mt-3\">GO</button>\n    </form>\n\n</div>';\n\n    echo $html;\n}\n\nadd_shortcode( 'wdv_search_form', 'add_search_form' );\n\nIs my approach right and what would be best-practice for my use-case?\n\nA: You shouldn't link directly to plugin/theme PHP files to handle requests for this exact reason - the WordPress environment won't be loaded, hence your undefined function error.\nSince you've implemented a shortcode-approach to integrate with the theme, you could just point the form to itself (i.e. remove the action attribute) and then dynamically handle the output based on if the form has been submitted, for example:\nfunction add_search_form() {\n    if ( ! empty( $_GET['countryChoice'] ) ) {\n        // Return search results HTML\n    } else {\n        // Return form HTML\n    }\n}\n\nIf you want the theme to have more control over the entire template for search results, you could override the template that WordPress will load like so:\nadd_filter( 'template_include', function ( $template ) {\n    if ( ! empty( $_GET['countryChoice'] ) ) {\n        $template = locate_template( 'my-plugin-search-results.php' );\n    }\n\n    return $template;\n});\n\nThis would load the theme template file my-plugin-search-results.php if there is a non-empty countryChoice URL parameter - you might want to add more conditions to ensure the template isn't overloaded for other WP requests.\nThese are just a couple of ideas - if you update your question with more context, we might be able to offer more specific help/suggestions.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407008", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Publish box in CPT remove 'edit' link Hello I have a custom post and in the Publish Box I would like to remove the timestamp edit link.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407009", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress Nav Walker - Top menu link with dropdown link not clickable (dropdown opens) I'm trying to setup a WP NAV WALKER with dropdowns.\nThe links work fine, the dropdowns work fine, however the parents of dropdowns should also have links, but they don't trigger, instead, they just open the dropdowns. The goal would be that the arrows open the dropdowns, and clicking on the a tag results in the parent page opening.\nCode:\nclass Walker_Nav_primary extends Walker_Nav_menu {\n\n\n    function start_lvl( &$output, $depth = 0, $args = array() ) {\n        // ul\n        $indent  = str_repeat( \"\\t\", $depth );\n        $submenu = ( $depth > 0 ) ? ' sub-menu' : '';\n        $output .= \"\\n$indent<ul class=\\\"dropdown-menu$submenu depth_$depth\\\">\\n\";\n    }\n\n    function start_el( &$output, $item, $depth = 0, $args = array(), $id = 0 ) {\n        // li a span\n\n        $indent = ( $depth ) ? str_repeat( \"\\t\", $depth ) : '';\n\n        $li_attributes = '';\n        $class_names   = $value = '';\n\n        $classes = empty( $item->classes ) ? array() : (array) $item->classes;\n\n        $classes[] = ( $args->walker->has_children ) ? 'dropdown' : '';\n        $classes[] = ( $item->current || $item->current_item_ancestor ) ? 'active' : '';\n        $classes[] = 'menu-item-' . $item->ID;\n        if ( $depth && $args->walker->has_children ) {\n            $classes[] = 'dropdown-submenu';\n        }\n\n        $class_names = join( ' ', apply_filters( 'nav_menu_css_class', array_filter( $classes ), $item, $args ) );\n        $class_names = ' class=\"' . esc_attr( $class_names ) . '\"';\n\n        $id = apply_filters( 'nav_menu_item_id', 'menu-item-' . $item->ID, $item, $args );\n        $id = strlen( $id ) ? ' id=\"' . esc_attr( $id ) . '\"' : '';\n\n        $output .= $indent . '<li' . $id . $value . $class_names . $li_attributes . '>';\n\n        $attributes  = ! empty( $item->attr_title ) ? ' title=\"' . esc_attr( $item->attr_title ) . '\"' : '';\n        $attributes .= ! empty( $item->target ) ? ' target=\"' . esc_attr( $item->target ) . '\"' : '';\n        $attributes .= ! empty( $item->xfn ) ? ' rel=\"' . esc_attr( $item->xfn ) . '\"' : '';\n        $attributes .= ! empty( $item->url ) ? ' href=\"' . esc_attr( $item->url ) . '\"' : '';\n\n        $attributes .= ( $args->walker->has_children ) ? ' class=\"dropdown-toggle\" data-toggle=\"dropdown\"' : ''; // THE PROBLEM!\n\n\n\n        $item_output  = $args->before;\n        $item_output .= '<a' . $attributes . '>';\n        $item_output .= $args->link_before . apply_filters( 'the_title', $item->title, $item->ID ) . $args->link_after;\n        $item_output .= ( $depth == 0 && $args->walker->has_children ) ? ' <b class=\"caret\"></b></a>' : '</a>';\n        $item_output .= $args->after;\n\n        $output .= apply_filters( 'walker_nav_menu_start_el', $item_output, $item, $depth, $args );\n\n    }\n\n}\n\nI was able to narrow down the issue to this line:\n$attributes .= ( $args->walker->has_children ) ? ' class=\"dropdown-toggle\" data-toggle=\"dropdown\"' : '';\nIf I remove it, then the parent links work, however, the dropdowns don't.\nAnyone have any ideas?\nWp_nav_menu code:\n        wp_nav_menu(\n            array(\n                'theme_location'  => 'primary-menu',\n                'container_class' => false,\n                'menu_class'      => 'sidebar-list nav navbar-nav navbar-right',\n                'depth'           => 0,\n                'falback_cb'      => false,\n                'add_li_class'    => 'sidebar-item sidebar-anchor',\n                'walker'          => new Walker_Nav_primary(),\n\n            )\n        );\n\nThanks!\n\nA: Managed to fix it by updating the following:\n$attributes .= ( $args->walker->has_children ) ? ' class=\"dropdown-toggle\" data-toggle=\"dropdown\"' : ''; // THE PROBLEM!\n\nto:\n$attributes .= ( $args->walker->has_children ) ? ' ' : ''; // THE PROBLEM!\n\nAnd the fourth $item_output to:\n$item_output .= ( $depth == 0 && $args->walker->has_children ) ? ' </a><b class=\"caret dropdown-toggle\" data-toggle=\"dropdown\"></b>' : '</a>';\n\nCombined this with the following jQuery:\njQuery(document).ready(function () {\n  jQuery(\".dropdown > a\").click(function () {\n    window.location = jQuery(this).attr(\"href\");\n  });\n\n \n});\n\nIt does the trick. Probably not the best way, but it works. Hipp-hipp.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407010", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to insert and call new data in wordpress website database through a plugin I have a dropbox button that user interact with it to get some data like video's id and video's name using Js code.\nWhat I want to do is insert these data in the database using pair data structure and calling it in when it needed.\nI found out that I can do this using add_metadata or add_options which one shoukd i use? and is there better sutiable way.\nSecond thing: I have the button here implemented through add_shortcode using a tag but I want to replace the tag with html class in the page because I've to to write the tag like [] to add the button.\n\n\nA: The right place to store the data depends on how you will be using the data. From the context, it sounds like metadata might be the right place. There is usermeta if the data relates to one of your site users, or postmeta if the data relates to a specific post/page/CPT.\nOptions are best reserved for data that affects the site as a whole. So, if you were going to use the data to populate a video that appears sitewide, options would be an appropriate place to store the data. But the options table can tend to get bloated and impact site performance, so it's especially inappropriate if the data doesn't relate to the site as a whole, or a large part of the site.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407011", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to display the post categories for each post inside the loop with custom format? I'm trying to create a shortcode to display the post categories with custom format (ex.: I need to display emoji acf field before each category).\nI'm using version 6.0 of WordPress and the Full Site Editing to create the templates.\nI've added the shortcode in the single post template and inside the query loop block in the index template. It works fine for each single post page, but in the index page with all posts listed is showing the same category (the category of the first post) for every post.\nI'm new to php and WordPress development. Any help on how to solve this issue will be much appreciated.\nCode for the shortcode below:\nfunction my_theme_post_categories_shortcode() {\n    $post_id = get_the_ID();\n    $post_categories = get_the_category( $post_id );\n    $output = '';\n\n    if ( $post_categories ) {\n        foreach( $post_categories as $category ) {\n            $category_emoji = get_term_meta( $category->term_id, 'emoji', true);\n            $category_color = get_term_meta( $category->term_id, 'category_color', true);\n\n            $output .= '<a href=\"' . esc_url(get_category_link( $category->term_id )) . '\" style=\"color: var(--wp--preset--color--' . $category_color . ');\">' . '<span class=\"emoji\" aria-hidden=\"true\">' . $category_emoji . '</span>' . $category->cat_name . '</a>';\n        }\n    }\n\n    return '<div class=\"post-categories\">' . $output . '</div>';\n}\nadd_shortcode( 'post_categories', 'my_theme_post_categories_shortcode' );\n\nI've managed to add the emoji to the core categories list block that lists all categories via filters, with the following code. But I can't manage to do the same for the core post terms categories that lists the categories of each post.\nfunction my_theme_custom_list_categories( $list ) {\n    $categories = get_categories();\n\n    if ( $categories ) {\n        foreach( $categories as $cat ) {\n            $cat_emoji = get_term_meta( $cat->term_id, 'emoji', true);\n\n            $find = '<a href=\"' . esc_url(get_term_link( $cat )) . '\">';\n            $replace = '<a href=\"' . esc_url(get_term_link( $cat )) . '\">' . '<span class=\"emoji\" aria-hidden=\"true\">' . $cat_emoji . '</span><span class=\"cat-name\">';\n            $list = str_replace( $find, $replace, $list );\n            $find = '</a>';\n            $replace = '</span></a>';\n            $list = str_replace( $find, $replace, $list );\n        }\n    }\n\n    return $list;\n}\nadd_filter( 'wp_list_categories', 'my_theme_custom_list_categories');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407020", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Does wordpress support natively the concept of logging-in users? (not admins, but users of the website) I need to create a small members area, probably for about 1000 users, not more.\nI want to set private information there, forms, interaction, etc.\nMore in particular it'll be for \"providers\" of my business and I want them to access important notes about my business and them upload tariffs/rates, etc.\nI do not want the users to publicly register themselves. I will manually add the users after talking with them and let them they have access.\nBut care!!\nI'm not talking about the \"word-press native users that will be able to edit pages\".\nI fact I don't want them to be able to access \"any\" of the admin-panel parts, even do not login via the \"wp-admin login form\".\nQuestion\nDoes wordpress support \"consumer-users\" natively? Or I must do it by means of a plugin?\n\nA: \nDoes wordpress support \"consumer-users\" natively? Or I must do it by means of a plugin?\n\nThey're just users, you don't need to be able to edit pages to be logged in. In fact if you create a user, their default role doesn't allow them to even see the pages and posts menus.\nAll users in WordPress have a role, the basic role subscriber allows a user to reach the WP Admin area but the only thing they can do is edit their profile. Many plugins use this and redirect visitors from WP Admin to the frontend if they try to go there, giving them a frontend user edit screen and a frontend user login instead.\n\nI'm not talking about the \"word-press native users that will be able to edit pages\".\n\nThen don't give them author/editor/admin roles\n\nI do not want the users to publicly register themselves. I will manually add the users after talking with them and let them they have access.\n\nThis is a checkbox in the settings screen.\n\nI need to create a small members area, probably for about 1000 users, not more.\n\nI strongly recommend searching and evaluating membership plugins. The ability to login as a user as you describe is already a core part of WordPress that's relied upon by e-commerce and member plugins powering millions of sites.\nIf you're adding users manually, you could even do it via private pages, though that wouldn't handle your other requirements ( and you will need to seek recommendations for those requirements elsewhere ).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407021", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: MySQL Query Returns Array () In Shortcode This is in my theme's functions.php. I have an external MySQL database that I'm connecting to in WordPress with the following code, and I'm attempting to create a shortcode that shows the total of a column named total_downloads, with rows filtered by another column utm_campaign. The table name is reports_downloads. So, line 3 of my code returns the string \"apple\" and I want to get the sum of total_downloads for apple.\nThe problem is that this outputs Array ( ) on the page instead of a readable number. I'm struggling with PHP and more so with DB queries, but I'm trying to learn. Any guidance on how to get this function to return the integer 2?\n\n\n\n\nutm_campaign\ntotal_downloads\n\n\n\n\napple\n1\n\n\norange\n1\n\n\napple\n1\n\n\n\n\nfunction getAllDownloads() {\n    $wpdb2 = new WPDB( 'db_user', 'db_pass', 'db_name', 'db_host');\n    $utm = do_shortcode('[wpmem_field utm_campaign]');\n    $result = $wpdb2->get_results(\"SELECT SUM(total_downloads) as result_value FROM reports_downloads WHERE utm_campaign = \".$utm.\"\");\n    print_r($result);\n    echo $result[0]->result_value;\n}\nadd_shortcode('b3_all_downloads', 'getAllDownloads');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407023", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress user role with create user capability? I want to create a user type (Let\u2019s call it \u201cclinic\u201d which is similar to editor role in wordpress) but with permission to add_users /create_users capability. I wanted to limit that capability of this clinic user to adding only a single \u201ccustom user role\u201d (Let\u2019s call it \u201cpatients\u201d, which is similar to \u201ccustomers\u201d role in woocommerce), and nothing above that. Also when a clinic user view the list of users in wp admin, they can only see the patients list, ( But I wanted to show them only the patient users that particular clinic user created as there will be multiple clinic users) And admin can see all the clinics and patient users. Is there a way to do this? Any help to make this happen is appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407028", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Effeciently adding Checkboxes to TablePress table cells I\u2019m creating a frontend checklist for a card collection on Wordpress.\nI\u2019m combining two plugins. TablePress to create the table and Frontend Checklist to add checkboxes.\nThe idea allows the User to check a box to mark a card collected. This is stored in a cookie.\nI create the table in TablePress:\n\nI then create a Checklist using Frontend Checklist:\n\nThis creates the Shortcode [frontend-checklist name=\"001\"]\nThis is then placed in the TablePress Cell for the corresponding card.\n\nI have to make a Frontend Checklist list for every TablePress Row (One per card).\nThis method works just fine. However it\u2019s long-winded creating hundreds of Frontend Checklist lists and likely not efficient for memory/loading.\nI've checked similar questions, including this one on Stackoverflow, but no answer was included.\nIs there a more efficient way of adding checkboxes that store whether or not it have been checked? Thank you for your time.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407031", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: custom add note meta box with add button in wordpress I'm making a custom note meta box for plugin, and I have a note box input and one 'add' button in the box with. The button saves the text but does not move the text to the notepad but instead stays in the Box but saved, I'd like the text when saved to move to the note pad\n\n[![enter image description here][2]][2]\n    else {\n            print '<hr />';\n        }\n        print '<div id=\"ppn_add_post_note\" style=\"margin: 10px 0 10px 0;\">';\n        print '<label for=\"ppn_post_note\">' . __('Add note:', 'peters_post_notes') . '</label><br />';\n        print '<textarea rows=\"3\" cols=\"30\" name=\"ppn_post_note\" id=\"ppn_post_note\" style=\"width: 99%\">\n'.get_post_meta($post->ID, 'ppn_post_note', true).'\n</textarea><br /><br />';\n        print '<label><input type=\"checkbox\" name=\"ppn_private\" /> ' . __('Private note', 'peters_post_notes') . \"</label>\\n\";\n        print '</div>\n<div style=\"text-align: right\">\n<input type=\"submit\" value=\"Save\" id=\"save_note\">value=\"Add\" tabindex=\"5\" accesskey=\"p\">\n\n</div>\n\n';\n    }\n\nFunctions.php\n            jQuery(document).on('click', '#save_note', function(e) {\n                e.preventDefault();\n                var note =  $('#ppn_post_note').val();\n\n                var post_id = $('input[name=\"post_ID\"]').val();\n                var data = {\n                    'post_id': post_id,\n                    'note_movie': note,\n                    'action': 'rt_note_save',\n                }\n                jQuery.post(ajaxurl, data, function(resp){\n                });\n            });\n        });\n    </script>\n    <?php\n}\nadd_action('wp_ajax_nopriv_rt_movie_serial_save', 'rt_movie_serial_save');\nadd_action( 'wp_ajax_rt_movie_serial_save', 'rt_movie_serial_save' );\nfunction rt_movie_serial_save(){\n    if (isset($_POST['key'])) {\n        $key = $_POST['key'];\n        $bk_name = $_POST['bk_name'];\n        update_post_meta( $_POST['post_id'], 'serial-'.$key, $bk_name );\n    }\n    die();\n}\n\n\nadd_action('wp_ajax_nopriv_rt_note_save', 'rt_note_save');\nadd_action( 'wp_ajax_rt_note_save', 'rt_note_save' );\nfunction rt_note_save(){\n    if (isset($_POST['note_movie'])) {\n        $key = $_POST['note_movie'];\n        $bk_name = $_POST['note_movie'];\n        update_post_meta( $_POST['post_id'], 'ppn_post_note', $bk_name );\n    }\n    die();\n}\n\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407033", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Conditional operator OR not working with custom fields OR operator is not working for both conditions, only check first value if true then code executed and if first is false then not check 2nd condition and return else output.\nI also try with LIKE compare, but then it's check custom fields value with all other values and if This CF value's contain by any other string CF value then it's become true.\n<?php\n    $posts = get_posts(array(\n    'numberposts' => 14,\n    'post_type' => 'post',\n    'post_status' => 'publish',\n    'category_name' => 'travel',\n    'meta_query' => array(\n        'relation' => 'OR',\n          array(\n            'key'   => 'Swimming',\n            'value' => get_post_meta(get_the_ID(), 'Swimming',true),\n            'compare' => 'IN'\n        ),\n      array(\n            'key'   => 'Boat', \n            'value' => get_post_meta(get_the_ID(), 'Boat',true),\n            'compare' => 'IN'\n        ))));\n        if($posts) { \n             foreach($posts as $post) {\n?>\n <?php the_title(); ?> \n    <?php \n    }  \n}\nelse { \n?>  \n<?php echo \"No Update\";\n}\n?>\n\n\nA: The problem is that you used OR, specifically the human verbal colloquial understanding, not the logical definition. What you actually meant was AND.\nHere's a table demonstrating what happens to A and B for each comparison:\n\n\n\n\nA\nB\nAND\nOR\nXOR\n===\n\n\n\n\nfalse\nfalse\n\u274c\n\u274c\n\u274c\n\u2705\n\n\ntrue\ntrue\n\u2705\n\u2705\n\u274c\n\u2705\n\n\nfalse\ntrue\n\u274c\n\u2705\n\u2705\n\u274c\n\n\ntrue\nfalse\n\u274c\n\u2705\n\u2705\n\u274c\n\n\n\n\n\n*\n\n*OR means if any of the values are true, e.g. if one is false and the other is true\n\n*XOR means if one of the values is true ( but not both at the same time )\n\n*AND means if all/both of the values are true, and none are false\n\n*==means if both of the values are equivalent e.g. true and \"true\" are equivalent\n\n*===/EQUAL means if both of the values are exactly the same\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407034", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom plugin places html head content in body I'm currently working on a plugin. I have to render a lot of html on a specific page. I've placed that piece of code in the plugin it's core file, like so:\n    add_filter('the_content', 'overwrite_content');\n \nfunction overwrite_content($content) {\n    if(is_page('Signup')){\n        require_once(plugin_dir_path(__FILE__).'/views/signup.php');\n        $content = '';\n    }\n    else if(is_page('Bedankt')){\n        require_once(plugin_dir_path(__FILE__).'/views/thanks.php');\n        $content = '';\n    }\n    return $content;\n}\n\nIt all works fine, but for some reason all <head> elements are being placed underneath my custom html within the <body> think of <meta, <title> etc.\nDoes anyone know how I fix this?\nI'd rather skip creating a shortcode, since the html is just simply too much.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407035", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: exclude certain categories form archive widget i need some help for this...i want to hide posts of one specific category from appearing in the (sidebar-)archive-widget (chronological order, dropdown). I already tried to use the \"ultimate category excluder\" plugin but this hides them everywhere (incl. post sliders).\ni am not a programmer, so go easy php-lingo please :-)\nMany many Thanks in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407039", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Send Array from JS to php file then insert it in wp database through a plugin This's my code it's success but when but I can't the return data from ajax in the same page.\nthe mechanism is the user click the dropbox button and when he selects it returns dropbox_links and then insert dropbox_links in database using add_post_meta\nThe Insert should be on the spot becuase the dropbox button click is the only trigger\n $.ajax({\n    \n                type: \"POST\",\n                data: {\n                    req: JSON.stringify(dropbox_links)\n                },\n    \n                cache: false,\n                success: function(responseData) {\n                    // consider using console.log for these kind of things.\n                    console.log(\"Data recived: \" + responseData);\n                    console.log(dropbox_links);\n    \n                },\n                error: function(msg) {\n                    console.log(\"not sure what to ask for here to check issue\" + msg);\n                }\n            });\n\nThis's the php code but I don't catch or print any data so should I re-run the whole php script to see if it returns any data?\nfunction printdata()\n{\n    $data    = $_POST[\"req\"];\n    $data    = json_decode($data, true);\n    print_r($data);\n}\n\nif (isset($POST[\"req\"])) {\n\n    printdata();\n} else {;\n}\n\n\nA: You have to use json_encode to return data. Also use $_POST instead of $POST.\nPlease try the following code for the PHP part.\nfunction printdata() {\n    $data = $_POST[\"req\"];\n    echo json_encode($data);\n}\n\nif (isset($_POST[\"req\"])) {\n    printdata();\n} else {\n    echo 'No Data';\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407040", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Filtering custom post pages I am looking to create a system where I have a custom post type with a bunch pages therein. The custom post pages have a custom category system so I can add categories to each custom post.\nI the want to create a set of sector pages, which should display just the custom post pages that match a designated category. In addition, on these sector pages, I want to be able to include a set of filter buttons, which when clicked will alter the list of custom post results based on matching the additional category criteria.\nHas anyone built something like this before\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407041", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why isn't my `meta_query` array functioning properly? I am trying to include a meta_query to only show the 'post_type' => 'want-to-sell-post' that have the key  'key' => '_wpcf_belongs_artist_id',.\nRight now, all want-to-sell-posts are being displayed, and the meta_query is being ignored. What's the error in the way I'm writing this?\nThanks so much!\n<?php\n    $artist_id = get_the_ID();\n\n    $want_to_sell = new WP_Query( array(\n    'post_type' => 'want-to-sell-post',\n    'posts_per_page' => 5,\n    'meta_query' => array(\n        'key'     => '_wpcf_belongs_artist_id',\n        'value'   => $artist_id,\n        'compare' => '=',\n    ), \n));  \n?>\n<div class=\"container\">\n    <div class=\"row row-cols-1 row-cols-lg-1 justify-content-center\">\n        <?php if ( $want_to_sell->have_posts() ) : ?>\n            <?php while ( $want_to_sell->have_posts() ) : $want_to_sell->the_post(); ?>\n                <?php include get_template_directory() . '/includes/containers/marketplace-sell-artist-page.php'    ;?>\n            <?php endwhile;?>\n            <?php else: ?>\n        <?php endif; ?>\n        <?php wp_reset_query(); ?>\n    </div>\n</div>\n\n\nA: I already got it. Was missing an extra array() in the meta_query.\nMy updated code is this:\nI'd like to thank this website. Sometimes just posting the question helps me figure it out. What a cool community. Good luck and happy coding, all.\n<?php\n    $artist_id = get_the_ID();\n\n    $want_to_sell = new WP_Query( array(\n    'post_type' => 'want-to-sell-post',\n    'posts_per_page' => 5,\n    'meta_query' => array(\n        array(\n            'key'     => '_wpcf_belongs_artist_id',\n            'value'   => $artist_id,\n            'compare' => '=',\n        ),\n    ), \n));  \n?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407043", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is there a way to programmatically create multiple pages utilizing the same template but different content from a json file? I have been tasked with creating geolocation pages that will all use the same exact template. The content writer is giving me all the \"text\" for the pages (which I am converting to json). I want to be able to loop over wp_insert_post() and the json data to create \"x\" amount of pages automatically without manually having to go in the editor for each page. I have been attempting this on my own with no real luck so far but here is the code I have:\nHere is dummy json for my tests (wont work as a seperate file for some reason but will be getting it from AWS S3 bucket in the end result)\nconst people = [\n  {\n    \"id\": 1,\n    \"first_name\": \"Darla\",\n    \"last_name\": \"Garwill\",\n    \"email\": \"dgarwill0@sogou.com\",\n    \"gender\": \"Female\"\n  },\n  {\n    \"id\": 2,\n    \"first_name\": \"Mona\",\n    \"last_name\": \"Roles\",\n    \"email\": \"mroles1@guardian.co.uk\",\n    \"gender\": \"Female\"\n  },\n  {\n    \"id\": 3,\n    \"first_name\": \"Cori\",\n    \"last_name\": \"Danilowicz\",\n    \"email\": \"cdanilowicz2@rakuten.co.jp\",\n    \"gender\": \"Male\"\n  }\n] \n\nThis is included in my functions.php. (I want to be able to get all the data and structure it within the template. Kind of like passing props in react to the jsx.\nfunction create_page_function() {\n    // json I want to get the content from\n    $json_feed = \"I'M GETTING THE JSON FROM AWS S3 BUCKET\";\n    $json = file_get_contents($json_feed);\n    $obj = json_decode($json, true);\n\n    // foreach to loop over the json content\n    foreach($obj['people'] as $page_array){\n\n        // Save said content in variables\n        $name= $page_array['first_name'];\n        $email= $page_array['email'];\n\n        $page = wp_insert_post(\n            array(\n            'post_title' => ucwords($name),\n            'post_name' => strtolower(str_replace(' ', '-', trim($name))),\n            'post_content' => $email,\n            'post_author' => 1,\n            'post_status' => 'draft',\n            'post_type' => 'page',\n            'comment_status' => 'closed',\n            'page_template' => './templates/template.php'\n            )\n        );\n        return $page;\n    }\n}\n\ncreate_page_function();\n\nThen I have a template set up like so called template.php (for testing right now):\n<?php\n/**\n * Template Name: Test - Template\n * Template Post Type: page\n * @package WordPress\n * @subpackage Twenty_twenty_two\n * @since Twenty Twenty Two 1.0\n */\n?>\n\n<!DOCTYPE html>\n<html <?php language_attributes(); ?>>\n<head>\n    <meta charset=\"UTF-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Document</title>\n</head>\n<body>\n    <header>\n        <h1>Header</h1>\n    </header>\n    <div>\n        <h2>Name: <?php echo $name?></h2>\n        <p>Email: <?php echo $email?></p>\n    </div>\n</body>\n</html>\n\nAny help would be greatly appreciated!\nAgain to summarize. I want to loop over json data and create \"x\" amount of pages based on how many json objects there are and put the content in the template.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407047", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Delete/Spam Comment Button To add a 'spam/delete' button to an individual comment, you can use code similar to this\n$link = '<a class=\"comment-edit-link\" href=\"' . get_edit_comment_link( $comment->comment_ID ) . '\" title=\"' . __( 'Edit comment' ) . '\">' . $link . '</a>';\n\n$link = $link . ' <a href=\"'.admin_url(\"comment.php?action=cdc&dt=deletecomment&c=$id\").'\">Delete/Trash</a> ';\n\n$link = $link . ' <a href=\"'.admin_url(\"comment.php?action=cdc&dt=spam&c=$id\").'\">Spam</a>';\n\n$link = $before . $link . $after;\n\nand add that code via the edit_comment_link filter. There is also this answer which adds the same capability via a plugin: https://wordpress.stackexchange.com/a/54122/29416 .\nEither way, you are shown the admin page for that comment, where you can view the comment and then decide to spam/trash the comment. I have adjusted the code to only allow the admin to see those links.\nHow would this be enhanced to just 'do it', bypassing the admin page? In other words: hit the spam link (as admin), and the comment status is immediately changed to 'spam'.\nAdded\nI need an enhancement - the links in the original answer by \"Sally CJ\" work, but reload the page. And since the comment that I clicked on doesn't exist, the browser displayed the entire page. I need it to position to the spot where the comment used to be.\nI've tried some Ajax code , but get an 'expired' notice (related to an incorrect nonce?), or get the comment moderation screen complaining that the \"comment approved - do you want to spam it' message.\nAjax code used is roughly:\n    $cid = $the_comment_id;\n    $response = new WP_Ajax_Response;\n\n    if(\n            current_user_can( 'moderate_comments' ) &&\n            check_ajax_referer( 'cwimc_idc-delete-'.$cid, 'nonce', false ) &&\n                    wp_delete_comment( $cid,  true  )\n\n) ;\nI need the code to force a delete (in this case), which is why I added the 2nd parameter to wp_delete_comment). But that still brings me to the Moderation screen asking for a confirm on the delete.\nSo, I need to do an Ajax call to spam/delete/trash the comment, without getting to the Moderation screen. If I can get the Ajax call to work properly, then I can remove that comment with some 'parentnode/removechild', and the display will be at that point in the comment list.\n\nA: Update\n\nSo, I need to do an Ajax call to spam/delete/trash the comment\n\nI would actually also use AJAX, and secondly, I would use JS instead to add the action links \u2014 and personally, I think an edit_comment_link callback should return just one link (i.e. one a element).. but anyway,\nThere are many ways to do the AJAX, but I would use the REST API: https://developer.wordpress.org/rest-api/reference/comments/.\nYou can find a full working example here on GitHub where the script file name is comment-ajax-actions.js, but the main parts that you need to know are:\n\n*\n\n*Part 1:\n// Removes the spam/trashed/deleted comment's element from the DOM. Make sure\n// the selectors like LI.comment and .comment-body exist in your comments list.\nfunction removeComment( link ) {\n    ... see code on GitHub.\n}\n\n// Updates a comment's status, or delete the comment, via the REST API.\nfunction commentApiRequest( link ) {\n    var action     = $( link ).data( 'action' );\n    var comment_id = $( link ).data( 'id' );\n    var isDeleting = ( 'delete' === action );\n\n    if ( confirmDeleteText && isDeleting && ! confirm( confirmDeleteText ) ) {\n        return false;\n    }\n\n    wp.apiRequest( {\n        path: 'wp/v2/comments/' + comment_id,\n        method: isDeleting ? 'DELETE' : 'POST',\n        data: isDeleting ? { force: true } : { status: action }\n    } ).done( function () {\n        removeComment( link );\n    } );\n}\n\n\n\n*Part 2:\n// If you changed the action link's class (default: comment-ajax-action),\n// then be sure to also change the one below!\n$( '.comment-ajax-action' ).on( 'click', function ( e ) {\n    e.preventDefault();\n    commentApiRequest( this );\n} );\n\nAnd note that the script uses jQuery and wp.apiRequest() (see wp-includes/js/api-request.js), so be sure to add jquery and wp-api-request as dependencies when enqueueing that AJAX script. E.g. where the script file is placed inside wp-content/themes/your-theme/assets/js:\nwp_enqueue_script(\n    'your-theme-comment-ajax-actions',\n    get_template_directory_uri() . '/assets/js/comment-ajax-actions.js',\n    array( 'jquery', 'wp-api-request' ),\n    wp_get_theme()->get( 'Version' ),\n    true\n);\n\nLast but not least, the script has been tested with WordPress v6.0 and the Twenty Twenty-One and Twenty Twenty-Two themes (the latter is a block-based theme and as of writing, it uses wp-includes/theme-compat/comments.php which is deprecated, but Twenty Twenty-Two suppressed the deprecation notice).\nOriginal Answer\nIn the comments list table at wp-admin/edit-comments.php, the URL for the \"Spam\" link as of writing looks like this:\nhttps://example.com/wp-admin/comment.php?c=123&action=spamcomment&_wpnonce=xxxxxxxxxx\n\nwhere 123 is the comment ID and the _wpnonce value is a nonce with delete-comment_<comment ID> being the action.\nAnd the \"Trash\" and \"Delete\" links also follow the same format, except that the action value is trashcomment and deletecomment respectively.\nSo you should use the same format and visiting the link would just 'do it', i.e. bypassing the \"Moderate Comment\" admin page. And by default, after successfully marking the comment as spam or after trashing/deleting the comment, you would be sent back to where you were or otherwise then it defaults to wp-admin/edit-comments.php.\nAnd with your code, you'd just need to change this part:\n$link = $link . ' <a href=\"'.admin_url(\"comment.php?action=cdc&dt=deletecomment&c=$id\").'\">Delete/Trash</a> ';\n\n$link = $link . ' <a href=\"'.admin_url(\"comment.php?action=cdc&dt=spam&c=$id\").'\">Spam</a>';\n\nto the following, but note that you should always escape a URL when displaying it to the user:\n$del_nonce = wp_create_nonce( \"delete-comment_$id\" );\n\n$link = $link . ' <a href=\"'.admin_url(\"comment.php?c=$id&action=deletecomment&_wpnonce=$del_nonce\").'\">Delete/Trash</a> ';\n\n$link = $link . ' <a href=\"'.admin_url(\"comment.php?c=$id&action=spamcomment&_wpnonce=$del_nonce\").'\">Spam</a>';\n\nSee WP_Comments_List_Table::handle_row_actions() for the current URL format for the above links.\nAnd just for reference, this is the full code I used:\nadd_filter( 'edit_comment_link', function ( $link, $comment_id ) {\n    if ( ! current_user_can( 'edit_comment', $comment_id ) ) {\n        return $link;\n    }\n\n    $del_nonce = wp_create_nonce( \"delete-comment_$comment_id\" );\n\n    $url = admin_url( \"comment.php?c=$comment_id&action=spamcomment&_wpnonce=$del_nonce\" );\n    $link .= ' | <a href=\"' . esc_url( $url ) . '\">Spam</a>';\n\n    $url = admin_url( \"comment.php?c=$comment_id&action=trashcomment&_wpnonce=$del_nonce\" );\n    $link .= ' | <a href=\"' . esc_url( $url ) . '\">Trash</a>';\n\n    $url = admin_url( \"comment.php?c=$comment_id&action=deletecomment&_wpnonce=$del_nonce\" );\n    $link .= ' | <a href=\"' . esc_url( $url ) . '\">Delete</a>';\n\n    return $link;\n}, 10, 2 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407048", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom post type loop with custom category filtering Can anyone help me here. I want to list all the custom posts with the type 'portfolio' in this loop, where they have the 'Project Categories' set to 'ABC'. The below doesn't work, I think the issue is that the '' array parameter is looking at the main WP 'Categories'. Can someone help me to get it working please? Cheers.\n$loop = new WP_Query(\n    array(\n        'post_type'      => 'portfolio',\n        'posts_per_page' => 50,\n        'category_name'  => 'ABC',\n    )\n);\n\nwhile ( $loop->have_posts() ) :\n    $loop->the_post();\n    ?>\n\n    <div class=\"half-column\">\n        <h2><?php the_title(); ?></h2>\n    </div>\n\n<?php endwhile;\nwp_reset_postdata();\n\n\nA: Is that category or custom taxonomy?\nif this is a category, then try this one.\n<?php\n$loop = new WP_Query(\narray(\n    'post_type' => 'portfolio',\n    'posts_per_page' => 50,\n    'category__in' => array('8','9','10'), // your category ids\n)\n);\nwhile ( $loop->have_posts() ) : $loop->the_post();\n\n?>\n\n<div class=\"half-column\">\n<h2><?php the_title(); ?></h2>\n</div>\n\n<?php endwhile;\nwp_reset_postdata();\n?>\n\nOr if this custom taxonomy, try this one\n<?php\n$loop = new WP_Query(\narray(\n    'post_type' => 'portfolio',\n    'posts_per_page' => 50,\n    'tax_query' => array(\n        array (\n            'taxonomy' => 'yourTaxonomy',\n            'field' => 'slug', //type, id or slug\n            'terms' => 'yourTermSlug',\n        )\n    ),\n)\n);\nwhile ( $loop->have_posts() ) : $loop->the_post();\n\n?>\n\n<div class=\"half-column\">\n<h2><?php the_title(); ?></h2>\n</div>\n\n<?php endwhile;\nwp_reset_postdata();\n?>\n\nlet me know the update.\nThank You\n\nA: This solution worked for me 'project-type' => 'ABC' \n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407050", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do I upload file through custom field, save it to database and get it I have made a custom field without any plugin. When I choose file I want to upload that file and get its url on my page. Basically, I want to upload video and show it on frontend. This is my code right now (its just good for text, not upload file):\nfunction cd_meta_box_cb()\n{\n    global $post;\n    $values = get_post_custom( $post->ID );\n    $text = isset( $values['my_meta_box_text'] ) ? $values['my_meta_box_text'][0] : '';\n    wp_nonce_field( 'my_meta_box_nonce', 'meta_box_nonce' );\n    ?>\n    <p>\n        <label for=\"my_meta_box_text\">Video URL</label>\n        <input type=\"file\"\n       id=\"my_meta_box_text\" name=\"my_meta_box_text\" id=\"my_meta_box_text\"\n       accept=\"video/*\" value=\"<?php echo $text; ?>\" />\n       <input type=\"hidden\" class=\"hidden-file-field\" name=\"hidden_file_field\" />\n    </p>\n    <?php    \n}\nadd_action( 'save_post', 'cd_meta_box_save' );\nfunction cd_meta_box_save( $post_id )\n{\n    if( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) return;\n    if( !isset( $_POST['meta_box_nonce'] ) || !wp_verify_nonce( $_POST['meta_box_nonce'], 'my_meta_box_nonce' ) ) return;\n    if( !current_user_can( 'edit_post' ) ) return;\n    $allowed = array( \n        'a' => array( // on allow a tags\n            'href' => array() \n        )\n    );\n    if( isset( $_POST['my_meta_box_text'] ) )\n        update_post_meta( $post_id, 'my_meta_box_text', wp_kses( $_POST['my_meta_box_text'], $allowed ) );\n}\n\n\nA: If you want to add the file to the WordPress Media Library, you can use media_handle_upload(). The function returns the attachment post ID on success, so you can save that in a post meta and then use the relevant function to get the attachment/file details, e.g. wp_get_attachment_url() can be used to get the attachment URL.\nSo for example:\n\n*\n\n*In cd_meta_box_cb(), this will add the file upload input and (for demo purpose) displays the current video URL, if any, before that input:\n<?php\n$video_id  = (int) get_post_meta( $post->ID, 'my_video_id', true );\n$video_url = $video_id ? wp_get_attachment_url( $video_id ) : '';\n\necho 'Current video URL: ' . esc_url( $video_url ) . '<br />';\n?>\n<input type=\"file\" name=\"my_video_file\" accept=\"video/*\" />\n\n\n\n*In cd_meta_box_save(), this will add the video to the media library and save the attachment (post) ID in a post meta named my_video_id:\nif ( isset( $_FILES['my_video_file'] ) ) {\n    // Add the file to the media library.\n    $video_id = media_handle_upload( 'my_video_file', $post_id );\n\n    // Save the video/attachment ID in a post meta.\n    if ( ! is_wp_error( $video_id ) ) {\n        update_post_meta( $post_id, 'my_video_id', $video_id );\n    }\n}\n\nAnd if you just wanted to upload the file to the WordPress uploads directory (wp-content/uploads), i.e. without adding the file to the media library, then you can use wp_handle_upload(), but please check the documentation for usage syntax and also examples.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407055", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: wordpress built-in Jalali date convertor I'm developing a new plugin for a client and he wants dates to be in Jalali. As I changed language of WordPress to Persian, the posts date automatically changed to Jalali. So I Think maybe WordPress has some built-in functions for Jalali dates, But couldn't find anything in the internet. Can some one confirm if it's true? If it's true, can you link related documents?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407057", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom taxonomy - checking if name includes a declared value Can anyone help me adapt the below which creates a set of <LI> elements with custom taxonomy categories created in a custom post type I have. What I want to achieve is to only list the 'project-type' results which match a defined value.\nSo, I only want the <LI> to be listed if the 'project-type' value includes 'sector1' in the its name.\nSo, the 'project-type' names could be \"sector1-subsector1\", \"sector1-subsector2\", \"sector2-subsector1\" - from these only 2 would be listed as an <LI> - e.g. where the start of the name includes \"sector1\".\n<?php\n$terms = get_terms('project-type');\nforeach ($terms as  $term) { ?>\n<li data-filter=\".<?php  echo $term->slug; ?>\"><?php echo $term->name; ?></li>\n<?php  } ?>\n\n\nA: This worked for me:\n<?php\n$terms = get_terms('project-type');\nforeach ($terms as  $term) { \n\nif(strpos($term->slug, 'sector1-') !== false){\n?>\n<li data-filter=\".<?php  echo $term->slug; ?>\"><?php echo $term->name; ?>\n<?php\n}\n?>\n\n</li>\n<?php  } ?>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407063", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why will comments not remain open on custom post types? I have a WP install which makes use of default posts and of one custom post type (reviews). Discussion settings allow comments on both these post types. The comment form is present when viewing posts but I am getting \"comments are closed\" on the CPTs front-end.\nIf I edit the individual reviews I can see that \"Allow comments\" is not checked. If I check this and hit \"Update\" it reverts to unchecked (this doesn't happen with \"Allow trackbacks and pingbacks\").\nThis unchecking also happens if I \"Quick Edit\" in the All Reviews admin page too.\nComments which are already in the database are still visible using comments_template();, but the form will not appear on CPTs because comments cannot be enabled.\nI have made sure that \"Admin > Settings > Discussion > Allow people to submit comments on new posts\" is checked. I have unchecked/rechecked it as per this question but it has made no difference.\nThe CPT is declared in functions.php as follows:\nadd_action('init', 'all_custom_post_types');\n\nfunction all_custom_post_types() {\n    $types = array(\n        array(\n            'the_type' => 'review',\n            'single' => 'Review',\n            'plural' => 'Reviews'\n        ),\n    );\n\nforeach ($types as $type) {\n    $the_type = $type['the_type'];\n        $single = $type['single'];\n        $plural = $type['plural'];\n        $labels = array(\n            'name' => _x($plural, 'post type general name'),\n            'singular_name' => _x($single, 'post type singular name'),\n            'add_new' => _x('Add New', $single),\n            'add_new_item' => __('Add New '. $single),\n            'edit_item' => __('Edit '.$single),\n            'new_item' => __('New '.$single),\n            'view_item' => __('View '.$single),\n            'search_items' => __('Search '.$plural),\n            'not_found' =>  __('No '.$plural.' found'),\n            'not_found_in_trash' => __('No '.$plural.' found in Trash'),\n            'parent_item_colon' => '',\n        );\n        $args = array(\n            'labels' => $labels,\n            'public' => true,\n            'publicly_queryable' => true,\n            'show_ui' => true,\n            'query_var' => true,\n            'rewrite' => true,\n            'capability_type' => 'post',\n            'hierarchical' => true,\n            'has_archive' => true,\n            'menu_position' => 5,\n            'supports' => array('title','editor','thumbnail','comments'),\n            'show_in_menu' => true,\n            'show_in_nav_menus' => true,\n            'taxonomies' => array('category','post_tag'),\n        );\n        register_post_type($the_type, $args);\n    }\n}\n\ncomments are included under supports in the $args here.\nWhy would this be happening and how can I fix it?\nEDIT\nI have fixed this by registering another CPT and using that instead. The comments issue is only affecting the posts with the specific type of review. I'm not posting this as an answer because to my mind it is a workaround and not a solution.\nPresumably something got logged somewhere (in the database?) and I haven't been able to find or flush it. I'd still be interested in what this might be and how I could have avoided it.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407067", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Restrict Access without Creating Users I'm building a plugin which receives quote data form a third party api and uses it generate a post of type 'quote' which, on the front end, comprises an acf_form which the customer is required to fill out. As soon as the post is created (upon receiving the quote data), an email is sent to the user asking them to click on the link to visit the form and fill it out.\nNaturally, I don't want any of this to be public so my quotes are completely hidden from view. I had built a method using wp_nonce_url to build the link that appears in the email, validating that nonce on page load. However, I realise now that the nonce is session specific and so always fails validation the first time the link is clicked. When validation fails the user is prompted to 'request a new link' which is immediately emailed to them and which subsequently works since they already began their session.\nEnough background... the above method is no good because of the necessity to request the link every (first) time. So I'm looking to come up with a new solution. Crucially, I don't want to create user accounts for these customers (that would be too easy!), I just want some form of 'magic link' which I can validate on page load, ideally with an expiration (though not essential).\nOne option I'm considering is sending a link with the customer's hashed email address as a $_GET parameter which I could cross reference with the email address attached to the quote. This would 'look' secure and will be unique to the customer but could easily be figured out and can't be invalidated after a certain time.\nCan anyone suggest a method for this kind of thing? Thanks for reading.\n\nA: I believe you are on track; add a parameter to the URL that you can test on page-load.\nYou could create a GUID and add a table to the database where you store the email address and the GUID; this will make guessing parameters almost impossible. You could also add a timestamp to the table in the database, which you can use to see if the link should still be valid.\nTable cells: email, GUID, timestamp\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407068", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: wp.media Uncaught TypeError: Cannot read properties of undefined (reading 'state') Here in a JS class, I used \"wp.media\" to upload images. I can open the media popup by clicking a button. But getting this error (Uncaught TypeError: Cannot read properties of undefined (reading 'state')) while submitting the image.\n    constructor ( btn ) {\n        super();\n        this.uploaderBtn = $( btn );\n        this.mediaFrame;\n\n        this.events();\n    }\n\n    events () {\n        this.uploaderBtn.on( 'click', this.upload.bind( this ) );\n    }\n\n    upload ( e ) {\n        e.preventDefault();\n        //If the uploader object has already been created, reopen the dialog\n        if ( this.mediaFrame ) {\n          this.mediaFrame.open();\n          return;\n        }\n\n        //Extend the wp.media object\n        this.mediaFrame = wp.media.frames.file_frame = wp.media({\n          title: 'Choose Image',\n          button: {\n            text: 'Choose Image'\n          },\n          multiple: true\n        });\n\n        this.mediaFrame.on('select', function() {\n            const selection = this.mediaFrame.state().get('selection');\n            console.log( selection );\n        });\n\n        this.mediaFrame.open();\n    }\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407071", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Conditionally run function based on custom meta value? I\u2019m looking for a way to conditionally display an image within certain Woocommerce hooks that I choose based on whether a value is true within a custom meta field for the products on my site.\nFor example, if my custom meta value for a product is \u201cX\u201d, then I print custom html (containing an image) for the Woocommerce hooks \u2018woocommerce_product_additional_information\u2019 and \u2018woocommerce_after_shop_loop_item\u2019. However if the meta value is empty, then no image is printed for a particular product post.\nSo far this is the code I've been trying to make work within my theme's functions.php file for a single hook. The 'add_action' function works for displaying images within a hook, but I can't figure out how to get the if statement to work.\nif ( get_post_meta($post_id->ID, 'my-custom-meta-field', true) ) :\n\nadd_action( 'woocommerce_product_additional_information', 'print_custom_html' );\n function\n print_custom_html\n (){ ?> <img src=\"image.jpg\" alt=\"Image Name\"> <?php }\n\nendif;\n\nMy questions:\n\n*\n\n*How can I conditionally run the 'add_action' function based on whether my custom product meta has a value of 'X' or not?\n\n\n*How can I customize my 'add_action' function to work with more than one Woocommerce hooks?\nMany thanks!\n\nA: Instead of conditionally adding an add_action() call, you can just add it and run the function it hooks to\u2014its callback\u2014conditionally instead.\nFor example:\nadd_action( 'woocommerce_product_additional_information', 'wpse407073_callback' );\nadd_action( 'woocommerce_after_shop_loop_item', 'wpse407073_callback' );\n\nfunction wpse407073_callback( $product = null ) {\n    if ( empty( $product ) ) {\n        global $post;\n        $product = $post;\n    }\n    if ( 'X' === get_post_meta( $product->ID, 'my-custom-meta-field', true ) ) {\n        echo '<img src=\"image.jpg\" alt=\"Image Name\">';\n    }\n}\n\nA few points:\n\n*\n\n*Having looked quickly at WooCommerce's code, woocommerce_after_shop_loop_item doesn't pass anything to the callback, and woocommerce_product_additional_information passed 1 parameter, $product, which I'm assuming is a custom post. That's why I added a check for an empty $product in the callback.\n\n*This code hasn't been tested, and is meant as a possible starting point, not a finished product.\n\n*If you have questions about WooCommerce's hooks, you should check with WooCommerce's documentation and/or their support team.\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407073", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: What's more important for supporting concurrent users on an elearning site with dynamic content, CPUs or RAM? My site has >100 concurrent users. What's more important for supporting concurrent users on an elearning site with dynamic content, CPUs or RAM? And why?\n\nA: In my experience, neither is as important as PHP Workers.  If you're on a good hosting platform (like FlyWheel/WPEngine or Kinsta) you can look to get a customized configuration for your account and request an increase in the number of PHP Workers.\nA PHP Worker is what builds pages and handles back end requests - so concurrent users requesting page builds and backend processes, regardless of your CPU or RAM, if you have one PHP Worker, are all queuing up to run their process through that single Worker.  Which if busy, means you're getting a bottleneck.\nNow if you increase the PHP Workers available, what you get is numerous shorter queues.  Essentially they are processes executing simultaneously.\nNow, if you couple that with more CPU or more RAM, then each of the processes finishes quicker and each of the queues cycles through the processes quicker as well.\nHere's a good write up on PHP Workers:  https://www.nexcess.net/blog/what-are-php-workers/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407077", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: custom image size not being displayed in loop I believe I'm missing something on media images.\nI have created a custom image size with this code:\nadd_image_size( '250-square', 250, 250, true); // cropped\n\nI have then uploaded images.  When I check in the appropriate uploads directory in my installation I see that the image is uploaded and different sizes have been created.\nI have set my thumbnail dimensions to 75x75 hard crop so that there will be 2 different images with a 1:1 ratio if an image is uploaded that is not 1:1 as it is my understanding that's needed to create a srcsest.\nAs an example I uploaded an image (myimage.png) with dimensions of 1507 \u00d7 1267.\nIn the directory I have:\n\n*\n\n*myimage.png\n\n*myimage-75x75.png\n\n*myimage-250x250.png\n\n*myimage-400x400.png\n\n*myimage-1200x1200.png\n\n*myimage-768x336.png\n\n*myimage-1024x861.png\n\n*myimage-1507x500.png\n\nIn my loop I'm calling the thumbs with this code:\n<div class=\"product_cat <?php echo $kidcount;?>\"> //just outputs how many children are in the category\n    <a href=\"<?php the_permalink();?>\">\n        <?php the_post_thumbnail('250-square');?>                 \n        <h2><?php echo get_the_title();?></h2>\n    </a>\n</div>\n\nHowever this is what is being generated:\n<div class=\"productCategories grid\">\n    <div class=\"product_cat 5\">\n        <a href=\"https://examplesite.com/products/biglight-36-4000-landing-light/\">\n            <img src=\"https://examplesite.com/wp-content/uploads/2020/10/aeroleds-biglight-4000-landing.png\" class=\"attachment-250-square size-250-square wp-post-image\" alt=\"An image of Aeroleds biglight 4000 Landing\" width=\"250\" height=\"210\">\n            <h2>biglight 36-4000</h2>\n        </a>\n    </div>\n    <div class=\"product_cat 5\">\n        <a href=\"https://examplesite.com/products/biglight-36-4000-taxi-light/\">\n            <img src=\"https://examplesite.com/wp-content/uploads/2020/10/biglight_36_4587_4314_Taxi_SH.png\" class=\"attachment-250-square size-250-square wp-post-image\" alt=\"An image of biglight 36 4587 4314 Taxi Sh\" loading=\"lazy\" srcset=\"https://examplesite.com/wp-content/uploads/2020/10/biglight_36_4587_4314_Taxi_SH.png 450w, https://examplesite.com/wp-content/uploads/2020/10/biglight_36_4587_4314_Taxi_SH-75x75.png 75w\" sizes=\"(max-width: 250px) 100vw, 250px\" width=\"250\" height=\"250\">\n            <h2>biglight 36-4000</h2>\n        </a>\n    </div>\n</div>\n\nThe first image doesn't generate a srcset and isn't loading at 250x250 nor does it call the 250x250 version of the image.  the rest of the images (i removed them for simplicity in this question) work as the 2nd image in the output shown here.\n\nA: So after a bit of testing I figured out what was wrong.  It's the fact that I used numbers in the custom size name.\nWordpress created the custom image sizes fine when I uploaded images. All custom sizes were in my FTP directories and had an extension of 250x250.\nThe problem is in calling the new size later. Wordpress was never doing it.\nI added a new custom size:\nadd_image_size( 'cat-square', 250, 250, true); // cropped\n\nI then re-generated image sizes for just one image to test.  The new image size was referenced correctly and shows on the front end.\nNo new images were actually created though.  It was still using the -250x250 version of the image.\nSo in the end, I removed the 250-square media size, then regenerated all images and everything is good and working!\nTL;DR:  It appears you can't use numbers when creating the name for custom image sizes in wordpress.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407082", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Full Site Editing: How can I access my posts listing page? In WordPress 6.0, I've created a block based theme using fullsiteediting.com's theme generator. It had a default homepage which listed posts. Within the block editor (sidebar->Templates->Add New button), I added a \"Front Page\" for the theme. Now that template is set as the homepage. So, how can I see the list of all posts in the website now? In WordPress Settings->Reading, it's still set to \"Your latest posts\" as the homepage. Is this some disconnect that the developers haven't cleared yet? Should I create a new page in Pages that will query all the posts?\n\nA: Yes it sounds like there might be some sort of disconnect, as the template editor doesn't make this clear, but keep in mind that FSE is still marked as being in Beta in the latest version of WordPress.\nTemplates in full site editing still follow the standard template hierarchy. So if you want a static homepage you should set one in Settings > Reading, as well as a page for your posts. With that done your Front Page block template will be used to render the front page, while the Home block template will be used for the posts page.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407084", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress keeps redirecting to localhost Whenever I enter my domain name I can access all other files, but once I go to /wordpress it'll redirect me to localhost (which doesn't work). My wp-config contains the right address, so does my database. Can't seem to find any info besides to check that, what could it be?\nI'm running XAMPP on my PC in order to design the website before hosting it externally.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407090", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Set QTY to 0 With WP All Import from CSV I'm working with Woocommerce WP All Import to import stock quantities from my supplier's CSV Feed. However, when the item is out of stock at the Supplier, the product is removed from the CSV file, and not made 0 under QTY. In this case, the last import of QTY stays on my product on Woocommerce (for example if on 20 June there were 10 units of Product A, but on 21 June all the units of Product A is sold, the import does not update the record on my Woocommerce, and remains on 10 units in stock on my site - it basically just skips the product entirely and leaves previous settings as is)\nIs there perhaps some PHP coding I can use to make the stock level 0 if the record does not exist in the PHP File? This PHP code needs to run every time the import runs via Cron. Wp All Import has a section to put in PHP functions in the import's settings.\nI've come across this Github, but I don't really know WP All Import's jargon, etc. to change the code to suit what I need. https://gist.github.com/stuart-lambon/52f256671fe527be6bb9a25ae7cda355\nI'm not very clued up on PHP functions and help would really be appreciated!\nThanks in Advanced.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407091", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Ajax call not working in wordpress through a plugin I have 2 Ajax call the first is working but when it send the data to other the file send_data.php and when I try to run any wordpress function which is add_post_meta it doesn't work!\nThis's the first ajax call ok now the data sent to send_data.php file when I try to run any wordpress function like this     add_post_meta(2, 'dropbox', 'Senddataphp',  false); it prints this error what I want to do is pretty simple just get the data from ajax insert into wp database but I've no idea everytime I work with js with php problems like this happens. WHen I include  require_once(ABSPATH . 'wp-config.php'); require_once(ABSPATH . 'wp-load.php'); the ajax call doesn't work as well\ncaught Error: Call to undefined function add_post_meta() in C:\\xampp\\htdocs\\wordpress\\wp-content\\plugins\\Dropboxapi\\includes\\send_data.php:17\n        Stack trace:\n\nFirst Ajax code\n$.ajax({\n        \n                type: \"POST\",\n                url: 'wp-content/plugins/Dropboxapi/includes/send_data.php',\n                data: {\n                    req: JSON.stringify(dropbox_links)\n                },\n        \n                cache: false,\n                success: function(responseData) {\n                    // consider using console.log for these kind of things.\n                    console.log(\"Data recived: \" + responseData);\n                    console.log(\"First Ajax\" + dropbox_links);\n        \n        \n        \n                }\n            });\n\nSecond Ajax code here I tried to execute a function that take the sent data and insert into database but it doesn't work, dropbox.php file is the main file of the plugin\n$.ajax({\n            type: \"POST\",\n            url: 'wp-content/plugins/Dropboxapi/dropbox.php',\n\n            data: {\n                functionname: 'printdata2'\n            },\n\n            success: function(obj, textstatus) {\n                if (!('error' in obj)) {\n                    var yourVariable = obj.result;\n                    console.log(\"SEc Ajax\" + dropbox_links + yourVariable);\n\n                } else {\n                    console.log(obj.error);\n                    console.log(\"SEc1 errr Ajax\" + dropbox_links +\n                        yourVariable);\n                }\n            },\n            error: function(msg) {\n                console.log(\n                    \" errrnot sure what to ask for here to check issue\" +\n                    msg);\n            }\n        });\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407092", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Same category and post base I\u2019d like to have the following stucture:\nSingle Post: test.com/blog/post-name/\nCategory: test.com/blog/my-category-name/\nIf I go to permaliks and set: test.com/blog/%postname%/ it works okay\nBut if I Add category base: blog the category works okay but the post gets 404 error\nHow can I solve that?\nI wank to have the same structure like in cloudways:\nhttps://www.cloudways.com/blog/agencies/ (category)\nhttps://www.cloudways.com/blog/hire-wordpress-developer/ (post of that category)\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407093", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Editable select options in quick edit OR in plugin settings My plugin includes a select field that appears in the Quick Edit, but right now the values are hard coded in the plugin. I'd like to make these select options editable (add or remove option from select) and I'm not really picky about whether it's editable in the Quick Edit or if I have to do it in the plugins Setting page.\nThis is how I have the select in my plugin to display on the Quick Edit page:\n<select>\n    <option value=\"Option1\" <?php selected( $selected, 'Option1', false ); if ( $myoption == 'Option1' ) echo 'selected=\"selected\"'; ?>>Option1</option>\n    <option value=\"Option2\" <?php selected( $selected, 'Option2', false ); if ( $myoption == 'Option2' ) echo 'selected=\"selected\"'; ?>>Option2</option>\n</select>\n\nI've searched for days and found nothing specific to allowing edits to the options in a select field. I'm sure the solution is storing the list of options in the database then retrieving them, but that's where I'm lost.\nAny guidance appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407095", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I hide the ACF shortcode when empty I am facing a issue. I am using a snippet from github. It renders the URL with some attributes. However, when empty, the short code is still displaying and is not being hidden. Here it is:\n/*****************************************************************************************************************************************************\n *\n *  Usage: [acf_href href_before=\"mailto:\" href=\"acf:field_name\" text=\"acf:field_name\"]\n *\n *    acf:fieldname will retrieve the value of the specified \"fieldname\" and use that.\n *    get:url_variable will grab a variable from the URL and use that.\n *\n *      [acf_href href=\"acf:my_link\" text=\"Link to web site\"]\n *      [acf_href href_before=\"mailto:\" href=\"acf:email_address\" text=\"acf:user_name\" post_id=\"get:post_id\"]\n *\n *****************************************************************************************************************************************************/\n\n/*---------------------------------------------------------------------------------------------------------------------------------------------------*/\n\nfunction acf_field_from_string( $string, $post_id ) {\n    if ( substr( $string, 0, 4 ) == 'acf:' ) {      // ACF field name\n        $string = get_field( substr( $string, 4 ), $post_id );\n    } elseif ( substr( $string, 0, 4 ) == 'get:' ) {\n        $string = $_GET[substr( $string, 4 ) ];     // $_GET variable\n    }\n    return $string;\n}\n\n/*---------------------------------------------------------------------------------------------------------------------------------------------------*/\n\nadd_shortcode( 'acf_href', 'tscpl_sc_acf_href' );\nfunction tscpl_sc_acf_href( $atts ) {\n    extract( shortcode_atts( array(\n        'href_before' => '',\n        'href' => null,\n        'href_after' => '',\n        'text' => null,\n        'title' => null,\n        'alt' => null,\n        'target' => '_blank',\n        'rel' => 'nofollow',\n        'post_id' => null,\n        'post_type' => 'post',                      // default to POST if not specified\n        ), $atts ));\n\n    if ( empty( $post_id ) ) {                      // inside the loop\n        $post_id = get_the_id();\n    } elseif ( is_numeric( $post_id ) == false ) {  // slug\n        $post_id = acf_field_from_string( $post_id );\n        if ( empty( $post_type ) )\n            $post_type = get_post_type();\n        $post = get_page_by_path( $post_id, OBJECT, $post_type );\n        $post_id = $post->ID;\n    } else {\n        $post_id = (int) $post_id;\n    }\n\n    if ( empty( $href ) )\n        return;\n\n    $href           = acf_field_from_string( $href, $post_id );\n    $href_before    = acf_field_from_string( $href_before, $post_id );\n    $href_after     = acf_field_from_string( $href_after, $post_id );\n    $text           = acf_field_from_string( $text, $post_id );\n    $title          = acf_field_from_string( $title, $post_id );\n    $alt            = acf_field_from_string( $alt, $post_id );\n\n    return '<a href=\"' . $href_before . $href . $href_after . '\" title=\"' . $title . '\" alt=\"' . $alt . '\" target=\"' . $target . '\" rel=\"' . $rel . '\">' . $text . '</a>';\n\n}\n\nNow, when the ACF field is empty it's rendering like this.\n<a href=\"\" title=\"\" alt=\"\" target=\"_blank\" rel=\"nofollow\">Read the complete story here.</a>\nKindly guide what I am missing here.\nThanks\n\nA: the code needs some modification. see below.\n/*****************************************************************************************************************************************************\n *\n *  Usage: [acf_href href_before=\"mailto:\" href=\"acf:field_name\" text=\"acf:field_name\"]\n *\n *    acf:fieldname will retrieve the value of the specified \"fieldname\" and use that.\n *    get:url_variable will grab a variable from the URL and use that.\n *\n *      [acf_href href=\"acf:my_link\" text=\"Link to web site\"]\n *      [acf_href href_before=\"mailto:\" href=\"acf:email_address\" text=\"acf:user_name\" post_id=\"get:post_id\"]\n *\n *****************************************************************************************************************************************************/\n\n/*---------------------------------------------------------------------------------------------------------------------------------------------------*/\n\nfunction acf_field_from_string( $string, $post_id ) {\n    if ( substr( $string, 0, 4 ) == 'acf:' ) {      // ACF field name\n        $string = get_field( substr( $string, 4 ), $post_id );\n    } elseif ( substr( $string, 0, 4 ) == 'get:' ) {\n        $string = $_GET[substr( $string, 4 ) ];     // $_GET variable\n    }\n    return $string;\n}\n\n/*---------------------------------------------------------------------------------------------------------------------------------------------------*/\n\nadd_shortcode( 'acf_href', 'tscpl_sc_acf_href' );\nfunction tscpl_sc_acf_href( $atts ) {\n    extract( shortcode_atts( array(\n        'href_before' => '',\n        'href' => null,\n        'href_after' => '',\n        'text' => null,\n        'title' => null,\n        'alt' => null,\n        'target' => '_blank',\n        'rel' => 'nofollow',\n        'post_id' => null,\n        'post_type' => 'post',                      // default to POST if not specified\n    ), $atts ));\n    \n    if ( empty( $post_id ) ) {                      // inside the loop\n        $post_id = get_the_id();\n    } elseif ( is_numeric( $post_id ) == false ) {  // slug\n        $post_id = acf_field_from_string( $post_id );\n        if ( empty( $post_type ) )\n            $post_type = get_post_type();\n        $post = get_page_by_path( $post_id, OBJECT, $post_type );\n        $post_id = $post->ID;\n    } else {\n        $post_id = (int) $post_id;\n    }\n    \n    $href           = acf_field_from_string( $href, $post_id );\n    $href_before    = acf_field_from_string( $href_before, $post_id );\n    $href_after     = acf_field_from_string( $href_after, $post_id );\n    $text           = acf_field_from_string( $text, $post_id );\n    $title          = acf_field_from_string( $title, $post_id );\n    $alt            = acf_field_from_string( $alt, $post_id );\n    \n    if ( empty( $href ) ) {\n        return;\n    }\n    \n    return '<a href=\"' . $href_before . $href . $href_after . '\" title=\"' . $title . '\" alt=\"' . $alt . '\" target=\"' . $target . '\" rel=\"' . $rel . '\">' . $text . '</a>';\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407096", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Moving featured image to top of new post editor screen For some reason I'm having a hard time finding the right file to edit (even though I've done it before) but I want to move the featured image section to the top of the sidebar for the 'new post' editor screen. I know that you can move these around on the screen, but I want to enforce it for post authors by making it above the line, even before publishing options.\nDoes anyone know the file where these modules are stored so that I can swap their positions in my child theme?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407097", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to collect heading tag in a single post, such as Microsoft Word? This is what I need (without plugins and without adding shortcodes to all posts)\nHeadings h1-h6. Collect lower headings and text.\nExample:\n\nLike Microsoft Word. (Like this file)\nExample:\n\nLinks that were similar to my request but did not help (or I could not):\nhttps://stackoverflow.com/questions/37358608/how-to-add-automatically-collapse-expand-in-content-wordpress-single-php\nhttps://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/collapsible_headings/readme.html\nhttps://wparena.com/how-to-expandcollapse-wordpress-posts/\nhttps://stackoverflow.com/questions/61802692/add-shortcode-to-all-post-types\nAny help is appreciated.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407100", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can I add random alphabets in wordpress permalink posts structure I want to add random alphabets to wordpress posts permalinks with the following order:\ncurrent permalink structure sitename.com/view/%postname%/\nhttps://www.sitename.com/view/this-is-my-post-title/\nto\nnew permalink structure sitename.com/view/%random-alphabets%%postname%/\nhttps://www.pngwiz.com/view/[hkypw]-this-is-my-post-title/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407101", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to change add to cart button to call for price button in one of product variation? I want to replace add to cart button for one of my woocommerce product variation options to call for price button. how can I check that variation is selected to reach this goal?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407102", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Free search and custom taxonomy query not providing the same result Two queries that should function the same, provide different results.\nI've created a custom post type called maarchey_shiur.\nI've created a custom taxonomy called maarchey_shiur_categories.\nIf someone uses the free search they see 7 posts in the search results but if someone searches by the custom taxonomy only they see 12 posts.\nHere's the free search query args:\n$args: array(5) {\n  [\"post_type\"]=>\n  string(14) \"maarchey_shiur\"\n  [\"post_status\"]=>\n  string(7) \"publish\"\n  [\"numberposts\"]=>\n  int(-1)\n  [\"s\"]=>\n  string(8) \"\u05ea\u05e9\u05e8\u05d9\"\n  [\"tax_query\"]=>\n  array(3) {\n    [\"relation\"]=>\n    string(3) \"AND\"\n    [0]=>\n    array(4) {\n      [\"taxonomy\"]=>\n      string(25) \"maarchey_shiur_categories\"\n      [\"field\"]=>\n      string(7) \"term_id\"\n      [\"terms\"]=>\n      array(1) {\n        [0]=>\n        string(3) \"188\"\n      }\n      [\"operator\"]=>\n      string(2) \"IN\"\n    }\n    [1]=>\n    array(4) {\n      [\"taxonomy\"]=>\n      string(25) \"maarchey_shiur_categories\"\n      [\"field\"]=>\n      string(7) \"term_id\"\n      [\"terms\"]=>\n      array(1) {\n        [0]=>\n        string(3) \"189\"\n      }\n      [\"operator\"]=>\n      string(2) \"IN\"\n    }\n  }\n}\n\nIs it possible to have the query search using 'OR' for both free search and custom taxonomies in 1 go or do I have to create a custom query for that? i.e. remove the 's' part of this query and you'll get different results.\nIn other words, I would like have Wordpress search function to always search in all places (post title, post content, custom taxonomies) and if it found anything, show it in the results.\nEssentially, the query:\n$args = array(\n    'post_type'   => 'maarchey_shiur',\n    'post_status' => 'publish',\n    'numberposts' => -1,\n    's'           => $free_search,\n);\n\nshould also search in the custom taxonomies.\nThanks!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407103", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: check that the data exists before sending it to wpdb When I send data to wpdb from form I can have some empty fields.\nHow can I add conditions to array of data inside array or before insert wpdb to send only filled fields ?\nThe fields concerned (for example $serializedpaisol has no value(empty)) have already be checked to know if values exist, but the wpdb->insert find always this data name but is empty:\nif(isset($paisol)){ \n    $serializedpaisol = maybe_serialize($paisol);\n}\n$data = array(\n        'name' => $_POST['aacl_title'],\n        'nicname' => $Acronyme,\n        'img' => $idImage,\n        'info' => $_POST['aac_description'],\n        'resume' => $_POST['aac_resume'],\n        'statut' => $serializedcp,\n        'mgmt_act' => 1,\n        'website' => $serializedurllink,\n        'payment_solutions' => $serializedpaisol,\n        'mail'=> $mail,\n        'tel'=> $tel,\n        'location'=> $serializedloc,\n        'date'=> $timeday\n    );\n    $format = array('%d','%s','%s','%d','%s','%s','%s','%d','%s','%s','%s','%s','%s','%s');\n    $table = $wpdb->prefix.'table_data';\n    $wpdb->insert($table,$data,$format);\n\nWhen I send form I get  \"Notice: Undefined variable: serializedpaisol\"\nI don't understand well wpdb::prepare , does it check the existence of data value before to send to database ?\n\nA: Hi the error you are getting  for $serializedpaisol variable  because  it is not define in function  scope.\nthe variable you define in specific scope can not access out form its scope;\neg.\n{\n//example scope\n$var=10;\n}\necho $var; // you will get undefined error.\n\nhow you can fixed it?\nSolution\n// first define variable in function  scope\n\n$serializedpaisol =\"\";\n\nif(isset($paisol)){ \n    $serializedpaisol = maybe_serialize($paisol);\n}\necho $serializedpaisol; // now you will not get any error.\n\nhope you understand  the point.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407104", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Lots of 404 errors of pattern /null&rand=. Why? I can see a lot of 404 hits logged in the redirection plugin. It looks like they are made from some bad actors/bots.\nDoes anyone has same experience?\nWhat is the exact root cause?\nAny appropiate solution to handle/ignore these?\nSample Hits:\nhttps://howtodoinjava.com/json/append-json-to-file/null&rand=1656254512709\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407107", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: 3 Different Prices for Woocommerce Product I want 3 different prices for my woocommerce products. First is Regular Price and then we have Sale price which we already have, but I want to add different discounted price for the customers who pay in advance, so is it possible to do on woocommerce?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407109", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Tags hierarchical I changed the default code in the wp-includes/taxonomy.php file to:\n                            register_taxonomy(\n            'post_tag',\n            'post',\n            array(\n                    'hierarchical'          => true, //false, <--------- this line has been changed\n                    'query_var'             => 'tag',\n                    'rewrite'               => $rewrite['post_tag'],\n                    'public'                => true,\n                    'show_ui'               => true,\n                    'show_admin_column'     => true,\n                    '_builtin'              => true,\n                    'capabilities'          => array(\n                            'manage_terms' => 'manage_post_tags',\n                            'edit_terms'   => 'edit_post_tags',\n                            'delete_terms' => 'delete_post_tags',\n                            'assign_terms' => 'assign_post_tags',\n                    ),\n                    'show_in_rest'          => true,\n                    'rest_base'             => 'tags',\n                    'rest_controller_class' => 'WP_REST_Terms_Controller',\n            )\n    );\n\nHowever, now I'm getting two \"category\" taxonomies instead of \"post_tag\" and \"category\" in the wp-admin! Why is this? How can I make tags hierarchical?\nHere's a proof on the image - 2x Categories after changing one setting \"hierarchical\" as mentioned above from \"false\" to \"true\" in the post_tag:\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407110", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Ajax Favorite from foreach (how to specify which result result is processed) I created my first ajax script which is an add-to-favorites option on my real estate site.  On the single property page the setup works great...I check if the property is already saved, display a filled in heart if yes or a heart outline if not, then if the heart is clicked it toggles and adds a new entry into the user meta fields without reloading the page.\nI then created a favorite's page which uses a foreach loop to display each saved property.  I can check if the listing exists and display the correct heart icon but I'm unsure how to tell the jQuery code which foreach result to get variables from.  If I click on the icon it'll toggle but nothing is added or removed from the database.\nMy code:\nHTML:\n<?php \n$user_id = get_current_user_id();\n$parameters = array (\n    'URL' => http://website.com/property/3,\n    'Address1' => 123 Main St,\n    'Address2' => Roselle, IL 60172,\n);\n$testpara = $parameters['URL'];\n$string = serialize($parameters);\n\n$meta = get_user_meta($user_id, 'pluginlink'); \nif(array_search($testpara, array_column($meta, 'URL')) !== false) {\n    $icon = \"fa fa-heart\";\n} else {\n    $icon = \"fa fa-heart-o\";\n    }\n?> \n<form>\n<div class = \"buttons\"><i onClick=\"myFunction(this)\" class=\"<?php echo $icon; ?>\" id=\"call\" value=\"call\"></i> </div>\n </form>\n\njQuery:\n<script>       \njQuery(document).ready(function($) {\n            var user_id = '<?php echo $user_id; ?>';\n            var parameters = '<?php echo $string; ?>';\n            var testpara = '<?php echo $testpara; ?>';\n            $('#call').click(function(e) {\n                    e.preventDefault(); // prevent form from reloading page\n    \n            $.ajax({\n                url: '/wp-admin/admin-ajax.php',\n                data: {\n                    'action': 'save_listing',\n                    'user_id': user_id,\n                    'parameters': parameters,\n                    'testpara': testpara,\n                    },\n                }); \n                });\n            });\n    function myFunction(x) {\n      x.classList.toggle(\"fa-heart-o\");\n      x.classList.toggle(\"fa-heart\");\n    }\n</script>\n\nfunctions.php\nfunction save_user_listing() {\nif(!userid) {\n    die();\n} else {\n    if(isset($_REQUEST)){\n        $userid = $_REQUEST['user_id'];\n        $testparameter = $_REQUEST['testpara'];\n        $para = $_REQUEST['parameters'];        \n        $unser = unserialize(stripslashes($para));\n    \n        $meta = get_user_meta($userid, 'pluginlink'); \n        if(array_search($testparameter, array_column($meta, 'URL')) !== false) {\n            delete_user_meta($userid, 'pluginlink', $unser);\n            } else {\n            add_user_meta($userid, 'pluginlink', $unser);\n            };\n        }//end if isset\n}//close if userID\n        die();\n    }//end function\nadd_action('wp_ajax_save_listing', 'save_user_listing');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407112", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Use a custom block in another block Let's assume that I have a music player block and it's working fine.\nI now want to add another block for playlists and I want to use this single player block in this block.\nIs it possible to import this block into my playlist or should I just create a duplicate of all files in my playlist block?\n\nA: Yes, you can create custom blocks with InnerBlocks. If you only want the parent block to include music player blocks, you can define that in ALLOWED_BLOCKS. https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/nested-blocks-inner-blocks/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407113", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Remove parent category from child/sub-category page URL in Wordpress I want to remove the parent category from sub-category page URL. (actually I need it only for a specific parent-category)\nf.e, convert the URL of all sub-categories pages under this parent-category, from:\ndomain.com/parent-category/sub-category/\n\nto:\ndomain.com/sub-category/\n\n(BTW I have installed plugin that remove category base /category/ from posts and category URLs)\nI would love to get help on this. Thanks.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407114", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Flatten Responses returned via WP REST API via WP_Error for obfuscation According to this; I'm setting up the REST API of a website project.\nI'm returning the WP_Rest_Response for no matter which request in every possible end, with an according http status code, etc; no matter what happens in the request (If errors occur, I return a WP_Rest_Response object with an according error feedback, and if everything works, I return a WP_Rest_Response with an according positive feedback).\nThe API Calls all work perfectly.\nMy problem now is that, let's say your validate_callback that you can provide to your args when using register_rest_route, fails. Indicating that any of your validations reported a failed validation with a variable.\nThis seems to, according to the source code I've checked within wp-includes/rest-api/class-wp-rest-response, generate and then output a WP_Error object, with really all of the details, explaining precisely why the request failed (In this case for example that \"parameter 'x' is not valid\").\nSame happens for example if you have not provided all of the arguments you list as required for a given endpoint.\nMy question now is, is there some kind of wp filter or a hook to tell that in this case, we should simply output the HTTP status to the client, and no more details? I just feel that it's unnecessary to explain where exactly a validation failed, in production code. Especially as this is a safety feature, I feel you should tell your potential attackers as less as possible about your defense mechanisms, or at least reduce the hints you provide to a minimum.\nThe only thing that I could find so far in this sense is the _fields parameter; but yeah this filter is set on the client-side and is thus easy to manipulate. I know that the linked page says that it's not recommended to change the responses; but I just wondered if they haven't prepared a filter that you can scope to a custom REST namespace, or similar..?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407116", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Auto Generate Post Title from 2 Custom Fields I would like to generate the post title from 2 custom fields, 'job', which is a taxonomy, plus 'date' which is a date picker, not the date of the post. This is for a custom post type called 'job-updates'.\nI would also like to hide the title field in the editor.\nWith help from the ACF community, I have the following code which I have added to \"Code Snippets\" but it doesn't seem to work. Thoughts?\n// run function after acf updates fields\nadd_action('acf/update_post', 20);\nfunction title_from_fields($post_id) {\n  // check for your post type\n  if (get_post_type($post_id) != 'job-updates') {\n    return;\n  }\n  // get the post\n  $post = get_post($post_id);\n  // get the taxonomy field\n  $terms = get_field('job', $post_id);\n  // taxonomy fields return an array, use the first term\n  $term = $terms[0];\n  // get date field\n  $date = get_field('date', $post_id);\n  // set post title/slug\n  $title = $term->name.' '.$date;\n  $post->post_title = $title;\n  $post->post_name = sanitize_title($title);\n  // remove this filter to prevent infinite loop\n  remove_filter('acf/update_post', 20);\n  // update the post\n  wp_update_post($post);\n  // re-add this filter\n  add_action('acf/update_post', 20);\n}\n\n\nA: You can use the wordpress save_post action to update the title using the custom fields as you like. Here is the simple example I have used myself -\nadd_action( 'save_post', 'custom_post_type_title' );\nfunction custom_post_type_title ( $post_id ) {\n  global $wpdb;\n  if ( get_post_type( $post_id ) == 'job-updates') {\n    $terms = get_field('job', $post_id);\n    // taxonomy fields return an array, use the first term\n    $term = $terms[0];\n    // get date field\n    $date = get_field('date', $post_id);\n    // set post title/slug\n    $title = $term->name.' '.$date;\n    $where = array( 'ID' => $post_id );\n    $wpdb->update( $wpdb->posts, array( 'post_title' => $title ), $where );\n  }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407117", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: how to create hierachial taxonomy and manage under single post type? i have created Farmers Post type for managing farmers data in wordpress.\nnow i want to create hierarchical taxonomy as below:\n->state\n->district\n->g.panchayat\n->village\n->farmers\nPlease suggest me how to create hierarchical taxonomy as above and how can i managed all data under one post type.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407119", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to properly package a block plugin I've created a little WordPress block, starting from the npx @wordpress/create-block template. All is well and good, but I need to fix the packaging process.\nThe main plugin file includes a couple of php files:\ndefine( '__ROOT__', plugin_dir_path( __FILE__ ) );\n\nrequire_once( __ROOT__ . 'src/testimonial-pages.php' );\nrequire_once( __ROOT__ . 'src/block.php' );\n\nThe problem is, npm run plugin-zip does not include those files in the zip archive.\nAccording to the plugin-zip docs,\n\nIn the case where the plugin author wants to customize the files\nincluded in the zip file, they can provide the files field in the\npackage.json file as documented in the npm-packlist package\n\nwhich it does, but isn't the desired behavior. It includes the files specified, but also some additional cruft (e.g., the package.json file), and not all of the original files included by npm run plugin-zip if I don't add a \"files\" section to package.json.\nExample:\n% npm run plugin-zip\nUsing Plugin Handbook best practices to discover files:\n\n  Adding `cwr-testimonial-block.php`.\n  Adding `readme.txt`.\n  Adding `build/block.json`.\n  Adding `build/index.asset.php`.\n  Adding `build/index.css`.\n  Adding `build/index.js`.\n  Adding `build/slider.asset.php`.\n  Adding `build/slider.css`.\n  Adding `build/slider.js`.\n  Adding `build/style-index.css`.\n\nthen if I add \"files\": [ \"src/*php\" ] to package.json:\n% npm run plugin-zip\nUsing the `files` field from `package.json` to detect files:\n\n  Adding `build/index.js`.\n  Adding `package.json`.\n  Adding `src/block.php`.\n  Adding `src/testimonial-pages.php`.\n  Adding `readme.txt`.\n\nSo, I guess what I want is to extend \"Plugin Handbook best practices\" to include my required files. (or, alternatively, make whatever changes I need to make such that my plugin conforms to said best practices (which I can't actually find in the Plugin Handbook, but maybe I'm missing something)).\n\nA: Create a folder named includes in the root of your plugin folder; and place your additional php files inside of there. They (andchild folders and files) should then be copied over with plugin-zip.\nIf you have a php file with the same name as your plugin in your plugin's root folder; that will also copy over as well. (e.g. your plugin is named super-rad-explosion; plugin-zip will also copy oversuper-rad-explosion.php in the root folder of the zip).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407123", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: Sharing variables in both actions wp_footer and wp_ajax I have some code in my functions.php that, under a specific time condition, showes a popup that notices about some database update routine. What is happening here, is that when this condition happens, I place html + script code in my footer through the wp_footer action, that calls an ajax action for starting those updates. Because of this time condition and other stuffs, I have some variables that has the same value in wp_footer and in wp_ajax_update_db, so I want to write those variables only one time for both the actions. This is my functions.php like code\n/**\n * Popup for html to show update progress\n */\nadd_action('wp_footer', function() {\n    $var1 = 'some value';\n    $var2 = 'some value';\n    $var3 = 'some value';\n\n    if( $timeCondition ){\n        // My call to ajax update_db\n        // Rendered Html\n    }\n}\n\n/**\n * Engine for the update routine\n */ \nadd_action('wp_ajax_update_db', 'update_db');\nadd_action('wp_ajax_nopriv_update_db','update_db');\nfunction update_db() {\n    $var1 = 'some value';\n    $var2 = 'some value';\n    $var3 = 'some value';\n    \n    // Code for updating the dbs\n}\n\nI was thinking that I could wrap the wp_ajax_update_db inside the wp_footer action and declare the variables only in the beginning, but I don't know if this is the right way, like this\n/**\n * Popup for html to show update progress\n */\nadd_action('wp_footer', function() {\n    $var1 = 'some value';\n    $var2 = 'some value';\n    $var3 = 'some value';\n\n    if( $timeCondition ){\n        // My call to ajax update_db\n        // Rendered Html\n\n        /**\n         * Engine for the update routine\n         */ \n        add_action('wp_ajax_update_db', 'update_db');\n        add_action('wp_ajax_nopriv_update_db','update_db');\n        function update_db() {\n            // Code for updating the dbs\n        }\n\n    }\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407130", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Inject \"fake\" category to widget/block I have a regular categories widget (or \"block\" in the new terminology), that creates a <ul> with my categories.\n\nI want to add a fake category for linkbuilding reasons, an entry to this list that points to an external URL.\nHow can I do?\nI found only the_category_list hook but it doesn't seem to do what I need...\nTried also with the filters widget_categories_args and block_categories_all and but they are not called. (wp 6.0)\n\nA: Done like this:\nfunction cat_filter($args) {\n\n    if (count($args) < 10) {\n        return $args;\n    }\n\n    $new = new WP_Term((object)[\n        'term_id' => -17,\n        'name' => 'Blog',\n        'slug' => 'blog',\n        'taxonomy' => 'category',\n    ]);\n    array_splice($args, -5, 0, [$new]);\n\n    return $args;\n}\n\nadd_filter('get_terms', 'cat_filter', 10, 1);\n\nadd_filter('term_link', function( $url, $term, $taxonomy ) {\n    if ( $term->term_id == -17 ) {\n        $url = \"https://example.com\";\n    }\n    return $url;\n}, 10, 3);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407134", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Bulk Updating Post Date in 1 day Increments I have 1700 Motivational Updates + Write ups imported to WordPress.\nThe problem is they are all published on the same date.\nI'd ideally like for them to be published once per day.\nI researched a lot and found this.\n$date1       = date( $date_format, strtotime(\"-1 year\", time()) );\n$date2       = date( $date_format, time() );\n$post_type   = 'post'; // post, page, product or some other custom post type\n\n// Get all the posts\n$posts = get_posts( array( \n        'numberposts' => -1, // get ALL posts\n        'post_status' => 'any', // published, pending, draft, future, trash\n        'post_type'   => $post_type \n  ));\n\nforeach( $posts as $post ) {\n\n  //* Generate a random post dates\n  $random_date = mt_rand( strtotime( $date1 ), strtotime($date2) );\n\n  //* Format the date that WordPress likes\n  $post_date = date( $date_format, $random_date );\n\n  // We only want to update the post date\n  $update = array(\n        'ID'            => $post->ID,\n        'post_date'     => $post_date,\n        'post_date_gmt' => null,\n  );\n\n  //* Update the post\n  wp_update_post( $update );\n\n}\n\nThis setup works great, if am trying to randomize the post dates. However, it sometimes sets 2 or even 5 posts in the same day.\nIs there someway to have it such that the published_date is set to 1 per day, the time of the day can be randomized.\nAny help is greatly appreciated.\n\nA: You could start from today and just work backwards, one day at a time:\n$start_hour = 8;\n\n$end_hour = 17;\n\n$date = new DateTime;\n\nforeach ( $posts as $post ) {\n    $time = sprintf(\n        /* Left-pad time values with zeros to two digits */\n        '%02d:%02d:%02d',\n        /* Random hour between start and end */\n        rand( $start_hour, $end_hour ),\n        /* Random minutes */\n        rand( 0, 59 ),\n        /* Random seconds */\n        rand( 0, 59 )\n    );\n\n    $post_date = $date->format( 'Y-m-d' );\n\n    wp_update_post( array(\n        'ID'            => $post->ID,\n        'post_date'     => \"$post_date $time\",\n        'post_date_gmt' => null,\n    ));\n\n    // Move date 1 day back\n    $date->modify( '-1 day' );\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407137", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WordPress notification if new post published I use WordPress and I want to alert users if new post with post_type = job_post was published. Also I want to show amount of new post.\nSo I add to function.php\nglobal $new_job_count = 0;\n\nfunction newJobAdded($ID, $post ) {\n   $new_job_count = $new_job_count + 1;   \n}\nadd_action( 'publish_job_post', 'newJobAdded', 10, 2 );\n\nfunction mytheme_new_job_count(){\n      $new_job_count = 0;\n}\n\nAnd I want to show new jobs message to users in main menu\n<li class=\"new_job_count_class\"><a href=\"/newjobs\">New jobs count <?php echo $new_job_count ?></a></li>\n\nAlso I want to set $new_job_count to 0 if user click on New jobs count message\n(function ($) {\n  $(\".new_job_count_class\").on(\"click\", function () {\n     alert('click');\n     $.ajax({\n            url: '<?php echo admin_url('admin-ajax.php');?>', \n            type: 'POST',\n            data:{ \n              action: 'mytheme_new_job_count' \n            },\n            // success: function( data ){\n            //     alert(\"success\");\n            //     location.reload();\n            // }\n         });\n\n  });\n}(jQuery));\n\nThanks in advance.\n\nA: Your global $new_job_count won't work unless the value is persisted somehow as the data only exists during the PHP process' lifecycle and gets wiped when the process is done. To get the current count you need to do a query for example with WP_Query.\nTo keep a track who, and when, has viewed the published posts trigger a Ajax (or WP REST API) call when the user clicks on the post count and save the current time to the user meta. This of course only works for logged in users. You'll need to use a cookie or something for visitors.\nThe saved timestamp can then be used with the post count query to make it count only posts that have been published after the saved time.\nFor example something along these lines,\n// functions\nfunction my_user_last_new_jobs_check(int $user_id) {\n  return get_user_meta($user_id, 'new_jobs_checked', true);\n}\n\nfunction my_user_new_jobs_checked_now(int $user_id) {\n  return update_user_meta($user_id, 'new_jobs_checked', date('Y-m-d H:i:s'));\n}\n\nfunction my_get_new_jobs_count(int $user_id = 0) {\n  $args = [\n    'posts_per_page' => 500, // use some reasonable upper limit to prevent performance issues\n    'post_type' => 'job',\n    'post_status' => 'publish',\n    'no_found_rows' => true,\n    'update_post_meta_cache' => false,\n    'update_post_term_cache' => false,\n    'fields' => 'ids',\n  ];\n\n  $lastChecked = $user_id ? my_user_last_new_jobs_check($user_id) : ''; // maybe add default date & time as fallback\n  if ( $lastChecked ) {\n    $args['date_query'] = [\n      'after' => $lastChecked, // strtotime()-compatible string can be used here\n    ];\n  }\n  \n  $query = new WP_Query($args);\n  return $query->found_posts;\n}\n\n// template file\n$newJobsCount = my_get_new_jobs_count(get_current_user_id());\necho $newJobsCount;\n\n// ajax\nadd_action( 'wp_ajax_new_job_count_checked', 'my_ajax_callback' );\n// add_action( 'wp_ajax_nopriv_new_job_count_checked', 'my_ajax_callback' );\nfunction my_ajax_callback() {\n\n  // maybe validations, other checks, etc. here\n  \n  $timestampSet = my_user_new_jobs_checked_now(get_current_user_id());\n  if ( $timestampSet ) {\n    wp_send_json_success();\n  } else {\n    wp_send_json_error();\n  }\n}\n\nN.B. Untested. Modify as needed.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407139", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Hide custom column in admin template screen (Elementor) My plugin adds a custom column to admin posts and pages screens but it's also adding it to the Templates (Elementor) screen. I know users can hide this themselves, but I'd rather do it in my plugin.\nThe page where I want to remove the column is:\nedit.php?post_type=elementor_library&tabs_group=library&mode=list\nThe custom column was added using this code:\nadd_filter('manage_pages_columns', 'customfield_add_column', 5);\nadd_action('manage_pages_custom_column', 'customfield_add_column_values', 5, 2);\nadd_filter('manage_posts_columns', 'customfield_add_column', 5);\nadd_action('manage_posts_custom_column', 'customfield_add_column_values', 5, 2);\n\nfunction customfield_add_column($defaults){\n    // field vs displayed title\n    $defaults['my_custom_field'] = __('MyField');\n    return $defaults;\n}\n\n\nA: Use the second parameter $post_type passed to manage_posts_columns and ignore adding the column if it matches elementor_library:\nadd_filter( 'manage_posts_columns', 'customfield_add_column', 5, 2 /* <= Make sure you add the 2 here to pass the second parameter to your callback */ );\n\nfunction customfield_add_column( $defaults, $post_type = null ) {\n    if ( $post_type !== 'elementor_library' ) {\n        $defaults['my_custom_field'] = __( 'MyField' );\n    }\n\n    return $defaults;\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407140", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: CPT: Enable Gutenberg, but disable editor field I have a CPT which does not need an HTML/content/editor field.\nIt seems I have to add at least \"supports\" => [ \"editor\" ] to the args of register_post_type(), but then it is possible to add standard blocks to the content field. Otherwise the classic editor is shown.\nSo I want to remove this editor field without going back to the classic editor.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407146", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: LinkControl - how to toggle opensInNewTab When I click the \"open in new tab\" toggle, nothing happens in the UI. The onChange is triggered. How do I set the toggle to true?\nI am using the following:\nhttps://github.com/WordPress/gutenberg/tree/trunk/packages/block-editor/src/components/link-control#settings\nHere is my current link control component\n<LinkControl\n            searchInputPlaceholder=\"Add Link\"\n            value={attributes.link}\n            onChange={ ( value ) => {\n                setAttributes({ link: value.url, opensInNewTab: value.opensInNewTab})\n            }}\n            settings={[\n                {\n                    id: 'opensInNewTab',\n                    title: 'Opens in new tab',\n                }\n            ]}\n\n            suggestionsQuery={ { type: \"post\", subtype: 'page' } }\n        >\n\n\nA: This is covered in the documentation section directly above the one you linked, for value:\n\nA link value is composed of a union between the values of default\nlink properties and any custom link settings.\nThe resulting default properties of value include:\n\n*\n\n*url (string): Link URL.\n\n*title (string, optional): Link title.\n\n*opensInNewTab (boolean, optional): Whether link should open in a new    browser tab. This value is only assigned when not providing a\ncustom settings prop.\n\n\nSo you'd need to include it in the value:\n<LinkControl\n    searchInputPlaceholder=\"Add Link\"\n    value={{\n        url: attributes.link,\n        opensInNewTab: attributes.opensInNewTab,\n    }}\n    onChange={(value) => {\n        setAttributes({ link: value.url, opensInNewTab: value.opensInNewTab })\n    }}\n    settings={[\n        {\n            id: 'opensInNewTab',\n            title: 'Opens in new tab',\n        },\n    ]}\n    suggestionsQuery={{ type: \"post\", subtype: 'page' }}\n/>\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407147", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Gutenberg theme development: how to add \"headers\" option under styles > colors > elements? \nI'm not sure if this is even possible as I'm still learning about Gutenberg full site editing theme development. I've done my best to research this and read over the documentation before asking this question.\nIn the theme editor using a Gutenberg block theme, it's possible to set the colors for Background, Text, & Links (see screenshot). Is there a way to add \"Headers\" to this section so that header colors can be controlled across the theme as well?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407148", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: update_callback is not working in register_rest_field I am registering a new field in my custom post type using register_rest_field.\nBut I am unable to add/update the field using the rest API of post add/edit. However, the get_callback function is working fine.\nThe sample code is like the below -\n\\register_rest_field('my_post_type', 'my_field', [\n  'get_callback' => function ($params) {\n    return \\get_post_meta($params['id'], 'my_field', true);\n  },\n  'update_callback' => function ($value, $object){\n    return \\update_post_meta($object->ID, 'my_field', $value);\n  },\n  'schema'       => [\n     'description'       => __( 'Array of the ids', 'textdomain' ),\n     'type'              => 'array',\n     'items'             => [ 'type' => 'integer' ],\n  ],\n]);\n\nThanks in advance!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407150", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Trying to create a page as a menu item in the admin while keeping the admen panel visible I'll try my best to explain this in a way that makes sense.\nI'm customizing the WP admin dashboard and trying to add more elements to it by adding new menu items in the admin panel.\nNow when I create a new menu item and link it to a page, I end up on that page with the admin panel gone.\nI'm trying to add the page as a menu item so once I click on it, the URL does not necessarily change.\nSort of like having the menu item/page act as a plugin.\nThe reason why I'm doing this is simply because I can't figure out a way to duplicate the main WP dashboard without the duplicate overlapping with the main one (trying to create multiple unique dashboards).\nAny recommendation would be greatly appreciated!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407151", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Array_search ignoring the first element I made (copy) a function to make the url of the custom post (named investigacion) by year.\nfunction tex_get_archives($post_type = 'investigacion') {\n        global $wpdb;\n        $query2 = \"SELECT YEAR(post_date) AS `year` FROM $wpdb->posts WHERE `post_type` = '$post_type' AND `post_status` = 'publish' GROUP BY `year` ORDER BY `year` DESC\";\n        $arcresults = $wpdb->get_results($query2);\n        $years = array();\n    \n        if ($arcresults) {\n            foreach ( (array)$arcresults as $arcresult ) {\n                array_push($years, $arcresult->year);\n            }\n        }\n        $year_archives = [];\n        foreach ($years as $year) {\n            if ( $year ) {\n                $url = get_year_link( $year );\n                $year_archives[] = $url.'?post_type='.$post_type;\n            }\n        }\n        return $year_archives;\n    }\n\nThis function returns:\nArray\n(\n    [0] => http://ah6studio.local/2022/?post_type=investigacion\n    [1] => http://ah6studio.local/2020/?post_type=investigacion\n    [2] => http://ah6studio.local/2018/?post_type=investigacion\n    [3] => http://ah6studio.local/2010/?post_type=investigacion\n    [4] => http://ah6studio.local/2006/?post_type=investigacion\n)\n\nSo, that's ok. Then, I wanted to add some code only if you're in a yearly archive, in any of those url. So I used an if statemente that search if the url of the current page is on the array, it would add a text saying what year is the archive we are on:\n<?php \n    $yearlyarchives=tex_get_archives();\n    global $wp;\n    $currentpage= home_url( $wp->request ).\"/?post_type=investigacion\";\n      if (array_search($currentpage,$yearlyarchives,true)){\n     ?> en el <?php echo get_query_var('year');\n\n      }\n\nBut, it runs true when I'm in all the archive pages except the first one [0], the 2022 one. It runs false (I tested it). The array_search works just not with the first element. Is really weird.\n\nA: In PHP, the number 0 is interpreted as false-ish.\nYour if-statement asks for a true-ish condition like this:\nIf the result of the array_search function is interpreted as true-ish, THEN do the stuff\n\nwhich means if the result is 0, it is interpreted as false, and the code doesn't run.\nWhat to do?\nUse the identical operator for false like this to check for your wanted condition. Change your if-statement like this:\nif ( !( false === array_search( $currentpage, $yearlyarchives, true) ) ){\n     ?> en el <?php echo get_query_var('year');\n}\n\nThe code will then run if the result of the array search is not identical to false (array_search will return false if the needle is not found).\nHappy Coding!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407156", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: WP-CLI: Does \"wp post create\" will create post normally and will ping to Ping Service? Is post created using WP-CLI is just a normal post that will ping to Ping Service?\nI scared if Ping Service not triggered on my new post using WP-CLI.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407157", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to get post count of specific taxonomy that have store name & category I am new in php and trying to learning php.\nI have taxonomy called dealstore.\nI have added one store name \"Amazon\" and two categories name \"coupons and electronics\".\nNow, I want to post count which have Amazon store name and coupons category.\nI have tried\n\n <?php   $terms = get_the_terms( $post->ID , 'dealstore' );   \n          foreach ( $terms as $term ) \n             {    \n               echo $term->count; \n              } ?>\n\nIt counts All Post which have coupons category and electronics.\nI have added another code\n<?php\n                    $custom_terms = get_the_terms( $post->ID , 'dealstore' );\n                    foreach($custom_terms as $custom_term) {\n                    wp_reset_query();\n                    $args = array(\n                    'post_type' => 'post',\n                    'tax_query' => array(\n                        'relation'=> 'AND',\n                    \n                    array(\n                            'taxonomy' => 'dealstore',\n                            'field' => 'slug',\n                            'terms' => $custom_term->slug,\n                            ),\n                    array(\n                            'taxonomy' => 'category',\n                            'field' => 'slug',\n                            'terms' => $custom_term->slug,\n                            ),\n                            \n                        ),\n                    );\n                $query = new WP_Query( $args );\n                 if ( $query->have_posts() ) :\n                echo $query->post_count;\n                ?>\n\ncan anyone help me to solve this ?\nThank you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407158", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Programtically selecting image URL in Media Library modal I've been struggling with Backbone for a few hours now while I'm trying to select a custom image URL in the media modal. The idea is to have a button that I've coded already and when the user clicks on that button, we select a predefined image URL that makes the button enabled (which happens on selection automatically) which then the user can insert into their block (regardless of the block being used).\nSo far I haven't been able to find much that can allow me to select an image URL (not an uploaded image) programmatically.\nI've looked into methods like this https://github.com/WordPress/WordPress/blob/d533b76ef848528304a5ef08b82cc6e674eeb3cc/wp-includes/js/media-views.js#L3075 but to no avail. Does anyone have any pointers or past experience that can help me?\n\nEDIT: Another method that can work here is to not use the selection but to at least have a way to return the image URL back to the block from the modal.\n\nA: I found this answer, it can be done like this:\nconst state = this.state();\nconst selection = state.get( 'selection' );\nselection.add({ url: 'http://www2.cnrs.fr/sites/communique/image/mona_unvarnish_web_image.jpg' });\n\nWhere this is an instance of wp.media.view.MediaFrame.Select\nHope it helps someone!\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407159", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Changed domain name and all the 301 redirects work except the ones for the thumbnail image which return 403 Forbidden error I'm encountering a strange behavior and I don't know what is causing this.\nI recently changed my domain name and did all the 301 redirects from olddomain.com to newdomain.com.\nThey all work as intended except for the thumbnail images.\nWhen I check the URL of any thumbnail image from the old domain \u2014 olddomain.com/wp-content/uploads/image-url.jpg \u2014 it redirects to the new domain, same URL \u2014 newdomain.com/wp-content/uploads/image-url.jpg \u2014 but after the redirect takes place it doesn't return a 200 OK code but 403 Forbidden. It's like the server blocks that URL but the strange part is that this doesn't happen if I check the thumbnail URL of the new domain. So if I enter newdomain.com/wp-content/uploads/image-url.jpg, the image exists and it gave me 200 OK.\nPlease note this is happening only when I check with any tool like https://httpstatus.io/, no matter the user agent. If I try the redirect in my browser, it works. But that doesn't mean anything if Google or any other bot can't confirm the redirect.\nAnother strange thing is that the redirects for all the other images (product images, images in articles, etc.) work as indented. So the only problem is with the thumbnail images. I don't know why this is happening since all images have the same URL format (/wp-content/uploads/year/month/image-url.jpg)\nIn the below image, the first is an URL from a random image inside an article and the last is the URL of one of my thumbnail images. They have the exact URL format.\n\nAnyone know how to this thix?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407161", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Show Site Name on WP login screen I'm trying to create a generic, re-usable function that shows the site name on the login screen. It works with just static text, but how do I pull in the site name dynamically? Here's what I've tried:\nfunction custom_login_message() {\n    $message = '<p class=\"natz-login\">Log in to <?php echo get_option( 'name' ); ?> </p><br />';\n    return $message;\n    }\n    add_filter('login_message', 'custom_login_message');\n\nThis is obviously wrong, but what do is use instead of <?php echo get_option( 'name' ); ?> ?\n\nA: The function you are looking for is get_bloginfo().\nfunction wpse407167_custom_login_message( $message ) {\n\n    $message = '<p class=\"natz-login\">Log in to ' . get_bloginfo('name') . '</p><br>';\n    return $message;\n    \n}\nadd_filter( 'login_message', 'wpse407167_custom_login_message', 99 );\n\n\nA: if you mean, the php to replace  <?php echo get_option( 'name' ); ?>\nthen it's probably  <?=  bloginfo('name') ?>\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407167", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Meta field bulk editing no longer working in WP 6.0 Until recently, I was using the following PHP and jQuery code for adding bulk editing support for a meta field (price) in a custom post type (Book):\nPHP:\nfunction show_bulk_edit_book_metabox( $column_name, $post_type ) {\n    static $print_nonce = true;\n    if ( $print_nonce ) {\n        $print_nonce = false;\n        wp_nonce_field( plugin_basename( __FILE__ ), 'book_edit_nonce' );\n    }\n\n    switch ( $column_name ) {\n        case 'price':\n            ?>\n        <fieldset class=\"inline-edit-col-right inline-edit-book\">\n            <div class=\"inline-edit-col column-<?php echo esc_attr( $column_name ); ?>\">\n                <label class=\"inline-edit-group\">\n                    <span class=\"title\"><?php _e( 'Price', 'my-domain' ); ?></span><input type=\"text\" name=\"price\" />\n                </label>\n            </div>\n        </fieldset>\n            <?php\n        break;\n    }\n}\nadd_action( 'bulk_edit_custom_box', 'show_bulk_edit_book_metabox', 10, 2 );\n\nJQUERY:\n( function( $ ) {\n    $( '#bulk_edit' ).on( 'click', function() {\n        // Define the bulk edit row.\n        var $bulk_row = $( '#bulk-edit' );\n\n        // Get the selected post ids that are being edited.\n        var $post_ids = new Array();\n        $bulk_row.find( '#bulk-titles' ).children().each( function() {\n            $post_ids.push( $( this ).attr( 'id' ).replace( /^(ttle)/i, '' ) );\n        });\n\n        // Get the data.\n        var $nonce = $bulk_row.find( 'input[name=\"book_edit_nonce\"]' ).val();\n        var $price = $bulk_row.find( 'input[name=\"price\"]' ).val();\n\n        // Save the data.\n        $.ajax({\n            url: ajaxurl, // This is a variable that WordPress has already defined for us.\n            type: 'POST',\n            async: false,\n            cache: false,\n            data: {\n                action: 'save_bulk_edit_book', // This is the name of our WP AJAX function that we'll set up next.\n                post_ids: $post_ids, // And these are the parameters we're passing to our function.\n                price: $price,\n                book_edit_nonce: $nonce\n            }\n        });\n    });\n\n})( jQuery );\n\nApparently, WP 6.0 has made some accessibility markup changes to the bulk edit screen and the following part of the code no longer works:\n$bulk_row.find( '#bulk-titles' ).children().each( function() {\n    $post_ids.push( $( this ).attr( 'id' ).replace( /^(ttle)/i, '' ) );\n});\n\nThis is the new HTML markup of the selected bulk post IDs list (an example):\n<div class=\"inline-edit-col\">\n    <div id=\"bulk-title-div\">\n        <div id=\"bulk-titles\">\n            <ul id=\"bulk-titles-list\" role=\"list\">\n                <li class=\"ntdelitem\"><button type=\"button\" id=\"_2590\" class=\"button-link ntdelbutton\"><span class=\"screen-reader-text\">Remove \"167\" from Bulk Edit</span></button><span class=\"ntdeltitle\" aria-hidden=\"true\">167</span></li>\n                <li class=\"ntdelitem\"><button type=\"button\" id=\"_2589\" class=\"button-link ntdelbutton\"><span class=\"screen-reader-text\">Remove \"166\" from Bulk Edit</span></button><span class=\"ntdeltitle\" aria-hidden=\"true\">166</span></li>\n            </ul>\n        </div>\n    </div>\n</div>\n\nInstead of getting the selected post IDs, I'm getting an empty value.\nAny idea of which changes I should make to this code to make it work in WP 6.0?\nThanks in advance\n\nA: I managed to find a solution by myself. Just replace:\n$bulk_row.find( '#bulk-titles' ).children().each( function() {\n    $post_ids.push( $( this ).attr( 'id' ).replace( /^(ttle)/i, '' ) );\n});\n\nwith:\n$bulk_row.find( '#bulk-titles-list .button-link.ntdelbutton' ).each( function() {\n    $post_ids.push( $( this ).attr( 'id' ).replace( /_/g, '' ) );\n});\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407172", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display vendor phone number on single product page I'm using WordPress + WooCommerce + WCFM + ShopEngine + Elementor. I have widget Vendor Store: Info (see the picture), I need to display Vendor's (Seller's) phone number on it, instead of rating stars may be, or add somehow..\n\nIs there any way to do it?\nAny other suggestions is also welcome, the need is simple, I need to have Vendor's phone number on Single Product Page.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407178", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to set all External Domain Links with nofollow Attribute from Header Footer Content and Excerpt using PHP? I am trying to set all external links with nofollow attribute on all Wordpress site. I found so many site where code is available only for content and excerpt. But i want to set nofollow attribute on all external domain links from header, footer, content everywhere.\nPlease Provide Reference or PHP Code.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407188", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Gutenberg InnerBlocks renderAppender not showing with template I am developing a small plugin that contains two blocks: one grid/container, that renders its contents in 3 equal width columns, and a grid/item, that is the child of the grid. But the grid is supposed to also allow core/image blocks.\nTo show what I aim for I made a little sketch:\n\nAs a default layout, when the grid is inserted first, I want 6 grid/items to be displayed. Via deleting items and adding and moving images, admins should be able to adjust the layout to their liking.\nBut the problem I am facing right now, is that no button to add more children is displayed when I pass a template to the InnerBlocks of the edit of the container. Even if I manually pass a renderAppender prop. But in the official documentation both props are used in the example section about renderAppender, so this should work together, right?\nThis is my code:\nedit.js\nimport { __ } from \"@wordpress/i18n\";\nimport { useBlockProps, InnerBlocks } from \"@wordpress/block-editor\";\n\nimport \"./gridEdit.scss\";\n\nexport default function Edit() {\n    const ALLOWED_BLOCKS = [\"grid/item, core/image\"];\n    const MY_TEMPLATE = [\n        [\"grid/item\"],\n        [\"grid/item\"],\n        [\"grid/item\"],\n        [\"grid/item\"],\n        [\"grid/item\"],\n        [\"grid/item\"],\n    ];\n\n    return (\n        <div {...useBlockProps()}>\n            <InnerBlocks\n                allowedBlocks={ALLOWED_BLOCKS}\n                template={MY_TEMPLATE}\n                renderAppender={() => <InnerBlocks.DefaultBlockAppender />} //makes no difference\n            />\n        </div>\n    );\n}\n\nWhat am I missing?\nLet me know, if you need more code snippets.\nThanks in advance :)\n\nA: I have found my typo - It should be\nconst ALLOWED_BLOCKS = [\"grid/item\", \"core/image\"];\n\nnot\nconst ALLOWED_BLOCKS = [\"grid/item, core/image\"];\n\nIf the allowed block type does not exist it only makes sense not to display a button to add more blocks :D\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407194", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: WP query is calling get_userdata and throws error My function is:\nfunction wp_query_get_products() {\n    $query = new WP_Query( array(\n        'posts_per_page' => 1000,\n        'post_type' => 'product',\n        'post_status' => 'publish',\n    ) );\n    if($query->have_posts()) :\n        while($query->have_posts()) : $query->the_post();\n            echo get_the_ID();\n        endwhile;\n        wp_reset_postdata();\n    endif;\n}\n\nCalling this function throws this error\n\nUncaught Error: Call to undefined function get_userdata() in XXXX.php\non line 4489\n\nI've written a plugin where I need to get woocommerce products using WP Query, where this part is throwing error. Please suggest what might be causing this.\nThanks\n\nA: You need to call that code from within a hook. Calling it directly inside your plugin is way too soon - get_userdata is a pluggable function and will not yet be loaded.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407197", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How can i ensure that SQL statements are not displayed if an enduser types the wrong variable name in the URL My question is similar to this. It is about security of my wordpress site which has custom pages that call variables on the url.\nAn example of my url looks like this:\nhttps://mysitevvv.ke/mysite1/publications/?pages=getabstract&pubid=3371\n\nMy problem/concern is that if an enduser changes the parameter pubid to pbid or any other random non-existent variable name other that pubid wordpress returns the SQL query on the back end like so:\nWordPress database error: [You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1]\nSELECT * FROM wp7m_refs WHERE id =\nHow can i secure my site to protect against this? Can add_query_arg( $args ) function protect against this and if yes, how?\n\nA: There's two separate problems here:\n\n*\n\n*You have code that causes an error.\n\n*That error is exposing information to end users that you don't want to expose.\n\nThe problem that's causing #2 is that you have error printing enabled in a production environment, which is against best practice. Error reporting is controlled by a PHP configuration parameter. This doesn't involve WordPress and your host should be able to help with this. However keep in mind that if you do not have a staging or testing environment you would be unaware of any errors that are occurring. So make sure that your errors are at least being logged somewhere that you can check.\nThe problem that's causing #1 in the first place is that your site's code is apparently taking the value of the pubid parameter and putting it directly into an SQL query. This is a major security problem. I cannot understate the severity of this issue. If this is a production site you should remove the code that's responsible for this feature immediately. If you don't know how to do this, and if you have user's personal data in your database, then you need to take your site offline.\nIn your example pubid is a number. Therefore in your code when you access $_GET['pubid'] you need to include code that makes sure that this value is a number. If it is not a number then you should not run the query at all. For example, using WordPress's absint() function:\nif ( ! isset( $_GET['pubid'] ) ) {\n    return;\n}\n\n$pubid = absint( $_GET['pubid'] );\n\nif ( ! $pubid ) {\n    return;\n}\n\n// Perform query.\n\nThe important thing is that you should never accept external data and use it in an SQL query without first making sure that the value is safe and valid. Not doing so leaves you vulnerable to 'SQL injection' attacks.\nIn your query you should also be making using of $wpdb->prepare() to safely insert values into an SQL statement.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407200", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display custom post front end filter by ACF equals current user Let me try to be as clear as possible :\nI would like to display my custom post on Front-end.\nI made a Back-office for a mobile app, but I'd like to create an access from front-end to display some informations from my back-office.The first I try is to display single content from a custom post. I need to filter this pages by a custom ACF field equals to my current user.\nAnd I need to check if the user has the good role.. I've already configure all my Custom post, and all my ACF field, and custom roles.. I made a specific plugin for my Back Office.\nBut I'm very noob with WP-query..\nI would like to create specific shortcodes to display the differents single views and the different lists I'll will need for my back-office..\nI need you help on this one mates\nThanks by advance\nRegards from Paris\n\n\n\n\nCustom option\nValue\n\n\n\n\nCustom posts name\npage_clubs\n\n\nACF field related\nadministrators\n\n\nCustom role\nclub_adminstrators, or club_members\n\n\nUser\nCurrent\n\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407202", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Call to a member function add_rewrite_tag() on null on register_post_type Im trying to register a post type using the class below, the problem that appears is a fatal error \"Call to a member function add_rewrite_tag() on null\". I did some research and the general consensus was that i needed to put the function in a hook (init) within an add_action, which i have done within the construct of the class. But i still get the error.\nAny help would be greatly appreciated.\nclass PostTypes { \n\n\npublic function __construct()\n{\n    add_action( 'init', $this->registerCustomers() );\n}\n\npublic function registerCustomers() {\n\n    $labels = [\n        'name'                  => esc_html( 'Customers' ),\n        'singular_name'         => esc_html( 'Customer' ),\n        'all_items'             => esc_html( 'All Customers' ),\n        'featured_image'        => esc_html( 'Thumbnail Image' ),\n        'set_featured_image'    => esc_html( 'Set Thumbnail Image' ),\n        'remove_featured_image' => esc_html( 'Remove Thumbnail Image' ),\n    ];\n    $args = [\n        'labels'       => $labels,\n        'public'       => true,\n        'show_in_rest' => true,\n        'has_archive'  => false,\n        'rewrite'      => [\n            'slug'       => 'customers',\n            'with_front' => false,\n        ],\n        'supports'     => [\n            'title',\n            'editor',\n            'excerpt',\n            'thumbnail',\n            'post-formats',\n            'custom-fields',\n        ],\n        'menu_position'       => 10,\n    ];\n\n     \n    register_post_type( 'customer', $args );\n}\n\n}\n\n$postTypes = new PostTypes();\n\n\nA: Replace code:\nadd_action( 'init', $this->registerCustomers() );\n\nWith:\nadd_action( 'init', [ $this, 'registerCustomers' ] );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407205", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Display Current Posts Category (with the most posts)? I have an post article, with a title date and the category the post is assigned to.\nThe post is in multiple categories, but i only want to show the 'main' one its in and none of the others (for now).\nHow do i search through all the categories the post is assigned to and only show the one with the most posts in? Therefore giving that category the idea as the main one?\nI assume cycling through get_the_category counting all the posts within all the categories assigned to this post and then picking the one with the most?\n$category_main = get_the_category(); //But only the one with the more posts than the others?\n\nif ( ! empty( $category_main ) ) {\n    echo '<a href=\"' . esc_url( get_category_link( $category_main[0]->term_id ) ) . '\">' . esc_html( $category_main[0]->name ) . '</a>';\n}\n\nThank you for any ideas :)\n\nA: get_the_category() returns an array of WP_Term objects, so you already have access to the count property - just sort the array by it and retrieve the one with the highest count:\n$main_category = current( wp_list_sort( get_the_category(), [ 'count' => 'DESC' ] ) );\n\nCheck out the documentation for wp_list_sort()\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407209", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to properly escape values in meta query I found this filter some time ago at How to filter my search in post if contains a word in title, content or excerpt?\nIt worked well.  But now I am getting an error message of like_escape is deprecated since version 4.0.0! Use wpdb::esc_like()\nIt tried replacing esc_like, with wpdb::_esc_like, but that resulted in a message of:\nDeprecated: Non-static method wpdb::escape()\n\nIf I removed like_escape and just left the query inside esc_sql would that be secure enough?\nI am open to a better way to structure this.\nThanks.\nfunction general_filter( $where, &$wp_query )\n{\n    global $wpdb;\n    if ( $search_term = $wp_query->get( 'search_prod_title' ) ) {\n        $where .= ' AND (' . $wpdb->posts . '.post_title LIKE \\'%' . esc_sql( like_escape( $search_term ) ) . '%\\' OR ' . $wpdb->posts . ' .post_excerpt LIKE \\'%' . esc_sql( like_escape( $search_term ) ) . '%\\' OR ' . $wpdb->posts . ' .post_content LIKE \\'%' . esc_sql( like_escape( $search_term ) ) . '%\\')';\n    }\n    return $where;\n}\n\n\nA: The problem is that you've interpreted wpdb::esc_like as a literal copy paste, and not a direction, and used it as a static function, when it is not a static function.\nGood:\nglobal $wpdb;\n$foo = $wpdb->esc_like( $bar );\n\nBad:\n$foo = wpdb::esc_like( $bar );\n\nOther things to note:\n\n*\n\n*The & in &$wp_query ) is a holdover from PHP 4 that they fixed in PHP 5. However, a lot of WP devs weren't sure and didn't know this and copy pasted it everywhere. You should remove the &. The same with &$this, change it to $this. WordPress doesn't even run on PHP 4.x\n\n*The filter you found was just that persons attempt that they were asking how to fix, there are other ways to do what you want\n\n*An actual search solution will massively outperform this without needing to write custom SQL. Look into solutions such as Elasticsearch, Solr, etc\n\n*Generally it's far safer to use $wpdb->prepare, though sometimes that isn't always possible. Needing to write SQL for WP tables is normally a warning sign that you're doing something wrong.\n\n*If you used double quotes then you wouldn't need to slash escape your single quotes inside the SQL string. E.g. \"'test'\" vs '\\'test\\''\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407213", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Allow all reset password links within the past 24 hours to be valid and accepted Right now if a user requests a reset password link (link A), then requests another reset password link (link B), link A no longer works - WordPress considers the link invalid/expired.\nIs there a way in WordPress to allow all reset password links within the past 24 hours to be valid and accepted?\n\nI've been delving into the WordPress code and I can see one way to achieve this but its not a very nice solution. I'll show it below but does anyone have a nicer/cleaner solution they are aware of?\nSolution (in psuedo code):\n\n\n*\n\n*Hook login_form_lostpassword\n\n*Get user by their email\n\n*If this users user_activation_key is not empty and the last time they requested a reset password link is less than 24 hours ago:\n\n*\n\n*Resend the *email message that was sent before (that contains the same reset password link as before)\n\n\n\n*Else:\n\n*\n\n*Allow default behaviour to take over (generate a new reset password link and send an email containing the reset password link).\n\n\n\n\n*The icky-ness of the above solution is that I need to store the email body for every reset password email sent out (so I can retrieve it and resend it again if the user requests within 24 hours).\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407219", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How do i make this snippet work for order history page woocomerce I have this snippet which changes the title for the billing on checkout\nBut when you view in order history after order is placed, it does not change it and still says billing\n// Change the 'Billing details' checkout label to 'Outlet details'\nfunction wc_billing_field_strings( $translated_text, $text, $domain ) {\n    switch ( $translated_text ) {\n        case 'Billing details' :\n            $translated_text = __( 'Outlet details', 'woocommerce' );\n            break;\n    }\n    return $translated_text;\n}\nadd_filter( 'gettext', 'wc_billing_field_strings', 20, 3 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407220", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Can I change the URL structure for a CPT only? As I mentioned in the Title, I need to set my CPT \"Jobs\" post URLs to something like the following structure.\nhttps://domain.com/jobs?jobid=123\nWhere \"jobs\" is CPT slug and \"jobid\" is a meta key of the post.\nPlease let me know this can be achieved.\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407222", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Trigger a JavaScript function based on the data fetched from Woo commerce hook I have read quite a lot of possible ways to do it but after going through each of them I'm still not able to understand what should be the correct way of doing it and how the correct way works. \nQuestion:\nWhen the woo-commerce add to cart hook woocommerce_add_to_cart is triggered I want to send the recently added product data (and also user data) from a javascript function to an analytics data collector tool (through analytics.io in this case).\nProblem in implementation:\nThe hooks such as wp_head wp_footer are able to run javascript code inside of them either by wp_localize_script or echo <script>//some js code</script>. Whereas the woocommerce hooks such as woocommerce_add_to_cart can't run javascript code inside them. As per my understanding this is due the fact that woocommerce_add_to_cart update is happening via ajax.\nWhat I've tried till now:\nOne possible solution I found was when the woocommerce_add_to_cart hook is triggered change the data attribute of the Add to cart button and then read them in the jQuery script via added_to_cart event. For reference, I implemented this: https://stackoverflow.com/questions/62780949/get-specific-woocommerce-product-data-on-added-to-cart-javascript-event and this works.\nWhat I want:\n\nI want to update/create a javascript object when the woocommerce hook is triggered and then send that data via a javascript function to the analytics tool. Is adding data attributes to the button/HTML element a good way to do this task?\n\nP.S- I'm new to the WordPress/Php ecosystem and would really appreciate it if someone can explain a possible solution to my question in detail.\n\nA: After going through a lot of articles and solutions I finally figured it out:\nDirectory Structure for the plugin (Boilerplate directory structure used from here)\nFirst step:\nRegister a js script which would track the event/ user activity and pass it the ajax URL through which it would fetch the product details via ajax.\n// admin/class-pluginname-admin.php or public/class-pluginname-public.php\n\nfunction register_my_scripts(){\nwp_register_script('script_alias', ...);\nwp_localize_script('script_alias', 'localParams', array('ajax_url'=>admin_url('admin-ajax.php')));\nwp_enqueue_script('script_alias');\n}\n\nSecond:\nCreate a js file which would make an ajax call when the trigger occurs.\n// event-js-file.js\n...\n\n$.ajax({\nurl: localParams.ajax_url,\ntype: \"POST\",\ndata:{\naction: \"my_custom_action\", // calling the custom ajax action\n// send data via this post request\n},\nsuccess: function(res){// success response of the request},\nerror: function(err){// error as response of the request}\n});\n\nThird:\nCreate a custom ajax action which would respond to the request made via the js file and give the required data.\n// includes/class-pluginname.php\n\nadd_action('wp_ajax_my_custom_action', 'my_custom_function', priority_value);\nadd_action('wp_ajax_nopriv_custom_action', 'my_custom_function', priority_value);\nadd_action('wp_enqueue_scripts', 'register_my_scripts', priority_value);\n\n// admin/class-pluginname-admin.php or public/class-pluginname-public.php\n\nfunction my_custom_function(){\n// This is called via the js file ajax call.\n// Calculate or generate or resolve the data necessary and send the \n// response to the js script.\n}\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407226", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Sage wordpress add customize register I am working with customize register on sage wordpress\n//adding setting for copyright text\nadd_action('customize_register', 'theme_copyright_customizer');\n\nfunction theme_copyright_customizer($wp_customize) {\n    //adding section in wordpress customizer   \n    $wp_customize->add_section('copyright_extras_section', array(\n        'title'          => 'Copyright Text Section'\n    ));\n\n    //adding setting for copyright text\n    $wp_customize->add_setting('text_setting', array(\n        'default'        => 'Default Text For copyright Section',\n    ));\n\n    $wp_customize->add_control('text_setting', array(\n        'label'   => 'Copyright text',\n        'section' => 'copyright_extras_section',\n        'type'    => 'text',\n    ));\n}\n\nThis shows me\ncall_user_func_array() expects parameter 1 to be a valid callback, class xxx not found\n\nDo anyone has an idea?\n\nA: This is the solution for my question\n    add_action('customize_register', function ($wp_customize) {\n        $wp_customize->add_section('copyright_extras_section', array(\n            'title'          => 'Copyright Text Section'\n        ));\n    \n        //adding setting for copyright text\n        $wp_customize->add_setting('text_setting', array(\n            'default'        => 'Default Text For copyright Section',\n        ));\n    \n        $wp_customize->add_control('text_setting', array(\n            'label'   => 'Copyright text',\n            'section' => 'copyright_extras_section',\n            'type'    => 'text',\n        ));\n    });\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407230", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Alter core block's DOM - in both output AND editor I'd love to alter the inbuilt block .wp-block-file for downloading files, so we see the file's thumbnail picture. I know I can use\nadd_filter( 'render_block', 'MyFile' , 10, 2 );\n\nfunction MyFile( $block_content, $block ){\n  if ( 'core/file' !== $block['blockName']) return $block_content; // check if block is file block, else return\n  return \"MY CUSTOM DOM using \".$block[\"attrs\"][\"href\"];\n}\n\nbut that affects only the published page and doesn't change the block's appearance in editor.\nIs there a possibility to create e.g. a template file somewhere in my theme folder for the core block's DOM?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407233", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Exclude in get_pages() based on meta field I'm using get_pages() in order to get all the posts from a custom post type hierarchically for creating a custom \"next/previous\" navigation.\nI use it like this:\n    $sibling_list = get_pages(array(\n        'sort_column' => 'menu_order',\n        'sort_order' => 'asc',\n        'post_type' => 'guideline',\n    ));\n\nI want to exclude posts from this query based on if the post has a certain value to an ACF field. The field is named \"no-visit\" and has a boolean value. I want to exclude all posts that have \"no-visit\" set to true.\nIs this possible to do with get_pages()?\n\nA: You can using get_posts().\n$pages_args = array(\n  'orderby' => 'menu_order',\n  'parent' => 0,\n  'post_type' => 'guideline',\n  'post_status' => 'publish',\n  'meta_key'  => 'no-visit',\n  'meta_value' => 'true'\n);\n$pages = get_posts($pages_args);\n\n$pages_args = array(\n  'orderby' => 'menu_order',\n  'parent' => 0,\n  'post_type' => 'guideline',\n  'post_status' => 'publish',\n  'meta_query' => array(\n        array(\n            'key' => 'no-visit',\n            'value' => 'true',\n            'compare' => '='\n        )\n    )\n);\n$pages = get_posts($pages_args);\n\nmeta_compare Possible values are '!=', '>', '>=', '<', or '<='. Default value is '='\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407236", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Building a REST API for your web app exposes primary keys of DB records? I'm new to WP-REST and need to build a REST API for a wordpress project, but I'm somehow wondering about one aspect. Good practices say, and the built-in WP API for posts also shows, that you should use only nouns in routes, and let the HTTP methods like GET, POST, PUT, and DELETE define what the respective endpoint does. For this, let's assume you have something like:\n\n*\n\n*Base route: https://example.org/api/v1/customers\nAnd with that route, you use:\n\n*\n\n*GET https://example.org/api/v1/customers/<id> to get a customer\n\n*POST https://example.org/api/v1/customers + payload to create a customer\n\n*PUT https://example.org/api/v1/customers/<id> + payload to update a customer\n\n*DELETE https://example.org/api/v1/customers/<id> to delete a customer\n\nUsing this design, and extending it to relational endpoints, with sth like:\n\n*\n\n*GET https://example.org/api/v1/customers/<id>/products/<prod_id> to get a customer's product X\n\n*DELETE https://example.org/api/v1/customers/<id>/products/<prod_id> to delete a customer's product X\n\nHowever exposes practially your entire backend schema, including relationships of your tables or what they most likely are, to the public. I thus consider this as a security risk; and wanted to double-check: Am I missing out some fundamentals of REST API design? Or are you indeed supposed to expose your surrogate keys in REST APIs, like wordpress does it for example for posts?\n\nA: You are right, APIs should not expose internal data and structures, but if you depend on APIs not written by you, it will rarely be a good use of your time to develop a different API just feel better about this.\nAnd even if you develop your own API it is going to be hard to use for example something instead of post ids without making the API response even slower. You can probably use some kind symetric \"encryption\" for that, but I assume 99.9% of the developers will not see the point (I am in the 0.1%, but the reality is that something like that is unlikely to add any significant security for most sites)\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407239", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add custom posts to submenu automatically I'm trying to automatically add posts from a CPT to a submenu in Appearance > Menus.\nI've tried following this code suggested by @Bauwb\nadd_filter( 'wp_get_nav_menu_items', 'my_theme_nestjes_menu_filter',10, 3 );\n\nfunction my_theme_nestjes_menu_filter( $items, $menu, $args ) {\n  $child_items = array(); \n  $menu_order = count($items); \n  $parent_item_id = 0; \n\n  \n  foreach ( $items as $item ) {\n    if ( in_array('nestjes-parent-item', $item->classes) ){\n        $parent_item_id = $item->ID;\n    }\n  }\n\n  if($parent_item_id > 0){\n\n      foreach ( get_posts( 'post_type=nestjes-post-type&numberposts=-1' ) as $post ) {\n        $post->menu_item_parent = $parent_item_id;\n        $post->post_type = 'nav_menu_item';\n        $post->object = 'custom';\n        $post->type = 'custom';\n        $post->menu_order = ++$menu_order;\n        $post->title = $post->post_title;\n        $post->url = get_permalink( $post->ID );\n        array_push($child_items, $post);\n      }\n\n  }\n\n  return array_merge( $items, $child_items );\n}\n\nAuto add (multiple) Custom Post Types to menu\nbut I can't get it to work.\nDo I need to add the class nestjes-parent-item somewhere other than the custom CSS field on the menu item?\nThanks\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407242", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Save Custom Post Value I am learning WordPress Plugin Development. I have custom post type News. I am taking input using meta-boxes for this custom post.\nI added metabox using below code.\nadd_meta_box('news_settings', 'News Settings', [ $this, 'news_settings_html' ], 'News', 'normal', 'default');\n\nMy meta box code is like below.\npublic function news_settings_html()\n{\n    <?php\n        <label for=\"location\">\n            <?php _e('Location', 'textdomain');?>\n        </label>            \n        <input type=\"text\" name=\"location\"/>\n    ?>\n}\n\nHow can I save this meta-boxes values ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407243", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Add action save post when create and publish I try to use the hook save_post in my wp but I have a problem. I do this :\nfunction when_save_post_match($post_id, $post){\n\nif (isset($post->post_status) && 'auto-draft' == $post->post_status) {\n    return;\n}\n\nif( 'match' == $post->post_type ){\n\n    $id_match = get_post_meta( $post_id, '_select_match_from_db', true );\n\n    $req = $bdd->prepare('INSERT INTO posts_matchs (id_match,id_post) VALUES\n        (\n            :id_match,\n            :id_post\n        )\n    ON DUPLICATE KEY UPDATE id_match = :id_match, id_post = :id_post');\n    $req->bindParam(':id_match', $id_match);\n    $req->bindParam(':id_post', $post_id);\n    $req->execute();\n    $req->closeCursor();\n}\n}\nadd_action('save_post', 'when_save_post_match', 10, 2);\n\nWhen I create a custom post \"match\", the action of inserting data into the db is NOT DONE. When I update a custom post \"match\", the action IS DONE.\nWhen I create and then delete a post match, the action IS DONE.\nI would like the action to be taken when I create a custom post match (and update) and just for the published post.\nI don't understand how to do this.\nAny idea ?\nThanks\nEDIT\nWith transition post status :\nfunction when_save_post_match( $new_status, $old_status, $post ) {\nif ( ( 'publish' === $new_status && 'publish' !== $old_status ) && 'match' === $post->post_type) {\n\n        $id_match = get_post_meta( $post->ID, '_select_match_from_db', true );\n\n        $req = $bdd->prepare('INSERT INTO posts_matchs (id_match,id_post) VALUES\n        (\n            :id_match,\n            :id_post\n        )\n    ON DUPLICATE KEY UPDATE id_match = :id_match, id_post = :id_post');\n        $req->bindParam(':id_match', 32);\n        $req->bindParam(':id_post', 20);\n        $req->execute();\n        $req->closeCursor();\n\n}}add_action( 'transition_post_status', 'when_save_post_match', 10, 3 );\n\nThis code does not work :-( and when I create a new match the mesage \"publication failed\" appears the first time I click on \"publish\" and desappear after clicking a second time on the \"publish\" button... Don't understand what Is going on\n\nA: I think one key question here is how _select_match_from_id meta value is saved? Is it some metafield on the post edit screen or from some other logic?\nIf I may assume that it is from a metafield, then you could just read its value from the $_POST array.\n\nYou could also improve your code by splitting the callback function into two, one for new posts and the other for updates, and moving the database action into a separate function.\nUsing the save_post_{$post->post_type} helps you eliminate the post type check from the callback. The save_post callback recieves also a third parameter bool $update which you can use to determine, if it is a new post that is saved or an post update.\nSo you could for example do the following,\n// Use post type specific actions to eliminate post type checking in callback\nadd_action('save_post_match', 'when_save_post_match', 10, 3);\nadd_action('save_post_match', 'when_update_post_match', 10, 3);\n\nfunction when_save_post_match(int $post_id, WP_Post $post, bool $update) {\n  // only new posts\n  if ( $update ) {\n    return;\n  }\n  // get data for new post\n  $id_match = new_posts_match_from_db($post_id);\n  // pass id and data to action\n  execute_database_action($post_id, $id_match);\n}\n\nfunction new_posts_match_from_db(int $post_id) {\n  // this could be from the posted values as below or some other logic\n  // TODO: update to match your setup\n  return $_POST['_select_match_from_db'] ?? null;\n}\n\nfunction when_update_post_match(int $post_id, WP_Post $post, bool $update) {\n  // only updates\n  if ( ! $update ) {\n    return;\n  }\n  // get data from post meta\n  $id_match = existing_posts_match_from_db($post_id);\n  // pass id and data to action\n  execute_database_action( $post_id, $id_match );\n}\n\nfunction existing_posts_match_from_db(int $post_id) {\n  return get_post_meta( $post_id, '_select_match_from_db', true );\n}\n\nfunction execute_database_action(int $post_id, $id_match) {\n  // your db action...\n}\n\nModify as needed.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407247", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress restrict access to rest only I'm using the wordpress only as a backend to my website so I basically need:\nan access to the admin panel (/wp-admin/)\nan access to the REST API (/wp-json/)\n\nHow can I turn off the whole blog view functionality? Right now it is still being crawled by bots.\n\nA: I'm not sure if this is a proper solution. But finally, I've decided to modify the blog theme.\n<?php\nfunction Redirect($url, $permanent = false)\n{\n    header('Location: ' . $url, true, $permanent ? 301 : 302);\n\n    exit();\n}\n\nRedirect('/blog/admin/wp-admin/', false);\n?>\n\nSo the Wordpress website is not accessible at all, but I'm still able to access wp-admin and wp-json.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407248", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to rewrite this file_get_contents() snippet using wp_remote_get() I have this piece of code, which uses file_get_contents(), as far as I know this does not work with WP, can someone help me how to rewrite the following code using wp_remote_get()?\n$bizt_a = json_decode(file_get_contents(\"https://karteritesed.hu/biztositok.json\"));\n$bizt_lista = \"\";\nforeach($bizt_a as $bizt){\n$bizt_lista .= \"<option value=\\\"\".$bizt.\"\\\">\".$bizt.\"</option>\";\n}\n\n\nA: So take this code:\n$bizt_a = json_decode(file_get_contents(\"https://karteritesed.hu/biztositok.json\"));\n\nSeparate it out so that we do 1 thing per line ( if you pass it straight into json_decode what happens if the request fails and that site is down? json_decode isn't expecting an error message! It's going to turn around and ask \"What's this?!\" )\n$json = file_get_contents(\"https://karteritesed.hu/biztositok.json\");\n$bizt_a = json_decode( $json );\n\nNow that each line does 1 thing and only 1 thing, we can ignore the json decoding part, and focus on fetching the contents of that URL.\nLets look up the examples at https://developer.wordpress.org/reference/functions/wp_remote_get/\nIt wants the URL as the first parameter, and the second parameter is where we can give it any additional options. I don't think you need additional options so we can leave that out\n$response = wp_remote_get( 'URL goes here...' );\n\n$response is an array that has the content of the URL, and other things, such as the headers, the response code etc. Afterall don't you want to check it worked? What if it was a 404 not found!!!\nSo lets do a quick check, remember HTTP 200 means OK  great everything worked:\nif ( is_wp_error( $response ) || ( wp_remote_retrieve_response_code( $response ) != 200 ) ) {\n    // something went wrong!!! Abort!!!\n}\n\nThen we can extract the text:\n$responseBody = wp_remote_retrieve_body( $response );\n\nAnd JSON decode it:\n$bizt_a = json_decode( $responseBody );\n\nThen you can continue like you did before.\nEven better, swap wp_remote_get for wp_safe_remote_get for added protection.\nhttps://developer.wordpress.org/reference/functions/wp_safe_remote_get/\nNote though, that making a request to another server is expensive!! You don't want to do this on every page load or your site will get slow. It also means your site will always be as slow or slower than karteritesed.hu because it has to grab that file. Save that JSON somewhere, maybe in a cache etc and things will run faster\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407249", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "1"}}
{"text": "Q: Is there a way I can fetch the WordPress Developer Code References with an API? I would like to fetch the WordPress functions, methods, classes, and hooks from here: https://developer.wordpress.org/ in JSON format. I know that it is a WordPress site, and that I can use WP API to pull posts and such from https://developer.wordpress.org/wp-json/wp/v2/, but I'm not finding where the functions, etc are located. Or is there a different API I can tap into?\nI'm building a discord bot for a WordPress development server, hoping to make a command that will display what a function does and link to the source page.\n\nA: It seems to be accessible from:\nhttps://developer.wordpress.org/wp-json/wp/v2/wp-parser-class\nhttps://developer.wordpress.org/wp-json/wp/v2/wp-parser-method\nhttps://developer.wordpress.org/wp-json/wp/v2/wp-parser-hook\nhttps://developer.wordpress.org/wp-json/wp/v2/wp-parser-function\nand search with e.g.\nhttps://developer.wordpress.org/wp-json/wp/v2/wp-parser-function?search=get_post_embed\nbut it's probably best to generate your own with the WP Parser here:\nhttps://github.com/WordPress/phpdoc-parser\nThis will create custom post types for\n\n*\n\n*wp-parser-hook\n\n*wp-parser-function\n\n*wp-parser-class\n\n*wp-parser-method\n\nand related post meta (to e.g. store function input arguments, line numbers, class type, hook type and namespace) and taxonomies (to store info on files, package, since, namespaces) in your own WP install.\nHere's the theme that runs on the code reference's site:\nhttps://github.com/WordPress/wordpress.org/tree/trunk/wordpress.org/public_html/wp-content/themes/pub/wporg-developer\nThere we can see how it displays e.g. a function's source code and a\nlist of a input parameters, using the theme's helper functions get_source() and get_params().\nI ran a test with:\ncd wp-content\ncd plugins\ngit clone https://github.com/WordPress/phpdoc-parser.git\ncd phpdoc-parser/\ncomposer install\nwp plugin activate phpdoc-parser\nwp parser create /path/to/source/ --user=test\n\nHere's a screenshot from my test install:\n\nAlso more DevHub info here:\nhttps://make.wordpress.org/docs/handbook/devhub/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407251", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "3"}}
{"text": "Q: update_term_meta not working I am trying to remove a string off of a bunch of slugs in terms from a CPT taxonomy.\nFor example, I have a term named \"Accounting\" but the slug has the \"accounting-expert-witnesses\" I just need to remove the \"-expert-witnesses\" part of the slug.\nI am using this post as a reference as it appears to be what am I looking for but I cannot seem to get any of the suggestions to work: How to update taxonomy custom field with wp_update_term()?\nI have tried using update_term_meta, update_post_meta, wp_update_term and none of them are doing what I need.\nThe closest I've got is using update_term_meta and it appears to be working when I error log the result however when I look at the terms in the dashboard nothing has been updated.\nI can't figure out what I'm doing wrong here?\n    function remove_stuff() {\n    $terms = get_terms( array(\n        'taxonomy' => 'experts_industries',\n        'hide_empty' => false,\n    ) );\n\n    foreach($terms as $term) {\n\n        $newSlug = str_replace('-expert-witnesses', '' , $term->slug);\n\n        //update_term_meta($term->id, 'slug', $newSlug);\n\n        //update_post_meta($term->id, 'slug', $newSlug); \n\n        wp_update_term($term->id, 'experts_industries', array( 'slug' => $newSlug ));\n\n        error_log($term->slug);\n\n    }\n}\nadd_action( 'wp_loaded', 'remove_stuff' );\n\n\nA: A terms slug is not stored as meta/custom fields, and it's definitely not post meta, so update_term_meta and update_post_meta are innapropriate and can never be used to achieve your goal.\nThe correct function is wp_update_term, however you've used that incorrectly too:\n\n*\n\n*$term->id isn't a thing, if we look at the WP_Term class and the examples on the official docs, we see $term->term_id is what should be used\n\n*there is no code checking the return value of wp_update_term, if it failed there would have been a WP_Error object with an error message explaining what happened.\n\n*error_log($term->slug); doesn't fetch the new slug from the database or make a new query to check for a new slug, this cannot be used to test if it worked. You need to check the return value of wp_update_term instead\n\nFrom the official dev docs:\n\nReturn\n(array|WP_Error) An array containing the term_id and term_taxonomy_id, WP_Error otherwise.\n\nMore examples and information at:\n\n*\n\n*https://developer.wordpress.org/reference/functions/wp_update_term/\n\n*https://developer.wordpress.org/reference/classes/wp_term/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407256", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Catch metabox values in Plugin I am learning WordPress Plugin development. I would like to catch values of MetaBox. I found below code in Plugin development Handbook.\nfunction wporg_save_postdata( $post_id ) {\n    if ( array_key_exists( 'wporg_field', $_POST ) ) {\n        update_post_meta(\n            $post_id,\n            '_wporg_meta_key',\n            $_POST['wporg_field']\n        );\n    }\n}\nadd_action( 'save_post', 'wporg_save_postdata' );\n\nBut in which File should I place these codes ?\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407260", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Custom AJAX Endpoint not returning any result Hello I'm new to Wordpress and I'm trying to create an ajax endpoint that outputs JSON so I can access it through jQuery Datatables. I'm using Air Light theme for my current site and what happens when I go into /wp-admin/admin-ajax.php?action=ajax_endpoint is that it just gives me 0. I tried querying posts, users, and my custom tables they all give me 0 even though I have a status code 200.\nI'm wondering if there's something wrong I'm doing here. I've also tried putting an echo somewhere in the function and it does not show up.\nfunctions.php\nnamespace Air_Light;\n\n/**\n * The current version of the theme.\n */\ndefine( 'AIR_LIGHT_VERSION', '8.3.2' );\n\n/**\n * Theme setup code\n*/\n\n\nadd_action('wp_ajax_ajax_endpoint', 'ajax_endpoint');\nadd_action('wp_ajax_no_priv_ajax_endpoint', 'ajax_endpoint');\nfunction ajax_endpoint(){\n  global $wpdb;\n  $results = $wpdb->get_results('SELECT * FROM table');\n  \n  echo json_encode($results);\n  wp_die();\n}\n\n\nA: You need to use the defined namespace as the prefix for the add_action callbacks so that PHP knows which function it is supposed to call. More on this here, add_action in namespace not working\nThe add_actions should look like this then,\nadd_action('wp_ajax_ajax_endpoint', __NAMESPACE__ . '\\\\ajax_endpoint');\nadd_action('wp_ajax_nopriv_ajax_endpoint', __NAMESPACE__ . '\\\\ajax_endpoint');\n\nWhen doing development work it is a good idea to have debugging on so that you can check debug.log for error messages, which usually tell you what is wrong with the code and why it isn't working. Debugging in WordPress\nAs a side note, for sending a json response you can also use wp_send_json(), wp_send_json_error(), and wp_send_json_success().\n\nA: It seems the issue is because of incorrect hook_name. You have used wp_ajax_no_priv_{$action} instead of wp_ajax_nopriv_{$action}\nAlso use wp_send_json() for send response in json format.\nadd_action('wp_ajax_ajax_endpoint', 'ajax_endpoint');\nadd_action('wp_ajax_nopriv_ajax_endpoint', 'ajax_endpoint');\nfunction ajax_endpoint(){\n  $results = array(\"Test Result\");\n  wp_send_json($results);\n  wp_die();\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407263", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to put post title or keyphrase in content on different places automatically? I want to repeat my title/keyword in different places in my content.\nfor example, my title is \"Dog\"\nI want to replace \"Dog\" everywhere I have inserted *** or any hint.\nhow this is possible easily?\n\nA: You can search-replace those placeholders with the_content filter.\nfunction custom_the_content( $content ) {\n    return str_replace('{placeholder}', get_the_title(), $content);\n}\nadd_filter('the_content', 'custom_the_content');\n\nNote: I don't recommend using *** or similar as a placeholder, as it can be commonly used. That is why I've used {placeholder}.\nUPDATE: Based on the comments below, if you need to search-replace multiple values within the_content filter, use arrays as str_replace arguments like below:\nfunction custom_the_content( $content ) {\n\n    // Search for these elements\n    $search = array(\n        '{apktitle}',\n        '{apkversion}',\n    );\n\n    // And replace them with these (the order of array items is preserved)\n    $replace = array(\n        get_the_title(),\n        get_datos_info('version'),\n    );\n\n    return str_replace( $search, $replace, $content );\n}\nadd_filter('the_content', 'custom_the_content');\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407269", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Wordpress Primary Category Changes After Import, Permalink Issue Ok my Permalink structure is like this -\nwww.website.com/category/post-name\nNow, I have two parent categories assigned to a post cat1 and cat2.\nSo Permalink structure become\nwww.website.com/cat1/post-name (i clicked cat1 first that's why this category is on url)\nLater I took backup of my post via inbuilt wordpress export function and got my XML file.\nI deleted wordpress and installed from scratch and imported the XML file via Tools > import and now Permalink changes to\nwww.website.com/cat2/post-name\nHow to fix this. Please help.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407273", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Validate and Sanitize WP REST API Request using WP JSON Schema? I'm currently setting up my first WP REST API and am attempting to understand how WP implements JSON Schema for the API endpoints, and the docs are imho really poor and confusing; so I wanted to make sure that I understand things properly:\n\n*\n\n*According to this, you can specify the 'schema' parameter within the $args argument when registering a new rest route, to provide a JSON schema informing about the structure of the response of your endpoint. That schema should be delivered to any client making an OPTIONS HTTP request to the according endpoint. That works.\n\n\n*You can then specify any combination of the WP JSON Schema parameters for every parameter of your $args array when using register_rest_route, to inform about the required format of the request's arguments, for that respective endpoint. When I add for example a description key to the argument X of the endpoint Y, and then inspect the general https://example.org/wp-json/ REST schema of the website via GET, that description indeed shows up under the argument X of my API endpoint Y. So that also works.\n\n\n*What I totally don't understand is, how can I use the JSON schema I've specified in 2) for validation and subsequent (if validation is passed) sanitization? The docs mention the built-in rest_validate_value_from_schema and rest_validate_value_from_schema functions, but do not really show any examples / explain how you implement your JSON schemas provided for the request data (step 2))  for validation / sanitization.\nHow is that actually done using WP's built-in JSON schema ?\n\nA: You're already providing a schema, the parameters in args are their own schemas, but WordPress does not enforce this schema or perform sanitisation/validation by default.\nYou can make WordPress enforce it though by setting the validation and sanitisation callbacks to the following:\n'sanitize_callback' => 'rest_sanitize_request_arg',\n'validate_callback' => 'rest_validate_request_arg',\n\nrest_validate_request_arg will look up the parameter in the args and use that as the schema and pass it to rest_validate_value_from_schema for validation. The format of each parameter in the args section is also the format of the schema for that input because it is a schema.\nFor example, this is how WordPress defines validates and enforces the per_page parameter in the args section of collection endpoints:\n            'per_page' => array(\n                'description'       => __( 'Maximum number of items to be returned in result set.' ),\n                'type'              => 'integer',\n                'default'           => 10,\n                'minimum'           => 1,\n                'maximum'           => 100,\n                'sanitize_callback' => 'absint',\n                'validate_callback' => 'rest_validate_request_arg',\n            ),\n\nAnd here is how it does it internally:\nfunction rest_validate_request_arg( $value, $request, $param ) {\n    $attributes = $request->get_attributes();\n    if ( ! isset( $attributes['args'][ $param ] ) || ! is_array( $attributes['args'][ $param ] ) ) {\n        return true;\n    }\n    $args = $attributes['args'][ $param ];\n \n    return rest_validate_value_from_schema( $value, $args, $param );\n}\n\nThere is also a rest_sanitize_request_arg for sanitisation, but this is used in fewer locations in core itself.\n\n*\n\n*https://developer.wordpress.org/reference/functions/rest_sanitize_request_arg/\n\n*https://developer.wordpress.org/reference/functions/rest_validate_request_arg/\n\n*https://github.com/WordPress/WordPress/blob/c7d3e267b8a7aebc28b23efa74b2971602852315/wp-includes/rest-api/endpoints/class-wp-rest-controller.php#L348\n\nA: So the way to do what's mentioned can be reached by the following, coded in your main plugin file or the active theme's functions.php. But as you see, I need to specify the JSON schema used for validation, sanitization, and request argument documentation. I just would like to know if there's a way to provide that schema only once and use it everywhere (of course in a way different from just storing it in a variable).\nadd_action(\n                'rest_api_init',\n                function () {\n                    \n                    // Register Route - START\n                    \n                    register_rest_route(\n                        'api/v1',\n                        '/zoo',\n                        [\n                            [\n                                'methods'             => 'POST',\n                                'permission_callback' => function ( WP_REST_Request $request ) { // authenticate client + check nonce\n                                },\n                                'callback'            => 'controller_callback',\n                                'args'                => [\n                                    'animal' => [\n                                        'type' => 'string',\n                                        'oneOf' => ['lion','tiger'],\n                                        'description' => \"string determining the kind of animal you're trying to create\",\n                                        'required'          => true,\n                                        'validate_callback' => function ( $param ) {\n                                            return rest_validate_value_from_schema( $param, ['type' => 'string', 'enum' => ['lion','tiger']]);\n                                        },\n                                        'sanitize_callback' => function ( $param ) {\n                                            return rest_sanitize_value_from_schema( $param, ['type' => 'string', 'enum' => ['lion','tiger']]);\n                                        }\n                                    ],\n                                    '_wpnonce' => [\n                                        'required' => true\n                                    ]\n                                ]\n                            ],\n                            'schema' => function() { return array(\n                                // This tells the spec of JSON Schema we are using which is draft 4.\n                                '$schema'              => 'http://json-schema.org/draft-04/schema#',\n                                // The title property marks the identity of the resource.\n                                'title'                => 'animal',\n                                'type'                 => 'object',\n                                // In JSON Schema you can specify object properties in the properties attribute.\n                                'properties'           => array(\n                                    'id' => array(\n                                        'description'  => 'ID of the created animal',\n                                        'type'         => 'integer',\n                                        'readonly'     => true,\n                                    ),\n                                    'animal' => array(\n                                        'description'  => 'identifier of the animal type',\n                                        'type'         => 'string',\n                                    )\n                                )); }\n                        ]\n                    );\n    \n                    // Register Route - END\n                }\n            );\n\n\nA: So the finally correct (and tested) way to implement what I was looking for is:\nadd_action(\n                'rest_api_init',\n                function () {\n                    \n                    // Register Route - START\n                    \n                    register_rest_route(\n                        'api/v1',\n                        '/zoo',\n                        [\n                            [\n                                'methods'             => 'POST',\n                                'permission_callback' => function ( WP_REST_Request $request ) { // authenticate client + check nonce\n                                },\n                                'callback'            => 'controller_callback',\n                                'args'                => [\n                                    'animal' => [\n                                        'type' => 'string',\n                                        'enum' => ['lion','tiger'],\n                                        'description' => \"string determining the kind of animal you're trying to create\",\n                                        'required'          => true,\n                                        'validate_callback' => 'rest_validate_request_arg',\n                                        'sanitize_callback' => 'rest_sanitize_request_arg'\n                                    ],\n                                    '_wpnonce' => [\n                                        'required' => true\n                                    ]\n                                ]\n                            ]\n                        ]\n                    );\n    \n                    // Register Route - END\n                }\n            );\n\nAs a side-note, be aware that using JSON schema arguments exposes your argument validation + sanitization criteria through your endpoints, and will cause default responses with clear details about where your validation / sanitization failed.\nThis is perfect for development environments, but if you do not want this to happen in production environments, you're better off using custom validation and sanitization callbacks, where you can explicitly determine the information returned to your client in case of any failure, as documented here.\nWas just a final thought I had on this story.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407275", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Woocommerce check if email already created order recently I'm using woocommerce for my client to sell product worldwide. We don't force to create an account during the checkout so the user can buy without registration. Some times we get multiple order from the same user in few minutes, so i'm wondering if it is possible during the checkout to verify if from the same email we received an order (completed with payment) in the last 10 minutes. In case the email already exist in the last orders the system must block the checkout process.\nWe use stripe for payments and we lose money when we have to refund the user for multiple orders.\nThanks\n\nA: You can create a helper function for that which qurries the orders for given email and created less than 10 mins ago.\nfunction wpse407278_check_if_ordered_in_last_10_mins( $email ) {\n    \n    if ( !isset($email) || empty($email) ) {\n        return false;\n    }\n    \n    $args = array(\n        'customer' => $email,\n        'date_created' => '>' . ( time() - strtotime('-10 minutes') ),\n    );\n    $orders = wc_get_orders( $args );\n\n    if ( empty( $orders ) ) {\n        return false;\n    }\n    return true;\n}\n\nThis will return true if the customer has orderd within last 10 minutes and false otherwise.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407278", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Full documentation about $args for register_rest_route? I'm currently setting up a WP REST API, and the tool is really impressive and the amount of possibilities vast. I would however really love it to have a full documentation listing all of the possible keys you can provide for $args when calling register_rest_route, just as you have it with register_post_type.\nWe're slowly building our own documentation with the gathered information across different pages since more than a week now, but wondered if there isn't a full documentation on this?\n\nA: \nfull documentation listing all of the possible keys you can provide\nfor $args when calling\nregister_rest_route,\njust as you have it with\nregister_post_type\n\nregister_rest_route(), as of writing, doesn't have such a documentation; however, you can call $request->get_attributes() inside of your endpoint callback to get the full (registration) options (including those not explicitly specified) for that specific endpoint.\n\n*\n\n*Excerpt from https://developer.wordpress.org/rest-api/requests/#attributes:\n\nIf we made a GET request to my-namespace/v1/books, and then we called $request->get_attributes() inside of our endpoint callback, we would be returned all of the registration options for the my-namespace/v1/books endpoint.\n\n\nIn the attributes we will get a response containing supported methods, options, whether to show this endpoint in the index, a list of registered arguments for the endpoint, and our registered callbacks.\n\nSo for example, the following registers a route containing 2 endpoints:\nadd_action( 'rest_api_init', 'my_plugin_register_rest_routes' );\nfunction my_plugin_register_rest_routes() {\n    register_rest_route( 'my-plugin/v1', 'foo', array(\n        // Endpoint 1 - Get an item.\n        array(\n            'callback'            => 'my_plugin_rest_get_foo',\n            'permission_callback' => '__return_true',\n        ),\n\n        // Endpoint 2 - Create an item.\n        array(\n            'methods'             => 'POST',\n            'callback'            => 'my_plugin_rest_create_foo',\n            'permission_callback' => 'my_plugin_rest_create_foo_permissions_check',\n            'args'                => my_plugin_rest_create_foo_arguments(),\n            'show_in_index'       => false,\n        ),\n    ) );\n}\n\nfunction my_plugin_rest_get_foo( WP_REST_Request $request ) {\n    return $request->get_attributes();\n}\n\nfunction my_plugin_rest_create_foo( WP_REST_Request $request ) {\n    return array( $request->get_attributes(), $request->get_params() );\n}\n\nfunction my_plugin_rest_create_foo_permissions_check() {\n    return current_user_can( 'manage_options' );\n}\n\nfunction my_plugin_rest_create_foo_arguments() {\n    $args = array();\n\n    $args['title'] = array(\n        'type'              => 'string',\n        'required'          => true,\n        'sanitize_callback' => 'my_plugin_title_arg_sanitize_callback',\n    );\n\n    $args['color'] = array(\n        'type'     => 'string',\n        'required' => true,\n        'enum'     => array( 'red', 'green', 'blue' ),\n    );\n\n    return $args;\n}\n\nfunction my_plugin_title_arg_sanitize_callback( $value, WP_REST_Request $request, $param ) {\n    return wp_filter_kses( $value ); // allows basic HTML; e.g. <b> is OK, but not <hr />\n}\n\nAnd here's what the endpoint callback returned in my case (WordPress v6.0):\n\n*\n\n*GET my-plugin/v1/foo\nRequest via cURL:\ncurl -X GET https://example.com/wp-json/my-plugin/v1/foo\n\nSample response:\n{\n    \"methods\": {\n        \"GET\": true\n    },\n    \"accept_json\": false,\n    \"accept_raw\": false,\n    \"show_in_index\": true,\n    \"args\": [],\n    \"callback\": \"my_plugin_rest_get_foo\",\n    \"permission_callback\": \"__return_true\"\n}\n\n\n\n*POST my-plugin/v1/foo\nRequest via cURL:\ncurl --user \"<username>:<application password>\"\n    -X POST https://example.com/wp-json/my-plugin/v1/foo\n    -H \"Content-Type: application/json\"\n    -d '{\"title\": \"test with <b>HTML</b><hr /> yeah\", \"color\": \"blue\"}'\n\nSample response:\n[{\n    \"methods\": {\n        \"POST\": true\n    },\n    \"accept_json\": false,\n    \"accept_raw\": false,\n    \"show_in_index\": false,\n    \"args\": {\n        \"title\": {\n            \"type\": \"string\",\n            \"required\": true,\n            \"sanitize_callback\": \"my_plugin_title_arg_sanitize_callback\"\n        },\n        \"color\": {\n            \"type\": \"string\",\n            \"required\": true,\n            \"enum\": [\"red\", \"green\", \"blue\"]\n        }\n    },\n    \"callback\": \"my_plugin_rest_create_foo\",\n    \"permission_callback\": \"my_plugin_rest_create_foo_permissions_check\"\n}, {\n    \"title\": \"test with <b>HTML<\\/b> yeah\",\n    \"color\": \"blue\"\n}]\n\nSo as you could see, each endpoint contains 7 top-level attributes, namely:\n\n*\n\n*methods \u2014 One or more HTTP methods allowed for the endpoint.\n\n\n*args \u2014 Arguments for the endpoint.\n\n\n*callback \u2014 The main callback function for responding to the request.\n\n\n*permission_callback \u2014 A function which checks if the user can perform the action (reading, updating, etc.) before the real/main callback is called.\nNote: As of WordPress v5.5, if a permission_callback is not provided, the REST API will issue a _doing_it_wrong notice. So at bare minimum, an endpoint should always have both callback and permission_callback. And for REST API routes that are intended to be public, you can use __return_true as the permission callback.\n\n\n*show_in_index \u2014 A boolean indicating whether the endpoint should be included in the route index, e.g. at https://example.com/wp-json/my-plugin/v1 in my case.\nNote: You can omit your REST routes/endpoints from the index by using 'show_in_index' => false when registering your REST routes. However, the routes themselves will still be accessible. But you can use the permission callback to limit access to your endpoints.\n\n\n*accept_json and accept_raw \u2014 In REST API v1, (I believe) they were WP_JSON_Server::ACCEPT_JSON and WP_JSON_Server::ACCEPT_RAW respectively.\nBut in REST API v2, those \"accept_xxx\" are false by default, so I don't know what these are for in REST API v2. Maybe they're defined just for back-compat? \nAnd as for the first four attributes above, they're well-documented in the REST API handbook:\n\n*\n\n*https://developer.wordpress.org/rest-api/extending-the-rest-api/adding-custom-endpoints/\n\n*https://developer.wordpress.org/rest-api/extending-the-rest-api/routes-and-endpoints/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407287", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Build a must-use plugin that tracks when other plugins are activated or deactivated Here I am trying to utilize add_action to add a callback function to the hooked action of 'deactivate_plugin', but my function is not echoing as I expect.\n$plugin = 'polls_plugin';<br>\nfunction detect_plugin_deactivation( $plugin ) {\n    \n    echo \"$plugin was deactivated.\";\n\n}\n\nadd_action('deactivated_plugin', 'detect_plugin_deactivation', 10, 3);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407288", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Adding Parent Categories and keep current URLs I have a website that contains 200 categories with thousands of words in on every category page. Most of these category pages is where my traffic comes from, and have the following URL structure: example.com/tennis-shoes/.\nHowever, now I want to add parent categories in order to organize the content for my visitors, which means that the URL:s will be example.com/parent-category-name/tennis-shoes/. This will obviously have a major negative impact on my rankings and it's therefor something I don't want to risk.\nI've done some research and testing and realized that I have 2 problems with this addition of parent categories, namely the website URLs and the sitemap URLs.\nThe sitemap URLs I've managed to change with the following code:\nfunction sitemap_post_url( $url, $term, $object ) {\n    // Remove the parent category slug from the URLs by replacing it with an empty string\n    if (strpos($url, '/tennis-shoes/') !== false) {\n        return str_replace(\"/tennis-shoes/\", \"\", $url);\n    }\n\n    return $url;\n}\nadd_filter( 'wpseo_sitemap_entry', 'sitemap_post_url', 10, 3 );\n\nAs for the website URLs I don't know what to do, maybe I need to add some kind of redirect hook/filter in functions.php - similar to the filter code above - so that the URL:s to my now child categories (since I've added parents) exclude the parent slug from the URL so it does not affect my current indexed URLs.\nIn short what I want to do is to organize my site with parent categories but keep all my current URLs so it doesn't affect me SEO.\nHence, my questions are:\n\n*\n\n*How can I exclude the parent category slug for the website URLs, just\nlike I do for the sitemap URLs with the filter code?\n\n*If I manage to\nsolve the above, will my SEO to my currently indexed categories (and\n90% of my search traffic) be affected in a negative way by adding\nthese parent categories in order to improve the structure for my\nvisitors?\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407289", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Does WordPress do any internal caching if no plugin installed? I am editing my own plugin.\nWhen I make a change on one specific PHP page that is included when the plugin loads, the changes are not shown when I reload the site.  Edits on any other page are seen as expected.\nIf I do something as simple as make a copy of the page (with no edits) and include the copy instead, it works as expected.\nI have deleted all other plugins.\nI run my own server and the data centre says it isn't server related.\nCould this be being caused by WordPress itself?\n[UPDATE] I removed WordPress and reinstalled from scratch and the problem has disappeared.  I am still curious about what might have been causing this though.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407292", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Save Multiple Metabox values How to Save Multiple Metabox values ?\nI have 3 fields like below image.\n\nShould I use below code ?\nif (isset($_POST['name'])) {\n    update_post_meta($post_id, 'name', sanitize_text_field($_POST['name']));\n}\n\nif (isset($_POST['address'])) {\n    update_post_meta($post_id, 'address', sanitize_text_field($_POST['address']));\n}\n\nif (isset($_POST['phone'])) {\n    update_post_meta($post_id, 'phone', sanitize_text_field($_POST['phone']));\n}\n\nIs there any way to Save multiple metabox values ?\n\nA: I don't know where this code exists, if it's in a callback of a ajax or post event but it doesn't really matter.\nAssuming your code works as expected you could make it a bit easier to manage, lets say you have another 7 meta fields you need to update, you'll need to copy paste your if conditions every time which is not ideal.\nPHP also has a built in function for dealing with requests, filter_input, this function allows you to sanitize and validate the request data exactly as you need it, there are many flag for data types and common values like email.\nSo you could do something like this\n$fields = [\n    'name'    => FILTER_SANITIZE_STRING,\n    'address' => FILTER_SANITIZE_STRING,\n    'phone'   => FILTER_SANITIZE_NUMBER_INT,\n];\n\nforeach ($fields as $field_name => $flag) {\n    if (!empty($field = filter_input(INPUT_POST, $field_name, $flag))) {\n        update_post_meta($post_id, $field_name, sanitize_text_field($field));\n    }\n}\n\nSo now if you need to add another field, lets say email, you can just update the $field array instead of creating a new condition.\nThis\n$fields = [\n    'name'    => FILTER_SANITIZE_STRING,\n    'address' => FILTER_SANITIZE_STRING,\n    'phone'   => FILTER_SANITIZE_NUMBER_INT,\n    'email'   => FILTER_SANITIZE_EMAIL\n];\n\nInstead of another\nif (isset($_POST['email'])) {\n    update_post_meta($post_id, 'phone', sanitize_text_field($_POST['email']));\n}\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407293", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Post date automatically +100 years into the future Thank you for taking time to read my questions as I understand the request is a bit odd.\nCurrently I am doing posts in the Sci-Fi genre and would like the posts to come out reading 2122 instead of 2022. Is this possible to do automatically? I am using Elementor Pro's Post list function to display it on the page.\nAny suggestions you can give would be appreciated.\n-Fish\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407299", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to embed the Taxonomy Admin screen in to a Tab of a Settings Page in a plugin I am building a Plugin which has a number of custom post types and some associated taxonomies.\nWhat I am trying to do is to embed the edit-tags screen for specific taxonomies in the Settings Tab of my plugin.\nI have looked everywhere for a solution which uses a hook or similar, rather than writing a custom bit of code to do all the taxonomy admin functions.\nThe purpose of this is then there is just one area for setting up everything in my plugin.\nThanks for help in advance.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407302", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Which table (and column) has the content of configured get_post_meta? I have an already up and running WP web site. Its fully configured - some years ago :-/ Now there is the request to change the image. Somehow I don't know any longer how to do it. I managed nevertheless to find the cirtical code:\n <?php if (get_post_meta($curentPostID, \"page_top_img\", true) != ''): ?>\n\nTo my understanding the code would mean: For each post there is a \"meta\" tag with name page_top_img configured. I have  access to the database. Therefore the question arises where to find the configured data?\ni.e. Which table and which column contains the above information?\nSince I know the content (=result) from the web page I could do some kind of reverse engineering. Help would be highly appreciated.\n\nA: Post meta data is stored in the wp_postmeta table, the prefix wp_ may also be something else depending on your setup, in the meta_value column.\n\nIf there isn't a metabox in the post edit screen for updating the value, then instead of modifying the database directly you could temporarily add update_post_meta() call to your functions.php file (hooked to some action for example) to change the value - removing the function afterwards.\nOr if WP CLI is available, use wp post meta update command.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407307", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Prevent direct access to Wordpress plugin assets? I was wondering if there was a simple way to prevent direct access to asset files within a WordPress plugin. Primarily javascript files.\nI'm developing a plugin that's meant to be used only in the admin dashboard, and I would like the javascript files this plugin uses to not be exposed to the public. It should only be able to be run by a logged-in admin on the dashboard.\nCurrently, anyone can access a plugin asset file directly through the URL via\nhttps://DOMAIN.com/wp-content/plugins/YOURPLUGIN/assets/YOURJSFILE.js\nSo if somewhere were to somehow get that domain they can few the JS file.\nHope that question makes sense.\nThanks!\n\nA: so you need to make sure you are using the hook \"admin_enqueue_scripts\". this only loads the script on the admin side.\nadmin_enqueue_scripts is the proper hook to use when enqueuing scripts and styles that are meant to be used in the administration panel. Despite the name, it is used for enqueuing both scripts and styles.\nyou can find more about the function here https://developer.wordpress.org/reference/hooks/admin_enqueue_scripts/\nHope this was helpful.\n\nA: WordPress provides no mechanism for granular control of filesystem/server access - rather this is something which would be managed through server configuration. WordPress server environments are generally configured to entirely skip loading WordPress and directly serve any URL which resolves to an actual filepath.\n@Abraham.Olaobaju's answer is generally sufficient - the vast majority of servers are not configured to present a filesystem index when accessing a directory, so if the assets are only enqueued within the dashboard (ideally only on the relevant pages) then it is unlikely that general public users/visitors could become aware of the assets in order to request them directly, despite the files technically remaining available for direct access to all.\nIf it is absolutely imperative that you protect access to file assets in situations where you do not have control over the server configuration, the only way I can think of to enforce access control would be to store the assets' contents in some medium other than a servable file. The easiest route to doing so is probably to define the contents as a PHP string and conditionally perform the delivery via a wp_add_inline_script() call within your admin_enqueue_scripts hook (I've opted for HEREDOC string syntax in order to most easily facilitate whatever quotes which the script might contain):\nfunction wpse407311_admin_script() {\n  return <<SCRIPT\n    console.log( 'Hello World!' );\n  SCRIPT;\n}\n\nfunction wpse407311_enqueue_admin_assets() {\n  wp_enqueue_script( 'wpse407311-admin-script-dummy', '', [ 'jquery' ] );\n  wp_add_inline_script( 'wpse407311-admin-script-dummy', wpse407311_admin_script() );\n}\n\nadd_action( 'admin_enqueue_scripts', 'wpse407311_enqueue_admin_assets' );\n\nIt is somewhat detrimental to developer experience to remove asset code from appropriately typed files - if you're using this mechanism with larger assets or in a more complex project, it would probably be prudent to use a build step to generate PHP files containing the asset strings.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407311", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: May I do multiple micro-sites with different themes in a single wordpress without subdirectory nor subdomain separation? I need to setup a domain example.com with about a thousand pages, which represent about 100 micro-sites of about 10 pages each.\nThe thing is that I need that there's no subdomains nor sub-folder separation.\nSay that:\n\n*\n\n*pages A, B and C interlink together, but not to KLM nor XYZ.\n\n*pages K, L and M interlink together, but not to ABC nor XYZ.\n\n*pages X, Y and Z interlink together, but not to ABC nor KLM.\n\nBut, intentionally, there's no signal to the user about the grouping.\nQuestion:\nIs it possible to run example.com/page-a, example.com/page-b and example.com/page-c  with one theme and color settings (for example Kadence, light), then example.com/page-k, example.com/page-l and example.com/page-m with another theme and color settings (say Understrap) and then maybe example.com/page-x, example.com/page-y and example.com/page-z to use the same theme than ABC but with another color scheme (for example Kadence with dark theme)?\nIn short I want \"separate microsites\" from the design point of view but \"mixed\" from the URLs point of view.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407314", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Is it important to have integers inserted using %d rather than %s? Is it important to have integers inserted using %d rather than %s?\nI have a situation where there is a large number of fields and values.  When database changes are made, it is difficult to match all the field types to the data format.  It would be much easier to have them all be %s, even integers, but I am not sure of the ramifications of that.\n    $data = array(\n            \n        'field1'    => $this->val1,\n        'field2'    => $this->val2,\n        'field3'    => $this->val3,\n<snip>\n        'field100'  => $this->val4\n     )\n\n$format = array(  '%d', '%s', '%d',  <snip> '%s');\n\n$wpdb->insert( $db_example, $data, $format );\n\n\nI know the format option is optional, again, what are the possible ramifications of not using it at all?\n\nA: Going by the description for the $format argument\n\nAn array of formats to be mapped to each of the value in $data. If string, that format will be used for all of the values in $data. A format is one of '%d', '%f', '%s' (integer, float, string). If omitted, all values in $data will be treated as strings unless otherwise specified in wpdb::$field_types.\n\nSo unless the type is important for your column structure you can leave it as string.\nYou can however create a dynamic format array if you want to, something like this.\n$data = [\n    'This is a string', // string\n    55, // integer\n    3.7, // float (double)\n    true, // boolean\n];\n\n$format = array_map(function ($value) {\n    switch (gettype($value)) {\n        case 'string':\n            return '%s';\n        case 'integer':\n            return '%d';\n        case 'double':\n            return '%f';\n        default:\n            return '%s';\n    }\n}, $data);\n\nprint_r($format);\n\nYou can test this on https://3v4l.org/\nWhat we have here is a basic format builder based on the type of each array element, we always default to %s, also there is no need for a break; as we always return.\nYou can create a function out of this if you see that you use this multiple times, that was you can keep your code DRY.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407316", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Setting global block attribute value I have a scenario where I will have to use the same API key for all the blocks of the same namespace that is present and that will be created new. So when user inputs on one block through a form, it will update on all the blocks of the particular namespace instantly.\nCurrently when register_block_type() and props.setAttributes method is used, the values for each attribute is unique for each of the block. I have seen the documentation. I couldn't see a standard way for sharing the same value across blocks.\nRegister code:\nregisterBlockType(\"namespace\", {\n  title: \"Plugin title\",\n  category: \"common\",\n  attributes: {\n    apiKey: { type: \"string\" },\n\nHandling submit from the form inside InspectorControls:\n<InspectorControls>\n      <PanelBody>\n        <form id=\"api-key-input\" onSubmit={(e) => handleSubmit(e)}>\n          <input\n            type=\"password\"\n            ref={inputRef}\n            defaultValue={props.attributes.apiKey}\n          />\n          <input type=\"submit\" />\n        </form>\n </InspectorControls>\n\nfunction handleSubmit(e) {\n  e.preventDefault();\n  props.setAttributes({ apiKey: inputRef.current.value });\n}\n\nThe methods that I have looked at so far.\n\n*\n\n*Storing the attributes in the database using update_option but I did not see any get_option for the Gutenberg block.\n\n*wp.data.subscribe way of dispatching to the blocks required.\n\n*Creating a registry store and managing the overall value using states.\n\nIs there an easiest/safest way of doing this that I am missing, like setting an option or supports value?\n\nA: You could make use of register_post_field() to add the API key to the post object which you then can retrieve via getEditedPostAttribute() in the editor.\nIn register_post_field() you can define by yourself via get_callback/update_callback how/where the API key should be saved like post meta or an option.\nTo update the API key in the editor use the editPost() dispatch function which will invoke your update_callback.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407324", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Unable to set font colour I'm unable to set the font colour on hyperlinks in my blog posts. I'm runnung WordPress 6.0 running Twenty Fifteen theme.\nCan anyone let me know if I have to add code to make the hyperlinks blue, or any other colour. No matter what I do, or the colour option I select in the colour-picker, the hyperlinks remain black.\nAny help would be welcomed as I'm looking to migrate to a newer WordPress theme.\n\n\nA: You are setting the color of the paragraph the link resides in, but in style.css (that is part of the theme you are using) there is a rule targeting all <a> elements that is more specific targeting and is overriding the color you are trying to set at the <p> level.\nYou can try customizing the theme by adding additional CSS rules to override the hyperlink color. I would not edit style.css in the event the theme gets updated and overwrites any changes you make.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407325", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Duplicate menu items when auto generating menu from product categories I have been searching for solutions for a problem that many have in Wordpress. I wanted to create a menu that automatically adds children and grand children of product categories that are already in the menu. I never found a way that suits my case. So, I managed to get to some point with a custom code (which I am beginner to). Bellow is my code that I have placed in the functions.php file of the child theme.\n//add_action('wp_update_nav_menu_item', 'add_children_as_well', 10, 3);\nfunction add_children_as_well($menu_id, $menu_item_db_id, $args){\n    $is_taxonomy = $args['menu-item-type'] == 'taxonomy';\n    if($is_taxonomy){\n        $termchildren = get_term_children( $args['menu-item-object-id'], $args['menu-item-object'] );\n        if(!empty( $termchildren )){\n            foreach($termchildren as $child){\n                $menu_item_data = array(\n                    'menu-item-object-id'     => $child,\n                    'menu-item-object'        => 'product_cat',\n                    'menu-item-parent-id'     => $menu_item_db_id,\n                    'menu-item-type'          => 'taxonomy',\n                    'menu-item-status'        => 'publish'\n                );\n                $new_id = wp_update_nav_menu_item( $menu_id, 0, $menu_item_data);\n            }\n        }\n    } \n}\n\nThe Procedure\nSo, when I want the sub-items to be generated I create a new menu, I add the parent product categories and before I click save, I open a new tab, I uncomment the first line of the code above, I save the functions.php file and then I go back to the menu editor and save the menu.\nI know this is funny but it works!\nAlthough, there is a problem. When it generates the children, it adds the grandchildren to the parent too, instead of only the children. For example, if there is a product category with the bellow structure:\n\n*\n\n*Category A\n\n*\n\n*Category B1\n\n*Category B2\n\n*\n\n*Category C1\n\n*Category C2\n\n\n\n\n\nit generates the menu bellow:\n\n*\n\n*Category A\n\n*\n\n*Category B1\n\n*Category B2\n\n*\n\n*Category C1\n\n*Category C2\n\n\n\n*Category C1\n\n*Category C2\n\n\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407328", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: CSS appears to not work on any WordPress theme I am in the process of updating my website and decided to purge the old content and start from scratch. However whichever theme I use the webpage fails to load properly. It looks like something to do with the CSS, but it is happening across multiple themes - so could it be some core WordPress file missing causing this to break?\nAny help would be much appreciated.\nMy website is https://www.waltonskitchens.co.uk\nExample of using an alternative theme\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407329", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Why does \"updated_post_meta\" did not fire when uploading media other than image? I am testing out the \"updated_post_meta\" hook by uploading items to media. I have notice that the hook is not firing if I am uploading files other than image.\nSo I check the post_meta table for the item that I upload. A row in post_meta table was created for the item, which means that the hook should fires, but is not.\nAnyone know why? Thank you.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407332", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Run uninstall.php if a checkbox is checked from settings page I am building a custom plugin and when the plugin is activated it creates 2 tables inside the wp database. What I want is, to add a checkbox is my custom plugin settings page, and if the checkbox is checked, the tables to be deleted from the database. I am using and uninstall.php file to delete my tables but that happens when I delete the plugin. I would like to fire that uninstall.php file which have the scripts to delete my tables, if the checkbox is checked.\nHere is my code\n<form action=\"options.php\" method=\"POST\" id=\"my-form\">\n<?php\n    settings_fields(\"customfields\");\n    do_settings_sections(\"support\");\n    submit_button(\"Save Data\");\n    ?>\n</form>\n<p>Delete Database? <?php echo get_option(\"delete_database\"); ?></p>\n<?php\nadd_settings_section(\"section\", null, null, \"support\");\nadd_settings_field(\"wp_delete_database\", \"Delete Database?\", array($this, \"HTML\"), \"support\", \"section\");\nregister_setting(\"customfields\", \"wp_delete_database\", array(\"sanitize_callback\" => \"sanitize_text_field\", \"default\" => \"Placeholder\"));\n?>\n\n\nA: You should have a function (single class, or method in a class) for the task to remove all the data from the plugin, like database or options entries.\nOn your settings page, call after an active checkbox this function, after sending a request, like via Button. In the uninstall.php have you also the possibility to use this function.\nSo you have only one function to do the same goal and no redundancy.\nregister_uninstall_hook\nFor the un-installion of the plugin via Core Function, Gui in the admin backend use the function register_uninstall_hook.\nThe uninstall.php\ncould look like this\n<?php\n/**\n* Uninstallation script\n* This file is called automatically by WP when the admin deletes the plugin from the installation.\n*/\n    \n! defined( 'WP_UNINSTALL_PLUGIN' ) && exit;\n\nrequire_once __DIR__ . '/src/settings.php';\n// Use core function to delete items in the options table\ndelete_site_option( Your_Class_Settings::OPTION_NAME );\n// Call method from class\nYour_Class_Settings->uninstall();\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407333", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Hide shipping method in woocommerce if custom checkbox field is selected So, i'm trying to hide a shipping method when a custom checkout checkbox field is checked. The custom checkbox field is \"enabledropshipping\" and the custom shipping method i need to hide is \"shipping_method_0_flat_rate1\".\nfunction conditionaly_hide_shipping_method( $available_methods ) {\n$post_data = urldecode($_POST['post_data']);\n$post_data_arr = is_string($post_data) ? explode(\"&\", $post_data) : array();\n$field_value= '';\nforeach ($post_data_arr as $value) {\n$value_arr = is_string($value) ? explode(\"=\", $value) : array();\nif(isset($value_arr[0]) && $value_arr[0] === 'enabledropshipping'){\n$field_value = isset($value_arr[1]) ? $value_arr[1] : '';\n}\n}\nif(is_array($available_methods) && $field_value === 'shipping_method_0_flat_rate1'){\nunset( $available_methods['shipping_method_0_flat_rate1'] );\n}\nreturn $available_methods;\n}\nadd_filter( 'woocommerce_shipping_methods', 'conditionaly_hide_shipping_method' , 10, 1 );\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407334", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How To Update WordPress Custom Plugin For Customer? I am building a custom wordPress plugin for customers. It is a support plugin. It will be install in more than 100 customers. Customers will install the plugin. How can I update the plugin from one place, and update to all customers? What is the procedure for this? I do not want to ask them to download it and install it again. Thank you.\n\nA: please Check links:\nhttps://github.com/YahnisElsts/plugin-update-checker\nThis is a custom update checker library for WordPress plugins and themes. It lets you add automatic update notifications and one-click upgrades to your WP Plugin.\nand another ref.\nhttps://rudrastyh.com/wordpress/self-hosted-plugin-update.html\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407337", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: How to move a Wordpress installation to a subdirectory I want to replace my WordPress site with a non-WordPress site but keep the original WordPress site in a sub-directory.  I have read through and tried this and various other methods but none seem to work or don't seem to fit my needs.\nThe current WordPress installation: https://example.com\nI want it at: https://example.com/blog\nImportantly all the instructions ask me to copy the index.php and .htaccess files to the root at the end.  This I don't want.  In the root, I will have a different index.php that is unrelated to WordPress.\nAny help appreciated. TIA\n\nA: Move all your WP installation to the subdirectory, Then uodate in your DB (wp_options by default) the siteurl and home with the new url.\nchange https://example.com to https://example.com/blog\nYou need also to replace all ocurrences of example.com to example.com/blog in your DB manually, with SQL or with a plugin such Better Search Replace\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407345", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
{"text": "Q: Using wp_set_script_translations without manually registering the script When using @wordpress/create-block to scaffhold a plugin for a block, the generated bundle is automatically registered via the block.json metadata :\n{\n  ...\n  \"name\": \"my-block\",\n  \"textdomain\": \"my-block\",\n  \"editorScript\": \"file:./index.js\",\n  ...\n}\n\nNo need to call wp_register_script myself. This is great since it automatically handles dependencies via the index.asset.php file generated in the build folder.\nFollowing the procedure mentionned in the doc, I then create a JET translation file. Here is the procedure :\n\n*\n\n*Creating POT file with wp i18n make-pot . languages/my-block.pot\n\n*Creating PO file with cp languages/test.pot languages/my-block-FR_BE.po\n\n*Filling msgstr strings in my-block-FR_BE.po\n\n*Adding line \"Language: fr_BE\\n\" to my-block-FR_BE.po\n\n*Creating JSON file with wp i18n make-json languages/my-block-FR_BE.po --no-purge\nThe JSON generated is appended with a md5 hash: my-block-fr_BE-cae574befd871d4f740fd8b719bac1db.json.\nNow I have to call wp_set_script_translations in my init method :\nfunction my_block_init() {\n   register_block_type( __DIR__ . '/build' );\n   wp_set_script_translations( 'my-block-script', 'my-block', plugin_dir_path( __FILE__ ) . 'languages/' );\n}\n\nThis does not work.\nIn order to make it work, I have to register the script and enqueue it, loosing the ability to have dependencies automatically injected :\nfunction my_block_init() {\n    wp_register_script(\n        'my-block-script',\n        plugins_url('/build/index.js', __FILE__),\n        array('react', 'wp-block-editor', 'wp-blocks', 'wp-components', 'wp-element', 'wp-i18n', 'wp-react-refresh-runtime')\n    );\n    wp_enqueue_script('my-block-script');\n    register_block_type( __DIR__ . '/build' );\n\n    wp_set_script_translations('my-block-script', 'my-block', plugin_dir_path( __FILE__ ) . 'languages/');\n}\n\nI also need to rename my JSON file to include the script handle instead of the automatically generated md5 hash. The \"Load Translation File\" section in the doc gives me the impression that this shouldn't be necessary when keeping the generated name, though I'm not sure of what I'm supposed to do here :\n\nWordPress will check for a file in that path with the format ${domain}-${locale}-${handle}.json as the source of translations. Alternatively, instead of the registered handle you can use the md5 hash of the relative path of the file, ${domain}-${locale} in the form of ${domain}-${locale}-${md5}.json.\n\nIs there a way to register JET translations for a script that is automatically registered via the block metadata ? And how can I use the generated name for the JSON file when registering my translation ?\nEdit\nHere's the folder structure :\napp/plugins/my-block/\n\u251c\u2500\u2500 build\n\u2502   \u251c\u2500\u2500 block.json\n\u2502   \u2514\u2500\u2500 index.asset.php\n\u2502   \u2514\u2500\u2500 index.css\n\u2502   \u2514\u2500\u2500 index.js\n\u2502   \u2514\u2500\u2500 style-index.css\n\u251c\u2500\u2500 languages\n\u2502   \u251c\u2500\u2500 my-block.pot\n\u2502   \u2514\u2500\u2500 my-block-fr_BE.po\n\u2502   \u2514\u2500\u2500 my-block-fr_BE-my-block-script.json\n\u251c\u2500\u2500 src\n\u2502   \u251c\u2500\u2500 block.json\n\u2502   \u2514\u2500\u2500 index.js\n\u2502   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 my-block.php\n\nAnd here's the content of the my-block.php file (plugin root) :\n<?php\n/**\n * Plugin Name:       My Block\n * Requires at least: 5.9\n * Requires PHP:      7.0\n * Version:           0.1.0\n * Author:            The WordPress Contributors\n * License:           GPL-2.0-or-later\n * License URI:       https://www.gnu.org/licenses/gpl-2.0.html\n * Text Domain:       my-block\n */\n\nfunction my_block_init() {\n    register_block_type( __DIR__ . '/build' );\n\n    wp_set_script_translations( 'my-block-script', 'my-block', plugin_dir_path( __FILE__ ) . 'languages/' );\n}\nadd_action( 'init', 'my_block_init' );\n\n\nA: @drskullster already posted a good answer, but I thought I should share the following which explains why wp_set_script_translations() needs to be called manually:\n\n*\n\n*Yes it's true that WordPress will automatically register and enqueue the block editor script. So we do not need to manually register/enqueue that script!\n\n\n*WordPress will also automatically set the script's translations, but only if the block metadata file (i.e. block.json) specifies a valid text domain (e.g. \"textdomain\": \"gutenpride\") and that the script has wp-i18n as one of its dependencies. See register_block_script_handle().\n\n\n*WordPress uses wp_set_script_translations( $script_handle, $metadata['textdomain'] ) to register/set the translations for the script, which means the 3rd parameter (the file path) is not specified and therefore, WordPress will try to load the translation files from the wp-content/languages/plugins folder.\nSo for example, if my-block-fr_BE-dfbff627e6c248bcb3b61d7d06da9ca9.json was the JSON file name, then WordPress would attempt to load wp-content/languages/plugins/my-block-fr_BE-dfbff627e6c248bcb3b61d7d06da9ca9.json.\nAnd thus, you should copy that file to the wp-content/languages/plugins folder. That way, your main plugin file would only need to call register_block_type() and that's it \u2014 no need to worry about the JSON file name or MD5 hash, and you also would not need to manually call wp_set_script_translations().\nBut if you don't want to having to copy the files, then yes, you will need to manually call wp_set_script_translations(), but remember that the script handle is in the form of <block name>-editor-script where <block name> is the block name (which is the name property in block.json), but with slashes (/) replaced with hypens (-).\n\n*\n\n*So if the block name is my-block, then the script handle would be my-block-editor-script. Or if the name is create-block/gutenpride, then the handle would be create-block-gutenpride-editor-script. See generate_block_asset_handle() for more details.\n\nSo I hope that helps, and FYI, the following is what I had in my main plugin file (wp-content/plugins/gutenpride/gutenpride.php):\nfunction create_block_gutenpride_block_init() {\n    register_block_type( __DIR__ . '/build' );\n\n    // Load MO files for PHP.\n    load_plugin_textdomain( 'gutenpride', false, dirname( plugin_basename( __FILE__ ) ) . '/languages' );\n\n    // Load JSON files for JS - this is necessary if using a custom languages path!!\n    $script_handle = generate_block_asset_handle( 'create-block/gutenpride', 'editorScript' );\n    wp_set_script_translations( $script_handle, 'gutenpride', plugin_dir_path( __FILE__ ) . 'languages' );\n}\nadd_action( 'init', 'create_block_gutenpride_block_init' );\n\n\n*\n\n*Note: I followed the same steps as in your procedure, but I got an extra step \u2014 I created an MO file for use in standard PHP translations, e.g. <?php _e( 'text', 'gutenpride' ); ?>.\n\nAdditional Notes\n\n*\n\n*If the 3rd parameter for wp_set_script_translations() is specified and the path/folder contains a JSON translations file named <text domain>-<locale>-<script handle>.json, e.g. gutenpride-fr_BE-create-block-gutenpride-editor-script.json, then WordPress will attempt to load that first.\nSo if the file doesn't exist, then WordPress will attempt to load the default one with the MD5 hash, e.g. gutenpride-fr_BE-dfbff627e6c248bcb3b61d7d06da9ca9.json.\n\n\n*load_script_translations() is the function used to load translations from script translations files, i.e. that function opens the file and reads its content; and the function applies filters like load_script_translation_file which you may find useful when debugging.. :)\n\n\n*My \"Gutenpride\" block was tried & tested with WordPress v6.0, and the latest version of the @wordpress/create-block package at the time of writing.\n\nA: Here's the problem:\n    wp_set_script_translations( 'my-block-script', 'my-block', plugin_dir_path( __FILE__ ) . 'languages/' );\n}\nadd_action( 'init', 'my_block_init' );\n\ninit is too early, WP hasn't registered your blocks assets yet, it knows about the block but that doesn't mean it instantly did all the work all at once in a single atomic step. If it registered and enqueued the scripts and styles on init it would generate warnings and doing it wrong notices!\nAnd as the docs say:\n\nWorks only if the script has already been registered.\n\nhttps://developer.wordpress.org/reference/functions/wp_set_script_translations/\nIt's too early!!! A useful thing to do is check the return value which is a true/false indicating success.\nInstead, call it on the wp_enqueue_scripts hook the same way the docs say wp_enqueue_script and others should be called, but give it a higher priority value on the hook to ensure it runs afterwards.\nHere's a useful example from the official WP docs:\nhttps://developer.wordpress.org/reference/functions/wp_set_script_translations/#comment-5072\n\nA: Here's how I managed to make it work :\nI found the handle of the script registered automatically with register_block_type by printing the $this->registered variable inside the WP_Scripts->set_translations method, it was called something like my-block-editor-script.\nBy using this handle inside the call to wp_set_script_translations I was able to remove the code that registered and enqueued the script, and I also could use the generated name for the json files.\nHere's what my main plugin file looks like now :\n<?php\n/**\n * Plugin Name:       My Block\n * Requires at least: 5.9\n * Requires PHP:      7.0\n * Version:           0.1.0\n * Text Domain:       my-block\n */\n\nfunction my_block_init() {\n    register_block_type( __DIR__ . '/build' );\n}\nadd_action( 'init', 'my_block_init' );\n\nfunction my_block_set_translations() {\n    wp_set_script_translations( 'my-block-editor-script', 'my-block',  plugin_dir_path( __FILE__ ) . 'languages/' );\n}\nadd_action( 'init', 'my_block_set_translations' );\n\nAnd the path to the JET file: languages/my-block-fr_BE-dfbff627e6c248bcb3b61d7d06da9ca9.json.\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407346", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "4"}}
{"text": "Q: How to show every second user different types of banners? I have to create the next feature fore the project:\nWe have two type of top-bar lines. We need to show every second user(or user session I think it's more easy) different types of banners. Okay I created a really simple code for this propose:\n//Create a session\nsession_start();\nif(isset( $_SESSION ) ){\n    $_SESSION['visitCount']++;\n\n    //Create the option for adding here the session value\n    add_option( 'banner_counter', $_SESSION['visitCount'] );\n    \n    //Get curren value from the option table\n    $sessionValue = get_option('banner_counter');\n\n    //Added the value of new current session to the value from the optiontable\n    $TotalSession = $sessionValue + 1;\n\n    //Updat the option value for showing it on the admin section\n    update_option( 'banner_counter', $TotalSession  );\n}else{\n    $_SESSION['visitCount']=1;\n}\n\nFor displing different banner I used the next code:\n <?php if($_SESSION['visitCount'] % 2): ?>\n\n  <h2>Banner One</h2>\n\n <?php else: ?>\n\n  <h2>Banner One</h2>\n\n <?php endif; ?>\n\nAnd it works. But I afraid this is not correct solution used wp_option() for my propose. May be everybody could help me giving advise in this area.\n\nA: You could set a cookie that identifies a user as belonging to either group, then based on the cookie display different things.\nAnd I think there is no need to save the counter, you can randomly assign a new user to a group.\n\nA: Instead of using the Options API, you'd be better off using the Transients API, however in either case you'll be polluting the *_options table (even if you use transients with expiration times).\nI'd possibly recommend using wp-session-manager plugin by EAMann's which will allow you to use and store $_SESSION data in a dedicated sessions database table that the plugin creates upon activation (or where it does not exist).\nReading:\n\n*\n\n*https://github.com/ericmann/wp-session-manager\n\n*https://wordpress.org/plugins/wp-session-manager (Plugin Repo)\n\n*https://developer.wordpress.org/apis/handbook/transients/\n\n*https://developer.wordpress.org/plugins/settings/options-api/\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407347", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "2"}}
{"text": "Q: Theme JQuery inlcusion on Wordpress 6.0 always fails I am writing here because i have Wordpress 6.0, i am trying to include JQuery in my theme beacuse i have to start working on a functionality i need. The problem is that JQuery is not loading correctly i guess because in my chrome developer console i got this error:\n\n\nJquery is not recognized but i don't undersand why, because i have always followed Wordpress practices and as you can see below in the code apparently there is nothing wrong. Wordpress has already its own Jquery, i don't want an external Jquery library even in CDN, i don't think is needed another JQuery.\nHere is the code for enqueuing additional js scripts in functions.php:\nfunction load_custom_jquery_edit(){\nwp_enqueue_script('jquery');\n\nwp_enqueue_script('customize-jq', \n                    get_template_directory_uri().'/assets/js/customize-jq.js',\n                    array('jquery'),\n                    \"1.1.0\",\n                    true);\n}\n\nadd_action('wp_enqueue_scripts', 'load_custom_jquery_edit');\n\nThis is my JQuery additional file:\n(function($){\n$(document).ready(function(){\n    //testing example\n    $('test-my-new-submit-btn')\n    .attr('id','testBtn');\n\n    $('#testBtn').on('click', function(e){\n        e.preventDefault();\n    \n        let success_msg = \"success!!!\";\n        \n        alert(success_msg);\n                    \n        //Other things to do next\n    });\n});\n})(JQuery);\n\n", "meta": {"language": "en", "url": "https://wordpress.stackexchange.com/questions/407348", "timestamp": "2023-03-29", "source": "stackexchange", "question_score": "0"}}
